extend: flows
actions:
  designFlow:
    label: 流程设计器
    visible: !<tag:yaml.org,2002:js/function> |-
      function (object_name, record_id, record_permissions) {
              return true;
            }
    'on': record
    todo: !<tag:yaml.org,2002:js/function> |-
      function (object_name, record_id, fields) {
              var url;
              var locale = Steedos.locale();
              var space = Steedos.spaceId();
              var flow = record_id;
              var companyId = Creator.getUserCompanyId();
              url = `/applications/designer/current/${locale}/?spaceId=${space}`;
              if (flow) {
                url = url + `&flowId=${flow}`;
              }
              if (companyId && !Creator.isSpaceAdmin(space, Meteor.userId())) {
                url = url + `&companyId=${companyId}`;
              }
              return Steedos.openWindow(Steedos.absoluteUrl(url));
            }