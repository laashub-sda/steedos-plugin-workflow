/*!
 * jQuery JavaScript Library v1.6.2
 * http://jquery.com/
 *
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2011, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Thu Jun 30 14:16:56 2011 -0400
 */
(function(bc,N){var au=bc.document,bu=bc.navigator,bl=bc.location;var b=(function(){var bF=function(b0,b1){return new bF.fn.init(b0,b1,bD)},bV=bc.jQuery,bH=bc.$,bD,bZ=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,bN=/\S/,bJ=/^\s+/,bE=/\s+$/,bI=/\d/,bA=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,bO=/^[\],:{}\s]*$/,bX=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,bQ=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,bK=/(?:^|:|,)(?:\s*\[)+/g,by=/(webkit)[ \/]([\w.]+)/,bS=/(opera)(?:.*version)?[ \/]([\w.]+)/,bR=/(msie) ([\w.]+)/,bT=/(mozilla)(?:.*? rv:([\w.]+))?/,bB=/-([a-z])/ig,bU=function(b0,b1){return b1.toUpperCase()},bY=bu.userAgent,bW,bC,e,bM=Object.prototype.toString,bG=Object.prototype.hasOwnProperty,bz=Array.prototype.push,bL=Array.prototype.slice,bP=String.prototype.trim,bv=Array.prototype.indexOf,bx={};bF.fn=bF.prototype={constructor:bF,init:function(b0,b4,b3){var b2,b5,b1,b6;if(!b0){return this}if(b0.nodeType){this.context=this[0]=b0;this.length=1;return this}if(b0==="body"&&!b4&&au.body){this.context=au;this[0]=au.body;this.selector=b0;this.length=1;return this}if(typeof b0==="string"){if(b0.charAt(0)==="<"&&b0.charAt(b0.length-1)===">"&&b0.length>=3){b2=[null,b0,null]}else{b2=bZ.exec(b0)}if(b2&&(b2[1]||!b4)){if(b2[1]){b4=b4 instanceof bF?b4[0]:b4;b6=(b4?b4.ownerDocument||b4:au);b1=bA.exec(b0);if(b1){if(bF.isPlainObject(b4)){b0=[au.createElement(b1[1])];bF.fn.attr.call(b0,b4,true)}else{b0=[b6.createElement(b1[1])]}}else{b1=bF.buildFragment([b2[1]],[b6]);b0=(b1.cacheable?bF.clone(b1.fragment):b1.fragment).childNodes}return bF.merge(this,b0)}else{b5=au.getElementById(b2[2]);if(b5&&b5.parentNode){if(b5.id!==b2[2]){return b3.find(b0)}this.length=1;this[0]=b5}this.context=au;this.selector=b0;return this}}else{if(!b4||b4.jquery){return(b4||b3).find(b0)}else{return this.constructor(b4).find(b0)}}}else{if(bF.isFunction(b0)){return b3.ready(b0)}}if(b0.selector!==N){this.selector=b0.selector;this.context=b0.context}return bF.makeArray(b0,this)},selector:"",jquery:"1.6.2",length:0,size:function(){return this.length},toArray:function(){return bL.call(this,0)},get:function(b0){return b0==null?this.toArray():(b0<0?this[this.length+b0]:this[b0])},pushStack:function(b1,b3,b0){var b2=this.constructor();if(bF.isArray(b1)){bz.apply(b2,b1)}else{bF.merge(b2,b1)}b2.prevObject=this;b2.context=this.context;if(b3==="find"){b2.selector=this.selector+(this.selector?" ":"")+b0}else{if(b3){b2.selector=this.selector+"."+b3+"("+b0+")"}}return b2},each:function(b1,b0){return bF.each(this,b1,b0)},ready:function(b0){bF.bindReady();bC.done(b0);return this},eq:function(b0){return b0===-1?this.slice(b0):this.slice(b0,+b0+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(bL.apply(this,arguments),"slice",bL.call(arguments).join(","))},map:function(b0){return this.pushStack(bF.map(this,function(b2,b1){return b0.call(b2,b1,b2)}))},end:function(){return this.prevObject||this.constructor(null)},push:bz,sort:[].sort,splice:[].splice};bF.fn.init.prototype=bF.fn;bF.extend=bF.fn.extend=function(){var b9,b2,b0,b1,b6,b7,b5=arguments[0]||{},b4=1,b3=arguments.length,b8=false;if(typeof b5==="boolean"){b8=b5;b5=arguments[1]||{};b4=2}if(typeof b5!=="object"&&!bF.isFunction(b5)){b5={}}if(b3===b4){b5=this;--b4}for(;b4<b3;b4++){if((b9=arguments[b4])!=null){for(b2 in b9){b0=b5[b2];b1=b9[b2];if(b5===b1){continue}if(b8&&b1&&(bF.isPlainObject(b1)||(b6=bF.isArray(b1)))){if(b6){b6=false;b7=b0&&bF.isArray(b0)?b0:[]}else{b7=b0&&bF.isPlainObject(b0)?b0:{}}b5[b2]=bF.extend(b8,b7,b1)}else{if(b1!==N){b5[b2]=b1}}}}}return b5};bF.extend({noConflict:function(b0){if(bc.$===bF){bc.$=bH}if(b0&&bc.jQuery===bF){bc.jQuery=bV}return bF},isReady:false,readyWait:1,holdReady:function(b0){if(b0){bF.readyWait++}else{bF.ready(true)}},ready:function(b0){if((b0===true&&!--bF.readyWait)||(b0!==true&&!bF.isReady)){if(!au.body){return setTimeout(bF.ready,1)}bF.isReady=true;if(b0!==true&&--bF.readyWait>0){return}bC.resolveWith(au,[bF]);if(bF.fn.trigger){bF(au).trigger("ready").unbind("ready")}}},bindReady:function(){if(bC){return}bC=bF._Deferred();if(au.readyState==="complete"){return setTimeout(bF.ready,1)}if(au.addEventListener){au.addEventListener("DOMContentLoaded",e,false);bc.addEventListener("load",bF.ready,false)}else{if(au.attachEvent){au.attachEvent("onreadystatechange",e);bc.attachEvent("onload",bF.ready);var b0=false;try{b0=bc.frameElement==null}catch(b1){}if(au.documentElement.doScroll&&b0){bw()}}}},isFunction:function(b0){return bF.type(b0)==="function"},isArray:Array.isArray||function(b0){return bF.type(b0)==="array"},isWindow:function(b0){return b0&&typeof b0==="object"&&"setInterval" in b0},isNaN:function(b0){return b0==null||!bI.test(b0)||isNaN(b0)},type:function(b0){return b0==null?String(b0):bx[bM.call(b0)]||"object"},isPlainObject:function(b1){if(!b1||bF.type(b1)!=="object"||b1.nodeType||bF.isWindow(b1)){return false}if(b1.constructor&&!bG.call(b1,"constructor")&&!bG.call(b1.constructor.prototype,"isPrototypeOf")){return false}var b0;for(b0 in b1){}return b0===N||bG.call(b1,b0)},isEmptyObject:function(b1){for(var b0 in b1){return false}return true},error:function(b0){throw b0},parseJSON:function(b0){if(typeof b0!=="string"||!b0){return null}b0=bF.trim(b0);if(bc.JSON&&bc.JSON.parse){return bc.JSON.parse(b0)}if(bO.test(b0.replace(bX,"@").replace(bQ,"]").replace(bK,""))){return(new Function("return "+b0))()}bF.error("Invalid JSON: "+b0)},parseXML:function(b2,b0,b1){if(bc.DOMParser){b1=new DOMParser();b0=b1.parseFromString(b2,"text/xml")}else{b0=new ActiveXObject("Microsoft.XMLDOM");b0.async="false";b0.loadXML(b2)}b1=b0.documentElement;if(!b1||!b1.nodeName||b1.nodeName==="parsererror"){bF.error("Invalid XML: "+b2)}return b0},noop:function(){},globalEval:function(b0){if(b0&&bN.test(b0)){(bc.execScript||function(b1){bc["eval"].call(bc,b1)})(b0)}},camelCase:function(b0){return b0.replace(bB,bU)},nodeName:function(b1,b0){return b1.nodeName&&b1.nodeName.toUpperCase()===b0.toUpperCase()},each:function(b3,b6,b2){var b1,b4=0,b5=b3.length,b0=b5===N||bF.isFunction(b3);if(b2){if(b0){for(b1 in b3){if(b6.apply(b3[b1],b2)===false){break}}}else{for(;b4<b5;){if(b6.apply(b3[b4++],b2)===false){break}}}}else{if(b0){for(b1 in b3){if(b6.call(b3[b1],b1,b3[b1])===false){break}}}else{for(;b4<b5;){if(b6.call(b3[b4],b4,b3[b4++])===false){break}}}}return b3},trim:bP?function(b0){return b0==null?"":bP.call(b0)}:function(b0){return b0==null?"":b0.toString().replace(bJ,"").replace(bE,"")},makeArray:function(b3,b1){var b0=b1||[];if(b3!=null){var b2=bF.type(b3);if(b3.length==null||b2==="string"||b2==="function"||b2==="regexp"||bF.isWindow(b3)){bz.call(b0,b3)}else{bF.merge(b0,b3)}}return b0},inArray:function(b2,b3){if(bv){return bv.call(b3,b2)}for(var b0=0,b1=b3.length;b0<b1;b0++){if(b3[b0]===b2){return b0}}return -1},merge:function(b4,b2){var b3=b4.length,b1=0;if(typeof b2.length==="number"){for(var b0=b2.length;b1<b0;b1++){b4[b3++]=b2[b1]}}else{while(b2[b1]!==N){b4[b3++]=b2[b1++]}}b4.length=b3;return b4},grep:function(b1,b6,b0){var b2=[],b5;b0=!!b0;for(var b3=0,b4=b1.length;b3<b4;b3++){b5=!!b6(b1[b3],b3);if(b0!==b5){b2.push(b1[b3])}}return b2},map:function(b0,b7,b8){var b5,b6,b4=[],b2=0,b1=b0.length,b3=b0 instanceof bF||b1!==N&&typeof b1==="number"&&((b1>0&&b0[0]&&b0[b1-1])||b1===0||bF.isArray(b0));if(b3){for(;b2<b1;b2++){b5=b7(b0[b2],b2,b8);if(b5!=null){b4[b4.length]=b5}}}else{for(b6 in b0){b5=b7(b0[b6],b6,b8);if(b5!=null){b4[b4.length]=b5}}}return b4.concat.apply([],b4)},guid:1,proxy:function(b4,b3){if(typeof b3==="string"){var b2=b4[b3];b3=b4;b4=b2}if(!bF.isFunction(b4)){return N}var b0=bL.call(arguments,2),b1=function(){return b4.apply(b3,b0.concat(bL.call(arguments)))};b1.guid=b4.guid=b4.guid||b1.guid||bF.guid++;return b1},access:function(b0,b8,b6,b2,b5,b7){var b1=b0.length;if(typeof b8==="object"){for(var b3 in b8){bF.access(b0,b3,b8[b3],b2,b5,b6)}return b0}if(b6!==N){b2=!b7&&b2&&bF.isFunction(b6);for(var b4=0;b4<b1;b4++){b5(b0[b4],b8,b2?b6.call(b0[b4],b4,b5(b0[b4],b8)):b6,b7)}return b0}return b1?b5(b0[0],b8):N},now:function(){return(new Date()).getTime()},uaMatch:function(b1){b1=b1.toLowerCase();var b0=by.exec(b1)||bS.exec(b1)||bR.exec(b1)||b1.indexOf("compatible")<0&&bT.exec(b1)||[];return{browser:b0[1]||"",version:b0[2]||"0"}},sub:function(){function b0(b3,b4){return new b0.fn.init(b3,b4)}bF.extend(true,b0,this);b0.superclass=this;b0.fn=b0.prototype=this();b0.fn.constructor=b0;b0.sub=this.sub;b0.fn.init=function b2(b3,b4){if(b4&&b4 instanceof bF&&!(b4 instanceof b0)){b4=b0(b4)}return bF.fn.init.call(this,b3,b4,b1)};b0.fn.init.prototype=b0.fn;var b1=b0(au);return b0},browser:{}});bF.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(b1,b0){bx["[object "+b0+"]"]=b0.toLowerCase()});bW=bF.uaMatch(bY);if(bW.browser){bF.browser[bW.browser]=true;bF.browser.version=bW.version}if(bF.browser.webkit){bF.browser.safari=true}if(bN.test("\xA0")){bJ=/^[\s\xA0]+/;bE=/[\s\xA0]+$/}bD=bF(au);if(au.addEventListener){e=function(){au.removeEventListener("DOMContentLoaded",e,false);bF.ready()}}else{if(au.attachEvent){e=function(){if(au.readyState==="complete"){au.detachEvent("onreadystatechange",e);bF.ready()}}}}function bw(){if(bF.isReady){return}try{au.documentElement.doScroll("left")}catch(b0){setTimeout(bw,1);return}bF.ready()}return bF})();var a="done fail isResolved isRejected promise then always pipe".split(" "),aI=[].slice;b.extend({_Deferred:function(){var bx=[],by,bv,bw,e={done:function(){if(!bw){var bA=arguments,bB,bE,bD,bC,bz;if(by){bz=by;by=0}for(bB=0,bE=bA.length;bB<bE;bB++){bD=bA[bB];bC=b.type(bD);if(bC==="array"){e.done.apply(e,bD)}else{if(bC==="function"){bx.push(bD)}}}if(bz){e.resolveWith(bz[0],bz[1])}}return this},resolveWith:function(bA,bz){if(!bw&&!by&&!bv){bz=bz||[];bv=1;try{while(bx[0]){bx.shift().apply(bA,bz)}}finally{by=[bA,bz];bv=0}}return this},resolve:function(){e.resolveWith(this,arguments);return this},isResolved:function(){return !!(bv||by)},cancel:function(){bw=1;bx=[];return this}};return e},Deferred:function(bv){var e=b._Deferred(),bx=b._Deferred(),bw;b.extend(e,{then:function(bz,by){e.done(bz).fail(by);return this},always:function(){return e.done.apply(e,arguments).fail.apply(this,arguments)},fail:bx.done,rejectWith:bx.resolveWith,reject:bx.resolve,isRejected:bx.isResolved,pipe:function(bz,by){return b.Deferred(function(bA){b.each({done:[bz,"resolve"],fail:[by,"reject"]},function(bC,bF){var bB=bF[0],bE=bF[1],bD;if(b.isFunction(bB)){e[bC](function(){bD=bB.apply(this,arguments);if(bD&&b.isFunction(bD.promise)){bD.promise().then(bA.resolve,bA.reject)}else{bA[bE](bD)}})}else{e[bC](bA[bE])}})}).promise()},promise:function(bz){if(bz==null){if(bw){return bw}bw=bz={}}var by=a.length;while(by--){bz[a[by]]=e[a[by]]}return bz}});e.done(bx.cancel).fail(e.cancel);delete e.cancel;if(bv){bv.call(e,e)}return e},when:function(bA){var bv=arguments,bw=0,bz=bv.length,by=bz,e=bz<=1&&bA&&b.isFunction(bA.promise)?bA:b.Deferred();function bx(bB){return function(bC){bv[bB]=arguments.length>1?aI.call(arguments,0):bC;if(!(--by)){e.resolveWith(e,aI.call(bv,0))}}}if(bz>1){for(;bw<bz;bw++){if(bv[bw]&&b.isFunction(bv[bw].promise)){bv[bw].promise().then(bx(bw),e.reject)}else{--by}}if(!by){e.resolveWith(e,bv)}}else{if(e!==bA){e.resolveWith(e,bz?[bA]:[])}}return e.promise()}});b.support=(function(){var bF=au.createElement("div"),bM=au.documentElement,by,bN,bG,bw,bE,bz,bC,bv,bD,bH,bB,bL,bJ,bx,bA,bI,bO;bF.setAttribute("className","t");bF.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";by=bF.getElementsByTagName("*");bN=bF.getElementsByTagName("a")[0];if(!by||!by.length||!bN){return{}}bG=au.createElement("select");bw=bG.appendChild(au.createElement("option"));bE=bF.getElementsByTagName("input")[0];bC={leadingWhitespace:(bF.firstChild.nodeType===3),tbody:!bF.getElementsByTagName("tbody").length,htmlSerialize:!!bF.getElementsByTagName("link").length,style:/top/.test(bN.getAttribute("style")),hrefNormalized:(bN.getAttribute("href")==="/a"),opacity:/^0.55$/.test(bN.style.opacity),cssFloat:!!bN.style.cssFloat,checkOn:(bE.value==="on"),optSelected:bw.selected,getSetAttribute:bF.className!=="t",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};bE.checked=true;bC.noCloneChecked=bE.cloneNode(true).checked;bG.disabled=true;bC.optDisabled=!bw.disabled;try{delete bF.test}catch(bK){bC.deleteExpando=false}if(!bF.addEventListener&&bF.attachEvent&&bF.fireEvent){bF.attachEvent("onclick",function(){bC.noCloneEvent=false});bF.cloneNode(true).fireEvent("onclick")}bE=au.createElement("input");bE.value="t";bE.setAttribute("type","radio");bC.radioValue=bE.value==="t";bE.setAttribute("checked","checked");bF.appendChild(bE);bv=au.createDocumentFragment();bv.appendChild(bF.firstChild);bC.checkClone=bv.cloneNode(true).cloneNode(true).lastChild.checked;bF.innerHTML="";bF.style.width=bF.style.paddingLeft="1px";bD=au.getElementsByTagName("body")[0];bB=au.createElement(bD?"div":"body");bL={visibility:"hidden",width:0,height:0,border:0,margin:0};if(bD){b.extend(bL,{position:"absolute",left:-1000,top:-1000})}for(bI in bL){bB.style[bI]=bL[bI]}bB.appendChild(bF);bH=bD||bM;bH.insertBefore(bB,bH.firstChild);bC.appendChecked=bE.checked;bC.boxModel=bF.offsetWidth===2;if("zoom" in bF.style){bF.style.display="inline";bF.style.zoom=1;bC.inlineBlockNeedsLayout=(bF.offsetWidth===2);bF.style.display="";bF.innerHTML="<div style='width:4px;'></div>";bC.shrinkWrapBlocks=(bF.offsetWidth!==2)}bF.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";bJ=bF.getElementsByTagName("td");bO=(bJ[0].offsetHeight===0);bJ[0].style.display="";bJ[1].style.display="none";bC.reliableHiddenOffsets=bO&&(bJ[0].offsetHeight===0);bF.innerHTML="";if(au.defaultView&&au.defaultView.getComputedStyle){bz=au.createElement("div");bz.style.width="0";bz.style.marginRight="0";bF.appendChild(bz);bC.reliableMarginRight=(parseInt((au.defaultView.getComputedStyle(bz,null)||{marginRight:0}).marginRight,10)||0)===0}bB.innerHTML="";bH.removeChild(bB);if(bF.attachEvent){for(bI in {submit:1,change:1,focusin:1}){bA="on"+bI;bO=(bA in bF);if(!bO){bF.setAttribute(bA,"return;");bO=(typeof bF[bA]==="function")}bC[bI+"Bubbles"]=bO}}bB=bv=bG=bw=bD=bz=bF=bE=null;return bC})();b.boxModel=b.support.boxModel;var aP=/^(?:\{.*\}|\[.*\])$/,az=/([a-z])([A-Z])/g;b.extend({cache:{},uuid:0,expando:"jQuery"+(b.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(e){e=e.nodeType?b.cache[e[b.expando]]:e[b.expando];return !!e&&!W(e)},data:function(bx,bv,bz,by){if(!b.acceptData(bx)){return}var bC=b.expando,bB=typeof bv==="string",bA,bD=bx.nodeType,e=bD?b.cache:bx,bw=bD?bx[b.expando]:bx[b.expando]&&b.expando;if((!bw||(by&&bw&&!e[bw][bC]))&&bB&&bz===N){return}if(!bw){if(bD){bx[b.expando]=bw=++b.uuid}else{bw=b.expando}}if(!e[bw]){e[bw]={};if(!bD){e[bw].toJSON=b.noop}}if(typeof bv==="object"||typeof bv==="function"){if(by){e[bw][bC]=b.extend(e[bw][bC],bv)}else{e[bw]=b.extend(e[bw],bv)}}bA=e[bw];if(by){if(!bA[bC]){bA[bC]={}}bA=bA[bC]}if(bz!==N){bA[b.camelCase(bv)]=bz}if(bv==="events"&&!bA[bv]){return bA[bC]&&bA[bC].events}return bB?bA[b.camelCase(bv)]||bA[bv]:bA},removeData:function(by,bw,bz){if(!b.acceptData(by)){return}var bB=b.expando,bC=by.nodeType,bv=bC?b.cache:by,bx=bC?by[b.expando]:b.expando;if(!bv[bx]){return}if(bw){var bA=bz?bv[bx][bB]:bv[bx];if(bA){delete bA[bw];if(!W(bA)){return}}}if(bz){delete bv[bx][bB];if(!W(bv[bx])){return}}var e=bv[bx][bB];if(b.support.deleteExpando||bv!=bc){delete bv[bx]}else{bv[bx]=null}if(e){bv[bx]={};if(!bC){bv[bx].toJSON=b.noop}bv[bx][bB]=e}else{if(bC){if(b.support.deleteExpando){delete by[b.expando]}else{if(by.removeAttribute){by.removeAttribute(b.expando)}else{by[b.expando]=null}}}}},_data:function(bv,e,bw){return b.data(bv,e,bw,true)},acceptData:function(bv){if(bv.nodeName){var e=b.noData[bv.nodeName.toLowerCase()];if(e){return !(e===true||bv.getAttribute("classid")!==e)}}return true}});b.fn.extend({data:function(by,bA){var bz=null;if(typeof by==="undefined"){if(this.length){bz=b.data(this[0]);if(this[0].nodeType===1){var e=this[0].attributes,bw;for(var bx=0,bv=e.length;bx<bv;bx++){bw=e[bx].name;if(bw.indexOf("data-")===0){bw=b.camelCase(bw.substring(5));a5(this[0],bw,bz[bw])}}}}return bz}else{if(typeof by==="object"){return this.each(function(){b.data(this,by)})}}var bB=by.split(".");bB[1]=bB[1]?"."+bB[1]:"";if(bA===N){bz=this.triggerHandler("getData"+bB[1]+"!",[bB[0]]);if(bz===N&&this.length){bz=b.data(this[0],by);bz=a5(this[0],by,bz)}return bz===N&&bB[1]?this.data(bB[0]):bz}else{return this.each(function(){var bD=b(this),bC=[bB[0],bA];bD.triggerHandler("setData"+bB[1]+"!",bC);b.data(this,by,bA);bD.triggerHandler("changeData"+bB[1]+"!",bC)})}},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function a5(bx,bw,by){if(by===N&&bx.nodeType===1){var bv="data-"+bw.replace(az,"$1-$2").toLowerCase();by=bx.getAttribute(bv);if(typeof by==="string"){try{by=by==="true"?true:by==="false"?false:by==="null"?null:!b.isNaN(by)?parseFloat(by):aP.test(by)?b.parseJSON(by):by}catch(bz){}b.data(bx,bw,by)}else{by=N}}return by}function W(bv){for(var e in bv){if(e!=="toJSON"){return false}}return true}function bh(by,bx,bA){var bw=bx+"defer",bv=bx+"queue",e=bx+"mark",bz=b.data(by,bw,N,true);if(bz&&(bA==="queue"||!b.data(by,bv,N,true))&&(bA==="mark"||!b.data(by,e,N,true))){setTimeout(function(){if(!b.data(by,bv,N,true)&&!b.data(by,e,N,true)){b.removeData(by,bw,true);bz.resolve()}},0)}}b.extend({_mark:function(bv,e){if(bv){e=(e||"fx")+"mark";b.data(bv,e,(b.data(bv,e,N,true)||0)+1,true)}},_unmark:function(by,bx,bv){if(by!==true){bv=bx;bx=by;by=false}if(bx){bv=bv||"fx";var e=bv+"mark",bw=by?0:((b.data(bx,e,N,true)||1)-1);if(bw){b.data(bx,e,bw,true)}else{b.removeData(bx,e,true);bh(bx,bv,"mark")}}},queue:function(bv,e,bx){if(bv){e=(e||"fx")+"queue";var bw=b.data(bv,e,N,true);if(bx){if(!bw||b.isArray(bx)){bw=b.data(bv,e,b.makeArray(bx),true)}else{bw.push(bx)}}return bw||[]}},dequeue:function(bx,bw){bw=bw||"fx";var e=b.queue(bx,bw),bv=e.shift(),by;if(bv==="inprogress"){bv=e.shift()}if(bv){if(bw==="fx"){e.unshift("inprogress")}bv.call(bx,function(){b.dequeue(bx,bw)})}if(!e.length){b.removeData(bx,bw+"queue",true);bh(bx,bw,"queue")}}});b.fn.extend({queue:function(e,bv){if(typeof e!=="string"){bv=e;e="fx"}if(bv===N){return b.queue(this[0],e)}return this.each(function(){var bw=b.queue(this,e,bv);if(e==="fx"&&bw[0]!=="inprogress"){b.dequeue(this,e)}})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(bv,e){bv=b.fx?b.fx.speeds[bv]||bv:bv;e=e||"fx";return this.queue(e,function(){var bw=this;setTimeout(function(){b.dequeue(bw,e)},bv)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(bD,bw){if(typeof bD!=="string"){bw=bD;bD=N}bD=bD||"fx";var e=b.Deferred(),bv=this,by=bv.length,bB=1,bz=bD+"defer",bA=bD+"queue",bC=bD+"mark",bx;function bE(){if(!(--bB)){e.resolveWith(bv,[bv])}}while(by--){if((bx=b.data(bv[by],bz,N,true)||(b.data(bv[by],bA,N,true)||b.data(bv[by],bC,N,true))&&b.data(bv[by],bz,b._Deferred(),true))){bB++;bx.done(bE)}}bE();return e.promise()}});var aN=/[\n\t\r]/g,af=/\s+/,aR=/\r/g,h=/^(?:button|input)$/i,G=/^(?:button|input|object|select|textarea)$/i,n=/^a(?:rea)?$/i,an=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,a8=/\:|^on/,a3,aX;b.fn.extend({attr:function(e,bv){return b.access(this,e,bv,true,b.attr)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,bv){return b.access(this,e,bv,true,b.prop)},removeProp:function(e){e=b.propFix[e]||e;return this.each(function(){try{this[e]=N;delete this[e]}catch(bv){}})},addClass:function(by){var bA,bw,bv,bx,bz,bB,e;if(b.isFunction(by)){return this.each(function(bC){b(this).addClass(by.call(this,bC,this.className))})}if(by&&typeof by==="string"){bA=by.split(af);for(bw=0,bv=this.length;bw<bv;bw++){bx=this[bw];if(bx.nodeType===1){if(!bx.className&&bA.length===1){bx.className=by}else{bz=" "+bx.className+" ";for(bB=0,e=bA.length;bB<e;bB++){if(!~bz.indexOf(" "+bA[bB]+" ")){bz+=bA[bB]+" "}}bx.className=b.trim(bz)}}}}return this},removeClass:function(bz){var bA,bw,bv,by,bx,bB,e;if(b.isFunction(bz)){return this.each(function(bC){b(this).removeClass(bz.call(this,bC,this.className))})}if((bz&&typeof bz==="string")||bz===N){bA=(bz||"").split(af);for(bw=0,bv=this.length;bw<bv;bw++){by=this[bw];if(by.nodeType===1&&by.className){if(bz){bx=(" "+by.className+" ").replace(aN," ");for(bB=0,e=bA.length;bB<e;bB++){bx=bx.replace(" "+bA[bB]+" "," ")}by.className=b.trim(bx)}else{by.className=""}}}}return this},toggleClass:function(bx,bv){var bw=typeof bx,e=typeof bv==="boolean";if(b.isFunction(bx)){return this.each(function(by){b(this).toggleClass(bx.call(this,by,this.className,bv),bv)})}return this.each(function(){if(bw==="string"){var bA,bz=0,by=b(this),bB=bv,bC=bx.split(af);while((bA=bC[bz++])){bB=e?bB:!by.hasClass(bA);by[bB?"addClass":"removeClass"](bA)}}else{if(bw==="undefined"||bw==="boolean"){if(this.className){b._data(this,"__className__",this.className)}this.className=this.className||bx===false?"":b._data(this,"__className__")||""}}})},hasClass:function(e){var bx=" "+e+" ";for(var bw=0,bv=this.length;bw<bv;bw++){if((" "+this[bw].className+" ").replace(aN," ").indexOf(bx)>-1){return true}}return false},val:function(bx){var e,bv,bw=this[0];if(!arguments.length){if(bw){e=b.valHooks[bw.nodeName.toLowerCase()]||b.valHooks[bw.type];if(e&&"get" in e&&(bv=e.get(bw,"value"))!==N){return bv}bv=bw.value;return typeof bv==="string"?bv.replace(aR,""):bv==null?"":bv}return N}var by=b.isFunction(bx);return this.each(function(bA){var bz=b(this),bB;if(this.nodeType!==1){return}if(by){bB=bx.call(this,bA,bz.val())}else{bB=bx}if(bB==null){bB=""}else{if(typeof bB==="number"){bB+=""}else{if(b.isArray(bB)){bB=b.map(bB,function(bC){return bC==null?"":bC+""})}}}e=b.valHooks[this.nodeName.toLowerCase()]||b.valHooks[this.type];if(!e||!("set" in e)||e.set(this,bB,"value")===N){this.value=bB}})}});b.extend({valHooks:{option:{get:function(e){var bv=e.attributes.value;return !bv||bv.specified?e.value:e.text}},select:{get:function(e){var bA,by=e.selectedIndex,bB=[],bC=e.options,bx=e.type==="select-one";if(by<0){return null}for(var bv=bx?by:0,bz=bx?by+1:bC.length;bv<bz;bv++){var bw=bC[bv];if(bw.selected&&(b.support.optDisabled?!bw.disabled:bw.getAttribute("disabled")===null)&&(!bw.parentNode.disabled||!b.nodeName(bw.parentNode,"optgroup"))){bA=b(bw).val();if(bx){return bA}bB.push(bA)}}if(bx&&!bB.length&&bC.length){return b(bC[by]).val()}return bB},set:function(bv,bw){var e=b.makeArray(bw);b(bv).find("option").each(function(){this.selected=b.inArray(b(this).val(),e)>=0});if(!e.length){bv.selectedIndex=-1}return e}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attrFix:{tabindex:"tabIndex"},attr:function(bA,bx,bB,bz){var bv=bA.nodeType;if(!bA||bv===3||bv===8||bv===2){return N}if(bz&&bx in b.attrFn){return b(bA)[bx](bB)}if(!("getAttribute" in bA)){return b.prop(bA,bx,bB)}var bw,e,by=bv!==1||!b.isXMLDoc(bA);if(by){bx=b.attrFix[bx]||bx;e=b.attrHooks[bx];if(!e){if(an.test(bx)){e=aX}else{if(a3&&bx!=="className"&&(b.nodeName(bA,"form")||a8.test(bx))){e=a3}}}}if(bB!==N){if(bB===null){b.removeAttr(bA,bx);return N}else{if(e&&"set" in e&&by&&(bw=e.set(bA,bB,bx))!==N){return bw}else{bA.setAttribute(bx,""+bB);return bB}}}else{if(e&&"get" in e&&by&&(bw=e.get(bA,bx))!==null){return bw}else{bw=bA.getAttribute(bx);return bw===null?N:bw}}},removeAttr:function(bv,e){var bw;if(bv.nodeType===1){e=b.attrFix[e]||e;if(b.support.getSetAttribute){bv.removeAttribute(e)}else{b.attr(bv,e,"");bv.removeAttributeNode(bv.getAttributeNode(e))}if(an.test(e)&&(bw=b.propFix[e]||e) in bv){bv[bw]=false}}},attrHooks:{type:{set:function(e,bv){if(h.test(e.nodeName)&&e.parentNode){b.error("type property can't be changed")}else{if(!b.support.radioValue&&bv==="radio"&&b.nodeName(e,"input")){var bw=e.value;e.setAttribute("type",bv);if(bw){e.value=bw}return bv}}}},tabIndex:{get:function(bv){var e=bv.getAttributeNode("tabIndex");return e&&e.specified?parseInt(e.value,10):G.test(bv.nodeName)||n.test(bv.nodeName)&&bv.href?0:N}},value:{get:function(bv,e){if(a3&&b.nodeName(bv,"button")){return a3.get(bv,e)}return e in bv?bv.value:null},set:function(bv,bw,e){if(a3&&b.nodeName(bv,"button")){return a3.set(bv,bw,e)}bv.value=bw}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(bz,bx,bA){var bv=bz.nodeType;if(!bz||bv===3||bv===8||bv===2){return N}var bw,e,by=bv!==1||!b.isXMLDoc(bz);if(by){bx=b.propFix[bx]||bx;e=b.propHooks[bx]}if(bA!==N){if(e&&"set" in e&&(bw=e.set(bz,bA,bx))!==N){return bw}else{return(bz[bx]=bA)}}else{if(e&&"get" in e&&(bw=e.get(bz,bx))!==N){return bw}else{return bz[bx]}}},propHooks:{}});aX={get:function(bv,e){return b.prop(bv,e)?e.toLowerCase():N},set:function(bv,bx,e){var bw;if(bx===false){b.removeAttr(bv,e)}else{bw=b.propFix[e]||e;if(bw in bv){bv[bw]=true}bv.setAttribute(e,e.toLowerCase())}return e}};if(!b.support.getSetAttribute){b.attrFix=b.propFix;a3=b.attrHooks.name=b.attrHooks.title=b.valHooks.button={get:function(bw,bv){var e;e=bw.getAttributeNode(bv);return e&&e.nodeValue!==""?e.nodeValue:N},set:function(bw,bx,bv){var e=bw.getAttributeNode(bv);if(e){e.nodeValue=bx;return bx}}};b.each(["width","height"],function(bv,e){b.attrHooks[e]=b.extend(b.attrHooks[e],{set:function(bw,bx){if(bx===""){bw.setAttribute(e,"auto");return bx}}})})}if(!b.support.hrefNormalized){b.each(["href","src","width","height"],function(bv,e){b.attrHooks[e]=b.extend(b.attrHooks[e],{get:function(bx){var bw=bx.getAttribute(e,2);return bw===null?N:bw}})})}if(!b.support.style){b.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||N},set:function(e,bv){return(e.style.cssText=""+bv)}}}if(!b.support.optSelected){b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(bv){var e=bv.parentNode;if(e){e.selectedIndex;if(e.parentNode){e.parentNode.selectedIndex}}}})}if(!b.support.checkOn){b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}})}b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,bv){if(b.isArray(bv)){return(e.checked=b.inArray(b(e).val(),bv)>=0)}}})});var aZ=/\.(.*)$/,be=/^(?:textarea|input|select)$/i,Q=/\./g,bi=/ /g,aF=/[^\w\s.|`]/g,J=function(e){return e.replace(aF,"\\$&")};b.event={add:function(bx,bB,bG,bz){if(bx.nodeType===3||bx.nodeType===8){return}if(bG===false){bG=bk}else{if(!bG){return}}var bv,bF;if(bG.handler){bv=bG;bG=bv.handler}if(!bG.guid){bG.guid=b.guid++}var bC=b._data(bx);if(!bC){return}var bH=bC.events,bA=bC.handle;if(!bH){bC.events=bH={}}if(!bA){bC.handle=bA=function(bI){return typeof b!=="undefined"&&(!bI||b.event.triggered!==bI.type)?b.event.handle.apply(bA.elem,arguments):N}}bA.elem=bx;bB=bB.split(" ");var bE,by=0,e;while((bE=bB[by++])){bF=bv?b.extend({},bv):{handler:bG,data:bz};if(bE.indexOf(".")>-1){e=bE.split(".");bE=e.shift();bF.namespace=e.slice(0).sort().join(".")}else{e=[];bF.namespace=""}bF.type=bE;if(!bF.guid){bF.guid=bG.guid}var bw=bH[bE],bD=b.event.special[bE]||{};if(!bw){bw=bH[bE]=[];if(!bD.setup||bD.setup.call(bx,bz,e,bA)===false){if(bx.addEventListener){bx.addEventListener(bE,bA,false)}else{if(bx.attachEvent){bx.attachEvent("on"+bE,bA)}}}}if(bD.add){bD.add.call(bx,bF);if(!bF.handler.guid){bF.handler.guid=bG.guid}}bw.push(bF);b.event.global[bE]=true}bx=null},global:{},remove:function(bJ,bE,bw,bA){if(bJ.nodeType===3||bJ.nodeType===8){return}if(bw===false){bw=bk}var bM,bz,bB,bG,bH=0,bx,bC,bF,by,bD,e,bL,bI=b.hasData(bJ)&&b._data(bJ),bv=bI&&bI.events;if(!bI||!bv){return}if(bE&&bE.type){bw=bE.handler;bE=bE.type}if(!bE||typeof bE==="string"&&bE.charAt(0)==="."){bE=bE||"";for(bz in bv){b.event.remove(bJ,bz+bE)}return}bE=bE.split(" ");while((bz=bE[bH++])){bL=bz;e=null;bx=bz.indexOf(".")<0;bC=[];if(!bx){bC=bz.split(".");bz=bC.shift();bF=new RegExp("(^|\\.)"+b.map(bC.slice(0).sort(),J).join("\\.(?:.*\\.)?")+"(\\.|$)")}bD=bv[bz];if(!bD){continue}if(!bw){for(bG=0;bG<bD.length;bG++){e=bD[bG];if(bx||bF.test(e.namespace)){b.event.remove(bJ,bL,e.handler,bG);bD.splice(bG--,1)}}continue}by=b.event.special[bz]||{};for(bG=bA||0;bG<bD.length;bG++){e=bD[bG];if(bw.guid===e.guid){if(bx||bF.test(e.namespace)){if(bA==null){bD.splice(bG--,1)}if(by.remove){by.remove.call(bJ,e)}}if(bA!=null){break}}}if(bD.length===0||bA!=null&&bD.length===1){if(!by.teardown||by.teardown.call(bJ,bC)===false){b.removeEvent(bJ,bz,bI.handle)}bM=null;delete bv[bz]}}if(b.isEmptyObject(bv)){var bK=bI.handle;if(bK){bK.elem=null}delete bI.events;delete bI.handle;if(b.isEmptyObject(bI)){b.removeData(bJ,N,true)}}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(e,bB,bz,bG){var bE=e.type||e,bw=[],bv;if(bE.indexOf("!")>=0){bE=bE.slice(0,-1);bv=true}if(bE.indexOf(".")>=0){bw=bE.split(".");bE=bw.shift();bw.sort()}if((!bz||b.event.customEvent[bE])&&!b.event.global[bE]){return}e=typeof e==="object"?e[b.expando]?e:new b.Event(bE,e):new b.Event(bE);e.type=bE;e.exclusive=bv;e.namespace=bw.join(".");e.namespace_re=new RegExp("(^|\\.)"+bw.join("\\.(?:.*\\.)?")+"(\\.|$)");if(bG||!bz){e.preventDefault();e.stopPropagation()}if(!bz){b.each(b.cache,function(){var bI=b.expando,bH=this[bI];if(bH&&bH.events&&bH.events[bE]){b.event.trigger(e,bB,bH.handle.elem)}});return}if(bz.nodeType===3||bz.nodeType===8){return}e.result=N;e.target=bz;bB=bB!=null?b.makeArray(bB):[];bB.unshift(e);var bF=bz,bx=bE.indexOf(":")<0?"on"+bE:"";do{var bC=b._data(bF,"handle");e.currentTarget=bF;if(bC){bC.apply(bF,bB)}if(bx&&b.acceptData(bF)&&bF[bx]&&bF[bx].apply(bF,bB)===false){e.result=false;e.preventDefault()}bF=bF.parentNode||bF.ownerDocument||bF===e.target.ownerDocument&&bc}while(bF&&!e.isPropagationStopped());if(!e.isDefaultPrevented()){var by,bD=b.event.special[bE]||{};if((!bD._default||bD._default.call(bz.ownerDocument,e)===false)&&!(bE==="click"&&b.nodeName(bz,"a"))&&b.acceptData(bz)){try{if(bx&&bz[bE]){by=bz[bx];if(by){bz[bx]=null}b.event.triggered=bE;bz[bE]()}}catch(bA){}if(by){bz[bx]=by}b.event.triggered=N}}return e.result},handle:function(bB){bB=b.event.fix(bB||bc.event);var bv=((b._data(this,"events")||{})[bB.type]||[]).slice(0),bA=!bB.exclusive&&!bB.namespace,by=Array.prototype.slice.call(arguments,0);by[0]=bB;bB.currentTarget=this;for(var bx=0,e=bv.length;bx<e;bx++){var bz=bv[bx];if(bA||bB.namespace_re.test(bz.namespace)){bB.handler=bz.handler;bB.data=bz.data;bB.handleObj=bz;var bw=bz.handler.apply(this,by);if(bw!==N){bB.result=bw;if(bw===false){bB.preventDefault();bB.stopPropagation()}}if(bB.isImmediatePropagationStopped()){break}}}return bB.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(by){if(by[b.expando]){return by}var bv=by;by=b.Event(bv);for(var bw=this.props.length,bA;bw;){bA=this.props[--bw];by[bA]=bv[bA]}if(!by.target){by.target=by.srcElement||au}if(by.target.nodeType===3){by.target=by.target.parentNode}if(!by.relatedTarget&&by.fromElement){by.relatedTarget=by.fromElement===by.target?by.toElement:by.fromElement}if(by.pageX==null&&by.clientX!=null){var bx=by.target.ownerDocument||au,bz=bx.documentElement,e=bx.body;by.pageX=by.clientX+(bz&&bz.scrollLeft||e&&e.scrollLeft||0)-(bz&&bz.clientLeft||e&&e.clientLeft||0);by.pageY=by.clientY+(bz&&bz.scrollTop||e&&e.scrollTop||0)-(bz&&bz.clientTop||e&&e.clientTop||0)}if(by.which==null&&(by.charCode!=null||by.keyCode!=null)){by.which=by.charCode!=null?by.charCode:by.keyCode}if(!by.metaKey&&by.ctrlKey){by.metaKey=by.ctrlKey}if(!by.which&&by.button!==N){by.which=(by.button&1?1:(by.button&2?3:(by.button&4?2:0)))}return by},guid:100000000,proxy:b.proxy,special:{ready:{setup:b.bindReady,teardown:b.noop},live:{add:function(e){b.event.add(this,s(e.origType,e.selector),b.extend({},e,{handler:al,guid:e.handler.guid}))},remove:function(e){b.event.remove(this,s(e.origType,e.selector),e)}},beforeunload:{setup:function(bw,bv,e){if(b.isWindow(this)){this.onbeforeunload=e}},teardown:function(bv,e){if(this.onbeforeunload===e){this.onbeforeunload=null}}}}};b.removeEvent=au.removeEventListener?function(bv,e,bw){if(bv.removeEventListener){bv.removeEventListener(e,bw,false)}}:function(bv,e,bw){if(bv.detachEvent){bv.detachEvent("on"+e,bw)}};b.Event=function(bv,e){if(!this.preventDefault){return new b.Event(bv,e)}if(bv&&bv.type){this.originalEvent=bv;this.type=bv.type;this.isDefaultPrevented=(bv.defaultPrevented||bv.returnValue===false||bv.getPreventDefault&&bv.getPreventDefault())?k:bk}else{this.type=bv}if(e){b.extend(this,e)}this.timeStamp=b.now();this[b.expando]=true};function bk(){return false}function k(){return true}b.Event.prototype={preventDefault:function(){this.isDefaultPrevented=k;var bv=this.originalEvent;if(!bv){return}if(bv.preventDefault){bv.preventDefault()}else{bv.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=k;var bv=this.originalEvent;if(!bv){return}if(bv.stopPropagation){bv.stopPropagation()}bv.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=k;this.stopPropagation()},isDefaultPrevented:bk,isPropagationStopped:bk,isImmediatePropagationStopped:bk};var ae=function(bw){var bx=bw.relatedTarget,e=false,bv=bw.type;bw.type=bw.data;if(bx!==this){if(bx){e=b.contains(this,bx)}if(!e){b.event.handle.apply(this,arguments);bw.type=bv}}},aU=function(e){e.type=e.data;b.event.handle.apply(this,arguments)};b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(bv,e){b.event.special[bv]={setup:function(bw){b.event.add(this,e,bw&&bw.selector?aU:ae,bv)},teardown:function(bw){b.event.remove(this,e,bw&&bw.selector?aU:ae)}}});if(!b.support.submitBubbles){b.event.special.submit={setup:function(bv,e){if(!b.nodeName(this,"form")){b.event.add(this,"click.specialSubmit",function(by){var bx=by.target,bw=bx.type;if((bw==="submit"||bw==="image")&&b(bx).closest("form").length){aW("submit",this,arguments)}});b.event.add(this,"keypress.specialSubmit",function(by){var bx=by.target,bw=bx.type;if((bw==="text"||bw==="password")&&b(bx).closest("form").length&&by.keyCode===13){aW("submit",this,arguments)}})}else{return false}},teardown:function(e){b.event.remove(this,".specialSubmit")}}}if(!b.support.changeBubbles){var bn,m=function(bv){var e=bv.type,bw=bv.value;if(e==="radio"||e==="checkbox"){bw=bv.checked}else{if(e==="select-multiple"){bw=bv.selectedIndex>-1?b.map(bv.options,function(bx){return bx.selected}).join("-"):""}else{if(b.nodeName(bv,"select")){bw=bv.selectedIndex}}}return bw},ac=function ac(bx){var bv=bx.target,bw,by;if(!be.test(bv.nodeName)||bv.readOnly){return}bw=b._data(bv,"_change_data");by=m(bv);if(bx.type!=="focusout"||bv.type!=="radio"){b._data(bv,"_change_data",by)}if(bw===N||by===bw){return}if(bw!=null||by){bx.type="change";bx.liveFired=N;b.event.trigger(bx,arguments[1],bv)}};b.event.special.change={filters:{focusout:ac,beforedeactivate:ac,click:function(bx){var bw=bx.target,bv=b.nodeName(bw,"input")?bw.type:"";if(bv==="radio"||bv==="checkbox"||b.nodeName(bw,"select")){ac.call(this,bx)}},keydown:function(bx){var bw=bx.target,bv=b.nodeName(bw,"input")?bw.type:"";if((bx.keyCode===13&&!b.nodeName(bw,"textarea"))||(bx.keyCode===32&&(bv==="checkbox"||bv==="radio"))||bv==="select-multiple"){ac.call(this,bx)}},beforeactivate:function(bw){var bv=bw.target;b._data(bv,"_change_data",m(bv))}},setup:function(bw,bv){if(this.type==="file"){return false}for(var e in bn){b.event.add(this,e+".specialChange",bn[e])}return be.test(this.nodeName)},teardown:function(e){b.event.remove(this,".specialChange");return be.test(this.nodeName)}};bn=b.event.special.change.filters;bn.focus=bn.beforeactivate}function aW(bv,bx,e){var bw=b.extend({},e[0]);bw.type=bv;bw.originalEvent={};bw.liveFired=N;b.event.handle.call(bx,bw);if(bw.isDefaultPrevented()){e[0].preventDefault()}}if(!b.support.focusinBubbles){b.each({focus:"focusin",blur:"focusout"},function(bx,e){var bv=0;b.event.special[e]={setup:function(){if(bv++===0){au.addEventListener(bx,bw,true)}},teardown:function(){if(--bv===0){au.removeEventListener(bx,bw,true)}}};function bw(by){var bz=b.event.fix(by);bz.type=e;bz.originalEvent={};b.event.trigger(bz,null,bz.target);if(bz.isDefaultPrevented()){by.preventDefault()}}})}b.each(["bind","one"],function(bv,e){b.fn[e]=function(bB,bC,bA){var bz;if(typeof bB==="object"){for(var by in bB){this[e](by,bC,bB[by],bA)}return this}if(arguments.length===2||bC===false){bA=bC;bC=N}if(e==="one"){bz=function(bD){b(this).unbind(bD,bz);return bA.apply(this,arguments)};bz.guid=bA.guid||b.guid++}else{bz=bA}if(bB==="unload"&&e!=="one"){this.one(bB,bC,bA)}else{for(var bx=0,bw=this.length;bx<bw;bx++){b.event.add(this[bx],bB,bz,bC)}}return this}});b.fn.extend({unbind:function(by,bx){if(typeof by==="object"&&!by.preventDefault){for(var bw in by){this.unbind(bw,by[bw])}}else{for(var bv=0,e=this.length;bv<e;bv++){b.event.remove(this[bv],by,bx)}}return this},delegate:function(e,bv,bx,bw){return this.live(bv,bx,bw,e)},undelegate:function(e,bv,bw){if(arguments.length===0){return this.unbind("live")}else{return this.die(bv,null,bw,e)}},trigger:function(e,bv){return this.each(function(){b.event.trigger(e,bv,this)})},triggerHandler:function(e,bv){if(this[0]){return b.event.trigger(e,bv,this[0],true)}},toggle:function(bx){var bv=arguments,e=bx.guid||b.guid++,bw=0,by=function(bz){var bA=(b.data(this,"lastToggle"+bx.guid)||0)%bw;b.data(this,"lastToggle"+bx.guid,bA+1);bz.preventDefault();return bv[bA].apply(this,arguments)||false};by.guid=e;while(bw<bv.length){bv[bw++].guid=e}return this.click(by)},hover:function(e,bv){return this.mouseenter(e).mouseleave(bv||e)}});var aS={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};b.each(["live","die"],function(bv,e){b.fn[e]=function(bF,bC,bH,by){var bG,bD=0,bE,bx,bJ,bA=by||this.selector,bw=by?this:b(this.context);if(typeof bF==="object"&&!bF.preventDefault){for(var bI in bF){bw[e](bI,bC,bF[bI],bA)}return this}if(e==="die"&&!bF&&by&&by.charAt(0)==="."){bw.unbind(by);return this}if(bC===false||b.isFunction(bC)){bH=bC||bk;bC=N}bF=(bF||"").split(" ");while((bG=bF[bD++])!=null){bE=aZ.exec(bG);bx="";if(bE){bx=bE[0];bG=bG.replace(aZ,"")}if(bG==="hover"){bF.push("mouseenter"+bx,"mouseleave"+bx);continue}bJ=bG;if(aS[bG]){bF.push(aS[bG]+bx);bG=bG+bx}else{bG=(aS[bG]||bG)+bx}if(e==="live"){for(var bB=0,bz=bw.length;bB<bz;bB++){b.event.add(bw[bB],"live."+s(bG,bA),{data:bC,selector:bA,handler:bH,origType:bG,origHandler:bH,preType:bJ})}}else{bw.unbind("live."+s(bG,bA),bH)}}return this}});function al(bF){var bC,bx,bL,bz,e,bH,bE,bG,bD,bK,bB,bA,bJ,bI=[],by=[],bv=b._data(this,"events");if(bF.liveFired===this||!bv||!bv.live||bF.target.disabled||bF.button&&bF.type==="click"){return}if(bF.namespace){bA=new RegExp("(^|\\.)"+bF.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)")}bF.liveFired=this;var bw=bv.live.slice(0);for(bE=0;bE<bw.length;bE++){e=bw[bE];if(e.origType.replace(aZ,"")===bF.type){by.push(e.selector)}else{bw.splice(bE--,1)}}bz=b(bF.target).closest(by,bF.currentTarget);for(bG=0,bD=bz.length;bG<bD;bG++){bB=bz[bG];for(bE=0;bE<bw.length;bE++){e=bw[bE];if(bB.selector===e.selector&&(!bA||bA.test(e.namespace))&&!bB.elem.disabled){bH=bB.elem;bL=null;if(e.preType==="mouseenter"||e.preType==="mouseleave"){bF.type=e.preType;bL=b(bF.relatedTarget).closest(e.selector)[0];if(bL&&b.contains(bH,bL)){bL=bH}}if(!bL||bL!==bH){bI.push({elem:bH,handleObj:e,level:bB.level})}}}}for(bG=0,bD=bI.length;bG<bD;bG++){bz=bI[bG];if(bx&&bz.level>bx){break}bF.currentTarget=bz.elem;bF.data=bz.handleObj.data;bF.handleObj=bz.handleObj;bJ=bz.handleObj.origHandler.apply(bz.elem,arguments);if(bJ===false||bF.isPropagationStopped()){bx=bz.level;if(bJ===false){bC=false}if(bF.isImmediatePropagationStopped()){break}}}return bC}function s(bv,e){return(bv&&bv!=="*"?bv+".":"")+e.replace(Q,"`").replace(bi,"&")}b.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error").split(" "),function(bv,e){b.fn[e]=function(bx,bw){if(bw==null){bw=bx;bx=null}return arguments.length>0?this.bind(e,bx,bw):this.trigger(e)};if(b.attrFn){b.attrFn[e]=true}});
/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var bF=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,bG=0,bJ=Object.prototype.toString,bA=false,bz=true,bH=/\\/g,bN=/\W/;[0,0].sort(function(){bz=false;return 0});var bx=function(bS,e,bV,bW){bV=bV||[];e=e||au;var bY=e;if(e.nodeType!==1&&e.nodeType!==9){return[]}if(!bS||typeof bS!=="string"){return bV}var bP,b0,b3,bO,bZ,b2,b1,bU,bR=true,bQ=bx.isXML(e),bT=[],bX=bS;do{bF.exec("");bP=bF.exec(bX);if(bP){bX=bP[3];bT.push(bP[1]);if(bP[2]){bO=bP[3];break}}}while(bP);if(bT.length>1&&bB.exec(bS)){if(bT.length===2&&bC.relative[bT[0]]){b0=bK(bT[0]+bT[1],e)}else{b0=bC.relative[bT[0]]?[e]:bx(bT.shift(),e);while(bT.length){bS=bT.shift();if(bC.relative[bS]){bS+=bT.shift()}b0=bK(bS,b0)}}}else{if(!bW&&bT.length>1&&e.nodeType===9&&!bQ&&bC.match.ID.test(bT[0])&&!bC.match.ID.test(bT[bT.length-1])){bZ=bx.find(bT.shift(),e,bQ);e=bZ.expr?bx.filter(bZ.expr,bZ.set)[0]:bZ.set[0]}if(e){bZ=bW?{expr:bT.pop(),set:bD(bW)}:bx.find(bT.pop(),bT.length===1&&(bT[0]==="~"||bT[0]==="+")&&e.parentNode?e.parentNode:e,bQ);b0=bZ.expr?bx.filter(bZ.expr,bZ.set):bZ.set;if(bT.length>0){b3=bD(b0)}else{bR=false}while(bT.length){b2=bT.pop();b1=b2;if(!bC.relative[b2]){b2=""}else{b1=bT.pop()}if(b1==null){b1=e}bC.relative[b2](b3,b1,bQ)}}else{b3=bT=[]}}if(!b3){b3=b0}if(!b3){bx.error(b2||bS)}if(bJ.call(b3)==="[object Array]"){if(!bR){bV.push.apply(bV,b3)}else{if(e&&e.nodeType===1){for(bU=0;b3[bU]!=null;bU++){if(b3[bU]&&(b3[bU]===true||b3[bU].nodeType===1&&bx.contains(e,b3[bU]))){bV.push(b0[bU])}}}else{for(bU=0;b3[bU]!=null;bU++){if(b3[bU]&&b3[bU].nodeType===1){bV.push(b0[bU])}}}}}else{bD(b3,bV)}if(bO){bx(bO,bY,bV,bW);bx.uniqueSort(bV)}return bV};bx.uniqueSort=function(bO){if(bI){bA=bz;bO.sort(bI);if(bA){for(var e=1;e<bO.length;e++){if(bO[e]===bO[e-1]){bO.splice(e--,1)}}}}return bO};bx.matches=function(e,bO){return bx(e,null,null,bO)};bx.matchesSelector=function(e,bO){return bx(bO,null,null,[e]).length>0};bx.find=function(bU,e,bV){var bT;if(!bU){return[]}for(var bQ=0,bP=bC.order.length;bQ<bP;bQ++){var bR,bS=bC.order[bQ];if((bR=bC.leftMatch[bS].exec(bU))){var bO=bR[1];bR.splice(1,1);if(bO.substr(bO.length-1)!=="\\"){bR[1]=(bR[1]||"").replace(bH,"");bT=bC.find[bS](bR,e,bV);if(bT!=null){bU=bU.replace(bC.match[bS],"");break}}}}if(!bT){bT=typeof e.getElementsByTagName!=="undefined"?e.getElementsByTagName("*"):[]}return{set:bT,expr:bU}};bx.filter=function(bY,bX,b1,bR){var bT,e,bP=bY,b3=[],bV=bX,bU=bX&&bX[0]&&bx.isXML(bX[0]);while(bY&&bX.length){for(var bW in bC.filter){if((bT=bC.leftMatch[bW].exec(bY))!=null&&bT[2]){var b2,b0,bO=bC.filter[bW],bQ=bT[1];e=false;bT.splice(1,1);if(bQ.substr(bQ.length-1)==="\\"){continue}if(bV===b3){b3=[]}if(bC.preFilter[bW]){bT=bC.preFilter[bW](bT,bV,b1,b3,bR,bU);if(!bT){e=b2=true}else{if(bT===true){continue}}}if(bT){for(var bS=0;(b0=bV[bS])!=null;bS++){if(b0){b2=bO(b0,bT,bS,bV);var bZ=bR^!!b2;if(b1&&b2!=null){if(bZ){e=true}else{bV[bS]=false}}else{if(bZ){b3.push(b0);e=true}}}}}if(b2!==N){if(!b1){bV=b3}bY=bY.replace(bC.match[bW],"");if(!e){return[]}break}}}if(bY===bP){if(e==null){bx.error(bY)}else{break}}bP=bY}return bV};bx.error=function(e){throw"Syntax error, unrecognized expression: "+e};var bC=bx.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")},type:function(e){return e.getAttribute("type")}},relative:{"+":function(bT,bO){var bQ=typeof bO==="string",bS=bQ&&!bN.test(bO),bU=bQ&&!bS;if(bS){bO=bO.toLowerCase()}for(var bP=0,e=bT.length,bR;bP<e;bP++){if((bR=bT[bP])){while((bR=bR.previousSibling)&&bR.nodeType!==1){}bT[bP]=bU||bR&&bR.nodeName.toLowerCase()===bO?bR||false:bR===bO}}if(bU){bx.filter(bO,bT,true)}},">":function(bT,bO){var bS,bR=typeof bO==="string",bP=0,e=bT.length;if(bR&&!bN.test(bO)){bO=bO.toLowerCase();for(;bP<e;bP++){bS=bT[bP];if(bS){var bQ=bS.parentNode;bT[bP]=bQ.nodeName.toLowerCase()===bO?bQ:false}}}else{for(;bP<e;bP++){bS=bT[bP];if(bS){bT[bP]=bR?bS.parentNode:bS.parentNode===bO}}if(bR){bx.filter(bO,bT,true)}}},"":function(bQ,bO,bS){var bR,bP=bG++,e=bL;if(typeof bO==="string"&&!bN.test(bO)){bO=bO.toLowerCase();bR=bO;e=bv}e("parentNode",bO,bP,bQ,bR,bS)},"~":function(bQ,bO,bS){var bR,bP=bG++,e=bL;if(typeof bO==="string"&&!bN.test(bO)){bO=bO.toLowerCase();bR=bO;e=bv}e("previousSibling",bO,bP,bQ,bR,bS)}},find:{ID:function(bO,bP,bQ){if(typeof bP.getElementById!=="undefined"&&!bQ){var e=bP.getElementById(bO[1]);return e&&e.parentNode?[e]:[]}},NAME:function(bP,bS){if(typeof bS.getElementsByName!=="undefined"){var bO=[],bR=bS.getElementsByName(bP[1]);for(var bQ=0,e=bR.length;bQ<e;bQ++){if(bR[bQ].getAttribute("name")===bP[1]){bO.push(bR[bQ])}}return bO.length===0?null:bO}},TAG:function(e,bO){if(typeof bO.getElementsByTagName!=="undefined"){return bO.getElementsByTagName(e[1])}}},preFilter:{CLASS:function(bQ,bO,bP,e,bT,bU){bQ=" "+bQ[1].replace(bH,"")+" ";if(bU){return bQ}for(var bR=0,bS;(bS=bO[bR])!=null;bR++){if(bS){if(bT^(bS.className&&(" "+bS.className+" ").replace(/[\t\n\r]/g," ").indexOf(bQ)>=0)){if(!bP){e.push(bS)}}else{if(bP){bO[bR]=false}}}}return false},ID:function(e){return e[1].replace(bH,"")},TAG:function(bO,e){return bO[1].replace(bH,"").toLowerCase()},CHILD:function(e){if(e[1]==="nth"){if(!e[2]){bx.error(e[0])}e[2]=e[2].replace(/^\+|\s*/g,"");var bO=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(e[2]==="even"&&"2n"||e[2]==="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=(bO[1]+(bO[2]||1))-0;e[3]=bO[3]-0}else{if(e[2]){bx.error(e[0])}}e[0]=bG++;return e},ATTR:function(bR,bO,bP,e,bS,bT){var bQ=bR[1]=bR[1].replace(bH,"");if(!bT&&bC.attrMap[bQ]){bR[1]=bC.attrMap[bQ]}bR[4]=(bR[4]||bR[5]||"").replace(bH,"");if(bR[2]==="~="){bR[4]=" "+bR[4]+" "}return bR},PSEUDO:function(bR,bO,bP,e,bS){if(bR[1]==="not"){if((bF.exec(bR[3])||"").length>1||/^\w/.test(bR[3])){bR[3]=bx(bR[3],null,null,bO)}else{var bQ=bx.filter(bR[3],bO,bP,true^bS);if(!bP){e.push.apply(e,bQ)}return false}}else{if(bC.match.POS.test(bR[0])||bC.match.CHILD.test(bR[0])){return true}}return bR},POS:function(e){e.unshift(true);return e}},filters:{enabled:function(e){return e.disabled===false&&e.type!=="hidden"},disabled:function(e){return e.disabled===true},checked:function(e){return e.checked===true},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},parent:function(e){return !!e.firstChild},empty:function(e){return !e.firstChild},has:function(bP,bO,e){return !!bx(e[3],bP).length},header:function(e){return(/h\d/i).test(e.nodeName)},text:function(bP){var e=bP.getAttribute("type"),bO=bP.type;return bP.nodeName.toLowerCase()==="input"&&"text"===bO&&(e===bO||e===null)},radio:function(e){return e.nodeName.toLowerCase()==="input"&&"radio"===e.type},checkbox:function(e){return e.nodeName.toLowerCase()==="input"&&"checkbox"===e.type},file:function(e){return e.nodeName.toLowerCase()==="input"&&"file"===e.type},password:function(e){return e.nodeName.toLowerCase()==="input"&&"password"===e.type},submit:function(bO){var e=bO.nodeName.toLowerCase();return(e==="input"||e==="button")&&"submit"===bO.type},image:function(e){return e.nodeName.toLowerCase()==="input"&&"image"===e.type},reset:function(bO){var e=bO.nodeName.toLowerCase();return(e==="input"||e==="button")&&"reset"===bO.type},button:function(bO){var e=bO.nodeName.toLowerCase();return e==="input"&&"button"===bO.type||e==="button"},input:function(e){return(/input|select|textarea|button/i).test(e.nodeName)},focus:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(bO,e){return e===0},last:function(bP,bO,e,bQ){return bO===bQ.length-1},even:function(bO,e){return e%2===0},odd:function(bO,e){return e%2===1},lt:function(bP,bO,e){return bO<e[3]-0},gt:function(bP,bO,e){return bO>e[3]-0},nth:function(bP,bO,e){return e[3]-0===bO},eq:function(bP,bO,e){return e[3]-0===bO}},filter:{PSEUDO:function(bP,bU,bT,bV){var e=bU[1],bO=bC.filters[e];if(bO){return bO(bP,bT,bU,bV)}else{if(e==="contains"){return(bP.textContent||bP.innerText||bx.getText([bP])||"").indexOf(bU[3])>=0}else{if(e==="not"){var bQ=bU[3];for(var bS=0,bR=bQ.length;bS<bR;bS++){if(bQ[bS]===bP){return false}}return true}else{bx.error(e)}}}},CHILD:function(e,bQ){var bT=bQ[1],bO=e;switch(bT){case"only":case"first":while((bO=bO.previousSibling)){if(bO.nodeType===1){return false}}if(bT==="first"){return true}bO=e;case"last":while((bO=bO.nextSibling)){if(bO.nodeType===1){return false}}return true;case"nth":var bP=bQ[2],bW=bQ[3];if(bP===1&&bW===0){return true}var bS=bQ[0],bV=e.parentNode;if(bV&&(bV.sizcache!==bS||!e.nodeIndex)){var bR=0;for(bO=bV.firstChild;bO;bO=bO.nextSibling){if(bO.nodeType===1){bO.nodeIndex=++bR}}bV.sizcache=bS}var bU=e.nodeIndex-bW;if(bP===0){return bU===0}else{return(bU%bP===0&&bU/bP>=0)}}},ID:function(bO,e){return bO.nodeType===1&&bO.getAttribute("id")===e},TAG:function(bO,e){return(e==="*"&&bO.nodeType===1)||bO.nodeName.toLowerCase()===e},CLASS:function(bO,e){return(" "+(bO.className||bO.getAttribute("class"))+" ").indexOf(e)>-1},ATTR:function(bS,bQ){var bP=bQ[1],e=bC.attrHandle[bP]?bC.attrHandle[bP](bS):bS[bP]!=null?bS[bP]:bS.getAttribute(bP),bT=e+"",bR=bQ[2],bO=bQ[4];return e==null?bR==="!=":bR==="="?bT===bO:bR==="*="?bT.indexOf(bO)>=0:bR==="~="?(" "+bT+" ").indexOf(bO)>=0:!bO?bT&&e!==false:bR==="!="?bT!==bO:bR==="^="?bT.indexOf(bO)===0:bR==="$="?bT.substr(bT.length-bO.length)===bO:bR==="|="?bT===bO||bT.substr(0,bO.length+1)===bO+"-":false},POS:function(bR,bO,bP,bS){var e=bO[2],bQ=bC.setFilters[e];if(bQ){return bQ(bR,bP,bO,bS)}}}};var bB=bC.match.POS,bw=function(bO,e){return"\\"+(e-0+1)};for(var by in bC.match){bC.match[by]=new RegExp(bC.match[by].source+(/(?![^\[]*\])(?![^\(]*\))/.source));bC.leftMatch[by]=new RegExp(/(^(?:.|\r|\n)*?)/.source+bC.match[by].source.replace(/\\(\d+)/g,bw))}var bD=function(bO,e){bO=Array.prototype.slice.call(bO,0);if(e){e.push.apply(e,bO);return e}return bO};try{Array.prototype.slice.call(au.documentElement.childNodes,0)[0].nodeType}catch(bM){bD=function(bR,bQ){var bP=0,bO=bQ||[];if(bJ.call(bR)==="[object Array]"){Array.prototype.push.apply(bO,bR)}else{if(typeof bR.length==="number"){for(var e=bR.length;bP<e;bP++){bO.push(bR[bP])}}else{for(;bR[bP];bP++){bO.push(bR[bP])}}}return bO}}var bI,bE;if(au.documentElement.compareDocumentPosition){bI=function(bO,e){if(bO===e){bA=true;return 0}if(!bO.compareDocumentPosition||!e.compareDocumentPosition){return bO.compareDocumentPosition?-1:1}return bO.compareDocumentPosition(e)&4?-1:1}}else{bI=function(bV,bU){if(bV===bU){bA=true;return 0}else{if(bV.sourceIndex&&bU.sourceIndex){return bV.sourceIndex-bU.sourceIndex}}var bS,bO,bP=[],e=[],bR=bV.parentNode,bT=bU.parentNode,bW=bR;if(bR===bT){return bE(bV,bU)}else{if(!bR){return -1}else{if(!bT){return 1}}}while(bW){bP.unshift(bW);bW=bW.parentNode}bW=bT;while(bW){e.unshift(bW);bW=bW.parentNode}bS=bP.length;bO=e.length;for(var bQ=0;bQ<bS&&bQ<bO;bQ++){if(bP[bQ]!==e[bQ]){return bE(bP[bQ],e[bQ])}}return bQ===bS?bE(bV,e[bQ],-1):bE(bP[bQ],bU,1)};bE=function(bO,e,bP){if(bO===e){return bP}var bQ=bO.nextSibling;while(bQ){if(bQ===e){return -1}bQ=bQ.nextSibling}return 1}}bx.getText=function(e){var bO="",bQ;for(var bP=0;e[bP];bP++){bQ=e[bP];if(bQ.nodeType===3||bQ.nodeType===4){bO+=bQ.nodeValue}else{if(bQ.nodeType!==8){bO+=bx.getText(bQ.childNodes)}}}return bO};(function(){var bO=au.createElement("div"),bP="script"+(new Date()).getTime(),e=au.documentElement;bO.innerHTML="<a name='"+bP+"'/>";e.insertBefore(bO,e.firstChild);if(au.getElementById(bP)){bC.find.ID=function(bR,bS,bT){if(typeof bS.getElementById!=="undefined"&&!bT){var bQ=bS.getElementById(bR[1]);return bQ?bQ.id===bR[1]||typeof bQ.getAttributeNode!=="undefined"&&bQ.getAttributeNode("id").nodeValue===bR[1]?[bQ]:N:[]}};bC.filter.ID=function(bS,bQ){var bR=typeof bS.getAttributeNode!=="undefined"&&bS.getAttributeNode("id");return bS.nodeType===1&&bR&&bR.nodeValue===bQ}}e.removeChild(bO);e=bO=null})();(function(){var e=au.createElement("div");e.appendChild(au.createComment(""));if(e.getElementsByTagName("*").length>0){bC.find.TAG=function(bO,bS){var bR=bS.getElementsByTagName(bO[1]);if(bO[1]==="*"){var bQ=[];for(var bP=0;bR[bP];bP++){if(bR[bP].nodeType===1){bQ.push(bR[bP])}}bR=bQ}return bR}}e.innerHTML="<a href='#'></a>";if(e.firstChild&&typeof e.firstChild.getAttribute!=="undefined"&&e.firstChild.getAttribute("href")!=="#"){bC.attrHandle.href=function(bO){return bO.getAttribute("href",2)}}e=null})();if(au.querySelectorAll){(function(){var e=bx,bQ=au.createElement("div"),bP="__sizzle__";bQ.innerHTML="<p class='TEST'></p>";if(bQ.querySelectorAll&&bQ.querySelectorAll(".TEST").length===0){return}bx=function(b1,bS,bW,b0){bS=bS||au;if(!b0&&!bx.isXML(bS)){var bZ=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b1);if(bZ&&(bS.nodeType===1||bS.nodeType===9)){if(bZ[1]){return bD(bS.getElementsByTagName(b1),bW)}else{if(bZ[2]&&bC.find.CLASS&&bS.getElementsByClassName){return bD(bS.getElementsByClassName(bZ[2]),bW)}}}if(bS.nodeType===9){if(b1==="body"&&bS.body){return bD([bS.body],bW)}else{if(bZ&&bZ[3]){var bV=bS.getElementById(bZ[3]);if(bV&&bV.parentNode){if(bV.id===bZ[3]){return bD([bV],bW)}}else{return bD([],bW)}}}try{return bD(bS.querySelectorAll(b1),bW)}catch(bX){}}else{if(bS.nodeType===1&&bS.nodeName.toLowerCase()!=="object"){var bT=bS,bU=bS.getAttribute("id"),bR=bU||bP,b3=bS.parentNode,b2=/^\s*[+~]/.test(b1);if(!bU){bS.setAttribute("id",bR)}else{bR=bR.replace(/'/g,"\\$&")}if(b2&&b3){bS=bS.parentNode}try{if(!b2||b3){return bD(bS.querySelectorAll("[id='"+bR+"'] "+b1),bW)}}catch(bY){}finally{if(!bU){bT.removeAttribute("id")}}}}}return e(b1,bS,bW,b0)};for(var bO in e){bx[bO]=e[bO]}bQ=null})()}(function(){var e=au.documentElement,bP=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;if(bP){var bR=!bP.call(au.createElement("div"),"div"),bO=false;try{bP.call(au.documentElement,"[test!='']:sizzle")}catch(bQ){bO=true}bx.matchesSelector=function(bT,bV){bV=bV.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!bx.isXML(bT)){try{if(bO||!bC.match.PSEUDO.test(bV)&&!/!=/.test(bV)){var bS=bP.call(bT,bV);if(bS||!bR||bT.document&&bT.document.nodeType!==11){return bS}}}catch(bU){}}return bx(bV,null,null,[bT]).length>0}}})();(function(){var e=au.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>";if(!e.getElementsByClassName||e.getElementsByClassName("e").length===0){return}e.lastChild.className="e";if(e.getElementsByClassName("e").length===1){return}bC.order.splice(1,0,"CLASS");bC.find.CLASS=function(bO,bP,bQ){if(typeof bP.getElementsByClassName!=="undefined"&&!bQ){return bP.getElementsByClassName(bO[1])}};e=null})();function bv(bO,bT,bS,bW,bU,bV){for(var bQ=0,bP=bW.length;bQ<bP;bQ++){var e=bW[bQ];if(e){var bR=false;e=e[bO];while(e){if(e.sizcache===bS){bR=bW[e.sizset];break}if(e.nodeType===1&&!bV){e.sizcache=bS;e.sizset=bQ}if(e.nodeName.toLowerCase()===bT){bR=e;break}e=e[bO]}bW[bQ]=bR}}}function bL(bO,bT,bS,bW,bU,bV){for(var bQ=0,bP=bW.length;bQ<bP;bQ++){var e=bW[bQ];if(e){var bR=false;e=e[bO];while(e){if(e.sizcache===bS){bR=bW[e.sizset];break}if(e.nodeType===1){if(!bV){e.sizcache=bS;e.sizset=bQ}if(typeof bT!=="string"){if(e===bT){bR=true;break}}else{if(bx.filter(bT,[e]).length>0){bR=e;break}}}e=e[bO]}bW[bQ]=bR}}}if(au.documentElement.contains){bx.contains=function(bO,e){return bO!==e&&(bO.contains?bO.contains(e):true)}}else{if(au.documentElement.compareDocumentPosition){bx.contains=function(bO,e){return !!(bO.compareDocumentPosition(e)&16)}}else{bx.contains=function(){return false}}}bx.isXML=function(e){var bO=(e?e.ownerDocument||e:0).documentElement;return bO?bO.nodeName!=="HTML":false};var bK=function(e,bU){var bS,bQ=[],bR="",bP=bU.nodeType?[bU]:bU;while((bS=bC.match.PSEUDO.exec(e))){bR+=bS[0];e=e.replace(bC.match.PSEUDO,"")}e=bC.relative[e]?e+"*":e;for(var bT=0,bO=bP.length;bT<bO;bT++){bx(e,bP[bT],bQ)}return bx.filter(bR,bQ)};b.find=bx;b.expr=bx.selectors;b.expr[":"]=b.expr.filters;b.unique=bx.uniqueSort;b.text=bx.getText;b.isXMLDoc=bx.isXML;b.contains=bx.contains})();var ab=/Until$/,ap=/^(?:parents|prevUntil|prevAll)/,ba=/,/,bq=/^.[^:#\[\.,]*$/,S=Array.prototype.slice,K=b.expr.match.POS,ax={children:true,contents:true,next:true,prev:true};b.fn.extend({find:function(e){var bw=this,by,bv;if(typeof e!=="string"){return b(e).filter(function(){for(by=0,bv=bw.length;by<bv;by++){if(b.contains(bw[by],this)){return true}}})}var bx=this.pushStack("","find",e),bA,bB,bz;for(by=0,bv=this.length;by<bv;by++){bA=bx.length;b.find(e,this[by],bx);if(by>0){for(bB=bA;bB<bx.length;bB++){for(bz=0;bz<bA;bz++){if(bx[bz]===bx[bB]){bx.splice(bB--,1);break}}}}}return bx},has:function(bv){var e=b(bv);return this.filter(function(){for(var bx=0,bw=e.length;bx<bw;bx++){if(b.contains(this,e[bx])){return true}}})},not:function(e){return this.pushStack(aE(this,e,false),"not",e)},filter:function(e){return this.pushStack(aE(this,e,true),"filter",e)},is:function(e){return !!e&&(typeof e==="string"?b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(bE,bv){var bB=[],by,bw,bD=this[0];if(b.isArray(bE)){var bA,bx,bz={},e=1;if(bD&&bE.length){for(by=0,bw=bE.length;by<bw;by++){bx=bE[by];if(!bz[bx]){bz[bx]=K.test(bx)?b(bx,bv||this.context):bx}}while(bD&&bD.ownerDocument&&bD!==bv){for(bx in bz){bA=bz[bx];if(bA.jquery?bA.index(bD)>-1:b(bD).is(bA)){bB.push({selector:bx,elem:bD,level:e})}}bD=bD.parentNode;e++}}return bB}var bC=K.test(bE)||typeof bE!=="string"?b(bE,bv||this.context):0;for(by=0,bw=this.length;by<bw;by++){bD=this[by];while(bD){if(bC?bC.index(bD)>-1:b.find.matchesSelector(bD,bE)){bB.push(bD);break}else{bD=bD.parentNode;if(!bD||!bD.ownerDocument||bD===bv||bD.nodeType===11){break}}}}bB=bB.length>1?b.unique(bB):bB;return this.pushStack(bB,"closest",bE)},index:function(e){if(!e||typeof e==="string"){return b.inArray(this[0],e?b(e):this.parent().children())}return b.inArray(e.jquery?e[0]:e,this)},add:function(e,bv){var bx=typeof e==="string"?b(e,bv):b.makeArray(e&&e.nodeType?[e]:e),bw=b.merge(this.get(),bx);return this.pushStack(F(bx[0])||F(bw[0])?bw:b.unique(bw))},andSelf:function(){return this.add(this.prevObject)}});function F(e){return !e||!e.parentNode||e.parentNode.nodeType===11}b.each({parent:function(bv){var e=bv.parentNode;return e&&e.nodeType!==11?e:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(bv,e,bw){return b.dir(bv,"parentNode",bw)},next:function(e){return b.nth(e,2,"nextSibling")},prev:function(e){return b.nth(e,2,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(bv,e,bw){return b.dir(bv,"nextSibling",bw)},prevUntil:function(bv,e,bw){return b.dir(bv,"previousSibling",bw)},siblings:function(e){return b.sibling(e.parentNode.firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.makeArray(e.childNodes)}},function(e,bv){b.fn[e]=function(bz,bw){var by=b.map(this,bv,bz),bx=S.call(arguments);if(!ab.test(e)){bw=bz}if(bw&&typeof bw==="string"){by=b.filter(bw,by)}by=this.length>1&&!ax[e]?b.unique(by):by;if((this.length>1||ba.test(bw))&&ap.test(e)){by=by.reverse()}return this.pushStack(by,e,bx.join(","))}});b.extend({filter:function(bw,e,bv){if(bv){bw=":not("+bw+")"}return e.length===1?b.find.matchesSelector(e[0],bw)?[e[0]]:[]:b.find.matches(bw,e)},dir:function(bw,bv,by){var e=[],bx=bw[bv];while(bx&&bx.nodeType!==9&&(by===N||bx.nodeType!==1||!b(bx).is(by))){if(bx.nodeType===1){e.push(bx)}bx=bx[bv]}return e},nth:function(by,e,bw,bx){e=e||1;var bv=0;for(;by;by=by[bw]){if(by.nodeType===1&&++bv===e){break}}return by},sibling:function(bw,bv){var e=[];for(;bw;bw=bw.nextSibling){if(bw.nodeType===1&&bw!==bv){e.push(bw)}}return e}});function aE(bx,bw,e){bw=bw||0;if(b.isFunction(bw)){return b.grep(bx,function(bz,by){var bA=!!bw.call(bz,by,bz);return bA===e})}else{if(bw.nodeType){return b.grep(bx,function(bz,by){return(bz===bw)===e})}else{if(typeof bw==="string"){var bv=b.grep(bx,function(by){return by.nodeType===1});if(bq.test(bw)){return b.filter(bw,bv,!e)}else{bw=b.filter(bw,bv)}}}}return b.grep(bx,function(bz,by){return(b.inArray(bz,bw)>=0)===e})}var ag=/ jQuery\d+="(?:\d+|null)"/g,aq=/^\s+/,V=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,f=/<([\w:]+)/,z=/<tbody/i,Y=/<|&#?\w+;/,R=/<(?:script|object|embed|option|style)/i,p=/checked\s*(?:[^=]|=\s*.checked.)/i,bm=/\/(java|ecma)script/i,aM=/^\s*<!(?:\[CDATA\[|\-\-)/,aw={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};aw.optgroup=aw.option;aw.tbody=aw.tfoot=aw.colgroup=aw.caption=aw.thead;aw.th=aw.td;if(!b.support.htmlSerialize){aw._default=[1,"div<div>","</div>"]}b.fn.extend({text:function(e){if(b.isFunction(e)){return this.each(function(bw){var bv=b(this);bv.text(e.call(this,bw,bv.text()))})}if(typeof e!=="object"&&e!==N){return this.empty().append((this[0]&&this[0].ownerDocument||au).createTextNode(e))}return b.text(this)},wrapAll:function(e){if(b.isFunction(e)){return this.each(function(bw){b(this).wrapAll(e.call(this,bw))})}if(this[0]){var bv=b(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){bv.insertBefore(this[0])}bv.map(function(){var bw=this;while(bw.firstChild&&bw.firstChild.nodeType===1){bw=bw.firstChild}return bw}).append(this)}return this},wrapInner:function(e){if(b.isFunction(e)){return this.each(function(bv){b(this).wrapInner(e.call(this,bv))})}return this.each(function(){var bv=b(this),bw=bv.contents();if(bw.length){bw.wrapAll(e)}else{bv.append(e)}})},wrap:function(e){return this.each(function(){b(this).wrapAll(e)})},unwrap:function(){return this.parent().each(function(){if(!b.nodeName(this,"body")){b(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1){this.appendChild(e)}})},prepend:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1){this.insertBefore(e,this.firstChild)}})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(bv){this.parentNode.insertBefore(bv,this)})}else{if(arguments.length){var e=b(arguments[0]);e.push.apply(e,this.toArray());return this.pushStack(e,"before",arguments)}}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(bv){this.parentNode.insertBefore(bv,this.nextSibling)})}else{if(arguments.length){var e=this.pushStack(this,"after",arguments);e.push.apply(e,b(arguments[0]).toArray());return e}}},remove:function(e,bx){for(var bv=0,bw;(bw=this[bv])!=null;bv++){if(!e||b.filter(e,[bw]).length){if(!bx&&bw.nodeType===1){b.cleanData(bw.getElementsByTagName("*"));b.cleanData([bw])}if(bw.parentNode){bw.parentNode.removeChild(bw)}}}return this},empty:function(){for(var e=0,bv;(bv=this[e])!=null;e++){if(bv.nodeType===1){b.cleanData(bv.getElementsByTagName("*"))}while(bv.firstChild){bv.removeChild(bv.firstChild)}}return this},clone:function(bv,e){bv=bv==null?false:bv;e=e==null?bv:e;return this.map(function(){return b.clone(this,bv,e)})},html:function(bx){if(bx===N){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(ag,""):null}else{if(typeof bx==="string"&&!R.test(bx)&&(b.support.leadingWhitespace||!aq.test(bx))&&!aw[(f.exec(bx)||["",""])[1].toLowerCase()]){bx=bx.replace(V,"<$1></$2>");try{for(var bw=0,bv=this.length;bw<bv;bw++){if(this[bw].nodeType===1){b.cleanData(this[bw].getElementsByTagName("*"));this[bw].innerHTML=bx}}}catch(by){this.empty().append(bx)}}else{if(b.isFunction(bx)){this.each(function(bz){var e=b(this);e.html(bx.call(this,bz,e.html()))})}else{this.empty().append(bx)}}}return this},replaceWith:function(e){if(this[0]&&this[0].parentNode){if(b.isFunction(e)){return this.each(function(bx){var bw=b(this),bv=bw.html();bw.replaceWith(e.call(this,bx,bv))})}if(typeof e!=="string"){e=b(e).detach()}return this.each(function(){var bw=this.nextSibling,bv=this.parentNode;b(this).remove();if(bw){b(bw).before(e)}else{b(bv).append(e)}})}else{return this.length?this.pushStack(b(b.isFunction(e)?e():e),"replaceWith",e):this}},detach:function(e){return this.remove(e,true)},domManip:function(bB,bF,bE){var bx,by,bA,bD,bC=bB[0],bv=[];if(!b.support.checkClone&&arguments.length===3&&typeof bC==="string"&&p.test(bC)){return this.each(function(){b(this).domManip(bB,bF,bE,true)})}if(b.isFunction(bC)){return this.each(function(bH){var bG=b(this);bB[0]=bC.call(this,bH,bF?bG.html():N);bG.domManip(bB,bF,bE)})}if(this[0]){bD=bC&&bC.parentNode;if(b.support.parentNode&&bD&&bD.nodeType===11&&bD.childNodes.length===this.length){bx={fragment:bD}}else{bx=b.buildFragment(bB,this,bv)}bA=bx.fragment;if(bA.childNodes.length===1){by=bA=bA.firstChild}else{by=bA.firstChild}if(by){bF=bF&&b.nodeName(by,"tr");for(var bw=0,e=this.length,bz=e-1;bw<e;bw++){bE.call(bF?bb(this[bw],by):this[bw],bx.cacheable||(e>1&&bw<bz)?b.clone(bA,true,true):bA)}}if(bv.length){b.each(bv,bp)}}return this}});function bb(e,bv){return b.nodeName(e,"table")?(e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody"))):e}function w(e,bB){if(bB.nodeType!==1||!b.hasData(e)){return}var bA=b.expando,bx=b.data(e),by=b.data(bB,bx);if((bx=bx[bA])){var bC=bx.events;by=by[bA]=b.extend({},bx);if(bC){delete by.handle;by.events={};for(var bz in bC){for(var bw=0,bv=bC[bz].length;bw<bv;bw++){b.event.add(bB,bz+(bC[bz][bw].namespace?".":"")+bC[bz][bw].namespace,bC[bz][bw],bC[bz][bw].data)}}}}}function ah(bv,e){var bw;if(e.nodeType!==1){return}if(e.clearAttributes){e.clearAttributes()}if(e.mergeAttributes){e.mergeAttributes(bv)}bw=e.nodeName.toLowerCase();if(bw==="object"){e.outerHTML=bv.outerHTML}else{if(bw==="input"&&(bv.type==="checkbox"||bv.type==="radio")){if(bv.checked){e.defaultChecked=e.checked=bv.checked}if(e.value!==bv.value){e.value=bv.value}}else{if(bw==="option"){e.selected=bv.defaultSelected}else{if(bw==="input"||bw==="textarea"){e.defaultValue=bv.defaultValue}}}}e.removeAttribute(b.expando)}b.buildFragment=function(bz,bx,bv){var by,e,bw,bA;if(bx&&bx[0]){bA=bx[0].ownerDocument||bx[0]}if(!bA.createDocumentFragment){bA=au}if(bz.length===1&&typeof bz[0]==="string"&&bz[0].length<512&&bA===au&&bz[0].charAt(0)==="<"&&!R.test(bz[0])&&(b.support.checkClone||!p.test(bz[0]))){e=true;bw=b.fragments[bz[0]];if(bw&&bw!==1){by=bw}}if(!by){by=bA.createDocumentFragment();b.clean(bz,bA,by,bv)}if(e){b.fragments[bz[0]]=bw?by:1}return{fragment:by,cacheable:e}};b.fragments={};b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,bv){b.fn[e]=function(bw){var bz=[],bC=b(bw),bB=this.length===1&&this[0].parentNode;if(bB&&bB.nodeType===11&&bB.childNodes.length===1&&bC.length===1){bC[bv](this[0]);return this}else{for(var bA=0,bx=bC.length;bA<bx;bA++){var by=(bA>0?this.clone(true):this).get();b(bC[bA])[bv](by);bz=bz.concat(by)}return this.pushStack(bz,e,bC.selector)}}});function bf(e){if("getElementsByTagName" in e){return e.getElementsByTagName("*")}else{if("querySelectorAll" in e){return e.querySelectorAll("*")}else{return[]}}}function ay(e){if(e.type==="checkbox"||e.type==="radio"){e.defaultChecked=e.checked}}function H(e){if(b.nodeName(e,"input")){ay(e)}else{if("getElementsByTagName" in e){b.grep(e.getElementsByTagName("input"),ay)}}}b.extend({clone:function(by,bA,bw){var bz=by.cloneNode(true),e,bv,bx;if((!b.support.noCloneEvent||!b.support.noCloneChecked)&&(by.nodeType===1||by.nodeType===11)&&!b.isXMLDoc(by)){ah(by,bz);e=bf(by);bv=bf(bz);for(bx=0;e[bx];++bx){ah(e[bx],bv[bx])}}if(bA){w(by,bz);if(bw){e=bf(by);bv=bf(bz);for(bx=0;e[bx];++bx){w(e[bx],bv[bx])}}}e=bv=null;return bz},clean:function(bw,by,bH,bA){var bF;by=by||au;if(typeof by.createElement==="undefined"){by=by.ownerDocument||by[0]&&by[0].ownerDocument||au}var bI=[],bB;for(var bE=0,bz;(bz=bw[bE])!=null;bE++){if(typeof bz==="number"){bz+=""}if(!bz){continue}if(typeof bz==="string"){if(!Y.test(bz)){bz=by.createTextNode(bz)}else{bz=bz.replace(V,"<$1></$2>");var bK=(f.exec(bz)||["",""])[1].toLowerCase(),bx=aw[bK]||aw._default,bD=bx[0],bv=by.createElement("div");bv.innerHTML=bx[1]+bz+bx[2];while(bD--){bv=bv.lastChild}if(!b.support.tbody){var e=z.test(bz),bC=bK==="table"&&!e?bv.firstChild&&bv.firstChild.childNodes:bx[1]==="<table>"&&!e?bv.childNodes:[];for(bB=bC.length-1;bB>=0;--bB){if(b.nodeName(bC[bB],"tbody")&&!bC[bB].childNodes.length){bC[bB].parentNode.removeChild(bC[bB])}}}if(!b.support.leadingWhitespace&&aq.test(bz)){bv.insertBefore(by.createTextNode(aq.exec(bz)[0]),bv.firstChild)}bz=bv.childNodes}}var bG;if(!b.support.appendChecked){if(bz[0]&&typeof(bG=bz.length)==="number"){for(bB=0;bB<bG;bB++){H(bz[bB])}}else{H(bz)}}if(bz.nodeType){bI.push(bz)}else{bI=b.merge(bI,bz)}}if(bH){bF=function(bL){return !bL.type||bm.test(bL.type)};for(bE=0;bI[bE];bE++){if(bA&&b.nodeName(bI[bE],"script")&&(!bI[bE].type||bI[bE].type.toLowerCase()==="text/javascript")){bA.push(bI[bE].parentNode?bI[bE].parentNode.removeChild(bI[bE]):bI[bE])}else{if(bI[bE].nodeType===1){var bJ=b.grep(bI[bE].getElementsByTagName("script"),bF);bI.splice.apply(bI,[bE+1,0].concat(bJ))}bH.appendChild(bI[bE])}}}return bI},cleanData:function(bv){var by,bw,e=b.cache,bD=b.expando,bB=b.event.special,bA=b.support.deleteExpando;for(var bz=0,bx;(bx=bv[bz])!=null;bz++){if(bx.nodeName&&b.noData[bx.nodeName.toLowerCase()]){continue}bw=bx[b.expando];if(bw){by=e[bw]&&e[bw][bD];if(by&&by.events){for(var bC in by.events){if(bB[bC]){b.event.remove(bx,bC)}else{b.removeEvent(bx,bC,by.handle)}}if(by.handle){by.handle.elem=null}}if(bA){delete bx[b.expando]}else{if(bx.removeAttribute){bx.removeAttribute(b.expando)}}delete e[bw]}}}});function bp(e,bv){if(bv.src){b.ajax({url:bv.src,async:false,dataType:"script"})}else{b.globalEval((bv.text||bv.textContent||bv.innerHTML||"").replace(aM,"/*$0*/"))}if(bv.parentNode){bv.parentNode.removeChild(bv)}}var ak=/alpha\([^)]*\)/i,at=/opacity=([^)]*)/,C=/([A-Z]|^ms)/g,bd=/^-?\d+(?:px)?$/i,bo=/^-?\d/,L=/^[+\-]=/,aj=/[^+\-\.\de]+/g,a7={position:"absolute",visibility:"hidden",display:"block"},am=["Left","Right"],a1=["Top","Bottom"],Z,aH,aV;b.fn.css=function(e,bv){if(arguments.length===2&&bv===N){return this}return b.access(this,e,bv,true,function(bx,bw,by){return by!==N?b.style(bx,bw,by):b.css(bx,bw)})};b.extend({cssHooks:{opacity:{get:function(bw,bv){if(bv){var e=Z(bw,"opacity","opacity");return e===""?"1":e}else{return bw.style.opacity}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(bx,bw,bD,by){if(!bx||bx.nodeType===3||bx.nodeType===8||!bx.style){return}var bB,bC,bz=b.camelCase(bw),bv=bx.style,bE=b.cssHooks[bz];bw=b.cssProps[bz]||bz;if(bD!==N){bC=typeof bD;if(bC==="number"&&isNaN(bD)||bD==null){return}if(bC==="string"&&L.test(bD)){bD=+bD.replace(aj,"")+parseFloat(b.css(bx,bw));bC="number"}if(bC==="number"&&!b.cssNumber[bz]){bD+="px"}if(!bE||!("set" in bE)||(bD=bE.set(bx,bD))!==N){try{bv[bw]=bD}catch(bA){}}}else{if(bE&&"get" in bE&&(bB=bE.get(bx,false,by))!==N){return bB}return bv[bw]}},css:function(by,bx,bv){var bw,e;bx=b.camelCase(bx);e=b.cssHooks[bx];bx=b.cssProps[bx]||bx;if(bx==="cssFloat"){bx="float"}if(e&&"get" in e&&(bw=e.get(by,true,bv))!==N){return bw}else{if(Z){return Z(by,bx)}}},swap:function(bx,bw,by){var e={};for(var bv in bw){e[bv]=bx.style[bv];bx.style[bv]=bw[bv]}by.call(bx);for(bv in bw){bx.style[bv]=e[bv]}}});b.curCSS=b.css;b.each(["height","width"],function(bv,e){b.cssHooks[e]={get:function(by,bx,bw){var bz;if(bx){if(by.offsetWidth!==0){return q(by,e,bw)}else{b.swap(by,a7,function(){bz=q(by,e,bw)})}return bz}},set:function(bw,bx){if(bd.test(bx)){bx=parseFloat(bx);if(bx>=0){return bx+"px"}}else{return bx}}}});if(!b.support.opacity){b.cssHooks.opacity={get:function(bv,e){return at.test((e&&bv.currentStyle?bv.currentStyle.filter:bv.style.filter)||"")?(parseFloat(RegExp.$1)/100)+"":e?"1":""},set:function(by,bz){var bx=by.style,bv=by.currentStyle;bx.zoom=1;var e=b.isNaN(bz)?"":"alpha(opacity="+bz*100+")",bw=bv&&bv.filter||bx.filter||"";bx.filter=ak.test(bw)?bw.replace(ak,e):bw+" "+e}}}b(function(){if(!b.support.reliableMarginRight){b.cssHooks.marginRight={get:function(bw,bv){var e;b.swap(bw,{display:"inline-block"},function(){if(bv){e=Z(bw,"margin-right","marginRight")}else{e=bw.style.marginRight}});return e}}}});if(au.defaultView&&au.defaultView.getComputedStyle){aH=function(by,bw){var bv,bx,e;bw=bw.replace(C,"-$1").toLowerCase();if(!(bx=by.ownerDocument.defaultView)){return N}if((e=bx.getComputedStyle(by,null))){bv=e.getPropertyValue(bw);if(bv===""&&!b.contains(by.ownerDocument.documentElement,by)){bv=b.style(by,bw)}}return bv}}if(au.documentElement.currentStyle){aV=function(by,bw){var bz,bv=by.currentStyle&&by.currentStyle[bw],e=by.runtimeStyle&&by.runtimeStyle[bw],bx=by.style;if(!bd.test(bv)&&bo.test(bv)){bz=bx.left;if(e){by.runtimeStyle.left=by.currentStyle.left}bx.left=bw==="fontSize"?"1em":(bv||0);bv=bx.pixelLeft+"px";bx.left=bz;if(e){by.runtimeStyle.left=e}}return bv===""?"auto":bv}}Z=aH||aV;function q(bw,bv,e){var by=bv==="width"?bw.offsetWidth:bw.offsetHeight,bx=bv==="width"?am:a1;if(by>0){if(e!=="border"){b.each(bx,function(){if(!e){by-=parseFloat(b.css(bw,"padding"+this))||0}if(e==="margin"){by+=parseFloat(b.css(bw,e+this))||0}else{by-=parseFloat(b.css(bw,"border"+this+"Width"))||0}})}return by+"px"}by=Z(bw,bv,bv);if(by<0||by==null){by=bw.style[bv]||0}by=parseFloat(by)||0;if(e){b.each(bx,function(){by+=parseFloat(b.css(bw,"padding"+this))||0;if(e!=="padding"){by+=parseFloat(b.css(bw,"border"+this+"Width"))||0}if(e==="margin"){by+=parseFloat(b.css(bw,e+this))||0}})}return by+"px"}if(b.expr&&b.expr.filters){b.expr.filters.hidden=function(bw){var bv=bw.offsetWidth,e=bw.offsetHeight;return(bv===0&&e===0)||(!b.support.reliableHiddenOffsets&&(bw.style.display||b.css(bw,"display"))==="none")};b.expr.filters.visible=function(e){return !b.expr.filters.hidden(e)}}var l=/%20/g,ao=/\[\]$/,bt=/\r?\n/g,br=/#.*$/,aC=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,aY=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,aL=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/,aO=/^(?:GET|HEAD)$/,d=/^\/\//,O=/\?/,a6=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,t=/^(?:select|textarea)/i,j=/\s+/,bs=/([?&])_=[^&]*/,M=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,D=b.fn.load,aa={},u={},aD,v;try{aD=bl.href}catch(av){aD=au.createElement("a");aD.href="";aD=aD.href}v=M.exec(aD.toLowerCase())||[];function g(e){return function(by,bA){if(typeof by!=="string"){bA=by;by="*"}if(b.isFunction(bA)){var bx=by.toLowerCase().split(j),bw=0,bz=bx.length,bv,bB,bC;for(;bw<bz;bw++){bv=bx[bw];bC=/^\+/.test(bv);if(bC){bv=bv.substr(1)||"*"}bB=e[bv]=e[bv]||[];bB[bC?"unshift":"push"](bA)}}}}function aT(bv,bE,bz,bD,bB,bx){bB=bB||bE.dataTypes[0];bx=bx||{};bx[bB]=true;var bA=bv[bB],bw=0,e=bA?bA.length:0,by=(bv===aa),bC;for(;bw<e&&(by||!bC);bw++){bC=bA[bw](bE,bz,bD);if(typeof bC==="string"){if(!by||bx[bC]){bC=N}else{bE.dataTypes.unshift(bC);bC=aT(bv,bE,bz,bD,bC,bx)}}}if((by||!bC)&&!bx["*"]){bC=aT(bv,bE,bz,bD,"*",bx)}return bC}b.fn.extend({load:function(bw,bz,bA){if(typeof bw!=="string"&&D){return D.apply(this,arguments)}else{if(!this.length){return this}}var by=bw.indexOf(" ");if(by>=0){var e=bw.slice(by,bw.length);bw=bw.slice(0,by)}var bx="GET";if(bz){if(b.isFunction(bz)){bA=bz;bz=N}else{if(typeof bz==="object"){bz=b.param(bz,b.ajaxSettings.traditional);bx="POST"}}}var bv=this;b.ajax({url:bw,type:bx,dataType:"html",data:bz,complete:function(bC,bB,bD){bD=bC.responseText;if(bC.isResolved()){bC.done(function(bE){bD=bE});bv.html(e?b("<div>").append(bD.replace(a6,"")).find(e):bD)}if(bA){bv.each(bA,[bD,bB,bC])}}});return this},serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?b.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||t.test(this.nodeName)||aY.test(this.type))}).map(function(e,bv){var bw=b(this).val();return bw==null?null:b.isArray(bw)?b.map(bw,function(by,bx){return{name:bv.name,value:by.replace(bt,"\r\n")}}):{name:bv.name,value:bw.replace(bt,"\r\n")}}).get()}});b.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,bv){b.fn[bv]=function(bw){return this.bind(bv,bw)}});b.each(["get","post"],function(e,bv){b[bv]=function(bw,by,bz,bx){if(b.isFunction(by)){bx=bx||bz;bz=by;by=N}return b.ajax({type:bv,url:bw,data:by,success:bz,dataType:bx})}});b.extend({getScript:function(e,bv){return b.get(e,N,bv,"script")},getJSON:function(e,bv,bw){return b.get(e,bv,bw,"json")},ajaxSetup:function(bw,e){if(!e){e=bw;bw=b.extend(true,b.ajaxSettings,e)}else{b.extend(true,bw,b.ajaxSettings,e)}for(var bv in {context:1,url:1}){if(bv in e){bw[bv]=e[bv]}else{if(bv in b.ajaxSettings){bw[bv]=b.ajaxSettings[bv]}}}return bw},ajaxSettings:{url:aD,isLocal:aL.test(v[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":bc.String,"text html":true,"text json":b.parseJSON,"text xml":b.parseXML}},ajaxPrefilter:g(aa),ajaxTransport:g(u),ajax:function(bz,bx){if(typeof bz==="object"){bx=bz;bz=N}bx=bx||{};var bD=b.ajaxSetup({},bx),bS=bD.context||bD,bG=bS!==bD&&(bS.nodeType||bS instanceof b)?b(bS):b.event,bR=b.Deferred(),bN=b._Deferred(),bB=bD.statusCode||{},bC,bH={},bO={},bQ,by,bL,bE,bI,bA=0,bw,bK,bJ={readyState:0,setRequestHeader:function(bT,bU){if(!bA){var e=bT.toLowerCase();bT=bO[e]=bO[e]||bT;bH[bT]=bU}return this},getAllResponseHeaders:function(){return bA===2?bQ:null},getResponseHeader:function(bT){var e;if(bA===2){if(!by){by={};while((e=aC.exec(bQ))){by[e[1].toLowerCase()]=e[2]}}e=by[bT.toLowerCase()]}return e===N?null:e},overrideMimeType:function(e){if(!bA){bD.mimeType=e}return this},abort:function(e){e=e||"abort";if(bL){bL.abort(e)}bF(0,e);return this}};function bF(bY,bW,bZ,bV){if(bA===2){return}bA=2;if(bE){clearTimeout(bE)}bL=N;bQ=bV||"";bJ.readyState=bY?4:0;var bT,b3,b2,bX=bZ?bj(bD,bJ,bZ):N,bU,b1;if(bY>=200&&bY<300||bY===304){if(bD.ifModified){if((bU=bJ.getResponseHeader("Last-Modified"))){b.lastModified[bC]=bU}if((b1=bJ.getResponseHeader("Etag"))){b.etag[bC]=b1}}if(bY===304){bW="notmodified";bT=true}else{try{b3=I(bD,bX);bW="success";bT=true}catch(b0){bW="parsererror";b2=b0}}}else{b2=bW;if(!bW||bY){bW="error";if(bY<0){bY=0}}}bJ.status=bY;bJ.statusText=bW;if(bT){bR.resolveWith(bS,[b3,bW,bJ])}else{bR.rejectWith(bS,[bJ,bW,b2])}bJ.statusCode(bB);bB=N;if(bw){bG.trigger("ajax"+(bT?"Success":"Error"),[bJ,bD,bT?b3:b2])}bN.resolveWith(bS,[bJ,bW]);if(bw){bG.trigger("ajaxComplete",[bJ,bD]);if(!(--b.active)){b.event.trigger("ajaxStop")}}}bR.promise(bJ);bJ.success=bJ.done;bJ.error=bJ.fail;bJ.complete=bN.done;bJ.statusCode=function(bT){if(bT){var e;if(bA<2){for(e in bT){bB[e]=[bB[e],bT[e]]}}else{e=bT[bJ.status];bJ.then(e,e)}}return this};bD.url=((bz||bD.url)+"").replace(br,"").replace(d,v[1]+"//");bD.dataTypes=b.trim(bD.dataType||"*").toLowerCase().split(j);if(bD.crossDomain==null){bI=M.exec(bD.url.toLowerCase());bD.crossDomain=!!(bI&&(bI[1]!=v[1]||bI[2]!=v[2]||(bI[3]||(bI[1]==="http:"?80:443))!=(v[3]||(v[1]==="http:"?80:443))))}if(bD.data&&bD.processData&&typeof bD.data!=="string"){bD.data=b.param(bD.data,bD.traditional)}aT(aa,bD,bx,bJ);if(bA===2){return false}bw=bD.global;bD.type=bD.type.toUpperCase();bD.hasContent=!aO.test(bD.type);if(bw&&b.active++===0){b.event.trigger("ajaxStart")}if(!bD.hasContent){if(bD.data){bD.url+=(O.test(bD.url)?"&":"?")+bD.data}bC=bD.url;if(bD.cache===false){var bv=b.now(),bP=bD.url.replace(bs,"$1_="+bv);bD.url=bP+((bP===bD.url)?(O.test(bD.url)?"&":"?")+"_="+bv:"")}}if(bD.data&&bD.hasContent&&bD.contentType!==false||bx.contentType){bJ.setRequestHeader("Content-Type",bD.contentType)}if(bD.ifModified){bC=bC||bD.url;if(b.lastModified[bC]){bJ.setRequestHeader("If-Modified-Since",b.lastModified[bC])}if(b.etag[bC]){bJ.setRequestHeader("If-None-Match",b.etag[bC])}}bJ.setRequestHeader("Accept",bD.dataTypes[0]&&bD.accepts[bD.dataTypes[0]]?bD.accepts[bD.dataTypes[0]]+(bD.dataTypes[0]!=="*"?", */*; q=0.01":""):bD.accepts["*"]);for(bK in bD.headers){bJ.setRequestHeader(bK,bD.headers[bK])}if(bD.beforeSend&&(bD.beforeSend.call(bS,bJ,bD)===false||bA===2)){bJ.abort();return false}for(bK in {success:1,error:1,complete:1}){bJ[bK](bD[bK])}bL=aT(u,bD,bx,bJ);if(!bL){bF(-1,"No Transport")}else{bJ.readyState=1;if(bw){bG.trigger("ajaxSend",[bJ,bD])}if(bD.async&&bD.timeout>0){bE=setTimeout(function(){bJ.abort("timeout")},bD.timeout)}try{bA=1;bL.send(bH,bF)}catch(bM){if(status<2){bF(-1,bM)}else{b.error(bM)}}}return bJ},param:function(e,bw){var bv=[],by=function(bz,bA){bA=b.isFunction(bA)?bA():bA;bv[bv.length]=encodeURIComponent(bz)+"="+encodeURIComponent(bA)};if(bw===N){bw=b.ajaxSettings.traditional}if(b.isArray(e)||(e.jquery&&!b.isPlainObject(e))){b.each(e,function(){by(this.name,this.value)})}else{for(var bx in e){y(bx,e[bx],bw,by)}}return bv.join("&").replace(l,"+")}});function y(bw,by,bv,bx){if(b.isArray(by)){b.each(by,function(bA,bz){if(bv||ao.test(bw)){bx(bw,bz)}else{y(bw+"["+(typeof bz==="object"||b.isArray(bz)?bA:"")+"]",bz,bv,bx)}})}else{if(!bv&&by!=null&&typeof by==="object"){for(var e in by){y(bw+"["+e+"]",by[e],bv,bx)}}else{bx(bw,by)}}}b.extend({active:0,lastModified:{},etag:{}});function bj(bD,bC,bz){var bv=bD.contents,bB=bD.dataTypes,bw=bD.responseFields,by,bA,bx,e;for(bA in bw){if(bA in bz){bC[bw[bA]]=bz[bA]}}while(bB[0]==="*"){bB.shift();if(by===N){by=bD.mimeType||bC.getResponseHeader("content-type")}}if(by){for(bA in bv){if(bv[bA]&&bv[bA].test(by)){bB.unshift(bA);break}}}if(bB[0] in bz){bx=bB[0]}else{for(bA in bz){if(!bB[0]||bD.converters[bA+" "+bB[0]]){bx=bA;break}if(!e){e=bA}}bx=bx||e}if(bx){if(bx!==bB[0]){bB.unshift(bx)}return bz[bx]}}function I(bH,bz){if(bH.dataFilter){bz=bH.dataFilter(bz,bH.dataType)}var bD=bH.dataTypes,bG={},bA,bE,bw=bD.length,bB,bC=bD[0],bx,by,bF,bv,e;for(bA=1;bA<bw;bA++){if(bA===1){for(bE in bH.converters){if(typeof bE==="string"){bG[bE.toLowerCase()]=bH.converters[bE]}}}bx=bC;bC=bD[bA];if(bC==="*"){bC=bx}else{if(bx!=="*"&&bx!==bC){by=bx+" "+bC;bF=bG[by]||bG["* "+bC];if(!bF){e=N;for(bv in bG){bB=bv.split(" ");if(bB[0]===bx||bB[0]==="*"){e=bG[bB[1]+" "+bC];if(e){bv=bG[bv];if(bv===true){bF=e}else{if(e===true){bF=bv}}break}}}}if(!(bF||e)){b.error("No conversion from "+by.replace(" "," to "))}if(bF!==true){bz=bF?bF(bz):e(bv(bz))}}}}return bz}var aB=b.now(),x=/(\=)\?(&|$)|\?\?/i;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return b.expando+"_"+(aB++)}});b.ajaxPrefilter("json jsonp",function(bD,bA,bC){var bx=bD.contentType==="application/x-www-form-urlencoded"&&(typeof bD.data==="string");if(bD.dataTypes[0]==="jsonp"||bD.jsonp!==false&&(x.test(bD.url)||bx&&x.test(bD.data))){var bB,bw=bD.jsonpCallback=b.isFunction(bD.jsonpCallback)?bD.jsonpCallback():bD.jsonpCallback,bz=bc[bw],e=bD.url,by=bD.data,bv="$1"+bw+"$2";if(bD.jsonp!==false){e=e.replace(x,bv);if(bD.url===e){if(bx){by=by.replace(x,bv)}if(bD.data===by){e+=(/\?/.test(e)?"&":"?")+bD.jsonp+"="+bw}}}bD.url=e;bD.data=by;bc[bw]=function(bE){bB=[bE]};bC.always(function(){bc[bw]=bz;if(bB&&b.isFunction(bz)){bc[bw](bB[0])}});bD.converters["script json"]=function(){if(!bB){b.error(bw+" was not called")}return bB[0]};bD.dataTypes[0]="json";return"script"}});b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){b.globalEval(e);return e}}});b.ajaxPrefilter("script",function(e){if(e.cache===N){e.cache=false}if(e.crossDomain){e.type="GET";e.global=false}});b.ajaxTransport("script",function(bw){if(bw.crossDomain){var e,bv=au.head||au.getElementsByTagName("head")[0]||au.documentElement;return{send:function(bx,by){e=au.createElement("script");e.async="async";if(bw.scriptCharset){e.charset=bw.scriptCharset}e.src=bw.url;e.onload=e.onreadystatechange=function(bA,bz){if(bz||!e.readyState||/loaded|complete/.test(e.readyState)){e.onload=e.onreadystatechange=null;if(bv&&e.parentNode){bv.removeChild(e)}e=N;if(!bz){by(200,"success")}}};bv.insertBefore(e,bv.firstChild)},abort:function(){if(e){e.onload(0,1)}}}}});var E=bc.ActiveXObject?function(){for(var e in P){P[e](0,1)}}:false,B=0,P;function aK(){try{return new bc.XMLHttpRequest()}catch(bv){}}function ai(){try{return new bc.ActiveXObject("Microsoft.XMLHTTP")}catch(bv){}}b.ajaxSettings.xhr=bc.ActiveXObject?function(){return !this.isLocal&&aK()||ai()}:aK;(function(e){b.extend(b.support,{ajax:!!e,cors:!!e&&("withCredentials" in e)})})(b.ajaxSettings.xhr());if(b.support.ajax){b.ajaxTransport(function(e){if(!e.crossDomain||b.support.cors){var bv;return{send:function(bB,bw){var bA=e.xhr(),bz,by;if(e.username){bA.open(e.type,e.url,e.async,e.username,e.password)}else{bA.open(e.type,e.url,e.async)}if(e.xhrFields){for(by in e.xhrFields){bA[by]=e.xhrFields[by]}}if(e.mimeType&&bA.overrideMimeType){bA.overrideMimeType(e.mimeType)}if(!e.crossDomain&&!bB["X-Requested-With"]){bB["X-Requested-With"]="XMLHttpRequest"}try{for(by in bB){bA.setRequestHeader(by,bB[by])}}catch(bx){}bA.send((e.hasContent&&e.data)||null);bv=function(bK,bE){var bF,bD,bC,bI,bH;try{if(bv&&(bE||bA.readyState===4)){bv=N;if(bz){bA.onreadystatechange=b.noop;if(E){delete P[bz]}}if(bE){if(bA.readyState!==4){bA.abort()}}else{bF=bA.status;bC=bA.getAllResponseHeaders();bI={};bH=bA.responseXML;if(bH&&bH.documentElement){bI.xml=bH}bI.text=bA.responseText;try{bD=bA.statusText}catch(bJ){bD=""}if(!bF&&e.isLocal&&!e.crossDomain){bF=bI.text?200:404}else{if(bF===1223){bF=204}}}}}catch(bG){if(!bE){bw(-1,bG)}}if(bI){bw(bF,bD,bI,bC)}};if(!e.async||bA.readyState===4){bv()}else{bz=++B;if(E){if(!P){P={};b(bc).unload(E)}P[bz]=bv}bA.onreadystatechange=bv}},abort:function(){if(bv){bv(0,1)}}}}})}var T={},a9,o,aA=/^(?:toggle|show|hide)$/,aQ=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,a2,aG=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],a4,U=bc.webkitRequestAnimationFrame||bc.mozRequestAnimationFrame||bc.oRequestAnimationFrame;b.fn.extend({show:function(bx,bA,bz){var bw,by;if(bx||bx===0){return this.animate(a0("show",3),bx,bA,bz)}else{for(var bv=0,e=this.length;bv<e;bv++){bw=this[bv];if(bw.style){by=bw.style.display;if(!b._data(bw,"olddisplay")&&by==="none"){by=bw.style.display=""}if(by===""&&b.css(bw,"display")==="none"){b._data(bw,"olddisplay",A(bw.nodeName))}}}for(bv=0;bv<e;bv++){bw=this[bv];if(bw.style){by=bw.style.display;if(by===""||by==="none"){bw.style.display=b._data(bw,"olddisplay")||""}}}return this}},hide:function(bw,bz,by){if(bw||bw===0){return this.animate(a0("hide",3),bw,bz,by)}else{for(var bv=0,e=this.length;bv<e;bv++){if(this[bv].style){var bx=b.css(this[bv],"display");if(bx!=="none"&&!b._data(this[bv],"olddisplay")){b._data(this[bv],"olddisplay",bx)}}}for(bv=0;bv<e;bv++){if(this[bv].style){this[bv].style.display="none"}}return this}},_toggle:b.fn.toggle,toggle:function(bw,bv,bx){var e=typeof bw==="boolean";if(b.isFunction(bw)&&b.isFunction(bv)){this._toggle.apply(this,arguments)}else{if(bw==null||e){this.each(function(){var by=e?bw:b(this).is(":hidden");b(this)[by?"show":"hide"]()})}else{this.animate(a0("toggle",3),bw,bv,bx)}}return this},fadeTo:function(e,bx,bw,bv){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:bx},e,bw,bv)},animate:function(by,bv,bx,bw){var e=b.speed(bv,bx,bw);if(b.isEmptyObject(by)){return this.each(e.complete,[false])}by=b.extend({},by);return this[e.queue===false?"each":"queue"](function(){if(e.queue===false){b._mark(this)}var bC=b.extend({},e),bJ=this.nodeType===1,bG=bJ&&b(this).is(":hidden"),bz,bD,bB,bI,bH,bF,bA,bE,bK;bC.animatedProperties={};for(bB in by){bz=b.camelCase(bB);if(bB!==bz){by[bz]=by[bB];delete by[bB]}bD=by[bz];if(b.isArray(bD)){bC.animatedProperties[bz]=bD[1];bD=by[bz]=bD[0]}else{bC.animatedProperties[bz]=bC.specialEasing&&bC.specialEasing[bz]||bC.easing||"swing"}if(bD==="hide"&&bG||bD==="show"&&!bG){return bC.complete.call(this)}if(bJ&&(bz==="height"||bz==="width")){bC.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(b.css(this,"display")==="inline"&&b.css(this,"float")==="none"){if(!b.support.inlineBlockNeedsLayout){this.style.display="inline-block"}else{bI=A(this.nodeName);if(bI==="inline"){this.style.display="inline-block"}else{this.style.display="inline";this.style.zoom=1}}}}}if(bC.overflow!=null){this.style.overflow="hidden"}for(bB in by){bH=new b.fx(this,bC,bB);bD=by[bB];if(aA.test(bD)){bH[bD==="toggle"?bG?"show":"hide":bD]()}else{bF=aQ.exec(bD);bA=bH.cur();if(bF){bE=parseFloat(bF[2]);bK=bF[3]||(b.cssNumber[bB]?"":"px");if(bK!=="px"){b.style(this,bB,(bE||1)+bK);bA=((bE||1)/bH.cur())*bA;b.style(this,bB,bA+bK)}if(bF[1]){bE=((bF[1]==="-="?-1:1)*bE)+bA}bH.custom(bA,bE,bK)}else{bH.custom(bA,bD,"")}}}return true})},stop:function(bv,e){if(bv){this.queue([])}this.each(function(){var bx=b.timers,bw=bx.length;if(!e){b._unmark(true,this)}while(bw--){if(bx[bw].elem===this){if(e){bx[bw](true)}bx.splice(bw,1)}}});if(!e){this.dequeue()}return this}});function bg(){setTimeout(ar,0);return(a4=b.now())}function ar(){a4=N}function a0(bv,e){var bw={};b.each(aG.concat.apply([],aG.slice(0,e)),function(){bw[this]=bv});return bw}b.each({slideDown:a0("show",1),slideUp:a0("hide",1),slideToggle:a0("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,bv){b.fn[e]=function(bw,by,bx){return this.animate(bv,bw,by,bx)}});b.extend({speed:function(bw,bx,bv){var e=bw&&typeof bw==="object"?b.extend({},bw):{complete:bv||!bv&&bx||b.isFunction(bw)&&bw,duration:bw,easing:bv&&bx||bx&&!b.isFunction(bx)&&bx};e.duration=b.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in b.fx.speeds?b.fx.speeds[e.duration]:b.fx.speeds._default;e.old=e.complete;e.complete=function(by){if(b.isFunction(e.old)){e.old.call(this)}if(e.queue!==false){b.dequeue(this)}else{if(by!==false){b._unmark(this)}}};return e},easing:{linear:function(bw,bx,e,bv){return e+bv*bw},swing:function(bw,bx,e,bv){return((-Math.cos(bw*Math.PI)/2)+0.5)*bv+e}},timers:[],fx:function(bv,e,bw){this.options=e;this.elem=bv;this.prop=bw;e.orig=e.orig||{}}});b.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(b.fx.step[this.prop]||b.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var e,bv=b.css(this.elem,this.prop);return isNaN(e=parseFloat(bv))?!bv||bv==="auto"?0:bv:e},custom:function(bA,bz,bx){var e=this,bw=b.fx,by;this.startTime=a4||bg();this.start=bA;this.end=bz;this.unit=bx||this.unit||(b.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;function bv(bB){return e.step(bB)}bv.elem=this.elem;if(bv()&&b.timers.push(bv)&&!a2){if(U){a2=true;by=function(){if(a2){U(by);bw.tick()}};U(by)}else{a2=setInterval(bw.tick,bw.interval)}}},show:function(){this.options.orig[this.prop]=b.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());b(this.elem).show()},hide:function(){this.options.orig[this.prop]=b.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(by){var bx=a4||bg(),e=true,bz=this.elem,bv=this.options,bw,bB;if(by||bx>=bv.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();bv.animatedProperties[this.prop]=true;for(bw in bv.animatedProperties){if(bv.animatedProperties[bw]!==true){e=false}}if(e){if(bv.overflow!=null&&!b.support.shrinkWrapBlocks){b.each(["","X","Y"],function(bC,bD){bz.style["overflow"+bD]=bv.overflow[bC]})}if(bv.hide){b(bz).hide()}if(bv.hide||bv.show){for(var bA in bv.animatedProperties){b.style(bz,bA,bv.orig[bA])}}bv.complete.call(bz)}return false}else{if(bv.duration==Infinity){this.now=bx}else{bB=bx-this.startTime;this.state=bB/bv.duration;this.pos=b.easing[bv.animatedProperties[this.prop]](this.state,bB,0,1,bv.duration);this.now=this.start+((this.end-this.start)*this.pos)}this.update()}return true}};b.extend(b.fx,{tick:function(){for(var bv=b.timers,e=0;e<bv.length;++e){if(!bv[e]()){bv.splice(e--,1)}}if(!bv.length){b.fx.stop()}},interval:13,stop:function(){clearInterval(a2);a2=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(e){b.style(e.elem,"opacity",e.now)},_default:function(e){if(e.elem.style&&e.elem.style[e.prop]!=null){e.elem.style[e.prop]=(e.prop==="width"||e.prop==="height"?Math.max(0,e.now):e.now)+e.unit}else{e.elem[e.prop]=e.now}}}});if(b.expr&&b.expr.filters){b.expr.filters.animated=function(e){return b.grep(b.timers,function(bv){return e===bv.elem}).length}}function A(bx){if(!T[bx]){var e=au.body,bv=b("<"+bx+">").appendTo(e),bw=bv.css("display");bv.remove();if(bw==="none"||bw===""){if(!a9){a9=au.createElement("iframe");a9.frameBorder=a9.width=a9.height=0}e.appendChild(a9);if(!o||!a9.createElement){o=(a9.contentWindow||a9.contentDocument).document;o.write((au.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>");o.close()}bv=o.createElement(bx);o.body.appendChild(bv);bw=b.css(bv,"display");e.removeChild(a9)}T[bx]=bw}return T[bx]}var X=/^t(?:able|d|h)$/i,ad=/^(?:body|html)$/i;if("getBoundingClientRect" in au.documentElement){b.fn.offset=function(bI){var by=this[0],bB;if(bI){return this.each(function(e){b.offset.setOffset(this,bI,e)})}if(!by||!by.ownerDocument){return null}if(by===by.ownerDocument.body){return b.offset.bodyOffset(by)}try{bB=by.getBoundingClientRect()}catch(bF){}var bH=by.ownerDocument,bw=bH.documentElement;if(!bB||!b.contains(bw,by)){return bB?{top:bB.top,left:bB.left}:{top:0,left:0}}var bC=bH.body,bD=aJ(bH),bA=bw.clientTop||bC.clientTop||0,bE=bw.clientLeft||bC.clientLeft||0,bv=bD.pageYOffset||b.support.boxModel&&bw.scrollTop||bC.scrollTop,bz=bD.pageXOffset||b.support.boxModel&&bw.scrollLeft||bC.scrollLeft,bG=bB.top+bv-bA,bx=bB.left+bz-bE;return{top:bG,left:bx}}}else{b.fn.offset=function(bF){var bz=this[0];if(bF){return this.each(function(bG){b.offset.setOffset(this,bF,bG)})}if(!bz||!bz.ownerDocument){return null}if(bz===bz.ownerDocument.body){return b.offset.bodyOffset(bz)}b.offset.initialize();var bC,bw=bz.offsetParent,bv=bz,bE=bz.ownerDocument,bx=bE.documentElement,bA=bE.body,bB=bE.defaultView,e=bB?bB.getComputedStyle(bz,null):bz.currentStyle,bD=bz.offsetTop,by=bz.offsetLeft;while((bz=bz.parentNode)&&bz!==bA&&bz!==bx){if(b.offset.supportsFixedPosition&&e.position==="fixed"){break}bC=bB?bB.getComputedStyle(bz,null):bz.currentStyle;bD-=bz.scrollTop;by-=bz.scrollLeft;if(bz===bw){bD+=bz.offsetTop;by+=bz.offsetLeft;if(b.offset.doesNotAddBorder&&!(b.offset.doesAddBorderForTableAndCells&&X.test(bz.nodeName))){bD+=parseFloat(bC.borderTopWidth)||0;by+=parseFloat(bC.borderLeftWidth)||0}bv=bw;bw=bz.offsetParent}if(b.offset.subtractsBorderForOverflowNotVisible&&bC.overflow!=="visible"){bD+=parseFloat(bC.borderTopWidth)||0;by+=parseFloat(bC.borderLeftWidth)||0}e=bC}if(e.position==="relative"||e.position==="static"){bD+=bA.offsetTop;by+=bA.offsetLeft}if(b.offset.supportsFixedPosition&&e.position==="fixed"){bD+=Math.max(bx.scrollTop,bA.scrollTop);by+=Math.max(bx.scrollLeft,bA.scrollLeft)}return{top:bD,left:by}}}b.offset={initialize:function(){var e=au.body,bv=au.createElement("div"),by,bA,bz,bB,bw=parseFloat(b.css(e,"marginTop"))||0,bx="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";b.extend(bv.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});bv.innerHTML=bx;e.insertBefore(bv,e.firstChild);by=bv.firstChild;bA=by.firstChild;bB=by.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(bA.offsetTop!==5);this.doesAddBorderForTableAndCells=(bB.offsetTop===5);bA.style.position="fixed";bA.style.top="20px";this.supportsFixedPosition=(bA.offsetTop===20||bA.offsetTop===15);bA.style.position=bA.style.top="";by.style.overflow="hidden";by.style.position="relative";this.subtractsBorderForOverflowNotVisible=(bA.offsetTop===-5);this.doesNotIncludeMarginInBodyOffset=(e.offsetTop!==bw);e.removeChild(bv);b.offset.initialize=b.noop},bodyOffset:function(e){var bw=e.offsetTop,bv=e.offsetLeft;b.offset.initialize();if(b.offset.doesNotIncludeMarginInBodyOffset){bw+=parseFloat(b.css(e,"marginTop"))||0;bv+=parseFloat(b.css(e,"marginLeft"))||0}return{top:bw,left:bv}},setOffset:function(bx,bG,bA){var bB=b.css(bx,"position");if(bB==="static"){bx.style.position="relative"}var bz=b(bx),bv=bz.offset(),e=b.css(bx,"top"),bE=b.css(bx,"left"),bF=(bB==="absolute"||bB==="fixed")&&b.inArray("auto",[e,bE])>-1,bD={},bC={},bw,by;if(bF){bC=bz.position();bw=bC.top;by=bC.left}else{bw=parseFloat(e)||0;by=parseFloat(bE)||0}if(b.isFunction(bG)){bG=bG.call(bx,bA,bv)}if(bG.top!=null){bD.top=(bG.top-bv.top)+bw}if(bG.left!=null){bD.left=(bG.left-bv.left)+by}if("using" in bG){bG.using.call(bx,bD)}else{bz.css(bD)}}};b.fn.extend({position:function(){if(!this[0]){return null}var bw=this[0],bv=this.offsetParent(),bx=this.offset(),e=ad.test(bv[0].nodeName)?{top:0,left:0}:bv.offset();bx.top-=parseFloat(b.css(bw,"marginTop"))||0;bx.left-=parseFloat(b.css(bw,"marginLeft"))||0;e.top+=parseFloat(b.css(bv[0],"borderTopWidth"))||0;e.left+=parseFloat(b.css(bv[0],"borderLeftWidth"))||0;return{top:bx.top-e.top,left:bx.left-e.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||au.body;while(e&&(!ad.test(e.nodeName)&&b.css(e,"position")==="static")){e=e.offsetParent}return e})}});b.each(["Left","Top"],function(bv,e){var bw="scroll"+e;b.fn[bw]=function(bz){var bx,by;if(bz===N){bx=this[0];if(!bx){return null}by=aJ(bx);return by?("pageXOffset" in by)?by[bv?"pageYOffset":"pageXOffset"]:b.support.boxModel&&by.document.documentElement[bw]||by.document.body[bw]:bx[bw]}return this.each(function(){by=aJ(this);if(by){by.scrollTo(!bv?bz:b(by).scrollLeft(),bv?bz:b(by).scrollTop())}else{this[bw]=bz}})}});function aJ(e){return b.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false}b.each(["Height","Width"],function(bv,e){var bw=e.toLowerCase();b.fn["inner"+e]=function(){var bx=this[0];return bx&&bx.style?parseFloat(b.css(bx,bw,"padding")):null};b.fn["outer"+e]=function(by){var bx=this[0];return bx&&bx.style?parseFloat(b.css(bx,bw,by?"margin":"border")):null};b.fn[bw]=function(by){var bz=this[0];if(!bz){return by==null?null:this}if(b.isFunction(by)){return this.each(function(bD){var bC=b(this);bC[bw](by.call(this,bD,bC[bw]()))})}if(b.isWindow(bz)){var bA=bz.document.documentElement["client"+e];return bz.document.compatMode==="CSS1Compat"&&bA||bz.document.body["client"+e]||bA}else{if(bz.nodeType===9){return Math.max(bz.documentElement["client"+e],bz.body["scroll"+e],bz.documentElement["scroll"+e],bz.body["offset"+e],bz.documentElement["offset"+e])}else{if(by===N){var bB=b.css(bz,bw),bx=parseFloat(bB);return b.isNaN(bx)?bB:bx}else{return this.css(bw,typeof by==="string"?by:by+"px")}}}}});bc.jQuery=bc.$=b})(window);jQuery.Buffer=function(){var b=function(d){if(d){this.assign(d)}this._bufferedCommandList=[];this._bufferedCommands={}};b._buffers=[];b._pool=[];b.bufferForElement=function(d){if(d._jquery_buffer){return d._jquery_buffer}return this.bufferFromPool().assign(d)};b.bufferFromPool=function(){var d=null;if(this._pool.length===0){d=new b()}else{d=this._pool.pop()}b._buffers.push(d);if(!this.flushingScheduled){this.scheduleFlushing()}return d};b.returnToPool=function(d){d.unassign();this._pool.push(d)};b.scheduleFlushing=function(){this.flushingScheduled=true};b.flush=function(){var f=this._buffers,e,d=f.length;for(e=0;e<d;e++){f[e].flush();this.returnToPool(f[e])}this._buffers=[];this.flushingScheduled=false};b.prototype.assign=function(d){if(this._el){this.unassign()}this._el=d;this._el._jquery_buffer=this;return this};b.prototype.unassign=function(){if(!this._el){return}this._el._jquery_buffer=undefined;this._el=undefined;return this};b.prototype.flush=function(){var f=this._bufferedCommandList,e=f.length,d,g;for(d=0;d<e;d++){g=f[d];this[g](this._bufferedCommands[g]);delete this._bufferedCommands[g]}this._bufferedCommandList.length=0;this.unassign()};b.prototype.$=function(d,e){if(!e){e=this._el}if(d===""||d===undefined){d=e;e=undefined}return jQuery(d,e)};b.prototype.bufferedCommand=function(d){if(!this._bufferedCommands[d]){this._bufferedCommands[d]={};this._bufferedCommandList.push(d)}return this._bufferedCommands[d]};b.prototype.hasBufferedCommand=function(d){return !!this._bufferedCommands[d]};b.prototype.html=function(e){var d=this.bufferedCommand("flushContent");if(e===undefined){return d.text||d.html||this.$().html()}d.text=undefined;d.html=e};b.prototype.text=function(e){var d=this.bufferedCommand("flushContent");if(e===undefined){return d.text||d.html||this.$().text()}d.text=e;d.html=undefined};b.prototype.flushContent=function(d){if(d.text!==undefined){this.$().text(d.text)}else{if(d.html!==undefined){this.$().html(d.html)}}};b.prototype.attr=function(g,h){if(typeof g==="object"){for(var e in g){this.attr(e,g[e])}return}if(g==="class"){if(h===undefined){return this.setClass().join(" ")}else{if(typeof h==="string"||jQuery.isArray(h)){var d=this.bufferedCommand("flushClassNames");d.classNames=this._hashFromClassNames(h);return}else{return this.setClass(h)}}}else{if(g==="html"){return this.html(h)}else{if(g==="text"){return this.text(h)}else{if(g==="style"){return this.resetStyles(h)}}}}var f=this.bufferedCommand("flushAttributes");if(!f.attr){f.attr={}}f.attr[g]=h};b.prototype.flushAttributes=function(g){var d=g.attr,h=this.$(),e;for(var f in d){if(!d.hasOwnProperty(f)){continue}e=d[f];if(e!==null){h.attr(f,e)}else{h.removeAttr(f)}}};b.prototype._STYLE_REGEX=/-?\s*([^:\s]+)\s*:\s*([^;]+)\s*;?/g;b.prototype._camelizeStyleName=function(d){var e=d.match(/^-(webkit|moz|o)-/),f=d.camelize();if(e){return f.substr(0,1).toUpperCase()+f.substr(1)}else{return f}};b.prototype._dasherizeStyleName=function(d){var e=SC.String.dasherize(d);if(e.match(/^(webkit|moz|ms|o)-/)){e="-"+e}return e};b.prototype._loadStyles=function(d){if(!d){d=this.$().attr("style")}if(d&&(d=d.toString()).length>0){if(SC.browser.isIE){d=d.toLowerCase()}var g={};var f=this._STYLE_REGEX,e;f.lastIndex=0;while(e=f.exec(d)){g[this._camelizeStyleName(e[1])]=e[2]}return g}else{return{}}};b.prototype.resetStyles=function(e){var d=this.bufferedCommand("flushStyles");d._styles=this._loadStyles(e||" ")};b.prototype.styles=function(){var d=this.bufferedCommand("flushStyles");if(!d._styles){d._styles=this._loadStyles()}return d._styles};b.prototype.css=function(f,g){if(typeof f==="object"){for(var d in f){this.css(d,f[d])}return}var e=this.bufferedCommand("flushStyles");if(!e._styles){e._styles=this._loadStyles()}e._styles[f]=g};b.prototype.flushStyles=function(f){var h=f._styles;var k="";var e,j,g=[],d=0;for(e in h){if(!h.hasOwnProperty(e)){continue}j=h[e];if(j===null){continue}if(typeof j==="number"&&e!=="zIndex"&&e!=="fontWeight"&&e!=="opacity"){j+="px"}g[d++]=this._dasherizeStyleName(e)+": "+j}this.$().attr("style",g.join("; "))};b.prototype._hashFromClassNames=function(g){if(typeof g==="string"){g=g.split(" ")}var e,d=g.length,f={};for(e=0;e<d;e++){f[g[e]]=true}return f};b.prototype.setClass=function(h,d){var g=this.bufferedCommand("flushClassNames"),f;if(h===undefined){if(!g.classNames){g.classNames=this._hashFromClassNames(this._el.className)}var j=g.classNames,e=[];for(f in j){if(f&&j[f]){e.push(f)}}return e}if(typeof h==="object"){if(!g.classNames){g.classNames=this._hashFromClassNames(this._el.className)}for(f in h){g.classNames[f]=h[f]}return}if(!g.classNames){g.classNames=this._hashFromClassNames(this._el.className)}g.classNames[h]=d||false};b.prototype.hasClass=function(e){var d=this.bufferedCommand("flushClassNames");if(!d.classNames){d.classNames=this._hashFromClassNames(this._el.className)}return !!d.classNames[e]};b.prototype.addClass=function(g){if(!g){return}var f=this.bufferedCommand("flushClassNames");if(!f.classNames){f.classNames=this._hashFromClassNames(this._el.className)}if(typeof g==="string"){g=g.split(" ")}var e,d=g.length;for(e=0;e<d;e++){f.classNames[jQuery.trim(g[e])]=true}};b.prototype.removeClass=function(e){var d=this.bufferedCommand("flushClassNames");if(e===undefined){d.classNames={}}else{if(!d.classNames){d.classNames=this._hashFromClassNames(this._el.className)}d.classNames[e]=false}};b.prototype.resetClassNames=function(e){var d=this.bufferedCommand("flushClassNames");d.classNames={}};b.prototype.flushClassNames=function(e){var f=[];var g=e.classNames,d;for(d in g){if(g[d]){f.push(d)}}this.$().attr("class",f.join(" "))};function a(e){for(var d in e){if(typeof e[d]==="function"){e[d].displayName=d}}}a(b);a(b.prototype);return b}();(function(){jQuery.buffer=jQuery.bufferedJQuery=jQuery.sub();jQuery.bufferedJQuery.fn.extend({html:function(e){if(e===undefined){if(this.length<1){return undefined}return jQuery.Buffer.bufferForElement(this[0]).html()}var a=this.length,d,b;for(d=0;d<a;d++){b=jQuery.Buffer.bufferForElement(this[d]);b.html(e)}return this},text:function(e){if(e===undefined){if(this.length<1){return undefined}return jQuery.Buffer.bufferForElement(this[0]).text()}var a=this.length,d,b;for(d=0;d<a;d++){b=jQuery.Buffer.bufferForElement(this[d]);b.text(e)}return this},attr:function(e,f){var b;if(typeof f==="undefined"&&typeof e==="string"){if(this.length<1){return false}b=jQuery.Buffer.bufferForElement(this[0]);return b.attr(e)}var a=this.length,d;for(d=0;d<a;d++){b=jQuery.Buffer.bufferForElement(this[d]);b.attr(e,f)}return this},hasClass:function(a){if(this.length<1){return false}return jQuery.Buffer.bufferForElement(this[0]).hasClass(a)},setClass:function(f,d){var a=this.length,e,b;for(e=0;e<a;e++){b=jQuery.Buffer.bufferForElement(this[e]);b.setClass(f,d)}return this},addClass:function(e){var a=this.length,d,b;for(d=0;d<a;d++){b=jQuery.Buffer.bufferForElement(this[d]);b.addClass(e)}return this},removeClass:function(e){var a=this.length,d,b;for(d=0;d<a;d++){b=jQuery.Buffer.bufferForElement(this[d]);b.removeClass(e)}return this},resetClassNames:function(){var a=this.length,d,b;for(d=0;d<a;d++){b=jQuery.Buffer.bufferForElement(this[d]);b.resetClassNames()}return this},css:function(e,f){var a=this.length,d,b;for(d=0;d<a;d++){b=jQuery.Buffer.bufferForElement(this[d]);b.css(e,f)}return this},styles:function(){if(this.length<1){return null}return jQuery.Buffer.bufferForElement(this[0]).styles()},resetStyles:function(){if(this.length<1){return null}jQuery.Buffer.bufferForElement(this[0]).resetStyles();return this}})})();jQuery.Buffer._flush=function(){jQuery.Buffer.flush()};jQuery.Buffer.scheduleFlushing=function(){SC.RunLoop.currentRunLoop.invokeOnce(jQuery.Buffer._flush);this.flushingScheduled=true};if(!window.require){window.require=function sc_require(){}}window.sc_require=function sc_require(){};if(!window.sc_resource){window.sc_resource=function sc_resource(){}}sc_require("license");window.YES=true;window.NO=false;if(typeof console==="undefined"){window.console={};console.log=console.info=console.warn=console.error=function(){}}window.SC=window.SC||{};window.SproutCore=window.SproutCore||SC;SC=window.SC;SC.VERSION="1.9.2";SC._baseMixin=function(d){var g=Array.prototype.slice.call(arguments,1),a,f=g[0]||{},h=1,e=g.length,k,b,j;if(e===1){f=this||{};h=0}for(;h<e;h++){if(!(k=g[h])){continue}for(j in k){if(!k.hasOwnProperty(j)){continue}b=k[j];if(f===b){continue}if(b!==undefined&&(d||(f[j]===undefined))){f[j]=b}}if(k.hasOwnProperty("toString")){f.toString=k.toString}}return f};SC.mixin=function(){var a=Array.prototype.slice.call(arguments);a.unshift(true);return SC._baseMixin.apply(this,a)};SC.supplement=function(){var a=Array.prototype.slice.call(arguments);a.unshift(false);return SC._baseMixin.apply(this,a)};SC.extend=SC.mixin;SC.mixin({T_ERROR:"error",T_OBJECT:"object",T_NULL:"null",T_CLASS:"class",T_HASH:"hash",T_FUNCTION:"function",T_UNDEFINED:"undefined",T_NUMBER:"number",T_BOOL:"boolean",T_ARRAY:"array",T_STRING:"string",T_DATE:"date",T_REGEXP:"regexp",typeOf:function(a){if(a===undefined){return SC.T_UNDEFINED}if(a===null){return SC.T_NULL}var b=jQuery.type(a);if(b==="function"){return a.isClass?SC.T_CLASS:SC.T_FUNCTION}else{if(b==="object"){if(SC.Error&&(a instanceof SC.Error)){return SC.T_ERROR}else{if(a instanceof SC.Object){return SC.T_OBJECT}else{return SC.T_HASH}}}}return b},none:function(a){return a==null},empty:function(a){return a===null||a===undefined||a===""},isArray:function(a){if(!a||a.setInterval){return false}if(Array.isArray&&Array.isArray(a)){return true}if(a.objectAt){return true}if(a.length!==undefined&&jQuery.type(a)==="object"){return true}return false},makeArray:function(a){return SC.isArray(a)?a:SC.A(a)},A:function(d){if(d===null||d===undefined){return[]}if(d.slice instanceof Function){if(typeof(d)==="string"){return[d]}else{return d.slice()}}if(d.toArray){return d.toArray()}if(!SC.isArray(d)){return[d]}var b=[],a=d.length;while(--a>=0){b[a]=d[a]}return b},guidKey:"SproutCore"+(SC.VERSION+Math.random()).replace(/\D/g,""),_guidPrefixes:{number:"nu",string:"st"},_guidCaches:{number:{},string:{}},_numberGuids:[],_stringGuids:{},_keyCache:{},guidFor:function(f){var b,d,e=typeof f;if(f===undefined){return"(undefined)"}if(f===null){return"(null)"}if(e===SC.T_NUMBER||e===SC.T_STRING){b=this._guidCaches[e];d=b[f];if(!d){d="st"+(jQuery.uuid++);b[f]=d}return d}else{if(e===SC.T_BOOL){return(f)?"(true)":"(false)"}}var a=this.guidKey;if(f[a]){return f[a]}if(f===Object){return"(Object)"}if(f===Array){return"(Array)"}return SC.generateGuid(f,"sc")},keyFor:function(e,d){var b,a=this._keyCache[e];if(!a){a=this._keyCache[e]={}}b=a[d];if(!b){b=a[d]=e+"_"+d}return b},generateGuid:function(d,b){var a=(b+(jQuery.uuid++));if(d){d[this.guidKey]=a}return a},hashFor:function(){var a=arguments.length,d="",g,e,b;for(b=0;b<a;++b){g=arguments[b];d+=(g&&(e=g.hash)&&(typeof e===SC.T_FUNCTION))?e.call(g):this.guidFor(g)}return d===""?null:d},isEqual:function(e,d){return this.hashFor(e)===this.hashFor(d)},compare:function(t,q){if(t===q){return 0}var k=SC.typeOf(t);var h=SC.typeOf(q);var b=SC.ORDER_DEFINITION_MAPPING;if(!b){var e=SC.ORDER_DEFINITION;b=SC.ORDER_DEFINITION_MAPPING={};var s,o;for(s=0,o=e.length;s<o;++s){b[e[s]]=s}delete SC.ORDER_DEFINITION}var u=b[k];var d=b[h];if(u<d){return -1}if(u>d){return 1}switch(k){case SC.T_BOOL:case SC.T_NUMBER:case SC.T_DATE:if(t<q){return -1}if(t>q){return 1}return 0;case SC.T_STRING:var m=t.localeCompare(q);if(m<0){return -1}if(m>0){return 1}return 0;case SC.T_ARRAY:var p=t.length;var n=q.length;var f=Math.min(p,n);var a=0;var j=0;var g=arguments.callee;while(a===0&&j<f){a=g(t[j],q[j]);j++}if(a!==0){return a}if(p<n){return -1}if(p>n){return 1}return 0;case SC.T_OBJECT:if(t.constructor.isComparable===YES){return t.constructor.compare(t,q)}return 0;default:return 0}},K:function(){return this},EMPTY_ARRAY:[],EMPTY_HASH:{},EMPTY_RANGE:{start:0,length:0},beget:function(d){if(d===null||d===undefined){return null}var a=SC.K;a.prototype=d;var b=new a();a.prototype=null;if(typeof d.didBeget==="function"){b=d.didBeget(b)}return b},copy:function(e,b){var d=e,a;if(e){if(e.isCopyable){return e.copy(b)}if(e.clone){return e.clone()}}switch(jQuery.type(e)){case"array":d=e.slice();if(b){a=d.length;while(a--){d[a]=SC.copy(d[a],true)}}break;case"object":d={};for(var f in e){d[f]=b?SC.copy(e[f],true):e[f]}}return d},merge:function(){var d={},b=arguments.length,a;for(a=0;a<b;a++){SC.mixin(d,arguments[a])}return d},keys:function(d){var a=[];for(var b in d){a.push(b)}return a},inspect:function(e){var a,b=[];for(var d in e){a=e[d];if(a==="toString"){continue}if(SC.typeOf(a)===SC.T_FUNCTION){a="function() { ... }"}b.push(d+": "+a)}return"{"+b.join(" , ")+"}"},tupleForPropertyPath:function(f,a){if(typeof f==="object"&&(f instanceof Array)){return f}var d;var b=f.indexOf("*");if(b<0){b=f.lastIndexOf(".")}d=(b>=0)?f.slice(b+1):f;var e=this.objectForPropertyPath(f,a,b);return(e&&d)?[e,d]:null},objectForPropertyPath:function(g,d,e){var h,b,f,a;if(!d){d=window}if(SC.typeOf(g)===SC.T_STRING){if(e===undefined){e=g.length}h=0;while((d)&&(h<e)){b=g.indexOf(".",h);if((b<0)||(b>e)){b=e}f=g.slice(h,b);d=d.get?d.get(f):d[f];h=b+1}if(h<e){d=undefined}}else{h=0;a=g.length;f=null;while((h<a)&&d){f=g[h++];if(f){d=(d.get)?d.get(f):d[f]}}if(h<a){d=undefined}}return d},requiredObjectForPropertyPath:function(d,a,b){var e=SC.objectForPropertyPath(d,a,b);if(!e){throw d+" could not be found"}return e}});SC.clone=SC.copy;SC.$A=SC.A;SC.didLoad=SC.K;SC.ORDER_DEFINITION=[SC.T_ERROR,SC.T_UNDEFINED,SC.T_NULL,SC.T_BOOL,SC.T_NUMBER,SC.T_STRING,SC.T_ARRAY,SC.T_HASH,SC.T_OBJECT,SC.T_FUNCTION,SC.T_CLASS];SC.Function={property:function(b,d){b.dependentKeys=SC.$A(d);var a=SC.guidFor(b);b.cacheKey="__cache__"+a;b.lastSetValueKey="__lastValue__"+a;b.isProperty=true;return b},cacheable:function(a,b){a.isProperty=true;if(!a.dependentKeys){a.dependentKeys=[]}a.isCacheable=(b===undefined)?true:b;return a},idempotent:function(a,b){a.isProperty=true;if(!a.dependentKeys){this.dependentKeys=[]}a.isVolatile=(b===undefined)?true:b;return a},enhance:function(a){a.isEnhancement=true;return a},observes:function(d,a){var g=a.length,b=null,f=null;while(--g>=0){var e=a[g];if((e.indexOf(".")<0)&&(e.indexOf("*")<0)){if(!b){b=d.localPropertyPaths=[]}b.push(e)}else{if(!f){f=d.propertyPaths=[]}f.push(e)}}return d}};sc_require("system/function");SC.mixin(Function.prototype,{property:function(){return SC.Function.property(this,arguments)},cacheable:function(a){return SC.Function.cacheable(this,a)},idempotent:function(a){return SC.Function.idempotent(this,a)},enhance:function(){return SC.Function.enhance(this)},observes:function(a){return SC.Function.observes(this,arguments)}});SC.ObserverSet={add:function(l,a,d){var b=SC.guidFor(l),g=SC.guidFor(a),k=this._members,e=this.members,h=k[b],j,f;if(!h){h=k[b]={}}j=h[g];if(j===undefined){h[g]=e.length;f=[l,a,d];e.push(f)}else{}},remove:function(h,j){var f=SC.guidFor(h),b=SC.guidFor(j);var e=this._members[f],a=this.members;if(!e){return false}var d=e[b];if(d===undefined){return false}if(d!==a.length-1){var g=(a[d]=a[a.length-1]);this._members[SC.guidFor(g[0])][SC.guidFor(g[1])]=d}a.pop();delete this._members[f][b];return true},invokeMethods:function(){var b=this.members,e;for(var d=0,a=b.length;d<a;d++){e=b[d];e[1].call(e[0])}},clone:function(){var d=SC.ObserverSet.create(),e=this.members;d._members=SC.clone(this._members);var f=d.members;for(var b=0,a=e.length;b<a;b++){f[b]=SC.clone(e[b]);f[b].length=3}return d},create:function(){return new SC.ObserverSet.constructor()},getMembers:function(){return this.members.slice(0)},constructor:function(){this._members={};this.members=[]}};SC.ObserverSet.constructor.prototype=SC.ObserverSet;SC.ObserverSet.slice=SC.ObserverSet.clone;SC.ObserverSet.copy=SC.ObserverSet.clone;SC._ChainObserver=function(b,a){this.property=b;this.root=a||this};SC._ChainObserver.createChain=function(g,n,h,a,b){var e=n.split("."),k=new SC._ChainObserver(e[0]),j=k;for(var f=1,d=e.length;f<d;f++){j=j.next=new SC._ChainObserver(e[f],k)}var m=k.tails=[j];k.objectDidChange(g);m.forEach(function(l){l.target=h;l.method=a;l.context=b});k.tails=null;return k};SC._ChainObserver.prototype={isChainObserver:true,object:null,property:null,next:null,root:null,target:null,method:null,tail:function(){if(this._tail){return this._tail}var a=this;while(a.next){a=a.next}this._tail=a;return a},objectDidChange:function(a){if(a===this.object){return}if(this.object){if(this.property==="@each"&&this.object._removeContentObserver){this.object._removeContentObserver(this)}else{if(this.object.removeObserver){this.object.removeObserver(this.property,this,this.propertyDidChange)}}}this.object=a;if(this.property==="@each"&&this.next){if(this.object&&this.object._addContentObserver){this.object._addContentObserver(this)}}else{if(this.object&&this.object.addObserver){this.object.addObserver(this.property,this,this.propertyDidChange)}this.propertyDidChange()}},propertyDidChange:function(){var b=this.object;var f=this.property;var e=(b&&b.get)?b.get(f):null;if(this.next){this.next.objectDidChange(e)}var g=this.target,h=this.method,d=this.context;if(g&&h){var a=b?b.propertyRevision:null;if(d){h.call(g,b,f,e,d,a)}else{h.call(g,b,f,e,a)}}},destroyChain:function(){var a=this.object;if(a){if(this.property==="@each"&&this.next&&a._removeContentObserver){a._removeContentObserver(this)}if(a.removeObserver){a.removeObserver(this.property,this,this.propertyDidChange)}}if(this.next){this.next.destroyChain()}this.next=this.target=this.method=this.object=this.context=null;return null}};sc_require("ext/function");sc_require("private/observer_set");sc_require("private/chain_observer");SC.LOG_OBSERVERS=NO;SC.OBSERVES_HANDLER_ADD=0;SC.OBSERVES_HANDLER_REMOVE=1;SC.Observable={isObservable:YES,automaticallyNotifiesObserversFor:function(a){return YES},get:function(d){var b=this[d],a;if(b===undefined){return this.unknownProperty(d)}else{if(b&&b.isProperty){if(b.isCacheable){a=this._kvo_cache;if(!a){a=this._kvo_cache={}}return(a[b.cacheKey]!==undefined)?a[b.cacheKey]:(a[b.cacheKey]=b.call(this,d))}else{return b.call(this,d)}}else{return b}}},set:function(k,h){var b=this[k],l=this.automaticallyNotifiesObserversFor(k),g=h,e,a,j,f;if(h===undefined&&SC.typeOf(k)===SC.T_HASH){var d=k;for(k in d){if(!d.hasOwnProperty(k)){continue}this.set(k,d[k])}return this}if(!l&&this._kvo_cacheable&&(a=this._kvo_cache)){e=this._kvo_cachedep;if(!e||(e=e[k])===undefined){e=this._kvo_computeCachedDependentsFor(k)}if(e){j=e.length;while(--j>=0){f=e[j];a[f.cacheKey]=a[f.lastSetValueKey]=undefined}}}if(b&&b.isProperty){a=this._kvo_cache;if(b.isVolatile||!a||(a[b.lastSetValueKey]!==h)){if(!a){a=this._kvo_cache={}}a[b.lastSetValueKey]=h;if(l){this.propertyWillChange(k)}g=b.call(this,k,h);if(b.isCacheable){a[b.cacheKey]=g}if(l){this.propertyDidChange(k,g,YES)}}}else{if(b===undefined){if(l){this.propertyWillChange(k)}this.unknownProperty(k,h);if(l){this.propertyDidChange(k,g)}}else{if(this[k]!==h){if(l){this.propertyWillChange(k)}g=this[k]=h;if(l){this.propertyDidChange(k,g)}}}}return this},unknownProperty:function(a,b){if(!(b===undefined)){this[a]=b}return b},beginPropertyChanges:function(){this._kvo_changeLevel=(this._kvo_changeLevel||0)+1;return this},endPropertyChanges:function(){this._kvo_changeLevel=(this._kvo_changeLevel||1)-1;var b=this._kvo_changeLevel,a=this._kvo_changes;if((b<=0)&&a&&(a.length>0)&&!SC.Observers.isObservingSuspended){this._notifyPropertyObservers()}return this},propertyWillChange:function(a){return this},propertyDidChange:function(p,n,d){this._kvo_revision=(this._kvo_revision||0)+1;var b=this._kvo_changeLevel||0,j,o,k,e,g=SC.LOG_OBSERVERS&&(this.LOG_OBSERVING!==NO);var l=this._kvo_property_chains;if(l){var h=l[p];if(h){this.beginPropertyChanges();h=SC.clone(h);h.forEach(function(q){q.notifyPropertyDidChange()});this.endPropertyChanges()}}var a=this._kvo_cache;if(a){if(!d){e=this[p];if(e&&e.isProperty){a[e.cacheKey]=a[e.lastSetValueKey]=undefined}}if(this._kvo_cacheable){j=this._kvo_cachedep;if(!j||(j=j[p])===undefined){j=this._kvo_computeCachedDependentsFor(p)}if(j){o=j.length;while(--o>=0){k=j[o];a[k.cacheKey]=a[k.lastSetValueKey]=undefined}}}}var f=SC.Observers.isObservingSuspended;if((b>0)||f){var m=this._kvo_changes;if(!m){m=this._kvo_changes=SC.CoreSet.create()}m.add(p);if(f){if(g){SC.Logger.log("%@%@: will not notify observers because observing is suspended".fmt(SC.KVO_SPACES,this))}SC.Observers.objectHasPendingChanges(this)}}else{this._notifyPropertyObservers(p)}return this},registerDependentKey:function(j,d){var f=this._kvo_dependents,k=this._kvo_chain_dependents,b=this[j],l,h,a,g,e;if(typeof d==="object"&&(d instanceof Array)){l=d;a=0}else{l=arguments;a=1}h=l.length;if(!f){this._kvo_dependents=f={}}while(--h>=a){g=l[h];if(g.indexOf(".")>=0){SC._PropertyChain.createChain(g,this,j).activate()}else{e=f[g];if(!e){e=f[g]=[]}e.push(j)}}},registerDependentKeyWithChain:function(d,a){var e=this._chainsFor(d),b;e.add(a)},removeDependentKeyWithChain:function(d,a){var e=this._chainsFor(d),b;e.remove(a);if(e.get("length")===0){delete this._kvo_property_chains[d]}},_chainsFor:function(a){this._kvo_property_chains=this._kvo_property_chains||{};var b=this._kvo_property_chains[a]||SC.CoreSet.create();this._kvo_property_chains[a]=b;return b},_kvo_addCachedDependents:function(b,g,j,d){var a=g.length,f,e,h;while(--a>=0){e=g[a];d.add(e);f=this[e];if(f&&(f instanceof Function)&&f.isProperty){if(f.isCacheable){b.push(f)}if((h=j[e])&&h.length>0){this._kvo_addCachedDependents(b,h,j,d)}}}},_kvo_computeCachedDependentsFor:function(d){var e=this._kvo_cachedep,g=this._kvo_dependents,f=g?g[d]:null,a,b;if(!e){e=this._kvo_cachedep={}}if(!f||f.length===0){return e[d]=null}a=e[d]=[];b=SC._TMP_SEEN_SET=(SC._TMP_SEEN_SET||SC.CoreSet.create());b.add(d);this._kvo_addCachedDependents(a,f,g,b);b.clear();if(a.length===0){a=e[d]=null}return a},_kvo_for:function(d,b){var a=this[d];if(!this._kvo_cloned){this._kvo_cloned={}}if(!a){a=this[d]=(b===undefined)?[]:b.create();this._kvo_cloned[d]=YES}else{if(!this._kvo_cloned[d]){a=this[d]=a.copy();this._kvo_cloned[d]=YES}}return a},addObserver:function(d,g,j,b){var e,a,f,h;if(j===undefined){j=g;g=this}if(!g){g=this}if(typeof j==="string"){j=g[j]}if(!j){throw"You must pass a method to addObserver()"}d=d.toString();if(d.indexOf(".")>=0){a=SC._ChainObserver.createChain(this,d,g,j,b);a.masterTarget=g;a.masterMethod=j;this._kvo_for(SC.keyFor("_kvo_chains",d)).push(a)}else{if((this[d]===undefined)&&(d.indexOf("@")===0)){this.get(d)}if(g===this){g=null}e=SC.keyFor("_kvo_observers",d);this._kvo_for(e,SC.ObserverSet).add(g,j,b);this._kvo_for("_kvo_observed_keys",SC.CoreSet).add(d)}if(this.didAddObserver){this.didAddObserver(d,g,j)}return this},removeObserver:function(d,g,j){var e,f,b,h,a;if(j===undefined){j=g;g=this}if(!g){g=this}if(typeof j==="string"){j=g[j]}if(!j){throw"You must pass a method to removeObserver()"}d=d.toString();if(d.indexOf(".")>=0){e=SC.keyFor("_kvo_chains",d);if(f=this[e]){f=this._kvo_for(e);a=f.length;while(--a>=0){b=f[a];if(b&&(b.masterTarget===g)&&(b.masterMethod===j)){f[a]=b.destroyChain()}}}}else{if(g===this){g=null}e=SC.keyFor("_kvo_observers",d);if(h=this[e]){h=this._kvo_for(e);h.remove(g,j);if(h.getMembers().length===0){this._kvo_for("_kvo_observed_keys",SC.CoreSet).remove(d)}}}if(this.didRemoveObserver){this.didRemoveObserver(d,g,j)}return this},hasObserverFor:function(b){SC.Observers.flush(this);var e=this[SC.keyFor("_kvo_observers",b)],d=this[SC.keyFor("_kvo_local",b)],a;if(d&&d.length>0){return YES}if(e&&e.getMembers().length>0){return YES}return NO},initObservable:function(){if(this._observableInited){return}this._observableInited=YES;var g,o,m,l,j,f,n,h,d,p,b,k,e,a;if(o=this._observers){h=o.length;for(g=0;g<h;g++){m=o[g];j=this[m];f=j.propertyPaths;n=(f)?f.length:0;for(d=0;d<n;d++){p=f[d];this.addObservesHandler(j,p)}}}this.bindings=[];if(o=this._bindings){for(g=0,a=o.length;g<a;g++){m=o[g];l=this[m];e=m.slice(0,-7);this[m]=this.bind(e,l)}}if(o=this._properties){for(g=0,a=o.length;g<a;g++){m=o[g];if(l=this[m]){if(l.isCacheable){this._kvo_cacheable=YES}if(l.dependentKeys&&(l.dependentKeys.length>0)){this.registerDependentKey(m,l.dependentKeys)}}}}delete this._observers;delete this._bindings;delete this._properties},addObservesHandler:function(a,b){this._configureObservesHandler(SC.OBSERVES_HANDLER_ADD,a,b);return this},removeObservesHandler:function(a,b){this._configureObservesHandler(SC.OBSERVES_HANDLER_REMOVE,a,b);return this},_configureObservesHandler:function(e,b,f){var d,a;switch(e){case SC.OBSERVES_HANDLER_ADD:e="addObserver";break;case SC.OBSERVES_HANDLER_REMOVE:e="removeObserver";break;default:throw"invalid action provided: "+e}d=f.indexOf(".");if(d<0){this[e](f,this,b)}else{if(f.indexOf("*")===0){this[e](f.slice(1),this,b)}else{a=null;if(d===0){a=this;f=f.slice(1)}else{if(d===4&&f.slice(0,5)==="this."){a=this;f=f.slice(5)}else{if(d<0&&f.length===4&&f==="this"){a=this;f=""}else{if(d>0&&f[0]===f.charAt(0).toLowerCase()){a=this}}}}SC.Observers[e](f,this,b,a)}}},observersForKey:function(a){SC.Observers.flush(this);var b=this[SC.keyFor("_kvo_observers",a)];return b?b.getMembers():[]},_notifyPropertyObservers:function(w){if(!this._observableInited){this.initObservable()}SC.Observers.flush(this);var h=SC.LOG_OBSERVERS&&!(this.LOG_OBSERVING===NO),q,u,o,e,p,n,t,s,l,a,g,v,d,k,f,b,j,m;if(h){j=SC.KVO_SPACES=(SC.KVO_SPACES||"")+"  ";SC.Logger.log('%@%@: notifying observers after change to key "%@"'.fmt(j,this,w))}e=this["_kvo_observers_*"];this._kvo_changeLevel=(this._kvo_changeLevel||0)+1;while(((u=this._kvo_changes)&&(u.length>0))||w){t=++this.propertyRevision;if(!u){u=SC.CoreSet.create()}this._kvo_changes=null;if(w==="*"){u.add("*");u.addEach(this._kvo_for("_kvo_observed_keys",SC.CoreSet))}else{if(w){u.add(w)}}if(o=this._kvo_dependents){for(p=0;p<u.length;p++){w=u[p];n=o[w];if(n&&(k=n.length)){if(h){SC.Logger.log("%@...including dependent keys for %@: %@".fmt(j,w,n))}m=this._kvo_cache;if(!m){m=this._kvo_cache={}}while(--k>=0){u.add(w=n[k]);if(f=this[w]){this[f.cacheKey]=undefined;m[f.cacheKey]=m[f.lastSetValueKey]=undefined}}}}}while(u.length>0){w=u.pop();q=this[SC.keyFor("_kvo_observers",w)];if(q){s=SC.clone(q.getMembers());l=s.length;for(g=0;g<l;g++){a=s[g];if(a[3]===t){continue}if(!a[1]){SC.Logger.log(a)}v=a[0]||this;d=a[1];b=a[2];a[3]=t;if(h){SC.Logger.log('%@...firing observer on %@ for key "%@"'.fmt(j,v,w))}if(b!==undefined){d.call(v,this,w,null,b,t)}else{d.call(v,this,w,null,t)}}}s=this[SC.keyFor("_kvo_local",w)];if(s){l=s.length;for(g=0;g<l;g++){a=s[g];d=this[a];if(d){if(h){SC.Logger.log('%@...firing local observer %@.%@ for key "%@"'.fmt(j,this,a,w))}d.call(this,this,w,null,t)}}}if(e&&w!=="*"){s=SC.clone(e.getMembers());l=s.length;for(g=0;g<l;g++){a=s[g];v=a[0]||this;d=a[1];b=a[2];if(h){SC.Logger.log('%@...firing * observer on %@ for key "%@"'.fmt(j,v,w))}if(b!==undefined){d.call(v,this,w,null,b,t)}else{d.call(v,this,w,null,t)}}}if(this.propertyObserver){if(h){SC.Logger.log('%@...firing %@.propertyObserver for key "%@"'.fmt(j,this,w))}this.propertyObserver(this,w,null,t)}}if(u){u.destroy()}w=null}this._kvo_changeLevel=(this._kvo_changeLevel||1)-1;if(h){SC.KVO_SPACES=j.slice(0,-2)}return YES},bind:function(a,d,f){var e,b;if(f!==undefined){d=[d,f]}b=typeof d;if(b==="string"||(b==="object"&&(d instanceof Array))){e=this[a+"BindingDefault"]||SC.Binding;e=e.beget().from(d)}else{e=d.beget()}e=e.to(a,this).connect();this.bindings.push(e);return e},didChangeFor:function(a){var b,g,f,l,e,d,j,k,h;a=SC.hashFor(a);b=this._kvo_didChange_valueCache;if(!b){b=this._kvo_didChange_valueCache={}}g=this._kvo_didChange_revisionCache;if(!g){g=this._kvo_didChange_revisionCache={}}f=b[a]||{};l=g[a]||{};e=false;d=this._kvo_revision||0;j=arguments.length;while(--j>=1){k=arguments[j];if(l[k]!=d){h=this.get(k);if(f[k]!==h){e=true;f[k]=h}}l[k]=d}b[a]=f;g[a]=l;return e},setIfChanged:function(a,b){if(b===undefined&&SC.typeOf(a)===SC.T_HASH){var d=a;for(a in d){if(!d.hasOwnProperty(a)){continue}this.setIfChanged(a,d[a])}return this}return(this.get(a)!==b)?this.set(a,b):this},getPath:function(b){var a=SC.tupleForPropertyPath(b,this);if(a===null||a[0]===null){return undefined}return SC.get(a[0],a[1])},setPath:function(d,b){if(d.indexOf(".")>=0){var a=SC.tupleForPropertyPath(d,this);if(!a||!a[0]){return null}a[0].set(a[1],b)}else{this.set(d,b)}return this},setPathIfChanged:function(d,b){if(d.indexOf(".")>=0){var a=SC.tupleForPropertyPath(d,this);if(!a||!a[0]){return null}if(a[0].get(a[1])!==b){a[0].set(a[1],b)}}else{this.setIfChanged(d,b)}return this},getEach:function(){var e=SC.A(arguments),d=[],a,b;for(a=0,b=e.length;a<b;a++){d[d.length]=this.getPath(e[a])}return d},incrementProperty:function(b,a){if(!a){a=1}this.set(b,(this.get(b)||0)+a);return this.get(b)},decrementProperty:function(b,a){if(!a){a=1}this.set(b,(this.get(b)||0)-a);return this.get(b)},toggleProperty:function(a,b,d){if(b===undefined){b=true}if(d===undefined){d=false}b=(this.get(a)==b)?d:b;this.set(a,b);return this.get(a)},notifyPropertyChange:function(a,b){this.propertyWillChange(a);this.propertyDidChange(a,b);return this},allPropertiesDidChange:function(){this._kvo_cache=null;this._notifyPropertyObservers("*");return this},addProbe:function(a){this.addObserver(a,SC.logChange)},removeProbe:function(a){this.removeObserver(a,SC.logChange)},logProperty:function(){var b=SC.$A(arguments),e,d,a;for(a=0,d=b.length;a<d;a++){e=b[a];SC.Logger.log("%@:%@: ".fmt(SC.guidFor(this),e),this.get(e))}},propertyRevision:1};SC.logChange=function logChange(d,a,b){SC.Logger.log("CHANGE: %@[%@] => %@".fmt(d,a,d.get(a)))};SC.mixin(SC,{get:function(a,b){if(!a){return undefined}if(b===undefined){return this[a]}if(a.get){return a.get(b)}return a[b]},getPath:function(a,b){if(b===undefined){b=a;a=window}return SC.objectForPropertyPath(b,a)}});SC.mixin(Array.prototype,SC.Observable);SC.Enumerator=function(a){this.enumerable=a;this.reset();return this};SC.Enumerator.prototype={nextObject:function(){var d=this._index;var a=this._length;if(d>=a){return undefined}var b=this.enumerable.nextObject(d,this._previousObject,this._context);this._previousObject=b;this._index=d+1;if(d>=a){this._context=SC.Enumerator._pushContext(this._context)}return b},reset:function(){var b=this.enumerable;if(!b){throw SC.$error("Enumerator has been destroyed")}this._length=b.get?b.get("length"):b.length;var a=this._length;this._index=0;this._previousObject=null;this._context=(a>0)?SC.Enumerator._popContext():null},destroy:function(){this.enumerable=this._length=this._index=this._previousObject=this._context=null}};SC.Enumerator.create=function(a){return new SC.Enumerator(a)};SC.Enumerator._popContext=function(){var a=this._contextCache?this._contextCache.pop():null;return a||{}};SC.Enumerator._pushContext=function(b){this._contextCache=this._contextCache||[];var a=this._contextCache;a.push(b);return null};sc_require("core");sc_require("ext/function");sc_require("system/enumerator");SC.Enumerable={isEnumerable:YES,nextObject:function(a,d,b){return this.objectAt?this.objectAt(a):this[a]},firstObject:function(){if(this.get("length")===0){return undefined}if(this.objectAt){return this.objectAt(0)}var b=SC.Enumerator._popContext(),a;a=this.nextObject(0,null,b);b=SC.Enumerator._pushContext(b);return a}.property().cacheable(),lastObject:function(){var a=this.get("length");if(a===0){return undefined}if(this.objectAt){return this.objectAt(a-1)}}.property().cacheable(),enumerator:function(){return SC.Enumerator.create(this)},forEach:function(h,g){if(typeof h!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(g===undefined){g=null}var f=null;var d=SC.Enumerator._popContext();for(var a=0;a<b;a++){var e=this.nextObject(a,f,d);h.call(g,e,a,this);f=e}f=null;d=SC.Enumerator._pushContext(d);return this},getEach:function(a){return this.map(function(b){return b?(b.get?b.get(a):b[a]):null},this)},setEach:function(a,b){this.forEach(function(d){if(d){if(d.set){d.set(a,b)}else{d[a]=b}}},this);return this},map:function(j,h){if(typeof j!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(h===undefined){h=null}var d=[];var g=null;var e=SC.Enumerator._popContext();for(var a=0;a<b;a++){var f=this.nextObject(a,g,e);d[a]=j.call(h,f,a,this);g=f}g=null;e=SC.Enumerator._pushContext(e);return d},mapProperty:function(a){return this.map(function(b){return b?(b.get?b.get(a):b[a]):null})},filter:function(j,h){if(typeof j!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(h===undefined){h=null}var d=[];var g=null;var e=SC.Enumerator._popContext();for(var a=0;a<b;a++){var f=this.nextObject(a,g,e);if(j.call(h,f,a,this)){d.push(f)}g=f}g=null;e=SC.Enumerator._pushContext(e);return d},sortProperty:function(b){var d=(typeof b===SC.T_STRING)?arguments:b,a=d.length,e;if(this instanceof Array){e=this}else{e=[];this.forEach(function(f){e.push(f)})}if(!e){return[]}return e.sort(function(h,g){var f,k,m,l,j=0;for(f=0;j===0&&f<a;f++){k=d[f];m=h?(h.get?h.get(k):h[k]):null;l=g?(g.get?g.get(k):g[k]):null;j=SC.compare(m,l)}return j})},filterProperty:function(l,g){var e=this.get?this.get("length"):this.length;var f=[];var k=null;var b=SC.Enumerator._popContext();for(var h=0;h<e;h++){var d=this.nextObject(h,k,b);var j=d?(d.get?d.get(l):d[l]):null;var a=(g===undefined)?!!j:SC.isEqual(j,g);if(a){f.push(d)}k=d}k=null;b=SC.Enumerator._pushContext(b);return f},find:function(j,e){var d=this.get?this.get("length"):this.length;if(e===undefined){e=null}var h=null,b,k=NO,f=null;var a=SC.Enumerator._popContext();for(var g=0;g<d&&!k;g++){b=this.nextObject(g,h,a);if(k=j.call(e,b,g,this)){f=b}h=b}b=h=null;a=SC.Enumerator._pushContext(a);return f},findProperty:function(k,g){var d=this.get?this.get("length"):this.length;var l=NO,e=null,j=null,b,h;var a=SC.Enumerator._popContext();for(var f=0;f<d&&!l;f++){b=this.nextObject(f,j,a);h=b?(b.get?b.get(k):b[k]):null;l=(g===undefined)?!!h:SC.isEqual(h,g);if(l){e=b}j=b}j=b=null;a=SC.Enumerator._pushContext(a);return e},every:function(j,h){if(typeof j!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(h===undefined){h=null}var d=YES;var g=null;var e=SC.Enumerator._popContext();for(var a=0;d&&(a<b);a++){var f=this.nextObject(a,g,e);if(!j.call(h,f,a,this)){d=NO}g=f}g=null;e=SC.Enumerator._pushContext(e);return d},everyProperty:function(k,f){var d=this.get?this.get("length"):this.length;var e=YES;var j=null;var a=SC.Enumerator._popContext();for(var g=0;e&&(g<d);g++){var b=this.nextObject(g,j,a);var h=b?(b.get?b.get(k):b[k]):null;e=(f===undefined)?!!h:SC.isEqual(h,f);j=b}j=null;a=SC.Enumerator._pushContext(a);return e},some:function(j,h){if(typeof j!=="function"){throw new TypeError()}var b=this.get?this.get("length"):this.length;if(h===undefined){h=null}var d=NO;var g=null;var e=SC.Enumerator._popContext();for(var a=0;(!d)&&(a<b);a++){var f=this.nextObject(a,g,e);if(j.call(h,f,a,this)){d=YES}g=f}g=null;e=SC.Enumerator._pushContext(e);return d},someProperty:function(k,f){var d=this.get?this.get("length"):this.length;var e=NO;var j=null;var a=SC.Enumerator._popContext();for(var g=0;!e&&(g<d);g++){var b=this.nextObject(g,j,a);var h=b?(b.get?b.get(k):b[k]):null;e=(f===undefined)?!!h:SC.isEqual(h,f);j=b}j=null;a=SC.Enumerator._pushContext(a);return e},reduce:function(h,j,k){if(typeof h!=="function"){throw new TypeError()}var d=this.get?this.get("length"):this.length;if(d===0&&j===undefined){throw new TypeError()}var e=j;var g=null;var a=SC.Enumerator._popContext();for(var f=0;f<d;f++){var b=this.nextObject(f,g,a);if(b!==null){if(e===undefined){e=b}else{e=h.call(null,e,b,f,this,k)}}g=b}g=null;a=SC.Enumerator._pushContext(a);if(e===undefined){throw new TypeError()}return e},invoke:function(j){var f=this.get?this.get("length"):this.length;if(f<=0){return[]}var k;var h=[];var d=arguments.length;if(d>1){for(k=1;k<d;k++){h.push(arguments[k])}}var g=[];var l=null;var b=SC.Enumerator._popContext();for(k=0;k<f;k++){var e=this.nextObject(k,l,b);var a=e?e[j]:null;if(a){g[k]=a.apply(e,h)}l=e}l=null;b=SC.Enumerator._pushContext(b);return g},invokeWhile:function(e,k){var g=this.get?this.get("length"):this.length;if(g<=0){return null}var l;var j=[];var d=arguments.length;if(d>2){for(l=2;l<d;l++){j.push(arguments[l])}}var h=e;var m=null;var b=SC.Enumerator._popContext();for(l=0;(h===e)&&(l<g);l++){var f=this.nextObject(l,m,b);var a=f?f[k]:null;if(a){h=a.apply(f,j)}m=f}m=null;b=SC.Enumerator._pushContext(b);return h},toArray:function(){var a=[];this.forEach(function(b){a.push(b)},this);return a},groupBy:function(k){var d=this.get?this.get("length"):this.length,e=[],j=null,a=SC.Enumerator._popContext(),f=[],l=[],g,b,h;for(g=0;g<d;g++){b=this.nextObject(g,j,a);h=b?(b.get?b.get(k):b[k]):null;if(SC.none(f[h])){f[h]=[];l.push(h)}f[h].push(b);j=b}j=null;a=SC.Enumerator._pushContext(a);for(g=0,d=l.length;g<d;g++){e.push(f[l[g]])}return e}};SC._buildReducerFor=function(a,b){return function(e,f){var g=this[a];if(SC.typeOf(g)!==SC.T_FUNCTION){return this.unknownProperty?this.unknownProperty(e,f):null}else{var d=SC.Enumerable.reduce.call(this,g,null,b);return d}}.property("[]")};SC.Reducers={"[]":function(a,b){return this}.property(),enumerableContentDidChange:function(d,a,b){if(!SC.none(d)){if(d===0){this.notifyPropertyChange("firstObject")}if(!SC.none(a)&&d+a===this.get("length")-1){this.notifyPropertyChange("lastObject")}}this.notifyPropertyChange("[]")},reducedProperty:function(k,h,g){if(!k||typeof k!==SC.T_STRING||k.charAt(0)!=="@"){return undefined}var e=k.match(/^@([^(]*)(\(([^)]*)\))?$/);if(!e||e.length<2){return undefined}var j=e[1];var l=e[3];j="reduce"+j.slice(0,1).toUpperCase()+j.slice(1);var a=this[j];if(SC.typeOf(a)!==SC.T_FUNCTION){return undefined}if(g===NO){return SC.Enumerable.reduce.call(this,a,null,l)}var d=SC._buildReducerFor(j,l);var b=this.constructor.prototype;if(b){b[k]=d;var f=b._properties||[];f.push(k);b._properties=f;this.registerDependentKey(k,"[]")}return SC.Enumerable.reduce.call(this,a,null,l)},reduceMax:function(a,f,b,g,d){if(d&&f){f=f.get?f.get(d):f[d]}if(a===null){return f}return(f>a)?f:a},reduceMaxObject:function(b,g,d,h,f){var a=b,j=g;if(f){if(g){j=g.get?g.get(f):g[f]}if(b){a=b.get?b.get(f):b[f]}}if(a===null){return g}return(j>a)?g:b},reduceMin:function(a,f,b,g,d){if(d&&f){f=f.get?f.get(d):f[d]}if(a===null){return f}return(f<a)?f:a},reduceMinObject:function(b,g,d,h,f){var a=b,j=g;if(f){if(g){j=g.get?g.get(f):g[f]}if(b){a=b.get?b.get(f):b[f]}}if(a===null){return g}return(j<a)?g:b},reduceAverage:function(b,h,f,j,g){if(g&&h){h=h.get?h.get(g):h[g]}var d=(b||0)+h;var a=j.get?j.get("length"):j.length;if(f>=a-1){d=d/a}return d},reduceSum:function(a,f,b,g,d){if(d&&f){f=f.get?f.get(d):f[d]}return(a===null)?f:a+f}};SC.mixin(SC.Enumerable,SC.Reducers);SC.mixin(Array.prototype,SC.Reducers);Array.prototype.isEnumerable=YES;(function(){var a={nextObject:SC.Enumerable.nextObject,enumerator:SC.Enumerable.enumerator,firstObject:SC.Enumerable.firstObject,lastObject:SC.Enumerable.lastObject,sortProperty:SC.Enumerable.sortProperty,mapProperty:function(h){var f=this.length;var g=[];for(var e=0;e<f;e++){var j=this[e];g[e]=j?(j.get?j.get(h):j[h]):null}return g},filterProperty:function(j,l){var g=this.length;var h=[];for(var f=0;f<g;f++){var k=this[f];var m=k?(k.get?k.get(j):k[j]):null;var e=(l===undefined)?!!m:SC.isEqual(m,l);if(e){h.push(k)}}return h},groupBy:function(j){var f=this.length,h=[],l=[],g=[],e,k,m;for(e=0;e<f;e++){k=this[e];m=k?(k.get?k.get(j):k[j]):null;if(SC.none(l[m])){l[m]=[];g.push(m)}l[m].push(k)}for(e=0,f=g.length;e<f;e++){h.push(l[g[e]])}return h},find:function(l,k){if(typeof l!=="function"){throw new TypeError()}var f=this.length;if(k===undefined){k=null}var h,g=null,j=NO;for(var e=0;e<f&&!j;e++){h=this[e];if(j=l.call(k,h,e,this)){g=h}}h=null;return g},findProperty:function(h,l){var f=this.length;var j,m,k=NO,g=null;for(var e=0;e<f&&!k;e++){m=(j=this[e])?(j.get?j.get(h):j[h]):null;k=(l===undefined)?!!m:SC.isEqual(m,l);if(k){g=j}}j=null;return g},everyProperty:function(h,k){var f=this.length;var g=YES;for(var e=0;g&&(e<f);e++){var j=this[e];var l=j?(j.get?j.get(h):j[h]):null;g=(k===undefined)?!!l:SC.isEqual(l,k)}return g},someProperty:function(h,k){var f=this.length;var g=NO;for(var e=0;!g&&(e<f);e++){var j=this[e];var l=j?(j.get?j.get(h):j[h]):null;g=(k===undefined)?!!l:SC.isEqual(l,k)}return g},invoke:function(g){var f=this.length;if(f<=0){return[]}var e;var j=[];var l=arguments.length;if(l>1){for(e=1;e<l;e++){j.push(arguments[e])}}var h=[];for(e=0;e<f;e++){var k=this[e];var m=k?k[g]:null;if(m){h[e]=m.apply(k,j)}}return h},invokeWhile:function(g,m){var j=this.length;if(j<=0){return null}var n;var l=[];var f=arguments.length;if(f>2){for(n=2;n<f;n++){l.push(arguments[n])}}var k=g;for(n=0;(k===g)&&(n<j);n++){var h=this[n];var e=h?h[m]:null;if(e){k=e.apply(h,l)}}return k},toArray:function(){var f=this.length;if(f<=0){return[]}var g=[];for(var e=0;e<f;e++){var h=this[e];g.push(h)}return g},getEach:function(h){var g=[];var f=this.length;for(var e=0;e<f;e++){var j=this[e];g[e]=j?(j.get?j.get(h):j[h]):null}return g},setEach:function(g,h){var f=this.length;for(var e=0;e<f;e++){var j=this[e];if(j){if(j.set){j.set(g,h)}else{j[g]=h}}}return this}};var d={forEach:function(j,h){if(typeof j!=="function"){throw new TypeError()}if(h===undefined){h=null}for(var f=0,e=this.length;f<e;f++){var g=this[f];j.call(h,g,f,this)}return this},map:function(k,j){if(typeof k!=="function"){throw new TypeError()}if(j===undefined){j=null}var f=[];for(var g=0,e=this.length;g<e;g++){var h=this[g];f[g]=k.call(j,h,g,this)}return f},filter:function(k,j){if(typeof k!=="function"){throw new TypeError()}if(j===undefined){j=null}var f=[];for(var g=0,e=this.length;g<e;g++){var h=this[g];if(k.call(j,h,g,this)){f.push(h)}}return f},every:function(k,j){if(typeof k!=="function"){throw new TypeError()}var f=this.length;if(j===undefined){j=null}var g=YES;for(var e=0;g&&(e<f);e++){var h=this[e];if(!k.call(j,h,e,this)){g=NO}}return g},some:function(k,j){if(typeof k!=="function"){throw new TypeError()}var f=this.length;if(j===undefined){j=null}var g=NO;for(var e=0;(!g)&&(e<f);e++){var h=this[e];if(k.call(j,h,e,this)){g=YES}}return g},reduce:function(l,g,k){if(typeof l!=="function"){throw new TypeError()}var f=this.length;if(f===0&&g===undefined){throw new TypeError()}var h=g;for(var e=0;e<f;e++){var j=this[e];if(j!==null){if(h===undefined){h=j}else{h=l.call(null,h,j,e,this,k)}}}if(h===undefined){throw new TypeError()}return h}};for(var b in d){if(!d.hasOwnProperty(b)){continue}if(!Array.prototype[b]||((typeof Prototype==="object")&&Prototype.Version.match(/^1\.6/))){Array.prototype[b]=d[b]}}SC.mixin(Array.prototype,a)})();SC.RangeObserver={isRangeObserver:YES,toString:function(){var a=this.indexes?this.indexes.toString():"SC.IndexSet<..>";return a.replace("IndexSet","RangeObserver(%@)".fmt(SC.guidFor(this)))},create:function(e,g,f,h,d,a){var b=SC.beget(this);b.source=e;b.indexes=g?g.frozenCopy():null;b.target=f;b.method=(typeof h==="string")?f[h]:h;b.context=d;b.isDeep=a||false;b.beginObserving();return b},extend:function(e){var d=SC.beget(this),b=arguments;for(var f=0,a=b.length;f<a;f++){SC.mixin(d,b[f])}return d},destroy:function(a){this.endObserving();return this},update:function(a,b){if(this.indexes&&this.indexes.isEqual(b)){return this}this.indexes=b?b.frozenCopy():null;this.endObserving().beginObserving();return this},beginObserving:function(){if(!this.isDeep){return this}var d=this.observing=this.observing||SC.CoreSet.create();var a=this._beginObservingForEach,b=this.source;if(!a){a=this._beginObservingForEach=function(e){var f=b.objectAt(e);if(f&&f.addObserver){d.push(f);f._kvo_needsRangeObserver=true}}}this.indexes.forEach(a);this.isObserving=false;SC.Observers.addPendingRangeObserver(this);return this},setupPending:function(b){var f=this.observing;if(this.isObserving||!f||(f.get("length")===0)){return true}if(f.contains(b)){this.isObserving=true;var d=this._setupPendingForEach;if(!d){var e=this.source,g=this.objectPropertyDidChange,a=this;d=this._setupPendingForEach=function(h){var l=e.objectAt(h),j=SC.guidFor(l),k;if(l&&l.addObserver){f.push(l);l.addObserver("*",a,g);k=a[j];if(k==null){a[j]=h}else{if(k.isIndexSet){k.add(h)}else{a[j]=SC.IndexSet.create(k).add(h)}}}}}this.indexes.forEach(d);return true}else{return false}},endObserving:function(){if(!this.isDeep){return this}var f=this.observing;if(this.isObserving){var b=this.objectPropertyDidChange,d=this.source,a,g,e;if(f){g=f.length;for(a=0;a<g;a++){e=f[a];e.removeObserver("*",this,b);this[SC.guidFor(e)]=null}f.length=0}this.isObserving=false}if(f){f.clear()}return this},rangeDidChange:function(b){var a=this.indexes;if(!b||!a||a.intersects(b)){this.endObserving();this.method.call(this.target,this.source,null,"[]",b,this.context);this.beginObserving()}return this},objectPropertyDidChange:function(e,g,h,a){var f=this.context,j=this.method,d=SC.guidFor(e),b=this[d];if(b&&!b.isIndexSet){b=this[d]=SC.IndexSet.create(b).freeze()}j.call(this.target,this.source,e,g,b,f||a,a)}};sc_require("ext/function");sc_require("mixins/observable");sc_require("mixins/enumerable");sc_require("system/range_observer");SC.OUT_OF_RANGE_EXCEPTION="Index out of range";SC.CoreArray={isSCArray:YES,replace:function(a,d,b){throw"replace() must be implemented to support SC.Array"},indexOf:function(e,d){var b,a=this.get("length");if(d===undefined){d=0}else{d=(d<0)?Math.ceil(d):Math.floor(d)}if(d<0){d+=a}for(b=d;b<a;b++){if(this.objectAt(b,YES)===e){return b}}return -1},lastIndexOf:function(e,d){var b,a=this.get("length");if(d===undefined){d=a-1}else{d=(d<0)?Math.ceil(d):Math.floor(d)}if(d<0){d+=a}for(b=d;b>=0;b--){if(this.objectAt(b)===e){return b}}return -1},objectAt:function(a){if(a<0){return undefined}if(a>=this.get("length")){return undefined}return this.get(a)},"[]":function(a,b){if(b!==undefined){this.replace(0,this.get("length"),b)}return this}.property(),insertAt:function(a,b){if(a>this.get("length")){throw SC.OUT_OF_RANGE_EXCEPTION}this.replace(a,0,[b]);return this},removeAt:function(e,a){var d=0,b=[];if(typeof e===SC.T_NUMBER){if((e<0)||(e>=this.get("length"))){throw SC.OUT_OF_RANGE_EXCEPTION}if(a===undefined){this.replace(e,1,b);return this}else{e=SC.IndexSet.create(e,a)}}this.beginPropertyChanges();e.forEachRange(function(g,f){g-=d;d+=f;this.replace(g,f,b)},this);this.endPropertyChanges();return this},removeObject:function(b){var d=this.get("length")||0;while(--d>=0){var a=this.objectAt(d);if(a==b){this.removeAt(d)}}return this},removeObjects:function(a){this.beginPropertyChanges();a.forEach(function(b){this.removeObject(b)},this);this.endPropertyChanges();return this},slice:function(b,e){var a=[];var d=this.get("length");if(SC.none(b)){b=0}if(SC.none(e)||(e>d)){e=d}while(b<e){a[a.length]=this.objectAt(b++)}return a},pushObject:function(a){this.insertAt(this.get("length"),a);return a},pushObjects:function(a){this.beginPropertyChanges();a.forEach(function(b){this.pushObject(b)},this);this.endPropertyChanges();return this},popObject:function(){var a=this.get("length");if(a===0){return null}var b=this.objectAt(a-1);this.removeAt(a-1);return b},shiftObject:function(){if(this.get("length")===0){return null}var a=this.objectAt(0);this.removeAt(0);return a},unshiftObject:function(a){this.insertAt(0,a);return a},unshiftObjects:function(a){this.beginPropertyChanges();a.forEach(function(b){this.unshiftObject(b)},this);this.endPropertyChanges();return this},isEqual:function(a){if(!a){return false}if(a==this){return true}var b=a.get("length");if(b!=this.get("length")){return false}while(--b>=0){if(!SC.isEqual(a.objectAt(b),this.objectAt(b))){return false}}return true},compact:function(){return this.without(null)},without:function(b){if(this.indexOf(b)<0){return this}var a=[];this.forEach(function(d){if(d!==b){a[a.length]=d}});return a},uniq:function(){var a=[];this.forEach(function(b){if(a.indexOf(b)<0){a[a.length]=b}});return a},flatten:function(){var a=[];this.forEach(function(b){if(b&&b.isEnumerable){a=a.pushObjects(b.flatten())}else{a.pushObject(b)}});return a},max:function(){return Math.max.apply(Math,this)},min:function(){return Math.min.apply(Math,this)},rangeObserverClass:SC.RangeObserver,contains:function(a){return this.indexOf(a)>=0},addRangeObserver:function(e,g,j,f){var a=this._array_rangeObservers;if(!a){a=this._array_rangeObservers=SC.CoreSet.create()}if(this._array_oldLength===undefined){this._array_oldLength=this.get("length")}var h=this.rangeObserverClass;var b=NO;var d=h.create(this,e,g,j,f,b);a.add(d);if(!this._array_isNotifyingRangeObservers){this._array_isNotifyingRangeObservers=YES;this.addObserver("[]",this,this._array_notifyRangeObservers)}return d},updateRangeObserver:function(b,a){return b.update(this,a)},removeRangeObserver:function(d){var b=d.destroy(this);var a=this._array_rangeObservers;if(a){a.remove(d)}return b},addArrayObservers:function(a){this._modifyObserverSet("add",a)},removeArrayObservers:function(a){this._modifyObserverSet("remove",a)},_modifyObserverSet:function(j,d){var f,b;var h=d.target||this;var a=d.willChange||"arrayWillChange";var g=d.didChange||"arrayDidChange";var e=d.context;if(typeof a==="string"){a=h[a]}if(typeof g==="string"){g=h[g]}f=this._kvo_for("_kvo_array_will_change",SC.ObserverSet);b=this._kvo_for("_kvo_array_did_change",SC.ObserverSet);f[j](h,a,e);b[j](h,g,e)},arrayContentWillChange:function(b,k,a){this._teardownContentObservers(b,k);var g,e,j,l;var h,d;var f=this._kvo_array_will_change;if(f){e=f.members;j=e.length;for(l=0;l<j;l++){g=e[l];h=g[0];d=g[1];d.call(h,b,k,a,this)}}},arrayContentDidChange:function(b,p,a){var e=this._array_rangeObservers,j,d,n;this.beginPropertyChanges();this.notifyPropertyChange("length");if(e&&e.length>0){n=this._array_rangeChanges;if(!n){n=this._array_rangeChanges=SC.IndexSet.create()}if(p===a){d=p}else{d=this.get("length")-b;if(p>a){d+=(p-a)}}n.add(b,d)}this._setupContentObservers(b,a);var h,g,m,o;var k,f;var l=this._kvo_array_did_change;if(l){if(b===undefined){b=0;p=this.get("length");a=0}g=l.members;m=g.length;for(o=0;o<m;o++){h=g[o];k=h[0];f=h[1];f.call(k,b,p,a,this)}}this.notifyPropertyChange("[]");this.endPropertyChanges();return this},_setupContentObservers:function(g,f){var d=this._kvo_for("_kvo_content_observed_keys",SC.CoreSet);var e;var b;if(d.get("length")>0){e=this.slice(g,g+f);var a=this;d.forEach(function(h){b=SC.keyFor("_kvo_content_observers",h);a._kvo_for(b).forEach(function(j){e.forEach(function(k){a._resumeChainObservingForItemWithChainObserver(k,j)})})})}},_teardownContentObservers:function(f,a){var d=this._kvo_for("_kvo_content_observed_keys",SC.CoreSet);var e;var b;if(d.get("length")>0){e=this.slice(f,f+a);d.forEach(function(g){b=SC.keyFor("_kvo_content_observers",g);e.forEach(function(h){h._kvo_for(b).forEach(function(j){j.destroyChain()})})})}},teardownEnumerablePropertyChains:function(b){var a=this._kvo_enumerable_property_chains;if(a){a.forEach(function(h){var e,d=b.get("length"),k=SC.guidFor(h),g,j,f="_kvo_enumerable_property_clones";h.notifyPropertyDidChange();for(e=0;e<d;e++){j=b.objectAt(e);g=j[f][k];g.deactivate();delete j[f][k]}},this)}return this},setupEnumerablePropertyChains:function(b){var a=this._kvo_enumerable_property_chains;if(a){a.forEach(function(f){var e,d=b.get("length");f.notifyPropertyDidChange();d=b.get("length");for(e=0;e<d;e++){this._clonePropertyChainToItem(f,b.objectAt(e))}},this)}return this},registerDependentKeyWithChain:function(f,d){var b="_kvo_enumerable_property_chains",g,e,h,a;g=this._kvo_for(b,SC.CoreSet);g.add(d);this.forEach(function(j){this._clonePropertyChainToItem(d,j)},this)},_clonePropertyChainToItem:function(d,e){var f=SC.clone(d),b="_kvo_enumerable_property_clones",a;f.object=e;a=e[b]=e[b]||{};a[SC.guidFor(d)]=f;f.activate(e)},removeDependentKeyWithChain:function(g,e){var b="_kvo_enumerable_property_chains",d="_kvo_enumerable_property_clones",h,f,j,a;this.forEach(function(k){k.removeDependentKeyWithChain(g,e);a=k[d];j=a[SC.guidFor(e)];j.deactivate(k)},this)},_resumeChainObservingForItemWithChainObserver:function(e,a){var b=SC.clone(a.next);var d=b.property;b.object=e;e.addObserver(d,b,b.propertyDidChange);if(a.root.tails){a.root.tails.pushObject(b.tail())}b.propertyDidChange();e._kvo_for(SC.keyFor("_kvo_content_observers",d)).push(b)},_addContentObserver:function(a){var b=a.next.property;this._kvo_for("_kvo_content_observed_keys",SC.CoreSet).push(b);var d=SC.keyFor("_kvo_content_observers",b);this._kvo_for(d).push(a);this._setupContentObservers(0,a.object.get("length"))},_removeContentObserver:function(a){var f,d;var e=this._kvo_content_observed_keys;var b=a.next.property;if(e.contains(b)){d=SC.keyFor("_kvo_content_observers",b);f=this._kvo_for(d);f.removeObject(a);this._teardownContentObservers(0,a.object.get("length"));if(f.length===0){this._kvo_for("_kvo_content_observed_keys").remove(b)}}},_array_notifyRangeObservers:function(){var d=this._array_rangeObservers,e=this._array_rangeChanges,b=d?d.length:0,a,f;if(b>0&&e&&e.length>0){for(a=0;a<b;a++){d[a].rangeDidChange(e)}e.clear()}}};SC.Array=SC.mixin({},SC.Enumerable,SC.CoreArray);sc_require("mixins/array");SC.supplement(Array.prototype,SC.CoreArray);SC.mixin(Array.prototype,{replace:function(b,f,e){if(this.isFrozen){throw SC.FROZEN_ERROR}var d;var a=e?(e.get?e.get("length"):e.length):0;this.arrayContentWillChange(b,f,a);if(a===0){this.splice(b,f)}else{d=[b,f].concat(e);this.splice.apply(this,d)}this.beginPropertyChanges();this.arrayContentDidChange(b,f,a);this.enumerableContentDidChange(b,f,a-f);this.endPropertyChanges();return this},unknownProperty:function(b,d){var a=this.reducedProperty(b,d);if((d!==undefined)&&a===undefined){a=this[b]=d}return a}});if(Array.prototype.indexOf===SC.CoreArray.indexOf){Array.prototype.indexOf=function(e,d){var b,a=this.length;if(d===undefined){d=0}else{d=(d<0)?Math.ceil(d):Math.floor(d)}if(d<0){d+=a}for(b=d;b<a;b++){if(this[b]===e){return b}}return -1}}if(Array.prototype.lastIndexOf===SC.CoreArray.lastIndexOf){Array.prototype.lastIndexOf=function(e,d){var b,a=this.length;if(d===undefined){d=a-1}else{d=(d<0)?Math.ceil(d):Math.floor(d)}if(d<0){d+=a}for(b=d;b>=0;b--){if(this[b]===e){return b}}return -1}}if(!Date.now){Date.now=function(){return new Date().getTime()}}SC.String={_scs_valueForKey:function(f,h,d){var a,g,e,b=f.indexOf(":");if(b>-1){a=f.substr(b+1);f=f.substr(0,b)}g=h[f];e=h[f+"Formatter"];if(e){g=e(g,a)}else{if(a){throw"String.fmt was given a formatting string, but key `"+f+"` has no formatter! String: "+d}}return g},fmt:function(b,a){var d=0,e=undefined,f;if(a){e=a[0]}return b.replace(/%\{(.*?)\}/g,function(g,h){f=YES;if(!e){throw"Cannot use named parameters with `fmt` without a data hash. String: '"+b+"'"}return SC.String._scs_valueForKey(h,e,b)}).replace(/%@([0-9]+)?/g,function(h,g){if(f){throw"Invalid attempt to use both named parameters and indexed parameters. String: '"+b+"'"}g=g?parseInt(g,10)-1:d++;if(a[g]!==undefined){return a[g]}else{return""}})},w:function(g){var e=[],f=g.split(" "),b=f.length,d,a=0;for(a=0;a<b;++a){d=f[a];if(d.length!==0){e.push(d)}}return e}};sc_require("system/string");SC.mixin(String.prototype,{fmt:function(){return SC.String.fmt(this,arguments)},w:function(){return SC.String.w(this)}});SC.Comparable={isComparable:YES,compare:function(e,d){throw"%@.compare() is not implemented".fmt(this.toString())}};SC.Copyable={isCopyable:YES,copy:function(a){var b=SC._object_className(this.constructor);throw"%@.copy() is not implemented".fmt(b)},frozenCopy:function(){var a=this.get?this.get("isFrozen"):this.isFrozen;if(a===YES){return this}else{if(a===undefined){throw"%@ does not support freezing".fmt(this)}else{return this.copy().freeze()}}}};SC.mixin(Array.prototype,SC.Copyable);Array.prototype.copy=function(b){var d=this.slice(),a;if(b){a=d.length;while(a--){d[a]=SC.copy(d[a],true)}}return d};SC.FROZEN_ERROR=new Error("Cannot modify a frozen object");SC.Freezable={isFreezable:YES,isFrozen:NO,freeze:function(){if(this.set){this.set("isFrozen",YES)}else{this.isFrozen=YES}return this}};SC.mixin(Array.prototype,SC.Freezable);sc_require("mixins/enumerable");sc_require("mixins/observable");sc_require("mixins/freezable");sc_require("mixins/copyable");SC.Set=SC.mixin({},SC.Enumerable,SC.Observable,SC.Freezable,{create:function(d){var e,b,f=SC.Set._pool,g=this.isObservable,a;if(!g&&d===undefined&&f.length>0){return f.pop()}else{e=SC.beget(this);if(g){e.initObservable()}if(d&&d.isEnumerable&&d.get("length")>0){e.isObservable=NO;if(d.isSCArray){a=d.get("length");for(b=0;b<a;b++){e.add(d.objectAt(b))}}else{if(d.isSet){a=d.length;for(b=0;b<a;b++){e.add(d[b])}}else{d.forEach(function(h){e.add(h)},this)}}e.isObservable=g}}return e},isSet:YES,length:0,firstObject:function(){return(this.length>0)?this[0]:undefined}.property(),clear:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}this.length=0;return this},contains:function(b){if(b===null){return NO}var a=this[SC.hashFor(b)];return(!SC.none(a)&&(a<this.length)&&(this[a]===b))},isEqual:function(a){if(!a||!a.isSet||(a.get("length")!==this.get("length"))){return NO}var b=this.get("length");while(--b>=0){if(!a.contains(this[b])){return NO}}return YES},addSetObserver:function(a){if(!this.setObservers){this.setObservers=SC.CoreSet.create()}this.setObservers.add(a)},removeSetObserver:function(a){if(!this.setObservers){return}this.setObservers.remove(a)},add:function(f){if(this.isFrozen){throw SC.FROZEN_ERROR}if(SC.none(f)){return this}var d,e=((d=f.hash)&&(typeof d==="function"))?d.call(f):SC.guidFor(f),b=this[e],a=this.length;if((b>=a)||(this[b]!==f)){this[a]=f;this[e]=a;this.length=a+1;if(this.setObservers){this.didAddItem(f)}}if(this.isObservable){this.enumerableContentDidChange()}return this},addEach:function(d){if(this.isFrozen){throw SC.FROZEN_ERROR}if(!d||!d.isEnumerable){throw"%@.addEach must pass enumerable".fmt(this)}var a,b=this.isObservable;if(b){this.beginPropertyChanges()}if(d.isSCArray){a=d.get("length");while(--a>=0){this.add(d.objectAt(a))}}else{if(d.isSet){a=d.length;while(--a>=0){this.add(d[a])}}else{d.forEach(function(e){this.add(e)},this)}}if(b){this.endPropertyChanges()}return this},remove:function(g){if(this.isFrozen){throw SC.FROZEN_ERROR}if(g===null||g===undefined){return this}var d,e=(g&&(d=g.hash)&&(typeof d===SC.T_FUNCTION))?d.call(g):SC.guidFor(g),b=this[e],a=this.length,f;if((b===null||b===undefined)||(b>=a)||(this[b]!==g)){return this}delete this[e];if(b<(a-1)){f=this[b]=this[a-1];e=(f&&(d=f.hash)&&(typeof d===SC.T_FUNCTION))?d.call(f):SC.guidFor(f);this[e]=b}this.length=a-1;if(this.isObservable){this.enumerableContentDidChange()}if(this.setObservers){this.didRemoveItem(g)}return this},pop:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}var a=(this.length>0)?this[this.length-1]:null;this.remove(a);return a},removeEach:function(d){if(this.isFrozen){throw SC.FROZEN_ERROR}if(!d||!d.isEnumerable){throw"%@.addEach must pass enumerable".fmt(this)}var a,b=this.isObservable;if(b){this.beginPropertyChanges()}if(d.isSCArray){a=d.get("length");while(--a>=0){this.remove(d.objectAt(a))}}else{if(d.isSet){a=d.length;while(--a>=0){this.remove(d[a])}}else{d.forEach(function(e){this.remove(e)},this)}}if(b){this.endPropertyChanges()}return this},copy:function(){return this.constructor.create(this)},destroy:function(){this.isFrozen=NO;if(!this.isObservable){SC.Set._pool.push(this.clear())}return this},forEach:function(d,e){var b=this.length;if(!e){e=this}for(var a=0;a<b;a++){d.call(e,this[a],a,this)}return this},toString:function(){var b=this.length,a,d=[];for(a=0;a<b;a++){d[a]=this[a]}return"SC.Set<%@>".fmt(d.join(","))},didAddItem:function(d){var e=this.setObservers;if(!e){return}var b=e.length,a;for(a=0;a<b;a++){e[a].didAddItem(this,d)}},didRemoveItem:function(d){var e=this.setObservers;if(!e){return}var b=e.length,a;for(a=0;a<b;a++){e[a].didRemoveItem(this,d)}},_pool:[],isObservable:YES});SC.Set.constructor=SC.Set;SC.Set.clone=SC.Set.copy;SC.Set.push=SC.Set.unshift=SC.Set.add;SC.Set.shift=SC.Set.pop;SC.Set.addObject=SC.Set.add;SC.Set.removeObject=SC.Set.remove;SC.Set._pool=[];SC.CoreSet=SC.beget(SC.Set);SC.CoreSet.isObservable=NO;SC.CoreSet.constructor=SC.CoreSet;sc_require("mixins/observable");sc_require("system/set");SC.Observers={queue:[],addObserver:function(d,e,f,b){var a;if(typeof d==="string"){a=SC.tupleForPropertyPath(d,b)}else{a=d}if(a&&a[0].addObserver){a[0].addObserver(a[1],e,f)}else{this.queue.push([d,e,f,b])}},removeObserver:function(g,h,j,e){var d,b,a,f;a=SC.tupleForPropertyPath(g,e);if(a){a[0].removeObserver(a[1],h,j)}d=this.queue.length;b=this.queue,newQueue=undefined;while(--d>=0){f=b[d];if(f[0]!==g||f[1]!==h||f[2]!==j||f[3]!==e){if(!newQueue){newQueue=[]}newQueue.push(f)}}this.queue=newQueue||this.queue},addPendingRangeObserver:function(a){var b=this.rangeObservers;if(!b){b=this.rangeObservers=SC.CoreSet.create()}b.add(a);return this},_TMP_OUT:[],flush:function(b){var h=this.queue,e,a=h.length;if(h&&a>0){var l=(this.queue=[]);for(e=0;e<a;e++){var m=h[e];if(!m){continue}var j=SC.tupleForPropertyPath(m[0],m[3]);if(j&&j[0].addObserver){j[0].addObserver(j[1],m[1],m[2])}else{l.push(m)}}}if(b._kvo_needsRangeObserver){var k=this.rangeObservers,g=k?k.get("length"):0,d=this._TMP_OUT,f;for(e=0;e<g;e++){f=k[e];if(f.setupPending(b)){d.push(f)}}if(d.length>0){k.removeEach(d)}d.length=0;b._kvo_needsRangeObserver=false}},isObservingSuspended:0,_pending:SC.CoreSet.create(),objectHasPendingChanges:function(a){this._pending.add(a)},suspendPropertyObserving:function(){this.isObservingSuspended++},resumePropertyObserving:function(){var d;if(--this.isObservingSuspended<=0){d=this._pending;this._pending=SC.CoreSet.create();var b,a=d.length;for(b=0;b<a;b++){d[b]._notifyPropertyObservers()}d.clear();d=null}}};sc_require("core");sc_require("mixins/observable");sc_require("private/observer_queue");sc_require("mixins/array");sc_require("system/set");SC.BENCHMARK_OBJECTS=NO;SC._detect_base=function _detect_base(d,b,a){return function e(){var g=b[a],f;if(!g){throw new Error("No '"+a+"' method was found on the superclass")}if(d.isEnhancement){f=Array.prototype.slice.call(arguments,1)}else{f=arguments}return g.apply(this,f)}};SC._object_extend=function _object_extend(h,g,p){if(!g){throw"SC.Object.extend expects a non-null value.  Did you forget to 'sc_require' something?  Or were you passing a Protocol to extend() as if it were a mixin?"}h._kvo_cloned=null;var A,o,w,f,j=h.concatenatedProperties,m=SC.K,d,b;o=(j)?j.length:0;var a=(o>0)?{}:null;while(--o>=0){A=j[o];d=h[A];b=g[A];if(d){if(!(d instanceof Array)){d=SC.$A(d)}a[A]=(b)?d.concat(b):b}else{if(!(b instanceof Array)){b=SC.$A(b)}a[A]=b}}var z=h._bindings,n=NO,x=h._observers,y=NO,k=h._properties,e=NO,t,l,q,s;var v=h.outlets,u=NO;if(g.outlets){v=(v||SC.EMPTY_ARRAY).concat(g.outlets);u=YES}for(A in g){if(A==="_kvo_cloned"){continue}if(!g.hasOwnProperty(A)){continue}s=(a.hasOwnProperty(A)?a[A]:null)||g[A];if(A.length>7&&A.slice(-7)==="Binding"){if(!n){z=(z||SC.EMPTY_ARRAY).slice();n=YES}if(z===null){z=(h._bindings||SC.EMPTY_ARRAY).slice()}z[z.length]=A}else{if(s&&(s instanceof Function)){if(!s.superclass&&(s!==(f=h[A]))){s.superclass=f||m;s.base=p?SC._detect_base(s,p,A):f||m}if(s.propertyPaths){if(!y){x=(x||SC.EMPTY_ARRAY).slice();y=YES}x[x.length]=A}if(t=s.localPropertyPaths){l=t.length;while(--l>=0){q=h._kvo_for(SC.keyFor("_kvo_local",t[l]),SC.CoreSet);q.add(A);h._kvo_for("_kvo_observed_keys",SC.CoreSet).add(t[l])}}if(s.dependentKeys){if(!e){k=(k||SC.EMPTY_ARRAY).slice();e=YES}k[k.length]=A}if(s.autoconfiguredOutlet){if(!u){v=(v||SC.EMPTY_ARRAY).slice();u=YES}v[v.length]=A}if(s.isEnhancement){s=SC._enhance(h[A]||m,s)}}}h[A]=s}if(g.hasOwnProperty("toString")){A="toString";s=(a.hasOwnProperty(A)?a[A]:null)||g[A];if(!s.superclass&&(s!==(f=h[A]))){s.superclass=s.base=f||m}h[A]=s}h._bindings=z||[];h._observers=x||[];h._properties=k||[];h.outlets=v||[];return h};SC._enhance=function(b,a){return function(){var e=Array.prototype.slice.call(arguments,0),d=this;e.unshift(function(){return b.apply(d,arguments)});return a.apply(this,e)}};SC.Object=function(a){this.__sc_super__=SC.Object.prototype;return this._object_init(a)};SC.mixin(SC.Object,{mixin:function(b){var a=arguments.length,d;for(d=0;d<a;d++){SC.mixin(this,arguments[d])}return this},superclass:null,extend:function(f){var e=SC.BENCHMARK_OBJECTS;if(e){SC.Benchmark.start("SC.Object.extend")}var h,d=function(j){this.__sc_super__=d.prototype;return this._object_init(j)};for(h in this){if(!this.hasOwnProperty(h)){continue}d[h]=this[h]}if(this.hasOwnProperty("toString")){d.toString=this.toString}d.superclass=this;d.__sc_super__=this.prototype;SC.generateGuid(d,"sc");d.subclasses=SC.Set.create();this.subclasses.add(d);var g=(d.prototype=SC.beget(this.prototype)),b,a=arguments.length;for(b=0;b<a;b++){SC._object_extend(g,arguments[b],d.__sc_super__)}g.constructor=d;if(e){SC.Benchmark.end("SC.Object.extend")}return d},reopen:function(b){var a;a=SC._object_extend(this.prototype,b,this.__sc_super__);if(this.subclasses){this.subclasses.forEach(function(e,d){var f,g;for(f in b){if(!b.hasOwnProperty(f)){continue}g=b[f];if(e.prototype.hasOwnProperty(f)){delete b[f]}if(g&&(g instanceof Function)&&(g.isEnhancement)){delete b[f]}}e.reopen(b)},this)}return a},create:function(){var b=this,a=new b(arguments);if(SC.ObjectDesigner){SC.ObjectDesigner.didCreateObject(a,SC.$A(arguments))}return a},isClass:YES,subclasses:SC.Set.create(),toString:function(){return SC._object_className(this)},subclassOf:function(b){if(this===b){return NO}var a=this;while(a=a.superclass){if(a===b){return YES}}return NO},hasSubclass:function(a){return(a&&a.subclassOf)?a.subclassOf(this):NO},kindOf:function(a){return(this===a)||this.subclassOf(a)},design:function(){if(this.isDesign){return this}var a=this.extend.apply(this,arguments);a.isDesign=YES;if(SC.ObjectDesigner){SC.ObjectDesigner.didLoadDesign(a,this,SC.A(arguments))}return a}});SC.Object.prototype={_kvo_enabled:YES,_object_init:function(d){var b,a=(d)?d.length:0;for(b=0;b<a;b++){SC._object_extend(this,d[b],this.__sc_super__)}SC.generateGuid(this,"sc");this.init();var e=this.initMixin;a=(e)?e.length:0;for(b=0;b<a;b++){e[b].call(this)}return this},mixin:function(){var b,a=arguments.length,d;for(b=0;b<a;b++){SC._object_extend(this,arguments[b])}this._observableInited=NO;this.initObservable();for(b=0;b<a;b++){d=arguments[b].initMixin;if(d){d.call(this)}}return this},init:function(){this.initObservable();return this},isDestroyed:NO,destroy:function(){if(this.get("isDestroyed")){return this}this.set("isDestroyed",YES);var b,d=this.destroyMixin,a=(d)?d.length:0;for(b=0;b<a;b++){d[b].call(this)}this.bindings.invoke("disconnect");this.bindings=null;return this},isObject:true,respondsTo:function(a){return !!(this[a] instanceof Function)},tryToPerform:function(b,d,a){return this.respondsTo(b)&&(this[b](d,a)!==NO)},superclass:function(b){var a=arguments.callee.caller;if(!a){throw"superclass cannot determine the caller method"}return a.superclass?a.superclass.apply(this,arguments):null},instanceOf:function(a){return this.constructor===a},kindOf:function(a){return this.constructor.kindOf(a)},toString:function(){if(!this._object_toString){var a=SC._object_className(this.constructor),b=a+":"+SC.guidFor(this);if(a){this._object_toString=b}else{return b}}return this._object_toString},awake:function(){var e=this.outlets,b,a,d;for(b=0,a=e.length;b<a;++b){d=e[b];this.get(d)}this.bindings.invoke("sync")},invokeOnce:function(a){SC.RunLoop.currentRunLoop.invokeOnce(this,a);return this},invokeLast:function(a){SC.RunLoop.currentRunLoop.invokeLast(this,a);return this},invokeNext:function(a){SC.RunLoop.currentRunLoop.invokeNext(this,a);return this},concatenatedProperties:["concatenatedProperties","initMixin","destroyMixin"]};SC.Object.prototype.constructor=SC.Object;SC.mixin(SC.Object.prototype,SC.Observable);function findClassNames(){if(SC._object_foundObjectClassNames){return}SC._object_foundObjectClassNames=true;var b=[],d=false;var a=function(f,g,l){var n,k,j;l--;if(b.indexOf(g)>=0){return}b.push(g);for(var h in g){if(h=="__scope__"){continue}if(h=="superclass"){continue}if(h=="__SC__"){h="SC"}if(!h.match(/^[A-Z0-9]/)){continue}if(h=="SC"){if(d){continue}d=true}n=(f)?[f,h].join("."):h;k=g[h];try{j=SC.typeOf(k)}catch(m){break}switch(j){case SC.T_CLASS:if(!k._object_className){k._object_className=n}if(l>=0){a(n,k,l)}break;case SC.T_OBJECT:if(l>=0){a(n,k,l)}break;case SC.T_HASH:if(((f)||(n==="SC"))&&(l>=0)){a(n,k,l)}break;default:break}}};window.__SC__=SC;a(null,window,2)}SC.instanceOf=function(a,b){return !!(a&&a.constructor===b)};SC.kindOf=function(a,b){if(a&&!a.isClass){a=a.constructor}return !!(a&&a.kindOf&&a.kindOf(b))};SC._object_className=function(b){if(SC.isReady===NO){return""}if(!b._object_className){findClassNames()}if(b._object_className){return b._object_className}var a=b;while(a&&!a._object_className){a=a.superclass}return(a&&a._object_className)?a._object_className:"Anonymous"};sc_require("system/object");SC._PropertyChain=SC.Object.extend({object:null,property:null,target:null,toInvalidate:null,nextProperty:null,activate:function(b){var a=this.get("object"),d=this.get("property"),e;if(!b){b=this.get("target")}if(a&&a!==b){this.deactivate()}this.set("object",b);if(b&&d!=="@each"){b.registerDependentKeyWithChain(d,this)}if(this.next){e=b?b.get(d):undefined;this.next.activate(e)}return this},deactivate:function(){var a=this.get("object"),b=this.get("property");if(a){a.removeDependentKeyWithChain(b,this)}if(this.next){this.next.deactivate()}return this},notifyPropertyDidChange:function(){var e=this.get("target"),d=this.get("toInvalidate"),b,a;e.propertyDidChange(d);if(this.next){b=this.get("object");a=b.get(this.get("property"));this.next.activate(a)}}});SC._PropertyChain.createChain=function(j,h,f){var g=j.split(".");var a=g.length,e=1;var b=SC._PropertyChain.create({property:g[0],target:h,toInvalidate:f,nextProperty:g[1]});b.set("length",a);var d=b;while(--a>=1){d=d.next=SC._PropertyChain.create({property:g[e],target:h,toInvalidate:f,nextProperty:g[++e]});d.set("length",a)}return b};sc_require("ext/function");sc_require("system/object");SC.LOG_BINDINGS=NO;SC.BENCHMARK_BINDING_NOTIFICATIONS=NO;SC.BENCHMARK_BINDING_SETUP=NO;SC.MULTIPLE_PLACEHOLDER="@@MULT@@";SC.NULL_PLACEHOLDER="@@NULL@@";SC.EMPTY_PLACEHOLDER="@@EMPTY@@";SC.Binding={beget:function(b){var a=SC.beget(this);a.parentBinding=this;if(b!==undefined){a=a.from(b)}return a},builder:function(){var b=this,a=function(d){return b.beget().from(d)};a.beget=function(){return b.beget()};return a},from:function(b,a){if(!b){return this}var d=(this===SC.Binding)?this.beget():this;d._fromPropertyPath=b;d._fromRoot=a;d._fromTuple=null;return d},to:function(b,a){var d=(this===SC.Binding)?this.beget():this;d._toPropertyPath=b;d._toRoot=a;d._toTuple=null;return d},connect:function(){if(this.isConnected){return this}this.isConnected=YES;this._connectionPending=YES;this._syncOnConnect=YES;SC.Binding._connectQueue.add(this);if(!SC.RunLoop.isRunLoopInProgress()){this._scheduleSync()}return this},_connect:function(){if(!this._connectionPending){return}this._connectionPending=NO;var d,a,b=SC.BENCHMARK_BINDING_SETUP;if(b){SC.Benchmark.start("SC.Binding.connect()")}d=this._fromPropertyPath;a=this._fromRoot;if(typeof d==="string"){if(d.indexOf(".")===0){d=d.slice(1);if(!a){a=this._toRoot}}else{if(d.indexOf("*")===0){d=[this._fromRoot||this._toRoot,d.slice(1)];a=null}}}this._fromObserverData=[d,this,this.fromPropertyDidChange,a];SC.Observers.addObserver.apply(SC.Observers,this._fromObserverData);if(!this._oneWay){d=this._toPropertyPath;a=this._toRoot;this._toObserverData=[d,this,this.toPropertyDidChange,a];SC.Observers.addObserver.apply(SC.Observers,this._toObserverData)}if(b){SC.Benchmark.end("SC.Binding.connect()")}if(this._syncOnConnect){this._syncOnConnect=NO;if(b){SC.Benchmark.start("SC.Binding.connect().sync")}this.sync();if(b){SC.Benchmark.end("SC.Binding.connect().sync")}}},disconnect:function(){if(!this.isConnected){return this}if(this._connectionPending){this._connectionPending=NO}else{SC.Observers.removeObserver.apply(SC.Observers,this._fromObserverData);if(!this._oneWay){SC.Observers.removeObserver.apply(SC.Observers,this._toObserverData)}}this.isConnected=NO;return this},fromPropertyDidChange:function(d,b){var a=d?d.get(b):null;if(a!==this._bindingValue||b==="[]"){this._setBindingValue(d,b);this._changePending=YES;SC.Binding._changeQueue.add(this);this._scheduleSync()}},toPropertyDidChange:function(d,b){if(this._oneWay){return}var a=d.get(b);if(a!==this._transformedBindingValue){this._setBindingValue(d,b);this._changePending=YES;SC.Binding._changeQueue.add(this);this._scheduleSync()}},_scheduleSync:function(){if(SC.RunLoop.isRunLoopInProgress()||SC.Binding._syncScheduled){return}SC.Binding._syncScheduled=YES;setTimeout(function(){SC.run();SC.Binding._syncScheduled=NO},1)},_setBindingValue:function(b,a){this._bindingSource=b;this._bindingKey=a},_computeBindingValue:function(){var h=this._bindingSource,f=this._bindingKey,d,b;this._bindingValue=d=(h?h.getPath(f):null);var g=this._transforms;if(g){var a=g.length,e;for(b=0;b<a;b++){e=g[b];d=e(d,this)}}if(this._noError&&SC.typeOf(d)===SC.T_ERROR){d=null}this._transformedBindingValue=d},_connectQueue:SC.CoreSet.create(),_alternateConnectQueue:SC.CoreSet.create(),_changeQueue:SC.CoreSet.create(),_alternateChangeQueue:SC.CoreSet.create(),_changePending:NO,flushPendingChanges:function(){if(this._isFlushing){return NO}this._isFlushing=YES;SC.Observers.suspendPropertyObserving();var b=NO,d=SC.LOG_BINDINGS,a,e;while((a=this._connectQueue).length>0){this._connectQueue=this._alternateConnectQueue;this._alternateConnectQueue=a;while(e=a.pop()){e._connect()}}while((a=this._changeQueue).length>0){if(d){SC.Logger.log("Begin: Trigger changed bindings")}b=YES;this._changeQueue=this._alternateChangeQueue;this._alternateChangeQueue=a;while(e=a.pop()){e.applyBindingValue()}if(d){SC.Logger.log("End: Trigger changed bindings")}}this._isFlushing=NO;SC.Observers.resumePropertyObserving();return b},applyBindingValue:function(){this._changePending=NO;this._computeBindingTargets();this._computeBindingValue();var a=this._bindingValue,b=this._transformedBindingValue,d=SC.BENCHMARK_BINDING_NOTIFICATIONS,e=SC.LOG_BINDINGS;if(!this._oneWay&&this._fromTarget){if(e){SC.Logger.log("%@: %@ -> %@".fmt(this,a,b))}if(d){SC.Benchmark.start(this.toString()+"->")}this._fromTarget.setPathIfChanged(this._fromPropertyKey,a);if(d){SC.Benchmark.end(this.toString()+"->")}}if(this._toTarget){if(e){SC.Logger.log("%@: %@ <- %@".fmt(this,a,b))}if(d){SC.Benchmark.start(this.toString()+"<-")}this._toTarget.setPathIfChanged(this._toPropertyKey,b);if(d){SC.Benchmark.start(this.toString()+"<-")}}},sync:function(){if(!this.isConnected){return this}if(this._connectionPending){this._syncOnConnect=YES}else{this._computeBindingTargets();var d=this._fromTarget,b=this._fromPropertyKey;if(!d||!b){return this}if(!d.isObservable){SC.Logger.warn("Cannot bind '%@' to property '%@' on non-observable '%@'".fmt(this._toPropertyPath,b,d));return this}var a=d.getPath(b);if(a!==this._bindingValue||b==="[]"){this._setBindingValue(d,b);this._changePending=YES;SC.Binding._changeQueue.add(this)}}return this},_syncOnConnect:NO,_computeBindingTargets:function(){if(!this._fromTarget){var d,b,a;d=this._fromPropertyPath;b=this._fromRoot;if(typeof d==="string"){if(d.indexOf(".")===0){d=d.slice(1);if(!b){b=this._toRoot}}else{if(d.indexOf("*")===0){d=[b||this._toRoot,d.slice(1)];b=null}}}a=SC.tupleForPropertyPath(d,b);if(a){this._fromTarget=a[0];this._fromPropertyKey=a[1]}}if(!this._toTarget){d=this._toPropertyPath;b=this._toRoot;a=SC.tupleForPropertyPath(d,b);if(a){this._toTarget=a[0];this._toPropertyKey=a[1]}}},oneWay:function(d,a){if((a===undefined)&&(SC.typeOf(d)===SC.T_BOOL)){a=d;d=null}var b=this.from(d);if(b===SC.Binding){b=b.beget()}b._oneWay=(a===undefined)?YES:a;return b},transform:function(b){var d=(this===SC.Binding)?this.beget():this;var a=d._transforms;if(a&&(a===d.parentBinding._transform)){a=d._transforms=a.slice()}if(!a){a=d._transforms=[]}a.push(b);return d},resetTransforms:function(){var a=(this===SC.Binding)?this.beget():this;a._transforms=null;return a},noError:function(d,a){if((a===undefined)&&(SC.typeOf(d)===SC.T_BOOL)){a=d;d=null}var b=this.from(d);if(b===SC.Binding){b=b.beget()}b._noError=(a===undefined)?YES:a;return b},single:function(b,a){if(a===undefined){a=SC.MULTIPLE_PLACEHOLDER}return this.from(b).transform(function(f,e){if(f&&f.isEnumerable){var d=f.get("length");f=(d>1)?a:(d<=0)?null:f.firstObject()}return f})},notEmpty:function(b,a){if(a===undefined){a=SC.EMPTY_PLACEHOLDER}return this.from(b).transform(function(e,d){if(SC.none(e)||(e==="")||(SC.isArray(e)&&(e.get?e.get("length"):e.length)===0)){e=a}return e})},notNull:function(b,a){if(a===undefined){a=SC.EMPTY_PLACEHOLDER}return this.from(b).transform(function(e,d){if(SC.none(e)){e=a}return e})},multiple:function(a){return this.from(a).transform(function(b){if(!SC.isArray(b)){b=(b==null)?[]:[b]}return b})},bool:function(a){return this.from(a).transform(function(b){var d=SC.typeOf(b);if(d===SC.T_ERROR){return b}return(d==SC.T_ARRAY)?(b.length>0):(b==="")?NO:!!b})},and:function(b,a){var d=SC.Object.create({valueABinding:b,valueBBinding:a,and:function(){return(this.get("valueA")&&this.get("valueB"))}.property("valueA","valueB").cacheable()});return this.from("and",d).oneWay()},or:function(b,a){var d=SC.Object.create({valueABinding:b,valueBBinding:a,or:function(){return(this.get("valueA")||this.get("valueB"))}.property("valueA","valueB").cacheable()});return this.from("or",d).oneWay()},not:function(a){return this.from(a).transform(function(b){var d=SC.typeOf(b);if(d===SC.T_ERROR){return b}return !((d==SC.T_ARRAY)?(b.length>0):(b==="")?NO:!!b)})},isNull:function(a){return this.from(a).transform(function(b){var d=SC.typeOf(b);return(d===SC.T_ERROR)?b:SC.none(b)})},toString:function(){var d=this._fromRoot?"<%@>:%@".fmt(this._fromRoot,this._fromPropertyPath):this._fromPropertyPath;var b=this._toRoot?"<%@>:%@".fmt(this._toRoot,this._toPropertyPath):this._toPropertyPath;var a=this._oneWay?"[oneWay]":"";return"SC.Binding%@(%@ -> %@)%@".fmt(SC.guidFor(this),d,b,a)}};SC.binding=function(b,a){return SC.Binding.from(b,a)};sc_require("ext/function");SC.Error=SC.Object.extend({code:-1,message:"",errorValue:null,errorObject:function(){return this}.property().cacheable(),label:null,toString:function(){return"SC.Error:%@:%@ (%@)".fmt(SC.guidFor(this),this.get("message"),this.get("code"))},isError:YES});SC.Error.desc=function(e,a,f,d){var b={message:e};if(a!==undefined){b.label=a}if(d!==undefined){b.code=d}if(f!==undefined){b.errorValue=f}return this.create(b)};SC.$error=function(b,a,d,e){return SC.Error.desc(b,a,d,e)};SC.ok=function(a){return(a!==false)&&!(a&&a.isError)};SC.$ok=SC.ok;SC.val=function(a){if(a&&a.isError){return a.get?a.get("errorValue"):null}else{return a}};SC.$val=SC.val;SC.Error.HAS_MULTIPLE_VALUES=-100;sc_require("mixins/enumerable");sc_require("mixins/observable");sc_require("mixins/freezable");sc_require("mixins/copyable");SC.IndexSet=SC.mixin({},SC.Enumerable,SC.Observable,SC.Freezable,SC.Copyable,{_sc_sliceContent:function(e){if(e.length<1000){return e.slice()}var d=0,a=[],b=e[0];while(b!==0){a[d]=b;d=(b<0)?(0-b):b;b=e[d]}a[d]=0;this._hint(0,d,a);return a},create:function(d,b){var a=SC.beget(this);a.initObservable();a.registerDependentKey("min","[]");if(d&&d.isIndexSet){a._content=this._sc_sliceContent(d._content);a.max=d.max;a.length=d.length;a.source=d.source}else{a._content=[0];if(d!==undefined){a.add(d,b)}}return a},isIndexSet:YES,HINT_SIZE:256,length:0,max:0,min:function(){var a=this._content,b=a[0];return(b===0)?-1:(b>0)?0:Math.abs(b)}.property("[]").cacheable(),firstObject:function(){return(this.get("length")>0)?this.get("min"):undefined}.property(),rangeStartForIndex:function(d){var g=this._content,a=this.get("max"),b,f,e;if(d>=a){return a}if(Math.abs(g[d])>d){return d}e=d-(d%SC.IndexSet.HINT_SIZE);b=g[e];if(b<0||b>d){b=e}f=g[b];if(f===undefined){f=this.rangeStartForIndex(b)}else{f=Math.abs(f)}while(f<d){b=f;f=Math.abs(g[b])}return b},isEqual:function(d){if(d===this){return YES}if(!d||!d.isIndexSet||(d.max!==this.max)||(d.length!==this.length)){return NO}var f=this._content,b=d._content,e=0,a=f[e];do{if(b[e]!==a){return NO}e=Math.abs(a);a=f[e]}while(e!==0);return YES},indexBefore:function(b){if(b===0){return -1}b--;var d=this._content,a=this.get("max"),e=this.rangeStartForIndex(b);if(!d){return null}while((e===a)||(d[e]<0)){if(e===0){return -1}b=e-1;e=this.rangeStartForIndex(b)}return b},indexAfter:function(b){var e=this._content,a=this.get("max"),f,d;if(!e||(b>=a)){return -1}b++;f=this.rangeStartForIndex(b);d=e[f];while(d<0){if(d===0){return -1}b=f=Math.abs(d);d=e[f]}return b},contains:function(h,d){var b,g,a,f,e;if(d===undefined){if(h===null||h===undefined){return NO}if(typeof h===SC.T_NUMBER){d=1}else{if(h&&h.isIndexSet){if(h===this){return YES}b=h._content;g=0;a=b[g];while(a!==0){if((a>0)&&!this.contains(g,a-g)){return NO}g=Math.abs(a);a=b[g]}return YES}else{d=h.length;h=h.start}}}f=this.rangeStartForIndex(h);e=this._content[f];return(e>0)&&(f<=h)&&(e>=(h+d))},intersects:function(g,d){var b,f,a,e;if(d===undefined){if(typeof g===SC.T_NUMBER){d=1}else{if(g&&g.isIndexSet){if(g===this){return YES}b=g._content;f=0;a=b[f];while(a!==0){if((a>0)&&this.intersects(f,a-f)){return YES}f=Math.abs(a);a=b[f]}return NO}else{d=g.length;g=g.start}}}f=this.rangeStartForIndex(g);b=this._content;a=b[f];e=g+d;while(f<e){if(a===0){return NO}if((a>0)&&(a>g)){return YES}f=Math.abs(a);a=b[f]}return NO},without:function(b,a){if(b===this){return SC.IndexSet.create()}return this.clone().remove(b,a)},replace:function(d,a){if(a===undefined){if(typeof d===SC.T_NUMBER){a=1}else{if(d&&d.isIndexSet){this._content=this._sc_sliceContent(d._content);this.beginPropertyChanges().set("max",d.max).set("length",d.length).set("source",d.source).enumerableContentDidChange();this.endPropertyChanges();return this}else{a=d.length;d=d.start}}}var b=this.length;this._content.length=1;this._content[0]=0;this.length=this.max=0;return this.add(d,a)},add:function(a,b){if(this.isFrozen){throw SC.FROZEN_ERROR}var f,k,e;if(a&&a.isIndexSet){f=a._content;if(!f){return this}k=0;e=f[0];while(e!==0){if(e>0){this.add(k,e-k)}k=e<0?0-e:e;e=f[k]}return this}else{if(b===undefined){if(a===null||a===undefined){return this}else{if(typeof a===SC.T_NUMBER){b=1}else{b=a.length;a=a.start}}}else{if(b===null){b=1}}}if(b<=0){return this}var g=this.get("max"),d=g,j,h;f=this._content;if(a===g){if(a>0){k=this.rangeStartForIndex(a-1);e=f[k];if(e>0){delete f[g];f[k]=g=a+b;a=k}else{f[g]=g=a+b}}else{f[a]=g=b}f[g]=0;this.set("max",g);this.set("length",this.length+b);b=g-a}else{if(a>g){f[g]=0-a;f[a]=a+b;f[a+b]=0;this.set("max",a+b);this.set("length",this.length+b);b=a+b-g;a=g}else{k=this.rangeStartForIndex(a);e=f[k];g=a+b;j=0;if((a>0)&&(k===a)&&(e<=0)){k=this.rangeStartForIndex(a-1);e=f[k]}if(e<0){f[k]=0-a;if(Math.abs(e)>g){f[a]=0-g;f[g]=e}else{f[a]=e}}else{a=k;if(e>g){g=e}}k=a;while(k<g){h=f[k];if(h===0){f[g]=0;e=g;j+=g-k}else{e=Math.abs(h);if(e>g){f[g]=h;e=g}if(h<0){j+=e-k}}delete f[k];k=e}if((k=f[g])>0){delete f[g];g=k}f[a]=g;if(g>d){this.set("max",g)}this.set("length",this.get("length")+j);b=g-a}}this._hint(a,b);if(j!==0){this.enumerableContentDidChange()}return this},remove:function(a,b){if(this.isFrozen){throw SC.FROZEN_ERROR}if(b===undefined){if(a===null||a===undefined){return this}else{if(typeof a===SC.T_NUMBER){b=1}else{if(a.isIndexSet){a.forEachRange(this.remove,this);return this}else{b=a.length;a=a.start}}}}if(b<=0){return this}var g=this.get("max"),d=g,f=this._content,l,e,k,h,j;if(a>=g){return this}l=this.rangeStartForIndex(a);e=f[l];j=a+b;k=0;if((a>0)&&(l===a)&&(e>0)){l=this.rangeStartForIndex(a-1);e=f[l]}if(e>0){f[l]=a;if(e>j){f[a]=j;f[j]=e}else{f[a]=e}}else{a=l;e=Math.abs(e);if(e>j){j=e}}l=a;while(l<j){h=f[l];if(h===0){f[j]=0;e=j}else{e=Math.abs(h);if(e>j){f[j]=h;e=j}if(h>0){k+=e-l}}delete f[l];l=e}if((l=f[j])<0){delete f[j];j=Math.abs(l)}if(f[j]===0){delete f[j];f[a]=0;this.set("max",a)}else{f[a]=0-j}this.set("length",this.get("length")-k);b=j-a;this._hint(a,b);if(k!==0){this.enumerableContentDidChange()}return this},_hint:function(h,e,d){if(d===undefined){d=this._content}var b=SC.IndexSet.HINT_SIZE,a=Math.abs(d[h]),g=h-(h%b)+b,f=h+e;while(g<f){while((a!==0)&&(a<=g)){h=a;a=Math.abs(d[h])}if(a===0){delete d[g]}else{if(g!==h){d[g]=h}}g+=b}},clear:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}var a=this.length;this._content.length=1;this._content[0]=0;this.set("length",0).set("max",0);if(a>0){this.enumerableContentDidChange()}},addEach:function(b){if(this.isFrozen){throw SC.FROZEN_ERROR}this.beginPropertyChanges();var a=b.get("length");if(b.isSCArray){while(--a>=0){this.add(b.objectAt(a))}}else{if(b.isEnumerable){b.forEach(function(d){this.add(d)},this)}}this.endPropertyChanges();return this},removeEach:function(b){if(this.isFrozen){throw SC.FROZEN_ERROR}this.beginPropertyChanges();var a=b.get("length");if(b.isSCArray){while(--a>=0){this.remove(b.objectAt(a))}}else{if(b.isEnumerable){b.forEach(function(d){this.remove(d)},this)}}this.endPropertyChanges();return this},clone:function(){return SC.IndexSet.create(this)},inspect:function(){var f=this._content,b=f.length,a=0,d=[],e;for(a=0;a<b;a++){e=f[a];if(e!==undefined){d.push("%@:%@".fmt(a,e))}}return"SC.IndexSet<%@>".fmt(d.join(" , "))},forEachRange:function(g,e){var b=this._content,f=0,a=b[f],d=this.source;if(e===undefined){e=null}while(a!==0){if(a>0){g.call(e,f,a-f,this,d)}f=Math.abs(a);a=b[f]}return this},forEachIn:function(b,d,l,g){var h=this._content,k=0,j=0,e=b+d,a=this.source,f=h[k];if(g===undefined){g=null}while(f!==0){if(k<b){k=b}while((k<f)&&(k<e)){l.call(g,k++,j++,this,a)}if(k>=e){k=f=0}else{k=Math.abs(f);f=h[k]}}return this},lengthIn:function(h,e){var a=0;if(e===undefined){if(h===null||h===undefined){return 0}else{if(typeof h===SC.T_NUMBER){e=1}else{if(h.isIndexSet){h.forEachRange(function(k,j){a+=this.lengthIn(k,j)},this);return a}else{e=h.length;h=h.start}}}}if(this.get("length")===0){return 0}var d=this._content,g=0,b=d[g],f=h+e;while(g<f&&b!==0){if(b>0){a+=(b>f)?f-g:b-g}g=Math.abs(b);b=d[g]}return a},source:null,indexOf:function(e,d){var g=this.source;if(!g){throw"%@.indexOf() requires source".fmt(this)}var b=g.get("length"),f=this._content,h=f[0]<0?Math.abs(f[0]):0,a;while(h>=0&&h<b){a=g.indexOf(e,h);if(a<0){return -1}if(this.contains(a)){return a}h=a+1}return -1},lastIndexOf:function(e,d){var f=this.source;if(!f){throw"%@.lastIndexOf() requires source".fmt(this)}var b=f.get("length"),g=this.max-1,a;if(g>=b){g=b-1}while(g>=0){a=f.lastIndexOf(e,g);if(a<0){return -1}if(this.contains(a)){return a}g=a+1}return -1},forEachObject:function(h,f){var e=this.source;if(!e){throw"%@.forEachObject() requires source".fmt(this)}var d=this._content,g=0,a=0,b=d[g];if(f===undefined){f=null}while(b!==0){while(g<b){h.call(f,e.objectAt(g),g,e,this);g++}g=Math.abs(b);b=d[g]}return this},addObject:function(d,e){var f=this.source;if(!f){throw"%@.addObject() requires source".fmt(this)}var b=f.get("length"),g=0,a;while(g>=0&&g<b){a=f.indexOf(d,g);if(a>=0){this.add(a);if(e){return this}g=a++}else{return this}}return this},addObjects:function(b,a){b.forEach(function(d){this.addObject(d,a)},this);return this},removeObject:function(d,e){var f=this.source;if(!f){throw"%@.removeObject() requires source".fmt(this)}var b=f.get("length"),g=0,a;while(g>=0&&g<b){a=f.indexOf(d,g);if(a>=0){this.remove(a);if(e){return this}g=a+1}else{return this}}return this},removeObjects:function(b,a){b.forEach(function(d){this.removeObject(d,a)},this);return this},LOG_OBSERVING:NO,forEach:function(h,f){var d=this._content,g=0,a=0,e=this.source,b=d[g];if(f===undefined){f=null}while(b!==0){while(g<b){h.call(f,g++,a++,this,e)}g=Math.abs(b);b=d[g]}return this},nextObject:function(g,b,d){var f=this._content,e=d.next,a=this.get("max");if(b===null){b=e=0}else{if(b>=a){delete d.next;return null}else{b++}}if(b===e){do{b=Math.abs(e);e=f[b]}while(e<0);d.next=e}return b},toString:function(){var a=[];this.forEachRange(function(d,b){a.push(b===1?d:"%@..%@".fmt(d,d+b-1))},this);return"SC.IndexSet<%@>".fmt(a.join(","))},max:0});SC.IndexSet.slice=SC.IndexSet.copy=SC.IndexSet.clone;SC.IndexSet.EMPTY=SC.IndexSet.create().freeze();SC.json={encode:function(a){return JSON.stringify(a)},decode:function(a){return JSON.parse(a)}};if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());sc_require("ext/function");SC.LOGGER_LOG_DELIMITER=", ";SC.LOGGER_LOG_ERROR="ERROR: ";SC.LOGGER_LOG_INFO="INFO:  ";SC.LOGGER_LOG_WARN="WARN:  ";SC.LOGGER_LOG_DEBUG="DEBUG: ";SC.LOGGER_LOG_GROUP_HEADER="** %@";SC.LOGGER_LOG_GROUP_INDENTATION="    ";SC.LOGGER_RECORDED_LOG_TIMESTAMP_PREFIX="%@:  ";SC.LOGGER_LEVEL_DEBUG="debug";SC.LOGGER_LEVEL_INFO="info";SC.LOGGER_LEVEL_WARN="warn";SC.LOGGER_LEVEL_ERROR="error";SC.LOGGER_LEVEL_NONE="none";SC.Logger=SC.Object.create({messagePrefix:null,outputMessagePrefix:null,recordedMessagePrefix:null,logOutputLevel:null,logRecordingLevel:SC.LOGGER_LEVEL_NONE,recordedLogMessages:null,recordedLogMessagesMaximumLength:500,recordedLogMessagesPruningMinimumLength:100,debugEnabled:NO,exists:function(){return !SC.none(this.get("reporter"))}.property("reporter").cacheable(),fallBackOnAlert:NO,reporter:console,debug:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_DEBUG,YES,a,arguments)},debugWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_DEBUG,NO,null,arguments)},debugGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_DEBUG,a,arguments)},debugGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_DEBUG)},info:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_INFO,YES,a,arguments)},infoWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_INFO,NO,null,arguments)},infoGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_INFO,a,arguments)},infoGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_INFO)},warn:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_WARN,YES,a,arguments)},warnWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_WARN,NO,null,arguments)},warnGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_WARN,a,arguments)},warnGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_WARN)},error:function(a,b){SC.Logger._handleMessage(SC.LOGGER_LEVEL_ERROR,YES,a,arguments)},errorWithoutFmt:function(){this._handleMessage(SC.LOGGER_LEVEL_ERROR,NO,null,arguments)},errorGroup:function(a,b){SC.Logger._handleGroup(SC.LOGGER_LEVEL_ERROR,a,arguments)},errorGroupEnd:function(){SC.Logger._handleGroupEnd(SC.LOGGER_LEVEL_ERROR)},outputRecordedLogMessages:function(o){if(!this.get("exists")){return}var t=this.get("reporter"),l=this.get("recordedLogMessages"),a=0,e=SC.LOGGER_RECORDED_LOG_TIMESTAMP_PREFIX,s,p,b,d,h,k,f,g,v,n,m,q,u;if(l){for(s=0,p=l.length;s<p;++s){b=l[s];d=b.type;if(o){h=e.fmt(b.timestamp.toUTCString())}k=b.message;if(k){f=b.originalArguments;this._outputMessage(d,h,a,k,f)}else{n=b.indentation;v=b.title;m=n-a;if(t.group){if(Math.abs(m)>1){for(q=0,u=(m-1);q<u;++q){if(m>0){t.group()}else{t.groupEnd()}}}if(m>0){g=h?h:"";g+=v;t.group(g)}else{t.groupEnd()}}else{if(m>0){this._outputGroup(d,h,n-1,v)}}a=n}}}},stringifyRecordedLogMessages:function(){var k="",g=this.get("recordedLogMessages"),n=0,j=SC.LOGGER_RECORDED_LOG_TIMESTAMP_PREFIX,e=this._LOG_FALLBACK_PREFIX_MAPPING,d=SC.LOGGER_LOG_GROUP_HEADER,f,a,p,m,t,s,h,q,o,l,b;if(g){for(f=0,a=g.length;f<a;++f){p=g[f];m=p.type;h=j.fmt(p.timestamp.toUTCString());h+=e[m]||"";t=p.message;if(t){s=p.originalArguments;q=h+this._indentation(n);q+=s?this._argumentsToString(s):t}else{l=p.indentation;o=p.title;b=l-n;if(b>0){q=h+this._indentation(n)+d.fmt(o)}n=l}k+=q+"\n"}}return k},log:function(){var a=this.get("reporter"),d=arguments[0],e=this.get("messagePrefix"),f=this.get("outputMessagePrefix"),b=NO;if(d&&SC.typeOf(d)===SC.T_STRING){if(e||f){if(e){d=e+d}if(f){d=f+d}arguments[0]=d}}if(this.get("exists")){if(typeof a.log==="function"){a.log.apply(a,arguments);b=YES}else{if(a.log){a.log(this._argumentsToArray(arguments));b=YES}}}if(!b&&this.get("fallBackOnAlert")){if(this.get("exists")&&(typeof a.alert==="function")){a.alert(arguments);b=YES}else{alert(arguments);b=YES}}return b},group:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.group==="function")){a.group(b)}},groupEnd:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.groupEnd==="function")){a.groupEnd()}},dir:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.dir==="function")){a.dir.apply(a,arguments)}else{this.log.apply(this,arguments)}},dirxml:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.dirxml==="function")){a.dirxml.apply(a,arguments)}else{this.log.apply(this,arguments)}},profile:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.profile==="function")){a.profile(b);return YES}return NO},profileEnd:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.profileEnd==="function")){a.profileEnd(b);return YES}return NO},time:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.time==="function")){a.time(b);return YES}return NO},timeEnd:function(b){var a=this.get("reporter");if(this.get("exists")&&(typeof a.timeEnd==="function")){a.timeEnd(b);return YES}return NO},trace:function(){var a=this.get("reporter");if(this.get("exists")&&(typeof a.trace==="function")){a.trace();return YES}return NO},init:function(){arguments.callee.base.apply(this,arguments);if(!this.get("logOutputLevel")){if(SC.buildMode==="debug"){this.set("logOutputLevel",SC.LOGGER_LEVEL_DEBUG)}else{this.set("logOutputLevel",SC.LOGGER_LEVEL_INFO)}}this.debugEnabledDidChange()},debugEnabledDidChange:function(){if(this.get("debugEnabled")){this.set("logOutputLevel",SC.LOGGER_LEVEL_DEBUG)}}.observes("debugEnabled"),_handleMessage:function(m,o,q,p){var a=this._shouldOutputType(m),e=this._shouldRecordType(m),f,g,k,l,b,n,j,d,h;if(!(a||e)){return}f=(p&&p.length>1);if(o&&(SC.none(q)||(typeof q!=="string"))){o=NO}if(o){if(f){l=[];for(g=1,k=p.length;g<k;++g){l.push(p[g])}q=q.fmt.apply(q,l)}}j=this.get("messagePrefix");if(j){q=j+q}if(a){d=this.get("outputMessagePrefix");l=o?null:p;this._outputMessage(m,null,this._outputIndentationLevel,(d?d+q:q),l)}if(e){h=this.get("recordedMessagePrefix");n={type:m,message:q?(h?h+q:q):YES,timestamp:new Date()};if(!o&&f){n.originalArguments=p}this._addRecordedMessageEntry(n)}},_handleGroup:function(m,o,s){var a=this._shouldOutputType(m),f=this._shouldRecordType(m),g,h,k,l,q,e,d,j,b,n,p;if(!(a||f)){return}g=(s&&s.length>1);if(o&&g){l=[];for(h=1,k=s.length;h<k;++h){l.push(s[h])}o=o.fmt.apply(o,l)}if(a){this._outputGroup(m,null,this._outputIndentationLevel,o);this._outputIndentationLevel++}if(f){n=++this._recordingIndentationLevel;p={type:m,indentation:n,beginGroup:YES,title:o,timestamp:new Date()};this._addRecordedMessageEntry(p)}},_handleGroupEnd:function(e){var h=this._shouldOutputType(e),d=this._shouldRecordType(e),a,g,b,f;if(!(h||d)){return}if(h){this._outputIndentationLevel--;if(this.get("exists")){a=this.get("reporter");g=a.groupEnd;if(g){g.call(a)}}}if(d){b=--this._recordingIndentationLevel;f={type:e,indentation:b,timestamp:new Date()};this._addRecordedMessageEntry(f)}},_shouldOutputType:function(a){var d=this._LOG_LEVEL_MAPPING,e=d[a]||0,b=d[this.get("logOutputLevel")]||0;return(e<=b)},_shouldRecordType:function(a){var d=this._LOG_LEVEL_MAPPING,e=d[a]||0,b=d[this.get("logRecordingLevel")]||0;return(e<=b)},_outputMessage:function(j,h,k,n,m){if(!this.get("exists")){return}var e=this.get("reporter"),b,a,d,f,g,l;a=!e.group;d=e[j];if(d){if(!m){b=h?h:"";if(a){b+=this._indentation(k)}b+=n;e[j](b)}else{g=this._argumentsToArray(m);f="";if(h){f=h}if(a){f+=this._indentation(k)}if(f){g.splice(0,0,f)}if(d.apply){d.apply(e,g)}else{e[j](g)}}}else{if(e.log){f="";if(h){f=h}f+=this._LOG_FALLBACK_PREFIX_MAPPING[j]||"";if(a){f+=this._indentation(k)}if(!m){e.log(f+n)}else{g=this._argumentsToArray(m);if(f){g.splice(0,0,f)}e.log(g)}}}},_outputGroup:function(e,g,d,h){if(!this.get("exists")){return}var b=this.get("reporter"),f=b.group,a;if(f){a=g?g:"";a+=h;f.call(b,a)}else{if(b.log){a="";if(g){a=g}a+=this._LOG_FALLBACK_PREFIX_MAPPING[e]||"";a+=this._indentation(d);a+=SC.LOGGER_LOG_GROUP_HEADER.fmt(h);b.log(a)}}},_addRecordedMessageEntry:function(d){var b=this.get("recordedLogMessages"),a;if(!b){b=[];this.set("recordedLogMessages",b)}b.push(d);a=b.length;if(a>this.get("recordedLogMessagesMaximumLength")){b.splice(0,(a-this.get("recordedLogMessagesPruningMinimumLength")))}b.enumerableContentDidChange()},_argumentsToArray:function(d){var b=[],e,a;if(d){for(e=0,a=d.length;e<a;++e){b[e]=d[e]}}return b},_argumentsToString:function(){var d="",b=SC.LOGGER_LOG_DELIMITER,e,a;for(e=0,a=(arguments.length-1);e<a;++e){d+=arguments[e]+b}d+=arguments[a];return d},_indentation:function(e){if(!e||e<0){e=0}var b="",a=SC.LOGGER_LOG_GROUP_INDENTATION,d;for(d=0;d<e;++d){b+=a}return b},_outputIndentationLevel:0,_recordingIndentationLevel:0,_LOG_LEVEL_MAPPING:{debug:4,info:3,warn:2,error:1,none:0},_LOG_FALLBACK_PREFIX_MAPPING:{debug:SC.LOGGER_LOG_DEBUG,info:SC.LOGGER_LOG_INFO,warn:SC.LOGGER_LOG_WARN,error:SC.LOGGER_LOG_ERROR}});SC.debug=SC.Logger.debug;SC.info=SC.Logger.info;SC.warn=SC.Logger.warn;SC.error=SC.Logger.error;sc_require("ext/function");sc_require("private/observer_set");SC.RunLoop=SC.Object.extend({beginRunLoop:function(){this._start=new Date().getTime();if(SC.LOG_BINDINGS||SC.LOG_OBSERVERS){SC.Logger.log("-- SC.RunLoop.beginRunLoop at %@".fmt(this._start))}this._runLoopInProgress=YES;this._flushinvokeNextQueue();return this},isRunLoopInProgress:function(){return this._runLoopInProgress}.property(),endRunLoop:function(){if(SC.LOG_BINDINGS||SC.LOG_OBSERVERS){SC.Logger.log("-- SC.RunLoop.endRunLoop ~ flushing application queues")}this.flushAllPending();this._start=null;if(SC.LOG_BINDINGS||SC.LOG_OBSERVERS){SC.Logger.log("-- SC.RunLoop.endRunLoop ~ End")}SC.RunLoop.lastRunLoopEnd=Date.now();this._runLoopInProgress=NO;return this},flushAllPending:function(){var a;do{a=this.flushApplicationQueues();if(!a){a=this._flushinvokeLastQueue()}}while(a)},invokeOnce:function(b,d){if(d===undefined){d=b;b=this}var a;if(typeof d==="string"){d=b[d]}if(!this._invokeQueue){this._invokeQueue=SC.ObserverSet.create()}if(d){this._invokeQueue.add(b,d,undefined,a)}return this},invokeLast:function(b,d){if(d===undefined){d=b;b=this}var a;if(typeof d==="string"){d=b[d]}if(!this._invokeLastQueue){this._invokeLastQueue=SC.ObserverSet.create()}this._invokeLastQueue.add(b,d,undefined,a);return this},invokeNext:function(a,b){if(b===undefined){b=a;a=this}if(typeof b==="string"){b=a[b]}if(!this._invokeNextQueue){this._invokeNextQueue=SC.ObserverSet.create()}this._invokeNextQueue.add(a,b);return this},flushApplicationQueues:function(){var b=NO,a=this._invokeQueue;if(a&&a.getMembers().length){this._invokeQueue=null;b=YES;a.invokeMethods()}return SC.Binding.flushPendingChanges()||b},_flushinvokeLastQueue:function(){var a=this._invokeLastQueue,b=NO;if(a&&a.getMembers().length){this._invokeLastQueue=null;b=YES;if(b){a.invokeMethods()}}return b},_flushinvokeNextQueue:function(){var a=this._invokeNextQueue,b=NO;if(a&&a.getMembers().length){this._invokeNextQueue=null;b=YES;if(b){a.invokeMethods()}}return b}});SC.RunLoop.currentRunLoop=null;SC.RunLoop.runLoopClass=SC.RunLoop;SC.RunLoop.begin=function(){var a=this.currentRunLoop;if(!a){a=this.currentRunLoop=this.runLoopClass.create()}a.beginRunLoop();return this};SC.RunLoop.end=function(){var a=this.currentRunLoop;if(!a){throw"SC.RunLoop.end() called outside of a runloop!"}a.endRunLoop();return this};SC.RunLoop.kill=function(){this.currentRunLoop=this.runLoopClass.create();return this};SC.RunLoop.isRunLoopInProgress=function(){if(this.currentRunLoop){return this.currentRunLoop.get("isRunLoopInProgress")}return NO};SC.run=function(h,g,b){var a=SC.RunLoop.isRunLoopInProgress();if(SC.ExceptionHandler&&SC.ExceptionHandler.enabled){try{if(b||!a){SC.RunLoop.begin()}if(h){h.call(g)}if(b||!a){SC.RunLoop.end()}}catch(f){var d=SC.ExceptionHandler.handleException(f);if(!d&&!SC.browser.isIE){throw f}}}else{if(b||!a){SC.RunLoop.begin()}if(h){h.call(g)}if(b||!a){SC.RunLoop.end()}}};SC.RunLoop.wrapFunction=function(b){var a=function(){var d=SC.RunLoop.isRunLoopInProgress();if(!d){SC.RunLoop.begin()}var e=arguments.callee.wrapped.apply(this,arguments);if(!d){SC.RunLoop.end()}return e};a.wrapped=b;return a};SC.DROP_ON=1;SC.DROP_BEFORE=2;SC.DROP_AFTER=4;SC.DROP_ANY=7;SC.ALIGN_LEFT="left";SC.ALIGN_RIGHT="right";SC.ALIGN_CENTER="center";SC.ALIGN_TOP="top";SC.ALIGN_MIDDLE="middle";SC.ALIGN_BOTTOM="bottom";SC.ALIGN_TOP_LEFT="top-left";SC.ALIGN_TOP_RIGHT="top-right";SC.ALIGN_BOTTOM_LEFT="bottom-left";SC.ALIGN_BOTTOM_RIGHT="bottom-right";SC.mixin({data:$.data,removeData:$.removeData,STRINGS:{},stringsFor:function(b,a){SC.mixin(SC.STRINGS,a);return this}});SC.Controller=SC.Object.extend({isEditable:YES,destroyContentOnReplace:NO,contentObjectDidChanged:function(){var b,a;if(!this.get("destroyContentOnReplace")){return}b=this._oldContent;a=this.get("content");if(b&&a!==b&&b.destroy){b.destroy()}this._oldContent=a}.observes("content")});SC.SelectionSupport={hasSelectionSupport:YES,allowsSelection:YES,allowsMultipleSelection:YES,allowsEmptySelection:YES,firstSelectableObject:function(){return this.get("firstObject")}.property(),selection:function(e,g){var d=this._scsel_selection,h=d?d.get("length"):0,f,b=this.get("arrangedObjects"),a;if((g===undefined)||!this.get("allowsSelection")){g=d}a=(g&&g.isEnumerable)?g.get("length"):0;if((a>1)&&!this.get("allowsMultipleSelection")){if(h>1){g=SC.SelectionSet.create().addObject(d.get("firstObject")).freeze();a=1}else{g=d;a=h}}if((a===0)&&!this.get("allowsEmptySelection")&&b&&b.get("length")!==0){if(h===0){g=this.get("firstSelectableObject");if(g){g=SC.SelectionSet.create().addObject(g).freeze()}else{g=SC.SelectionSet.EMPTY}a=g.get("length")}else{g=d;a=h}}if(a===0){g=SC.SelectionSet.EMPTY}if(g!==d){g=g.frozenCopy()}this._scsel_selection=g;return g}.property("arrangedObjects","allowsEmptySelection","allowsMultipleSelection","allowsSelection").cacheable(),hasSelection:function(){var a=this.get("selection");return !!a&&(a.get("length")>0)}.property("selection").cacheable(),selectObjects:function(b,d){if(!b||b.get("length")===0){if(!d){this.set("selection",SC.SelectionSet.EMPTY)}return this}var a=this.get("selection");if(d&&a){a=a.copy()}else{a=SC.SelectionSet.create()}a.addObjects(b).freeze();this.set("selection",a);return this},selectObject:function(a,b){if(a===null){if(!b){this.set("selection",null)}return this}else{return this.selectObjects([a],b)}},deselectObjects:function(b){if(!b||b.get("length")===0){return this}var a=this.get("selection");if(!a||a.get("length")===0){return this}a=a.copy().removeObjects(b).freeze();this.set("selection",a.freeze());return this},deselectObject:function(a){if(!a){return this}else{return this.deselectObjects([a])}},updateSelectionAfterContentChange:function(){var a=this.get("arrangedObjects");var b=this.get("selection");var e=this.get("allowsEmptySelection");var d;if(!b){return this}d=b.indexSetForSource(a);if((d&&(d.get("length")!==b.get("length")))||(!d&&(b.get("length")>0))){b=b.copy().constrain(a).freeze();this.set("selection",b)}if((b.get("length")===0)&&a&&(a.get("length")>0)&&!e){this.selectObject(this.get("firstSelectableObject"),NO)}return this}};sc_require("controllers/controller");sc_require("mixins/selection_support");SC.ArrayController=SC.Controller.extend(SC.Array,SC.SelectionSupport,{content:null,isEditable:YES,orderBy:null,allowsSingleContent:YES,destroyOnRemoval:NO,arrangedObjects:function(){return this}.property().cacheable(),canRemoveContent:function(){var b=this.get("content"),a;a=!!b&&this.get("isEditable")&&this.get("hasContent");if(a){return !b.isEnumerable||(SC.typeOf(b.removeObject)===SC.T_FUNCTION)}else{return NO}}.property("content","isEditable","hasContent"),canReorderContent:function(){var b=this.get("content"),a;a=!!b&&this.get("isEditable")&&!this.get("orderBy");return a&&!!b.isSCArray}.property("content","isEditable","orderBy"),canAddContent:function(){var b=this.get("content"),a;a=b&&this.get("isEditable")&&b.isEnumerable;if(a){return(SC.typeOf(b.addObject)===SC.T_FUNCTION)||(SC.typeOf(b.pushObject)===SC.T_FUNCTION)}else{return NO}}.property("content","isEditable"),hasContent:function(){var a=this.get("content");return !!a&&(!!a.isEnumerable||!!this.get("allowsSingleContent"))}.property("content","allowSingleContent"),status:function(){var b=this.get("content"),a=b?b.get("status"):null;return a?a:SC.Record.READY}.property().cacheable(),addObject:function(a){if(!this.get("canAddContent")){throw"%@ cannot add content".fmt(this)}var b=this.get("content");if(b.isSCArray){b.pushObject(a)}else{if(b.addObject){b.addObject(a)}else{throw"%@.content does not support addObject".fmt(this)}}return this},removeObject:function(a){if(!this.get("canRemoveContent")){throw"%@ cannot remove content".fmt(this)}var b=this.get("content");if(b.isEnumerable){b.removeObject(a)}else{this.set("content",null)}if(this.get("destroyOnRemoval")&&a.destroy){a.destroy()}return this},length:function(){var a=this._scac_observableContent();return a?a.get("length"):0}.property().cacheable(),objectAt:function(a){var b=this._scac_observableContent();return b?b.objectAt(a):undefined},replace:function(h,g,e){if(!e||e.get("length")===0){if(!this.get("canRemoveContent")){throw"%@ cannot remove objects from the current content".fmt(this)}}else{if(!this.get("canReorderContent")){throw"%@ cannot add or reorder the current content".fmt(this)}}var d=this.get("content");var b=[],a,f;if(this.get("destroyOnRemoval")){for(a=0;a<g;a++){b.push(d.objectAt(a+h))}}if(d){d.replace(h,g,e)}for(a=0,f=b.length;a<f;a++){b[a].destroy()}b=null;return this},indexOf:function(b,a){var d=this._scac_observableContent();return d?d.indexOf(b,a):-1},init:function(){arguments.callee.base.apply(this,arguments);this._scac_contentDidChange()},_scac_cached:NO,_scac_observableContent:function(){var d=this._scac_cached;if(d){return d}var g=this.get("content"),f,b,a;if(SC.none(g)){return(this._scac_cached=[])}if(!g.isEnumerable){d=this.get("allowsSingleContent")?[g]:[];return(this._scac_cached=d)}var h=this.get("orderBy");if(!h){if(g.isSCArray){return(this._scac_cached=g)}else{throw"%@.orderBy is required for unordered content".fmt(this)}}var e=SC.typeOf(h);if(e===SC.T_STRING){h=[h]}else{if(e===SC.T_FUNCTION){f=h}else{if(e!==SC.T_ARRAY){throw"%@.orderBy must be Array, String, or Function".fmt(this)}}}f=f||function(q,p){var m,s,o,j,t;for(var n=0,k=h.get("length");n<k&&!m;n++){s=h.objectAt(n);if(s.search(/(ASC|DESC)/)===0){o=s.match(/^(ASC )?(DESC )?(.*)$/);s=o[3]}else{o=s.match(/^(\S*)\s*(DESC)?(?:ASC)?$/);s=o[1]}a=o[2]?-1:1;if(q){j=q.isObservable?q.get(s):q[s]}if(p){t=p.isObservable?p.get(s):p[s]}m=SC.compare(j,t)*a}return m};return(this._scac_cached=g.toArray().sort(f))},propertyWillChange:function(a){if(a==="content"){this.arrayContentWillChange(0,this.get("length"),0)}else{return arguments.callee.base.apply(this,arguments)}},_scac_arrayContentWillChange:function(e,d,a){this.arrayContentWillChange(e,d,a);if(this._kvo_enumerable_property_chains){var b=this.slice(e,e+d);this.teardownEnumerablePropertyChains(b)}},_scac_arrayContentDidChange:function(e,d,a){this._scac_cached=NO;this.arrayContentDidChange(e,d,a);if(this._kvo_enumerable_property_chains){var b=this.slice(e,e+a);this.setupEnumerablePropertyChains(b)}this.updateSelectionAfterContentChange()},_scac_contentDidChange:function(){this._scac_cached=NO;var j=this.get("content"),e=!!this.get("orderBy"),k=this._scac_content,a=this._scac_length||0,h=this._scac_arrayContentDidChange,d=this._scac_arrayContentWillChange,b=this._scac_contentStatusDidChange,g=this._scac_enumerableDidChange,f;if(j===k){return this}if(k){if(k.isSCArray){k.removeArrayObservers({target:this,didChange:h,willChange:d})}else{if(k.isEnumerable){k.removeObserver("[]",this,g)}}k.removeObserver("status",this,b);this.teardownEnumerablePropertyChains(k)}this._scac_cached=NO;this._scac_content=j;if(j){if(j.isSCArray){j.addArrayObservers({target:this,didChange:h,willChange:d});f=j.get("length")}else{if(j.isEnumerable){j.addObserver("[]",this,g);f=j.get("length")}else{f=1}}j.addObserver("status",this,b);this.setupEnumerablePropertyChains(j)}else{f=SC.none(j)?0:1}this._scac_length=f;this._scac_contentStatusDidChange();this.arrayContentDidChange(0,0,f);this.updateSelectionAfterContentChange()}.observes("content"),_scac_enumerableDidChange:function(){var a=this.get("content"),d=a?a.get("length"):0,b=this._scac_length;this._scac_length=d;this.beginPropertyChanges();this._scac_cached=NO;this.arrayContentDidChange(0,b,d);this.enumerableContentDidChange(0,b-1);this.endPropertyChanges();this.updateSelectionAfterContentChange()}.observes("orderBy"),_scac_contentStatusDidChange:function(){this.notifyPropertyChange("status")}});sc_require("controllers/controller");SC.ObjectController=SC.Controller.extend({content:null,allowsMultipleContent:NO,hasContent:function(){return !SC.none(this.get("observableContent"))}.property("observableContent"),isEditable:YES,observableContent:function(){var b=this.get("content"),a,d;if(b&&b.isEnumerable){a=b.get("length");d=this.get("allowsMultipleContent");if(a===1){b=b.firstObject()}else{if(a===0||!d){b=null}}if(b&&!d&&b.isEnumerable){b=null}}return b}.property("content","allowsMultipleContent").cacheable(),destroy:function(){var a=this.get("observableContent");if(a&&SC.typeOf(a.destroy)===SC.T_FUNCTION){a.destroy()}this.set("content",null);return this},contentPropertyDidChange:function(b,a){if(a==="*"){this.allPropertiesDidChange()}else{this.notifyPropertyChange(a)}},unknownProperty:function(b,e){if(b==="content"){if(e!==undefined){this.content=e}return this.content}var d=this.get("observableContent"),g,f,a;if(d===null||d===undefined){return undefined}if(e===undefined){if(d.isEnumerable){e=d.getEach(b);g=e.get("length");if(g>0){a=YES;f=e.objectAt(0);while((--g>0)&&a){if(f!==e.objectAt(g)){a=NO}}if(a){e=f}}else{e=undefined}}else{e=(d.isObservable)?d.get(b):d[b]}}else{if(!this.get("isEditable")){throw"%@.%@ is not editable".fmt(this,b)}if(d.isEnumerable){d.setEach(b,e)}else{if(d.isObservable){d.set(b,e)}else{d[b]=e}}}return e},init:function(){arguments.callee.base.apply(this,arguments);if(this.get("content")){this._scoc_contentDidChange()}if(this.get("observableContent")){this._scoc_observableContentDidChange()}},_scoc_contentDidChange:function(){var b=this._scoc_content,d=this.get("content");if(b!==d){this._scoc_content=d;var a=this._scoc_enumerableContentDidChange;if(b&&b.isEnumerable){b.removeObserver("[]",this,a)}if(d&&d.isEnumerable){d.addObserver("[]",this,a)}}}.observes("content"),_scoc_observableContentDidChange:function(){var b=this._scoc_observableContent,e=this.get("observableContent"),a=this.contentPropertyDidChange,d=this._scoc_enumerableContentDidChange;if(b===e){return this}this._scoc_observableContent=e;if(b){if(b.isEnumerable){b.removeObserver("[]",this,d)}else{if(b.isObservable){b.removeObserver("*",this,a)}}}if(e){if(e.isEnumerable){e.addObserver("[]",this,d)}else{if(e.isObservable){e.addObserver("*",this,a)}}}if((b&&b.isEnumerable)||(e&&e.isEnumerable)){this._scoc_enumerableContentDidChange()}else{this.contentPropertyDidChange(e,"*")}}.observes("observableContent"),_scoc_enumerableContentDidChange:function(){var b=this.get("observableContent"),d=this._scoc_observableContentItems,a=this.contentPropertyDidChange;if(d){d.forEach(function(e){if(e.isObservable){e.removeObserver("*",this,a)}},this);d.clear()}if(b&&b.isEnumerable){if(!d){d=SC.Set.create()}b.forEach(function(e){if(d.contains(e)){return}d.add(e);if(e.isObservable){e.addObserver("*",this,a)}},this)}else{d=null}this._scoc_observableContentItems=d;this.contentPropertyDidChange(b,"*");return this}});SC.mixin(Function.prototype,{invokeLater:function(g,a){if(a===undefined){a=1}var e=this;if(arguments.length>2){var b=SC.$A(arguments).slice(2,arguments.length);b.unshift(g);var d=e;e=function(){return d.apply(this,b.slice(1))}}return SC.Timer.schedule({target:g,action:e,interval:a})}});SC.mixin(SC.Object.prototype,{invokeLater:function(e,a){var d,b;if(SC.typeOf(e)===SC.T_STRING){e=this[e]}if(a===undefined){a=1}if(arguments.length>2){b=SC.$A(arguments).slice(2);d=function(){return e.apply(this,b)}}else{d=e}return SC.Timer.schedule({target:this,action:d,interval:a})},invokeOnceLater:function(k,d){var e,h,b,g=this._sc_invokeOnceLaterTimers,j,a;if(SC.typeOf(k)===SC.T_STRING){k=this[k]}if(d===undefined){d=1}if(!g){g=this._sc_invokeOnceLaterTimers={}}b=SC.guidFor(k);j=g[b];if(j){j.invalidate()}if(arguments.length>2){e=SC.$A(arguments).slice(2)}else{e=arguments}h=function(){delete g[b];return k.apply(this,e)};a=SC.Timer.schedule({target:this,action:h,interval:d});g[b]=a;return a},invokeWith:function(b,d,e){if(e===undefined){e=d;d=this}if(!d){d=this}if(SC.typeOf(e)===SC.T_STRING){e=d[e]}var a=this.getPath(b);e.call(d,a,this);return this}});SC.RunLoop=SC.RunLoop.extend({startTime:function(){if(!this._start){this._start=Date.now()}return this._start}.property(),endRunLoop:function(){this.fireExpiredTimers();var a=arguments.callee.base.apply(this,arguments);this.scheduleNextTimeout();return a},scheduleTimer:function(b,a){this._timerQueue=b.removeFromTimerQueue(this._timerQueue);this._timerQueue=b.scheduleInTimerQueue(this._timerQueue,a);return this},cancelTimer:function(a){this._timerQueue=a.removeFromTimerQueue(this._timerQueue);return this},TIMER_ARRAY:[],fireExpiredTimers:function(){if(!this._timerQueue||this._firing){return NO}var e=this.get("startTime"),f=this.TIMER_ARRAY,d,b,a;this._firing=YES;this._timerQueue=this._timerQueue.collectExpiredTimers(f,e);b=f.length;for(d=0;d<b;d++){f[d].fire()}a=f.length>0;f.length=0;this._firing=NO;return a},scheduleNextTimeout:function(){var e=this._timerQueue;var b=NO;if(!e){if(this._timeout){clearTimeout(this._timeout)}}else{var d=e._timerQueueRunTime;if(this._timeoutAt!==d){if(this._timeout){clearTimeout(this._timeout)}var a=Math.max(0,d-Date.now());this._timeout=setTimeout(this._timeoutDidFire,a);this._timeoutAt=d}b=YES}return b},_timeoutDidFire:function(){var a=SC.RunLoop.currentRunLoop;a._timeout=a._timeoutAt=null;SC.run()}});SC.RunLoop.currentRunLoop=SC.RunLoop.create();SC.RunLoop.runLoopClass=SC.RunLoop;SC.Locale=SC.Object.extend({init:function(){if(!this.language){SC.Locale._assignLocales()}if(!this.hasStrings){var d=this._deprecatedLanguageCodes||[];d.push(this.language);var b=d.length;var a=null;while(!a&&--b>=0){a=String[d[b]]}if(a){this.hasStrings=YES;this.strings=a}}},hasStrings:NO,strings:{},metrics:{},toString:function(){if(!this.language){SC.Locale._assignLocales()}return"SC.Locale["+this.language+"]"+SC.guidFor(this)},locWithDefault:function(b,d){var a=this.strings[b];if(SC.typeOf(a)===SC.T_STRING){return a}else{if(SC.typeOf(d)===SC.T_STRING){return d}}return b},locMetric:function(b){var a=this.metrics[b];if(SC.typeOf(a)===SC.T_NUMBER){return a}else{if(a===undefined){SC.warn('No localized metric found for key "'+b+'"');return undefined}else{SC.warn('Unexpected metric type for key "'+b+'"');return undefined}}},locLayout:function(d,b){var f,h,g,n,m,a=SC.Locale.layoutKeys,l=this.metrics,k=SC.typeOf,e=SC.T_NUMBER,j={};if(b){SC.mixin(j,b)}for(f=0,h=a.length;f<h;++f){g=a[f];n=d+"."+g;m=l[n];if(k(m)===e){if(b&&b[g]){throw"locLayout():  There is a localized value for the key '"+n+"' but a value for '"+g+"' was also specified in the non-localized hash"}j[g]=m}}return j}});SC.Locale.mixin({useAutodetectedLanguage:NO,preferredLanguage:null,layoutKeys:["left","top","right","bottom","width","height","minWidth","minHeight","centerX","centerY"],createCurrentLocale:function(){var d=(String.useAutodetectedLanguage!==undefined)?String.useAutodetectedLanguage:this.useAutodetectedLanguage;var b=(String.preferredLanguage!==undefined)?String.preferredLanguage:this.preferredLanguage;var e=((d)?SC.browser.language:null)||b||SC.browser.language||"en";e=SC.Locale.normalizeLanguage(e);var a=this.localeClassFor(e);if(e!=this.currentLanguage){this.currentLanguage=e;this.currentLocale=a.create()}return this.currentLocale},localeClassFor:function(d){d=SC.Locale.normalizeLanguage(d);var b,a=this.locales[d];if(!a&&((b=d.split("-")[0])!==d)&&(a=this.locales[b])){a=this.locales[d]=a.extend()}if(!a){a=this.locales[d]=this.locales.en.extend()}return a},define:function(b,d){var a;if(d===undefined&&(SC.typeOf(b)!==SC.T_STRING)){a=this;d=b}else{a=SC.Locale.localeClassFor(b)}SC.mixin(a.prototype,d);return a},options:function(){return this.prototype},addStrings:function(b){var a=this.prototype.strings;if(a){if(!this.prototype.hasOwnProperty("strings")){a=this.prototype.strings=SC.clone(a)}}else{a=this.prototype.strings={}}if(b){this.prototype.strings=SC.mixin(a,b)}this.prototype.hasStrings=YES;return this},addMetrics:function(b){var a=this.prototype.metrics;if(a){if(!this.prototype.hasOwnProperty(a)){a=this.prototype.metrics=SC.clone(a)}}else{a=this.prototype.metrics={}}if(b){this.prototype.metrics=SC.mixin(a,b)}return this},_map:{english:"en",french:"fr",german:"de",japanese:"ja",jp:"ja",spanish:"es"},normalizeLanguage:function(a){if(!a){return"en"}return SC.Locale._map[a.toLowerCase()]||a},_assignLocales:function(){for(var a in this.locales){this.locales[a].prototype.language=a}},toString:function(){if(!this.prototype.language){SC.Locale._assignLocales()}return"SC.Locale["+this.prototype.language+"]"},extend:function(){var a=SC.Object.extend.apply(this,arguments);a.addStrings=SC.Locale.addStrings;a.define=SC.Locale.define;a.options=SC.Locale.options;a.toString=SC.Locale.toString;return a}});SC.Locale.locales={en:SC.Locale.extend({_deprecatedLanguageCodes:["English"]}),fr:SC.Locale.extend({_deprecatedLanguageCodes:["French"]}),de:SC.Locale.extend({_deprecatedLanguageCodes:["German"]}),ja:SC.Locale.extend({_deprecatedLanguageCodes:["Japanese","jp"]}),es:SC.Locale.extend({_deprecatedLanguageCodes:["Spanish"]})};SC.stringsFor=function(d,b){var a=SC.Locale.localeClassFor(d);a.addStrings(b);return this};SC.metricsFor=function(d,b){var a=SC.Locale.localeClassFor(d);a.addMetrics(b);return this};sc_require("system/locale");SC.STRING_TITLEIZE_REGEXP=(/([\s|\-|\_|\n])([^\s|\-|\_|\n]?)/g);SC.STRING_DECAMELIZE_REGEXP=(/([a-z])([A-Z])/g);SC.STRING_DASHERIZE_REGEXP=(/[ _]/g);SC.STRING_DASHERIZE_CACHE={};SC.STRING_TRIM_LEFT_REGEXP=(/^\s+/g);SC.STRING_TRIM_RIGHT_REGEXP=(/\s+$/g);SC.mixin(SC.String,{capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},camelize:function(e){var b=e.replace(SC.STRING_TITLEIZE_REGEXP,function(g,h,f){return f?f.toUpperCase():""});var d=b.charAt(0),a=d.toLowerCase();return d!==a?a+b.slice(1):b},decamelize:function(a){return a.replace(SC.STRING_DECAMELIZE_REGEXP,"$1_$2").toLowerCase()},dasherize:function(d){var a=SC.STRING_DASHERIZE_CACHE,b=a[d];if(b){return b}else{b=SC.String.decamelize(d).replace(SC.STRING_DASHERIZE_REGEXP,"-");a[d]=b}return b},loc:function(f){if(!SC.Locale.currentLocale){SC.Locale.createCurrentLocale()}var b=SC.Locale.currentLocale.locWithDefault(f);if(SC.typeOf(b)!==SC.T_STRING){b=f}var a=SC.$A(arguments);a.shift();if(a.length>0&&a[0]&&a[0].isSCArray){a=a[0]}try{return SC.String.fmt(b,a)}catch(d){SC.error("Error processing string with key: "+f);SC.error("Localized String: "+b);SC.error("Error: "+d)}},locMetric:function(b){var a=SC.Locale,d=a.currentLocale;if(!d){a.createCurrentLocale();d=a.currentLocale}return d.locMetric(b)},locLayout:function(b,d){var a=SC.Locale,e=a.currentLocale;if(!e){a.createCurrentLocale();e=a.currentLocale}return e.locLayout(b,d)},locWithDefault:function(e,d){if(!SC.Locale.currentLocale){SC.Locale.createCurrentLocale()}var b=SC.Locale.currentLocale.locWithDefault(e,d);if(SC.typeOf(b)!==SC.T_STRING){b=e}var a=SC.$A(arguments);a.shift();a.shift();return SC.String.fmt(b,a)},trim:jQuery.trim,trimLeft:function(a){return a.replace(SC.STRING_TRIM_LEFT_REGEXP,"")},trimRight:function(a){return a.replace(SC.STRING_TRIM_RIGHT_REGEXP,"")},mult:function(e,d){if(SC.typeOf(d)!==SC.T_NUMBER||d<1){return null}var a="";for(var b=0;b<d;b+=1){a+=e}return a}});if(String.prototype.trim){SC.supplement(String.prototype,{trim:function(){return SC.String.trim(this,arguments)},trimLeft:function(){return SC.String.trimLeft(this,arguments)},trimRight:function(){return SC.String.trimRight(this,arguments)}})}SC.mixin(String.prototype,{loc:function(){return SC.String.loc(this.toString(),SC.$A(arguments))},locMetric:function(){return SC.String.locMetric(this.toString())},locLayout:function(a){return SC.String.locLayout(this.toString(),a)}});sc_require("system/string");SC.supplement(String.prototype,{capitalize:function(){return SC.String.capitalize(this,arguments)},camelize:function(){return SC.String.camelize(this,arguments)},decamelize:function(){return SC.String.decamelize(this,arguments)},dasherize:function(){return SC.String.dasherize(this,arguments)},loc:function(){var a=SC.$A(arguments);a.unshift(this);return SC.String.loc.apply(SC.String,a)},locWithDefault:function(b){var a=SC.$A(arguments);a.unshift(this);return SC.String.locWithDefault.apply(SC.String,a)},mult:function(a){return SC.String.mult(this,a)}});SC.ActionSupport={target:null,action:null,actionContext:null,fireAction:function(b){var d=this.get("target")||null,a=this.getPath("pane.rootResponder");if(b===undefined){b=this.get("action")}if(b&&a){return a.sendAction(b,d,this,this.get("pane"),this.get("actionContext"),this)}return false}};SC.DelegateSupport={delegateFor:function(d){var b=1,a=arguments.length,e;while(b<a){e=arguments[b];if(e&&e[d]!==undefined){return e}b++}return(this[d]!==undefined)?this:null},invokeDelegateMethod:function(d,a,b){b=SC.A(arguments);b=b.slice(2,b.length);if(!d||!d[a]){d=this}var e=d[a];return e?e.apply(d,b):null},getDelegateProperty:function(e,f){var b=1,a=arguments.length,d;while(b<a){d=arguments[b++];if(d&&d[e]!=undefined){return d.get?d.get(e):d[e]}}return(this[e]!=undefined)?this.get(e):undefined}};SC.Responder=SC.Object.extend({isResponder:YES,pane:null,responderContext:null,nextResponder:null,isFirstResponder:NO,hasFirstResponder:NO,acceptsFirstResponder:YES,becomingFirstResponder:NO,becomeFirstResponder:function(){var a=this.get("pane")||this.get("responderContext")||this.pane();if(a&&this.get("acceptsFirstResponder")){if(a.get("firstResponder")!==this){a.makeFirstResponder(this)}}return this},resignFirstResponder:function(a){var b=this.get("pane")||this.get("responderContext");if(b&&(b.get("firstResponder")===this)){b.makeFirstResponder(null,a)}return YES},willLoseFirstResponder:function(a){},didBecomeFirstResponder:function(a){}});sc_require("system/responder");SC.ResponderContext={isResponderContext:YES,trace:NO,defaultResponder:null,nextResponder:function(){return this.get("defaultResponder")}.property("defaultResponder").cacheable(),firstResponder:null,nextResponderFor:function(a){var b=a.get("nextResponder");if(typeof b===SC.T_STRING){b=SC.objectForPropertyPath(b,this)}else{if(!b&&(a!==this)){b=this}}return b},responderNameFor:function(a){if(!a){return"(No Responder)"}else{if(a._scrc_name){return a._scrc_name}}var b=this.NAMESPACE;this._findResponderNamesFor(this,3,b?[this.NAMESPACE]:[]);return a._scrc_name||a.toString()},_findResponderNamesFor:function(a,f,e){var b,d;for(b in a){if(b==="nextResponder"){continue}d=a[b];if(d&&d.isResponder){if(d._scrc_name){continue}e.push(b);d._scrc_name=e.join(".");if(f>0){this._findResponderNamesFor(d,f-1,e)}e.pop()}}},makeFirstResponder:function(b,a){var g=this.get("firstResponder"),e=this.get("nextResponder"),f=this.get("trace"),d;if(this._locked){if(f){SC.Logger.log("%@: AFTER ACTION: makeFirstResponder => %@".fmt(this,this.responderNameFor(b)))}this._pendingResponder=b;return}if(f){SC.Logger.log("%@: makeFirstResponder => %@".fmt(this,this.responderNameFor(b)))}if(b){b.set("becomingFirstResponder",YES)}this._locked=YES;this._pendingResponder=null;d=b?b:null;while(d){if(d.get("hasFirstResponder")){break}d=(d===e)?null:this.nextResponderFor(d)}if(!d){d=e}this._notifyWillLoseFirstResponder(g,g,d,a);if(g){g.set("isFirstResponder",NO)}this.beginPropertyChanges();this.set("firstResponder",b);if(b){b.set("isFirstResponder",YES)}this._notifyDidBecomeFirstResponder(b,b,d);this.endPropertyChanges();this._locked=NO;if(this._pendingResponder){this.makeFirstResponder(this._pendingResponder);this._pendingResponder=null}if(b){b.set("becomingFirstResponder",NO)}return this},_notifyWillLoseFirstResponder:function(d,f,b,a){if(!f||f===b){return}f.willLoseFirstResponder(d,a);f.set("hasFirstResponder",NO);var e=this.nextResponderFor(f);if(e){this._notifyWillLoseFirstResponder(d,e,b)}},_notifyDidBecomeFirstResponder:function(b,e,a){if(!e||e===a){return}var d=this.nextResponderFor(e);if(d){this._notifyDidBecomeFirstResponder(b,d,a)}e.set("hasFirstResponder",YES);e.didBecomeFirstResponder(b)},resetFirstResponder:function(){var a=this.get("firstResponder");if(!a){return}a.willLoseFirstResponder();a.didBecomeFirstResponder()},sendAction:function(h,e,d){var a=this.get("firstResponder"),f=this.get("nextResponder"),g=this.get("trace"),j=NO,b;this._locked=YES;if(g){SC.Logger.log("%@: begin action '%@' (%@, %@)".fmt(this,h,e,d))}if(!j&&!a&&this.tryToPerform){j=this.tryToPerform(h,e,d)}while(!j&&a){if(a.tryToPerform){j=a.tryToPerform(h,e,d)}if(!j){a=(a===f)?null:this.nextResponderFor(a)}}if(g){if(!j){SC.Logger.log("%@:  action '%@' NOT HANDLED".fmt(this,h))}else{SC.Logger.log("%@: action '%@' handled by %@".fmt(this,h,this.responderNameFor(a)))}}this._locked=NO;if(b=this._pendingResponder){this._pendingResponder=null;this.makeFirstResponder(b)}return a}};SC.bodyOverflowArbitrator=SC.Object.create({requestHidden:function(b,a){this._makeRequest(b,-1-9*!!a)},requestVisible:function(b,a){this._makeRequest(b,1+9*!!a)},withdrawRequest:function(b){if(!b){return}var a=SC.guidFor(b);if(this._requests[a]){delete this._requests[a]}this.setOverflow()},setOverflow:function(){var a=this._decideOverflow();if(a!==undefined){document.body.style.overflow=a?"auto":"hidden"}},_makeRequest:function(d,b){if(!d){return}var a=SC.guidFor(d);this._requests[a]=b;this.setOverflow()},_requests:{},_decideOverflow:function(){var a,f,d,g,b=this._requests,h;for(var e in b){if((h=b[e])<0){a=YES}if(h<-1){d=YES}if(h>0){f=YES}if(h>1){g=YES}}if(g){return YES}if(f&&d){return NO}if(f){return YES}if(a){return NO}return undefined}});SC.mixin(SC.browser,{compare:function(d,a){var g,h,f;if(typeof d==="number"||typeof a==="number"){SC.warn("SC.browser.compare(): Versions compared against Numbers may not provide accurate results.  Use a String of decimal separated Numbers instead.");d=String(d);a=String(a)}g=function(j){return Number(j.match(/^[0-9]+/))};h=SC.A(d.split(".")).map(g);f=SC.A(a.split(".")).map(g);for(var e=0;e<f.length;e++){var b=h[e]-f[e];if(isNaN(b)){return 0}if(b!==0){return b}}return 0},compareVersion:function(){SC.warn("SC.browser.compareVersion() has been deprecated.  Please use SC.browser.compare() instead.  Example: SC.browser.compareVersion(16,0,912) < 0 becomes SC.browser.compare(SC.browser.engineVersion, '16.0.912').");if(this._versionSplit===undefined){var e=function(f){return Number(f.match(/^[0-9]+/))};this._versionSplit=SC.A(this.version.split(".")).map(e)}var d=SC.A(arguments).map(Number);for(var b=0;b<d.length;b++){var a=this._versionSplit[b]-d[b];if(isNaN(a)){return 0}if(a!==0){return a}}return 0}});SC.Builder=function(a){return SC.Builder.create(a)};SC.Builder.create=function create(d){var b=SC.mixin(SC.beget(this.fn),d||{});if(d.hasOwnProperty("toString")){b.toString=d.toString}var a=function(){var e=SC.beget(b);e.defaultClass=this;e.constructor=a;return e.init.apply(e,arguments)};a.fn=a.prototype=b;a.extend=SC.Builder.create;a.mixin=SC.Builder.mixin;return a};SC.Builder.mixin=function(){var b=arguments.length,a;for(a=0;a<b;a++){SC.mixin(this,arguments[a])}return this};SC.Builder.fn={init:function(a){if(a!==undefined){if(SC.typeOf(a)===SC.T_ARRAY){var b=a.length;while(--b>=0){this[b]=a.objectAt?a.objectAt(b):a[b]}this.length=a.length}else{this[0]=a;this.length=1}}return this},size:function(){return this.length},pushStack:function(){var a=this.constructor.apply(this,arguments);a.prevObject=this;return a},end:function(){return this.prevObject||this.constructor()},toString:function(){return"%@$(%@)".fmt(this.defaultClass.toString(),SC.A(this).invoke("toString").join(","))},mixin:SC.Builder.mixin};(function(){var a=SC.Enumerable,d=SC.Builder.fn,b,e;for(b in a){if(!a.hasOwnProperty(b)){continue}e=Array.prototype[b]||a[b];d[b]=e}})();sc_require("system/builder");SC.$=SC.CoreQuery=jQuery;SC.mixin(SC.$.fn,{isCoreQuery:YES,toString:function(){var d=[],b=this.length,a=0;for(a=0;a<b;a++){d[a]="%@: %@".fmt(a,this[a]?this[a].toString():"(null)")}return"<$:%@>(%@)".fmt(SC.guidFor(this),d.join(" , "))},isVisible:function(){return Array.prototype.every.call(this,function(a){return SC.$.isVisible(a)})},view:function(){return this.map(function(){var b=null,a=SC.viewKey,e=this,d;while(!b&&e&&(e!==document)){if(e.nodeType===1&&(d=e.getAttribute("id"))){b=SC.View.views[d]}e=e.parentNode}e=null;return b})},within:function(a){if(this.filter(a).length){return true}return !!this.has(a).length}});(function(){var d={},g={find:function(j,h){return(h!==undefined)?SC.Enumerable.find.call(this,j,h):d.find.call(this,j)},filter:function(j,h){return(h!==undefined)?this.pushStack(SC.Enumerable.filter.call(this,j,h)):d.filter.call(this,j)},filterProperty:function(h,j){return this.pushStack(SC.Enumerable.filterProperty.call(this,h,j))},indexOf:SC.$.index,map:function(j,h){return(h!==undefined)?SC.Enumerable.map.call(this,j,h):d.map.call(this,j)}};var e=SC.$.fn,a=SC.Enumerable,f;for(var b in a){if(a.hasOwnProperty(b)){f=a[b];if(b in g){d[b]=e[b];f=g[b]}e[b]=f}}})();SC.mixin(SC.$,{isVisible:function(a){var b=SC.$;return("hidden"!=a.type)&&(b.css(a,"display")!="none")&&(b.css(a,"visibility")!="hidden")}});sc_require("system/core_query");SC.Event=function(e){var d,b;if(e){this.originalEvent=e;var h=SC.Event._props,g;b=h.length;d=b;while(--d>=0){g=h[d];this[g]=e[g]}}this.timeStamp=this.timeStamp||Date.now();if(!this.target){this.target=this.srcElement||document}if(this.target.nodeType===3){this.target=this.target.parentNode}if(!this.relatedTarget&&this.fromElement){this.relatedTarget=(this.fromElement===this.target)?this.toElement:this.fromElement}if(SC.none(this.pageX)&&!SC.none(this.clientX)){var j=document.documentElement,a=document.body;this.pageX=this.clientX+(j&&j.scrollLeft||a&&a.scrollLeft||0)-(j.clientLeft||0);this.pageY=this.clientY+(j&&j.scrollTop||a&&a.scrollTop||0)-(j.clientTop||0)}if(!this.which&&((this.charCode||e.charCode===0)?this.charCode:this.keyCode)){this.which=this.charCode||this.keyCode}if(!this.metaKey&&this.ctrlKey){this.metaKey=this.ctrlKey}if(!this.which&&this.button){this.which=((this.button&1)?1:((this.button&2)?3:((this.button&4)?2:0)))}if(this.type==="mousewheel"||this.type==="DOMMouseScroll"||this.type==="MozMousePixelScroll"){var f=SC.Event.MOUSE_WHEEL_MULTIPLIER;if(SC.browser.isWebkit&&e.wheelDelta!==undefined){this.wheelDelta=0-(e.wheelDeltaY||e.wheelDeltaX);this.wheelDeltaY=0-(e.wheelDeltaY||0);this.wheelDeltaX=0-(e.wheelDeltaX||0)}else{if(!SC.none(e.detail)&&SC.browser.isMozilla){if(e.axis&&(e.axis===e.HORIZONTAL_AXIS)){this.wheelDeltaX=e.detail;this.wheelDeltaY=this.wheelDelta=0}else{this.wheelDeltaY=this.wheelDelta=e.detail;this.wheelDeltaX=0}}else{this.wheelDelta=this.wheelDeltaY=SC.browser.isIE||SC.browser.isOpera?0-e.wheelDelta:e.wheelDelta;this.wheelDeltaX=0}}this.wheelDelta*=f;this.wheelDeltaX*=f;this.wheelDeltaY*=f}return this};SC.mixin(SC.Event,{MOUSE_WHEEL_MULTIPLIER:function(){var b=1,a=SC.browser.engineVersion;if(SC.browser.name===SC.BROWSER.safari){b=0.4;if(SC.browser.compare(a,"533.17")>0&&SC.browser.compare(a,"534")<0){b=0.004}else{if(SC.browser.compare(a,"533")<0){b=40}}}else{if(SC.browser.name===SC.BROWSER.ie){b=0.3}else{if(SC.browser.name===SC.BROWSER.chrome){b=0.4}}}return b}(),MOUSE_WHEEL_DELTA_LIMIT:1000,_MOUSE_WHEEL_LIMIT_INVALIDATED:NO,create:function(a){return new SC.Event(a)},add:function(g,f,h,j,e,a){if(g&&g.isCoreQuery){if(g.length>0){g.forEach(function(k){this.add(k,f,h,j,e)},this);return this}else{g=g[0]}}if(!g){return this}if(!a){a=NO}if(g.nodeType===3||g.nodeType===8){return SC.Event}if(SC.browser.name===SC.BROWSER.ie&&g.setInterval){g=window}if(SC.typeOf(h)===SC.T_FUNCTION){e=j;j=h;h=null}else{if(h&&SC.typeOf(j)===SC.T_STRING){j=h[j]}}var d=SC.data(g,"sc_events")||SC.data(g,"sc_events",{}),b=d[f];if(!b){b=d[f]={};this._addEventListener(g,f,a)}b[SC.hashFor(h,j)]=[h,j,e];SC.Event._global[f]=YES;g=d=b=null;return this},remove:function(g,f,h,j){if(g&&g.isCoreQuery){if(g.length>0){g.forEach(function(k){this.remove(k,f,h,j)},this);return this}else{g=g[0]}}if(!g){return this}if(g.nodeType===3||g.nodeType===8){return SC.Event}var a,e,d=SC.data(g,"sc_events");if(!d){return this}if(f===undefined){for(f in d){this.remove(g,f)}}else{if(a=d[f]){var b=NO;if(h||j){if(SC.typeOf(h)===SC.T_FUNCTION){j=h;h=null}else{if(SC.typeOf(j)===SC.T_STRING){j=h[j]}}delete a[SC.hashFor(h,j)];e=null;for(e in a){break}if(e===null){b=YES}}else{b=YES}if(b){delete d[f];this._removeEventListener(g,f)}e=null;for(e in d){break}if(!e){SC.removeData(g,"sc_events");delete this._elements[SC.guidFor(g)]}}}g=d=a=null;return this},NO_BUBBLE:["blur","focus","change"],simulateEvent:function(e,d,b){var a=SC.Event.create({type:d,target:e,preventDefault:function(){this.cancelled=YES},stopPropagation:function(){this.bubbles=NO},allowDefault:function(){this.hasCustomEventHandling=YES},timeStamp:Date.now(),bubbles:(this.NO_BUBBLE.indexOf(d)<0),cancelled:NO,normalized:YES});if(b){SC.mixin(a,b)}return a},trigger:function(d,b,k,l){if(d&&d.isCoreQuery){if(d.length>0){d.forEach(function(o){this.trigger(o,b,k,l)},this);return this}else{d=d[0]}}if(!d){return this}if(d.nodeType===3||d.nodeType===8){return undefined}k=SC.A(k);var j,m=SC.typeOf(d[b]||null)===SC.T_FUNCTION,a,h,f,n;a=k[0];if(!a||!a.preventDefault){a=this.simulateEvent(d,b);k.unshift(a)}a.type=b;h=d;do{j=SC.Event.handle.apply(h,k);h=(h===document)?null:(h.parentNode||document)}while(!j&&a.bubbles&&h);h=null;f=d["on"+b];n=SC.$.nodeName(d,"a")&&b==="click";if((!m||n)&&f&&f.apply(d,k)===NO){j=NO}if(m&&l!==NO&&j!==NO&&!n){this.triggered=YES;try{d[b]()}catch(g){}}this.triggered=NO;return j},handle:function(b){if((typeof SC==="undefined")||SC.Event.triggered){return YES}var d,h,f,k,e,j,l,m,a,g;j=SC.A(arguments);j[0]=b=SC.Event.normalizeEvent(b||window.event);e=(SC.data(this,"sc_events")||{})[b.type];if(!e){return NO}for(l in e){m=e[l];a=m[1];b.handler=a;b.data=b.context=m[2];g=m[0]||this;h=a.apply(g,j);if(d!==NO){d=h}if(h===NO){b.preventDefault();b.stopPropagation()}}return d},unload:function(){var a,b=this._elements;for(a in b){this.remove(b[a])}for(a in b){delete b[a]}delete this._elements},special:{ready:{setup:function(){SC._bindReady();return},teardown:function(){return}},mouseenter:{setup:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.add(this,"mouseover",SC.Event.special.mouseenter.handler);return YES},teardown:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.remove(this,"mouseover",SC.Event.special.mouseenter.handler);return YES},handler:function(a){if(SC.Event._withinElement(a,this)){return YES}a.type="mouseenter";return SC.Event.handle.apply(this,arguments)}},mouseleave:{setup:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.add(this,"mouseout",SC.Event.special.mouseleave.handler);return YES},teardown:function(){if(SC.browser.name===SC.BROWSER.ie){return NO}SC.Event.remove(this,"mouseout",SC.Event.special.mouseleave.handler);return YES},handler:function(a){if(SC.Event._withinElement(a,this)){return YES}a.type="mouseleave";return SC.Event.handle.apply(this,arguments)}}},KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,_withinElement:function(e,d){var b=e.relatedTarget;while(b&&b!==d){try{b=b.parentNode}catch(a){b=d}}return b===d},_addEventListener:function(f,e,a){var g,d=this.special[e];if(!a){a=NO}if(!d||d.setup.call(f)===NO){var b=SC.guidFor(f);this._elements[b]=f;g=SC.data(f,"listener")||SC.data(f,"listener",function(){return SC.Event.handle.apply(SC.Event._elements[b],arguments)});if(f.addEventListener){f.addEventListener(e,g,a)}else{if(f.attachEvent){f.attachEvent("on"+e,g)}}}f=d=g=null},_removeEventListener:function(d,b){var e,a=SC.Event.special[b];if(!a||(a.teardown.call(d)===NO)){e=SC.data(d,"listener");if(e){if(d.removeEventListener){d.removeEventListener(b,e,NO)}else{if(d.detachEvent){d.detachEvent("on"+b,e)}}}}d=a=e=null},_elements:{},normalizeEvent:function(a){if(a===window.event){return SC.Event.create(a)}else{return a.normalized?a:SC.Event.create(a)}},_global:{},_props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target timeStamp toElement type view which touches targetTouches changedTouches animationName elapsedTime dataTransfer".split(" ")});SC.Event.prototype={hasCustomEventHandling:NO,touchesForView:function(a){if(this.touchContext){return this.touchContext.touchesForView(a)}},touchesForResponder:function(a){if(this.touchContext){return this.touchContext.touchesForView(a)}},averagedTouchesForView:function(a){if(this.touchContext){return this.touchContext.averagedTouchesForView(a)}return null},allowDefault:function(){this.hasCustomEventHandling=YES;return this},preventDefault:function(){var a=this.originalEvent;if(a){if(a.cancelable){if(!a.defaultPrevented){if(a.preventDefault){a.preventDefault()}a.returnValue=NO}}}this.hasCustomEventHandling=YES;return this},stopPropagation:function(){var a=this.originalEvent;if(a){if(a.stopPropagation){a.stopPropagation()}a.cancelBubble=YES}this.hasCustomEventHandling=YES;return this},stop:function(){return this.preventDefault().stopPropagation()},normalized:YES,getCharString:function(){if(SC.browser.name===SC.BROWSER.ie&&SC.browser.compare(SC.browser.version,"9.0")<0){if(this.keyCode==8||this.keyCode==9||(this.keyCode>=37&&this.keyCode<=40)){return String.fromCharCode(0)}else{return(this.keyCode>0)?String.fromCharCode(this.keyCode):null}}else{return(this.charCode>0)?String.fromCharCode(this.charCode):null}},commandCodes:function(){var f=this.keyCode,b=null,d=null,a="",e;if(f&&f!==this.charCode){b=SC.FUNCTION_KEYS[f];if(!b&&(this.altKey||this.ctrlKey||this.metaKey)){b=SC.PRINTABLE_KEYS[f]}if(b){if(this.altKey){a+="alt_"}if(this.ctrlKey||this.metaKey){a+="ctrl_"}if(this.shiftKey){a+="shift_"}}}if(!b){f=this.which;d=b=String.fromCharCode(f);e=b.toLowerCase();if(this.metaKey){a="meta_";b=e}else{b=null}}if(b){b=a+b}return[b,d]}};SC.Event.observe=SC.Event.add;SC.Event.stopObserving=SC.Event.remove;SC.Event.fire=SC.Event.trigger;if(SC.browser.name===SC.BROWSER.ie){SC.Event.add(window,"unload",SC.Event.prototype,SC.Event.unload)}SC.MODIFIER_KEYS={16:"shift",17:"ctrl",18:"alt"};SC.FUNCTION_KEYS={8:"backspace",9:"tab",13:"return",19:"pause",27:"escape",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"printscreen",45:"insert",46:"delete",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock"};SC.PRINTABLE_KEYS={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:'"'};SC.SYSTEM_CURSOR="default";SC.AUTO_CURSOR=SC.DEFAULT_CURSOR="auto";SC.CROSSHAIR_CURSOR="crosshair";SC.HAND_CURSOR=SC.POINTER_CURSOR="pointer";SC.MOVE_CURSOR="move";SC.E_RESIZE_CURSOR="e-resize";SC.NE_RESIZE_CURSOR="ne-resize";SC.NW_RESIZE_CURSOR="nw-resize";SC.N_RESIZE_CURSOR="n-resize";SC.SE_RESIZE_CURSOR="se-resize";SC.SW_RESIZE_CURSOR="sw-resize";SC.S_RESIZE_CURSOR="s-resize";SC.W_RESIZE_CURSOR="w-resize";SC.IBEAM_CURSOR=SC.TEXT_CURSOR="text";SC.WAIT_CURSOR="wait";SC.HELP_CURSOR="help";SC.Cursor=SC.Object.extend({init:function(){arguments.callee.base.apply(this,arguments);var a=this.get("cursorStyle")||SC.DEFAULT_CURSOR,d=this.constructor.sharedStyleSheet(),b=SC.guidFor(this);if(d.insertRule){d.insertRule("."+b+" {cursor: "+a+";}",d.cssRules?d.cssRules.length:0)}else{if(d.addRule){d.addRule("."+b,"cursor: "+a)}}this.cursorStyle=a;this.className=b;return this},className:null,cursorStyle:SC.DEFAULT_CURSOR,cursorStyleDidChange:function(){var e,g,d,f,h,b,a;e=this.get("cursorStyle")||SC.DEFAULT_CURSOR;g=this._rule;if(g){g.style.cursor=e;return}d="."+this.get("className");f=this.constructor.sharedStyleSheet();h=(f.cssRules?f.cssRules:f.rules)||[];for(b=0,a=h.length;b<a;++b){g=h[b];if(g.selectorText===d){this._rule=g;g.style.cursor=e;break}}}.observes("cursorStyle")});SC.Cursor.sharedStyleSheet=function(){var b,a=this._styleSheet;if(!a){a=document.createElement("style");a.type="text/css";b=document.getElementsByTagName("head")[0];if(!b){b=document.documentElement}b.appendChild(a);a=document.styleSheets[document.styleSheets.length-1];this._styleSheet=a}return a};SC.Theme={isTheme:YES,classNames:SC.CoreSet.create(),_extend_class_names:function(b){if(b){if(SC.typeOf(b)===SC.T_HASH&&!b.isSet){for(var a in b){if(b[a]){this.classNames.add(a)}else{this.classNames.remove(a)}}}else{if(typeof b==="string"){this.classNames.addEach(b.split(" "))}else{this.classNames.addEach(b)}}}},_extend_self:function(b){if(b.classNames){this._extend_class_names(b.classNames)}var a,d,e;for(a in b){if(a==="classNames"){continue}if(!b.hasOwnProperty(a)){continue}d=b[a];if(d instanceof Function&&!d.base&&(d!==(e=this[a]))){d.base=e}this[a]=d}},create:function(){var d=SC.beget(this);d.baseTheme=this;if(this.themes===SC.Theme.themes){d.themes={}}else{d.themes=SC.beget(this.themes)}d._privateThemes={};d._specializedThemes={};d.classNames=SC.clone(this.classNames);var f=arguments,b=f.length,a,e;for(a=0;a<b;a++){d._extend_self(f[a])}if(d.name){d.classNames.add(d.name)}return d},subtheme:function(a){var b=this.create({name:a});this.addTheme(b);return b},invisibleSubtheme:function(a){var b=this.create({name:a});this._privateThemes[a]=b;return b},themes:{},find:function(a){if(this===SC.Theme){return this.themes[a]}var b;b=this._privateThemes[a];if(b){return b}b=this._specializedThemes[a];if(b){return b}b=this.themes[a];if(b&&!this._specializedThemes[a]){return(this._specializedThemes[a]=b.create({classNames:this.classNames}))}b=SC.Theme.themes[a];if(b){return b}return null},addTheme:function(a){this.themes[a.name]=a}};SC.BaseTheme=SC.Theme.create({name:""});SC.Theme.themes["sc-base"]=SC.BaseTheme;SC.defaultTheme="sc-base";sc_require("mixins/delegate_support");SC.CoreView=SC.Responder.extend(SC.DelegateSupport);sc_require("system/browser");sc_require("system/event");sc_require("system/cursor");sc_require("system/responder");sc_require("system/theme");sc_require("system/string");sc_require("views/view/base");SC.CONTEXT_MENU_ENABLED=YES;SC.TABBING_ONLY_INSIDE_DOCUMENT=NO;SC.FROM_THEME="__FROM_THEME__";SC.EMPTY_CHILD_VIEWS_ARRAY=[];SC.EMPTY_CHILD_VIEWS_ARRAY.needsClone=YES;SC.CoreView.reopen({concatenatedProperties:["outlets","displayProperties","classNames","renderMixin","didCreateLayerMixin","willDestroyLayerMixin","classNameBindings","attributeBindings"],ariaRole:null,ariaHidden:null,pane:function(){var a=this;while(a&&!a.isPane){a=a.get("parentView")}return a}.property("parentView").cacheable(),page:null,parentView:null,isVisible:YES,isVisibleBindingDefault:SC.Binding.bool(),isVisibleInWindow:YES,childViews:SC.EMPTY_CHILD_VIEWS_ARRAY,layer:function(a,d){if(d!==undefined){this._view_layer=d}else{d=this._view_layer;if(!d){var b=this.get("parentView");if(b){b=b.get("layer")}this._view_layer=d=this.findLayerInParentLayer(b)}}return d}.property("isVisibleInWindow").cacheable(),$:function(b){var a=this.get("layer");if(!a){return SC.$()}else{if(b===undefined){return SC.$(a)}else{return SC.$(b,a)}}},containerLayer:function(){return this.get("layer")}.property("layer").cacheable(),layerId:function(a,b){if(b){this._layerId=b}if(this._layerId){return this._layerId}return SC.guidFor(this)}.property().cacheable(),findLayerInParentLayer:function(a){var b="#"+this.get("layerId");return jQuery(b,a)[0]||jQuery(b)[0]},isDescendantOf:function(a){var b=this.get("parentView");if(this===a){return YES}else{if(b){return b.isDescendantOf(a)}else{return NO}}},displayDidChange:function(){this.set("layerNeedsUpdate",YES);return this},_sc_isVisibleDidChange:function(){this.displayDidChange()}.observes("isVisible"),layerNeedsUpdate:NO,_view_layerNeedsUpdateDidChange:function(){if(this.get("layerNeedsUpdate")){this.invokeOnce(this.updateLayerIfNeeded)}}.observes("layerNeedsUpdate"),updateLayerIfNeeded:function(b){var d=this.get("layerNeedsUpdate"),a=d&&(b||this.get("isVisibleInWindow"));if(a){if(this.get("layer")){this.beginPropertyChanges();this.set("layerNeedsUpdate",NO);this.updateLayer();this.endPropertyChanges()}}return this},updateLayer:function(g){var d,b,a,e;var f=g||this.renderContext(this.get("layer"));this._renderLayerSettings(f,NO);e=!this.update;if(e){this.render(f,NO)}else{this.update(f.$())}if(d=this.renderMixin){a=d.length;for(b=0;b<a;++b){d[b].call(this,f,NO)}}f.update();if(f._innerHTMLReplaced){var h=this.get("pane");if(h&&h.get("isPaneAttached")){this._notifyDidAppendToDocument()}}if(this.useStaticLayout){this.viewDidResize()}if(this.didUpdateLayer){this.didUpdateLayer()}if(this.designer&&this.designer.viewDidUpdateLayer){this.designer.viewDidUpdateLayer()}return this},parentViewDidResize:function(){if(!this.get("hasLayout")){this.notifyPropertyChange("frame")}this.viewDidResize()},viewDidResize:function(){},renderContext:function(a){return SC.RenderContext(a)},createLayer:function(){if(this.get("layer")){return this}var a=this.renderContext(this.get("tagName"));this.renderToContext(a);this.set("layer",a.element());this._notifyDidCreateLayer();return this},_notifyDidCreateLayer:function(){this.notifyPropertyChange("layer");if(this.get("useStaticLayout")){this.viewDidResize()}if(this.didCreateLayer){this.didCreateLayer()}var d=this.didCreateLayerMixin,b,a,e=this.get("childViews"),f;if(d){b=d.length;for(a=0;a<b;++a){d[a].call(this)}}b=e.length;for(a=0;a<b;++a){f=e[a];if(!f){continue}f.notifyPropertyChange("layer");if(this.get("useStaticLayout")){if(!f.get("isFixedLayout")){f.viewDidResize()}}f._notifyDidCreateLayer()}},destroyLayer:function(){var a=this.get("layer");if(a){this._notifyWillDestroyLayer();if(a.parentNode){a.parentNode.removeChild(a)}a=null}return this},replaceLayer:function(){this.destroyLayer();this.set("layerLocationNeedsUpdate",YES);this.invokeOnce(this.updateLayerLocationIfNeeded)},parentViewDidChange:function(){this.parentViewDidResize();this.updateLayerLocation()},layerLocationNeedsUpdate:NO,updateLayerLocationIfNeeded:function(a){if(this.get("layerLocationNeedsUpdate")){this.updateLayerLocation()}return this},updateLayerLocation:function(){var f=this.get("layer"),e=this.get("parentView"),b=e?e.get("containerLayer"):null;if(f&&f.parentNode&&f.parentNode!==b){f.parentNode.removeChild(f)}if(!e){if(f&&f.parentNode){f.parentNode.removeChild(f)}}else{if(!b){if(f){if(f.parentNode){f.parentNode.removeChild(f)}this.destroyLayer()}}else{if(!f){this.createLayer();f=this.get("layer");if(!f){return}}var g=e.get("childViews"),d=g.objectAt(g.indexOf(this)+1),a=(d)?d.get("layer"):null;if(d&&(!a||a.parentNode!==b)){d.updateLayerLocationIfNeeded();a=d.get("layer")||null}if((f.parentNode!==b)||(f.nextSibling!==a)){b.insertBefore(f,a)}}}b=e=f=a=null;this.set("layerLocationNeedsUpdate",NO);return this},_notifyWillDestroyLayer:function(){if(this.willDestroyLayer){this.willDestroyLayer()}var d=this.willDestroyLayerMixin,b,a,e=this.get("childViews");if(d){b=d.length;for(a=0;a<b;++a){d[a].call(this)}}b=e.length;for(a=0;a<b;++a){e[a]._notifyWillDestroyLayer()}this.set("layer",null)},renderToContext:function(f,g){var e,d,b,a;this.beginPropertyChanges();this.set("layerNeedsUpdate",NO);if(SC.none(g)){g=YES}this._renderLayerSettings(f,g);e=!this.update;if(e){this.render(f,g)}else{if(g){this.render(f)}else{this.update(f.$())}}if(g&&!this._didRenderChildViews){this.renderChildViews(f,g)}this._didRenderChildViews=NO;if(d=this.renderMixin){a=d.length;for(b=0;b<a;++b){d[b].call(this,f,g)}}this.endPropertyChanges()},_renderLayerSettings:function(a,b){a.resetClassNames();a.resetStyles();this.applyAttributesToContext(a)},applyAttributesToContext:function(a){if(!this.get("layer")){this._applyClassNameBindings();this._applyAttributeBindings(a)}a.addClass(this.get("classNames"));if(this.get("isTextSelectable")){a.addClass("allow-select")}if(!this.get("isVisible")){a.addClass("sc-hidden")}if(this.get("isFirstResponder")){a.addClass("focus")}a.id(this.get("layerId"));a.attr("role",this.get("ariaRole"));var b=this.get("ariaHidden");if(b!==null){if(b===NO){a.removeAttr("aria-hidden")}else{a.attr("aria-hidden",b)}}},_applyClassNameBindings:function(){var a=this.get("classNameBindings"),b=this.get("classNames"),d;if(!a){return}a.forEach(function(g){var f;var e=function(){var j=this._classStringForProperty(g);var h=this.$();if(f){h.removeClass(f);b.removeObject(f)}if(j){h.addClass(j);b.push(j);f=j}else{f=null}};this.addObserver(g.split(":")[0],this,e);d=this._classStringForProperty(g);if(d){b.push(d);f=d}},this)},_applyAttributeBindings:function(a){var f=this.get("attributeBindings"),d,e,b;if(!f){return}f.forEach(function(h){var g=function(){e=this.$();var j=e.attr(h);d=this.get(h);b=typeof d;if((b==="string"||b==="number")&&d!==j){e.attr(h,d)}else{if(d&&b==="boolean"){e.attr(h,h)}else{if(d===NO){e.removeAttr(h)}}}};this.addObserver(h,this,g);d=this.get(h);b=typeof d;if(b==="string"||b==="number"){a.attr(h,d)}else{if(d&&b==="boolean"){a.attr(h,h)}}},this)},_classStringForProperty:function(d){var a=d.split(":"),b=a[1];d=a[0];var e=SC.getPath(this,d);if(e===YES){if(b){return b}return SC.String.dasherize(d.split(".").get("lastObject"))}else{if(e!==NO&&e!==undefined&&e!==null){return e}else{return null}}},prepareContext:function(a,b){if(b!==false){b=YES}if(b){this.renderToContext(a)}else{this.updateLayer(a)}},renderChildViews:function(f,g){var e=this.get("childViews"),b=e.length,a,d;for(a=0;a<b;++a){d=e[a];if(!d){continue}f=f.begin(d.get("tagName"));d.renderToContext(f,g);f=f.end()}this._didRenderChildViews=YES;return f},render:function(){},_notifyDidAppendToDocument:function(){if(!this.get("hasLayout")){this.notifyPropertyChange("frame")}if(this.didAppendToDocument){this.didAppendToDocument()}var d=0,e,a,b=this.get("childViews");for(d=0,a=b.length;d<a;d++){e=b[d];if(e._notifyDidAppendToDocument){e._notifyDidAppendToDocument()}}},childViewsObserver:function(){var d=this.get("childViews"),b,a,e;for(b=0,a=d.length;b<a;b++){e=d[b];if(e._notifyDidAppendToDocument){e._notifyDidAppendToDocument()}}}.observes("childViews"),attributeBindings:null,tagName:"div",classNames:[],classNameBindings:null,toolTip:null,displayToolTip:function(){var a=this.get("toolTip");return(a&&this.get("localize"))?SC.String.loc(a):(a||"")}.property("toolTip","localize").cacheable(),isTextSelectable:NO,displayProperties:["ariaHidden"],nextResponder:function(){return this.get("parentView")}.property("parentView").cacheable(),acceptsFirstResponder:NO,init:function(){var f=this.get("parentView"),h,b,e,g;arguments.callee.base.apply(this,arguments);SC.View.views[this.get("layerId")]=this;this.classNames=this.get("classNames").slice();this.childViews=this.get("childViews").slice();this.createChildViews();g=this.get("displayProperties");for(var d=0,a=g.length;d<a;d++){this.addObserver(g[d],this,this.displayDidChange)}},awake:function(){arguments.callee.base.apply(this,arguments);var d=this.get("childViews"),b=d.length,a;for(a=0;a<b;++a){if(!d[a]){continue}d[a].awake()}},frame:function(){return this.computeFrameWithParentFrame(null)}.property("useStaticLayout").cacheable(),computeFrameWithParentFrame:function(){var a,b=this.get("parentView"),d;if(a=this.get("layer")){d=SC.offset(a);if(b){d=b.convertFrameFromView(d,null)}d.width=a.offsetWidth;d.height=a.offsetHeight;return d}if(this.get("hasLayout")){return null}else{return{x:0,y:0,width:0,height:0}}},clippingFrame:function(){var e=this.get("frame"),a=e,b,d;if(!e){return null}b=this.get("parentView");if(b){d=b.get("clippingFrame");if(!d){return{x:0,y:0,width:e.width,height:e.height}}a=SC.intersectRects(d,e)}a.x-=e.x;a.y-=e.y;return a}.property("parentView","frame").cacheable(),_sc_view_clippingFrameDidChange:function(){var e=this.get("childViews"),b=e.length,a,d;for(a=0;a<b;++a){d=e[a];d.notifyPropertyChange("clippingFrame");d._sc_view_clippingFrameDidChange()}},removeChild:function(b){b.set("parentView",null);var d=this.get("childViews"),a=d.indexOf(b);if(a>=0){d.removeAt(a)}return this},removeAllChildren:function(){var b=this.get("childViews"),a;while(a=b.objectAt(b.get("length")-1)){this.removeChild(a)}return this},removeFromParent:function(){var a=this.get("parentView");if(a){a.removeChild(this)}return this},destroy:function(){if(this.get("isDestroyed")){return this}this._destroy();return arguments.callee.base.apply(this,arguments)},_destroy:function(){this.destroyLayer();var d=this.get("childViews"),b=d.length,a;if(b){d=d.slice();for(a=0;a<b;++a){d[a].destroy()}}delete SC.View.views[this.get("layerId")];delete this._CQ;delete this.page;if(this.get("parentView")){this.removeFromParent()}this.set("owner",null);return this},createChildViews:function(){var g=this.get("childViews"),b=g.length,a,f,e,d;this.beginPropertyChanges();for(a=0;a<b;++a){if(f=(d=g[a])){if(typeof f===SC.T_STRING){d=this[f]}else{f=null}if(!d){SC.Logger.error("No view with name "+f+" has been found in "+this.toString());continue}d=this.createChildView(d);if(f){this[f]=d}}g[a]=d}this.endPropertyChanges();return this},createChildView:function(a,b){if(!a.isClass){b=a}else{if(!b){b={}}else{b=SC.clone(b)}}b.owner=b.parentView=this;if(a.isClass&&a.prototype.hasVisibility){b.isVisibleInWindow=this.get("isVisibleInWindow")}if(!b.page){b.page=this.page}if(a.isClass){a=a.create(b)}return a},isView:YES,selectStart:function(a){return this.get("isTextSelectable")},contextMenu:function(a){if(this.get("isContextMenuEnabled")){a.allowDefault();return YES}}});SC.CoreView.mixin({isViewClass:YES,design:function(){if(this.isDesign){return this}var a=this.extend.apply(this,arguments);a.isDesign=YES;if(SC.ViewDesigner){SC.ViewDesigner.didLoadDesign(a,this,SC.A(arguments))}return a},extend:function(){var a=arguments[arguments.length-1];if(a&&!SC.none(a.theme)){a.themeName=a.theme;delete a.theme}return SC.Object.extend.apply(this,arguments)},layout:function(a){this.prototype.layout=a;return this},classNames:function(a){a=(this.prototype.classNames||[]).concat(a);this.prototype.classNames=a;return this},tagName:function(a){this.prototype.tagName=a;return this},childView:function(a){var b=this.prototype.childViews||[];if(b===this.superclass.prototype.childViews){b=b.slice()}b.push(a);this.prototype.childViews=b;return this},bind:function(b,e){var d=this.prototype,a=this.superclass.prototype;var f=d._bindings;if(!f||f===a._bindings){f=d._bindings=(f||[]).slice()}b=b+"Binding";d[b]=e;f.push(b);return this},prop:function(a,b){this.prototype[a]=b;return this},localization:function(b,a){if(a){b.rootElement=SC.$(a)[0]}return b},viewFor:function(e,d){var b=SC.$A(arguments);if(SC.none(e)){b.shift()}else{b[0]={rootElement:SC.$(e)[0]}}var a=this.create.apply(this,arguments);b=b[0]=null;return a},create:function(){var b=arguments[arguments.length-1];if(b&&b.theme){b.themeName=b.theme;delete b.theme}var d=this,a=new d(arguments);if(SC.ViewDesigner){SC.ViewDesigner.didCreateView(a,SC.$A(arguments))}return a},loc:function(f){var b=f.childViews;delete f.childViews;this.applyLocalizedAttributes(f);if(SC.ViewDesigner){SC.ViewDesigner.didLoadLocalization(this,SC.$A(arguments))}var e=this.prototype.childViews,a=e.length,d;while(--a>=0){d=e[a];f=b[a];if(f&&d&&typeof d===SC.T_STRING){SC.String.loc(d,f)}}return this},applyLocalizedAttributes:function(a){SC.mixin(this.prototype,a)},views:{}});SC.outlet=function(b,a){return function(d){return(this[d]=SC.objectForPropertyPath(b,(a!==undefined)?a:this))}.property()};SC.CoreView.unload=function(){var a=SC.View.views;if(a){for(var b in a){if(!a.hasOwnProperty(b)){continue}delete a[b]}}};SC.View=SC.CoreView.extend({classNames:["sc-view"],displayProperties:["isFirstResponder"]});if(SC.browser.isIE){SC.Event.add(window,"unload",SC.View,SC.View.unload)}sc_require("views/view");sc_require("views/view/layout_style");SC.ANIMATABLE_PROPERTIES={top:YES,left:YES,bottom:YES,right:YES,width:YES,height:YES,centerX:YES,centerY:YES,opacity:YES,scale:YES,rotate:YES,rotateX:YES,rotateY:YES,rotateZ:YES};SC.View.reopen({didCreateLayerMixin:function(){if(SC.platform.supportsCSSTransitions){this.resetAnimation()}},animate:function(q,m,e,p){var g,s;if(typeof q===SC.T_STRING){g={};g[q]=m;s=e}else{g=q;s=m;p=e}var d=SC.typeOf(s);if(d===SC.T_NUMBER){s={duration:s}}else{if(d!==SC.T_HASH){throw"Must provide options hash or duration!"}}if(p){s.callback=p}else{if(s.callback){p=s.callback}}if(s.duration===0){var k=this.adjust(g);if(p){this.layoutStyleCalculator.invokeOnceLater("runAnimationCallback",1,p,null,NO)}return k}var a=s.timing;if(a){if(typeof a!==SC.T_STRING){s.timing="cubic-bezier("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}}else{s.timing="linear"}var h=SC.clone(this.get("layout")),j=NO,l,o,b,f,n;if(!h.animate){h.animate={}}for(n in g){if(!g.hasOwnProperty(n)||!SC.ANIMATABLE_PROPERTIES[n]){continue}l=g[n];o=h[n];f=h.animate[n];if(SC.none(l)){throw"Can only animate to an actual value!"}if(o!==l||(f&&f.duration!==s.duration)){j=YES;h.animate[n]=s;h[n]=l}}if(j){this.set("layout",h)}else{if(p){this.layoutStyleCalculator.invokeOnceLater("runAnimationCallback",1,p,null,NO)}}return this},resetAnimation:function(){var d=this.get("layout"),f=d.animate,e=NO,b;if(!f){return}var a;for(b in f){e=YES;delete f[b]}if(e){this.set("layout",d);this.notifyPropertyChange("layout")}return this},transitionDidEnd:function(a){this.get("layoutStyleCalculator").transitionDidEnd(a)}});sc_require("ext/string");sc_require("views/view");sc_require("views/view/animation");SC.CSS_TRANSFORM_MAP={rotate:function(a){return null},rotateX:function(a){if(SC.typeOf(a)===SC.T_NUMBER){a+="deg"}return"rotateX("+a+")"},rotateY:function(a){if(SC.typeOf(a)===SC.T_NUMBER){a+="deg"}return"rotateY("+a+")"},rotateZ:function(a){if(SC.typeOf(a)===SC.T_NUMBER){a+="deg"}return"rotateZ("+a+")"},scale:function(a){if(SC.typeOf(a)===SC.T_ARRAY){a=a.join(", ")}return"scale("+a+")"}};SC.View.reopen({layoutStyleCalculator:null,layoutStyle:function(){var a={layout:this.get("layout"),turbo:this.get("hasAcceleratedLayer"),staticLayout:this.get("useStaticLayout")};var b=this.get("layoutStyleCalculator");b.set(a);return b.calculate()}.property().cacheable()});SC.View.LayoutStyleCalculator=SC.Object.extend({_layoutDidUpdate:function(){var h=this.get("layout");if(!h){return}this.dims=SC._VIEW_DEFAULT_DIMS;this.loc=this.dims.length;var p=(this.right=h.right);this.hasRight=(p!=null);var d=(this.left=h.left);this.hasLeft=(d!=null);var l=(this.top=h.top);this.hasTop=(l!=null);var a=(this.bottom=h.bottom);this.hasBottom=(a!=null);var b=(this.width=h.width);this.hasWidth=(b!=null);var q=(this.height=h.height);this.hasHeight=(q!=null);this.minWidth=((h.minWidth===undefined)?null:h.minWidth);var o=(this.maxWidth=(h.maxWidth===undefined)?null:h.maxWidth);this.hasMaxWidth=(o!=null);this.minHeight=(h.minHeight===undefined)?null:h.minHeight;var n=(this.maxHeight=(h.maxHeight===undefined)?null:h.maxHeight);this.hasMaxHeight=(n!=null);var g=(this.centerX=h.centerX);this.hasCenterX=(g!=null);var f=(this.centerY=h.centerY);this.hasCenterY=(f!=null);var e=(this.borderTop=((h.borderTop!==undefined)?h.borderTop:h.border)||0);var m=(this.borderRight=((h.borderRight!==undefined)?h.borderRight:h.border)||0);var k=(this.borderBottom=((h.borderBottom!==undefined)?h.borderBottom:h.border)||0);var j=(this.borderLeft=((h.borderLeft!==undefined)?h.borderLeft:h.border)||0);this.zIndex=(h.zIndex!=null)?h.zIndex.toString():null;this.opacity=(h.opacity!=null)?h.opacity.toString():null;this.backgroundPosition=(h.backgroundPosition!=null)?h.backgroundPosition:null;this.ret={marginTop:null,marginLeft:null}}.observes("layout"),_invalidAutoValue:function(b){var a=SC.Error.desc("%@.layout() you cannot use %@:auto if staticLayout is disabled".fmt(this.get("view"),b),"%@".fmt(this.get("view")),-1);SC.Logger.error(a.toString());throw a},_handleMistakes:function(){var d=this.get("layout");if(!this.staticLayout){if(this.width===SC.LAYOUT_AUTO){this._invalidAutoValue("width")}if(this.height===SC.LAYOUT_AUTO){this._invalidAutoValue("height")}}if(SC.platform.supportsCSSTransforms){var e=d.animate,a,b;if(e){for(b in e){if(SC.CSS_TRANSFORM_MAP[b]){if(this._pendingAnimations&&this._pendingAnimations["-"+SC.platform.cssPrefix+"-transform"]){throw"Animations of transforms must be executed simultaneously!"}if(a&&e[b].duration!==a){SC.Logger.warn("Can't animate transforms with different durations! Using first duration specified.");e[b].duration=a}a=e[b].duration}}}}},_calculatePosition:function(p){var h=null,a=this.get("turbo"),u=this.ret;var e,m,l,d,k,o,b,g,f,n,t,j,q,s;if(p==="x"){e="left";m="right";l="width";d="maxWidth";k="marginLeft";n="borderLeft";j="borderRight";o=this.hasLeft;b=this.hasRight;g=this.hasWidth;f=this.hasMaxWidth}else{e="top";m="bottom";l="height";d="maxHeight";k="marginTop";n="borderTop";j="borderBottom";o=this.hasTop;b=this.hasBottom;g=this.hasHeight;f=this.hasMaxHeight}u[e]=this._cssNumber(this[e]);u[m]=this._cssNumber(this[m]);t=this._cssNumber(this[n]);q=this._cssNumber(this[j]);u[n+"Width"]=t||null;u[j+"Width"]=q||null;s=this[l];if(s>=1){s-=(t+q)}u[l]=this._cssNumber(s);if(o){if(a){h=u[e];u[e]=0}if(b&&g){u[m]=null}}else{if(!b||(b&&!g&&!f)){u[e]=0}}if(!g&&!b){u[m]=0}return h},_calculateCenter:function(p){var k=this.ret,t,a,d,q,g,h,n,o,f;if(p==="x"){t="width";a="centerX";d="left";q="right";g="marginLeft";h="borderLeft";o="borderRight"}else{t="height";a="centerY";d="top";q="bottom";g="marginTop";h="borderTop";o="borderBottom"}k[d]="50%";n=this._cssNumber(this[h]);f=this._cssNumber(this[o]);k[h+"Width"]=n||null;k[o+"Width"]=f||null;var m=this[t],l=this[a],b=this[d];var j=SC.isPercentage(m),e=SC.isPercentage(l,YES);if(m>1){m-=(n+f)}if((j&&e)||(!j&&!e)){var s=l-m/2;k[g]=(j)?Math.floor(s*100)+"%":Math.floor(s)}else{SC.Logger.warn("You have to set "+t+" and "+a+" using both percentages or pixels");k[g]="50%"}k[t]=this._cssNumber(m)||0;k[q]=null},_calculateTransforms:function(f,j){if(SC.platform.supportsCSSTransforms){var h=this.get("layout");var b=SC.platform.domCSSPrefix+"Transform";var e=[];if(this.turbo){e.push("translateX("+(f||0)+"px)","translateY("+(j||0)+"px)");if(SC.platform.supportsCSS3DTransforms){e.push("translateZ(0px)")}}var g=SC.CSS_TRANSFORM_MAP;for(var a in g){var d=h[a];if(d!=null){e.push(g[a](d))}}this.ret[b]=e.length>0?e.join(" "):null}},_calculateAnimations:function(f,d){var e=this.layout,j=e.animate,h;if(!j){return}if(this.getPath("view.isAnimatable")){return}var g=[],b;this._animatedTransforms=[];if(!this._pendingAnimations){this._pendingAnimations={}}var k="-"+SC.platform.cssPrefix+"-transform";if(SC.platform.supportsCSSTransitions){for(h in j){b=j[h];var l=SC.CSS_TRANSFORM_MAP[h];var a=(h==="top"&&d!=null)||(h==="left"&&f!=null);if(SC.platform.supportsCSSTransforms&&(a||l)){this._animatedTransforms.push(h);h=k}b.css=h+" "+b.duration+"s "+b.timing;if(!this._pendingAnimations[h]){this._pendingAnimations[h]=b;g.push(b.css)}}this.ret[SC.platform.domCSSPrefix+"Transition"]=g.join(", ")}else{for(h in j){this._pendingAnimations[h]=j[h]}}delete e.animate},_cssNumber:function(a){if(a==null){return null}else{if(a===SC.LAYOUT_AUTO){return SC.LAYOUT_AUTO}else{if(SC.isPercentage(a)){return(a*100)+"%"}else{return Math.floor(a)}}}},calculate:function(){var e=this.get("layout"),b=null,n=this.get("staticLayout"),d=null,f=null,a=this.get("turbo"),h=this.ret,l=this.dims,g=this.loc,j=this.get("view"),m,k;this._handleMistakes(e);if(n&&e===SC.View.prototype.layout){return{}}if(this.hasLeft||this.hasRight||!this.hasCenterX){f=this._calculatePosition("x")}else{this._calculateCenter("x")}if(this.hasTop||this.hasBottom||!this.hasCenterY){d=this._calculatePosition("y")}else{this._calculateCenter("y")}h.minWidth=this.minWidth;h.maxWidth=this.maxWidth;h.minHeight=this.minHeight;h.maxHeight=this.maxHeight;h.zIndex=this.zIndex;h.opacity=this.opacity;h.backgroundPosition=this.backgroundPosition;this._calculateTransforms(f,d);this._calculateAnimations(f,d);for(m in h){k=h[m];if(typeof k===SC.T_NUMBER){h[m]=(k+"px")}}return h},willRenderAnimations:function(){if(SC.platform.supportsCSSTransitions){var j=this.get("view"),g=j.get("layer"),a=g?g.style:null,b=j.get("layoutStyle"),n=this._activeAnimations,d,f=this._pendingAnimations,e,p=this._animatedTransforms,h=p?p.length:0,m,q=[],o,l,k;if(f){if(!n){n={}}for(m in f){if(!f.hasOwnProperty(m)){continue}e=f[m];d=n[m];k=NO;if(b[m]!==(a?a[m]:null)){k=YES}if(d&&(d.duration!==e.duration||d.timing!==e.timing)){k=YES}if(k&&d){if(o=d.callback){if(h>0){this.runAnimationCallback(o,null,YES);this._animatedTransforms=null}else{this.runAnimationCallback(o,null,YES)}}this.removeAnimationFromLayout(m,YES)}n[m]=e;q.push(m)}if(!this._groupedAnimations){this._groupedAnimations={}}this._groupedAnimations[m]=q;this._activeAnimations=n;this._pendingAnimations=null}}},didRenderAnimations:function(){if(!SC.platform.supportsCSSTransitions){var a,b;for(a in this._pendingAnimations){b=this._pendingAnimations[a].callback;if(b){this.invokeOnceLater("runAnimationCallback",1,b,null,NO)}this.removeAnimationFromLayout(a,NO,YES)}this._activeAnimations=this._pendingAnimations=null}},runAnimationCallback:function(e,b,d){var a=this.get("view");if(e){if(SC.typeOf(e)!==SC.T_HASH){e={action:e}}e.source=a;if(!e.target){e.target=this}}SC.View.runCallback(e,{event:b,view:a,isCancelled:d})},transitionDidEnd:function(d){var f=d.originalEvent.propertyName,e,j,b;j=this._activeAnimations?this._activeAnimations[f]:null;if(j){if(j.callback){this.invokeOnceLater("runAnimationCallback",1,j.callback,d,NO)}this.removeAnimationFromLayout(f,YES);var h;e=this._groupedAnimations&&this._groupedAnimations[f];if(e){for(var g=0,a=e.length;g<a;g++){h=e[g];delete this._activeAnimations[h]}delete this._groupedAnimations[f]}}},removeAnimationFromLayout:function(d,j,b){if(j){var f=this.getPath("view.layer"),h=[],e;for(e in this._activeAnimations){if(e!==d){h.push(this._activeAnimations[e].css)}}if(f){f.style[SC.platform.domCSSPrefix+"Transition"]=h.join(", ")}}var g=this.getPath("view.layout"),a;if(d==="-"+SC.platform.cssPrefix+"-transform"&&this._animatedTransforms&&this._animatedTransforms.length>0){for(a=0;a<this._animatedTransforms.length;a++){delete g["animate"+SC.String.capitalize(this._animatedTransforms[a])]}this._animatedTransforms=null}delete g["animate"+SC.String.capitalize(d)]}});SC.CoreView.runCallback=function(h){var b=SC.$A(arguments).slice(1),a=SC.typeOf(h.action);if(a==SC.T_FUNCTION){h.action.apply(h.target,b)}else{if(a===SC.T_STRING){if(h.action.indexOf(".")>=0){var g=h.action.split(".");var e=g.pop();var f=SC.objectForPropertyPath(g,window);var d=f.get?f.get(e):f[e];if(d&&SC.typeOf(d)==SC.T_FUNCTION){d.apply(f,b)}else{throw"SC.runCallback could not find a function at %@".fmt(h.action)}}}}};SC.View.runCallback=SC.CoreView.runCallback;sc_require("views/view");sc_require("views/view/layout_style");SC.LAYOUT_HORIZONTAL="sc-layout-horizontal";SC.LAYOUT_VERTICAL="sc-layout-vertical";SC._VIEW_DEFAULT_DIMS=["marginTop","marginLeft"];SC.FULL_WIDTH={left:0,right:0};SC.FULL_HEIGHT={top:0,bottom:0};SC.ANCHOR_CENTER={centerX:0,centerY:0};SC.LAYOUT_AUTO="auto";SC.View.reopen({hasLayout:YES,concatenatedProperties:["layoutProperties"],backgroundColor:null,displayProperties:["backgroundColor"],useStaticLayout:NO,init:function(a){a();this.layoutStyleCalculator=SC.View.LayoutStyleCalculator.create({view:this});this._previousLayout=this.get("layout")}.enhance(),propertyDidChange:function(b,e,d){var a=false;if(typeof this.layout==="function"&&this._kvo_dependents){var f=this._kvo_dependents[b];if(f&&f.indexOf("layout")!=-1){a=true}}if(b==="layout"||a){this.layoutDidChange()}arguments.callee.base.apply(this,arguments)},adjust:function(a,e){var b=this.get("layout"),d=NO,g,f;if(a===undefined){return this}if(SC.typeOf(a)===SC.T_STRING){g=b[a];if(e===undefined||g==e){return this}b=SC.clone(b);if(e===null){delete b[a]}else{b[a]=e}d=YES}else{f=a;for(a in f){if(!f.hasOwnProperty(a)){continue}e=f[a];g=b[a];if(e===undefined||g==e){continue}if(!d){b=SC.clone(b)}if(e===null){delete b[a]}else{b[a]=e}d=YES}}if(d){this.set("layout",b)}return this},layout:{top:0,left:0,bottom:0,right:0},isFixedLayout:function(){return this.get("isFixedPosition")&&this.get("isFixedSize")}.property("isFixedPosition","isFixedSize").cacheable(),isFixedPosition:function(){var b=this.get("layout"),a;a=(((b.left!==undefined)&&(b.top!==undefined))&&((b.left!==SC.LAYOUT_AUTO)&&(b.top!==SC.LAYOUT_AUTO)));if(a){a=(!SC.isPercentage(b.top)&&!SC.isPercentage(b.left))}return a}.property("layout").cacheable(),isFixedSize:function(){var b=this.get("layout"),a;a=(((b.width!==undefined)&&(b.height!==undefined))&&((b.width!==SC.LAYOUT_AUTO)&&(b.height!==SC.LAYOUT_AUTO)));if(a){a=(!SC.isPercentage(b.width)&&!SC.isPercentage(b.height))}return a}.property("layout").cacheable(),convertFrameToView:function(k,e){var d=0,b=0,h=0,g=0,a=this,j;while(a){j=a.get("frame");d+=j.x;b+=j.y;a=a.get("layoutView")}if(e){a=e;while(a){j=a.get("frame");h+=j.x;g+=j.y;a=a.get("layoutView")}}d=k.x+d-h;b=k.y+b-g;return{x:d,y:b,width:k.width,height:k.height}},convertFrameFromView:function(k,e){var d=0,b=0,h=0,g=0,a=this,j;while(a&&(j=a.get("frame"))){d+=j.x;b+=j.y;a=a.get("parentView")}if(e){a=e;while(a){j=a.get("frame");h+=j.x;g+=j.y;a=a.get("parentView")}}d=k.x-d+h;b=k.y-b+g;return{x:d,y:b,width:k.width,height:k.height}},scrollToVisible:function(){var a=this.get("parentView");while(a&&!a.get("isScrollable")){a=a.get("parentView")}if(a){a.scrollToVisible();return a.scrollToVisible(this)}else{return NO}},_adjustForBorder:function(f,d){var g=((d.borderTop!==undefined)?d.borderTop:d.border)||0,e=((d.borderLeft!==undefined)?d.borderLeft:d.border)||0,b=((d.borderBottom!==undefined)?d.borderBottom:d.border)||0,a=((d.borderRight!==undefined)?d.borderRight:d.border)||0;f.x+=e;f.y+=g;f.width-=(e+a);f.height-=(g+b);return f},computeFrameWithParentFrame:function(o,h){var q,s=this.get("layout");if(this.get("useStaticLayout")){q=o();return q?this._adjustForBorder(q,s):null}else{q={}}var p,v,n=SC.LAYOUT_AUTO,m=this.get("parentView"),j,d,a=s.right,b=s.left,u=s.top,g=s.bottom,t=s.width,e=s.height,l=s.centerX,k=s.centerY;if(t===n){p=SC.Error.desc(("%@.layout() cannot use width:auto if staticLayout is disabled").fmt(this),"%@".fmt(this),-1);SC.Logger.error(p.toString());throw p}if(e===n){p=SC.Error.desc(("%@.layout() cannot use height:auto if staticLayout is disabled").fmt(this),"%@".fmt(this),-1);SC.Logger.error(p.toString());throw p}if(!h){h=this.computeParentDimensions(s)}j=h.height;d=h.width;if(!SC.none(b)){if(SC.isPercentage(b)){q.x=d*b}else{q.x=b}if(t!==undefined){if(t===n){q.width=n}else{if(SC.isPercentage(t)){q.width=d*t}else{q.width=t}}}else{q.width=d-q.x;if(a&&SC.isPercentage(a)){q.width=q.width-(a*d)}else{q.width=q.width-(a||0)}}}else{if(!SC.none(a)){if(SC.none(t)){if(SC.isPercentage(a)){q.width=d-(d*a)}else{q.width=d-a}q.x=0}else{if(t===n){q.width=n}else{if(SC.isPercentage(t)){q.width=d*t}else{q.width=(t||0)}}if(SC.isPercentage(t)){q.x=d-(a*d)-q.width}else{q.x=d-a-q.width}}}else{if(!SC.none(l)){if(t===n){q.width=n}else{if(SC.isPercentage(t)){q.width=t*d}else{q.width=(t||0)}}if(SC.isPercentage(l)){q.x=(d-q.width)/2+(l*d)}else{q.x=(d-q.width)/2+l}}else{q.x=0;if(SC.none(t)){q.width=d}else{if(t===n){q.width=n}if(SC.isPercentage(t)){q.width=t*d}else{q.width=(t||0)}}}}}if(!SC.none(u)){if(SC.isPercentage(u)){q.y=u*j}else{q.y=u}if(e!==undefined){if(e===n){q.height=n}else{if(SC.isPercentage(e)){q.height=e*j}else{q.height=e}}}else{if(g&&SC.isPercentage(g)){q.height=j-q.y-(g*j)}else{q.height=j-q.y-(g||0)}}}else{if(!SC.none(g)){if(SC.none(e)){if(SC.isPercentage(g)){q.height=j-(g*j)}else{q.height=j-g}q.y=0}else{if(e===n){q.height=n}if(e&&SC.isPercentage(e)){q.height=e*j}else{q.height=(e||0)}if(SC.isPercentage(g)){q.y=j-(g*j)-q.height}else{q.y=j-g-q.height}}}else{if(!SC.none(k)){if(e===n){q.height=n}if(e&&SC.isPercentage(e)){q.height=e*j}else{q.height=(e||0)}if(SC.isPercentage(k)){q.y=(j-q.height)/2+(k*j)}else{q.y=(j-q.height)/2+k}}else{q.y=0;if(SC.none(e)){q.height=j}else{if(e===n){q.height=n}if(SC.isPercentage(e)){q.height=e*j}else{q.height=e||0}}}}}q.x=Math.floor(q.x);q.y=Math.floor(q.y);if(q.height!==n){q.height=Math.floor(q.height)}if(q.width!==n){q.width=Math.floor(q.width)}if(q.height===n||q.width===n){v=this.get("layer");if(q.height===n){q.height=v?v.clientHeight:0}if(q.width===n){q.width=v?v.clientWidth:0}}q=this._adjustForBorder(q,s);if(m&&m.isScrollContainer){m=m.get("parentView");q.x-=m.get("horizontalScrollOffset");q.y-=m.get("verticalScrollOffset")}if(!SC.none(s.maxHeight)&&(q.height>s.maxHeight)){q.height=s.maxHeight}if(!SC.none(s.minHeight)&&(q.height<s.minHeight)){q.height=s.minHeight}if(!SC.none(s.maxWidth)&&(q.width>s.maxWidth)){q.width=s.maxWidth}if(!SC.none(s.minWidth)&&(q.width<s.minWidth)){q.width=s.minWidth}if(q.height<0){q.height=0}if(q.width<0){q.width=0}return q}.enhance(),computeParentDimensions:function(g){var b,d=this.get("parentView"),a=(d)?d.get("frame"):null;if(a){b={width:a.width,height:a.height}}else{var e=g||{};b={width:(e.left||0)+(e.width||0)+(e.right||0),height:(e.top||0)+(e.height||0)+(e.bottom||0)}}return b},borderFrame:function(){var e=this.get("layout"),g=this.get("frame"),a=e.border,f=((e.topBorder!==undefined)?e.topBorder:e.border)||0,d=((e.rightBorder!==undefined)?e.rightBorder:e.border)||0,h=((e.bottomBorder!==undefined)?e.bottomBorder:e.border)||0,b=((e.leftBorder!==undefined)?e.leftBorder:e.border)||0;return{x:g.x-b,y:g.y-f,width:g.width+b+d,height:g.height+f+h}}.property("frame").cacheable(),parentViewDidResize:function(){var b,a;a=this.useStaticLayout||!this.get("isFixedSize");b=!this.get("isFixedPosition");if(a){this.viewDidResize()}else{if(b){this._viewFrameDidChange()}}},viewDidResize:function(){this._viewFrameDidChange();var e=this.childViews,b,a,d;for(a=0;a<(b=e.length);++a){d=e[a];d.tryToPerform("parentViewDidResize")}},_viewFrameDidChange:function(){this.notifyPropertyChange("frame");this._sc_view_clippingFrameDidChange()},beginLiveResize:function(){if(this.willBeginLiveResize){this.willBeginLiveResize()}var e=this.get("childViews"),b=e.length,a,d;for(a=0;a<b;++a){d=e[a];if(d.beginLiveResize){d.beginLiveResize()}}return this},endLiveResize:function(){var e=this.get("childViews"),b=e.length,a,d;for(a=b-1;a>=0;--a){d=e[a];if(d.endLiveResize){d.endLiveResize()}}if(this.didEndLiveResize){this.didEndLiveResize()}return this},layoutView:function(){return this.get("parentView")}.property("parentView").cacheable(),layoutDidChange:function(){var h=this._previousLayout,g=this.get("layout"),k=YES,e,d,a,b;if(!SC.none(g.rotate)){if(SC.none(g.rotateX)){g.rotateX=g.rotate;SC.Logger.warn("Please set rotateX instead of rotate")}}if(!SC.none(g.rotateX)){g.rotate=g.rotateX}else{delete g.rotate}var j=g.animations;if(j){if(!SC.none(j.rotate)){if(SC.none(j.rotateX)){j.rotateX=j.rotate;SC.Logger.warn("Please animate rotateX instead of rotate")}}if(!SC.none(j.rotateX)){j.rotate=j.rotateX}else{delete j.rotate}}if(h&&h!==g){e=h.width;if(e!==undefined){a=g.width;if(e===a){d=h.height;if(h!==undefined){b=g.height;if(d===b){k=NO}}}}}this.beginPropertyChanges();this.notifyPropertyChange("hasAcceleratedLayer");this.notifyPropertyChange("layoutStyle");if(k){this.viewDidResize()}else{this._viewFrameDidChange()}this.endPropertyChanges();var f=this.get("layoutView");if(f){f.set("childViewsNeedLayout",YES);f.layoutDidChangeFor(this);if(f.get("childViewsNeedLayout")){f.invokeOnce(f.layoutChildViewsIfNeeded)}}this._previousLayout=g;return this},childViewsNeedLayout:NO,layoutDidChangeFor:function(b){var a=this._needLayoutViews;if(!a){a=this._needLayoutViews=SC.CoreSet.create()}a.add(b)},layoutChildViewsIfNeeded:function(a){if(!a){a=this.get("isVisibleInWindow")}if(a&&this.get("childViewsNeedLayout")){this.set("childViewsNeedLayout",NO);this.layoutChildViews()}return this},layoutChildViews:function(){var d=this._needLayoutViews,a=d?d.length:0,b;for(b=0;b<a;++b){d[b].updateLayout()}d.clear()},updateLayout:function(){var b=this.get("layer"),a;if(b){a=this.renderContext(b);this.renderLayout(a,NO);a.update();if(this.useStaticLayout){this.viewDidResize()}}b=null;return this},renderLayout:function(a,b){this.get("layoutStyleCalculator").willRenderAnimations();a.addStyle(this.get("layoutStyle"));this.get("layoutStyleCalculator").didRenderAnimations()},_renderLayerSettings:function(b,a,d){b(a,d);this.renderLayout(a,d)}.enhance(),applyAttributesToContext:function(b,a){b(a);if(this.get("useStaticLayout")){a.addClass("sc-static-layout")}if(this.get("backgroundColor")){a.css("backgroundColor",this.get("backgroundColor"))}}.enhance()});SC.View.mixin({convertLayoutToAnchoredLayout:function(g,o){var j={top:0,left:0,width:o.width,height:o.height},e=o.width,m=o.height,n=g.right,a=g.left,l=g.top,h=g.bottom,k=g.width,f=g.height,d=g.centerX,b=g.centerY;if(!SC.none(a)){if(SC.isPercentage(a)){j.left=a*e}else{j.left=a}if(k!==undefined){if(k===SC.LAYOUT_AUTO){j.width=SC.LAYOUT_AUTO}else{if(SC.isPercentage(k)){j.width=k*e}else{j.width=k}}}else{if(n&&SC.isPercentage(n)){j.width=e-j.left-(n*e)}else{j.width=e-j.left-(n||0)}}}else{if(!SC.none(n)){if(SC.none(k)){j.left=0;if(n&&SC.isPercentage(n)){j.width=e-(n*e)}else{j.width=e-(n||0)}}else{if(k===SC.LAYOUT_AUTO){j.width=SC.LAYOUT_AUTO}else{if(SC.isPercentage(k)){j.width=k*e}else{j.width=k}if(SC.isPercentage(n)){j.left=e-(j.width+n)}else{j.left=e-(j.width+n)}}}}else{if(!SC.none(d)){if(k&&SC.isPercentage(k)){j.width=(k*e)}else{j.width=(k||0)}j.left=((e-j.width)/2);if(SC.isPercentage(d)){j.left=j.left+d*e}else{j.left=j.left+d}}else{if(!SC.none(k)){j.left=0;if(k===SC.LAYOUT_AUTO){j.width=SC.LAYOUT_AUTO}else{if(SC.isPercentage(k)){j.width=k*e}else{j.width=k}}}else{j.left=0;j.width=0}}}}if(g.minWidth!==undefined){j.minWidth=g.minWidth}if(g.maxWidth!==undefined){j.maxWidth=g.maxWidth}if(!SC.none(l)){if(SC.isPercentage(l)){j.top=l*m}else{j.top=l}if(f!==undefined){if(f===SC.LAYOUT_AUTO){j.height=SC.LAYOUT_AUTO}else{if(SC.isPercentage(f)){j.height=f*m}else{j.height=f}}}else{j.height=m-j.top;if(h&&SC.isPercentage(h)){j.height=j.height-(h*m)}else{j.height=j.height-(h||0)}}}else{if(!SC.none(h)){if(SC.none(f)){j.top=0;if(h&&SC.isPercentage(h)){j.height=m-(h*m)}else{j.height=m-(h||0)}}else{if(f===SC.LAYOUT_AUTO){j.height=SC.LAYOUT_AUTO}else{if(SC.isPercentage(f)){j.height=f*m}else{j.height=f}j.top=m-j.height;if(SC.isPercentage(h)){j.top=j.top-(h*m)}else{j.top=j.top-h}}}}else{if(!SC.none(b)){if(f&&SC.isPercentage(f)){j.height=(f*m)}else{j.height=(f||0)}j.top=((m-j.height)/2);if(SC.isPercentage(b)){j.top=j.top+b*m}else{j.top=j.top+b}}else{if(!SC.none(f)){j.top=0;if(f===SC.LAYOUT_AUTO){j.height=SC.LAYOUT_AUTO}else{if(SC.isPercentage(f)){j.height=f*m}else{j.height=f}}}else{j.top=0;j.height=0}}}}if(j.top){j.top=Math.floor(j.top)}if(j.bottom){j.bottom=Math.floor(j.bottom)}if(j.left){j.left=Math.floor(j.left)}if(j.right){j.right=Math.floor(j.right)}if(j.width!==SC.LAYOUT_AUTO){j.width=Math.floor(j.width)}if(j.height!==SC.LAYOUT_AUTO){j.height=Math.floor(j.height)}if(g.minHeight!==undefined){j.minHeight=g.minHeight}if(g.maxHeight!==undefined){j.maxHeight=g.maxHeight}return j},convertLayoutToCustomLayout:function(b,a,d){}});sc_require("views/view");sc_require("views/view/layout");sc_require("views/view/layout_style");SC.View.reopen({wantsAcceleratedLayer:NO,hasAcceleratedLayer:function(){if(this.get("wantsAcceleratedLayer")&&SC.platform.supportsAcceleratedLayers){var d=this.get("layout"),e=d.animate,b=SC.LAYOUT_AUTO,a;if(e&&(e.top||e.left)){for(a in e){if(SC.CSS_TRANSFORM_MAP[a]&&((e.top&&e.top.duration!==e[a].duration)||(e.left&&e.left.duration!==e[a].duration))){return NO}}}return this.get("isFixedLayout")}return NO}.property("wantsAcceleratedLayer").cacheable()});sc_require("views/view");SC.View.reopen({cursor:function(a,d){var b;if(d){this._setCursor=d}if(this._setCursor!==undefined){return this._setCursor}b=this.get("parentView");if(this.get("shouldInheritCursor")&&b){return b.get("cursor")}return null}.property("parentView","shouldInheritCursor").cacheable(),applyAttributesToContext:function(b,a){var d=this.get("cursor");if(d){a.addClass(d.get("className"))}b(a)}.enhance(),shouldInheritCursor:YES});sc_require("views/view");SC.View.reopen({isEnabled:YES,isEnabledBindingDefault:SC.Binding.oneWay().bool(),isEnabledInPane:function(){var a=this.get("isEnabled"),b;if(a&&(b=this.get("parentView"))){a=b.get("isEnabledInPane")}return a}.property("parentView","isEnabled"),_sc_view_isEnabledDidChange:function(){if(!this.get("isEnabled")&&this.get("isFirstResponder")){this.resignFirstResponder()}}.observes("isEnabled"),applyAttributesToContext:function(b,a){var d=this.get("isEnabled");b(a);a.setClass("disabled",!d);a.attr("aria-disabled",!d?"true":null)}.enhance()});sc_require("views/view");SC.View.reopen({isKeyResponder:NO,willLoseKeyResponderTo:function(a){},willBecomeKeyResponderFrom:function(a){},didLoseKeyResponderTo:function(a){},didBecomeKeyResponderFrom:function(a){},interpretKeyEvents:function(b){var a=b.commandCodes(),e=a[0],f=a[1],h;if(!e&&!f){return null}if(e){var j=SC.MODIFIED_KEY_BINDINGS[e]||SC.BASE_KEY_BINDINGS[e.match(/[^_]+$/)[0]];if(j){var g=this,d=this.get("pane"),k=null;while(g&&!(k=g.tryToPerform(j,b))){g=(g===d)?null:g.get("nextResponder")}return k}}if(f&&this.respondsTo("insertText")){h=this.insertText(f,b);return h?(h===YES?this:h):null}return null},insertText:function(a){return NO},performKeyEquivalent:function(g,e){var f=NO,h=this.get("childViews"),b=h.length,a=-1,d;while(!f&&(++a<b)){d=h[a];f=d.tryToPerform("performKeyEquivalent",g,e)}return f},firstKeyView:null,_getFirstKeyView:function(){var a=this.get("firstKeyView");if(a){return a}var b=this.get("childViews");if(b){return b[0]}},lastKeyView:null,_getLastKeyView:function(){var e=this.get("lastKeyView");if(e){return e}var a,b=this.get("firstKeyView");if(b){while(a=b._getNextKeyView()){b=a}return b}else{var d=this.get("childViews");if(d){return d[d.length-1]}}},nextKeyView:undefined,_getNextKeyView:function(){var b=this.get("parentView"),a=this.get("nextKeyView");if(b&&b.get("lastKeyView")===this){return null}if(a!==undefined){return a}if(b){var d=b.get("childViews");return d[d.indexOf(this)+1]}},nextValidKeyView:function(){var b=this,a;while(a!==this){a=null;if(b.get("isVisibleInWindow")){a=b._getFirstKeyView()}if(!a){a=b._getNextKeyView()}if(!a){while(b=b.get("parentView")){if(a=b._getNextKeyView()){break}}}if(!a){if(!SC.TABBING_ONLY_INSIDE_DOCUMENT){break}else{a=this.get("pane")}}if(a.get("isVisibleInWindow")&&a.get("acceptsFirstResponder")){return a}b=a}return null}.property("nextKeyView"),previousKeyView:undefined,_getPreviousKeyView:function(){var b=this.get("parentView"),a=this.get("previousKeyView");if(b&&b.get("firstKeyView")===this){return null}if(a!==undefined){return a}if(b){var d=b.get("childViews");return d[d.indexOf(this)-1]}},previousValidKeyView:function(){var b=this,a;while(a!==this){if(b.get("parentView")){a=b._getPreviousKeyView()}else{if(!SC.TABBING_ONLY_INSIDE_DOCUMENT){break}else{a=b}}if(a){do{b=a;a=a._getLastKeyView()}while(a&&a.get("isVisibleInWindow"));if(!a){a=b}}else{a=b.get("parentView")}if(a.get("isVisibleInWindow")&&a.get("acceptsFirstResponder")){return a}b=a}return null}.property("previousKeyView")});sc_require("views/view");SC.View.reopen({_lastLayerId:null,layerIdDidChange:function(){var a=this.get("layer"),b=this.get("layerId"),d=this._lastLayerId;if(b!==d){if(d&&SC.View.views[d]===this){delete SC.View.views[d]}this._lastLayerId=b;SC.View.views[b]=this;if(a){a.id=b}}}.observes("layerId"),parentViewDidChange:function(){this.recomputeIsVisibleInWindow();this.resetBuildState();this.set("layerLocationNeedsUpdate",YES);this.invokeOnce(this.updateLayerLocationIfNeeded);this._invalidatePaneCacheForSelfAndAllChildViews();return this},_invalidatePaneCacheForSelfAndAllChildViews:function(){var e,d=this.get("childViews"),b=d.length,a;this.notifyPropertyChange("pane");for(a=0;a<b;++a){e=d[a];if(e._invalidatePaneCacheForSelfAndAllChildViews){e._invalidatePaneCacheForSelfAndAllChildViews()}}},insertBefore:function(b,e){b.beginPropertyChanges();if(b.get("parentView")){b.removeFromParent()}if(this.willAddChild){this.willAddChild(b,e)}if(b.willAddToParent){b.willAddToParent(this,e)}b.set("parentView",this);var a,d=this.get("childViews");if(d.needsClone){this.set(d=[])}a=(e)?d.indexOf(e):d.length;if(a<0){a=d.length}d.insertAt(a,b);if(b.parentViewDidChange){b.parentViewDidChange()}if(b.layoutDidChange){b.layoutDidChange()}b.endPropertyChanges();this.invokeLast(function(){var f=b.get("pane");if(f&&f.get("isPaneAttached")){b._notifyDidAppendToDocument()}});if(this.didAddChild){this.didAddChild(b,e)}if(b.didAddToParent){b.didAddToParent(this,e)}return this},removeChild:function(b,a){if(!a){return this}if(a.parentView!==this){throw"%@.removeChild(%@) must belong to parent".fmt(this,a)}if(a.willRemoveFromParent){a.willRemoveFromParent()}if(this.willRemoveChild){this.willRemoveChild(a)}b(a);if(a.parentViewDidChange){a.parentViewDidChange()}if(this.didRemoveChild){this.didRemoveChild(a)}if(a.didRemoveFromParent){a.didRemoveFromParent(this)}return this}.enhance(),replaceChild:function(a,b){a.beginPropertyChanges();b.beginPropertyChanges();this.beginPropertyChanges();this.insertBefore(a,b).removeChild(b);this.endPropertyChanges();b.endPropertyChanges();a.endPropertyChanges();return this},replaceAllChildren:function(d){var b=d.get("length"),a;this.beginPropertyChanges();this.destroyLayer().removeAllChildren();for(a=0;a<b;a++){this.appendChild(d.objectAt(a))}this.replaceLayer();this.endPropertyChanges();return this},appendChild:function(a){return this.insertBefore(a,null)},buildInChild:function(a){a.willBuildInToView(this);this.appendChild(a);a.buildInToView(this)},buildOutChild:function(a){a.buildOutFromView(this)},buildInDidFinishFor:function(a){},buildOutDidFinishFor:function(a){this.removeChild(a)},isBuildingIn:NO,isBuildingOut:NO,buildIn:function(){this.buildInDidFinish()},buildOut:function(){this.buildOutDidFinish()},resetBuild:function(){},buildOutDidCancel:function(){},buildInDidCancel:function(){},buildInDidFinish:function(){this.isBuildingIn=NO;this._buildingInTo.buildInDidFinishFor(this);this._buildingInTo=null},buildOutDidFinish:function(){this.isBuildingOut=NO;this._buildingOutFrom.buildOutDidFinishFor(this);this._buildingOutFrom=null},resetBuildState:function(){if(this.isBuildingIn){this.buildInDidCancel();this.isBuildingIn=NO}if(this.isBuildingOut){this.buildOutDidCancel();this.isBuildingOut=NO}this.buildingInTo=null;this.buildingOutFrom=null;this.resetBuild()},willBuildInToView:function(a){if(this.isBuildingOut){this.buildOutDidCancel()}},buildInToView:function(a){if(this.isBuildingIn){return}this._buildingInTo=a;this.isBuildingOut=NO;this.isBuildingIn=YES;this.buildIn()},buildOutFromView:function(a){if(this.isBuildingOut){return}if(this.isBuildingIn){this.buildInDidCancel()}this.isBuildingOut=YES;this.isBuildingIn=NO;this._buildingOutFrom=a;this.buildOut()}});sc_require("views/view");SC.View.reopen({init:function(a){a();this._lastTheme=this.get("theme")}.enhance(),themeName:null,baseThemeName:null,theme:function(){var b=this.get("baseTheme"),a=this.get("themeName");if(a){var d;if(b){d=b.find(a);if(d){return d}}d=SC.Theme.find(a);if(d){return d}return b.invisibleSubtheme(a)}return b}.property("baseTheme","themeName").cacheable(),_sc_view_themeDidChange:function(){if(this._lastTheme===this.get("theme")){return}this._lastTheme=this.get("theme");var d=this.childViews,b=d.length,a;for(a=0;a<b;a++){d[a].notifyPropertyChange("baseTheme")}if(this.get("layer")){this.replaceLayer()}}.observes("theme"),baseTheme:function(){var b;var a=this.get("baseThemeName");if(a){return SC.Theme.find(a)}else{b=this.get("parentView");var d=b&&b.get("theme");return d||SC.Theme.find(SC.defaultTheme)}}.property("baseThemeName","parentView").cacheable(),renderDelegate:function(d,e){if(e){this._setRenderDelegate=e}if(this._setRenderDelegate){return this._setRenderDelegate}var a=this.get("renderDelegateName"),b;if(a){b=this.get("theme")[a];if(!b){throw'%@: Unable to locate render delegate "%@" in theme.'.fmt(this,a)}return b}return null}.property("renderDelegateName","theme"),renderDelegateName:null,renderDelegateProxy:function(){return SC.View._RenderDelegateProxy.createForView(this)}.property("renderDelegate").cacheable(),render:function(b,d){var a=this.get("renderDelegate");if(a){if(d){a.render(this.get("renderDelegateProxy"),b)}else{a.update(this.get("renderDelegateProxy"),b.$())}}},applyAttributesToContext:function(g,f){var h=this.get("theme");var d=h.classNames,b,a=d.length;for(b=0;b<a;b++){f.addClass(d[b])}g(f);var e=this.get("renderDelegate");if(e&&e.className){f.addClass(e.className)}}.enhance(),invokeRenderDelegateMethod:function(d,b){var a=this.get("renderDelegate");if(!a){return undefined}if(SC.typeOf(a[d])!==SC.T_FUNCTION){return undefined}b=SC.$A(arguments);b.shift();b.unshift(this.get("renderDelegateProxy"));return a[d].apply(a,b)}});SC.View._RenderDelegateProxy={isViewRenderDelegateProxy:YES,createForView:function(d){var e=SC.beget(this);var g=d.get("displayProperties"),f={};for(var b=0,a=g.length;b<a;b++){f[g[b]]=YES}f.theme=YES;e._displayPropertiesLookup=f;e.renderState={};e._view=d;return e},get:function(b){if(this[b]!==undefined){return this[b]}var a="display"+b.capitalize();if(this._displayPropertiesLookup[a]){return this._view.get(a)}else{if(this._displayPropertiesLookup[b]){return this._view.get(b)}}return undefined},didChangeFor:function(e){var b=arguments.length,a;for(a=1;a<b;a++){var f=arguments[a],d="display"+f.capitalize();if(this._displayPropertiesLookup[d]){if(this._view.didChangeFor(e,d)){return YES}}else{if(this._displayPropertiesLookup[f]){if(this._view.didChangeFor(e,f)){return YES}}}}return NO}};SC.propertyFromRenderDelegate=function(a,b){return function(g,h){if(h!==undefined){this["_set_rd_"+g]=h}var e=this["_set_rd_"+g];if(e!==undefined){return e}var d=this.get("renderDelegate");if(d&&d.get){var f=this.get("renderDelegateProxy");e=d.getPropertyFor(f,a)}if(e!==undefined){return e}return b}.property("renderDelegate").cacheable()};sc_require("views/view");SC.View.reopen({acceptsMultitouch:NO,hasTouch:NO,touchBoundary:{left:25,right:25,top:25,bottom:25},_touchBoundaryFrame:function(){var b=this.get("touchBoundary"),a;a=this.get("parentView").convertFrameToView(this.get("frame"),null);a.x-=b.left;a.y-=b.top;a.width+=b.left+b.right;a.height+=b.top+b.bottom;return a}.property("touchBoundary","clippingFrame").cacheable(),touchIsInBoundary:function(a){return SC.pointInRect({x:a.pageX,y:a.pageY},this.get("_touchBoundaryFrame"))}});sc_require("views/view");SC.View.reopen({hasVisibility:YES,isVisibleInWindow:NO,isContextMenuEnabled:function(){return SC.CONTEXT_MENU_ENABLED}.property(),recomputeIsVisibleInWindow:function(e){var g=this.get("isVisibleInWindow"),j=this.get("isVisible"),f;if(j){if(e===undefined){f=this.get("parentView");e=f?f.get("isVisibleInWindow"):NO}j=j&&e}if(g!==j){this.set("isVisibleInWindow",j);var h=this.get("childViews"),b=h.length,a,d;for(a=0;a<b;a++){d=h[a];if(d.recomputeIsVisibleInWindow){d.recomputeIsVisibleInWindow(j)}}if(j){if(this.get("childViewsNeedLayout")){this.invokeOnce(this.layoutChildViewsIfNeeded)}}else{if(this.get("isFirstResponder")){this.resignFirstResponder()}}}this.updateLayerIfNeeded(YES);return this},_sc_isVisibleDidChange:function(){this.displayDidChange();this.recomputeIsVisibleInWindow()}.observes("isVisible")});sc_require("views/view");sc_require("views/view/acceleration");sc_require("views/view/cursor");sc_require("views/view/enabled");sc_require("views/view/keyboard");sc_require("views/view/layout");sc_require("views/view/manipulation");sc_require("views/view/theming");sc_require("views/view/touch");sc_require("views/view/visibility");sc_require("mixins/responder_context");SC.MIXED_STATE="__MIXED__";SC.Pane=SC.View.extend(SC.ResponderContext,{isPane:YES,page:null,rootResponder:null,sendEvent:function(d,a,e){var b;if(!e){e=this.get("firstResponder")}while(e){if(d==="touchStart"){if(a.touchResponder===e){e=null;break}if(!e.get("hasTouch")||e.get("acceptsMultitouch")){if(e.tryToPerform("touchStart",a)){break}}}else{if(d==="touchEnd"&&!e.get("acceptsMultitouch")){if(!e.get("hasTouch")){if(e.tryToPerform("touchEnd",a)){break}}}else{if(e.tryToPerform(d,a)){break}}}e=(e===this)?null:e.get("nextResponder")}if(!e&&(e=this.get("defaultResponder"))){if(typeof e===SC.T_STRING){e=SC.objectForPropertyPath(e)}if(!e){e=null}else{e=e.tryToPerform(d,a)?e:null}}else{if(!e&&!(e=this.get("defaultResponder"))){e=this.tryToPerform(d,a)?this:null}}return a.mouseHandler||e},nextResponder:function(){return null}.property().cacheable(),firstResponder:null,acceptsKeyPane:YES,isKeyPane:NO,becomeKeyPane:function(){if(this.get("isKeyPane")){return this}if(this.rootResponder){this.rootResponder.makeKeyPane(this)}return this},resignKeyPane:function(){if(!this.get("isKeyPane")){return this}if(this.rootResponder){this.rootResponder.makeKeyPane(null)}return this},makeFirstResponder:function(d,b,a){if(!b){b=this}var f=this.get("firstResponder"),e=this.get("isKeyPane");if(f===b){return this}if(SC.platform.touch&&b&&b.kindOf(SC.TextFieldView)&&!b.get("focused")){return this}if(e){if(f){f.tryToPerform("willLoseKeyResponderTo",b)}if(b){b.tryToPerform("willBecomeKeyResponderFrom",f)}}if(f){f.beginPropertyChanges();f.set("isKeyResponder",NO)}if(b){b.beginPropertyChanges();b.set("isKeyResponder",e)}d(b,a);if(f){f.endPropertyChanges()}if(b){b.endPropertyChanges()}if(e){if(b){b.tryToPerform("didBecomeKeyResponderFrom",f)}if(f){f.tryToPerform("didLoseKeyResponderTo",b)}}return this}.enhance(),willLoseKeyPaneTo:function(a){this._forwardKeyChange(this.get("isKeyPane"),"willLoseKeyResponderTo",a,NO);return this},willBecomeKeyPaneFrom:function(a){this._forwardKeyChange(!this.get("isKeyPane"),"willBecomeKeyResponderFrom",a,YES);return this},didBecomeKeyResponderFrom:function(a){},didLoseKeyPaneTo:function(b){var a=this.get("isKeyPane");this.set("isKeyPane",NO);this._forwardKeyChange(a,"didLoseKeyResponderTo",b);return this},didBecomeKeyPaneFrom:function(b){var a=this.get("isKeyPane");this.set("isKeyPane",YES);this._forwardKeyChange(!a,"didBecomeKeyResponderFrom",b,YES);return this},isMainPane:NO,focusFrom:function(a){},blurTo:function(a){},blurMainTo:function(a){this.set("isMainPane",NO)},focusMainFrom:function(a){this.set("isMainPane",YES)},append:function(){return this.appendTo(document.body)},remove:function(){if(!this.get("isVisibleInWindow")){return this}if(!this.get("isPaneAttached")){return this}var b=this.get("layer");if(b&&b.parentNode){b.parentNode.removeChild(b)}b=null;this._removeIntercept();this.resignKeyPane();var a=this.rootResponder;if(this.get("isMainPane")){a.makeMainPane(null)}a.panes.remove(this);this.rootResponder=null;this.set("isPaneAttached",NO);this.parentViewDidChange();return this},insert:function(b){var a=this.get("layer");if(!a){a=this.createLayer().get("layer")}b(a);if(!this.get("isPaneAttached")){this.paneDidAttach()}return this},appendTo:function(a){return this.insert(function(b){jQuery(a).append(b)})},paneDidAttach:function(){var a=(this.rootResponder=SC.RootResponder.responder);a.panes.add(this);this.set("isPaneAttached",YES);this.recomputeDependentProperties();this._notifyDidAppendToDocument();this._addIntercept();return this},recomputeDependentProperties:function(){},isPaneAttached:NO,wantsTouchIntercept:NO,hasTouchIntercept:function(){return this.get("wantsTouchIntercept")&&SC.platform.touch}.property("wantsTouchIntercept").cacheable(),zIndex:0,touchZ:99,_addIntercept:function(){if(this.get("hasTouchIntercept")){var b=document.createElement("div");var a=b.style;a.position="absolute";a.left="0px";a.top="0px";a.right="0px";a.bottom="0px";a.webkitTransform="translateZ(0px)";a.zIndex=this.get("zIndex")+this.get("touchZ");b.className="touch-intercept";b.id="touch-intercept-"+SC.guidFor(this);this._touchIntercept=b;document.body.appendChild(b)}},_removeIntercept:function(){if(this._touchIntercept){document.body.removeChild(this._touchIntercept);this._touchIntercept=null}},hideTouchIntercept:function(){if(this._touchIntercept){this._touchIntercept.style.display="none"}},showTouchIntercept:function(){if(this._touchIntercept){this._touchIntercept.style.display="block"}},recomputeIsVisibleInWindow:function(){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}var e=this.get("isVisibleInWindow"),g=this.get("isVisible")&&this.get("isPaneAttached");if(e!==g){this.set("isVisibleInWindow",g);var f=this.get("childViews"),b=f.length,a,d;for(a=0;a<b;a++){d=f[a];if(d.recomputeIsVisibleInWindow){d.recomputeIsVisibleInWindow(g)}}if(g){if(this.get("childViewsNeedLayout")){this.invokeOnce(this.layoutChildViewsIfNeeded)}}else{if(this.get("isKeyPane")){this.resignKeyPane()}}}this.updateLayerIfNeeded(YES);return this},updateLayerLocation:function(){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}return this},init:function(){if(this.hasTouchIntercept===YES){SC.Logger.warn("Do not set hasTouchIntercept directly. Use wantsTouchIntercept instead.");this.hasTouchIntercept=SC.platform.touch}var a=!!this.get("layer");arguments.callee.base.apply(this,arguments);if(a){this.paneDidAttach()}},classNames:["sc-pane"]});sc_require("panes/pane");SC.Pane.reopen({performKeyEquivalent:function(d,a){var b=arguments.callee.base.apply(this,arguments);if(!b){var e=this.get("defaultResponder");if(e){if(e.performKeyEquivalent){b=e.performKeyEquivalent(d,a)}if(!b&&e.tryToPerform){b=e.tryToPerform(d,a)}}}return b},keyDown:function(a){var b;if(a.keyCode===9&&!this.get("firstResponder")){if(a.shiftKey){b=this.get("previousValidKeyView")}else{b=this.get("nextValidKeyView")}if(b){this.makeFirstResponder(b);return YES}else{if(!SC.TABBING_ONLY_INSIDE_DOCUMENT){a.allowDefault()}}}return NO},_forwardKeyChange:function(e,b,h,g){var d,a,f;if(e&&(a=this.get("firstResponder"))){f=(h)?h.get("firstResponder"):null;d=this.get("firstResponder");if(d&&d[b]){d[b](f)}if((g!==undefined)&&a){a.set("isKeyResponder",g)}}}});sc_require("panes/pane");SC.Pane.reopen({currentWindowSize:null,computeParentDimensions:function(d){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}var e={x:0,y:0,width:1000,height:1000},b=this.get("layout");if(document&&document.body){e.width=document.body.clientWidth;e.height=document.body.clientHeight;if(SC.browser.name===SC.BROWSER.ie&&SC.browser.compareVersion(SC.browser.version,"7")===0){var a=SC.platform.get("scrollbarSize");if(document.body.scrollWidth>e.width){e.width-=a}if(document.body.scrollHeight>e.height){e.height-=a}}}if(b.minHeight||b.minWidth){if(b.minHeight){e.height=Math.max(e.height,b.minHeight)}if(b.minWidth){e.width=Math.max(e.width,b.minWidth)}}return e},frame:function(){if(this.get("designer")&&SC.suppressMain){return arguments.callee.base.apply(this,arguments)}return this.computeFrameWithParentFrame(null)}.property(),windowSizeDidChange:function(b,a){this.set("currentWindowSize",a);this.setBodyOverflowIfNeeded();this.parentViewDidResize();return this},setBodyOverflowIfNeeded:function(f){var e=this.get("layout"),b=this.get("currentWindowSize");if(!e||!b||!b.width||!b.height){return}var a=e.minWidth,d=e.minHeight;if(f===true||a||d){if((d&&b.height<d)||(a&&b.width<a)){SC.bodyOverflowArbitrator.requestVisible(this)}else{SC.bodyOverflowArbitrator.requestHidden(this)}}},paneLayoutDidChange:function(){this.invokeOnce(this.updateLayout);this.setBodyOverflowIfNeeded()}.observes("layout"),recomputeDependentProperties:function(a){this.set("currentWindowSize",this.rootResponder.computeWindowSize());a()}.enhance()});sc_require("panes/pane");SC.Pane.reopen({prependTo:function(a){return this.insert(function(b){jQuery(a).prepend(b)})},removeFromParent:function(){throw SC.Error.desc("SC.Pane cannot be removed from its parent, since it's the root. Did you mean remove()?")}});sc_require("panes/pane");SC.Pane.reopen({recomputeDependentProperties:function(a){this.recomputeIsVisibleInWindow();a()}.enhance()});SC.Application=SC.Responder.extend(SC.ResponderContext,{});SC.Color=SC.Object.extend(SC.Copyable,{original:null,a:1,r:0,g:0,b:0,hue:function(d,e){var f=SC.Color.clampToDeviceGamut,a=SC.Color.rgbToHsl(f(this.get("r")),f(this.get("g")),f(this.get("b"))),b;if(e!==undefined){a[0]=(e%360+360)%360;b=SC.Color.hslToRgb(a[0],a[1],a[2]);this.beginPropertyChanges();this.set("r",b[0]);this.set("g",b[1]);this.set("b",b[2]);this.endPropertyChanges()}return a[0]}.property("r","g","b").cacheable(),saturation:function(d,e){var f=SC.Color.clampToDeviceGamut,a=SC.Color.rgbToHsl(f(this.get("r")),f(this.get("g")),f(this.get("b"))),b;if(e!==undefined){a[1]=SC.Color.clamp(e,0,1);b=SC.Color.hslToRgb(a[0],a[1],a[2]);this.beginPropertyChanges();this.set("r",b[0]);this.set("g",b[1]);this.set("b",b[2]);this.endPropertyChanges()}return a[1]}.property("r","g","b").cacheable(),luminosity:function(d,e){var f=SC.Color.clampToDeviceGamut,a=SC.Color.rgbToHsl(f(this.get("r")),f(this.get("g")),f(this.get("b"))),b;if(e!==undefined){a[2]=SC.Color.clamp(e,0,1);b=SC.Color.hslToRgb(a[0],a[1],a[2]);this.beginPropertyChanges();this.set("r",b[0]);this.set("g",b[1]);this.set("b",b[2]);this.endPropertyChanges()}return a[2]}.property("r","g","b").cacheable(),isEqualTo:function(a){return this.get("r")===a.get("r")&&this.get("g")===a.get("g")&&this.get("b")===a.get("b")&&this.get("a")===a.get("a")},toArgb:function(){var a=SC.Color.clampToDeviceGamut;return"#"+[a(255*this.get("a")),a(this.get("r")),a(this.get("g")),a(this.get("b"))].map(function(b){b=b.toString(16);return b.length===1?"0"+b:b}).join("")},toHex:function(){var a=SC.Color.clampToDeviceGamut;return"#"+[a(this.get("r")),a(this.get("g")),a(this.get("b"))].map(function(b){b=b.toString(16);return b.length===1?"0"+b:b}).join("")},toRgb:function(){var a=SC.Color.clampToDeviceGamut;return"rgb("+a(this.get("r"))+","+a(this.get("g"))+","+a(this.get("b"))+")"},toRgba:function(){var a=SC.Color.clampToDeviceGamut;return"rgba("+a(this.get("r"))+","+a(this.get("g"))+","+a(this.get("b"))+","+this.get("a")+")"},toHsl:function(){var a=Math.round;return"hsl("+a(this.get("hue"))+","+a(this.get("saturation")*100)+"%,"+a(this.get("luminosity")*100)+"%)"},toHsla:function(){var a=Math.round;return"hsla("+a(this.get("hue"))+","+a(this.get("saturation")*100)+"%,"+a(this.get("luminosity")*100)+"%,"+this.get("a")+")"},cssText:function(){var a=SC.Color.supportsRgba||SC.Color.supportsArgb;return(this.a===1||!a)?this.toHex():SC.Color.supportsRgba?this.toRgba():this.toArgb()}.property("r","g","b","a").cacheable(),copy:function(){return SC.Color.create({original:this.get("original"),r:this.get("r"),g:this.get("g"),b:this.get("b"),a:this.get("a")})},sub:function(a){return SC.Color.create({r:this.get("r")-a.get("r"),g:this.get("g")-a.get("g"),b:this.get("b")-a.get("b"),a:this.get("a")-a.get("a")})},add:function(a){return SC.Color.create({r:this.get("r")+a.get("r"),g:this.get("g")+a.get("g"),b:this.get("b")+a.get("b"),a:this.get("a")+a.get("a")})},mult:function(b){var a=Math.round;return SC.Color.create({r:a(this.get("r")*b),g:a(this.get("g")*b),b:a(this.get("b")*b),a:this.get("a")*b})}});SC.Color.mixin({supportsRgba:(function(){var d=document.getElementsByTagName("script")[0].style,b=d.cssText,a;d.cssText="background-color:rgba(5,2,1,.5)";a=d.backgroundColor.indexOf("rgba")!==-1;d.cssText=b;return a}()),supportsArgb:(function(){var d=document.getElementsByTagName("script")[0].style,b=d.cssText,a;d.cssText='filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#55000000", endColorstr="#55000000");';a=d.backgroundColor.indexOf("#55000000")!==-1;d.cssText=b;return a}()),clamp:function(d,b,a){return Math.max(Math.min(d,a),b)},clampInt:function(d,b,a){return Math.round(SC.Color.clamp(d,b,a))},clampToDeviceGamut:function(a){return SC.Color.clampInt(a,0,255)},hsvToRgb:function(k,y,w){k/=360;var a,m,u,j=Math.floor(k*6),n=k*6-j,e=w*(1-y),d=w*(1-(y*n)),x=w*(1-(y*(1-n))),o=[[w,x,e],[d,w,e],[e,w,x],[e,d,w],[x,e,w],[w,e,d]],l=SC.Color.clampToDeviceGamut;j=j%6;a=l(o[j][0]*255);m=l(o[j][1]*255);u=l(o[j][2]*255);return[a,m,u]},rgbToHsv:function(a,j,l){a/=255;j/=255;l/=255;var m=Math.max(a,j,l),e=Math.min(a,j,l),k=m-e,f,o=m===0?0:k/m,n=m;if(m===e){f=0}else{switch(m){case a:f=(j-l)/k+(j<l?6:0);break;case j:f=(l-a)/k+2;break;case l:f=(a-j)/k+4;break}f/=6}f*=360;return[f,o,n]},hslToRgb:function(g,f,b){g/=360;var e,d,a=SC.Color.hueToRgb,j=SC.Color.clampToDeviceGamut;d=b<=0.5?b*(f+1):b+f-b*f;e=b*2-d;return[j(a(e,d,g+1/3)*255),j(a(e,d,g)*255),j(a(e,d,g-1/3)*255)]},hueToRgb:function(b,a,d){if(d<0){d++}if(d>1){d--}if(d<1/6){return b+(a-b)*d*6}if(d<1/2){return a}if(d<2/3){return b+(a-b)*(2/3-d)*6}return b},rgbToHsl:function(a,k,n){a/=255;k/=255;n/=255;var o=Math.max(a,k,n),f=Math.min(a,k,n),j,p,e=(o+f)/2,m=o-f;if(o===f){j=p=0}else{p=e>0.5?m/(2-o-f):m/(o+f);switch(o){case a:j=(k-n)/m+(k<n?6:0);break;case k:j=(n-a)/m+2;break;case n:j=(a-k)/m+4;break}j/=6}j*=360;return[j,p,e]},PARSE_RGBA:/^rgba\(\s*([\d]+%?)\s*,\s*([\d]+%?)\s*,\s*([\d]+%?)\s*,\s*([.\d]+)\s*\)$/,PARSE_RGB:/^rgb\(\s*([\d]+%?)\s*,\s*([\d]+%?)\s*,\s*([\d]+%?)\s*\)$/,PARSE_HSLA:/^hsla\(\s*(-?[\d]+)\s*\s*,\s*([\d]+)%\s*,\s*([\d]+)%\s*,\s*([.\d]+)\s*\)$/,PARSE_HSL:/^hsl\(\s*(-?[\d]+)\s*,\s*([\d]+)%\s*,\s*([\d]+)%\s*\)$/,PARSE_HEX:/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,PARSE_ARGB:/^#[0-9a-fA-F]{8}$/,KEYWORDS:{aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},from:function(h){var m=SC.Color,l=h,k,j,d,e=1,f=function(b){var a=parseInt(b,10);return b.slice(-1)==="%"?m.clampInt(a*2.55,0,255):m.clampInt(a,0,255)};if(m.KEYWORDS.hasOwnProperty(h)){h=m.KEYWORDS[h]}if(m.PARSE_RGB.test(h)){h=h.match(m.PARSE_RGB);k=f(h[1]);j=f(h[2]);d=f(h[3])}else{if(m.PARSE_RGBA.test(h)){h=h.match(m.PARSE_RGBA);k=f(h[1]);j=f(h[2]);d=f(h[3]);e=parseFloat(h[4],10)}else{if(m.PARSE_HEX.test(h)){if(h.length===4){h="#"+h.charAt(1)+h.charAt(1)+h.charAt(2)+h.charAt(2)+h.charAt(3)+h.charAt(3)}k=parseInt(h.slice(1,3),16);j=parseInt(h.slice(3,5),16);d=parseInt(h.slice(5,7),16)}else{if(m.PARSE_ARGB.test(h)){k=parseInt(h.slice(3,5),16);j=parseInt(h.slice(5,7),16);d=parseInt(h.slice(7,9),16);e=parseInt(h.slice(1,3),16)/255}else{if(m.PARSE_HSL.test(h)){h=h.match(m.PARSE_HSL);h=m.hslToRgb(((parseInt(h[1],10)%360+360)%360),m.clamp(parseInt(h[2],10)/100,0,1),m.clamp(parseInt(h[3],10)/100,0,1));k=h[0];j=h[1];d=h[2]}else{if(m.PARSE_HSLA.test(h)){h=h.match(m.PARSE_HSLA);e=parseFloat(h[4],10);h=m.hslToRgb(((parseInt(h[1],10)%360+360)%360),m.clamp(parseInt(h[2],10)/100,0,1),m.clamp(parseInt(h[3],10)/100,0,1));k=h[0];j=h[1];d=h[2]}else{if(h==="transparent"){k=j=d=0;e=0}else{return NO}}}}}}}return SC.Color.create({original:l,r:m.clampInt(k,0,255),g:m.clampInt(j,0,255),b:m.clampInt(d,0,255),a:m.clamp(e,0,1)})}});SC.BENCHMARK_LOG_READY=YES;sc_require("system/event");SC.mixin({isReady:NO,suppressOnReady:SC.suppressOnReady?YES:NO,suppressMain:SC.suppressMain?YES:NO,ready:function(b,d){var a=SC._readyQueue;if(d===undefined){d=b;b=null}else{if(SC.typeOf(d)===SC.T_STRING){d=b[d]}}if(SC.isReady){jQuery(document).ready(function(){d.call(b)})}else{if(!a){SC._readyQueue=[]}SC._readyQueue.push(function(){d.call(b)})}return this},onReady:{done:function(){if(SC.isReady){return}SC.isReady=true;SC.RunLoop.begin();SC.Locale.createCurrentLocale();var e=SC.Locale.currentLanguage.toLowerCase();jQuery("body").addClass(e);jQuery("html").attr("lang",e);jQuery("#loading").remove();var d=SC._readyQueue,b,a;if(d){for(b=0,a=d.length;b<a;b++){d[b].call()}SC._readyQueue=null}if(window.main&&!SC.suppressMain&&(SC.mode===SC.APP_MODE)){window.main()}SC.RunLoop.end()}}});if(!SC.suppressOnReady){jQuery.event.special.ready._default=SC.onReady.done}SC.APP_MODE="APP_MODE";SC.TEST_MODE="TEST_MODE";SC.mode=SC.APP_MODE;SC.platform=SC.Object.create({scrollbarSize:function(){var a=document.createElement("DIV"),e;a.innerHTML="<div style='height:1px;'></div>";a.style.cssText="position:absolute;width:100px;height:100px;overflow-y:visible;";e=a.childNodes[0];document.body.appendChild(a);var b=e.innerWidth||e.clientWidth;a.style.overflowY="scroll";var d=e.innerWidth||e.clientWidth;document.body.removeChild(a);return b-d}.property().cacheable(),touch:!SC.none(window.ontouchstart)||SC.browser.name===SC.BROWSER.android||"ontouchstart" in document.documentElement,bounceOnScroll:SC.browser.os===SC.OS.ios,pinchToZoom:SC.browser.os===SC.OS.ios,input:{placeholder:("placeholder" in document.createElement("input"))},input:function(e){var f={},d=e.length,g=document.createElement("input"),b,a;for(a=0;a<d;a++){b=e[a];f[b]=!!(b in g)}return f}(["autocomplete","readonly","list","size","required","multiple","maxlength","pattern","min","max","step","placeholder"]),standalone:!!navigator.standalone,cssPrefix:null,domCSSPrefix:null,simulateTouchEvents:function(){if(this.touch){return}SC.Logger.log("Simulating touch events");SC.platform.touch=YES;SC.platform.bounceOnScroll=YES;document.body.className=document.body.className+" touch";this._simtouch_counter=1;this.removeEvents(["click","dblclick","mouseout","mouseover","mousewheel"]);this.replaceEvent("mousemove",this._simtouch_mousemove);this.replaceEvent("mousedown",this._simtouch_mousedown);this.replaceEvent("mouseup",this._simtouch_mouseup);SC.platform.windowSizeDeterminesOrientation=YES;SC.device.orientationHandlingShouldChange()},removeEvents:function(e){var b,a=e.length,d;for(b=0;b<a;b++){d=e[b];SC.Event.remove(document,d,SC.RootResponder.responder,SC.RootResponder.responder[d])}},replaceEvent:function(a,b){SC.Event.remove(document,a,SC.RootResponder.responder,SC.RootResponder.responder[a]);SC.Event.add(document,a,this,b)},_simtouch_mousemove:function(a){if(!this._mousedown){if(a.altKey&&this._pinchCenter===null){this._pinchCenter={pageX:a.pageX,pageY:a.pageY,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}}else{if(!a.altKey&&this._pinchCenter!==null){this._pinchCenter=null}}return NO}var b=this.manufactureTouchEvent(a,"touchmove");return SC.RootResponder.responder.touchmove(b)},_simtouch_mousedown:function(a){this._mousedown=YES;var b=this.manufactureTouchEvent(a,"touchstart");return SC.RootResponder.responder.touchstart(b)},_simtouch_mouseup:function(a){var d=this.manufactureTouchEvent(a,"touchend"),b=SC.RootResponder.responder.touchend(d);this._mousedown=NO;this._simtouch_counter++;return b},manufactureTouchEvent:function(m,l){var d,n,g=this._simtouch_counter;d={type:l,target:m.target,identifier:g,pageX:m.pageX,pageY:m.pageY,screenX:m.screenX,screenY:m.screenY,clientX:m.clientX,clientY:m.clientY};m.touches=[d];if(m.altKey&&this._pinchCenter!==null){var j=this._pinchCenter.pageX+this._pinchCenter.pageX-m.pageX,h=this._pinchCenter.pageY+this._pinchCenter.pageY-m.pageY,f=this._pinchCenter.screenX+this._pinchCenter.screenX-m.screenX,e=this._pinchCenter.screenY+this._pinchCenter.screenY-m.screenY,b=this._pinchCenter.clientX+this._pinchCenter.clientX-m.clientX,a=this._pinchCenter.clientY+this._pinchCenter.clientY-m.clientY,k=this._simtouch_counter+1;n={type:l,target:m.target,identifier:k,pageX:j,pageY:h,screenX:f,screenY:e,clientX:b,clientY:a};m.touches=[d,n]}m.changedTouches=m.touches;return m},supportsCSSTransitions:NO,supportsCSSTransforms:NO,understandsCSS3DTransforms:NO,supportsCSS3DTransforms:NO,supportsAcceleratedLayers:NO,supportsHashChange:function(){return("onhashchange" in window)&&(document.documentMode===undefined||document.documentMode>7)}(),supportsHistory:function(){return !!(window.history&&window.history.pushState)}(),supportsCanvas:function(){return !!document.createElement("canvas").getContext}(),supportsOrientationChange:("onorientationchange" in window),windowSizeDeterminesOrientation:SC.browser.os===SC.OS.ios||!("onorientationchange" in window)});(function(){var a=navigator.userAgent.toLowerCase();if((/webkit/).test(a)){SC.platform.cssPrefix="webkit";SC.platform.domCSSPrefix="Webkit"}else{if((/opera/).test(a)){SC.platform.cssPrefix="opera";SC.platform.domCSSPrefix="O"}else{if((/msie/).test(a)&&!(/opera/).test(a)){SC.platform.cssPrefix="ms";SC.platform.domCSSPrefix="ms"}else{if((/mozilla/).test(a)&&!(/(compatible|webkit)/).test(a)){SC.platform.cssPrefix="moz";SC.platform.domCSSPrefix="Moz"}}}}})();(function(){var b=document.createElement("div");var a=["-moz-","-moz-","-o-","-ms-","-webkit-"],j=["moz","Moz","o","ms","webkit"];var g="",f=null,k,d;for(f=0,d=a.length;f<d;f++){k=a[f];g+=k+"transition:all 1s linear;";g+=k+"transform: translate(1px, 1px);";g+=k+"perspective: 500px;"}b.style.cssText=g;var l;for(f=0,d=j.length;f<d;f++){l=j[f];if(b.style[l+"TransitionProperty"]!==undefined){SC.platform.supportsCSSTransitions=YES}if(b.style[l+"Transform"]!==undefined){SC.platform.supportsCSSTransforms=YES}if(b.style[l+"Perspective"]!==undefined||b.style[l+"PerspectiveProperty"]!==undefined){SC.platform.understandsCSS3DTransforms=YES;SC.platform.supportsCSS3DTransforms=YES}}try{if(window.media&&window.media.matchMedium){if(!window.media.matchMedium("(-webkit-transform-3d)")){SC.platform.supportsCSS3DTransforms=NO}}else{if(window.styleMedia&&window.styleMedia.matchMedium){if(!window.styleMedia.matchMedium("(-webkit-transform-3d)")){SC.platform.supportsCSS3DTransforms=NO}}}}catch(h){SC.platform.supportsCSS3DTransforms=NO}if(SC.platform.supportsCSSTransforms&&SC.platform.cssPrefix==="webkit"){SC.platform.supportsAcceleratedLayers=YES}})();sc_require("system/ready");sc_require("system/platform");SC.CAPTURE_BACKSPACE_KEY=NO;SC.RootResponder=SC.Object.extend({panes:null,init:function(){arguments.callee.base.apply(this,arguments);this.panes=SC.Set.create()},mainPane:null,makeMainPane:function(b){var a=this.get("mainPane");if(a===b){return this}this.beginPropertyChanges();if(this.get("keyPane")===a){this.makeKeyPane(b)}this.set("mainPane",b);if(a){a.blurMainTo(b)}if(b){b.focusMainFrom(a)}this.endPropertyChanges();return this},menuPane:null,makeMenuPane:function(b){if(b&&!b.get("acceptsMenuPane")){return this}else{var a=this.get("menuPane");if(a===b){return this}this.set("menuPane",b)}return this},keyPane:null,previousKeyPanes:[],makeKeyPane:function(g){var f,a,e;if(g){if(!g.get("acceptsKeyPane")){return this}else{a=this.get("keyPane");if(a===g){return this}else{if(a){e=this.get("previousKeyPanes");e.push(a)}f=g}}}else{a=this.get("keyPane");e=this.get("previousKeyPanes");f=null;var d;while(e.length>0){d=e.pop();if(d.get("isPaneAttached")&&d.get("acceptsKeyPane")){f=d;break}}}if(!f){var b=this.get("mainPane");if(b&&b.get("acceptsKeyPane")){f=b}}if(a){a.willLoseKeyPaneTo(f)}if(f){f.willBecomeKeyPaneFrom(a)}this.set("keyPane",f);if(f){f.didBecomeKeyPaneFrom(a)}if(a){a.didLoseKeyPaneTo(f)}return this},currentWindowSize:null,computeWindowSize:function(){var d,b,a;if(!this._bod||!this._docElement){b=document.body;a=document.documentElement;this._bod=b;this._docElement=a}else{b=this._bod;a=this._docElement}if(window.innerHeight){d={width:window.innerWidth,height:window.innerHeight}}else{if(a&&a.clientHeight){d={width:a.clientWidth,height:a.clientHeight}}else{if(b){d={width:b.clientWidth,height:b.clientHeight}}}}return d},resize:function(){this._resize();this._assignDesignMode();return YES},_resize:function(){var a=this.computeWindowSize(),b=this.get("currentWindowSize");this.set("currentWindowSize",a);if(!SC.rectsEqual(a,b)){SC.run(function(){SC.device.windowSizeDidChange(a);if(this.panes){if(b!==a){this.panes.invoke("windowSizeDidChange",b,a)}}},this)}},_assignDesignMode:function(){var a=this.computeDesignMode(),b=this.get("currentDesignMode");if(b!==a){this.set("currentDesignMode",a);if(this.panes){SC.run(function(){this.panes.invoke("updateDesignMode",b,a)},this)}}},hasFocus:NO,focus:function(a){if(!this.get("hasFocus")){SC.$("body").addClass("sc-focus").removeClass("sc-blur");SC.run(function(){if(!SC.TABBING_ONLY_INSIDE_DOCUMENT&&!SC.browser.isIE8OrLower){var b=SC.RootResponder.responder.get("keyPane");if(b){var d=b.get("nextValidKeyView");if(d){b.makeFirstResponder(d)}}}this.set("hasFocus",YES)},this)}return YES},focusin:function(a){if(this._focusTimeout){clearTimeout(this._focusTimeout)}this.focus(a)},focusout:function(a){var b=this;this._focusTimeout=setTimeout(function(){b.blur(a)},300)},blur:function(a){if(this.get("hasFocus")){SC.$("body").addClass("sc-blur").removeClass("sc-focus");SC.run(function(){this.set("hasFocus",NO)},this)}return YES},dragDidStart:function(a){this._mouseDownView=a;this._drag=a},currentDesignMode:null,designModes:function(a,b){if(SC.none(b)){if(this._designModeNames){delete this._designModeNames;delete this._designModeThresholds}b=null}else{this._prepOrderedArrays(b)}this._assignDesignMode();return b}.property().cacheable(),computeDesignMode:function(){var k=null,h=this._designModeNames,f=this._designModeThresholds,j=window.devicePixelRatio,d,a;if(!h){return null}d=this.get("currentWindowSize");if(!j){j=1}a=(d.width*d.height)/j;var e,g;for(e=0,g=f.get("length");e<g;e++){var b=f.objectAt(e);if(a<b){k=h.objectAt(e);break}}if(SC.none(k)&&h&&h.get("length")>0){k=h.objectAt(e)}return SC.device.orientation===SC.PORTRAIT_ORIENTATION?k+"_p":k+"_l"},fallbackDesignMode:function(e){var d=this._designModeNames,b,a=null;b=d.indexOf(e);if(b>=0){a=d[b-1]}return a},_prepOrderedArrays:function(f){var a,g;if(f){a=this._designModeNames=[];g=this._designModeThresholds=[];var d;outer:for(d in f){var b,e;e=f[d];inner:for(b=g.length-1;b>=0;b--){if(g[b]<e){break inner}}b+=1;a.splice(b,0,d);g.splice(b,0,e)}}},defaultResponder:null,sendAction:function(e,f,d,g,b,a){f=this.targetForAction(e,f,d,g,a);if(f&&f.isResponderContext){return !!f.sendAction(e,d,b,a)}else{return f&&f.tryToPerform(e,d)}},_responderFor:function(e,b,a){var d=e?e.get("defaultResponder"):null;if(e){e=a||e.get("firstResponder")||e;do{if(e.respondsTo(b)){return e}}while((e=e.get("nextResponder")))}if(typeof d===SC.T_STRING){d=SC.objectForPropertyPath(d)}if(!d){return null}else{if(d.isResponderContext){return d}else{if(d.respondsTo(b)){return d}else{return null}}}},targetForAction:function(d,g,f,h,a){if(!d||(SC.typeOf(d)!==SC.T_STRING)){return null}if(g){if(SC.typeOf(g)===SC.T_STRING){g=SC.objectForPropertyPath(g)||SC.objectForPropertyPath(g,f)}if(g&&!g.isResponderContext){if(g.respondsTo&&!g.respondsTo(d)){g=null}else{if(SC.typeOf(g[d])!==SC.T_FUNCTION){g=null}}}return g}if(h){g=this._responderFor(h,d,a);if(g){return g}}var b=this.get("keyPane"),e=this.get("mainPane");if(b&&(b!==h)){g=this._responderFor(b,d)}if(!g&&e&&(e!==b)){g=this._responderFor(e,d)}if(!g&&(g=this.get("defaultResponder"))){if(SC.typeOf(g)===SC.T_STRING){g=SC.objectForPropertyPath(g);if(g){this.set("defaultResponder",g)}}if(g&&!g.isResponderContext){if(g.respondsTo&&!g.respondsTo(d)){g=null}else{if(SC.typeOf(g[d])!==SC.T_FUNCTION){g=null}}}}return g},targetViewForEvent:function(a){return a.target?SC.$(a.target).view()[0]:null},sendEvent:function(d,a,e){var f,b;SC.run(function(){if(e){f=e.get("pane")}else{f=this.get("menuPane")||this.get("keyPane")||this.get("mainPane")}b=(f)?f.sendEvent(d,a,e):null},this);return b},listenFor:function(e,d,b,a){b=b?b:this;e.forEach(function(f){var g=b[f];if(g){SC.Event.add(d,f,b,g,null,a)}},this);d=null;return b},setup:function(){this.listenFor(["touchstart","touchmove","touchend","touchcancel","keydown","keyup","beforedeactivate","mousedown","mouseup","dragenter","dragover","dragleave","drop","click","dblclick","mousemove","contextmenu"],document).listenFor(["resize"],window);if(SC.browser.isIE8OrLower){this.listenFor(["focusin","focusout"],document)}else{this.listenFor(["focus","blur"],window)}if(this.keypress){if(SC.CAPTURE_BACKSPACE_KEY&&SC.browser.isMozilla){var b=this;document.onkeypress=function(f){f=SC.Event.normalizeEvent(f);return b.keypress.call(b,f)}}else{SC.Event.add(document,"keypress",this,this.keypress)}}["drag","selectstart"].forEach(function(g){var h=this[g];if(h){if(SC.browser.isIE){var f=this;document.body["on"+g]=function(j){return h.call(f,SC.Event.normalizeEvent(event||window.event))};SC.Event.add(window,"unload",this,function(){document.body["on"+g]=null})}else{SC.Event.add(document,g,this,h)}}},this);var a="mousewheel";if(SC.browser.isMozilla){if(SC.browser.compare(SC.browser.engineVersion,"1.9.1")<0){a="DOMMouseScroll"}else{a="MozMousePixelScroll"}}SC.Event.add(document,a,this,this.mousewheel);this.set("currentWindowSize",this.computeWindowSize());if(SC.browser.os===SC.OS.ios&&SC.browser.name===SC.BROWSER.safari){if(SC.platform&&!SC.platform.touch){SC.platform.simulateTouchEvents()}var d=SC.RunLoop.prototype.endRunLoop,e;e=function(){if(d){d.apply(this,arguments)}var k=SC.RootResponder.responder._touches,m,g,j,h=NO;if(k){for(m in k){if(k[m]._rescuedElement){continue}j=g=k[m].target;while(g&&(g=g.parentNode)&&!h){h=(g===document.body)}if(!h&&j){if(j.parentNode&&j.cloneNode){var l=j.cloneNode(true);j.parentNode.replaceChild(l,j);j.swapNode=l}var f=SC.touchHoldingPen;if(!f){f=SC.touchHoldingPen=document.createElement("div");f.style.display="none";document.body.appendChild(f)}f.appendChild(j);k[m]._rescuedElement=j}}}};SC.RunLoop.prototype.endRunLoop=e}},cleanUpTransitionListeners:function(){var a=SC.platform.transitionendEventName,d=SC.browser.domPrefix,b=d.toLowerCase(),g=b+"transitionend",f=b+"TransitionEnd",e=d+"TransitionEnd";["transitionend",g,f,e].forEach(function(h){if(h!=a){SC.Event.remove(document,h,this,this[h]);this[h]=null}})},cleanUpAnimationListeners:function(){var d=SC.browser.domPrefix,b=d.toLowerCase(),a=SC.platform.animationendEventName,g=b+"animationend",f=b+"AnimationEnd",e=d+"AnimationEnd";["animationend",g,f,e].forEach(function(h){if(h!=a){SC.Event.remove(document,h,this,this[h]);this[h]=null}});a=SC.platform.animationiterationEventName;g=b+"animationiteration";f=b+"AnimationIteration";e=d+"AnimationIteration";["animationiteration",g,f,e].forEach(function(h){if(h!=a){SC.Event.remove(document,h,this,this[h]);this[h]=null}});a=SC.platform.animationstartEventName;g=b+"animationstart";f=b+"AnimationStart";e=d+"AnimationStart";["animationstart",g,f,e].forEach(function(h){if(h!=a){SC.Event.remove(document,h,this,this[h]);this[h]=null}})},_touchedViews:{},_touches:{},touchesForView:function(a){if(this._touchedViews[SC.guidFor(a)]){return this._touchedViews[SC.guidFor(a)].touches}},averagedTouchesForView:function(j,h){var g,n=this.touchesForView(j),b=j._scrr_averagedTouches||(j._scrr_averagedTouches={});if((!n||n.length===0)&&!h){b.x=0;b.y=0;b.d=0;b.touchCount=0}else{var f=this._averagedTouches_touches||(this._averagedTouches_touches=[]);f.length=0;if(n){var e;g=n.length;for(e=0;e<g;e++){f.push(n[e])}}if(h){f.push(h)}var k,d,a=0,p=0,o,m,l=0;g=f.length;for(k=0;k<g;k++){d=f[k];a+=d.pageX;p+=d.pageY}a/=g;p/=g;for(k=0;k<g;k++){d=f[k];o=Math.abs(d.pageX-a);m=Math.abs(d.pageY-p);l+=Math.pow(o*o+m*m,0.5)}l/=g;b.x=a;b.y=p;b.d=l;b.touchCount=g}return b},assignTouch:function(b,a){if(b.hasEnded){throw new Error("Attempt to assign a touch that is already finished.")}if(b.view===a){return}if(b.view){this.unassignTouch(b)}if(!this._touchedViews[SC.guidFor(a)]){this._touchedViews[SC.guidFor(a)]={view:a,touches:SC.CoreSet.create([]),touchCount:0};a.set("hasTouch",YES)}b.view=a;this._touchedViews[SC.guidFor(a)].touches.add(b);this._touchedViews[SC.guidFor(a)].touchCount++},unassignTouch:function(d){var a,b;if(!d.view){return}a=d.view;b=this._touchedViews[SC.guidFor(a)];b.touches.remove(d);b.touchCount--;if(b.touchCount<1){a.set("hasTouch",NO);b.view=null;delete this._touchedViews[SC.guidFor(a)]}d.view=undefined},_flushQueuedTouchResponder:function(){if(this._queuedTouchResponder){var a=this._queuedTouchResponder;this._queuedTouchResponder=null;this.makeTouchResponder.apply(this,a)}},makeTouchResponder:function(g,f,d,m){if(this._isMakingTouchResponder){this._queuedTouchResponder=[g,f,d,m];return}this._isMakingTouchResponder=YES;var j=g.touchResponders,b;if(g.touchResponder===f){this._isMakingTouchResponder=NO;this._flushQueuedTouchResponder();return}var a;if(f){a=f.get("pane")}else{a=this.get("keyPane")||this.get("mainPane")}if(j.indexOf(f)<0){if(m){try{f=(a)?a.sendEvent("touchStart",g,f):null}catch(h){SC.Logger.error("Error in touchStart: "+h);f=null}}else{if(f&&((f.get?f.get("acceptsMultitouch"):f.acceptsMultitouch)||!f.hasTouch)){if(!f.touchStart(g)){f=null}}else{}}}if(!d||(j.indexOf(f)>-1&&j[j.length-1]!==f)){this.unassignTouch(g);var k=j.length-1,l=j[k];while(l&&l!==f){b=this.touchesForView(l);if((l.get?l.get("acceptsMultitouch"):l.acceptsMultitouch)||!b){if(l.touchCancelled){l.touchCancelled(g)}}k--;l=j[k];j.pop();g.touchResponder=j[k];g.nextTouchResponder=j[k-1]}}if(f){this.assignTouch(g,f);if(f!==g.touchResponder){j.push(f);g.touchResponder=f;g.nextTouchResponder=j[j.length-2]}}this._isMakingTouchResponder=NO;this._flushQueuedTouchResponder()},captureTouch:function(j,f,h){if(!f){f=this}var g=j.targetView,d=g,e=[],b,a;while(d&&(d!==f)){e.unshift(d);d=d.get("nextResponder")}for(a=e.length,b=0;b<a;b++){d=e[b];if(d.tryToPerform("captureTouch",j)){this.makeTouchResponder(j,d,h,YES);return}}this.makeTouchResponder(j,g,h,YES)},endMissingTouches:function(f){var b,a=f.length,e={},d=[];for(b=0;b<a;b++){e[f[b].identifier]=YES}for(b in this._touches){var g=this._touches[b].identifier;if(!e[g]){d.push(this._touches[b])}}for(b=0,a=d.length;b<a;b++){this.endTouch(d[b]);this.finishTouch(d[b])}},_touchCount:0,endTouch:function(b,h,d){if(!h){h="touchEnd"}var a,g,e,f;this.unassignTouch(b);if(b.touchResponder){f=b.touchResponder;g=b.touchResponders;a=g.length-1;e=g[a];while(e){if(e[h]){e[h](b,d)}if(b.touchResponder!==f){break}a--;e=g[a];h="touchCancelled"}}},finishTouch:function(b){var a;this.unassignTouch(b);if(a=b._rescuedElement){if(a.swapNode&&a.swapNode.parentNode){a.swapNode.parentNode.replaceChild(a,a.swapNode)}else{if(a.parentNode===SC.touchHoldingPen){SC.touchHoldingPen.removeChild(a)}}delete b._rescuedElement;a.swapNode=null;a=null}b.touchResponders=null;b.touchResponder=null;b.nextTouchResponder=null;b.hasEnded=YES;if(this._touches[b.identifier]){delete this._touches[b.identifier]}},touchstart:function(a){if(this.ignoreTouchHandle(a)){return YES}var b=NO;SC.run(function(){this.endMissingTouches(a.touches);var f,g=a.changedTouches,e=g.length,h,d;a.touchContext=this;for(f=0;f<e;f++){h=g[f];d=SC.Touch.create(h,this);if(!d.targetView){continue}if(d.hidesTouchIntercept){b=YES}d.timeStamp=a.timeStamp;this._touches[h.identifier]=d;d.event=a;this.captureTouch(d,this);d.event=null}},this);if(b){return YES}return a.hasCustomEventHandling},touchmove:function(b){if(SC.browser.isiOS||SC.browser.isAndroid){var a=b.target.tagName;if(a==="A"){b.allowDefault();return YES}}SC.run(function(){var e=b.changedTouches,d,p,n,g=e.length,m,l,k,o,h={},j,f=NO;if(this._drag){d=SC.Touch.create(b.changedTouches[0],this);this._drag.tryToPerform("mouseDragged",d)}for(n=0;n<g;n++){d=e[n];p=this._touches[d.identifier];if(!p){continue}if(p.hidesTouchIntercept){f=YES}p.pageX=d.pageX;p.pageY=d.pageY;p.clientX=d.clientX;p.clientY=d.clientY;p.screenX=d.screenX;p.screenY=d.screenY;p.timeStamp=b.timeStamp;p.event=b;if(p.touchResponder){m=p.touchResponder;j=SC.guidFor(m);if(!h[j]){h[j]={view:m,touches:[]}}h[j].touches.push(p)}}if(f){b.allowDefault();return YES}for(n in h){m=h[n].view;l=h[n].touches;b.viewChangedTouches=l;k=this.touchesForView(m);o=k.firstObject();b.pageX=o.pageX;b.pageY=o.pageY;b.clientX=o.clientX;b.clientY=o.clientY;b.screenX=o.screenX;b.screenY=o.screenY;b.touchContext=this;m.tryToPerform("touchesDragged",b,k)}e=b.changedTouches;g=e.length;for(n=0;n<g;n++){d=e[n];p=this._touches[d.identifier];if(p){p.event=null}}},this);return b.hasCustomEventHandling},touchend:function(b){var d=NO;if(this.ignoreTouchHandle(b)){return YES}SC.run(function(){var j=b.changedTouches,k,g,f,e=j.length,h=b.isCancel?"touchCancelled":"touchEnd";for(f=0;f<e;f++){k=j[f];k.type="touchend";g=this._touches[k.identifier];if(!g){continue}g.timeStamp=b.timeStamp;g.pageX=k.pageX;g.pageY=k.pageY;g.clientX=k.clientX;g.clientY=k.clientY;g.screenX=k.screenX;g.screenY=k.screenY;g.type="touchend";g.event=b;if(g.hidesTouchIntercept){g.unhideTouchIntercept();d=YES}if(this._drag){this._drag.tryToPerform("mouseUp",k);this._drag=null}this.endTouch(g,h,b);this.finishTouch(g)}},this);if(d){return YES}if(SC.browser.isiOS){var a=b.target.tagName;if(a==="INPUT"||a==="TEXTAREA"){window.focus()}else{window.focus();$(".field").blur()}}return b.hasCustomEventHandling},touchcancel:function(a){a.isCancel=YES;this.touchend(a)},ignoreTouchHandle:function(b){if(SC.browser.isiOS||SC.browser.isAndroid){var a=b.target.tagName;if(a==="INPUT"||a==="TEXTAREA"||a==="A"||a==="SELECT"){b.allowDefault();return NO}}return NO},ignoreMouseHandle:function(b){if(SC.browser.isAndroid){var a=b.target.tagName;if(a==="INPUT"||a==="TEXTAREA"||a==="A"||a==="SELECT"){return NO}return YES}return NO},attemptKeyEquivalent:function(b){var e=null;var d=b.commandCodes()[0];if(!d){return NO}var g=this.get("menuPane"),a=this.get("keyPane"),f=this.get("mainPane");if(g){e=g.performKeyEquivalent(d,b);if(e){return e}}if(a){e=a.performKeyEquivalent(d,b);if(e||a.get("isModal")){return e}}if(!e&&f&&(f!==a)){e=f.performKeyEquivalent(d,b);if(e||f.get("isModal")){return e}}return e},_lastModifiers:null,_handleModifierChanges:function(b){var a;a=this._lastModifiers=(this._lastModifiers||{alt:false,ctrl:false,shift:false});var d=false;if(b.altKey!==a.alt){a.alt=b.altKey;d=true}if(b.ctrlKey!==a.ctrl){a.ctrl=b.ctrlKey;d=true}if(b.shiftKey!==a.shift){a.shift=b.shiftKey;d=true}b.modifiers=a;return(d)?(this.sendEvent("flagsChanged",b)?b.hasCustomEventHandling:YES):YES},_isFunctionOrNonPrintableKey:function(a){return !!(a.altKey||a.ctrlKey||a.metaKey||SC.FUNCTION_KEYS[a.which])},_isModifierKey:function(a){return !!SC.MODIFIER_KEYS[a.charCode]},_isPrintableKey:function(a){return((a.originalEvent.which===undefined||a.originalEvent.which>0)&&!(a.which===8||a.which===9||a.which===13||a.which===27))},keydown:function(a){if(SC.none(a)){return YES}var f=a.keyCode;if(SC.browser.isMozilla&&a.keyCode===9){this.keydownCounter=1}if(f===229){this._IMEInputON=YES;return this.sendEvent("keyDown",a)}if(f===27&&this._drag){this._drag.cancelDrag(a);this._drag=null;this._mouseDownView=null;return YES}if(SC.browser.isMozilla&&(a.which===8)){return true}var b=this._handleModifierChanges(a),e=a.target||a.srcElement,d=(a.which===8)&&!SC.allowsBackspaceToPreviousPage&&(e===document.body);if(this._isModifierKey(a)){return(d?NO:b)}b=YES;if(this._isFunctionOrNonPrintableKey(a)){if(f>=37&&f<=40&&SC.browser.isMozilla){return YES}b=this.sendEvent("keyDown",a);if(!b){SC.run(function(){b=!this.attemptKeyEquivalent(a)},this)}else{b=a.hasCustomEventHandling;if(b){d=NO}}}return d?NO:b},keypress:function(b){var d,f=b.keyCode,g=SC.browser.isMozilla;if(g&&b.keyCode===9){this.keydownCounter++;if(this.keydownCounter==2){return YES}}if(g&&(b.which===8)){b.which=f;d=this.sendEvent("keyDown",b);return d?(SC.allowsBackspaceToPreviousPage||b.hasCustomEventHandling):YES}else{var e=(f>=37&&f<=40&&g),a=b.charCode;if((a!==undefined&&a===0&&b.keyCode!==9)&&!e){return YES}if(e){b.which=f}if(e||this._isPrintableKey(b)){return this.sendEvent("keyDown",b)?b.hasCustomEventHandling:YES}}},keyup:function(a){if(this._ffevt){this._ffevt=null}var b=this._handleModifierChanges(a);if(this._isModifierKey(a)){return b}if(this._IMEInputON&&a.keyCode===13){a.isIMEInput=YES;this.sendEvent("keyDown",a);this._IMEInputON=NO}return this.sendEvent("keyUp",a)?a.hasCustomEventHandling:YES},beforedeactivate:function(d){var b=d.toElement;if(b&&b.tagName&&b.tagName!=="IFRAME"){var a=SC.$(b).view()[0];if(a&&a.get("blocksIEDeactivate")){return NO}}return YES},mousedown:function(e){if(this.ignoreMouseHandle(e)){return YES}this._clickCount+=1;if(!this._lastMouseUpAt||this._lastClickWhich!==e.which||((Date.now()-this._lastMouseUpAt)>250)){this._clickCount=1}else{var d=this._lastMouseDownX-e.clientX,a=this._lastMouseDownY-e.clientY,g=Math.sqrt(d*d+a*a);if(g>8){this._clickCount=1}}e.clickCount=this._clickCount;this._lastClickWhich=e.which;this._lastMouseDownX=e.clientX;this._lastMouseDownY=e.clientY;var b=this.targetViewForEvent(e);if(b){fr=b.getPath("pane.firstResponder")}if(fr&&fr.get("blurOnMouseDown")&&fr!==b){fr.resignFirstResponder(e)}b=this._mouseDownView=this.sendEvent("mouseDown",e,b);if(b&&b.respondsTo("mouseDragged")){this._mouseCanDrag=YES}var f=b?e.hasCustomEventHandling:YES;this._lastMouseDownCustomHandling=f;return f},mouseup:function(b){if(this.ignoreMouseHandle(b)){return YES}var h=NO,d=this._drag,g=null;if(d){SC.run(function(){d.tryToPerform("mouseUp",b)})}else{var a=this._mouseDownView,f=this.targetViewForEvent(b);b.clickCount=this._clickCount;if(a){g=this.sendEvent("mouseUp",b,a);if(!g&&(this._clickCount===2)){g=this.sendEvent("doubleClick",b,a);h=YES}if(!g){g=this.sendEvent("click",b,a);h=YES}}if(!g&&!h){if(this._clickCount===2){g=this.sendEvent("doubleClick",b,f)}if(!g){g=this.sendEvent("click",b,f)}}}this._mouseCanDrag=NO;this._mouseDownView=this._drag=null;this._lastMouseUpAt=Date.now();var e=g?b.hasCustomEventHandling:YES;this._lastMouseUpCustomHandling=e;return e},click:function(a){if(!this._lastMouseUpCustomHandling||!this._lastMouseDownCustomHandling){a.preventDefault();a.stopPropagation();return NO}return YES},dblclick:function(a){if(SC.browser.isIE8OrLower){this._clickCount=2;this.mouseup(a)}},mousewheel:function(b){var a=this.targetViewForEvent(b),d=this.sendEvent("mouseWheel",b,a);return(d)?b.hasCustomEventHandling:YES},_lastHovered:null,mousemove:function(a){if(SC.browser.isIE){if(this._lastMoveX===a.clientX&&this._lastMoveY===a.clientY){return}}this._lastMoveX=a.clientX;this._lastMoveY=a.clientY;SC.run(function(){var f=this._drag;if(f){if(SC.browser.isIE){if(this._lastMouseDownX!==a.clientX||this._lastMouseDownY!==a.clientY){f.tryToPerform("mouseDragged",a)}}else{f.tryToPerform("mouseDragged",a)}}else{var e=this._lastHovered||[],g=[],h,b,d=this.targetViewForEvent(a);while(d&&(d!==this)){g.push(d);d=d.get("nextResponder")}for(h=0,b=e.length;h<b;h++){d=e[h];if(g.indexOf(d)===-1){d.tryToPerform("mouseExited",a)}}for(h=0,b=g.length;h<b;h++){d=g[h];if(e.indexOf(d)!==-1){d.tryToPerform("mouseMoved",a)}else{d.tryToPerform("mouseEntered",a)}}this._lastHovered=g;if(this._mouseDownView){if(SC.browser.isIE){if(this._lastMouseDownX!==a.clientX&&this._lastMouseDownY!==a.clientY){this._mouseDownView.tryToPerform("mouseDragged",a)}}else{this._mouseDownView.tryToPerform("mouseDragged",a)}}}},this)},dragenter:function(a){SC.run(function(){this._dragenter(a)},this)},_dragenter:function(a){if(!this._dragCounter){this.sendAction("dataDragDidEnter",null,a);this._dragCounter=1}else{this._dragCounter++}return this._dragover(a)},dragleave:function(a){SC.run(function(){this._dragleave(a)},this)},_dragleave:function(a){this._dragCounter--;var b=this._dragover(a);if(this._dragCounter===0){this.sendAction("dataDragDidExit",null,a)}return b},_forceDragLeave:function(){this.invokeLast(function(){if(this._dragCounter===0){return}this._dragCounter=0;var a=this._lastDraggedEvt;this._dragover(a);this.sendAction("dataDragDidExit",null,a)})},dragover:function(a){SC.run(function(){this._dragover(a)},this)},_dragover:function(d){if(d.dataTransfer.types&&(d.dataTransfer.types.contains("Files")||d.dataTransfer.types.contains("text/uri-list"))){d.preventDefault();d.stopPropagation();d.dataTransfer.dropEffect="none"}this.sendAction("dataDragDidHover",null,d);var e=this._lastDraggedOver||[],g=[],f,a,b=this.targetViewForEvent(d);while(b&&(b!==this)){g.push(b);b=b.get("nextResponder")}if(this._dragLeaveTimer){this._dragLeaveTimer.invalidate()}if(this._dragCounter===0){for(f=0,a=g.length;f<a;f++){b=g[f];b.tryToPerform("dataDragExited",d)}this._lastDraggedOver=this._lastDraggedEvt=this._dragLeaveTimer=null}else{if(d.type!=="dragleave"){for(f=0,a=e.length;f<a;f++){b=e[f];if(g.indexOf(b)===-1){b.tryToPerform("dataDragExited",d)}}for(f=g.length-1;f>=0;f--){b=g[f];if(e.indexOf(b)===-1){b.tryToPerform("dataDragEntered",d)}}for(f=0,a=g.length;f<a;f++){b=g[f];b.tryToPerform("dataDragHovered",d)}this._lastDraggedOver=g;this._lastDraggedEvt=d;this._dragLeaveTimer=SC.Timer.schedule({target:this,action:"_forceDragLeave",interval:300})}}},drop:function(a){SC.run(function(){this._drop(a)},this)},_drop:function(d){if(d.dataTransfer.types&&(d.dataTransfer.types.contains("Files")||d.dataTransfer.types.contains("text/uri-list"))){d.preventDefault();d.stopPropagation();d.dataTransfer.dropEffect="none"}var e=this._lastDraggedOver||[],g=[],f,a,b=this.targetViewForEvent(d);while(b&&(b!==this)){g.push(b);b=b.get("nextResponder")}for(f=0,a=e.length;f<a;f++){b=e[f];if(g.indexOf(b)===-1){b.tryToPerform("dataDragExited",d)}}for(f=0,a=g.length;f<a;f++){b=g[f];if(b.tryToPerform("dataDragDropped",d)){break}}for(f=0,a=g.length;f<a;f++){b=g[f];b.tryToPerform("dataDragExited",d)}this._lastDraggedOver=null;this._lastDraggedAt=null;this._dragCounter=0;if(this._dragLeaveTimer){this._dragLeaveTimer.invalidate()}this._dragLeaveTimer=null;this.sendAction("dataDragDidDrop",null,d);this.sendAction("dataDragDidExit",null,d)},_mouseCanDrag:YES,selectstart:function(b){var d=this.targetViewForEvent(b),a=this.sendEvent("selectStart",b,d);if(d&&d.respondsTo("mouseDragged")){return(a!==null?YES:NO)&&!this._mouseCanDrag}else{return(a!==null?YES:NO)}},drag:function(){return false},contextmenu:function(b){var a=this.targetViewForEvent(b),d;a=this.sendEvent("contextMenu",b,a);d=a?b.hasCustomEventHandling:YES;return d},animationstart:function(b){var a=this.targetViewForEvent(b);this.sendEvent("animationDidStart",b,a);return a?b.hasCustomEventHandling:YES},animationiteration:function(b){var a=this.targetViewForEvent(b);this.sendEvent("animationDidIterate",b,a);return a?b.hasCustomEventHandling:YES},animationend:function(b){var a=this.targetViewForEvent(b);this.sendEvent("animationDidEnd",b,a);return a?b.hasCustomEventHandling:YES},transitionend:function(b){var a=this.targetViewForEvent(b);this.sendEvent("transitionDidEnd",b,a);return a?b.hasCustomEventHandling:YES}});SC.Touch=function(e,a){this.touchContext=a;this.identifier=e.identifier;var d=e.target,b;if(d&&SC.$(d).hasClass("touch-intercept")){e.target.style.webkitTransform="translate3d(0px,-5000px,0px)";d=document.elementFromPoint(e.pageX,e.pageY);if(d){b=SC.$(d).view()[0]}this.hidesTouchIntercept=NO;if(d.tagName==="INPUT"){this.hidesTouchIntercept=e.target}else{e.target.style.webkitTransform="translate3d(0px,0px,0px)"}}else{b=e.target?SC.$(e.target).view()[0]:null}this.targetView=b;this.target=d;this.hasEnded=NO;this.type=e.type;this.clickCount=1;this.view=undefined;this.touchResponder=this.nextTouchResponder=undefined;this.touchResponders=[];this.startX=this.pageX=e.pageX;this.startY=this.pageY=e.pageY;this.clientX=e.clientX;this.clientY=e.clientY;this.screenX=e.screenX;this.screenY=e.screenY};SC.Touch.prototype={unhideTouchIntercept:function(){var a=this.hidesTouchIntercept;if(a){setTimeout(function(){a.style.webkitTransform="translate3d(0px,0px,0px)"},500)}},allowDefault:function(){if(this.event){this.event.hasCustomEventHandling=YES}},preventDefault:function(){if(this.event){this.event.preventDefault()}},stopPropagation:function(){if(this.event){this.event.stopPropagation()}},stop:function(){if(this.event){this.event.stop()}},end:function(){this.touchContext.endTouch(this)},makeTouchResponder:function(b,d,a){this.touchContext.makeTouchResponder(this,b,d,a)},captureTouch:function(a,b){this.touchContext.captureTouch(this,a,b)},touchesForView:function(a){return this.touchContext.touchesForView(a)},touchesForResponder:function(a){return this.touchContext.touchesForView(a)},averagedTouchesForView:function(a,b){return this.touchContext.averagedTouchesForView(a,(b?this:null))}};SC.mixin(SC.Touch,{create:function(b,a){return new SC.Touch(b,a)}});SC.ready(SC.RootResponder,SC.RootResponder.ready=function(){var a;a=SC.RootResponder.responder=SC.RootResponder.create();a.setup()});sc_require("system/core_query");sc_require("system/ready");sc_require("system/root_responder");sc_require("system/platform");SC.PORTRAIT_ORIENTATION="portrait";SC.LANDSCAPE_ORIENTATION="landscape";SC.NO_ORIENTATION="desktop";SC.device=SC.Object.create({orientation:SC.NO_ORIENTATION,isOffline:NO,mouseLocation:function(){var a=SC.RootResponder.responder,d=a._lastMoveX,b=a._lastMoveY;if(SC.empty(d)||SC.empty(b)){return null}return{x:d,y:b}}.property(),init:function(){arguments.callee.base.apply(this,arguments);if(navigator&&navigator.onLine===false){this.set("isOffline",YES)}},setup:function(){var a=SC.RootResponder.responder;a.listenFor(["online","offline"],window,this);this.orientationHandlingShouldChange()},orientationHandlingShouldChange:function(){if(SC.platform.windowSizeDeterminesOrientation){SC.Event.remove(window,"orientationchange",this,this.orientationchange);this.windowSizeDidChange(SC.RootResponder.responder.get("currentWindowSize"))}else{if(SC.platform.supportsOrientationChange){SC.Event.add(window,"orientationchange",this,this.orientationchange);this.orientationchange()}}},windowSizeDidChange:function(a){if(SC.platform.windowSizeDeterminesOrientation){if(!SC.browser.iOS){SC.run(function(){if(SC.platform.touch){if(a.height>=a.width){SC.device.set("orientation",SC.PORTRAIT_ORIENTATION)}else{SC.device.set("orientation",SC.LANDSCAPE_ORIENTATION)}}else{SC.device.set("orientation",SC.NO_ORIENTATION)}})}else{SC.run(function(){if(a.width===window.screen.width){SC.device.set("orientation",SC.PORTRAIT_ORIENTATION)}else{SC.device.set("orientation",SC.LANDSCAPE_ORIENTATION)}})}return YES}return NO},orientationchange:function(a){SC.run(function(){if(window.orientation===0||window.orientation===180){SC.device.set("orientation",SC.PORTRAIT_ORIENTATION)}else{SC.device.set("orientation",SC.LANDSCAPE_ORIENTATION)}})},orientationObserver:function(){var a=SC.$(document.body),b=this.get("orientation");if(b===SC.PORTRAIT_ORIENTATION){a.addClass("portrait")}else{a.removeClass("portrait")}if(b===SC.LANDSCAPE_ORIENTATION){a.addClass("landscape")}else{a.removeClass("landscape")}}.observes("orientation"),online:function(a){this.set("isOffline",NO)},offline:function(a){this.set("isOffline",YES)}});SC.ready(function(){SC.device.setup()});SC.MODIFIED_KEY_BINDINGS={"ctrl_.":"cancel",shift_tab:"insertBacktab",shift_left:"moveLeftAndModifySelection",shift_right:"moveRightAndModifySelection",shift_up:"moveUpAndModifySelection",shift_down:"moveDownAndModifySelection",alt_left:"moveLeftAndModifySelection",alt_right:"moveRightAndModifySelection",alt_up:"moveUpAndModifySelection",alt_down:"moveDownAndModifySelection",ctrl_a:"selectAll"};SC.BASE_KEY_BINDINGS={escape:"cancel",backspace:"deleteBackward","delete":"deleteForward","return":"insertNewline",tab:"insertTab",left:"moveLeft",right:"moveRight",up:"moveUp",down:"moveDown",home:"moveToBeginningOfDocument",end:"moveToEndOfDocument",pagedown:"pageDown",pageup:"pageUp"};SC.Page=SC.Object.extend({owner:null,get:function(a){var b=this[a];if(b&&b.isClass){this[a]=b=b.create({page:this});if(!this.get("inDesignMode")){b.awake()}return b}else{return arguments.callee.base.apply(this,arguments)}},awake:function(){var b,a;for(a in this){if(!this.hasOwnProperty(a)){continue}b=this[a];if(b&&b.isViewClass){this[a]=b=b.create({page:this})}}return this},getIfConfigured:function(b){var a=this[b];return(a&&a.isViewClass)?null:this.get(b)},loc:function(d){var a,b;for(b in d){if(!d.hasOwnProperty(b)){continue}a=this[b];if(!a||!a.isViewClass){continue}a.loc(d[b])}return this}});SC.Page.design=SC.Page.create;SC.Page.localization=function(a){return a};sc_require("system/builder");SC.MODE_REPLACE="replace";SC.MODE_APPEND="append";SC.MODE_PREPEND="prepend";SC.NON_PIXEL_PROPERTIES=["zIndex","fontWeight","opacity"];SC.COMBO_STYLES={WebkitTransition:["WebkitTransitionProperty","WebkitTransitionDuration","WebkitTransitionDelay","WebkitTransitionTimingFunction"]};SC.RenderContext=SC.Builder.create({SELF_CLOSING:SC.CoreSet.create().addEach(["area","base","basefront","br","hr","input","img","link","meta"]),init:function(e,d){var b,a;if(d){this.prevObject=d;this.strings=d.strings;this.offset=d.length+d.offset}if(!this.strings){this.strings=[]}if(e===undefined){e="div";a=YES}else{if(e==="div"||e==="label"||e==="a"){a=YES}else{if(SC.typeOf(e)===SC.T_STRING){e=e.toLowerCase();a=YES}}}if(a){this._tagName=e;this._needsTag=YES;this.needsContent=YES;var f=this;while(f){f.length++;f=f.prevObject}this.strings.push(null);this._selfClosing=this.SELF_CLOSING.contains(e)}else{this._elem=e;this._needsTag=NO;this.length=0;this.needsContent=NO}return this},strings:null,offset:0,length:0,updateMode:SC.MODE_REPLACE,needsContent:NO,get:function(b){var a=this.strings||[];return(b===undefined)?a.slice(this.offset,this.length):a[b+this.offset]},push:function(d){var b=this.strings,a=arguments.length;if(!b){this.strings=b=[]}if(a>1){b.push.apply(b,arguments)}else{b.push(d)}var e=this;while(e){e.length+=a;e=e.prevObject}this.needsContent=YES;return this},text:function(d){var b=arguments.length,a=0;for(a=0;a<b;a++){this.push(SC.RenderContext.escapeHTML(arguments[a]))}return this},join:function(b){if(this._needsTag){this.end()}var a=this.strings;return a?a.join(b||""):""},begin:function(a){return SC.RenderContext(a,this)},element:function(){return this._elem?this._elem:SC.$(this.join())[0]},remove:function(a){if(!a){return}var b,d=this._elem;if(!d||!d.removeChild){return}b=document.getElementById(a);if(b){b=d.removeChild(b);b=null}},update:function(){var d=this._elem,h=this.updateMode,f,e,a,g,b;this._innerHTMLReplaced=NO;if(!d){return}f=this.$();if(this.length>0){this._innerHTMLReplaced=YES;if(h===SC.MODE_REPLACE){f.html(this.join())}else{a=d.cloneNode(false);a.innerHTML=this.join();g=a.firstChild;while(g){b=g.nextSibling;d.insertBefore(g,b);g=b}g=b=a=null}}if(this._idDidChange&&(e=this._id)){f.attr("id",e)}jQuery.Buffer.flush();d=this._elem=null;return this.prevObject||this},_DEFAULT_ATTRS:{},end:function(){var o="",b="",d,m,k,h,l=this._attrs,e=this._classNames,a=this._id,n=this._styles,j,g;o="<"+this._tagName;if(l||e||n||a){if(!l){l=this._DEFAULT_ATTRS}if(a){l.id=a}if(e){l["class"]=e.join(" ")}if(n){for(k in n){if(!n.hasOwnProperty(k)){continue}h=n[k];if(h===null){continue}if(typeof h===SC.T_NUMBER&&!SC.NON_PIXEL_PROPERTIES.contains(k)){h+="px"}b=b+this._dasherizeStyleName(k)+": "+h+"; "}l.style=b}o=o+" ";for(k in l){if(!l.hasOwnProperty(k)){continue}h=l[k];if(h===null){continue}o=o+k+'="'+h+'" '}if(l===this._DEFAULT_ATTRS){delete l.style;delete l["class"];delete l.id}}j=this.strings;g=(this._selfClosing===NO)?NO:(this.length===1);o=o+(g?" />":">");j[this.offset]=o;if(!g){j.push("</"+this._tagName+">");var f=this;while(f){f.length++;f=f.prevObject}}this._elem=null;return this.prevObject||this},tag:function(a,b){return this.begin(a,b).end()},tagName:function(a){if(a===undefined){if(!this._tagName&&this._elem){this._tagName=this._elem.tagName}return this._tagName}else{this._tagName=a;this._tagNameDidChange=YES;return this}},id:function(a){if(a===undefined){if(!this._id&&this._elem){this._id=this._elem.id}return this._id}else{this._id=a;this._idDidChange=YES;return this}},classNames:function(b,a){if(this._elem){if(b){this.$().resetClassNames().addClass(b);return this}else{return this.$().attr("class").split(" ")}}if(b===undefined){if(this._cloneClassNames){this._classNames=(this._classNames||[]).slice();this._cloneClassNames=NO}if(!this._classNames){this._classNames=[]}return this._classNames}else{this._classNames=b;this._cloneClassNames=a||NO;this._classNamesDidChange=YES;return this}},hasClass:function(a){if(this._elem){return this.$().hasClass(a)}return this.classNames().indexOf(a)>=0},addClass:function(g){if(g===undefined||g===null){SC.Logger.warn("You are adding an undefined or empty class"+this.toString());return this}if(this._elem){if(SC.typeOf(g)===SC.T_STRING){this.$().addClass(g)}else{var d,b=g.length;for(d=0;d<b;d++){this.$().addClass(g[d])}}return this}var h=this.classNames();if(SC.typeOf(g)===SC.T_STRING){if(h.indexOf(g)<0){h.push(g);this._classNamesDidChange=YES}}else{var e;for(var f=0,a=g.length;f<a;f++){e=g[f];if(h.indexOf(e)<0){h.push(e);this._classNamesDidChange=YES}}}return this},removeClass:function(b){if(this._elem){this.$().removeClass(b);return this}var d=this._classNames,a;if(d&&(a=d.indexOf(b))>=0){if(this._cloneClassNames){d=this._classNames=d.slice();this._cloneClassNames=NO}d[a]=null;this._classNamesDidChange=YES}return this},resetClassNames:function(){if(this._elem){this.$().resetClassNames();return this}this._classNames=[];this._classNamesDidChange=YES;return this},setClass:function(e,d){if(this._elem){this.$().setClass(e,d);return this}var g,a,b,f;if(d!==undefined){return d?this.addClass(e):this.removeClass(e)}else{g=this._classNames;if(!g){g=this._classNames=[]}if(this._cloneClassNames){g=this._classNames=g.slice();this._cloneClassNames=NO}f=NO;for(b in e){if(!e.hasOwnProperty(b)){continue}a=g.indexOf(b);if(e[b]){if(a<0){g.push(b);f=YES}}else{if(a>=0){g[a]=null;f=YES}}}if(f){this._classNamesDidChange=YES}}return this},_STYLE_REGEX:/-?\s*([^:\s]+)\s*:\s*([^;]+)\s*;?/g,styles:function(e,f){if(this._elem){if(e){this.$().resetStyles().css(e)}return this.$().styles()}var a,d,b;if(e===undefined){if(!this._styles&&this._elem){a=this.$().attr("style");if(a&&(a=a.toString()).length>0){if(SC.browser.name===SC.BROWSER.ie){a=a.toLowerCase()}e={};d=this._STYLE_REGEX;d.lastIndex=0;while(b=d.exec(a)){e[this._camelizeStyleName(b[1])]=b[2]}this._styles=e;this._cloneStyles=NO}else{this._styles={}}}else{if(!this._styles){this._styles={}}else{if(this._cloneStyles){this._styles=SC.clone(this._styles);this._cloneStyles=NO}}}return this._styles}else{this._styles=e;this._cloneStyles=f||NO;this._stylesDidChange=YES;return this}},_deleteComboStyles:function(f,e){var h=SC.COMBO_STYLES[e],g=NO,d;if(h){for(var a=0,b=h.length;a<b;a++){d=h[a];if(f[d]){delete f[d];g=YES}}}return g},resetStyles:function(){this.styles({});return this},addStyle:function(a,f){if(this._elem){this.$().css(a,f);return this}var b,e=NO,d=this.styles();if(typeof a===SC.T_STRING){if(f===undefined){return d[a]}else{e=this._deleteComboStyles(d,a);if(d[a]!==f){d[a]=f;e=YES}if(e){this._stylesDidChange=YES}}}else{for(b in a){if(!a.hasOwnProperty(b)){continue}e=e||this._deleteComboStyles(d,b);f=a[b];if(d[b]!==f){d[b]=f;e=YES}}if(e){this._stylesDidChange=YES}}return this},removeStyle:function(a){if(this._elem){this.$().css(a,null);return this}if(!this._styles){return this}var b=this.styles();if(b[a]){b[a]=null;this._stylesDidChange=YES}},attr:function(a,f){if(this._elem){this.$().attr(a,f);return this}var d,b=this._attrs,e=NO;if(!b){this._attrs=b={}}if(typeof a===SC.T_STRING){if(f===undefined){return b[a]}else{if(b[a]!==f){b[a]=f;this._attrsDidChange=YES}}}else{for(d in a){if(!a.hasOwnProperty(d)){continue}f=a[d];if(b[d]!==f){b[d]=f;e=YES}}if(e){this._attrsDidChange=YES}}return this},removeAttr:function(a){if(this._elem){this.$().removeAttr(a);return this}},$:function(d){var a,b=this._elem;a=!b?SC.$.buffer([]):(d===undefined)?SC.$.buffer(b):SC.$.buffer(d,b);b=null;return a},_camelizeStyleName:function(a){var b=a.match(/^-(webkit|moz|o)-/),d=SC.String.camelize(a);if(b){return d.substr(0,1).toUpperCase()+d.substr(1)}else{return d}},_dasherizeStyleName:function(a){var b=SC.String.dasherize(a);if(b.match(/^(webkit|moz|ms|o)-/)){b="-"+b}return b}});SC.RenderContext.fn.html=SC.RenderContext.fn.push;SC.RenderContext.fn.css=SC.RenderContext.fn.addStyle;(function(){var b=/[&<> ]/g,a=function(d){switch(d){case" ":return"&nbsp;";case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;"}};SC.RenderContext.escapeHTML=function(d){if(!d){return""}if(SC.typeOf(d)===SC.T_NUMBER){d=d.toString()}return d.replace(b,a)}})();(function(){var b=0;var d=["ms","moz","webkit","o"];for(var a=0;a<d.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[d[a]+"RequestAnimationFrame"];window.cancelRequestAnimationFrame=window[d[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(j,f){var e=new Date().getTime();var g=Math.max(0,16-(e-b));var h=window.setTimeout(function(){j(e+g)},g);b=e+g;return h}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(e){clearTimeout(e)}}}());SC.SelectionSet=SC.Object.extend(SC.Enumerable,SC.Freezable,SC.Copyable,{isSelectionSet:YES,length:function(){var a=0,b=this._sets,d=this._objects;if(d){a+=d.get("length")}if(b){b.forEach(function(e){a+=e.get("length")})}return a}.property().cacheable(),sources:function(){var d=[],e=this._sets,b=e?e.length:0,a,g,f;for(a=0;a<b;a++){g=e[a];if(g&&g.get("length")>0&&g.source){d.push(g.source)}}return d}.property().cacheable(),indexSetForSource:function(f){if(!f||!f.isSCArray){return null}var b=this._indexSetCache,e=this._objects,d,a;if(!b){b=this._indexSetCache={}}d=b[SC.guidFor(f)];if(d&&d._sourceRevision&&(d._sourceRevision!==f.propertyRevision)){d=null}if(!d){d=this._indexSetForSource(f,NO);if(d&&d.get("length")===0){d=null}if(e){if(d){d=d.copy()}e.forEach(function(g){if((a=f.indexOf(g))>=0){if(!d){d=SC.IndexSet.create()}d.add(a)}},this)}if(d){d=b[SC.guidFor(f)]=d.frozenCopy();d._sourceRevision=f.propertyRevision}}return d},_indexSetForSource:function(g,h){if(h===undefined){h=YES}var e=SC.guidFor(g),d=this[e],f=this._sets,a=f?f.length:0,b=null;if(d>=a){d=null}if(SC.none(d)){if(h&&!this.isFrozen){this.propertyWillChange("sources");if(!f){f=this._sets=[]}b=f[a]=SC.IndexSet.create();b.source=g;this[e]=a;this.propertyDidChange("sources")}}else{b=f?f[d]:null}return b},add:function(a,b,e){if(this.isFrozen){throw SC.FROZEN_ERROR}var h,g,l,k,d,f,j,m;if(b===undefined&&e===undefined){if(!a){throw"Must pass params to SC.SelectionSet.add()"}if(a.isIndexSet){return this.add(a.source,a)}if(a.isSelectionSet){h=a._sets;m=a._objects;g=h?h.length:0;this.beginPropertyChanges();for(l=0;l<g;l++){k=h[l];if(k&&k.get("length")>0){this.add(k.source,k)}}if(m){this.addObjects(m)}this.endPropertyChanges();return this}}k=this._indexSetForSource(a,YES);d=this.get("length");j=k.get("length");f=d-j;k.add(b,e);this._indexSetCache=null;f+=k.get("length");if(f!==d){this.propertyDidChange("length");this.enumerableContentDidChange();if(j===0){this.notifyPropertyChange("sources")}}return this},remove:function(a,b,e){if(this.isFrozen){throw SC.FROZEN_ERROR}var h,g,l,k,d,f,j,m;if(b===undefined&&e===undefined){if(!a){throw"Must pass params to SC.SelectionSet.remove()"}if(a.isIndexSet){return this.remove(a.source,a)}if(a.isSelectionSet){h=a._sets;m=a._objects;g=h?h.length:0;this.beginPropertyChanges();for(l=0;l<g;l++){k=h[l];if(k&&k.get("length")>0){this.remove(k.source,k)}}if(m){this.removeObjects(m)}this.endPropertyChanges();return this}}k=this._indexSetForSource(a,YES);d=this.get("length");f=d-k.get("length");if(k&&(m=this._objects)){if(e!==undefined){b=SC.IndexSet.create(b,e);e=undefined}m.forEach(function(n){l=a.indexOf(n);if(b.contains(l)){m.remove(n);f--}},this)}k.remove(b,e);j=k.get("length");f+=j;this._indexSetCache=null;if(f!==d){this.propertyDidChange("length");this.enumerableContentDidChange();if(j===0){this.notifyPropertyChange("sources")}}return this},contains:function(b,e,a){if(e===undefined&&a===undefined){return this.containsObject(b)}var d=this.indexSetForSource(b);if(!d){return NO}return d.contains(e,a)},intersects:function(b,e,a){var d=this.indexSetForSource(b,NO);if(!d){return NO}return d.intersects(e,a)},_TMP_ARY:[],addObject:function(b){var d=this._TMP_ARY,a;d[0]=b;a=this.addObjects(d);d.length=0;return a},addObjects:function(a){var e=this._objects,b,d;if(!e){e=this._objects=SC.CoreSet.create()}b=e.get("length");e.addEach(a);d=e.get("length");this._indexSetCache=null;if(d!==b){this.propertyDidChange("length");this.enumerableContentDidChange()}return this},removeObject:function(b){var d=this._TMP_ARY,a;d[0]=b;a=this.removeObjects(d);d.length=0;return a},removeObjects:function(b){var f=this._objects,d,e,a;if(!f){return this}d=f.get("length");f.removeEach(b);e=f.get("length");if(a=this._sets){a.forEach(function(g){d+=g.get("length");g.removeObjects(b);e+=g.get("length")},this)}this._indexSetCache=null;if(e!==d){this.propertyDidChange("length");this.enumerableContentDidChange()}return this},containsObject:function(d){var f=this._objects;if(f&&f.contains(d)){return YES}var e=this._sets,b=e?e.length:0,a,g;for(a=0;a<b;a++){g=e[a];if(g&&g.indexOf(d)>=0){return YES}}return NO},constrain:function(f){var h,b,a,e;this.beginPropertyChanges();this.get("sources").forEach(function(j){if(j===f){return}var k=this._indexSetForSource(f,NO);if(k){this.remove(f,k)}},this);h=this._indexSetForSource(f,NO);if(h&&((a=h.get("max"))>(b=f.get("length")))){this.remove(f,b,a-b)}if(e=this._objects){var d,g;for(d=e.length-1;d>=0;d--){g=e[d];if(f.indexOf(g)<0){this.removeObject(g)}}}this.endPropertyChanges();return this},isEqual:function(h){var g,e,b,a,d,f;if(!h||!h.isSelectionSet){return NO}if(h===this){return YES}if((this._sets===h._sets)&&(this._objects===h._objects)){return YES}if(this.get("length")!==h.get("length")){return NO}g=this._objects;e=h._objects;if(g||e){if((g?g.get("length"):0)!==(e?e.get("length"):0)){return NO}if(g&&!g.isEqual(e)){return NO}}d=this.get("sources");a=d.get("length");for(b=0;b<a;b++){f=d.objectAt(b);g=this._indexSetForSource(f,NO);e=this._indexSetForSource(f,NO);if(!!e!==!!g){return NO}if(g&&!g.isEqual(e)){return NO}}return YES},clear:function(){if(this.isFrozen){throw SC.FROZEN_ERROR}if(this._sets){this._sets.length=0}if(this._objects){this._objects=null}this._indexSetCache=null;this.propertyDidChange("length");this.enumerableContentDidChange();this.notifyPropertyChange("sources");return this},copy:function(){var d=this.constructor.create(),e=this._sets,b=e?e.length:0,a,f;if(e&&b>0){e=d._sets=e.slice();for(a=0;a<b;a++){if(!(f=e[a])){continue}f=e[a]=f.copy();d[SC.guidFor(f.source)]=a}}if(this._objects){d._objects=this._objects.copy()}return d},freeze:function(){if(this.get("isFrozen")){return this}var a=this._sets,b=a?a.length:0,d;while(--b>=0){d=a[b];if(d){d.freeze()}}if(this._objects){this._objects.freeze()}this.set("isFrozen",YES);return this},toString:function(){var a=this._sets||[];a=a.map(function(b){return b.toString().replace("SC.IndexSet",SC.guidFor(b.source))},this);if(this._objects){a.push(this._objects.toString())}return"SC.SelectionSet:%@<%@>".fmt(SC.guidFor(this),a.join(","))},firstObject:function(){var b=this._sets,d=this._objects;if(b&&b.get("length")>0){var f=b?b[0]:null,e=f?f.source:null,a=f?f.firstObject():-1;if(e&&a>=0){return e.objectAt(a)}}return d?d.firstObject():undefined}.property(),nextObject:function(d,f,b){var e,a;if(d===0){e=b.objects=[];this.forEach(function(g){e.push(g)},this);b.max=e.length}e=b.objects;a=e[d];if(d+1>=b.max){b.objects=b.max=null}return a},forEach:function(h,f){var d=this._sets,e=this._objects,b=d?d.length:0,g,a;for(a=0;a<b;a++){g=d[a];if(g){g.forEachObject(h,f)}}if(e){e.forEach(h,f)}return this}});SC.SelectionSet.prototype.clone=SC.SelectionSet.prototype.copy;SC.SelectionSet.EMPTY=SC.SelectionSet.create().freeze();sc_require("mixins/delegate_support");SC.SparseArray=SC.Object.extend(SC.Observable,SC.Enumerable,SC.Array,SC.DelegateSupport,{_requestingLength:0,_requestingIndex:0,length:function(){var a=this.delegate;if(a&&SC.none(this._length)&&a.sparseArrayDidRequestLength){this._requestingLength++;a.sparseArrayDidRequestLength(this);this._requestingLength--}return this._length||0}.property().cacheable(),provideLength:function(b){var a;if(SC.none(b)){this._sa_content=null}if(b!==this._length){a=this._length;this._length=b;if(this._requestingLength<=0){this.arrayContentDidChange(0,a||0,b||0)}}return this},rangeWindowSize:1,requestedRangeIndex:null,init:function(){arguments.callee.base.apply(this,arguments);this.requestedRangeIndex=[];this._TMP_PROVIDE_ARRAY=[];this._TMP_PROVIDE_RANGE={length:1};this._TMP_RANGE={}},objectAt:function(a,e){var d=this._sa_content,b;if(!d){d=this._sa_content=[]}if((b=d[a])===undefined){if(!e){this.requestIndex(a)}b=d[a]}return b},definedIndexes:function(e){var d=SC.IndexSet.create(),f=this._sa_content,b,a;if(!f){return d.freeze()}if(e){e.forEach(function(g){if(f[g]!==undefined){d.add(g)}})}else{a=f.length;for(b=0;b<a;b++){if(f[b]!==undefined){d.add(b)}}}return d.freeze()},_TMP_RANGE:{},requestIndex:function(b){var d=this.delegate;if(!d){return this}var a=this.get("rangeWindowSize"),f=b;if(a>1){f=f-Math.floor(f%a)}if(a<1){a=1}this._requestingIndex++;if(d.sparseArrayDidRequestRange){var e=this._TMP_RANGE;if(this.wasRangeRequested(f)===-1){e.start=f;e.length=a;this.requestedRangeIndex.push(f);d.sparseArrayDidRequestRange(this,e)}}else{if(d.sparseArrayDidRequestIndex){while(--a>=0){d.sparseArrayDidRequestIndex(this,f+a)}}}this._requestingIndex--;return this},wasRangeRequested:function(d){var b,a;for(b=0,a=this.requestedRangeIndex.length;b<a;b++){if(this.requestedRangeIndex[b]===d){return b}}return -1},rangeRequestCompleted:function(b){var a=this.wasRangeRequested(b);if(a>=0){this.requestedRangeIndex.removeAt(a,1);return YES}return NO},provideObjectsInRange:function(b,f){var d=this._sa_content;if(!d){d=this._sa_content=[]}var e=b.start,a=b.length;while(--a>=0){d[e+a]=f.objectAt(a)}if(this._requestingIndex<=0){this.arrayContentDidChange(b.start,b.length,b.length)}return this},provideObjectAtIndex:function(d,b){var e=this._TMP_PROVIDE_ARRAY,a=this._TMP_PROVIDE_RANGE;e[0]=b;a.start=d;return this.provideObjectsInRange(a,e)},objectsDidChangeInRange:function(a){var b=this._sa_content;if(b){if(a.start===0&&SC.maxRange(a)>=b.length){this._sa_content=null}else{var e=a.start,d=Math.min(e+a.length,b.length);while(--d>=e){b[d]=undefined}}}this.arrayContentDidChange(a.start,a.length,a.length);return this},indexOf:function(d){var e,b,a=this.delegate;if(a&&a.sparseArrayDidRequestIndexOf){b=a.sparseArrayDidRequestIndexOf(this,d)}if(SC.none(b)){e=this._sa_content;if(!e){e=this._sa_content=[]}b=e.indexOf(d)}return b},replace:function(b,h,f){f=f||[];var d=this.delegate;if(d){if(!d.sparseArrayShouldReplace||!d.sparseArrayShouldReplace(this,b,h,f)){return this}}var e=this._sa_content;if(!e){e=this._sa_content=[]}e.replace(b,h,f);var a=f?(f.get?f.get("length"):f.length):0;var g=a-h;this.arrayContentWillChange(b,h,a);if(!SC.none(this._length)){this.propertyWillChange("length");this._length+=g;this.propertyDidChange("length")}this.beginPropertyChanges();this.arrayContentDidChange(b,h,a);this.enumerableContentDidChange(b,h,g);this.endPropertyChanges();return this},reset:function(){var a;this._sa_content=null;a=this._length;this._length=null;this.arrayContentDidChange(0,a,0);this.invokeDelegateMethod(this.delegate,"sparseArrayDidReset",this);return this}});SC.SparseArray.array=function(a){return this.create({_length:a||0})};SC.Timer=SC.Object.extend({target:null,action:null,isPooled:NO,interval:0,startTime:null,repeats:NO,until:null,isPaused:NO,isScheduled:NO,isValid:YES,lastFireTime:0,fireTime:function(){if(!this.get("isValid")){return -1}var f=this.get("startTime");if(!f||f===0){return -1}var a=this.get("interval"),d=this.get("lastFireTime");if(d<f){d=f}var b;if(this.get("repeats")){if(a===0){b=d}else{b=f+(Math.floor((d-f)/a)+1)*a}}else{b=f+a}var e=this.get("until");if(e&&e>0&&b>e){b=e}return b}.property("interval","startTime","repeats","until","isValid","lastFireTime").cacheable(),schedule:function(){if(!this.get("isValid")){return this}this.beginPropertyChanges();if(!this.startTime){this.set("startTime",SC.RunLoop.currentRunLoop.get("startTime"))}var a=this.get("fireTime"),b=this.get("lastFireTime");if(a>=b){this.set("isScheduled",YES);SC.RunLoop.currentRunLoop.scheduleTimer(this,a)}this.endPropertyChanges();return this},invalidate:function(){this.beginPropertyChanges();this.set("isValid",NO);var a=SC.RunLoop.currentRunLoop;if(a){a.cancelTimer(this)}this.action=this.target=null;this.endPropertyChanges();if(this.get("isPooled")){SC.Timer.returnTimerToPool(this)}return this},fire:function(){var b=Date.now();this.set("lastFireTime",b);var a=this.get("fireTime");if(!this.get("isPaused")){this.performAction()}if(a>b){this.schedule()}else{this.invalidate()}},performAction:function(){var a=SC.typeOf(this.action);if(a==SC.T_FUNCTION){this.action.call((this.target||this),this)}else{if(a===SC.T_STRING){if(this.action.indexOf(".")>=0){var f=this.action.split(".");var d=f.pop();var e=SC.objectForPropertyPath(f,window);var b=e.get?e.get(d):e[d];if(b&&SC.typeOf(b)==SC.T_FUNCTION){b.call(e,this)}else{throw"%@: Timer could not find a function at %@".fmt(this,this.action)}}else{SC.RootResponder.responder.sendAction(this.action,this.target,this)}}}},init:function(){arguments.callee.base.apply(this,arguments);if(this.startTime instanceof Date){this.startTime=this.startTime.getTime()}if(this.until instanceof Date){this.until=this.until.getTime()}},RESET_DEFAULTS:{target:null,action:null,isPooled:NO,isPaused:NO,isScheduled:NO,isValid:YES,interval:0,repeats:NO,until:null,startTime:null,lastFireTime:0},reset:function(b){if(!b){b=SC.EMPTY_HASH}this.propertyWillChange("fireTime");var d=this.RESET_DEFAULTS;for(var a in d){if(!d.hasOwnProperty(a)){continue}this[a]=SC.none(b[a])?d[a]:b[a]}this.propertyDidChange("fireTime");return this},removeFromTimerQueue:function(d){var b=this._timerQueuePrevious,a=this._timerQueueNext;if(!b&&!a&&d!==this){return d}if(b){b._timerQueueNext=a}if(a){a._timerQueuePrevious=b}this._timerQueuePrevious=this._timerQueueNext=null;return(d===this)?a:d},scheduleInTimerQueue:function(d,b){this._timerQueueRunTime=b;var a=d;var e=null;while(a&&a._timerQueueRunTime<b){e=a;a=a._timerQueueNext}if(e){e._timerQueueNext=this;this._timerQueuePrevious=e}if(a){a._timerQueuePrevious=this;this._timerQueueNext=a}return(a===d)?this:d},collectExpiredTimers:function(d,a){if(this._timerQueueRunTime>a){return this}d.push(this);var b=this._timerQueueNext;this._timerQueueNext=null;if(b){b._timerQueuePrevious=null}return b?b.collectExpiredTimers(d,a):null}});SC.Timer.schedule=function(a){var b;if(!a||SC.none(a.isPooled)||a.isPooled){b=this.timerFromPool(a)}else{b=this.create(a)}return b.schedule()};SC.Timer.timerFromPool=function(a){var b=this._timerPool;if(!b){b=this._timerPool=[]}var d=b.pop();if(!d){d=this.create()}return d.reset(a)};SC.Timer.returnTimerToPool=function(a){if(!this._timerPool){this._timerPool=[]}this._timerPool.push(a);return this};sc_require("system/browser");SC.mixin({normalizeURL:function(a){if(a.slice(0,1)=="/"){a=window.location.protocol+"//"+window.location.host+a}else{if((a.slice(0,5)=="http:")||(a.slice(0,6)=="https:")){}else{a=window.location.href+"/"+a}}return a},isPercentage:function(a){return(a<1&&a>0)},minX:function(a){return a.x||0},maxX:function(a){return(a.x||0)+(a.width||0)},midX:function(a){return(a.x||0)+((a.width||0)/2)},minY:function(a){return a.y||0},maxY:function(a){return(a.y||0)+(a.height||0)},midY:function(a){return(a.y||0)+((a.height||0)/2)},centerX:function(b,a){return(a.width-b.width)/2},centerY:function(b,a){return(a.height-b.height)/2},offset:function(f,d){var g,b,j,a;d=d||"document";if(d==="parent"){a=jQuery(f).position()}else{a=jQuery(f).offset();if(SC.browser.isMobileSafari){g=navigator.userAgent;b=g.indexOf("Mobile/");j=g.substring(b+7,b+9);if(parseInt(SC.browser.mobileSafari,0)<=532||(j<="8A")){a.left-=window.pageXOffset;a.top-=window.pageYOffset}}if(d==="viewport"){if(SC.browser.isIE8OrLower){a.left-=$(window).scrollLeft();a.top-=$(window).scrollTop()}else{a.left-=window.pageXOffset;a.top-=window.pageYOffset}}}try{a.x=a.left;a.y=a.top}catch(h){a={x:a.left,y:a.top}}delete a.left;delete a.top;return a},viewportOffset:function(b){var a=SC.offset(b,"viewport");return{x:a.left,y:a.top}}});SC.mixin({ZERO_POINT:{x:0,y:0},pointInRect:function(a,b){return(a.x>=SC.minX(b))&&(a.y>=SC.minY(b))&&(a.x<=SC.maxX(b))&&(a.y<=SC.maxY(b))},rectsEqual:function(b,a,d){if(!b||!a){return(b==a)}if(!d&&d!==0){d=0.1}if((b.y!=a.y)&&(Math.abs(b.y-a.y)>d)){return NO}if((b.x!=a.x)&&(Math.abs(b.x-a.x)>d)){return NO}if((b.width!=a.width)&&(Math.abs(b.width-a.width)>d)){return NO}if((b.height!=a.height)&&(Math.abs(b.height-a.height)>d)){return NO}return YES},intersectRects:function(b,a){var d={x:Math.max(SC.minX(b),SC.minX(a)),y:Math.max(SC.minY(b),SC.minY(a)),width:Math.min(SC.maxX(b),SC.maxX(a)),height:Math.min(SC.maxY(b),SC.maxY(a))};d.width=Math.max(0,d.width-d.x);d.height=Math.max(0,d.height-d.y);return d},unionRects:function(b,a){var d={x:Math.min(SC.minX(b),SC.minX(a)),y:Math.min(SC.minY(b),SC.minY(a)),width:Math.max(SC.maxX(b),SC.maxX(a)),height:Math.max(SC.maxY(b),SC.maxY(a))};d.width=Math.max(0,d.width-d.x);d.height=Math.max(0,d.height-d.y);return d},cloneRect:function(a){return{x:a.x,y:a.y,width:a.width,height:a.height}},stringFromRect:function(a){if(!a){return"(null)"}else{return"{x:"+a.x+", y:"+a.y+", width:"+a.width+", height:"+a.height+"}"}}});sc_require("panes/pane");sc_require("panes/keyboard");sc_require("panes/layout");sc_require("panes/manipulation");sc_require("panes/visibility");SC.MainPane=SC.Pane.extend({layout:{top:0,left:0,bottom:0,right:0,minHeight:200,minWidth:200},init:function(){var d={x:0,y:0,width:1000,height:1000},a=this.get("layout"),b=false;if(document&&document.body){d.width=document.body.clientWidth;d.height=document.body.clientHeight;if(a.minHeight||a.minWidth){if((a.minHeight&&d.height<a.minHeight)||(a.minWidth&&d.width<a.minWidth)){SC.bodyOverflowArbitrator.requestVisible(this)}else{SC.bodyOverflowArbitrator.requestHidden(this)}}}arguments.callee.base.apply(this,arguments)},paneDidAttach:function(){var b=arguments.callee.base.apply(this,arguments),a=this.rootResponder;a.makeMainPane(this);if(!a.get("keyRootView")){a.makeKeyPane(this)}return b},acceptsKeyPane:YES,classNames:["sc-main"]});SC.routes=SC.Object.create({wantsHistory:NO,usesHistory:null,baseURI:document.baseURI,_didSetup:NO,_location:null,_firstRoute:null,_extractParametersAndRoute:function(e,b){var a={},k=e.route||"",g,d,f,j,h,l;g=(k.indexOf("?")<0&&k.indexOf("&")>=0)?"&":"?";d=k.split(g);k=d.shift();a=this.deparam(d.join("&"),b||false);for(l in e){if(e.hasOwnProperty(l)&&l!=="route"){a[l]=""+e[l]}}a.params=g+$.param(a);a.route=k;return a},location:function(a,b){this._skipRoute=NO;return this._extractLocation(a,b)}.property(),informLocation:function(a,b){this._skipRoute=YES;var d=this.location.lastSetValueKey;if(d&&this._kvo_cache){this._kvo_cache[d]=b}return this._extractLocation(a,b)}.property(),_extractLocation:function(d,e){var a,b;if(e!==undefined){if(e===null){e=""}if(typeof(e)==="object"){a=this._extractParametersAndRoute(e);e=a.route+a.params}if(!SC.empty(e)||(this._location&&this._location!==e)){b=encodeURI(e);if(this.usesHistory){if(b.length>0){b="/"+b}window.history.pushState(null,null,this.get("baseURI")+b)}else{window.location.hash=b}}this._location=e}return this._location},ping:function(){var a;if(!this._didSetup){this._didSetup=YES;if(this.get("wantsHistory")&&SC.platform.supportsHistory){this.usesHistory=YES;this.popState();SC.Event.add(window,"popstate",this,this.popState)}else{this.usesHistory=NO;if(SC.platform.supportsHashChange){this.hashChange();SC.Event.add(window,"hashchange",this,this.hashChange)}else{a=this;this._invokeHashChange=function(){a.hashChange();setTimeout(a._invokeHashChange,100)};this._invokeHashChange()}}}},hashChange:function(a){var b=window.location.hash;b=(b&&b.length>0)?b.slice(1,b.length):"";if(!SC.browser.isMozilla){b=decodeURI(b)}if(this.get("location")!==b&&!this._skipRoute){SC.run(function(){this.set("location",b)},this)}this._skipRoute=false},popState:function(a){var b=this.get("baseURI"),d=document.location.href;if(d.slice(0,b.length)===b){d=d.slice(b.length+1,d.length);if(this.get("location")!==d&&!this._skipRoute){SC.run(function(){this.set("location",d)},this)}}this._skipRoute=false},add:function(a,b,d){if(!this._didSetup){this.invokeLast(this.ping)}if(d===undefined&&SC.typeOf(b)===SC.T_FUNCTION){d=b;b=null}else{if(SC.typeOf(d)===SC.T_STRING){d=b[d]}}if(!this._firstRoute){this._firstRoute=this._Route.create()}this._firstRoute.add(a.split("/"),b,d);return this},locationDidChange:function(){this.trigger()}.observes("location"),trigger:function(){var a=this._firstRoute,b=this.get("location"),e,d;if(a){e=this._extractParametersAndRoute({route:b});b=e.route;delete e.route;delete e.params;d=a.routeForParts(b.split("/"),e);if(d&&d.method){d.method.call(d.target||this,e)}}},deparam:function(l,h){var k={},b={"true":!0,"false":!1,"null":null},g=l.replace(/\+/g," ").split("&"),m=g.length,o,e,q,d,p,j,s,n,f=decodeURIComponent,a=Object.prototype.toString;for(o=0;o<m;++o){e=g[o].split("="),q=f(e[0]),p=k,s=q.split("]["),n=q.length-1;if(/\[/.test(s[0])&&/\]$/.test(s[n])){s[n]=s[n].replace(/\]$/,"");s=s.shift().split("[").concat(s);n=s.length-1}else{n=0}if(e.length===2){d=f(e[1]);if(h){d=d&&!isNaN(d)?+d:d==="undefined"?undefined:b[d]!==undefined?b[d]:d}if(n){for(j=0;j<n;++j){q=s[j]===""?p.length:s[j];p=p[q]=j<n?p[q]||(s[j+1]&&isNaN(s[j+1])?{}:[]):d}}else{if(a.apply(k[q])==="[object Array]"){k[q].push(d)}else{if(k[q]!==undefined){k[q]=[k[q],d]}else{k[q]=d}}}}else{if(q){k[q]=h?undefined:""}}}return k},_Route:SC.Object.extend({target:null,method:null,staticRoutes:null,dynamicRoutes:null,wildcardRoutes:null,add:function(d,b,f){var a,e;d=SC.clone(d);if(!d||d.length===0){this.target=b;this.method=f}else{a=d.shift();switch(a.slice(0,1)){case":":a=a.slice(1,a.length);if(!this.dynamicRoutes){this.dynamicRoutes={}}if(!this.dynamicRoutes[a]){this.dynamicRoutes[a]=this.constructor.create()}e=this.dynamicRoutes[a];break;case"*":a=a.slice(1,a.length);if(!this.wildcardRoutes){this.wildcardRoutes={}}e=this.wildcardRoutes[a]=this.constructor.create();break;default:if(!this.staticRoutes){this.staticRoutes={}}if(!this.staticRoutes[a]){this.staticRoutes[a]=this.constructor.create()}e=this.staticRoutes[a]}if(e){e.add(d,b,f)}}},routeForParts:function(e,f){var b,d,a;e=SC.clone(e);if(!e||e.length===0){return this.method?this:null}else{b=e.shift();if(this.staticRoutes&&this.staticRoutes[b]){return this.staticRoutes[b].routeForParts(e,f)}else{for(d in this.dynamicRoutes){a=this.dynamicRoutes[d].routeForParts(e,f);if(a){f[d]=b;return a}}for(d in this.wildcardRoutes){e.unshift(b);f[d]=e.join("/");return this.wildcardRoutes[d].routeForParts(null,f)}return null}}}})});SC.SCANNER_OUT_OF_BOUNDS_ERROR=new Error("Out of bounds.");SC.SCANNER_INT_ERROR=new Error("Not an int.");SC.SCANNER_SKIP_ERROR=new Error("Did not find the string to skip.");SC.SCANNER_SCAN_ARRAY_ERROR=new Error("Did not find any string of the given array to scan.");SC.DATETIME_COMPAREDATE_TIMEZONE_ERROR=new Error("Can't compare the dates of two DateTimes that don't have the same timezone.");SC.DATETIME_ISO8601="%Y-%m-%dT%H:%M:%S%Z";SC.Scanner=SC.Object.extend({string:null,scanLocation:0,scan:function(a){if(this.scanLocation+a>this.length){throw SC.SCANNER_OUT_OF_BOUNDS_ERROR}var b=this.string.substr(this.scanLocation,a);this.scanLocation+=a;return b},scanInt:function(d,f){if(f===undefined){f=d}var e=this.scan(f);var b=new RegExp("^\\d{"+d+","+f+"}");var a=e.match(b);if(!a){throw SC.SCANNER_INT_ERROR}if(a[0].length<f){this.scanLocation+=a[0].length-f}return parseInt(a[0],10)},skipString:function(a){if(this.scan(a.length)!==a){throw SC.SCANNER_SKIP_ERROR}return YES},scanArray:function(d){for(var b=0,a=d.length;b<a;b++){if(this.scan(d[b].length)===d[b]){return b}this.scanLocation-=d[b].length}throw SC.SCANNER_SCAN_ARRAY_ERROR}});SC.DateTime=SC.Object.extend(SC.Freezable,SC.Copyable,{_ms:0,timezone:0,isFrozen:YES,adjust:function(b,a){var d;b=b?SC.clone(b):{};d=(b.timezone!==undefined)?b.timezone:(this.timezone!==undefined)?this.timezone:0;return this.constructor._adjust(b,this._ms,d,a)._createFromCurrentState()},advance:function(a){return this.constructor._advance(a,this._ms,this.timezone)._createFromCurrentState()},unknownProperty:function(a){return this.constructor._get(a,this._ms,this.timezone)},toFormattedString:function(a){return this.constructor._toFormattedString(a,this._ms,this.timezone)},toISO8601:function(){return this.constructor._toFormattedString(SC.DATETIME_ISO8601,this._ms,this.timezone)},toString:function(){return"UTC: "+new Date(this._ms).toUTCString()+", timezone: "+this.timezone},isEqual:function(a){return this.constructor.compare(this,a)===0},copy:function(){return this},toTimezone:function(a){if(a===undefined){a=0}return this.advance({timezone:a-this.timezone})}});SC.DateTime.mixin(SC.Comparable,{recordFormat:SC.DATETIME_ISO8601,dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],_englishDayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],AMPMNames:["AM","PM"],_date:new Date(),_tz:0,timezone:new Date().getTimezoneOffset(),_dt_cache:{},_dt_cache_index:-1,_DT_CACHE_MAX_LENGTH:1000,_setCalcState:function(a,d){var b={milliseconds:this._date.getTime(),timezone:this._tz};if(a!==undefined){this._date.setTime(a)}if(d!==undefined){this._tz=d}return b},_setCalcStateFromHash:function(d,b){var e=(b!==undefined)?b:this._tz;var a=this._toMilliseconds(d,this._ms,e);return this._setCalcState(a,e)},_get:function(z,b,p){var o,w,j,q,f,l,n,g,s,a;var e,k;var u=this._date;var t,h=null;t=this._setCalcState(b,p);if(z==="milliseconds"){h=u.getTime()}else{if(z==="timezone"){h=this._tz}}if(h===null){s=z.slice(0,4);a=z.slice(4);if(s==="last"||s==="next"){e=this._get("dayOfWeek",b,p);k=this._englishDayNames.indexOf(a);if(k>=0){var x=k-e;if(s==="last"&&x>=0){x-=7}if(s==="next"&&x<0){x+=7}this._advance({day:x},b,p);h=this._createFromCurrentState()}}}if(h===null){if(p!==undefined){this._setCalcState(u.getTime()-(p*60000),0)}switch(z){case"year":h=u.getUTCFullYear();break;case"month":h=u.getUTCMonth()+1;break;case"day":h=u.getUTCDate();break;case"dayOfWeek":h=u.getUTCDay();break;case"hour":h=u.getUTCHours();break;case"minute":h=u.getUTCMinutes();break;case"second":h=u.getUTCSeconds();break;case"millisecond":h=u.getUTCMilliseconds();break}if((h===null)&&(z==="isLeapYear")){f=this._get("year");h=(f%4===0&&f%100!==0)||f%400===0}if((h===null)&&(z==="daysInMonth")){switch(this._get("month")){case 4:case 6:case 9:case 11:h=30;break;case 2:h=this._get("isLeapYear")?29:28;break;default:h=31;break}}if((h===null)&&(z==="dayOfYear")){o=u.getTime();j=this._get("day");this._setCalcStateFromHash({day:1});for(q=this._get("month")-1;q>0;q--){this._setCalcStateFromHash({month:q});j+=this._get("daysInMonth")}u.setTime(o);h=j}if((h===null)&&(z.slice(0,4)==="week")){l=z.length===4?1:parseInt(z.slice("4"),10);n=this._get("dayOfWeek");g=this._get("dayOfYear")-1;if(l===0){h=parseInt((g-n+7)/7,10)}else{h=parseInt((g-(n-1+7)%7+7)/7,10)}}}this._setCalcState(t.milliseconds,t.timezone);return h},_adjust:function(d,g,f,a){var e=d?SC.clone(d):{};var b=this._toMilliseconds(d,g,f,a);this._setCalcState(b,f);return this},_advance:function(a,g,e){var d=a?SC.clone(a):{};var f;for(var b in d){d[b]+=this._get(b,g,e)}f=(d.timezone!==undefined)?d.timezone:e;return this._adjust(d,g,f,NO)},_toMilliseconds:function(l,e,j,g){var a=l?SC.clone(l):{};var k=this._date;var h=k.getTime();var b,f;if(!SC.none(e)){k.setTime(e)}f=(j!==undefined)?j:(this.timezone!==undefined)?this.timezone:0;k.setTime(k.getTime()-(f*60000));if(g===undefined||g===YES){if(!SC.none(a.hour)&&SC.none(a.minute)){a.minute=0}if(!(SC.none(a.hour)&&SC.none(a.minute))&&SC.none(a.second)){a.second=0}if(!(SC.none(a.hour)&&SC.none(a.minute)&&SC.none(a.second))&&SC.none(a.millisecond)){a.millisecond=0}}if(SC.none(a.year)){a.year=k.getUTCFullYear()}if(SC.none(a.month)){a.month=k.getUTCMonth()+1}if(SC.none(a.day)){a.day=k.getUTCDate()}if(SC.none(a.hour)){a.hour=k.getUTCHours()}if(SC.none(a.minute)){a.minute=k.getUTCMinutes()}if(SC.none(a.second)){a.second=k.getUTCSeconds()}if(SC.none(a.millisecond)){a.millisecond=k.getUTCMilliseconds()}b=Date.UTC(a.year,a.month-1,a.day,a.hour,a.minute,a.second,a.millisecond);k.setTime(b+(f*60000));b=k.getTime();k.setTime(h);return b},create:function(){var k=arguments.length===0?{}:arguments[0];var e;if(SC.typeOf(k)===SC.T_NUMBER){k={milliseconds:k}}e=(k.timezone!==undefined)?k.timezone:this.timezone;if(e===undefined){e=0}if(!SC.none(k.milliseconds)){var j="nu"+k.milliseconds+e,a=this._dt_cache;var f=a[j];if(!f){var g,h=this._dt_cache_index,b=this;f=a[j]=new b([{_ms:k.milliseconds,timezone:e}]);h=this._dt_cache_index=(h+1)%this._DT_CACHE_MAX_LENGTH;g=a[h];if(g!==undefined&&a[g]){delete a[g]}a[h]=j}return f}else{var d=new Date();return this.create({milliseconds:this._toMilliseconds(k,d.getTime(),e,k.resetCascadingly),timezone:e})}},_createFromCurrentState:function(){return this.create({milliseconds:this._date.getTime(),timezone:this._tz})},parse:function(q,f){var s=new RegExp("(?:%([aAbBcdDhHiIjmMpsSUWwxXyYZ%])|(.))","g");var p,l,a={},b={},k=SC.Scanner.create({string:q});if(SC.none(f)){f=SC.DATETIME_ISO8601}try{while((l=s.exec(f))!==null){switch(l[1]){case"a":b.dayOfWeek=k.scanArray(this.abbreviatedDayNames);break;case"A":b.dayOfWeek=k.scanArray(this.dayNames);break;case"b":a.month=k.scanArray(this.abbreviatedMonthNames)+1;break;case"B":a.month=k.scanArray(this.monthNames)+1;break;case"c":throw"%c is not implemented";case"d":case"D":a.day=k.scanInt(1,2);break;case"h":case"H":a.hour=k.scanInt(1,2);break;case"i":case"I":a.hour=k.scanInt(1,2);break;case"j":throw"%j is not implemented";case"m":a.month=k.scanInt(1,2);break;case"M":a.minute=k.scanInt(1,2);break;case"p":a.meridian=k.scanArray(this.AMPMNames);break;case"S":a.second=k.scanInt(1,2);break;case"s":a.millisecond=k.scanInt(1,3);break;case"U":throw"%U is not implemented";case"W":throw"%W is not implemented";case"w":throw"%w is not implemented";case"x":throw"%x is not implemented";case"X":throw"%X is not implemented";case"y":a.year=k.scanInt(2);a.year+=(a.year>70?1900:2000);break;case"Y":a.year=k.scanInt(4);break;case"Z":var j=k.scan(1);if(j==="Z"){a.timezone=0}else{if(j==="+"||j==="-"){var n=k.scanInt(2);if(k.scan(1)!==":"){k.scan(-1)}var g=k.scanInt(2);a.timezone=(j==="+"?-1:1)*(n*60+g)}}break;case"%":k.skipString("%");break;default:k.skipString(l[0]);break}}}catch(o){SC.Logger.log("SC.DateTime.createFromString "+o.toString());return null}if(!SC.none(a.meridian)&&!SC.none(a.hour)){if((a.meridian===1&&a.hour!==12)||(a.meridian===0&&a.hour===12)){a.hour=(a.hour+12)%24}delete a.meridian}p=this.create(a);if(!SC.none(b.dayOfWeek)&&p.get("dayOfWeek")!==b.dayOfWeek){return null}return p},_pad:function(b,a){var d=""+b;if(a===undefined){a=2}while(d.length<a){d="0"+d}return d},__toFormattedString:function(b,f,d){var a,e;switch(b[1]){case"a":return this.abbreviatedDayNames[this._get("dayOfWeek")];case"A":return this.dayNames[this._get("dayOfWeek")];case"b":return this.abbreviatedMonthNames[this._get("month")-1];case"B":return this.monthNames[this._get("month")-1];case"c":return this._date.toString();case"d":return this._pad(this._get("day"));case"D":return this._get("day");case"h":return this._get("hour");case"H":return this._pad(this._get("hour"));case"i":a=this._get("hour");return(a===12||a===0)?12:(a+12)%12;case"I":a=this._get("hour");return this._pad((a===12||a===0)?12:(a+12)%12);case"j":return this._pad(this._get("dayOfYear"),3);case"m":return this._pad(this._get("month"));case"M":return this._pad(this._get("minute"));case"p":return this._get("hour")>11?this.AMPMNames[1]:this.AMPMNames[0];case"S":return this._pad(this._get("second"));case"s":return this._pad(this._get("millisecond"),3);case"u":return this._pad(this._get("utc"));case"U":return this._pad(this._get("week0"));case"W":return this._pad(this._get("week1"));case"w":return this._get("dayOfWeek");case"x":return this._date.toDateString();case"X":return this._date.toTimeString();case"y":return this._pad(this._get("year")%100);case"Y":return this._get("year");case"Z":e=-1*d;return(e>=0?"+":"-")+this._pad(parseInt(Math.abs(e)/60,10))+":"+this._pad(Math.abs(e)%60);case"%":return"%"}},_toFormattedString:function(d,f,b){var a=this;var e=(b!==undefined)?b:(this.timezone!==undefined)?this.timezone:0;this._setCalcState(f-(b*60000),0);return d.replace(/\%([aAbBcdDhHiIjmMpsSUWwxXyYZ\%])/g,function(){var g=a.__toFormattedString.call(a,arguments,f,b);return g})},compare:function(e,d){var g=e.get("milliseconds");var f=d.get("milliseconds");return g<f?-1:g===f?0:1},compareDate:function(e,d){if(e.get("timezone")!==d.get("timezone")){throw SC.DATETIME_COMPAREDATE_TIMEZONE_ERROR}var g=e.adjust({hour:0}).get("milliseconds");var f=d.adjust({hour:0}).get("milliseconds");return g<f?-1:g===f?0:1}});SC.Binding.dateTime=function(a){return this.transform(function(b,d){return b?b.toFormattedString(a):null})};SC.stringsFor("English",{"_SC.DateTime.dayNames":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday","_SC.DateTime.abbreviatedDayNames":"Sun Mon Tue Wed Thu Fri Sat","_SC.DateTime.monthNames":"January February March April May June July August September October November December","_SC.DateTime.abbreviatedMonthNames":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec","_SC.DateTime.AMPMNames":"AM PM"});SC.DateTime.mixin({_setup:function(){SC.DateTime.dayNames=SC.String.w(SC.String.loc("_SC.DateTime.dayNames"));SC.DateTime.abbreviatedDayNames=SC.String.w(SC.String.loc("_SC.DateTime.abbreviatedDayNames"));SC.DateTime.monthNames=SC.String.w(SC.String.loc("_SC.DateTime.monthNames"));SC.DateTime.abbreviatedMonthNames=SC.String.w(SC.String.loc("_SC.DateTime.abbreviatedMonthNames"));SC.DateTime.AMPMNames=SC.String.w(SC.String.loc("_SC.DateTime.AMPMNames"))}});jQuery(document).ready(function(){SC.DateTime._setup()});SC.Response=SC.Object.extend({isResponse:YES,isError:NO,errorValue:function(){return this}.property().cacheable(),errorObject:null,request:null,originalRequest:function(){var a=this.get("request");while(a.get("source")){a=a.get("source")}return a}.property("request").cacheable(),type:function(){return this.getPath("request.type")}.property("request").cacheable(),address:function(){return this.getPath("request.address")}.property("request").cacheable(),isJSON:function(){return this.getPath("request.isJSON")||NO}.property("request").cacheable(),isXML:function(){return this.getPath("request.isXML")||NO}.property("request").cacheable(),listeners:function(){return this.getPath("request.listeners")}.property("request").cacheable(),status:-100,headers:null,body:function(){var a=this.get("encodedBody");if(a&&this.get("isJSON")){try{a=SC.json.decode(a)}catch(b){return SC.Error.create({message:b.name+": "+b.message,label:"Response",errorValue:this})}}return a}.property("encodedBody").cacheable(),response:function(){return this.get("body")}.property("body").cacheable(),isCancelled:NO,timedOut:null,timeoutTimer:null,fire:function(){var a=this.get("request"),d=a?a.get("source"):null;if(d&&d.willSend){d.willSend(a,this)}a.freeze();if(!this.get("isCancelled")){this.invokeTransport()}var b=a.get("timeout");if(b){var e=SC.Timer.schedule({target:this,action:"timeoutReached",interval:b,repeats:NO});this.set("timeoutTimer",e)}if(!this.get("isCancelled")&&d&&d.didSend){d.didSend(a,this)}},invokeTransport:function(){this.receive(function(a){this.set("status",200)},this)},receive:function(f,a){if(!this.get("timedOut")){var e=this.get("timeoutTimer");if(e){e.invalidate()}this.set("timedOut",NO)}var b=this.get("request");var d=b?b.get("source"):null;SC.run(function(){if(d&&d.willReceive){d.willReceive(b,this)}f.call(a,!this.get("isCancelled"));if(!this.get("isCancelled")&&d&&d.didReceive){d.didReceive(b,this)}if(!this.get("isCancelled")){this.notify()}},this);SC.Request.manager.transportDidClose(this);return this},cancel:function(){if(!this.get("isCancelled")){this.set("isCancelled",YES);this.cancelTransport();SC.Request.manager.transportDidClose(this)}},timeoutReached:function(){if(this.get("timedOut")===null){this.set("timedOut",YES);this.cancelTransport();this.receive(function(b){if(!b){return}var a=SC.$error("HTTP Request timed out","Request",0);a.set("errorValue",this);this.set("isError",YES);this.set("errorObject",a);this.set("status",0)},this);return YES}return NO},cancelTransport:function(){},_notifyListeners:function(j,b){var k=j[b],h,g,a;if(!k){return NO}var e=NO;var f=k.length;for(var d=0;d<f;d++){var l=k[d];h=(l.args||[]).copy();h.unshift(this);g=l.target;a=l.action;if(SC.typeOf(a)===SC.T_STRING){a=g[a]}e=a.apply(g,h)}return e},notify:function(){var b=this.get("listeners"),a=this.get("status"),d=Math.floor(a/100)*100,e=NO;if(!b){return this}e=this._notifyListeners(b,a);if(!e&&d!==a){e=this._notifyListeners(b,d)}if(!e&&a!==0){e=this._notifyListeners(b,0)}return this},toString:function(){var a=arguments.callee.base.apply(this,arguments);return"%@<%@ %@, status=%@".fmt(a,this.get("type"),this.get("address"),this.get("status"))}});SC.XHRResponse=SC.Response.extend({headers:function(){var d=this.get("rawRequest"),b=d?d.getAllResponseHeaders():null,a={};if(!b){return a}b.split("\n").forEach(function(h){var e=h.indexOf(":"),f,g;if(e>=0){f=h.slice(0,e);g=h.slice(e+1).trim();a[f]=g}},this);return a}.property("status").cacheable(),header:function(a){var b=this.get("rawRequest");return b?b.getResponseHeader(a):null},encodedBody:function(){var a=this.get("rawRequest");if(!a){return null}if(this.get("isXML")){return a.responseXML}return a.responseText}.property("status").cacheable(),cancelTransport:function(){var a=this.get("rawRequest");if(a){a.abort()}this.set("rawRequest",null)},invokeTransport:function(){var e,o,b,h,j=this.get("request"),f,a,g,d;h=this.createRequest();this.set("rawRequest",h);g=!!j.get("isAsynchronous");if(g){if(window.XMLHttpRequestProgressEvent){o=j.get("listeners");if(o){for(var p in o){if(isNaN(parseInt(p,10))){b=o[p];for(var l=0,m=b.length;l<m;l++){e=b[l];var n=p.split(".");if(SC.none(n[1])){SC.Event.add(h,n[0],e.target,e.action,e.args)}else{SC.Event.add(h[n[0]],n[1],e.target,e.action,e.args)}}}}}SC.Event.add(h,"loadend",this,this.finishRequest)}else{if(window.XMLHttpRequest&&h.addEventListener){SC.Event.add(h,"readystatechange",this,this.finishRequest)}else{f=this;a=function(){if(!f){return null}var q=f.finishRequest();if(q){f=null}return q};h.onreadystatechange=a}}}h.open(this.get("type"),this.get("address"),g);d=this.getPath("request.headers");for(var k in d){h.setRequestHeader(k,d[k])}h.send(this.getPath("request.encodedBody"));if(!g){this.finishRequest()}return h},createRequest:function(){var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{try{a=new ActiveXObject("MSXML2.XMLHTTP.6.0")}catch(b){}try{if(!a){a=new ActiveXObject("MSXML2.XMLHTTP")}}catch(b){}}return a},finishRequest:function(p){var d,m,a,f=this.get("rawRequest"),j=f.readyState,g,n,e,b;if(j===4&&!this.get("timedOut")){this.receive(function(q){if(!q){return}e=-1;try{e=f.status||0}catch(t){}if((e<200)||(e>=300)){try{b=f.statusText||""}catch(s){b=""}n=SC.$error(b||"HTTP Request failed","Request",e);n.set("errorValue",this);this.set("isError",YES);this.set("errorObject",n)}this.set("status",e)},this);if(window.XMLHttpRequestProgressEvent){SC.Event.remove(f,"loadend",this,this.finishRequest);g=this.get("request");m=g.get("listeners");if(m){for(var o in m){if(isNaN(parseInt(o,10))){a=m[o];for(var h=0,k=a.length;h<k;h++){d=a[h];var l=o.split(".");if(SC.none(l[1])){SC.Event.remove(f,l[0],d.target,d.action,d.args)}else{SC.Event.remove(f[l[0]],l[1],d.target,d.action,d.args)}}}}}}else{if(window.XMLHttpRequest&&f.addEventListener){SC.Event.remove(f,"readystatechange",this,this.finishRequest)}else{f.onreadystatechange=null}}return YES}return NO}});sc_require("system/response");SC.Request=SC.Object.extend(SC.Copyable,SC.Freezable,{isAsynchronous:YES,isJSON:NO,isXML:NO,attachIdentifyingHeaders:YES,headers:function(){var a=this._headers;if(!a){a=this._headers={}}return a}.property().cacheable(),responseClass:SC.XHRResponse,source:null,address:null,type:"GET",timeout:null,body:null,encodedBody:function(){var a=this.get("body");if(a&&this.get("isJSON")){a=SC.json.encode(a)}return a}.property("isJSON","isXML","body").cacheable(),willSend:function(b,a){},didSend:function(b,a){},willReceive:function(b,a){},didReceive:function(b,a){},concatenatedProperties:"COPY_KEYS",COPY_KEYS:["attachIdentifyingHeaders","isAsynchronous","isJSON","isXML","address","type","timeout","body","responseClass","willSend","didSend","willReceive","didReceive"],copy:function(){var a={},e=this.COPY_KEYS,g=e.length,b,d,f;while(--g>=0){b=e[g];if(this.hasOwnProperty(b)){a[b]=this.get(b)}}if(this.hasOwnProperty("listeners")){a.listeners=SC.copy(this.get("listeners"))}if(this.hasOwnProperty("_headers")){a._headers=SC.copy(this._headers)}a.source=this.get("source")||this;return this.constructor.create(a)},header:function(a,b){var e,d;if(SC.typeOf(a)===SC.T_STRING){d=this._headers;if(arguments.length===1){return d?d[a]:null}else{this.propertyWillChange("headers");if(!d){d=this._headers={}}d[a]=b;this.propertyDidChange("headers");return this}}else{if(b===undefined){d=a;this.beginPropertyChanges();for(e in d){if(!d.hasOwnProperty(e)){continue}this.header(e,d[e])}this.endPropertyChanges();return this}}return this},clearHeaders:function(){this.propertyWillChange("headers");this._headers={};this.propertyDidChange("headers")},async:function(a){if(a===undefined){a=YES}return this.set("isAsynchronous",a)},timeoutAfter:function(a){return this.set("timeout",a)},json:function(a){if(a===undefined){a=YES}if(a){this.set("isXML",NO)}return this.set("isJSON",a)},xml:function(a){if(a===undefined){a=YES}if(a){this.set("isJSON",NO)}return this.set("isXML",a)},_prep:function(){var a=!!this.header("Content-Type");if(this.get("attachIdentifyingHeaders")){this.header("X-Requested-With","XMLHttpRequest");this.header("X-SproutCore-Version",SC.VERSION)}if(!a&&!!this.get("body")){if(this.get("isJSON")){this.header("Content-Type","application/json")}else{if(this.get("isXML")){this.header("Content-Type","text/xml")}}}return this},send:function(a){var b=this.get("timeout");if(b&&!this.get("isAsynchronous")){throw"Timeout values cannot be used with synchronous requests"}else{if(b===0){throw"The timeout value must either not be specified or must be greater than 0"}}if(a){this.set("body",a)}return SC.Request.manager.sendRequest(this.copy()._prep())},resend:function(){var a=this.get("source")?this:this.copy()._prep();return SC.Request.manager.sendRequest(a)},notify:function(f,e,d){var a;if(SC.typeOf(f)!==SC.T_NUMBER&&SC.typeOf(f)!==SC.T_STRING){a=SC.A(arguments).slice(2);d=e;e=f;f=0}else{a=SC.A(arguments).slice(3)}var b=this.get("listeners");if(!b){this.set("listeners",b={})}if(!b[f]){b[f]=[]}b[f].push({target:e,action:d,args:a});return this}});SC.Request.mixin({getUrl:function(a){return this.create().set("address",a).set("type","GET")},postUrl:function(b,a){var d=this.create().set("address",b).set("type","POST");if(a){d.set("body",a)}return d},deleteUrl:function(a){return this.create().set("address",a).set("type","DELETE")},putUrl:function(b,a){var d=this.create().set("address",b).set("type","PUT");if(a){d.set("body",a)}return d},patchUrl:function(b,a){var d=this.create().set("address",b).set("type","PATCH");if(a){d.set("body",a)}return d}});SC.Request.manager=SC.Object.create({maxRequests:6,inflight:[],pending:[],sendRequest:function(b){if(!b){return null}var a=b.get("responseClass").create({request:b});this.get("pending").pushObject(a);this.fireRequestIfNeeded();return a},cancel:function(b){var e=this.get("pending"),d=this.get("inflight"),a;if(e.indexOf(b)>=0){this.propertyWillChange("pending");e.removeObject(b);this.propertyDidChange("pending");return YES}else{if(d.indexOf(b)>=0){b.cancel();d.removeObject(b);this.fireRequestIfNeeded();return YES}}return NO},cancelAll:function(){if(this.get("pending").length||this.get("inflight").length){this.set("pending",[]);this.get("inflight").forEach(function(a){a.cancel()});this.set("inflight",[]);return YES}return NO},fireRequestIfNeeded:function(){var e=this.get("pending"),d=this.get("inflight"),a=this.get("maxRequests"),b;if((e.length>0)&&(d.length<a)){b=e.shiftObject();d.pushObject(b);b.fire()}},transportDidClose:function(a){this.get("inflight").removeObject(a);this.fireRequestIfNeeded()}});SC.FOCUS_ALL_CONTROLS=NO;SC.ready(function(){var a=SC.SAFARI_FOCUS_BEHAVIOR;if(a!==null&&a!==undefined){SC.FOCUS_ALL_CONTROLS=SC.SAFARI_FOCUS_BEHAVIOR}});SC.TreeItemContent={isTreeItemContent:YES,treeItemChildren:null,treeItemIsExpanded:YES,treeItemIsGrouped:NO,treeItemDisclosureState:function(b,a){return this.get("treeItemIsExpanded")?SC.BRANCH_OPEN:SC.BRANCH_CLOSED},treeItemCollapse:function(b,a){this.setIfChanged("treeItemIsExpanded",NO)},treeItemExpand:function(b,a){this.setIfChanged("treeItemIsExpanded",YES)},treeItemBranchIndexes:function(f,d){var e=this.get("treeItemChildren"),b,h,a,g;if(!e){return null}b=SC.IndexSet.create();h=e.get("length");for(a=0;a<h;a++){if(!(g=e.objectAt(a))){continue}if(!g.get("treeItemChildren")){continue}if(g.treeItemDisclosureState(this,a)!==SC.LEAF_NODE){b.add(a)}}return b.get("length")>0?b:null}};SC.BRANCH_OPEN=17;SC.BRANCH_CLOSED=18;SC.LEAF_NODE=32;SC.CollectionContent={isCollectionContent:YES,contentIndexIsSelected:function(b,d,a){var e=b.get("selection");return e?e.contains(d,a):NO},contentIndexIsEnabled:function(b,d,a){return b.get("isEnabled")},contentGroupIndexes:function(a,b){return null},contentIndexIsGroup:function(b,d,a){return NO},contentIndexOutlineLevel:function(b,d,a){return -1},contentIndexDisclosureState:function(b,d,a){return SC.LEAF_NODE},contentIndexExpand:function(b,d,a){SC.Logger.log("contentIndexExpand(%@, %@, %@)".fmt(b,d,a))},contentIndexCollapse:function(b,d,a){SC.Logger.log("contentIndexCollapse(%@, %@, %@)".fmt(b,d,a))}};sc_require("mixins/tree_item_content");sc_require("mixins/collection_content");SC.TreeItemObserver=SC.Object.extend(SC.Array,SC.CollectionContent,{item:null,delegate:null,parentObserver:null,parentItem:function(){var a=this.get("parentObserver");return a?a.get("item"):null}.property("parentObserver").cacheable(),index:null,outlineLevel:0,children:null,disclosureState:SC.BRANCH_OPEN,branchIndexes:function(){var f=this.get("item"),b,g,a,e,d;if(!f){return SC.IndexSet.EMPTY}else{if(f.isTreeItemContent){g=this.get("parentItem");a=this.get("index");return f.treeItemBranchIndexes(g,a)}else{e=this.get("children");if(!e){return null}d=SC.IndexSet.create();b=e.get("length");g=f;for(a=0;a<b;a++){if(!(f=e.objectAt(a))){continue}if(!this._computeChildren(f,g,a)){continue}if(this._computeDisclosureState(f,g,a)!==SC.LEAF_NODE){d.add(a)}}return d.get("length")>0?d:null}}}.property("children").cacheable(),isHeaderVisible:function(){return !!this.get("parentObserver")}.property("parentObserver").cacheable(),length:0,objectAt:function(g,d){var h=this.get("length"),k=this.get("item"),a=this._objectAtCache,j=g,f=0,e,b;if(g>=h){return undefined}if(this.get("isHeaderVisible")){if(g===0){return k}else{j--}}k=null;if(!a){a=this._objectAtCache=[]}if((k=a[g])!==undefined){return k}b=this.get("children");if(!b){return undefined}if(e=this.get("branchIndexes")){e.forEach(function(n){if(k||(n>j)){return}var m=this.branchObserverAt(n),l;if(!m){return}l=m.get("length");if(n+l>j){k=m.objectAt(j-n,d);j=-1}else{j-=l-1}},this)}if(j>=0){k=b.objectAt(j,d)}a[g]=k;return k},replace:function(a,b,l,e){var k=a,h=null,f,g,j;if(e===undefined){e=SC.DROP_BEFORE}if(this.get("isHeaderVisible")){k--}if(k<0){throw"Tree Item cannot replace itself"}if(f=this.get("branchIndexes")){f.forEach(function(m){if(h||(m>=k)){return}if(!(h=this.branchObserverAt(m))){return}g=h.get("length");if((m+g===k)&&e===SC.DROP_AFTER){k-=m}else{if(m+g>k){k-=m}else{k-=g-1;h=null}}},this)}if(h){h.replace(k,b,l,e);return this}j=k+b;if(b>1&&f){f.forEachIn(k,f.get("max")-k,function(m){if(m>j){return}if(!(h=this.branchObserverAt(m))){return}g=h.get("length");j-=g-1},this)}b=j-k;var d=this.get("children");if(!d){throw"cannot replace() tree item with no children"}if((b<0)||(j>d.get("length"))){throw"replace() range must lie within a single tree item"}d.replace(k,b,l,e);return this},observerContentDidChange:function(b,d,k){this.invalidateBranchObserversAt(b);this._objectAtCache=this._outlineLevelCache=null;this._disclosureStateCache=null;this._contentGroupIndexes=NO;this.notifyPropertyChange("branchIndexes");var e=this.get("length"),f=this._computeLength(),h=this.get("parentObserver"),g;if(e!==f){this.set("length",f)}if(!this._notifyParent){return this}if(h){g=SC.IndexSet.create(this.get("index"));h._childrenRangeDidChange(h.get("children"),null,"[]",g)}else{if(e===f){d=this.expandChildIndex(b+d);b=this.expandChildIndex(b);d=d-b;k=0}else{b=this.expandChildIndex(b);d=f-b;k=f-e}var j=d;var a=k+j;this.arrayContentDidChange(b,j,a)}},expandChildIndex:function(d){var b=d;if(this.get("isHeaderVisible")){d++}var a=this.get("branchIndexes");if(!a||a.get("length")===0){return b}a.forEachIn(0,d,function(e){b+=this.branchObserverAt(e).get("length")-1},this);return b},_contentGroupIndexes:NO,contentGroupIndexes:function(a,f){if(f!==this){return null}var d=this._contentGroupIndexes;if(d!==NO){return d}if(this.get("parentObserver")){return null}var e=this.get("item"),h,b,j,g;if(e&&e.isTreeItemContent){h=e.get("treeItemIsGrouped")}else{h=!!this.delegate.get("treeItemIsGrouped")}if(h){d=SC.IndexSet.create();b=this.get("branchIndexes");if(b){j=b.min();g=0;b.forEach(function(l){d.add(l+g,1);var k=this.branchObserverAt(l);if(k){g+=k.get("length")-1;j+=g}},this)}}else{d=null}this._contentGroupIndexes=d;return d},contentIndexIsGroup:function(b,e,a){var d=this.contentGroupIndexes(b,e);return d?d.contains(a):NO},contentIndexOutlineLevel:function(l,h,f){if(h!==this){return -1}var a=this._outlineLevelCache;if(a&&(a[f]!==undefined)){return a[f]}if(!a){a=this._outlineLevelCache=[]}var g=this.get("length"),m=f,e=0,j=null,d,b,k;if(f>=g){return -1}if(this.get("isHeaderVisible")){if(f===0){return a[0]=this.get("outlineLevel")-1}else{m--}}if(d=this.get("branchIndexes")){d.forEach(function(p){if((j!==null)||(p>m)){return}var o=this.branchObserverAt(p),n;if(!o){return}n=o.get("length");if(p+n>m){j=o.contentIndexOutlineLevel(l,o,m-p);m=-1}else{m-=n-1}},this)}if(m>=0){j=this.get("outlineLevel")}a[f]=j;return j},contentIndexDisclosureState:function(l,h,f){if(h!==this){return -1}var a=this._disclosureStateCache;if(a&&(a[f]!==undefined)){return a[f]}if(!a){a=this._disclosureStateCache=[]}var g=this.get("length"),m=f,e=0,j=null,d,b,k;if(f>=g){return SC.LEAF_NODE}if(this.get("isHeaderVisible")){if(f===0){return a[0]=this.get("disclosureState")}else{m--}}if(d=this.get("branchIndexes")){d.forEach(function(p){if((j!==null)||(p>m)){return}var o=this.branchObserverAt(p),n;if(!o){return}n=o.get("length");if(p+n>m){j=o.contentIndexDisclosureState(l,o,m-p);m=-1}else{m-=n-1}},this)}if(m>=0){j=SC.LEAF_NODE}a[f]=j;return j},contentIndexExpand:function(b,g,a){var d,h=a,e,f;if(g!==this){return}if(this.get("isHeaderVisible")){if(a===0){this._expand(this.get("item"));return}else{h--}}if(d=this.get("branchIndexes")){d.forEach(function(l){if(l>=h){return}var k=this.branchObserverAt(l),j;if(!k){return}j=k.get("length");if(l+j>h){k.contentIndexExpand(b,k,h-l);h=-1}else{h-=j-1}},this)}if(h>=0){e=this.get("children");f=e?e.objectAt(h):null;if(f){this._expand(f,this.get("item"),h)}}},contentIndexCollapse:function(b,g,a){var d,e,f,h=a;if(g!==this){return}if(this.get("isHeaderVisible")){if(a===0){this._collapse(this.get("item"));return}else{h--}}if(d=this.get("branchIndexes")){d.forEach(function(l){if(l>=h){return}var k=this.branchObserverAt(l),j;if(!k){return}j=k.get("length");if(l+j>h){k.contentIndexCollapse(b,k,h-l);h=-1}else{h-=j-1}},this)}if(h>=0){e=this.get("children");f=e?e.objectAt(h):null;if(f){this._collapse(f,this.get("item"),h)}}},branchObserverAt:function(e){var h=this._branchObserversByIndex,d=this._branchObserverIndexes,f,j,b,l,a,g,k;if(!h){h=this._branchObserversByIndex=[]}if(!d){d=this._branchObserverIndexes=SC.IndexSet.create()}if(f=h[e]){return f}a=this.get("children");l=a?a.objectAt(e):null;if(!l){return null}h[e]=f=SC.TreeItemObserver.create({item:l,delegate:this.get("delegate"),parentObserver:this,index:e,outlineLevel:this.get("outlineLevel")+1});d.add(e);return f},invalidateBranchObserversAt:function(d){var b=this._branchObserversByIndex,a=this._branchObserverIndexes;if(!b||b.length<=d){return this}if(d<0){d=0}a.forEachIn(d,a.get("max")-d,function(f){var e=b[f];if(e){e.destroy()}},this);b.length=d;return this},init:function(){arguments.callee.base.apply(this,arguments);var a=this.get("item");if(!a){throw"SC.TreeItemObserver.item cannot be null"}a.addObserver("*",this,this._itemPropertyDidChange);this._itemPropertyDidChange(a,"*");this._notifyParent=YES},destroy:function(){this.invalidateBranchObserversAt(0);this._objectAtCache=null;this._notifyParent=NO;var d=this.get("item");if(d){d.removeObserver("*",this,this._itemPropertyDidChange)}var a=this._children,b=this._childrenRangeObserver;if(a&&b){a.removeRangeObserver(b)}this.set("length",0);arguments.callee.base.apply(this,arguments)},_itemPropertyDidChange:function(g,b){var a=this.get("children"),f=this.get("disclosureState"),e=this.get("item"),d;this.beginPropertyChanges();d=this._computeDisclosureState(e);if(f!==d){this.set("disclosureState",d)}d=this._computeChildren(e);if(a!==d){this.set("children",d)}this.endPropertyChanges()},_childrenDidChange:function(){var d=this.get("disclosureState"),e=d===SC.BRANCH_OPEN?this.get("children"):null,b=this._children,a=this._childrenRangeObserver;if(b===e){return this}if(a){b.removeRangeObserver(a)}if(e){this._childrenRangeObserver=e.addRangeObserver(null,this,this._childrenRangeDidChange)}else{this._childrenRangeObserver=null}this._children=e;this._childrenRangeDidChange(e,null,"[]",null)}.observes("children","disclosureState"),_childrenRangeDidChange:function(g,k,j,e){var a=this.get("children"),f=a?a.get("length"):0,d=e?e.get("min"):0,h=e?e.get("max"):f,b=this._childrenLen||0;this._childrenLen=f;this.observerContentDidChange(d,h-d,f-b)},_computeDisclosureState:function(e,f,b){var d,a;if(!e||!this._computeChildren(e)){return SC.LEAF_NODE}else{if(e.isTreeItemContent){if(f===undefined){f=this.get("parentItem")}if(b===undefined){b=this.get("index")}return e.treeItemDisclosureState(f,b)}else{d=this._treeItemIsExpandedKey;if(!d){a=this.get("delegate");d=a?a.get("treeItemIsExpandedKey"):"treeItemIsExpanded";this._treeItemIsExpandedKey=d}return e.get(d)?SC.BRANCH_OPEN:SC.BRANCH_CLOSED}}},_collapse:function(e,f,b){var d,a;if(!e||!this._computeChildren(e)){return this}else{if(e.isTreeItemContent){if(f===undefined){f=this.get("parentItem")}if(b===undefined){b=this.get("index")}e.treeItemCollapse(f,b)}else{d=this._treeItemIsExpandedKey;if(!d){a=this.get("delegate");d=a?a.get("treeItemIsExpandedKey"):"treeItemIsExpanded";this._treeItemIsExpandedKey=d}e.setIfChanged(d,NO)}}return this},_expand:function(e,f,b){var d,a;if(!e||!this._computeChildren(e)){return this}else{if(e.isTreeItemContent){if(f===undefined){f=this.get("parentItem")}if(b===undefined){b=this.get("index")}e.treeItemExpand(f,b)}else{d=this._treeItemIsExpandedKey;if(!d){a=this.get("delegate");d=a?a.get("treeItemIsExpandedKey"):"treeItemIsExpanded";this._treeItemIsExpandedKey=d}e.setIfChanged(d,YES)}}return this},_computeChildren:function(d){var a,b;if(!d){return null}else{if(d.isTreeItemContent){return d.get("treeItemChildren")}else{b=this._treeItemChildrenKey;if(!b){a=this.get("delegate");b=a?a.get("treeItemChildrenKey"):"treeItemChildren";this._treeItemChildrenKey=b}return d.get(b)}}},_computeLength:function(){var b=this.get("isHeaderVisible")?1:0,e=this.get("disclosureState"),d=this.get("children"),a;if((e===SC.BRANCH_OPEN)&&d){b+=d.get("length");if(a=this.get("branchIndexes")){a.forEach(function(f){var g=this.branchObserverAt(f);b+=g.get("length")-1},this)}}return b}});sc_require("private/tree_item_observer");SC.TreeController=SC.ObjectController.extend(SC.SelectionSupport,{treeItemIsGrouped:NO,treeItemIsExpandedKey:"treeItemIsExpanded",treeItemChildrenKey:"treeItemChildren",arrangedObjects:function(){var a,b=this.get("content");if(b){a=SC.TreeItemObserver.create({item:b,delegate:this});a.bind("allowsSelection",this,"allowsSelection");a.bind("allowsMultipleSelection",this,"allowsMultipleSelection");a.bind("allowsEmptySelection",this,"allowsEmptySelection")}else{a=null}this._sctc_arrangedObjects=a;return a}.property().cacheable(),_sctc_invalidateArrangedObjects:function(){this.propertyWillChange("arrangedObjects");var a=this._sctc_arrangedObjects;if(a){a.destroy()}this._sctc_arrangedObjects=null;this.propertyDidChange("arrangedObjects")}.observes("content","treeItemIsExpandedKey","treeItemChildrenKey","treeItemIsGrouped"),_sctc_arrangedObjectsContentDidChange:function(){this.updateSelectionAfterContentChange()}.observes("*arrangedObjects.[]"),canSelectGroups:NO,firstSelectableObject:function(){var e=this.get("arrangedObjects"),d,b,a=0;if(!e){return null}if(this.get("canSelectGroups")){return e.get("firstObject")}d=e.contentGroupIndexes(null,e);b=e.get("length");while(d.contains(a)&&(a<b)){a++}return a>=b?null:e.objectAt(a)}.property()});SC.InlineTextFieldDelegate={editor:null,acquireEditor:function(a){var b=this.editor;if(b){if(b.get("isEditing")&&!b.commitEditing()&&!b.discardEditing()){return null}this.releaseEditor(b)}var d=a.exampleEditor?a.exampleEditor:SC.InlineTextFieldView,e=a.get("pane");b=this.editor=e.createChildView(d,{inlineEditorDelegate:this});e.appendChild(b);return b},releaseEditor:function(a){a.removeFromParent();this.editor=null;return YES}};SC.STRING_TITLEIZE_REGEXP=(/([\s|\-|\_|\n])([^\s|\-|\_|\n]?)/g);SC.STRING_HUMANIZE_REGEXP=(/[\-_]/g);SC.STRING_REGEXP_ESCAPED_REGEXP=(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g);SC.STRING_DASHERIZE_CACHE={top:"top",left:"left",right:"right",bottom:"bottom",width:"width",height:"height",minWidth:"min-width",maxWidth:"max-width"};SC.INFLECTION_CONSTANTS={PLURAL:[[/(quiz)$/i,"$1zes"],[/^(ox)$/i,"$1en"],[/([m|l])ouse$/i,"$1ice"],[/(matr|vert|ind)ix|ex$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/(?:([^f])fe|([lr])f)$/i,"$1$2ves"],[/sis$/i,"ses"],[/([ti])um$/i,"$1a"],[/(buffal|tomat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status)$/i,"$1es"],[/(octop|vir)us$/i,"$1i"],[/(ax|test)is$/i,"$1es"],[/s$/i,"s"],[/$/,"s"]],SINGULAR:[[/(quiz)zes$/i,"$1"],[/(matr)ices$/i,"$1ix"],[/(vert|ind)ices$/i,"$1ex"],[/^(ox)en/i,"$1"],[/(alias|status)es$/i,"$1"],[/(octop|vir)i$/i,"$1us"],[/(cris|ax|test)es$/i,"$1is"],[/(shoe)s$/i,"$1"],[/(o)es$/i,"$1"],[/(bus)es$/i,"$1"],[/([m|l])ice$/i,"$1ouse"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m)ovies$/i,"$1ovie"],[/(s)eries$/i,"$1eries"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/([lr])ves$/i,"$1f"],[/(tive)s$/i,"$1"],[/(hive)s$/i,"$1"],[/([^f])ves$/i,"$1fe"],[/(^analy)ses$/i,"$1sis"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i,"$1$2sis"],[/([ti])a$/i,"$1um"],[/(n)ews$/i,"$1ews"],[/s$/i,""]],IRREGULAR:[["move","moves"],["sex","sexes"],["child","children"],["man","men"],["person","people"]],UNCOUNTABLE:["sheep","fish","series","species","money","rice","information","info","equipment"]};SC.mixin(SC.String,{capitalizeEach:function(a){return a.replace(SC.STRING_TITLEIZE_REGEXP,function(d,b,e){return(e)?(b+e.toUpperCase()):b}).capitalize()},titleize:function(b){var a=b.replace(SC.STRING_DECAMELIZE_REGEXP,"$1_$2");return a.replace(SC.STRING_TITLEIZE_REGEXP,function(d,f,e){return e?" "+e.toUpperCase():" "}).capitalize()},classify:function(e){var a=e.replace(SC.STRING_TITLEIZE_REGEXP,function(f,h,g){return g?g.toUpperCase():""});var d=a.charAt(0),b=d.toUpperCase();return d!==b?b+a.slice(1):a},humanize:function(a){return SC.String.decamelize(a).replace(SC.STRING_HUMANIZE_REGEXP," ")},escapeForRegExp:function(a){return a.replace(SC.STRING_REGEXP_ESCAPED_REGEXP,"\\$1")},removeDiacritics:function(h){var a=SC.diacriticMappingTable;if(!a){SC.diacriticMappingTable={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"P","":"P","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"`","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"p","":"p","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z"};a=SC.diacriticMappingTable}var e,f,b="",g=h.length;for(var d=0;d<=g;++d){e=h.charAt(d);f=a[e];b+=f||e}return b},pluralize:function(h){var m,f,b=h.split(/\s/).pop(),j=h.replace(b,""),a=b.charAt(0).match(/[A-Z]/)?true:false;b=b.toLowerCase();for(m=0,f=SC.INFLECTION_CONSTANTS.UNCOUNTABLE.length;m<f;m++){var g=SC.INFLECTION_CONSTANTS.UNCOUNTABLE[m];if(b==g){return h.toString()}}for(m=0,f=SC.INFLECTION_CONSTANTS.IRREGULAR.length;m<f;m++){var d=SC.INFLECTION_CONSTANTS.IRREGULAR[m][0],l=SC.INFLECTION_CONSTANTS.IRREGULAR[m][1];if((b==d)||(b==l)){if(a){l=l.capitalize()}return j+l}}for(m=0,f=SC.INFLECTION_CONSTANTS.PLURAL.length;m<f;m++){var k=SC.INFLECTION_CONSTANTS.PLURAL[m][0],e=SC.INFLECTION_CONSTANTS.PLURAL[m][1];if(k.test(b)){return h.replace(k,e)}}},singularize:function(h){var m,f,b=h.split(/\s/).pop(),j=h.replace(b,""),a=b.charAt(0).match(/[A-Z]/)?true:false;b=b.toLowerCase();for(m=0,f=SC.INFLECTION_CONSTANTS.UNCOUNTABLE.length;m<f;m++){var g=SC.INFLECTION_CONSTANTS.UNCOUNTABLE[m];if(b==g){return h.toString()}}for(m=0,f=SC.INFLECTION_CONSTANTS.IRREGULAR.length;m<f;m++){var d=SC.INFLECTION_CONSTANTS.IRREGULAR[m][0],l=SC.INFLECTION_CONSTANTS.IRREGULAR[m][1];if((b==d)||(b==l)){if(a){d=d.capitalize()}return j+d}}for(m=0,f=SC.INFLECTION_CONSTANTS.SINGULAR.length;m<f;m++){var k=SC.INFLECTION_CONSTANTS.SINGULAR[m][0],e=SC.INFLECTION_CONSTANTS.SINGULAR[m][1];if(k.test(b)){return h.replace(k,e)}}}});SC.String.strip=SC.String.trim;sc_require("system/string");SC.supplement(String.prototype,{capitalizeEach:function(){return SC.String.capitalizeEach(this,arguments)},titleize:function(a){return SC.String.titleize(this,arguments)},classify:function(a){return SC.String.classify(this,arguments)},humanize:function(a){return SC.String.humanize(this,arguments)},escapeForRegExp:function(a){return SC.String.escapeForRegExp(this,arguments)},removeDiacritics:function(a){return SC.String.removeDiacritics(this,arguments)},trim:function(a){return SC.String.trim(this,arguments)},trimLeft:function(a){return SC.String.trimLeft(this,arguments)},trimRight:function(a){return SC.String.trimRight(this,arguments)},pluralize:function(a){return SC.String.pluralize(this,arguments)},singularize:function(a){return SC.String.singularize(this,arguments)}});SC.Gesture=SC.Object.extend({name:"gesture",touchIsInGesture:function(b,a){return NO},touchStart:function(a){},touchesDragged:function(a,b){},touchEnd:function(a){},start:function(){if(!this.get("isActive")){this.set("isActive",YES);var b=SC.$A(arguments);b.unshift(this);var a=this.name+"Start";if(this.view[a]){this.view[a].apply(this.view,b)}}},end:function(){if(this.get("isActive")){this.set("isActive",NO);var b=SC.$A(arguments);b.unshift(this);var a=this.name+"End";if(this.view[a]){this.view[a].apply(this.view,b)}}},change:function(){if(this.get("isActive")){var b=SC.$A(arguments);b.unshift(this);var a=this.name+"Changed";if(this.view[a]){this.view[a].apply(this.view,b)}}},cancel:function(){if(this.get("isActive")){this.set("isActive",NO);var b=SC.$A(arguments);b.unshift(this);var a=this.name+"Cancelled";if(this.view[a]){this.view[a].apply(this.view,b)}}},trigger:function(){var b=SC.$A(arguments);b.unshift(this);var a=this.name;if(this.view[a]){this.view[a].apply(this.view,b)}},take:function(a){a.isTaken=YES;if(SC.none(a.touchResponder)||a.touchResponder!==this){a.makeTouchResponder(this,YES)}},release:function(a){a.isTaken=NO;if(a.nextTouchResponder){a.makeTouchResponder(a.nextTouchResponder)}},discardTouch:function(a){a.isTaken=YES;a.makeTouchResponder(null)},statusForTouch:function(d){var b=SC.guidFor(d.view)+this.name;var a=d[b];if(!a){a=d[b]={}}return a},unassignedTouchDidStart:function(a){if(a.isTaken){return}if(this.touchIsInGesture(a,this.statusForTouch(a))){this.take(a)}},unassignedTouchesDidChange:function(a,b){b.forEach(function(d){if(d.isTaken){return}if(this.touchIsInGesture(d,this.statusForTouch(d))){this.take(d)}},this)},unassignedTouchDidEnd:function(a){},interestedInTouch:function(b){var a=this.statusForTouch(b);if(a.isInterested){return}a.isInterested=YES;b.isInteresting++},uninterestedInTouch:function(b){var a=this.statusForTouch(b);if(!a.isInterested){return}a.isInterested=NO;b.isInteresting--}});sc_require("system/gesture");SC.PinchGesture=SC.Gesture.extend({name:"pinch",acceptsMultitouch:YES,scale:1,unassignedTouchesDidChange:function(a,b){if(b.length==2){this.take(b[0]);this.take(b[1])}},touchStart:function(b){var a=b.touchesForResponder(this);if(!a||a.length===0){return YES}else{if(a.length==1){this.start([a[0],b]);return YES}else{return NO}}},touchesDragged:function(a,d){var e=d.firstObject(),b=e.averagedTouchesForView(this);if(b.touchCount==2){if(!this._startDistance){this._startDistance=b.d}this.scale=b.d/this._startDistance;this.change(d,this.scale)}},touchEnd:function(b){this._startDistance=null;var a=b.touchesForResponder(this);this.trigger(a,this.scale);this.end(a,this.scale);if(a){a.forEach(function(d){this.release(d)},this)}}});sc_require("system/gesture");SC.SWIPE_HORIZONTAL="X";SC.SWIPE_VERTICAL="Y";SC.SWIPE_ANY="XY";SC.SWIPE_LEFT="LEFT";SC.SWIPE_RIGHT="RIGHT";SC.SWIPE_UP="UP";SC.SWIPE_DOWN="DOWN";SC.SwipeGesture=SC.Gesture.extend({name:"swipe",acceptsMultitouch:YES,direction:SC.SWIPE_HORIZONTAL,currentDirection:null,startDistance:5,swipeDistance:40,tolerance:0.5,touchIsInGesture:function(k,h){if(!h.flunked){var l=this.get("direction"),f=this.get("currentDirection"),a=this.get("startDistance"),j=k.pageX-k.startX,g=k.pageY-k.startY,e=Math.abs(j),b=Math.abs(g);if(Math.abs(j)>a||Math.abs(g)>a){if(!f){if(l==SC.SWIPE_ANY){if(e>b){f=SC.SWIPE_HORIZONTAL}else{if(b>e){f=SC.SWIPE_VERTICAL}else{return NO}}}else{f=l}this.set("currentDirection",f)}var n=(f==SC.SWIPE_HORIZONTAL)?j:g,m=(f==SC.SWIPE_HORIZONTAL)?g:j;if(Math.abs(n)*this.get("tolerance")>Math.abs(m)){return YES}}}return NO},touchStart:function(f){var b=this.get("currentDirection"),e=f["page"+b]-f["start"+b],a;if(e<0){a=(b===SC.SWIPE_HORIZONTAL)?SC.SWIPE_LEFT:SC.SWIPE_UP}else{a=(b===SC.SWIPE_HORIZONTAL)?SC.SWIPE_RIGHT:SC.SWIPE_DOWN}this.start(f,a,e);return YES},touchesDragged:function(l,f){var e=f.firstObject();var g=this.get("currentDirection"),a=(g===SC.SWIPE_HORIZONTAL?"Y":"X"),k=e["page"+g]-e["start"+g],h=e["page"+a]-e["start"+a],j;if(k<0){j=(g===SC.SWIPE_HORIZONTAL)?SC.SWIPE_LEFT:SC.SWIPE_UP}else{j=(g===SC.SWIPE_HORIZONTAL)?SC.SWIPE_RIGHT:SC.SWIPE_DOWN}if(Math.abs(k)<this.get("startDistance")||Math.abs(k)*this.get("tolerance")<Math.abs(h)){this.release(e);var b=e.touchesForResponder(this);if(!b||b.length===0){this.cancel(e,j,k)}}else{this.change(e,j,k)}},touchEnd:function(j){var g=this.get("currentDirection"),f=(g===SC.SWIPE_HORIZONTAL?"Y":"X"),h=j["page"+g]-j["start"+g],b=j["page"+f]-j["start"+f],a;if(h<0){a=(g===SC.SWIPE_HORIZONTAL)?SC.SWIPE_LEFT:SC.SWIPE_UP}else{a=(g===SC.SWIPE_HORIZONTAL)?SC.SWIPE_RIGHT:SC.SWIPE_DOWN}if(Math.abs(h)>this.get("swipeDistance")||Math.abs(h)*this.get("tolerance")<Math.abs(b)){this.trigger(j,a)}this.end(j,a,h);this.set("currentDirection",null);var e=j.touchesForResponder(this);if(e){e.forEach(function(d){this.release(d)},this)}},cancel:function(){arguments.callee.base.apply(this,arguments);this.set("currentDirection",null)}});sc_require("system/gesture");SC.TapGesture=SC.Gesture.extend({name:"tap",acceptsMultitouch:NO,_tapCount:null,_candidateTouch:null,_eventTimer:null,tapWiggle:10,tapDelay:200,touchIsInGesture:function(b,a){return !b.tapFlunked},touchStart:function(a){if(this._eventTimer){this._eventTimer.invalidate()}if(this._candidateTouch&&this._candidateTouch.touch.identifier!==a.identifier){this._cancelTap(a);return NO}this._candidateTouch={startTime:Date.now(),touch:a};this.start(a);return YES},touchesDragged:function(a,d){var f=d[0];var b=(d.length>1||!this._candidateTouch||f.identifier!==this._candidateTouch.touch.identifier);var e=this._calculateDragDistance(f)>this.get("tapWiggle");if(b||e){this._cancelTap(f)}},touchEnd:function(a){if(this._calculateDragDistance(a)>this.get("tapWiggle")||Date.now()-this._candidateTouch.startTime>this.get("tapDelay")){this._cancelTap(a)}else{this._addTap(a)}},_addTap:function(b){var a=this;if(this._eventTimer){this._eventTimer.invalidate()}this._tapCount=(this._tapCount||0)+1;this._candidateTouch=null;this._eventTimer=SC.Timer.schedule({target:a,action:function(){this._triggerTap(b)},interval:this.get("tapDelay")});this.change(b,this._tapCount);this.trigger(b,this._tapCount)},_cancelTap:function(a){a.tapFlunked=YES;this.release(a);this.cancel(a,this._tapCount);if(this._eventTimer){this._eventTimer.invalidate()}this._tapCount=null;this._candidateTouch=null;this._eventTimer=null},_triggerTap:function(a){this.end(a,this._tapCount);this._tapCount=null;this._candidateTouch=null;this._eventTimer=null},_calculateDragDistance:function(a){return Math.sqrt(Math.pow(a.pageX-a.startX,2)+Math.pow(a.pageY-a.startY,2))}});SC.AutoMixin={autoMixins:[],createChildView:function(b,d){if(!d){d={}}d.owner=d.parentView=this;d.isVisibleInWindow=this.get("isVisibleInWindow");if(!d.page){d.page=this.page}var a=this.get("autoMixins");a.push(d);b=b.create.apply(b,a);return b}};SC.mixin({_copy_computed_props:["maxWidth","maxHeight","paddingLeft","paddingRight","paddingTop","paddingBottom","fontFamily","fontSize","fontStyle","fontWeight","fontVariant","lineHeight","whiteSpace","letterSpacing","wordWrap"],stringFromLayout:function(f){var e=["maxHeight","maxWidth","minHeight","minWidth","centerY","centerX","width","height","bottom","right","top","left","zIndex","opacity","border","borderLeft","borderRight","borderTop","borderBottom"],a=[],d,b=e.length;while(--b>=0){d=e[b];if(f.hasOwnProperty(d)){a.push(d+":"+f[d])}}return"{"+a.join(", ")+"}"},heightForString:function(j,d,b,a,h){var f=this._heightCalcElement,g,k;if(!h){j=SC.RenderContext.escapeHTML(j)}g=(a&&SC.typeOf(a)===SC.T_ARRAY)?a.join(" "):"";if(!d){d=100}if(!f){f=this._heightCalcElement=document.createElement("div");document.body.insertBefore(f,null)}b=b+"; width: "+d+"px; left: "+(-1*d)+"px; position: absolute";var e=SC.$(f);e.attr("style",b);if(g!==""){e.attr("class",g)}f.innerHTML=j;k=f.clientHeight;f=null;return k},prepareStringMeasurement:function(p,a){var l=this._metricsCalculationElement,j,q,d,e;j=SC.A(a).join(" ");if(!l){var o=document.createElement("div");o.style.cssText="position:absolute; left:-10010px; top:-10px;width:10000px; height:0px; overflow:hidden;visibility:hidden;";l=this._metricsCalculationElement=document.createElement("div");o.appendChild(l);document.body.insertBefore(o,null)}e=SC.$(l);if(SC.typeOf(p)!=SC.T_STRING){var h=null;if(document.defaultView&&document.defaultView.getComputedStyle){h=document.defaultView.getComputedStyle(p,null)}else{h=p.currentStyle}var n=this._copy_computed_props;for(var k=0;k<n.length;k++){var b=n[k],g=h[b];l.style[b]=g}var m=l.style;if(m.font===""){var f="";if(m.fontStyle){f+=m.fontStyle+" "}if(m.fontVariant){f+=m.fontVariant+" "}if(m.fontWeight){f+=m.fontWeight+" "}if(m.fontSize){f+=m.fontSize}else{f+="10px"}if(m.lineHeight){f+="/"+m.lineHeight}f+=" ";if(m.fontFamily){f+=m.fontFamily}else{m+="sans-serif"}l.style.font=f}SC.mixin(l.style,{left:"0px",top:"0px",position:"absolute",bottom:"auto",right:"auto",width:"auto",height:"auto"});h=null}else{d=p;e.attr("style",d+"; position:absolute; left: 0px; top: 0px; bottom: auto; right: auto; width: auto; height: auto;")}l.className=j;l=null},teardownStringMeasurement:function(){var a=this._metricsCalculationElement;a.innerHTML="";a.className="";a.setAttribute("style","");a=null},measureString:function(d,b){var e=this._metricsCalculationElement,f=0;if(!e){throw"measureString requires a string measurement environment to be set up. Did you mean metricsForString?"}if(b){e.innerHTML=d}else{if(typeof e.innerText!="undefined"){e.innerText=d}else{e.textContent=d}}if(SC.browser.isIE){f=1}var a={width:e.clientWidth+f,height:e.clientHeight};if(SC.browser.isMozilla){a.width+=1}e=null;return a},metricsForString:function(d,e,f,b){SC.prepareStringMeasurement(e,f);var a=SC.measureString(d,b);SC.teardownStringMeasurement();return a}});sc_require("system/utils/string_measurement");SC.AutoResize={shouldAutoResize:YES,shouldMeasureSize:YES,shouldCacheSizes:NO,shouldResizeWidth:YES,shouldResizeHeight:NO,measuredSize:{width:0,height:0},maxWidth:null,maxHeight:null,shouldAutoFitText:NO,autoFitDiscreteFontSizes:NO,minFontSize:12,maxFontSize:20,calculatedFontSize:20,fontPropertyDidChange:function(){if(this.get("shouldAutoFitText")){this.invokeLast(this.fitTextToFrame)}}.observes("shouldAutoFitText","minFontSize","maxFontSize","measuredSize"),measuredSizeDidChange:function(){var d=this.get("measuredSize"),b=d.width,j=d.height,h,a,e=this.get("autoResizePadding")||0,g=this.get("maxWidth"),f=this.get("maxHeight");if(SC.typeOf(e)===SC.T_NUMBER){h=a=e}else{h=e.height;a=e.width}j+=h;b+=a;if(this.get("shouldAutoResize")){if(this.get("shouldResizeWidth")){if(g&&b>g){b=g}this.set("calculatedWidth",b);this.adjust("width",b)}if(this.get("shouldResizeHeight")){if(f&&j>f){j=f}this.set("calculatedHeight",j);this.adjust("height",j)}}}.observes("shouldAutoResize","measuredSize","autoResizePadding","maxWidth","minWidth","shouldResizeWidth","shouldResizeHeight"),initMixin:function(){},batchResizeId:null,scheduleMeasurement:function(){var a=this.get("batchResizeId");if(!this.get("shouldMeasureSize")||!this.get("isVisibleInWindow")||(this.get("autoResizeText")===this._lastMeasuredText&&a===this._lastMeasuredId)){return}SC.AutoResizeManager.scheduleMeasurementForView(this,a)}.observes("isVisibleInWindow","shouldMeasureSize","autoResizeText","batchResizeId"),_lastMeasuredText:null,_cachedMetrics:function(d,e){if(!this.get("shouldCacheSizes")){return}var b=SC.cacheSlotFor(this.get("batchResizeId")||this),a=this.get("autoResizeText");if(e){b[a]=e}else{e=b[a]}return e}.property("shouldCacheSizes","autoResizeText","batchResizeId").cacheable(),measureSize:function(e){var j,f=this.get("autoResizeLayer"),d=this.get("autoResizeText"),b=!this.get("escapeHTML"),h=this.get("batchResizeId"),a=this.get("_cachedMetrics"),g=this.get("maxFontSize");if(!f){return}if(a){j=a}else{if(SC.none(d)||d===""){j={width:0,height:0}}else{if(e){j=SC.measureString(d,b)}else{this.prepareLayerForStringMeasurement(f);j=SC.metricsForString(d,f,this.get("classNames"),b)}}}this.set("measuredSize",j);if(this.get("shouldCacheSizes")){this.setIfChanged("_cachedMetrics",j)}this._lastMeasuredText=d;this._lastMeasuredId=h;return j},prepareLayerForStringMeasurement:function(a){var b=this.get("maxFontSize");if(this.get("shouldAutoFitText")&&this.get("calculatedFontSize")!==b){a.style.fontSize=b+"px"}},viewDidResize:function(a){a();this.fontPropertyDidChange()}.enhance(),fitTextToFrame:function(){var t=this.get("autoResizeLayer");if(!t){return}var d=this.get("maxFontSize"),e=this.get("minFontSize");this.prepareLayerForStringMeasurement(t);var f=this.get("frame"),g=this.get("autoResizePadding")||0,l=f.width-1,h=f.height-1,s=this.get("measuredSize"),a=s.width,u=s.height;if(SC.typeOf(g)===SC.T_NUMBER){l-=g;h-=g}else{l-=g.width;h-=g.height}if(a<=l&&u<=h){return}if(this.get("autoFitDiscreteFontSizes")){j=e}else{var b=l/a,k=h/u,n=Math.floor(d*Math.min(b,k)),j,q=this.get("classNames"),p=!this.get("escapeHTML"),m=this.get("autoResizeText"),o;n=j=Math.min(d,Math.max(e,n));t.style.fontSize=n+"px";o=SC.metricsForString(m,t,q,p);if(o.width>l||o.height>h){for(n=n-1;n>=e;n--){t.style.fontSize=n+"px";o=SC.metricsForString(m,t,q,p);j=n;if(o.width<=l&&o.height<=h){break}}}else{if(o.width<l||o.height<h){for(n=n+1;n<=d;n++){t.style.fontSize=n+"px";o=SC.metricsForString(m,t,q,p);if(o.width<=l&&o.height<=h){j=n}if(o.width>=l||o.height>=h){break}}}}}t.style.fontSize=j+"px";this.set("calculatedFontSize",j)},applyAttributesToContext:function(b,a){b(a);if(this.get("shouldAutoFitText")){a.css("font-size",this.get("calculatedFontSize")+"px")}}.enhance(),didCreateLayer:function(a){a();this.scheduleMeasurement()}.enhance()};SC.AutoResizeManager={measurementQueue:SC.CoreSet.create(),scheduleMeasurementForView:function(a){this.measurementQueue.add(a);SC.RunLoop.currentRunLoop.invokeLast(this.doBatchResize)},cancelMeasurementForView:function(a,b){this.measurementQueue.remove(a)},doBatchResize:function(){if(this!==SC.AutoResizeManager){return SC.AutoResizeManager.doBatchResize()}var b,e,g,h=this.measurementQueue,j,d,f,a;while((a=h.get("length"))>0){j=NO;b=h[a-1].get("batchResizeId");for(f=a-1;f>=0;--f){e=h[f];if(e.get("batchResizeId")!==b){continue}if(e.get("isVisibleInWindow")&&e.get("shouldMeasureSize")&&(g=e.get("autoResizeLayer"))){d=e.get("autoResizeText");if(!SC.none(d)&&d!==""&&!e.get("_cachedMetrics")&&!j){e.prepareLayerForStringMeasurement(g);SC.prepareStringMeasurement(g,e.get("classNames"));j=YES}e.measureSize(YES)}h.remove(e);if(!b){break}}if(j){SC.teardownStringMeasurement()}}}};if(SC.Button){SC.Button.initMixin=function(){throw"SC.Button is deprecated as a mixin and is now a subclass of SC.TemplateView. Subclass SC.ButtonView instead."}}SC.ContentDisplay={concatenatedProperties:"contentDisplayProperties",displayProperties:["content"],contentDisplayProperties:[],initMixin:function(){this._display_contentDidChange()},destroyMixin:function(){if(!this._display_content){return}this._display_stopObservingContent(this._display_content);this._display_content=null},_display_beginObservingContent:function(a){var b=this._display_contentPropertyDidChange;if(SC.isArray(a)){a.invoke("addObserver","*",this,b)}else{if(a.addObserver){a.addObserver("*",this,b)}}},_display_stopObservingContent:function(a){var b=this._display_contentPropertyDidChange;if(SC.isArray(a)){a.invoke("removeObserver","*",this,b)}else{if(a.removeObserver){a.removeObserver("*",this,b)}}},_display_contentDidChange:function(e,a,d){if((d=this.get("content"))===this._display_content){return}var b=this._display_content;if(b){this._display_stopObservingContent(b)}b=this._display_content=d;if(b){this._display_beginObservingContent(b)}this.displayDidChange()}.observes("content","contentDisplayProperties"),_display_contentPropertyDidChange:function(f,d,e,b){if(d==="*"){this.displayDidChange()}else{var a=this.get("contentDisplayProperties");if(a&&a.indexOf(d)>=0){this.displayDidChange()}}}};SC.ContentValueSupport={hasContentValueSupport:YES,initMixin:function(){this._control_contentKeysDidChange()},value:null,content:null,contentKeys:null,_default_contentKeys:{contentValueKey:"value"},contentValueKey:null,contentPropertyDidChange:function(d,b){var a=this.get("contentKeys");if(a){var e;for(e in a){if(b==="*"||b===this.getDelegateProperty(e,this,this.get("displayDelegate"),a)){return this.updatePropertyFromContent(a[e],b,e,d)}}}else{return this.updatePropertyFromContent("value",b,"contentValueKey",d)}},updatePropertyFromContent:function(g,d,f,e){var a,b;if(f===undefined){f="content"+g.capitalize()+"Key"}if(this[f]){f=this.get(f)}else{if((a=this.get("displayDelegate"))&&(b=a[f])){f=a.get?a.get(f):b}else{return this}}if(d==="*"||d===f){if(e===undefined){e=this.get("content")}if(e){b=e.get?e.get(f):e[f]}else{b=null}this.setIfChanged(g,b)}return this},updateContentWithValueObserver:function(e,a){var g=this._reverseContentKeys;if(!a||a==="*"){for(a in g){this.updateContentWithValueObserver(this,a)}}var d=this.get(a);var b=this.get("content"),f=this.getDelegateProperty(g[a],this,this.displayDelegate);if(!f||!b){return this}if(typeof b.setIfChanged===SC.T_FUNCTION){b.setIfChanged(f,d)}else{if(b[f]!==d){b[f]=d}}},_control_content:null,_old_contentValueKeys:null,_old_contentKeys:null,_control_contentDidChange:function(j,m){var k=this.get("content"),b=this.get("contentKeys"),a,d=this._control_content,n=this._old_contentValueKeys,l=SC.typeOf(n),h=this.contentPropertyDidChange;if(d&&d.removeObserver&&n){if(l===SC.T_STRING){d.removeObserver(n,this,h);n=null}else{var e,g=n.get("length");for(e=0;e<g;e++){a=n[e];d.removeObserver(a,this,h)}n.clear()}}if(k&&k.addObserver){if(b){if(!n){n=SC.CoreSet.create()}for(a in b){a=this.getDelegateProperty(a,this,this.get("displayDelegate"));if(a){k.addObserver(a,this,h);n.add(a)}}}else{a=this.getDelegateProperty("contentValueKey",this,this.get("displayDelegate"));if(a){k.addObserver(a,this,h);if(n){n.add(a)}else{n=a}}}}this._control_content=k;this._old_contentValueKeys=n;m=(!m||m==="content")?"*":this.get(m);if(m){this.contentPropertyDidChange(k,m)}}.observes("content"),_old_contentKeys:null,_control_contentKeysDidChange:function(){var e,d={},a=this.get("contentKeys")||this._default_contentKeys,j,b=this._old_contentKeys,h=this._control_contentDidChange,g=this.updateContentWithValueObserver;for(e in b){j=b[e];this.removeObserver(j,this,g);this.removeObserver(e,this,h)}for(e in a){j=a[e];d[j]=e;this.addObserver(j,this,g);this.addObserver(e,this,h)}this._reverseContentKeys=d;this._old_contentKeys=a;this._control_contentDidChange()}.observes("contentKeys")};sc_require("mixins/content_value_support");sc_require("system/string");SC.AUTO_CONTROL_SIZE="__AUTO__";SC.JUMBO_CONTROL_SIZE="sc-jumbo-size";SC.HUGE_CONTROL_SIZE="sc-huge-size";SC.LARGE_CONTROL_SIZE="sc-large-size";SC.REGULAR_CONTROL_SIZE="sc-regular-size";SC.SMALL_CONTROL_SIZE="sc-small-size";SC.TINY_CONTROL_SIZE="sc-tiny-size";SC.Control=SC.mixin(SC.clone(SC.ContentValueSupport),{isControl:YES,isSelected:NO,isSelectedBindingDefault:SC.Binding.oneWay().bool(),isActive:NO,isActiveBindingDefault:SC.Binding.oneWay().bool(),fieldKey:null,fieldLabel:null,errorLabel:function(){var a,e,d,b;if(a=this.get("fieldLabel")){return a}e=this.get("fieldKey")||this.constructor.toString();d=e?SC.String.capitalize(SC.String.humanize(e)):"";b=SC.String.locWithDefault("FieldKey."+e,d);return SC.String.locWithDefault("ErrorLabel."+e,b)}.property("fieldLabel","fieldKey").cacheable(),controlSize:SC.REGULAR_CONTROL_SIZE,displayProperties:["isEnabled","isSelected","isActive","controlSize"],_CONTROL_TMP_CLASSNAMES:{},renderMixin:function(b,h){var e=this.get("isSelected"),d=!this.get("isEnabled"),f=this._CONTROL_TMP_CLASSNAMES;f.mixed=e===SC.MIXED_STATE;f.sel=e&&(e!==SC.MIXED_STATE);f.active=this.get("isActive");var g=this.get("controlSize");if(!g){g=SC.REGULAR_CONTROL_SIZE}if(h){b.setClass(f);if(!this.get("renderDelegate")){b.addClass(g)}}else{b.$().setClass(f);if(!this.get("renderDelegate")){b.$().addClass(g)}}if(!h&&this.$input){var a=this.$input();if(a.attr("type")!=="radio"){this.$input().attr("disabled",d)}}}});SC.Editable={isEditable:NO,isEditing:NO,beginEditing:function(){if(!this.get("isEditable")){return NO}if(this.get("isEditing")){return YES}this.beginPropertyChanges();this.set("isEditing",YES);this.becomeFirstResponder();this.endPropertyChanges();return YES},discardEditing:function(){return !this.get("isEditing")},commitEditing:function(){if(!this.get("isEditing")){return YES}this.set("isEditing",NO);this.resignFirstResponder();return YES}};SC.ALIGN_JUSTIFY="justify";SC.FlowedLayout={isFlowedLayout:YES,layoutDirection:SC.LAYOUT_HORIZONTAL,autoResize:YES,shouldResizeWidth:YES,shouldResizeHeight:YES,align:SC.ALIGN_LEFT,canWrap:YES,defaultFlowSpacing:{left:0,bottom:0,top:0,right:0},flowPadding:{left:0,bottom:0,right:0,top:0},_scfl_validFlowPadding:function(){var b=this.get("flowPadding")||{},a={};a.left=b.left||0;a.top=b.top||0;a.bottom=b.bottom||0;a.right=b.right||0;return a}.property("flowPadding").cacheable(),concatenatedProperties:["childMixins"],initMixin:function(){this._scfl_tileOnce()},_scfl_childViewsDidChange:function(a){this._scfl_tileOnce()}.observes("childViews"),_scfl_layoutPropertyDidChange:function(a){this._scfl_tileOnce()}.observes("layoutDirection","align","flowPadding","canWrap","defaultFlowSpacing","isVisibleInWindow"),layoutDidChangeFor:function(g){var b=g._scfl_lastLayout,a=g.get("layout"),d=g.get("frame");if(!b){return arguments.callee.base.apply(this,arguments)}var e=YES;if(b.left&&b.left!==a.left){e=NO}else{if(b.top&&b.top!==a.top){e=NO}else{if(!g.get("fillWidth")&&b.width&&b.width!==a.width){e=NO}else{if(!b.width&&!g.get("fillWidth")&&d.width!==g._scfl_lastFrame.width){e=NO}else{if(!g.get("fillHeight")&&b.height&&b.height!==a.height){e=NO}else{if(!b.height&&!g.get("fillHeight")&&d.height!==g._scfl_lastFrame.height){e=NO}}}}}}if(e){return arguments.callee.base.apply(this,arguments)}this._scfl_tileOnce();arguments.callee.base.apply(this,arguments)},observeChildLayout:function(a){if(a._scfl_isBeingObserved){return}a._scfl_isBeingObserved=YES;a.addObserver("flowSpacing",this,"_scfl_tileOnce");a.addObserver("isVisible",this,"_scfl_tileOnce");a.addObserver("useAbsoluteLayout",this,"_scfl_tileOnce");a.addObserver("calculatedWidth",this,"_scfl_tileOnce");a.addObserver("calculatedHeight",this,"_scfl_tileOnce");a.addObserver("startsNewRow",this,"_scfl_tileOnce");a.addObserver("isSpacer",this,"_scfl_tileOnce");a.addObserver("maxSpacerLength",this,"_scfl_tileOnce");a.addObserver("fillWidth",this,"_scfl_tileOnce");a.addObserver("fillHeight",this,"_scfl_tileOnce")},unobserveChildLayout:function(a){a._scfl_isBeingObserved=NO;a.removeObserver("flowSpacing",this,"_scfl_tileOnce");a.removeObserver("isVisible",this,"_scfl_tileOnce");a.removeObserver("useAbsoluteLayout",this,"_scfl_tileOnce");a.removeObserver("calculatedWidth",this,"_scfl_tileOnce");a.removeObserver("calculatedHeight",this,"_scfl_tileOnce");a.removeObserver("startsNewRow",this,"_scfl_tileOnce");a.removeObserver("isSpacer",this,"_scfl_tileOnce");a.removeObserver("maxSpacerLength",this,"_scfl_tileOnce");a.removeObserver("fillWidth",this,"_scfl_tileOnce");a.removeObserver("fillHeight",this,"_scfl_tileOnce")},shouldIncludeChildInFlow:function(a,b){return b.get("isVisible")&&!b.get("useAbsoluteLayout")},flowSpacingForChild:function(a,b){var d=b.get("flowSpacing");if(SC.none(d)){d=this.get("defaultFlowSpacing")}if(SC.none(d)){d=0}if(SC.typeOf(d)===SC.T_NUMBER){d={left:d,right:d,bottom:d,top:d}}else{d.left=d.left||0;d.right=d.right||0;d.top=d.top||0;d.bottom=d.bottom||0}return d},flowSizeForChild:function(a,e){var d=e.get("calculatedWidth"),h=e.get("calculatedHeight"),k=this.get("layoutDirection"),g={},j=e.get("frame"),b=e.get("layout");e._scfl_lastFrame=j;if(d){g.width=d}else{g.width=b.width||j.width}if(h){g.height=h}else{g.height=b.height||j.height}if(e.get("isSpacer")){g.maxSpacerLength=e.get("maxSpacerLength");if(k===SC.LAYOUT_HORIZONTAL){g.width=b.minWidth||0}else{g.height=b.minHeight||0}}if(k===SC.LAYOUT_HORIZONTAL&&e.get("fillHeight")){g.height=b.minHeight||0}else{if(k===SC.LAYOUT_VERTICAL&&e.get("fillWidth")){g.width=b.minWidth||0}}return g},clippingFrame:function(){return{left:0,top:0,width:this.get("calculatedWidth"),height:this.get("calculatedHeight")}}.property("calculatedWidth","calculatedHeight"),_scfl_maxCollapsedRowLength:0,_scfl_totalCollapsedRowSize:0,_scfl_calculatedSizeDidChange:function(){if(this.get("autoResize")){if(this.get("layoutDirection")==SC.LAYOUT_VERTICAL){if(this.get("shouldResizeHeight")){this.adjust("minHeight",this.get("_scfl_maximumCollapsedRowLength"))}if(this.get("shouldResizeWidth")){this.adjust("minWidth",this.get("_scfl_totalCollapsedRowSize"))}}else{if(this.get("shouldResizeWidth")){this.adjust("minWidth",this.get("_scfl_maximumCollapsedRowLength"))}if(this.get("shouldResizeHeight")){this.adjust("minHeight",this.get("_scfl_totalCollapsedRowSize"))}}}}.observes("autoResize","shouldResizeWidth","_scfl_maximumCollapsedRowLength","_scfl_totalCollapsedRowSize","shouldResizeHeight"),_scfl_createPlan:function(){var f=this.get("layoutDirection"),a=this.get("_scfl_validFlowPadding"),e=this.get("frame");var d=(f===SC.LAYOUT_VERTICAL);var b={rows:undefined,maximumCollapsedRowLength:0,totalCollapsedRowSize:0,isVertical:f===SC.LAYOUT_VERTICAL,isHorizontal:f===SC.LAYOUT_HORIZONTAL,flowPadding:a,planStartPadding:a[d?"left":"top"],planEndPadding:a[d?"right":"bottom"],rowStartPadding:a[d?"top":"left"],rowEndPadding:a[d?"bottom":"right"],maximumRowLength:undefined,fitToPlanSize:undefined,align:this.get("align")};if(d){b.maximumRowLength=e.height-b.rowStartPadding-b.rowEndPadding;b.fitToPlanSize=e.width-b.planStartPadding-b.planEndPadding}else{b.maximumRowLength=e.width-b.rowStartPadding-b.rowEndPadding;b.fitToPlanSize=e.height-b.planStartPadding-b.planEndPadding}return b},_scfl_distributeChildrenIntoRows:function(e){var b=this.get("childViews"),a,h,d=b.length,f=e.isVertical,k=[],g;g=-1;h=0;while(h<d&&h!==g){g=h;var j={plan:e,rowLength:undefined,rowSize:undefined,shouldExpand:undefined,items:undefined,position:undefined};h=this._scfl_distributeChildrenIntoRow(b,h,j);k.push(j)}e.rows=k},_scfl_distributeChildrenIntoRow:function(f,o,k){var q,w=f.length,b=k.plan,h,a,e,s=[],m=0,n=b.isVertical,l,g,d,p=this.get("canWrap"),j=NO,t=0,v=k.plan.maximumRowLength;for(q=o;q<w;q++){h=f[q];j=j||(s.length>0&&h.get("startsNewRow"));if(!this.shouldIncludeChildInFlow(q,h)){continue}a=this.flowSizeForChild(q,h);e=this.flowSpacingForChild(q,h);a.width+=e.left+e.right;a.height+=e.top+e.bottom;g=a[n?"height":"width"];if(!SC.none(a.maxSpacerLength)){d=a.maxSpacerLength+(n?e.top+e.bottom:e.left+e.right)}l=a[n?"width":"height"];if((j||(p&&m+g>v))&&s.length>0){break}var x={child:h,itemLength:g,maxSpacerLength:d,itemSize:l,spacing:e,position:undefined,fillRow:n?h.get("fillWidth"):h.get("fillHeight"),isSpacer:h.get("isSpacer"),left:undefined,top:undefined,width:undefined,height:undefined};s.push(x);m+=g;t=Math.max(g,t)}k.rowLength=m;var u=p?t:k.rowLength;k.plan.maximumCollapsedRowLength=Math.max(u,k.plan.maximumCollapsedRowLength);k.items=s;return q},_scfl_positionChildrenInRows:function(e){var d=e.rows,b=d.length,a;for(a=0;a<b;a++){this._scfl_positionChildrenInRow(d[a])}},_scfl_positionChildrenInRow:function(o){var h=o.items,f=h.length,l,n,e,m=0,a=0,d,g=o.plan.align,k=YES,b=0,j=NO;for(l=0;l<f;l++){n=h[l];if(n.isSpacer){a+=n.child.get("spaceUnits")||1}}if(g===SC.ALIGN_JUSTIFY){a+=f-1}d=Math.max(0,o.plan.maximumRowLength-o.rowLength)/a;while(d>0){for(l=0;l<f;l++){n=h[l];if(n.isSpacer){n.itemLength+=d*(n.child.get("spaceUnits")||1);if(n.itemLength>n.maxSpacerLength){b+=n.itemLength-n.maxSpacerLength;n.itemLength=n.maxSpacerLength}else{j=YES}}}if(!j){break}d=Math.round(b/a);b=0}e=0;if(a===0&&(g===SC.ALIGN_RIGHT||g===SC.ALIGN_BOTTOM)){e=o.plan.maximumRowLength-o.rowLength}else{if(a===0&&(g===SC.ALIGN_CENTER||g===SC.ALIGN_MIDDLE)){e=(o.plan.maximumRowLength/2)-(o.rowLength/2)}}e+=o.plan.rowStartPadding;for(l=0;l<f;l++){n=h[l];if(!n.fillRow){k=NO}m=Math.max(n.itemSize,m);n.position=e;e+=n.itemLength;if(g===SC.ALIGN_JUSTIFY&&l<f-1){e+=d}}o.shouldExpand=f>0?k:NO;o.rowLength=e-o.plan.rowStartPadding;o.rowSize=m;o.plan.totalCollapsedRowSize+=o.rowSize},_scfl_positionRows:function(e){var k=e.rows,d=k.length,g,j,b,a=0,h=0,f;for(g=0;g<d;g++){if(k[g].shouldExpand){a++}h+=k[g].rowSize}f=e.fitToPlanSize-h;b=e.planStartPadding;for(g=0;g<d;g++){j=k[g];if(j.shouldExpand&&f>0){j.rowSize+=f/a;a--}j.position=b;b+=j.rowSize}},_scfl_applyPlan:function(j){var p=j.rows,b,d,o,f=0,l=0,h,a,e,n,g,m,k=j.isVertical;d=p.length;for(b=0;b<d;b++){o=p[b];f=Math.max(f,o.rowLength);l+=o.rowSize;h=o.items;e=h.length;for(a=0;a<e;a++){n=h[a];n.child.beginPropertyChanges();m=n.fillRow?o.rowSize:n.itemSize;g={left:n.spacing.left+(k?o.position:n.position),top:n.spacing.top+(k?n.position:o.position),width:k?m:n.itemLength,height:k?n.itemLength:m};g.width-=n.spacing.left+n.spacing.right;g.height-=n.spacing.top+n.spacing.bottom;this.applyPlanToView(n.child,g);n.child._scfl_lastLayout=g;n.child.endPropertyChanges()}}l+=j.planStartPadding+j.planEndPadding;f+=j.rowStartPadding+j.rowEndPadding;this.beginPropertyChanges();this.set("calculatedHeight",k?f:l);this.set("calculatedWidth",k?l:f);this.set("_scfl_maximumCollapsedRowLength",j.maximumCollapsedRowLength);this.set("_scfl_totalCollapsedRowSize",j.totalCollapsedRowSize);this.endPropertyChanges()},applyPlanToView:function(a,b){a.adjust(b)},_scfl_tileOnce:function(){this.invokeLast(this._scfl_tile)},_scfl_tile:function(){if(!this.get("isVisibleInWindow")){return}var g=this._scfl_createPlan();this._scfl_distributeChildrenIntoRows(g);this._scfl_positionChildrenInRows(g);this._scfl_positionRows(g);this._scfl_applyPlan(g);this.setIfChanged("numberOfRows",g.rows.length);var e=this._scfl_isObserving||SC.CoreSet.create(),d=SC.CoreSet.create();var f=this.get("childViews"),b=f.length,a,h;for(a=0;a<b;a++){h=f[a];if(!e.contains(h)){this.observeChildLayout(h)}else{e.remove(h)}d.add(h)}b=e.length;for(a=0;a<b;a++){this.unobserveChildLayout(e[a])}},_scfl_frameDidChange:function(){var b=this.get("frame"),a=this._scfl_lastFrameSize||{};this._scfl_lastFrameSize=SC.clone(b);if(a.width==b.width&&a.height==b.height){return}this._scfl_tileOnce()}.observes("frame"),destroyMixin:function(){var d=this._scfl_isObserving;if(!d){return}var b=d.length,a;for(a=0;a<b;a++){this.unobserveChildLayout(d[a])}},reorder:function(b){if(!SC.typeOf(b)===SC.T_ARRAY){b=arguments}var d=b.length,e=this.childViews,a;this.beginPropertyChanges();while(d-->0){a=b[d];if(SC.typeOf(a)===SC.T_STRING){a=this.get(a)}e.removeObject(a);e.unshiftObject(a)}this.endPropertyChanges();this._scfl_childViewsDidChange();return this}};SC.Gesturable={concatenatedProperties:["gestures"],gestures:[],initMixin:function(){this.createGestures()},createGestures:function(){var f=this.get("gestures"),b,a=f.length,d,e=[];for(b=0;b<a;b++){if(SC.typeOf(f[b])===SC.T_STRING){d=this.get(f[b])}else{d=f[b]}if(!d){throw"Could not find gesture named '"+f[b]+"' on view."}if(d.isClass){d=d.create({view:this})}if(SC.typeOf(f[b])===SC.T_STRING){this[f[b]]=d}e.push(d)}this.set("gestures",e)},touchStart:function(a){this.gestureTouchStart(a)},touchesDragged:function(a,b){this.gestureTouchesDragged(a,b)},touchEnd:function(a){this.gestureTouchEnd(a)},gestureTouchStart:function(f){f.isInteresting=0;var e=this.get("gestures"),b,a=e.length,d;for(b=0;b<a;b++){d=e[b];d.unassignedTouchDidStart(f)}},gestureTouchesDragged:function(d,f){var h=this.get("gestures"),b,a=h.length,e;for(b=0;b<a;b++){e=h[b];e.unassignedTouchesDidChange(d,f)}},gestureTouchEnd:function(f){var e=this.get("gestures"),b,a=e.length,d;for(b=0;b<a;b++){d=e[b];d.unassignedTouchDidEnd(f)}}};SC.InlineEditable={isInlineEditable:YES,isEditable:YES,exampleEditor:SC.InlineTextFieldView,isEditing:NO,inlineEditorDelegate:SC.InlineTextFieldDelegate,_editor:null,beginEditing:function(){var a;a=this.delegateFor("inlineEditorShouldBeginEditing",this.inlineEditorDelegate);if(a&&!a.inlineEditorShouldBeginEditing(this,this.get("value"))){return NO}this._editor=this.invokeDelegateMethod(this.inlineEditorDelegate,"acquireEditor",this);if(this._editor){return this._editor.beginEditing(this)}else{return NO}},commitEditing:function(){return this._editor?this._editor.commitEditing():NO},discardEditing:function(){return this._editor?this._editor.discardEditing():NO},inlineEditorShouldBeginEditing:function(){return !this.get("isEditing")&&this.get("isEditable")},inlineEditorWillBeginEditing:function(b,d,a){b.set("value",this.get("value"))},inlineEditorDidBeginEditing:function(b,d,a){this.set("isEditing",YES)},inlineEditorWillCommmitEditing:function(b,d,a){if(this.inlineEditorWillEndEditing){this.inlineEditorWillEndEditing(b,d)}},inlineEditorDidCommitEditing:function(b,d,a){a.setIfChanged("value",d);if(this.inlineEditorDidEndEditing){this.inlineEditorDidEndEditing(b,d)}this._endEditing()},inlineEditorWillDiscardEditing:function(b,a){if(this.inlineEditorWillEndEditing){this.inlineEditorWillEndEditing(b,this.get("value"))}},inlineEditorDidDiscardEditing:function(b,a){if(this.inlineEditorDidEndEditing){this.inlineEditorDidEndEditing(b,this.get("value"))}this._endEditing()},_endEditing:function(){if(this._editor){this.invokeDelegateMethod(this.inlineEditorDelegate,"releaseEditor",this._editor);this._editor=null}this.set("isEditing",NO)}};SC.InlineEditor={isInlineEditor:YES,isEditing:NO,inlineEditorDelegate:null,_target:null,beginEditing:function(b){if(this.get("isEditing")||!b||!b.isInlineEditable){return NO}var a,d;d=this._target=b;a=this.delegateFor("inlineEditorWillBeginEditing",this.inlineEditorDelegate,d);if(a){a.inlineEditorWillBeginEditing(this,this.get("value"),d)}this.set("isEditing",YES);this.invokeLast(this._callDidBegin);this._didBeginInvoked=YES;return YES},_callDidBegin:function(){if(!this.get("isEditing")){return NO}this._didBeginInvoked=NO;var b=this._target,a;a=this.delegateFor("inlineEditorDidBeginEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorDidBeginEditing(this,this.get("value"),b)}},commitEditing:function(){if(!this.get("isEditing")){return NO}if(this._didBeginInvoked){this._callDidBegin()}var a,b=this._target;a=this.delegateFor("inlineEditorShouldCommitEditing",this.inlineEditorDelegate,b);if(a&&!a.inlineEditorShouldCommitEditing(this,this.get("value"),b)){return NO}a=this.delegateFor("inlineEditorWillCommitEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorWillCommitEditing(this,this.get("value"),b)}this._endEditing();a=this.delegateFor("inlineEditorDidCommitEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorDidCommitEditing(this,this.get("value"),b)}return YES},discardEditing:function(){if(!this.get("isEditing")){return NO}if(this._didBeginInvoked){this._callDidBegin()}var a,b=this._target;a=this.delegateFor("inlineEditorShouldDiscardEditing",this.inlineEditorDelegate,b);if(a&&!a.inlineEditorShouldDiscardEditing(this,b)){return NO}a=this.delegateFor("inlineEditorWillDiscardEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorWillDiscardEditing(this,b)}this._endEditing();a=this.delegateFor("inlineEditorDidDiscardEditing",this.inlineEditorDelegate,b);if(a){a.inlineEditorDidDiscardEditing(this,b)}return YES},_endEditing:function(){this.set("isEditing",NO);this._target=null}};SC.InlineEditorDelegate={acquireEditor:function(a){},releaseEditor:function(a){},inlineEditorShouldBeginEditing:function(a,b){},inlineEditorWillBeginEditing:function(b,d,a){},inlineEditorDidBeginEditing:function(b,d,a){},inlineEditorShouldCommitEditing:function(b,d,a){},inlineEditorWillCommitEditing:function(b,d,a){},inlineEditorDidCommitEditing:function(b,d,a){},inlineEditorShouldDiscardEditing:function(b,a){},inlineEditorWillDiscardEditing:function(b,a){},inlineEditorDidDiscardEditing:function(b,a){},inlineEditorWillEndEditing:function(b,d,a){},inlineEditorDidEndEditing:function(b,d,a){}};SC.SCALE_NONE="none";SC.FILL="fill";SC.FILL_PROPORTIONALLY="fillProportionally";SC.BEST_FIT="fitBest";SC.BEST_FIT_DOWN_ONLY="fitBestDown";SC.InnerFrame={align:SC.ALIGN_CENTER,innerFrameForSize:function(a,d,j,b){var f=this.get("align"),e=this.get("scale"),h,g,k;k={x:0,y:0,width:j,height:b};if(e===SC.FILL){return k}h=j/a;g=b/d;switch(e){case SC.FILL_PROPORTIONALLY:e=h>g?h:g;break;case SC.BEST_FIT:e=h<g?h:g;break;case SC.BEST_FIT_DOWN_ONLY:if((a>j)||(d>b)){e=h<g?h:g}else{e=1}break;case SC.SCALE_NONE:e=1;break;default:if(isNaN(window.parseFloat(e))||(window.parseFloat(e)<=0)){SC.Logger.warn("SC.InnerFrame: The scale '%@' was not understood.  Scale must be one of SC.FILL, SC.FILL_PROPORTIONALLY, SC.BEST_FIT, SC.BEST_FIT_DOWN_ONLY or a positive number greater than 0.00.".fmt(e));return k}}a*=e;d*=e;k.width=Math.round(a);k.height=Math.round(d);switch(f){case SC.ALIGN_LEFT:k.x=0;k.y=(b/2)-(d/2);break;case SC.ALIGN_RIGHT:k.x=j-a;k.y=(b/2)-(d/2);break;case SC.ALIGN_TOP:k.x=(j/2)-(a/2);k.y=0;break;case SC.ALIGN_BOTTOM:k.x=(j/2)-(a/2);k.y=b-d;break;case SC.ALIGN_TOP_LEFT:k.x=0;k.y=0;break;case SC.ALIGN_TOP_RIGHT:k.x=j-a;k.y=0;break;case SC.ALIGN_BOTTOM_LEFT:k.x=0;k.y=b-d;break;case SC.ALIGN_BOTTOM_RIGHT:k.x=j-a;k.y=b-d;break;default:if(f!==SC.ALIGN_CENTER&&f!==SC.ALIGN_MIDDLE){SC.Logger.warn("SC.InnerFrame: The align '%@' was not understood.  Align must be one of SC.ALIGN_CENTER/SC.ALIGN_MIDDLE, SC.ALIGN_LEFT, SC.ALIGN_RIGHT, SC.ALIGN_TOP, SC.ALIGN_BOTTOM, SC.ALIGN_TOP_LEFT, SC.ALIGN_TOP_RIGHT, SC.ALIGN_BOTTOM_LEFT or SC.ALIGN_BOTTOM_RIGHT.".fmt(f))}k.x=(j/2)-(a/2);k.y=(b/2)-(d/2)}return k},scale:SC.FILL};SC.StaticLayout={hasStaticLayout:YES};SC.Validatable={initMixin:function(){this._validatable_validatorDidChange()},validator:null,errorLabel:null,isValid:function(){return SC.typeOf(this.get("value"))!==SC.T_ERROR}.property("value"),ownerForm:null,performValidate:function(d){var a=SC.VALIDATE_OK;if(this._validator){var b=this.get("ownerForm");if(d){a=this._validator.validatePartial(b,this);if((a==SC.VALIDATE_NO_CHANGE)&&(this._validator.validateChange(b,this)==SC.VALIDATE_OK)){a=SC.VALIDATE_OK}}else{a=this._validator.validateChange(b,this)}}return a},performValidateSubmit:function(){return this._validator?this._validator.validateSubmit(this.get("ownerForm"),this):SC.VALIDATE_OK},performValidateKeyDown:function(a){var b=a.getCharString();if(!b){return this.needValidChar?NO:YES}return this._validator?this._validator.validateKeyDown(this.get("ownerForm"),this,b):YES},validatorObject:function(){return this._validator}.property(),validateSubmit:function(){return this.performValidateSubmit()},objectForFieldValue:function(b,a){return this._validator?this._validator.objectForFieldValue(b,this.get("ownerForm"),this):b},fieldValueForObject:function(a){return this._validator?this._validator.fieldValueForObject(a,this.get("ownerForm"),this):a},_validatable_displayObserver:function(){this.displayDidChange()}.observes("isValid"),renderMixin:function(a){a.setClass("invalid",!this.get("isValid"))},_validatable_validatorDidChange:function(){var a=this.get("ownerForm");var b=SC.Validator.findFor(a,this,this.get("validator"));if(b!=this._validator){this.propertyWillChange("validatorObject");if(this._validator){this._validator.detachFrom(a,this)}this._validator=b;if(this._validator){this._validator.attachTo(a,this)}this.propertyDidChange("validatorObject")}}.observes("validator","ownerForm")};SC.RenderDelegate={create:function(){var d=SC.beget(this);var b,a=arguments.length;for(b=0;b<a;b++){d.mixin(arguments[b])}return d},reopen:function(b){var d,a;for(d in b){a=b[d];if(!b.hasOwnProperty(d)){continue}if(typeof a==="function"&&a!==this[d]){a.base=this[d]||SC.K}if(a&&a.isEnhancement&&a!==this[d]){a=SC._enhance(this[d]||SC.K,a)}this[d]=a}},get:function(a){return this[a]},getPropertyFor:function(b,a){if(this[a+"For"]){return this[a+"For"](b,a)}return this[a]},className:undefined,render:function(b,a){},update:function(b,a){}};SC.RenderDelegate.extend=SC.RenderDelegate.create;SC.RenderDelegate.mixin=SC.RenderDelegate.reopen;sc_require("render_delegates/render_delegate");SC.BaseTheme.canvasImageRenderDelegate=SC.RenderDelegate.create({className:"canvasImage",render:function(e,b){var d=e.get("width")||0,a=e.get("height")||0;b.attr("width",d);b.attr("height",a)},update:function(a,f){var h=f[0],k=a.get("image"),e=a.get("frame"),n=e.width,l=e.height,m=a.get("innerFrame"),o=a.get("backgroundColor"),q=a.get("renderState"),b;var p=![m.x,m.y,m.width,m.height].isEqual(q._lastInnerFrameValues),j=![h.width,h.height].isEqual(q._lastElemSizeValues),g=a.didChangeFor("canvasImageRenderDelegate","backgroundColor"),d=a.didChangeFor("canvasImageRenderDelegate","image")||(k&&k.complete)!==q._lastImageComplete;if(j||p||g||d){if(h&&h.getContext){h.height=l;h.width=n;b=h.getContext("2d");b.clearRect(0,0,n,l);if(o){b.fillStyle=o;b.fillRect(0,0,n,l)}if(k&&k.complete){b.drawImage(k,Math.floor(m.x),Math.floor(m.y),Math.floor(m.width),Math.floor(m.height))}}q._lastInnerFrameValues=[m.x,m.y,m.width,m.height];q._lastElemSizeValues=[h.width,h.height];q._lastImageComplete=k&&k.complete}}});sc_require("render_delegates/render_delegate");SC.BaseTheme.containerRenderDelegate=SC.RenderDelegate.create({render:function(b,a){},update:function(){}});sc_require("render_delegates/render_delegate");SC.RenderDelegate.reopen({sizes:[SC.TINY_CONTROL_SIZE,SC.SMALL_CONTROL_SIZE,SC.REGULAR_CONTROL_SIZE,SC.LARGE_CONTROL_SIZE,SC.HUGE_CONTROL_SIZE,SC.JUMBO_CONTROL_SIZE],sizeFor:function(g){var f=g.get("controlSize"),d,b,a;if(f){if(!this[f]){this[f]={}}d=this[f];if(!d.name){d.name=f}return d}var e=g.get("frame");if(!e){d=this["sc-regular-size"];if(!d){d=this["sc-regular-size"]={}}if(!d.name){d.name="sc-regular-size"}return d}for(b=0;b<a;b++){key=sizes[b];d=this[key];if(!d){continue}if((d.width===undefined&&d.height===undefined&&d.minHeight===undefined&&d.minWidth===undefined&&d.maxHeight===undefined&&d.maxWidth===undefined)||(d.width!==undefined&&e.width!==d.width)||(d.minWidth!==undefined&&e.width<d.minWidth)||(d.maxWidth!==undefined&&e.width>d.maxWidth)||(d.height!==undefined&&e.height!==d.height)||(d.minHeight!==undefined&&e.height<d.minHeight)||(d.maxHeight!==undefined&&e.height<d.maxHeight)){continue}if(!d.name){d.name=key}return d}d=this["sc-regular-size"];if(!d){d=this["sc-regular-size"]={}}if(!d.name){d.name="sc-regular-size"}return d},addSizeClassName:function(d,b){var a=this.sizeFor(d);if(a){b.addClass(a.name)}},updateSizeClassName:function(d,a){var b=this.sizeFor(d);if(b){a.addClass(b.name)}},getPropertyFor:function(d,a){var b=this.sizeFor(d);if(b){if(b[a+"For"]){return b[a+"For"](d,a)}else{if(b[a]!==undefined){return b[a]}}}if(this[a+"For"]){return this[a+"For"]}return this[a]}});sc_require("render_delegates/render_delegate");SC.BaseTheme.imageRenderDelegate=SC.RenderDelegate.create({className:"image",render:function(g,d){var f=g.get("image"),b=g.get("imageValue"),e=g.get("type")||SC.IMAGE_TYPE_URL,a=g.get("toolTip");d=d.begin("img");d.attr("src",f.src);if(b&&e===SC.IMAGE_TYPE_CSS_CLASS){d.addClass(b);this._last_class=b}if(a){d.attr("title",a);d.attr("alt",a)}d.addStyle(this.imageStyles(g));d=d.end()},update:function(f,a){var e=f.get("image"),d=f.get("imageValue"),b=f.get("toolTip");a=a.find("img");a.attr("src",e.src);if(d!==this._last_class){a.setClass(this._last_class,NO)}if(d){a.addClass(d);this._last_class=d}if(b){a.attr("title",b);a.attr("alt",b)}a.css(this.imageStyles(f))},imageStyles:function(b){var a=b.get("innerFrame");return{position:"absolute",left:Math.round(a.x),top:Math.round(a.y),width:Math.round(a.width),height:Math.round(a.height)}}});sc_require("render_delegates/render_delegate");SC.BaseTheme.labelRenderDelegate=SC.RenderDelegate.create({className:"label",render:function(e,d){this.addSizeClassName(e,d);var a=e.get("toolTip");if(a){d.attr("title",a)}d.addStyle({fontWeight:e.get("fontWeight")||null,textAlign:e.get("textAlign")||null});d.setClass("ellipsis",e.get("needsEllipsis")||NO);d.setClass("icon",e.get("icon")||NO);var b=this.htmlForTitleAndIcon(e);d.push(b);e.get("renderState")._lastHTMLForTitleAndIcon=b},update:function(e,a){this.updateSizeClassName(e,a);a.css({fontWeight:e.get("fontWeight")||null,textAlign:e.get("textAlign")||null});var b=e.get("toolTip");if(b){a.attr("title",b)}else{a.removeAttr("title")}a.setClass("ellipsis",e.get("needsEllipsis")||NO);var d=this.htmlForTitleAndIcon(e);if(e.get("renderState")._lastHTMLForTitleAndIcon!==d){a.html(d);e.get("renderState")._lastHTMLForTitleAndIcon=d}},htmlForTitleAndIcon:function(f){var e=f.get("title"),d=f.get("hint"),b=f.get("escapeHTML"),a=f.get("icon")||"";if(e&&b){e=SC.RenderContext.escapeHTML(e)}if(b){d=SC.RenderContext.escapeHTML(d)}if(d&&!e){e="<span class='sc-hint'>"+d+"</span>"}if(a){if(a.indexOf("/")>=0){a='<img src="'+a+'" alt="" class="icon" />'}else{a='<img src="'+SC.BLANK_IMAGE_URL+'" alt="" class="icon '+a+'" />'}}return a+(SC.none(e)?"":e)}});sc_require("core");SC.Benchmark={verbose:NO,enabled:YES,events:{},stats:{},globalStartTime:null,addEvent:function(a,b){if(!b){b=new Date().getTime()}this.events[a]=b},start:function(b,a,f,e){if(!this.enabled){return}var g=(f||Date.now()),d;if(a){d=this._subStatFor(b,a)}else{d=this._statFor(b)}if(e&&d._starts.length>0){d._starts.push("ignore")}else{d._starts.push(g)}d._times.push({start:g,_subStats:{}});return b},end:function(d,b,g){var f;if(!this.enabled){return}if(b){f=this._subStatFor(d,b)}else{f=this._statFor(d)}var h=f._starts.pop();if(!h){SC.Logger.log('SC.Benchmark "%@" ended without a matching start.  No information was saved.'.fmt(d));return}if(h=="ignore"){return}var a=(g||Date.now());var e=a-h;f._times[f._times.length-1].end=a;f._times[f._times.length-1].dur=e;f.amt+=e;f.runs++;if(this.verbose){this.log(d)}},setGlobalStartTime:function(a){this.globalStartTime=a},bench:function(f,e,a){if(!e){e="bench%@".fmt(this._benchCount++)}if(!a){a=1}var b;while(--a>=0){var d=SC.Benchmark.start(e);b=f();SC.Benchmark.end(d)}return b},install:function(a,e,b){a["b__"+e]=a[e];var d=a["b__"+e];a[e]=function(){var g="%@(%@)".fmt(e,$A(arguments).join(", "));SC.Benchmark.start(g,b);var f=d.apply(this,arguments);SC.Benchmark.end(g);return f}},restore:function(a,b){a[b]=a["b__"+b]},report:function(d){if(d){return this._genReport(d)}var b=[];for(var a in this.stats){if(!this.stats.hasOwnProperty(a)){continue}b.push(this._genReport(a))}return b.join("\n")},timelineReport:function(a){a=(a)?"SproutCore Application":a;var b=[a,"User-Agent: %@".fmt(navigator.userAgent),"Report Generated: %@ (%@)".fmt(new Date().toString(),Date.now()),""];var e=this._compileChartData(true);for(var d=0;d<e.length;d++){if(e[d][4]){b.push(this._timelineGenSubReport(e[d]))}else{b.push(this._timelineGenReport(e[d]))}}return b.join("\n")},getTimelineChartContent:function(){var m=this._compileChartData(false);var h=m.length;if(h===0){return}var d=this.globalStartTime?this.globalStartTime:m[0][1];var e=m[h-1][2]-d;var o=25+h*30;var s=Math.ceil(e/200)+1;var u=s*50;var n=10,v=300;var p="<div class = 'sc-benchmark-timeline-chart' style = 'position:relative;'>";p+="<div class = 'sc-benchmark-top'></div>";for(var q=0;q<s;q++){p+="<div class = 'sc-benchmark-tick' style = '";p+="left: "+(n+q*50)+"px; ";p+="height: "+o+"px;";p+="'></div>";p+="<div class = 'sc-benchmark-tick-label' style = '";p+="left: "+(n+q*50)+"px; ";p+="'>"+(q*200)+"ms</div>"}for(q=0;q<h;q++){p+="<div class = 'sc-benchmark-row ";p+=(q%2===0)?"even":"odd";p+="' style = '";p+="top: "+(50+(q*30))+"px; ";p+="'></div>";var k=document.createElement("div");var g=m[q][1];var f=m[q][2];var a=m[q][3];p+="<div class = 'sc-benchmark-bar' style = '";p+="left:"+(n+((g-d)/4))+"px; width: "+((a/4))+"px;";p+="top: "+(28+(q*30))+"px;";p+="' title = 'start: "+(g-d)+" ms, end: "+(f-d)+" ms, duration: "+a+" ms'";p+=">";p+="&nbsp;"+m[q][0]+" <span class='sc-benchmark-emphasis'>";p+=a+"ms (start: "+(g-d)+"ms)";p+="</span>";p+="</div>"}var b=this.events,l=0;for(q in b){var j=b[q]-d;p+="<div class = 'sc-benchmark-event idx"+(l%10)+"' style = '";p+="left: "+(n+j/4)+"px; height: "+o+"px; top: 20px;";p+="' title = '"+q+": "+j+"'></div>";l++}p+="</div>";return{html:p,totalCapturedTime:e,pointsCaptured:h,width:u+n+v,height:o}},getTimelineChartView:function(){var a=SC.ScrollView.create({contentView:SC.StaticContentView.extend({}),reload:function(){var b=SC.Benchmark.getTimelineChartContent();this.contentView.set("content",b.html);this.contentView.adjust({width:b.width,height:b.height});this.chartContent=b;SC.RunLoop.invokeLater(SC.Benchmark,function(){this.contentView.notifyPropertyChange("frame")})}});a.reload();return a},timelineChart:function(a){SC.RunLoop.begin();var d=0;this.hideChart();var b=this.getTimelineChartView();var f=b.chartContent.pointsCaptured,e=b.chartContent.totalCapturedTime;this._benchmarkChart=SC.Pane.create({classNames:["sc-benchmark-pane"],layout:{left:20,right:20,bottom:20,top:20},childViews:["title","exit"],exit:SC.ButtonView.extend({layout:{right:20,top:20,width:100,height:30},title:"Hide Chart",target:this,action:"hideChart"}),title:SC.LabelView.extend({classNames:["sc-benchmark-title"],layout:{left:20,top:23,right:200,height:30},value:((a)?a:"SproutCore Application")+(" - Total Captured Time: "+e+" ms - Points Captured: "+f),fontWeight:"bold"})}).append();b.set("layout",{left:20,top:60,bottom:20,right:20});this._benchmarkChart.appendChild(b);SC.RunLoop.end()},hideChart:function(){if(this._benchmarkChart){this._benchmarkChart.remove();this._benchmarkChart=null}return YES},tryToPerform:function(b,a){if(this[b]){return this[b](a)}return NO},log:function(e){var d=this.report(e).split("\n"),b=d.length,a;for(a=0;a<b;a++){SC.Logger.log(d[a])}},startProfile:function(a){if(!this.enabled){return}SC.Logger.profile(a)},endProfile:function(a){if(!this.enabled){return}SC.Logger.profileEnd(a)},loadPreloadEvents:function(){var g=SC.benchmarkPreloadEvents,f=[],b,a,d;if(typeof webkitPerformnce!=="undefined"){SC.mixin(g,webkitPerformane.timing)}if(!this.globalStartTime){var e=["navigation","navigationStart","headStart"];a=e.length;for(b=0;b<a;b++){if(g[e[b]]){this.globalStartTime=g[e[b]];break}}}this.javascriptStartTime=g.headStart;SC.mixin(this.events,g);this._hasLoadedPreloadEvents=true},_loadBenchmarksFromEvents:function(){if(!this._hasLoadedPreloadEvents){this.loadPreloadEvents()}var b=this.events;for(var a in b){if(a.substr(-3)!=="End"){continue}var d=a.substr(0,a.length-3);if(!b[d+"Start"]){continue}SC.Benchmark.start(d,undefined,b[d+"Start"]);SC.Benchmark.end(d,undefined,b[d+"End"]);delete b[d+"Start"];delete b[d+"End"]}},_compileChartData:function(h){this._loadBenchmarksFromEvents();var m=[],a;for(var n in this.stats){var f=this.stats[n];for(var g=0;g<f._times.length;g++){var o=f._times[g];a=(f._times.length>1)?(g+1)+" - "+n:n;m.push([a,o.start,o.end,o.dur,false]);if(h){var b=o._subStats;for(var d in b){var l=b[d];for(var e=0;e<l._times.length;e++){var p=l._times[e];a=(l._times.length>1)?(e+1)+" - "+d:d;m.push([a,p.start,p.end,p.dur,true])}}}}}m.sort(function(k,j){if(k[1]<j[1]){return -1}else{if(k[1]==j[1]){if(k[3]&&!j[3]){return -1}if(!k[3]&&j[3]){return 1}return 0}}return 1});return m},_genReport:function(a){var b=this._statFor(a);var e=(b.runs>0)?(Math.floor(b.amt*1000/b.runs)/1000):0;var d=b._times[b._times.length-1];return"BENCH %@ msec: %@ (%@x); latest: %@".fmt(e,(b.name||a),b.runs,d.end-d.start)},_timelineGenReport:function(a){if(this.globalStartTime){return"BENCH start: %@ msec, duration: %@ msec,  %@".fmt((a[1]-this.globalStartTime),a[3],a[0])}else{return"BENCH duration: %@ msec, %@".fmt(a[3],a[0])}},_timelineGenSubReport:function(a){if(this.globalStartTime){return"   CHECKPOINT BENCH start: %@ msec, duration: %@ msec,  %@".fmt((a[1]-this.globalStartTime),a[3],a[0])}else{return"   CHECKPOINT BENCH duration: %@ msec, %@".fmt(a[3],a[0])}},_subStatFor:function(e,d){var f=this.stats[d]._times.length;if(f===0){return}var a=this.stats[d]._times[this.stats[d]._times.length-1]._subStats;var b=a[e];if(!b){a[e]={runs:0,amt:0,name:e,_starts:[],_times:[]};b=a[e]}return b},_statFor:function(b){var a=this.stats[b];if(!a){a=this.stats[b]={runs:0,amt:0,name:b,_starts:[],_times:[]};a=this.stats[b]}return a},reset:function(){this.stats={}},_bench:function(b,a){SC.Benchmark.bench(b,a,1)},_benchCount:1};SC.Benchmark=SC.Benchmark;SC.Cookie=SC.Object.extend({name:null,value:"",expires:null,path:null,domain:null,secure:NO,isCookie:YES,destroy:function(){this.set("expires",-1);this.write();arguments.callee.base.apply(this,arguments)},write:function(){var e=this.get("name"),g=this.get("value"),a=this.get("expires"),j=this.get("path"),f=this.get("domain"),h=this.get("secure"),b="",d;if(a){if(typeof a===SC.T_NUMBER){d=new Date();d.setTime(d.getTime()+(a*24*60*60*1000))}else{if(SC.DateTime&&a.get&&a.get("milliseconds")){d=new Date(a.get("milliseconds"))}else{if(a.toUTCString&&a.toUTCString.apply){d=a}}}if(d){b="; expires="+d.toUTCString()}}if(!SC.none(j)){b+="; path="+j}if(!SC.none(f)){b+="; domain="+f}if(h===YES){b+="; secure"}document.cookie=e+"="+encodeURIComponent(g)+b;return this}});SC.Cookie.mixin({find:function(a){if(document.cookie&&document.cookie!==""){var e=document.cookie.split(";");for(var d=0;d<e.length;d++){var b=SC.String.trim(String(e[d]));if(b.substring(0,a.length+1)===(a+"=")){return SC.Cookie.create({name:a,value:decodeURIComponent(b.substring(a.length+1))})}}}return null}});SC.CookieMonster={nomNomNom:function(b){var a=SC.kindOf(b,SC.Cookie);if(a){SC.Logger.log("YUM!");return b.destroy()}SC.Logger.error("Y U PASS ME NO COOKIE? %@",b);return NO}};SC.mixin(SC.$.fn,{setClass:function(e,d){if(SC.none(e)){return this}var f=SC.typeOf(e)!==SC.T_STRING,a=this._fixupClass,b;this.each(function(){if(this.nodeType!==1){return}var j=this.className.split(/\s+/),h=NO;if(f){for(var g in e){if(e.hasOwnProperty(g)){h=a(j,g,e[g])||h}}}else{h=a(j,e,d)}if(h){this.className=j.join(" ")}});return this},_fixupClass:function(e,a,d){var b=e.indexOf(a);if(d){if(b<0){e.push(a);return YES}}else{if(b>=0){e[b]=null;return YES}}return NO}});SC.ExceptionHandler={enabled:(SC.buildMode!=="debug"),handleException:function(a){if(this.isShowingErrorDialog){return NO}this._displayErrorDialog(a);return NO},_displayErrorDialog:function(b){var a=this._errorDialogHTMLForException(b),d=document.createElement("div");d.style.cssText="left: 0px; right: 0px; top: 0px; bottom: 0px; position: absolute; background-color: white; background-color: rgba(255,255,255,0.6); z-index:100;";d.innerHTML=a;document.body.appendChild(d);this.isShowingErrorDialog=YES},_errorDialogHTMLForException:function(b){var a;a=['<div id="sc-error-dialog" style="position: absolute; width: 500px; left: 50%; top: 50%; margin-left: -250px; background-color: white; border: 1px solid black; font-family: Monaco, monospace; font-size: 9px; letter-spacing: 1px; padding: 10px">',"An error has occurred which prevents the application from running:","<br><br>",b.message,'<div id="sc-error-dialog-reload-button" onclick="window.location.reload();" style="float: right; font-family: Monaco, monospace; font-size: 9px; letter-spacing: 1px; border: 1px solid black; padding: 3px; clear: both; margin-top: 20px; cursor: pointer;">',"Reload","</div>","</div>"];return a.join("")},isShowingErrorDialog:NO};SC.IMAGE_ABORTED_ERROR=SC.$error("SC.Image.AbortedError","Image",-100);SC.IMAGE_FAILED_ERROR=SC.$error("SC.Image.FailedError","Image",-101);SC.imageQueue=SC.Object.create({loadLimit:4,activeRequests:0,loadImage:function(a,f,g,e){var b=SC.typeOf(f);if(SC.none(g)&&SC.typeOf(f)===SC.T_FUNCTION){f=null;g=f}if(SC.typeOf(g)===SC.T_STRING){g=f[g]}if(SC.none(e)){e=SC.none(f)&&SC.none(g)}var d=this._imageEntryFor(a);if(d.status===this.IMAGE_LOADED){if(g){g.call(f||d.image,d.url,d.image)}}else{if(f||g){this._addCallback(d,f,g)}d.retainCount++;this._scheduleImageEntry(d,e)}},releaseImage:function(a,e,f){var d=this._imageEntryFor(a,NO);if(!d){return this}if(--d.retainCount<=0){this._deleteEntry(d)}else{if(e||f){var b=SC.typeOf(e);if(SC.none(f)&&SC.typeOf(e)===SC.T_FUNCTION){e=null;f=e}if(SC.typeOf(f)===SC.T_STRING){f=e[f]}this._removeCallback(d,e,f)}}},reloadImage:function(a){var b=this._imageEntryFor(a,NO);if(b&&b.status===this.IMAGE_LOADED){b.status=this.IMAGE_WAITING}},loadNextImage:function(){var d=null,a;if(this.get("activeRequests")>=this.get("loadLimit")){return}a=this._foregroundQueue;while(a.length>0&&!d){d=a.shift()}if(!d){a=this._backgroundQueue;while(a.length>0&&!d){d=a.shift()}}this.set("isLoading",!!d);if(d){var b=d.image;if(!b){return}$(b).bind("abort",this._imageDidAbort);$(b).bind("error",this._imageDidError);$(b).bind("load",this._imageDidLoad);b.src=d.url;this._loading.push(d);this.incrementProperty("activeRequests");this.loadNextImage()}},_imageEntryFor:function(d,a){if(a===undefined){a=YES}var e=this._images[d];if(!e&&a){var b=new Image();e=this._images[d]={url:d,status:this.IMAGE_WAITING,callbacks:[],retainCount:0,image:b};b.entry=e}else{if(e&&e.image===null){e.image=new Image();e.image.entry=e}}return e},_deleteEntry:function(a){this._unscheduleImageEntry(a);delete this._images[a.url]},_addCallback:function(d,e,f){var b=d.callbacks;var a=b.find(function(g){return g[0]===e&&g[1]===f},this);if(!a){b.push([e,f])}b=null;return this},_removeCallback:function(b,d,e){var a=b.callbacks;a.forEach(function(g,f){if(g[0]===d&&g[1]===e){a[f]=null}},this);a=null;return this},_scheduleImageEntry:function(e,d){var b=this._backgroundQueue;var f=this._foregroundQueue;if(e.status===this.IMAGE_LOADED){return this}if((e.status===this.IMAGE_QUEUED)&&!d&&e.isBackground){b[b.indexOf(e)]=null;e.status=this.IMAGE_WAITING}if(e.status!==this.IMAGE_QUEUED){var a=(d)?b:f;a.push(e);e.status=this.IMAGE_QUEUED;e.isBackground=d}if(!this.isLoading){this.invokeLater(this.loadNextImage,100)}this.set("isLoading",YES);return this},_unscheduleImageEntry:function(b){if(b.status!==this.IMAGE_QUEUED){return this}var a=b.isBackground?this._backgroundQueue:this._foregroundQueue;a[a.indexOf(b)]=null;if(this._loading.indexOf(b)>=0){if(a.image){a.image.abort()}this.imageStatusDidChange(b,this.ABORTED)}return this},_imageDidAbort:function(){SC.run(function(){SC.imageQueue.imageStatusDidChange(this.entry,SC.imageQueue.ABORTED)},this)},_imageDidError:function(){SC.run(function(){SC.imageQueue.imageStatusDidChange(this.entry,SC.imageQueue.ERROR)},this)},_imageDidLoad:function(){SC.run(function(){SC.imageQueue.imageStatusDidChange(this.entry,SC.imageQueue.LOADED)},this)},imageStatusDidChange:function(d,a){if(!d){return}var b=d.url;var e;switch(a){case this.LOADED:e=d.image;break;case this.ABORTED:e=SC.IMAGE_ABORTED_ERROR;break;case this.ERROR:e=SC.IMAGE_FAILED_ERROR;break;default:e=SC.IMAGE_FAILED_ERROR;break}d.callbacks.forEach(function(g){var h=g[0],j=g[1];j.call(h,b,e)},this);d.callbacks=[];d.status=(a===this.LOADED)?this.IMAGE_LOADED:this.IMAGE_WAITING;var f=d.image;if(f){f.onload=f.onerror=f.onabort=null;if(a!==this.LOADED){d.image=null}}this._loading[this._loading.indexOf(d)]=null;if(this._loading.length>this.loadLimit*2){this._loading=this._loading.compact()}this.decrementProperty("activeRequests");this.loadNextImage()},init:function(){arguments.callee.base.apply(this,arguments);this._images={};this._loading=[];this._foregroundQueue=[];this._backgroundQueue=[]},IMAGE_LOADED:"loaded",IMAGE_QUEUED:"queued",IMAGE_WAITING:"waiting",ABORTED:"aborted",ERROR:"error",LOADED:"loaded"});SC.Math=SC.Object.create({near:function(d,b,a){if(!a){a=0.00001}return Math.abs(d-b)<=a},round:function(e,a){if(!a){a=0}var b=Math.pow(10,a);if(a<0){var d=b.toString();b=d.substring(0,d.indexOf("1")+1)}e=e.valueOf();return Math.round(e*b)/b}});SC.Task=SC.Object.extend({run:function(a){}});sc_require("tasks/task");SC.LOG_MODULE_LOADING=YES;SC.Module=SC.Object.create({isModuleReady:function(a){var b=SC.MODULE_INFO[a];return b?!!b.isReady:NO},loadModule:function(b,h,a){var d=SC.MODULE_INFO[b],j,g,k=SC.A(arguments).slice(3),e=SC.LOG_MODULE_LOADING,l,f;if(a===undefined&&SC.typeOf(h)===SC.T_FUNCTION){a=h;h=null}if(e){SC.debug("SC.Module: Attempting to load '%@'",b)}if(!d){throw"SC.Module: could not find module '%@'".fmt(b)}d.isPrefetching=NO;if(d.isLoaded&&!d.isWaitingForRunLoop){if(e){SC.debug("SC.Module: Module '%@' already loaded.",b)}if(!this._dependenciesMetForModule(b)){this._addCallbackForModule(b,h,a,k);this._loadDependenciesForModule(b);return NO}if(d.source){if(e){SC.debug("SC.Module: Evaluating JavaScript for module '%@'.",b)}this._evaluateStringLoadedModule(d);this._addCallbackForModule(b,h,a,k);this.invokeLast(function(){d.isReady=YES;this._moduleDidBecomeReady(b)});return NO}if(a){if(SC.isReady){SC.Module._invokeCallback(b,h,a,k)}else{SC.ready(SC.Module,function(){SC.Module._invokeCallback(b,h,a,k)})}}return YES}else{if(d.isWaitingForRunLoop){this._addCallbackForModule(b,h,a,k)}else{if(e){SC.debug("SC.Module: Module '%@' is not loaded, loading now.",b)}this._addCallbackForModule(b,h,a,k);if(!d.isLoading){this._loadDependenciesForModule(b);this._loadCSSForModule(b);this._loadJavaScriptForModule(b);d.isLoading=YES}return NO}}},_addCallbackForModule:function(b,f,g,a){var d=SC.MODULE_INFO[b];var e=d.callbacks||[];if(g){e.push(function(){SC.Module._invokeCallback(b,f,g,a)})}d.callbacks=e},prefetchModule:function(a){var b=SC.MODULE_INFO[a];if(b.isLoading||b.isLoaded){return}if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Prefetching module '%@'.",a)}this._loadDependenciesForModule(a);this._loadCSSForModule(a);this._loadJavaScriptForModule(a);b.isLoading=YES;b.isPrefetching=YES},_executeLazilyInstantiatedModule:function(b,d,k){var j=SC.LAZY_INSTANTIATION[b];var h;var a;var l,f;if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Module '%@' is marked for lazy instantiation, instantiating it now",b)}f=j.length;for(l=0;l<f;l++){try{j[l]()}catch(g){SC.Logger.error("SC.Module: Failed to lazily instatiate entry for  '%@'".fmt(b))}}delete SC.LAZY_INSTANTIATION[b];h=this._targetForTargetName(d);a=this._methodForMethodNameInTarget(k,h);if(!a){throw"SC.Module: could not find callback for lazily instantiated module '%@'".fmt(b)}},_evaluateStringLoadedModule:function(b){var a=b.source;jQuery.globalEval(a);delete b.source;if(b.cssSource){var d=document.createElement("style");d.setAttribute("type","text/css");if(d.styleSheet){d.styleSheet.cssText=b.cssSource}else{var e=document.createTextNode(b.cssSource);d.appendChild(e)}document.getElementsByTagName("head")[0].appendChild(d)}b.isReady=YES},_loadCSSForModule:function(e){var g=document.getElementsByTagName("head")[0];var f=SC.MODULE_INFO[e];var j=f.styles||[];var b=j.length;var d;var h;var a;if(!g){g=document.documentElement}b=j.length;for(a=0;a<b;a++){d=j[a];if(d.length>0){if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Loading CSS file in '%@' -> '%@'",e,d)}h=document.createElement("link");h.setAttribute("href",d);h.setAttribute("rel","stylesheet");h.setAttribute("type","text/css");g.appendChild(h)}}h=null},_loadJavaScriptForModule:function(moduleName){var module=SC.MODULE_INFO[moduleName];var el;var url;var dependencies=module.dependencies;var dependenciesAreLoaded=YES;if(dependencies&&dependencies.length>0){dependenciesAreLoaded=this._dependenciesMetForModule(moduleName)}if(module.isPrefetched){url=module.stringURL}else{if(dependenciesAreLoaded){url=module.scriptURL}else{url=module.stringURL}}if(url.length>0){if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Loading JavaScript file in '%@' -> '%@'",moduleName,url)}if(parseFloat(SC.browser.msie)>=11){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(this.readyState!==4||this.status!==200||this._done===(this._done=YES)){return}window.eval.call(window,this.responseText+';SC.run(function(){SC.Module._moduleDidLoad("'+moduleName+'")})')},o.open("GET",url),o.send(null);return}el=document.createElement("script");el.setAttribute("type","text/javascript");el.setAttribute("src",url);if(SC.browser.isIE){el.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){SC.run(function(){SC.Module._moduleDidLoad(moduleName)})}};el.onload=function(){SC.run(function(){SC.Module._moduleDidLoad(moduleName)})}}else{el.onload=function(){SC.run(function(){SC.Module._moduleDidLoad(moduleName)})}}document.body.appendChild(el)}},_dependenciesMetForModule:function(d){var f=SC.MODULE_INFO[d].dependencies||[];var b,a=f.length;var g;var e;for(b=0;b<a;b++){g=f[b];e=SC.MODULE_INFO[g];if(!e){throw"SC.loadModule: Unable to find dependency %@ for module %@.".fmt(g,d)}if(!e.isReady){return NO}}return YES},_loadDependenciesForModule:function(a){var b=SC.MODULE_INFO[a];var f=SC.LOG_MODULE_LOADING;var k=b.dependencies||[];var g=YES;var h=k.length;var l;var e;var d;var j;for(l=0;l<h;l++){e=k[l];d=SC.MODULE_INFO[e];if(!d){throw"SC.Module: could not find required module '%@' for module '%@'".fmt(e,a)}else{if(d.isLoading){g=NO;j=d.dependents;if(!j){d.dependents=j=[]}j.push(a)}else{if(d.isReady){continue}else{g=NO;j=d.dependents;if(!j){d.dependents=j=[]}j.push(a);if(f){SC.debug("SC.Module: '%@' depends on '%@', loading dependency",a,e)}SC.Module.loadModule(e)}}}}},_invokeCallback:function(d,e,a,b){var h;var g;g=this._targetForTargetName(e);h=this._methodForMethodNameInTarget(a,g);if(!h){if(SC.LAZY_INSTANTIATION[d]){this._executeLazilyInstantiatedModule(d,e,a);g=this._targetForTargetName(e);h=this._methodForMethodNameInTarget(a,g)}else{throw"SC.Module: could not find callback for '%@'".fmt(d)}}if(!b){b=[]}b.unshift(d);var f=!!SC.RunLoop.currentRunLoop;if(f){SC.run(function(){h.apply(g,b)})}else{h.apply(g,b)}},_invokeCallbacksForModule:function(d){var f=SC.MODULE_INFO[d],e;if(!f){return}if(SC.LOG_MODULE_LOADING){SC.debug("SC.Module: Module '%@' has completed loading, invoking callbacks.",d)}e=f.callbacks||[];for(var b=0,a=e.length;b<a;++b){e[b]()}},_evaluateAndInvokeCallbacks:function(a){var e=SC.MODULE_INFO;var b=e[a];var d=SC.LOG_MODULE_LOADING;if(d){SC.debug("SC.Module: Evaluating and invoking callbacks for '%@'.",a)}if(b.source){this._evaluateStringLoadedModule(b)}b.isWaitingForRunLoop=YES;this.invokeLast(function(){b.isReady=YES;this._moduleDidBecomeReady(a)})},_moduleDidBecomeReady:function(a){var d=SC.MODULE_INFO;var b=d[a];var e=SC.LOG_MODULE_LOADING;b.isWaitingForRunLoop=NO;if(SC.isReady){SC.Module._invokeCallbacksForModule(a);delete b.callbacks}else{SC.ready(SC,function(){SC.Module._invokeCallbacksForModule(a);delete b.callbacks})}var h=b.dependents||[];var f,k;for(var j=0,g=h.length;j<g;j++){f=h[j];k=d[f];if(k.isLoaded&&this._dependenciesMetForModule(f)){if(e){SC.debug("SC.Module: Now that %@ has loaded, all dependencies for a dependent %@ are met.",a,f)}this._evaluateAndInvokeCallbacks(f)}}},_moduleDidLoad:function(b){var d=SC.MODULE_INFO[b];var f=SC.LOG_MODULE_LOADING;var e;var g,a;if(f){SC.debug("SC.Module: Module '%@' finished loading.",b)}if(!d){if(f){SC.debug("SC._moduleDidLoad() called for unknown module '@'.",b)}d=SC.MODULE_INFO[b]={isLoaded:YES,isReady:YES};return}if(d.isLoaded){if(f){SC.debug("SC._moduleDidLoad() called more than once for module '%@'. Skipping.",b)}return}delete d.isLoading;d.isLoaded=YES;if(!d.isPrefetching){e=this._dependenciesMetForModule(b);if(e){this._evaluateAndInvokeCallbacks(b)}else{if(f){SC.debug("SC.Module: Dependencies for '%@' not met yet, waiting to evaluate.",b)}}}else{delete d.isPrefetching;if(f){SC.debug("SC.Module: Module '%@' was prefetched, not evaluating until needed.",b)}}},_targetForTargetName:function(a){if(SC.typeOf(a)===SC.T_STRING){return SC.objectForPropertyPath(a)}return a},_methodForMethodNameInTarget:function(a,b){if(SC.typeOf(a)===SC.T_STRING){return SC.objectForPropertyPath(a,b)}return a},methodsForSuspend:"loadModule _moduleDidLoad prefetchModule _moduleDidBecomeReady".w(),suspend:function(){this._suspendCount=(this._suspendCount||0)+1;if(this._suspendCount!==1){return}var a=this.get("methodsForSuspend"),f,e,d,b;for(b=0;d=a[b];b++){if(!this[f="__replacement_"+d+"__"]){(this[f]=function(){(this._bufferedCalls||(this._bufferedCalls=[])).push({method:arguments.callee.methodName,arguments:arguments})}).methodName=d}if(!this[e="__saved_"+d+"__"]){this[e]=this[d]}this[d]=this[f]}},resume:function(){this._suspendCount=(this._suspendCount||0)-1;if(this._suspendCount<0){SC.warn("SC.Module.resume() was called without SC.Module having been in a suspended state. Call aborted.");this._suspendCount=0;return}if(this._suspendCount>0){return}var a=this.get("methodsForSuspend"),e=this._bufferedCalls,d,b,g,f;for(b=0;(d=a[b]);b++){this[d]=this["__saved_"+d+"__"]}for(b=0;f=e&&e[b];b++){this[f.method].apply(this,f.arguments)}if(e){e.length=0}}});SC.ready(function(){var e=SC.MODULE_INFO;var b;var d;var a;for(b in e){d=e[b];if(d.isPrefetched){a=SC.Module.PrefetchModuleTask.create({prefetchedModuleName:b});SC.backgroundTaskQueue.push(a)}}});SC.Module.PrefetchModuleTask=SC.Task.extend({prefetchedModuleName:null,run:function(){SC.Module.prefetchModule(this.prefetchedModuleName)}});sc_require("tasks/task");SC.TaskQueue=SC.Task.extend({init:function(){var a=this;this._doIdleEntry=function(){a._idleEntry()};this._suspendCount=0;this._tasks=[]},runWhenIdle:NO,runLimit:50,interval:50,isRunning:NO,minimumIdleDuration:500,_tasks:null,hasTasks:function(){return this._tasks.length>0}.property("taskCount").cacheable(),taskCount:function(){return this._tasks.length}.property().cacheable(),push:function(a){this._tasks.push(a);this.notifyPropertyChange("taskCount")},next:function(){if(this._tasks.length<1){return null}var a=this._tasks.shift();this.notifyPropertyChange("taskCount");return a},suspend:function(){this._suspendCount++},resume:function(){this._suspendCount--;if(this._suspendCount<=0){this._setupIdle()}},_taskCountDidChange:function(){this._setupIdle()}.observes("taskCount"),_runWhenIdleDidChange:function(){this._setupIdle()}.observes("runWhenIdle"),_setupIdle:function(){if(!this._suspendCount&&this.get("runWhenIdle")&&!this._idleIsScheduled&&this.get("taskCount")>0){setTimeout(this._doIdleEntry,this.get("interval"));this._idleIsScheduled=YES}},_idleEntry:function(){this._idleIsScheduled=NO;var a=SC.RunLoop.lastRunLoopEnd;if(!this.get("runWhenIdle")&&!this._suspendCount){return}if(Date.now()-a>this.get("minimumIdleDuration")){SC.run(this.run,this);SC.RunLoop.lastRunLoopEnd=a}this._setupIdle()},run:function(a){this.set("isRunning",YES);if(!a){a=this.get("runLimit")}var b,d=Date.now();while(b=this.next()){b.run(this);if(Date.now()-d>a){break}}this.set("isRunning",NO)}});SC.backgroundTaskQueue=SC.TaskQueue.create({runWhenIdle:YES});SC.TextSelection=SC.Object.extend(SC.Copyable,SC.Freezable,{start:-1,end:-1,length:function(){var b=this.get("start");var a=this.get("end");if((b)===-1||(a===-1)){return -1}else{return a-b}}.property("start","end").cacheable(),init:function(){arguments.callee.base.apply(this,arguments);this.freeze()},copy:function(){return SC.TextSelection.create({start:this.get("start"),end:this.get("end")})},toString:function(){var a=this.get("length");if(a&&a>0){if(a===1){return"[%@ character selected: {%@, %@}]".fmt(a,this.get("start"),this.get("end"))}else{return"[%@ characters selected: {%@, %@}]".fmt(a,this.get("start"),this.get("end"))}}else{return"[no text selected; caret at %@]".fmt(this.get("start"))}}});SC.UserDefaults=SC.Object.extend({ready:NO,userDomain:null,appDomain:null,_defaults:null,_safari3DB:null,defaults:function(a){this._defaults=a;this.allPropertiesDidChange()},readDefault:function(k){var a,f,b,l,j,m,h;k=this._normalizeKeyName(k);b=this._userKeyName(k);if(this._written){f=this._written[b]}a=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(a){l=document.body;try{l.load("SC.UserDefaults")}catch(d){SC.Logger.error("Couldn't load userDefaults in IE7: "+d.description)}}else{if(this.HTML5DB_noLocalStorage){h=this._safari3DB}else{l=window.localStorage;if(!l&&window.globalStorage){l=window.globalStorage[window.location.hostname]}}}if(l||h){j=["SC.UserDefaults",b].join("-at-");if(a){f=l.getAttribute(j.replace(/\W/gi,""))}else{if(h){f=this.dataHash[j]}else{f=l[j]}}if(!SC.none(f)){try{f=SC.json.decode(f)}catch(g){}}}m=this.delegate;if(m&&m.userDefaultsNeedsDefault){f=m.userDefaultsNeedsDefault(this,k,b)}if(SC.none(f)&&this._defaults){f=this._defaults[b]||this._defaults[k]}return f},writeDefault:function(m,k){var b,g,d,n,l,o,j;m=this._normalizeKeyName(m);g=this._userKeyName(m);d=this._written;if(!d){d=this._written={}}d[g]=k;b=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(b){n=document.body}else{if(this.HTML5DB_noLocalStorage){j=this._safari3DB}else{n=window.localStorage;if(!n&&window.globalStorage){n=window.globalStorage[window.location.hostname]}}}l=["SC.UserDefaults",g].join("-at-");if(n||j){var a=SC.json.encode(k);if(b){n.setAttribute(l.replace(/\W/gi,""),a);n.save("SC.UserDefaults")}else{if(j){var f=this;j.transaction(function(e){e.executeSql("delete from SCLocalStorage where key = ?",[l],function(){e.executeSql("insert into SCLocalStorage(key, value) VALUES ('"+l+"', '"+a+"');",[],f._nullDataHandler,f.killTransaction)})});this.dataHash[l]=a}else{try{n[l]=a}catch(h){SC.Logger.error("Failed using localStorage. "+h)}}}}o=this.delegate;if(o&&o.userDefaultsDidChange){o.userDefaultsDidChange(this,m,k,g)}return this},resetDefault:function(l){var b,a,g,d,m,k,j;b=this._normalizeKeyName(l);g=this._userKeyName(b);this.propertyWillChange(l);this.propertyWillChange(b);d=this._written;if(d){delete d[g]}a=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0;if(a){m=document.body}else{if(this.HTML5DB_noLocalStorage){j=this._safari3DB}else{m=window.localStorage;if(!m&&window.globalStorage){m=window.globalStorage[window.location.hostname]}}}k=["SC.UserDefaults",g].join("-at-");if(m){if(a){m.setAttribute(k.replace(/\W/gi,""),null);m.save("SC.UserDefaults")}else{if(j){var f=this;j.transaction(function(e){e.executeSql("delete from SCLocalStorage where key = ?",[k],null)});delete this.dataHash[k]}else{try{delete m[k]}catch(h){SC.Logger.warn("Deleting local storage encountered a problem. "+h)}}}}this.propertyDidChange(l);this.propertyDidChange(b);return this},unknownProperty:function(a,b){if(b===undefined){return this.readDefault(a)}else{this.writeDefault(a,b);return b}},_normalizeKeyName:function(a){if(a.indexOf(":")<0){var b=this.get("appDomain")||"app";a=[b,a].join(":")}return a},_userKeyName:function(b){var a=this.get("userDomain")||"(anonymous)";return[a,b].join("-at-")},_domainDidChange:function(){var a=NO;if(this.get("userDomain")!==this._scud_userDomain){this._scud_userDomain=this.get("userDomain");a=YES}if(this.get("appDomain")!==this._scud_appDomain){this._scud_appDomain=this.get("appDomain");a=YES}if(a){this.allPropertiesDidChange()}}.observes("userDomain","appDomain"),init:function(){arguments.callee.base.apply(this,arguments);var a;jQuery.readyWait++;if(SC.userDefaults&&SC.userDefaults.get("dataHash")){var h=SC.userDefaults.get("dataHash");if(h){this.dataHash=SC.userDefaults.get("dataHash")}}this._scud_userDomain=this.get("userDomain");this._scud_appDomain=this.get("appDomain");a=SC.browser.isIE&&parseFloat(SC.browser.msie)<8;if(a){document.body.addBehavior("#default#userData")}this.HTML5DB_noLocalStorage=SC.browser.isWebkit&&SC.browser.compare(SC.browser.engineVersion,"523")>0&&SC.browser.compare(SC.browser.engineVersion,"528")<0;if(this.HTML5DB_noLocalStorage){var b;try{if(!window.openDatabase){SC.Logger.error("Trying to load a database with safari version 3.1 to get SC.UserDefaults to work. You are either in a previous version or there is a problem with your browser.");return}else{var j="scdb",g="1.0",k="SproutCore database",l=65536;b=openDatabase(j,g,k,l)}}catch(f){SC.Logger.error("Trying to load a database with safari version 3.1 to get SC.UserDefaults to work. You are either in a previous version or there is a problem with your browser.");return}if(b){var d=this;b.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS SCLocalStorage(key TEXT NOT NULL PRIMARY KEY, value TEXT NOT NULL);",[],d._nullDataHandler,d.killTransaction)});b.transaction(function(e){e.parent=d;e.executeSql("SELECT * from SCLocalStorage;",[],function(s,o){var p={},q;for(var n=0,m=o.rows.length;n<m;n++){q=o.rows.item(n);p[q.key]=q.value}s.parent.dataHash=p;SC.run(function(){jQuery.ready(true)})},d.killTransaction)});this._safari3DB=b}}else{jQuery.ready(true)}},_killTransaction:function(b,a){return true},_nullDataHandler:function(b,a){}});SC.userDefaults=SC.UserDefaults.create();SC.mixin({convertHsvToHex:function(e,d,a){var b=SC.Color.hsvToRgb(e,d,a);return SC.Color.create({r:b[0],g:b[1],b:b[2]}).toHex()},convertHexToHsv:function(b){var a=SC.Color.from(b);return a&&SC.Color.rgbToHsv(a.r,a.g,a.b)},PARSE_COLOR_RGBRE:/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i,PARSE_COLOR_HEXRE:/^\#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,expandColor:function(b){var d,f,e,a;d=this.parseColor(b);if(d){f=parseInt(d.slice(1,3),16);e=parseInt(d.slice(3,5),16);a=parseInt(d.slice(5,7),16);return[f,e,a]}},parseColor:function(e){var f=0,a="#",d,b;if(d=this.PARSE_COLOR_RGBRE.exec(e)){for(f=1;f<=3;f++){b=Math.max(0,Math.min(255,parseInt(d[f],0)));a+=this.toColorPart(b)}return a}if(d=this.PARSE_COLOR_HEXRE.exec(e)){if(d[1].length==3){for(f=0;f<3;f++){a+=d[1].charAt(f)+d[1].charAt(f)}return a}return"#"+d[1]}return false},toColorPart:function(a){if(a>255){a=255}var b=a.toString(16);if(a<16){return"0"+b}return b}});SC.mixin({_downloadFrames:0,download:function(e){var a=document.createElement("iframe"),d="DownloadFrame_"+this._downloadFrames;SC.$(a).attr("id",d);a.style.border="10px";a.style.width="0px";a.style.height="0px";a.style.position="absolute";a.style.top="-10000px";a.style.left="-10000px";if(!SC.browser.isSafari){SC.$(a).attr("src",e)}document.getElementsByTagName("body")[0].appendChild(a);if(SC.browser.isSafari){SC.$(a).attr("src",e)}this._downloadFrames=this._downloadFrames+1;if(!SC.browser.isSafari){var b=function(){document.body.removeChild(document.getElementById(d));d=null};b.invokeLater(null,2000)}a=null},getStyle:function(a,b){var d="";if(document.defaultView&&document.defaultView.getComputedStyle){d=document.defaultView.getComputedStyle(a,"").getPropertyValue(b)}else{if(a.currentStyle){b=b.replace(/\-(\w)/g,function(e,f){return f.toUpperCase()});d=a.currentStyle[b]}}return d},uniJapaneseConvert:function(f){var a,d="",b,e;for(b=0,e=f.length;b<e;b++){a=f.charCodeAt(b);a=((a>=65281&&a<=65392)?a-65248:a);a=(a===12540?45:a);d=d+String.fromCharCode(a)}return d},pointInElement:function(b,h,d,g){var j,e,a,f;h=jQuery(h);d=d||"border";j=SC.offset(h,g);if(d==="padding"){e=h.innerWidth();a=h.innerHeight();j.x+=window.parseInt(h.css("border-left-width").replace("px",""));j.y+=window.parseInt(h.css("border-top-width").replace("px",""))}else{e=h.outerWidth(d==="margin");a=h.outerHeight(d==="margin");if(d==="margin"){j.x-=window.parseInt(h.css("margin-left").replace("px",""));j.y-=window.parseInt(h.css("margin-top").replace("px",""))}}f={x:j.x,y:j.y,width:e,height:a};return SC.pointInRect(b,f)},switchScale:function(){$("head meta[name=viewport]").remove();if(window.innerWidth===window.screen.width){$("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5, user-scalable=0" />')}else{$("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=0" />')}}});SC.mixin({ZERO_RANGE:{start:0,length:0},RANGE_NOT_FOUND:{start:0,length:-1},valueInRange:function(b,a){return(b>=0)&&(b>=a.start)&&(b<(a.start+a.length))},minRange:function(a){return a.start},maxRange:function(a){return(a.length<0)?-1:(a.start+a.length)},unionRanges:function(d,b){if((d==null)||(d.length<0)){return b}if((b==null)||(b.length<0)){return d}var e=Math.min(d.start,b.start),a=Math.max(SC.maxRange(d),SC.maxRange(b));return{start:e,length:a-e}},intersectRanges:function(d,b){if((d==null)||(b==null)){return SC.RANGE_NOT_FOUND}if((d.length<0)||(b.length<0)){return SC.RANGE_NOT_FOUND}var e=Math.max(SC.minRange(d),SC.minRange(b)),a=Math.min(SC.maxRange(d),SC.maxRange(b));if(a<e){return SC.RANGE_NOT_FOUND}return{start:e,length:a-e}},subtractRanges:function(d,b){if((d==null)||(b==null)){return SC.RANGE_NOT_FOUND}if((d.length<0)||(b.length<0)){return SC.RANGE_NOT_FOUND}var a=Math.max(SC.minRange(d),SC.minRange(b)),e=Math.min(SC.maxRange(d),SC.maxRange(b));if(a<e){return SC.RANGE_NOT_FOUND}return{start:e,length:a-e}},cloneRange:function(a){return{start:a.start,length:a.length}},rangesEqual:function(b,a){if(b===a){return true}if(b==null){return a.length<0}if(a==null){return b.length<0}return(b.start==a.start)&&(b.length==a.length)}});SC.mixin({bestStringMetricsForMaxWidth:function(a,z,o,B,y){if(!z){SC.warn("When calling bestMetricsForWidth, the second argument, maxWidth, is required. There's no reason to call this without a maxWidth.");return undefined}z=Math.ceil(parseFloat(z));var C=arguments.callee,j=SC.typeOf(o||(o=""))!==SC.T_STRING,n=j?o.style.maxWidth:undefined,p=(!j||o.cacheableForMetrics)?SC.cacheSlotFor(o,B,y,a):undefined,t=j?(C._applyMaxToEl||(C._applyMaxToEl=function(G,l){G.style.maxWidth=l+"px";return G})):(C._applyMaxToStr||(C._applyMaxToStr=function(G,l){return G.replace(/max-width:[^;]*;/g,"")+" max-width:"+l+"px"})),w=j?(C._removeMaxFromEl||(C._removeMaxFromEl=function(l){l.style.maxWidth="none";return l})):(C._removeMaxFromStr||(C._removeMaxFromStr=function(l){return l.replace(/max-width:[^;]*;/g,"")+" max-width:none"})),q=false;if(p){p.list||(p.list=[{width:Infinity,height:0}]);for(var x=1,v=p.list.length,E,b,F;x<v&&!F;x++){E=p.list[x];b=p.list[x-1];if(!E||!E.width){continue}if(z>=E.width){if((b&&b.width)||(z<=E.maxWidth)){return E}F=E}}}var s=t(o,z),u=SC.metricsForString(a,s,B,y),A=u.height,e=p?p.parent.height||(p.parent.height=SC.metricsForString("W",s,B).height):SC.metricsForString("W",s,B).height,d=Math.round(A/e);if(q){d--;A=d*e}if(A>e){var h=q?Math.ceil(u.width*2.5):u.width,m=q?u.width:Math.floor(u.width/2.5),D,g=new Date()*1,k=0;while(h-m>1||(u.height>A&&!q)||(u.height<A&&q)){k++;D=(h+m)/2;s=t(s,D);u=SC.metricsForString(a,s,B,y);if(u.height>A){m=D}else{h=D}}u.width=Math.ceil(D);u.height=A;u.maxWidth=z;u.lineHeight=e;u.lines=d;u.searchPerformed=true;u.searchTime=new Date()*1-g;u.searchCount=k}else{if(q){u=SC.metricsForString(a,s=w(s),B,y)}u.maxWidth=z;u.lineHeight=e;u.lines=d;u.searchPerformed=false}u.browserCorrection=0;if(SC.browser.isIE){u.browserCorrection=1}if(SC.browser.isMozilla){u.browserCorrection=1}u.width=Math.min(z,u.width+u.browserCorrection);if(p){var f=p.list[d];if(f&&f.maxWidth<z){f.maxWidth=z}if(!f){f=p.list[d]=u}}if(j){s.style.maxWidth=n}F=q?F:u;return F},cacheSlotFor:function(){var f=arguments.callee.caller,g=f.cache||(f.cache={});if(!arguments[0]){return g}var b=(arguments[0] instanceof Array||arguments[0].callee)?arguments[0]:arguments,e=b.length,a,d;for(d=0;d<e;d++){if(typeof(a=b[d])==="object"){a=SC.guidFor(a)}g=g[a]||(g[a]={parent:g})}return g},cachedVersionOf:function(){var a=function(d){var b=function(){var e=SC.cacheSlotFor(arguments);return e.result||(e.result=arguments.callee.func.apply(this,arguments))};b.func=d;return b};return a(a)}()});sc_require("tasks/task");SC.didPreloadBundle=function(){};SC.PreloadBundleTask=SC.Task.extend({bundle:null,target:"SC",action:"preloaded",run:function(a){var b;if(b=this.get("bundle")){var d=Date.now();SC.Module.loadModule(this.get("bundle"),this.get("target"),this.get("action"))}}});sc_require("system/string");SC.VALIDATE_OK=YES;SC.VALIDATE_NO_CHANGE=NO;SC.Validator=SC.Object.extend({fieldValueForObject:function(b,d,a){return b},objectForFieldValue:function(d,b,a){return d},validate:function(a,b){return true},validateError:function(a,b){return SC.$error(SC.String.loc("Invalid.General(%@)",b.get("fieldValue")),b.get("fieldKey"))},validateChange:function(b,d,a){return this.validate(b,d)?SC.VALIDATE_OK:this.validateError(b,d)},validateSubmit:function(a,b){return this.validate(a,b)?SC.VALIDATE_OK:this.validateError(a,b)},validatePartial:function(a,b){if(!b.get("isValid")){return this.validate(a,b)?SC.VALIDATE_OK:this.validateError(a,b)}else{return SC.VALIDATE_NO_CHANGE}},validateKeyDown:function(b,d,a){return true},attachTo:function(a,b){},detachFrom:function(a,b){}});SC.Validator.mixin({OK:true,NO_CHANGE:false,findFor:function(f,h,g){var d;if(!g){return}if(g instanceof SC.Validator){d=g}else{if(g.isClass){d=g.create()}else{if(SC.typeOf(g)===SC.T_STRING){var b=null;var a=g.match(/^(.+)\[(.*)\]/);if(a){g=a[1];b=a[2]}g=SC.String.classify(g);var e=SC.Validator[g];if(SC.none(e)){throw"validator %@ not found for %@".fmt(g,h)}else{if(b){if(!f){throw"named validator (%@) could not be found for field %@ because the field does not belong to a form".fmt(b,h)}if(!f._validatorHash){f._validatorHash={}}d=(b)?f._validatorHash[b]:null;if(!d){d=e.create()}if(b){f._validatorHash[b]=d}}else{d=e.create()}}}}}return d},fieldValueForObject:function(a,b,d){if(this.prototype&&this.prototype.fieldValueForObject){return this.prototype.fieldValueForObject(a,b,d)}else{return null}},objectForFieldValue:function(b,a,d){if(this.prototype&&this.prototype.objectForFieldValue){return this.prototype.objectForFieldValue(b,a,d)}else{return null}}});sc_require("validators/validator");SC.Validator.CreditCard=SC.Validator.extend({fieldValueForObject:function(a,b,d){if(typeof(a)=="string"&&a.length==16){a=[a.slice(0,4),a.slice(4,8),a.slice(8,12),a.slice(12,16)].join(" ")}return a},objectForFieldValue:function(b,a,d){return b.replace(/[\s-\.\:]/g,"")},validate:function(a,b){return this.checkNumber(b.get("fieldValue"))},validateError:function(b,d){var a=d.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.CreditCard(%@)",a),a)},validateKeyDown:function(b,d,a){return !!a.match(/[0-9\- ]/)},checkNumber:function(k){if(!k||k.length===0){return YES}k=k.replace(/[^0-9]/g,"");var a="0123456789";var h=k.length;var g=parseInt(k,0);var m=k.toString();m=m.replace(/^\s+|\s+$/g,"");var l=0;var o=true;var b=false;var n;var e;for(var d=0;d<h;d++){n=""+m.substring(d,d+1);if(a.indexOf(n)=="-1"){o=false}}if(!o){b=false}if((h===0)&&(b)){b=false}else{if(h>=15){for(var f=h;f>0;f--){e=parseInt(g,0)%10;e=parseInt(e,0);l+=e;f--;g=g/10;e=parseInt(g,0)%10;e=e*2;switch(e){case 10:e=1;break;case 12:e=3;break;case 14:e=5;break;case 16:e=7;break;case 18:e=9;break;default:e=e}g=g/10;l+=e}if((l%10)===0){b=true}else{b=false}}}return b}});sc_require("validators/validator");SC.Validator.Date=SC.Validator.extend({format:"%b %d, %Y %i:%M:%S %p",fieldValueForObject:function(a,b,f){var e=this.get("format"),d;if(SC.typeOf(a)===SC.T_NUMBER){d=SC.DateTime.create(a)}else{if(a instanceof Date){d=a.getTime()}}if(d){a=d.toFormattedString(e)}return a},objectForFieldValue:function(d,a,f){var e=this.get("format"),b;if(d){b=SC.DateTime.parse(d,e);d=b?b._ms:null}return d}});sc_require("validators/validator");SC.Validator.DateTime=SC.Validator.extend({format:"%d/%m/%Y",fieldValueForObject:function(a,b,d){if(SC.kindOf(a,SC.DateTime)){a=a.toFormattedString(this.get("format"))}else{a=null}return a},objectForFieldValue:function(b,a,d){if(b){b=SC.DateTime.parse(b,this.get("format"))}return b}});sc_require("validators/validator");SC.Validator.Email=SC.Validator.extend({validate:function(a,b){return(b.get("fieldValue")||"").match(/.+@.+\...+/)},validateError:function(b,d){var a=d.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Email(%@)",a),a)}});SC.Validator.EmailOrEmpty=SC.Validator.Email.extend({validate:function(a,d){var b=d.get("fieldValue");return(b&&b.length>0)?b.match(/.+@.+\...+/):true}});sc_require("validators/validator");SC.Validator.NotEmpty=SC.Validator.extend({validate:function(a,d){var b=d.get("fieldValue");if(SC.none(b)){return NO}if(!SC.none(b.length)){return b.length>0}return YES},validateError:function(b,d){var a=d.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.NotEmpty(%@)",SC.String.capitalize(a)),d.get("errorLabel"))}});sc_require("validators/validator");sc_require("system/utils/misc");SC.Validator.Number=SC.Validator.extend({places:0,fieldValueForObject:function(a,b,d){switch(SC.typeOf(a)){case SC.T_NUMBER:a=a.toFixed(this.get("places"));break;case SC.T_NULL:case SC.T_UNDEFINED:a="";break}return a},objectForFieldValue:function(d,b,e){var a;d=d.replace(/,/g,"");switch(SC.typeOf(d)){case SC.T_STRING:if(d.length===0){d=null}else{if(this.get("places")>0){d=parseFloat(d)}else{if(d.length===1&&d.match(/-/)){d=null}else{a=parseInt(d,0);if(isNaN(a)){d=SC.uniJapaneseConvert(d);d=parseInt(d,0);if(isNaN(d)){d=""}}else{d=a}}}}break;case SC.T_NULL:case SC.T_UNDEFINED:d=null;break}return d},validate:function(a,d){var b=d.get("fieldValue");return(b==="")||!(isNaN(b)||isNaN(parseFloat(b)))},validateError:function(b,d){var a=d.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Number(%@)",a),a)},validateKeyDown:function(b,d,a){if(!a){a=""}var e=d.$input().val();if(!e){e=""}e+=a;if(this.get("places")===0){if(a.length===0){return true}else{return e.match(/^[\-{0,1}]?[0-9,\0]*/)[0]===e}}else{if(a.length===0){return true}else{return e.match(/^[\-{0,1}]?[0-9,\0]*\.?[0-9\0]+/)?e.match(/^[\-{0,1}]?[0-9,\0]*\.?[0-9\0]+/)[0]===e:false}}}});sc_require("validators/validator");SC.Validator.Password=SC.Validator.extend({attachTo:function(a,b){arguments.callee.base.apply(this,arguments);if(!this.fields){this.fields=[]}this.fields.push(b)},validate:function(f){if(!this.fields||this.fields.length===0){return true}var e=false;var b=false;var a=true;var d=this.fields[0].get("fieldValue");this.fields.forEach(function(h){var g=h.get("fieldValue");if(g!=d){a=false}if(!g||g.length===0){e=true}if(g&&g.length>0){b=true}});if(f){return(b===false)?false:a}else{return(e===true)?true:a}},updateFields:function(d,b){if(!this.fields||this.fields.length===0){return true}var a=SC.String.loc("Invalid.Password");var e=this._field;this.fields.forEach(function(g){var h=(b)?null:((g==e)?a:"");d.setErrorFor(g,h)});return(b)?SC.VALIDATE_OK:a},validateChange:function(b,d,a){return this.updateFields(b,this.validate(false))},validateSubmit:function(a,b){return this.updateFields(a,this.validate(true))},validatePartial:function(b,d){var a=!this._field.get("isValid");if(a){return this.updateFields(b,this.validate(false))}else{return SC.VALIDATE_NO_CHANGE}}});sc_require("validators/validator");SC.Validator.PositiveInteger=SC.Validator.extend({defaultValue:null,fieldValueForObject:function(a,b,d){switch(SC.typeOf(a)){case SC.T_NUMBER:a=a.toFixed(0);break;case SC.T_NULL:case SC.T_UNDEFINED:a=this.get("defaultValue");break}return a},objectForFieldValue:function(b,a,d){b=b.replace(/,/g,"");switch(SC.typeOf(b)){case SC.T_STRING:if(b.length===0){b=this.get("defaultValue")}else{b=parseInt(b,0)}break;case SC.T_NULL:case SC.T_UNDEFINED:b=this.get("defaultValue");break}if(isNaN(b)){return this.get("defaultValue")}return b},validate:function(a,d){var b=d.get("fieldValue");return(b==="")||!isNaN(b)},validateError:function(b,d){var a=d.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Number(%@)",a),a)},validateKeyDown:function(b,d,a){var e=d.$input().val();if(!e){e=""}e+=a;if(a.length===0){return true}else{return e.match(/^[0-9\0]*/)[0]===e}}});SC.ContainerView=SC.View.extend({classNames:["sc-container-view"],renderDelegateName:"containerRenderDelegate",nowShowing:null,contentView:null,contentViewBindingDefault:SC.Binding.single(),replaceContent:function(a){this.removeAllChildren();if(a){this.appendChild(a)}},createChildViews:function(){var a=this.get("contentView");if(a){a=this.contentView=this.createChildView(a);this.childViews=[a]}},awake:function(){arguments.callee.base.apply(this,arguments);var a=this.get("nowShowing");if(a&&a.length>0){this.nowShowingDidChange()}},nowShowingDidChange:function(){var d=this.get("nowShowing");if(d===SC.CONTENT_SET_DIRECTLY){return}var a=(this._instantiatedLastView===YES)?this.get("contentView"):null;this._instantiatedLastView=NO;if(SC.typeOf(d)===SC.T_STRING&&d.length>0){if(d.indexOf(".")>0){d=SC.objectForPropertyPath(d)}else{var b=this.getPath(d);d=SC.kindOf(b,SC.CoreView)?b:SC.objectForPropertyPath(d,this.get("page"))}}if(SC.typeOf(d)===SC.T_CLASS){if(d.kindOf(SC.CoreView)){d=this.createChildView(d);this._instantiatedLastView=YES}else{d=null}}if(d&&!(d instanceof SC.CoreView)){d=null}this.set("contentView",d);if(a){a.destroy()}}.observes("nowShowing"),contentViewDidChange:function(){this.replaceContent(this.get("contentView"))}.observes("contentView")});sc_require("mixins/validatable");SC.FieldView=SC.View.extend(SC.Control,SC.Validatable,{fieldValue:function(){var a=this.get("value");if(SC.typeOf(a)===SC.T_ERROR){a=a.get("errorValue")}return this.fieldValueForObject(a)}.property("value","validator").cacheable(),$input:function(){var a=this._inputElementTagName();return this.$(a).andSelf().filter(a)},_inputElementTagName:function(){return"input"},setFieldValue:function(b){if(SC.none(b)){b=""}var a=this.$input();if(a.val()!==b){a.val(b)}return this},getFieldValue:function(){return this.$input().val()},_field_fieldValueDidChange:function(a){SC.run(function(){this.fieldValueDidChange(NO)},this)},fieldValueDidChange:function(a){var d=this.getFieldValue();var b=this.objectForFieldValue(d,a);this.setIfChanged("value",b)},_field_valueDidChange:function(){this.setFieldValue(this.get("fieldValue"))}.observes("fieldValue"),didCreateLayer:function(){this.setFieldValue(this.get("fieldValue"));this._addChangeEvent()},willDestroyLayer:function(){SC.Event.remove(this.$input(),"change",this,this._field_fieldValueDidChange)},mouseDown:function(a){this._field_isMouseDown=YES;a.allowDefault();return YES},mouseExited:function(a){if(this._field_isMouseDown){this.set("isActive",NO)}a.allowDefault();return YES},mouseEntered:function(a){this.set("isActive",this._field_isMouseDown);a.allowDefault();return YES},mouseUp:function(a){if(this._field_isMouseDown){this.set("isActive",NO)}this._field_isMouseDown=NO;a.allowDefault();return YES},keyDown:function(b){if(b.which===9||b.keyCode===9){var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(this.performValidateKeyDown(b)){this._isKeyDown=YES;b.allowDefault()}else{b.stop()}return YES},acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),_addChangeEvent:function(){SC.Event.add(this.$input(),"change",this,this._field_fieldValueDidChange)},_field_setFieldValue:function(b){this.propertyWillChange("fieldValue");if(this.fieldValueForObject){b=this.fieldValueForObject(b)}var a=this.setFieldValue(b);this.propertyDidChange("fieldValue");return a},_field_getFieldValue:function(){var a=this.getFieldValue();if(this.objectForFieldValue){a=this.objectForFieldValue(a)}return a}});SC.IMAGE_STATE_NONE="none";SC.IMAGE_STATE_LOADING="loading";SC.IMAGE_STATE_LOADED="loaded";SC.IMAGE_STATE_FAILED="failed";SC.IMAGE_TYPE_NONE="NONE";SC.IMAGE_TYPE_URL="URL";SC.IMAGE_TYPE_CSS_CLASS="CSS_CLASS";SC.BLANK_IMAGE_DATAURL="data:image/gif;base64,R0lGODlhAQABAJAAAP///wAAACH5BAUQAAAALAAAAAABAAEAAAICBAEAOw==";SC.BLANK_IMAGE_URL=SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"8")<0?"/applications/designer/5410/sproutcore/foundation/5410/en-us/source/resources/blank.gif":SC.BLANK_IMAGE_DATAURL;SC.BLANK_IMAGE=new Image();SC.BLANK_IMAGE.src=SC.BLANK_IMAGE_URL;SC.BLANK_IMAGE.width=SC.BLANK_IMAGE.height=1;SC.ImageView=SC.View.extend(SC.Control,SC.InnerFrame,{classNames:"sc-image-view",displayProperties:["frame","image","innerFrame","toolTip","imageValue","type"],renderDelegateName:function(){return(this.get("useCanvas")?"canvasImage":"image")+"RenderDelegate"}.property("useCanvas").cacheable(),tagName:function(){return this.get("useCanvas")?"canvas":"div"}.property("useCanvas").cacheable(),canLoadInBackground:NO,image:SC.BLANK_IMAGE,imageValue:function(){var a=this.get("value");return a&&a.isEnumerable?a.firstObject():a}.property("value").cacheable(),innerFrame:function(){var d=this.get("image"),b=d.width,a=d.height,e=this.get("frame");if(SC.none(e)){return{x:0,y:0,width:0,height:0}}return this.innerFrameForSize(b,a,e.width,e.height)}.property("align","image","scale","frame").cacheable(),localize:YES,status:SC.IMAGE_STATE_NONE,type:function(){var a=this.get("imageValue");if(SC.ImageView.valueIsUrl(a)){return SC.IMAGE_TYPE_URL}else{if(!SC.none(a)){return SC.IMAGE_TYPE_CSS_CLASS}}return SC.IMAGE_TYPE_NONE}.property("imageValue").cacheable(),useCanvas:function(){return SC.platform.supportsCanvas&&!this.get("useStaticLayout")&&this.get("type")!==SC.IMAGE_TYPE_CSS_CLASS}.property("useStaticLayout","type").cacheable(),useImageQueue:YES,value:null,viewDidResize:function(){var b=this.get("layer"),d,a;if(b){d=b.offsetWidth;a=b.offsetHeight;if(this._cachedWidth!==d||this._cachedHeight!==a){this.notifyPropertyChange("frame");this._cachedWidth=d;this._cachedHeight=a}}},init:function(){arguments.callee.base.apply(this,arguments);this._image_valueDidChange();if(this.get("useImageCache")!==undefined){SC.Logger.warn("%@ has useImageCache set, please set useImageQueue instead".fmt(this));this.set("useImageQueue",this.get("useImageCache"))}},layerDidChange:function(){if(this.get("useCanvas")){this.set("layerNeedsUpdate",YES)}}.observes("layer"),_image_valueDidChange:function(){var b=this.get("imageValue"),a=this.get("type");if(b!==this._iv_value){this._iv_value=b;this.set("image",SC.BLANK_IMAGE);if(a!==SC.IMAGE_TYPE_CSS_CLASS){this.set("status",SC.IMAGE_STATE_LOADING);if(!this._loadImageUsingCache()){this._loadImage()}}}}.observes("imageValue"),_loadImageUsingCache:function(){var d=this.get("imageValue"),b=this.get("type");if(b===SC.IMAGE_TYPE_URL&&this.get("useImageQueue")){var a=this.get("isVisibleInWindow")||this.get("canLoadInBackground");SC.imageQueue.loadImage(d,this,this._loadImageUsingCacheDidComplete,a);return YES}return NO},_loadImageUsingCacheDidComplete:function(a,d){var b=this.get("imageValue");if(b===a){if(SC.ok(d)){this.didLoad(d)}else{this.didError(d)}}},_loadImage:function(){var e=this.get("imageValue"),b=this.get("type"),d=this,g,a;if(b===SC.IMAGE_TYPE_URL){g=new Image();var f=function(){SC.run(function(){d._loadImageDidComplete(e,SC.$error("SC.Image.FailedError","Image",-101))})};var h=function(){SC.run(function(){d._loadImageDidComplete(e,g)})};a=$(g);a.bind("error",f);a.bind("abort",f);a.bind("load",h);g.src=e;return YES}return NO},_loadImageDidComplete:function(a,d){var b=this.get("imageValue");if(b===a){if(SC.ok(d)){this.didLoad(d)}else{this.didError(d)}}},didLoad:function(a){this.set("status",SC.IMAGE_STATE_LOADED);if(!a){a=SC.BLANK_IMAGE}this.set("image",a)},didError:function(a){this.set("status",SC.IMAGE_STATE_FAILED);this.set("image",SC.BLANK_IMAGE)}});SC.ImageView.valueIsUrl=function(a){return a&&SC.typeOf(a)===SC.T_STRING?a.indexOf("/")>=0:NO};sc_require("views/field");sc_require("system/text_selection");sc_require("mixins/static_layout");sc_require("mixins/editable");SC.TextFieldView=SC.FieldView.extend(SC.StaticLayout,SC.Editable,{classNames:["sc-text-field-view"],blurOnMouseDown:YES,triggerReturnInsertNewline:YES,isTextField:YES,applyImmediately:YES,commitOnBlur:YES,isPassword:NO,isTextArea:NO,focused:NO,hint:"",type:"text",isBrowserFocusable:YES,autoCorrect:YES,autoCapitalize:YES,formattedHint:function(){var a=this.get("hint");return typeof(a)==="string"&&this.get("localize")?SC.String.loc(a):a}.property("hint","localize").cacheable(),hintOnFocus:YES,localize:YES,isEditing:NO,defaultTabbingEnabled:YES,isContextMenuEnabled:YES,continuouslyUpdatesValue:null,allowsErrorAsValue:YES,leftAccessoryView:null,rightAccessoryView:null,spellCheckEnabled:YES,maxLength:5096,shouldRenderBorder:YES,supportsAutoResize:YES,autoResizeLayer:function(){return this.$input()[0]}.property("layer").cacheable(),autoResizeText:function(){return this.get("value")}.property("value").cacheable(),autoResizePadding:SC.propertyFromRenderDelegate("autoResizePadding",20),_hintON:YES,init:function(){var a=this.get("value");this._hintON=((!a||a&&a.length===0)&&!this.get("hintOnFocus"))?YES:NO;var b=this.get("continouslyUpdatesValue");if(b!==null&&b!==undefined){this.set("applyImmediately",b)}return arguments.callee.base.apply(this,arguments)},isEditable:YES,selection:function(n,l){var f=this.$input()[0],g,a,d;if(l===undefined){if(f){a=null;d=null;if(!f.value){a=d=0}else{try{if("selectionStart" in f){a=f.selectionStart}if("selectionEnd" in f){d=f.selectionEnd}}catch(h){return null}if(a===null||d===null){var m=document.selection;if(m){var k=m.type;if(k&&(k==="None"||k==="Text")){g=m.createRange();if(!this.get("isTextArea")){var b=g.text.length;a=Math.abs(g.moveStart("character",0-(f.value.length+1)));d=a+b}else{var j=g.duplicate();j.moveToElementText(f);j.setEndPoint("EndToStart",g);a=j.text.length;d=a+g.text.length}}}}}return SC.TextSelection.create({start:a,end:d})}else{return null}}else{if(!l||!l.kindOf||!l.kindOf(SC.TextSelection)){throw"When setting the selection, you must specify an SC.TextSelection instance."}if(f){if(f.setSelectionRange){f.setSelectionRange(l.get("start"),l.get("end"))}else{g=f.createTextRange();a=l.get("start");g.move("character",a);g.moveEnd("character",l.get("end")-a);g.select()}}return l}}.property("fieldValue").cacheable(),displayProperties:["isBrowserFocusable","formattedHint","fieldValue","isEditing","isEditable","leftAccessoryView","rightAccessoryView","isTextArea"],createChildViews:function(){arguments.callee.base.apply(this,arguments);this.accessoryViewObserver()},acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),accessoryViewObserver:function(){var g,j=["leftAccessoryView","rightAccessoryView"],a=j.length,b,f,e,h;for(b=0;b<a;b++){f=j[b];e=this["_"+f];h=this.get(f);if(!(e&&h&&(e===h))){if(e){g=e.get("classNames");g=g.without("sc-text-field-accessory-view");e.set("classNames",g);this.removeChild(e);e=null;this["_"+f]=null}if(h){if(h.isClass){h=h.create({layoutView:this})}g=h.get("classNames");var d="sc-text-field-accessory-view";if(g.indexOf(d)<0){g=SC.clone(g);g.push(d);h.set("classNames",g)}this.appendChild(h);this["_"+f]=h}}}}.observes("leftAccessoryView","rightAccessoryView"),layoutChildViewsIfNeeded:function(a){if(!a){a=this.get("isVisibleInWindow")}if(a&&this.get("childViewsNeedLayout")){var b=this.get("rightAccessoryView");if(b&&b.get){var d=b.get("layout");if(d){d.left=null;if(!d.right){d.right=0}b.adjust(d)}}}arguments.callee.base.apply(this,arguments)},render:function(f,g){arguments.callee.base.apply(this,arguments);var a,e,d,b;a=this.get("fieldValue");if(SC.none(a)){a=""}a=String(a);f.setClass("not-empty",a.length>0);e=this._getAccessoryViewWidths();d=e.left;b=e.right;if(d){d+="px"}if(b){b+="px"}this._renderField(f,g,a,d,b)},_forceRenderFirstTime:NO,_renderFieldLikeFirstTime:function(){this.set("_forceRenderFirstTime",YES)}.observes("isTextArea"),_renderField:function(g,m,z,k,t){var u=this.get("formattedHint"),b=this.get("hintOnFocus"),p="",l=this.get("maxLength"),x=this.get("isTextArea"),E=this.get("isEnabled"),q=this.get("isEditable"),v=this.get("autoCorrect"),F=this.get("autoCapitalize"),n=this.get("isBrowserFocusable"),I="",f="",e="",H,A,h,D,d,o,j,a,y,w;g.setClass("text-area",x);a=SC.browser.isWebkit&&SC.browser.compare(SC.browser.engineVersion,"532")<0;g.setClass("oldWebKitFieldPadding",a);if(m||this._forceRenderFirstTime){this._forceRenderFirstTime=NO;y=E?(q?"":'readonly="readonly"'):'disabled="disabled"';H=this.get("layerId");I=this.get("spellCheckEnabled")?' spellcheck="true"':' spellcheck="false"';if(v!=null){e=" autocorrect="+(!v?'"off"':'"true"')}if(v!=null){f=" autocapitalize="+(!F?'"off"':'"true"')}if(n){w='tabindex="-1"'}if(SC.platform.input.placeholder&&!b){p=' placeholder="'+u+'"'}if(this.get("shouldRenderBorder")){g.push('<div class="border"></div>')}A="";if(k||t){A='style="';if(k){A+="left:"+k+";"}if(t){A+="right:"+t+";"}A+='"'}g.push('<div class="padding" '+A+">");z=this.get("escapeHTML")?SC.RenderContext.escapeHTML(z):z;if(this._hintON&&!SC.platform.input.placeholder&&(!z||(z&&z.length===0))){z=u;g.setClass("sc-hint",YES)}if(b){var B='<div aria-hidden="true" class="hint '+(x?"":"ellipsis")+'%@">'+u+"</div>";g.push(B.fmt(z?" sc-hidden":""))}j="field";if(x){g.push('<textarea aria-label="'+u+'" aria-multiline="true" class="'+j+'" name="'+H+'" '+y+p+I+e+w+f+' maxlength="'+l+'">'+z+"</textarea></div>")}else{h=this.get("type");if(this.get("isPassword")){h="password"}g.push('<input aria-label="'+u+'" class="'+j+'" type="'+h+'" name="'+H+'" '+y+' value="'+z+'"'+p+I+w+' maxlength="'+l+'" '+e+" "+f+"/></div>")}}else{var s=this.$input(),C=s[0],G=this.get("value");if(b){this.$(".hint")[0].innerHTML=u}else{if(!b){C.placeholder=u}}if(SC.browser.name===SC.BROWSER.ie&&SC.browser.version<=8&&!x){s.css("line-height",this.get("frame").height+"px")}if(!G||(G&&G.length===0)){if(this.get("isPassword")){C.type="password"}if(!SC.platform.input.placeholder&&this._hintON){if(!this.get("isFirstResponder")){g.setClass("sc-hint",YES);s.val(u)}else{g.setClass("sc-hint",NO);s.val("")}}}if(v!=null){s.attr("autoCorrect",!v?"off":"true")}else{s.attr("autoCorrect",null)}if(F!=null){s.attr("autoCapitalize",!F?"off":"true")}else{s.attr("autoCapitalize",null)}if(!b&&SC.platform.input.placeholder){s.attr("placeholder",u)}if(n){s.removeAttr("tabindex")}else{s.attr("tabindex","-1")}d=s[0];if(d){if(!E){d.disabled="true";d.readOnly=null}else{if(!q){d.disabled=null;d.readOnly="true"}else{d.disabled=null;d.readOnly=null}}o=d.parentNode.style;if(k){if(o.left!==k){o.left=k}}else{o.left=null}if(t){if(o.right!==t){o.right=t}}else{o.right=null}}}},_getAccessoryViewWidths:function(){var d={},l=["left","right"],e=l.length,g,h,m,k,a,j,f,b;for(g=0;g<e;g++){h=l[g];m=this["_"+h+"AccessoryView"];if(m&&m.isObservable){b=m.get("frame");if(b){a=b.width;if(a){j=m.get("layout");if(j){f=j[h];a+=f}d[h]=a}}}}return d},didCreateLayer:function(){arguments.callee.base.apply(this,arguments);if(!SC.platform.input.placeholder){this.invokeLast(this._setInitialPlaceHolderIE)}if(this.get("isTextArea")){this.invokeLast(this._addTextAreaEvents)}else{this._addTextAreaEvents();if(SC.browser.isMozilla){var a=this.$input();SC.Event.add(a,"keypress",this,this._firefox_dispatch_keypress)}}if(this.get("hintOnFocus")||(SC.browser.name===SC.BROWSER.ie&&SC.browser.version<=8&&!this.get("isTextArea"))){this.invokeLast(this._fixupTextLayout)}},_fixupTextLayout:function(){var a=this.get("frame").height;if(SC.browser.name===SC.BROWSER.ie&&SC.browser.version<=8&&!this.get("isTextArea")){this.$input().css("line-height",a+"px")}if(this.get("hintOnFocus")&&!this.get("isTextArea")){}},_setInitialPlaceHolderIE:function(){if(!SC.platform.input.placeholder&&this._hintON){var a=this.$input(),b=a.val();if(!b||(b&&b.length===0)){a.val(this.get("formattedHint"))}}},_addTextAreaEvents:function(){var a=this.$input();SC.Event.add(a,"focus",this,this._textField_fieldDidFocus);SC.Event.add(a,"blur",this,this._textField_fieldDidBlur);SC.Event.add(a,"select",this,this._textField_selectionDidChange);SC.Event.add(a,"input",this,this._textField_inputDidChange)},willDestroyLayer:function(){arguments.callee.base.apply(this,arguments);var a=this.$input();SC.Event.remove(a,"focus",this,this._textField_fieldDidFocus);SC.Event.remove(a,"blur",this,this._textField_fieldDidBlur);SC.Event.remove(a,"select",this,this._textField_selectionDidChange);SC.Event.remove(a,"keypress",this,this._firefox_dispatch_keypress);SC.Event.remove(a,"input",this,this._textField_inputDidChange)},_textField_fieldDidFocus:function(a){SC.run(function(){this.set("focused",YES);this.fieldDidFocus(a);var b=this.get("value");if(!SC.platform.input.placeholder&&((!b)||(b&&b.length===0))){this._hintON=NO}},this)},_textField_fieldDidBlur:function(a){SC.run(function(){this.set("focused",NO);this.fieldDidBlur(this._origEvent||a);var b=this.get("value");if(!SC.platform.input.placeholder&&!this.get("hintOnFocus")&&((!b)||(b&&b.length===0))){this._hintON=YES}},this)},fieldDidFocus:function(a){this.becomeFirstResponder();this.beginEditing(a);if(this._didHideInterceptForPane){this._didHideInterceptForPane.showTouchIntercept();this._didHideInterceptForPane=null}var b=this.get("pane");if(b&&b.get("hasTouchIntercept")){b.hideTouchIntercept();this._didHideInterceptForPane=this.get("pane")}},fieldDidBlur:function(a){this.resignFirstResponder(a);if(this.get("commitOnBlur")){this.commitEditing(a)}var b=this._didHideInterceptForPane;if(b){b.showTouchIntercept();b=null}},_field_fieldValueDidChange:function(a){if(this.get("focused")){SC.run(function(){this.fieldValueDidChange(NO)},this)}this.updateHintOnFocus()},_textField_inputDidChange:function(){var a=SC.empty(this._fieldValueDidChangeTimer)||!this._fieldValueDidChangeTimer.get("isValid");if(this.get("applyImmediately")&&a){this.invokeLater(this.fieldValueDidChange,10)}},updateHintOnFocus:function(){var a=this.get("hintOnFocus");if(!a){return}if(this.getFieldValue()){this.$(".hint").addClass("sc-hidden")}else{this.$(".hint").removeClass("sc-hidden")}}.observes("value"),_topOffsetForFirefoxCursorFix:3,_firefox_dispatch_keypress:function(a){var e=this.get("selection"),f=this.get("value"),d=f?f.length:0,b;if(!e||((e.get("length")===0&&(e.get("start")===0)||e.get("end")===d))){b=SC.RootResponder.responder;if(a.keyCode===9){return}b.keypress.call(b,a);a.stopPropagation()}},_textField_selectionDidChange:function(){this.notifyPropertyChange("selection")},didBecomeKeyResponderFrom:function(a){if(this.get("isVisibleInWindow")){var b=this.$input()[0];try{if(b){b.focus()}}catch(d){}if(!this._txtFieldMouseDown){this.invokeLast(this._selectRootElement)}}},_selectRootElement:function(){var b=this.$input()[0],a;if(b){a=SC.browser.os===SC.OS.mac&&SC.browser.compare(SC.browser.osVersion,"10.7")===0;if(!(SC.browser.name===SC.BROWSER.safari&&a&&SC.buildLocale==="ko-kr")){b.select()}}else{this._textField_selectionDidChange()}},didLoseKeyResponderTo:function(a){var b=this.$input()[0];if(b){b.blur()}this.invokeLater("scrollToOriginIfNeeded",100)},scrollToOriginIfNeeded:function(){var b=this.get("pane");if(!b){return}var a=b.get("firstResponder");if(!a||!a.get("isTextField")){document.body.scrollTop=document.body.scrollLeft=0}},keyDown:function(a){return this.interpretKeyEvents(a)||NO},insertText:function(d,a){var g=a.which,e=a.keyCode,b=false;if(!SC.platform.input.maxlength&&this.get("isTextArea")){var f=this.get("value");if(f&&((!SC.browser.isMozilla&&g>47)||(SC.browser.isMozilla&&((g>32&&g<43)||g>47)&&!(e>36&&e<41)))&&(f.length>=this.get("maxLength"))){b=true}}if((this.performValidateKeyDown(a)||SC.platform.touch)&&!b){this._isKeyDown=YES;a.allowDefault()}else{a.stop()}if(this.get("applyImmediately")){this._fieldValueDidChangeTimer=this.invokeLater(this.fieldValueDidChange,10)}return YES},insertTab:function(b){if(!this.get("defaultTabbingEnabled")){return NO}var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},insertNewline:function(a){if(this.get("isTextArea")){a.allowDefault();if(this.get("triggerReturnInsertNewline")){return YES}else{return NO}}return NO},deleteForward:function(a){a.allowDefault();return YES},deleteBackward:function(a){a.allowDefault();return YES},moveLeft:function(a){a.allowDefault();return YES},moveRight:function(a){a.allowDefault();return YES},selectAll:function(a){a.allowDefault();return YES},moveUp:function(a){if(this.get("isTextArea")){a.allowDefault();return YES}return NO},moveDown:function(a){if(this.get("isTextArea")){a.allowDefault();return YES}return NO},keyUp:function(a){if(SC.browser.isMozilla&&a.keyCode===SC.Event.KEY_RETURN){this.fieldValueDidChange()}this.notifyPropertyChange("selection");this._isKeyDown=NO;a.allowDefault();return YES},mouseDown:function(a){var b=this.get("fieldValue");this._txtFieldMouseDown=YES;this.becomeFirstResponder();if(!this.get("isEnabled")){a.stop();return YES}else{return arguments.callee.base.apply(this,arguments)}},mouseUp:function(a){this._txtFieldMouseDown=NO;this.notifyPropertyChange("selection");if(!this.get("isEnabled")){a.stop();return YES}return arguments.callee.base.apply(this,arguments)},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},mouseWheel:function(a){if(this.get("isTextArea")){a.allowDefault();return YES}else{return NO}},selectStart:function(a){return YES},_inputElementTagName:function(){if(this.get("isTextArea")){return"textarea"}else{return"input"}},_valueObserver:function(){var b=this.get("value"),a;if(b&&b.length>0){this._hintON=NO;a=this.get("maxLength");if(!SC.platform.input.maxlength&&b.length>a){this.set("value",b.substr(0,a))}}else{if(!this.get("hintOnFocus")){this._hintON=YES}}}.observes("value")});sc_require("views/text_field");sc_require("system/utils/misc");sc_require("delegates/inline_text_field");sc_require("mixins/inline_editor");SC.InlineTextFieldView=SC.TextFieldView.extend(SC.InlineEditor,{classNames:["inline-editor"],_topOffsetForFirefoxCursorFix:0,blurOnMouseDown:YES,_updateViewStyle:function(b){var d="",a=SC.getStyle(b,"font-size");if(a&&a.length>0){d=d+"font-size: "+a+" !important; "}a=SC.getStyle(b,"font-family");if(a&&a.length>0){d=d+"font-family: "+a+" !important; "}a=SC.getStyle(b,"font-weight");if(a&&a.length>0){d=d+"font-weight: "+a+" !important; "}a=SC.getStyle(b,"z-index");if(a&&a.length>0){d=d+"z-index: "+a+" !important; "}a=SC.getStyle(b,"line-height");if(a&&a.length>0){d=d+"line-height: "+a+" !important; "}a=SC.getStyle(b,"text-align");if(a&&a.length>0){d=d+"text-align: "+a+" !important; "}a=SC.getStyle(b,"top-margin");if(a&&a.length>0){d=d+"top-margin: "+a+" !important; "}a=SC.getStyle(b,"bottom-margin");if(a&&a.length>0){d=d+"bottom-margin: "+a+" !important; "}a=SC.getStyle(b,"left-margin");if(a&&a.length>0){d=d+"left-margin: "+a+" !important; "}a=SC.getStyle(b,"right-margin");if(a&&a.length>0){d=d+"right-margin: "+a+" !important; "}return d},_updateViewPaddingStyle:function(b){var d="",a=SC.getStyle(b,"padding-top");if(a&&a.length>0){d=d+"top: "+a+" !important; "}a=SC.getStyle(b,"padding-bottom");if(a&&a.length>0){d=d+"bottom: "+a+" !important; "}a=SC.getStyle(b,"padding-left");if(a&&a.length>0){d=d+"left: "+a+" !important; "}a=SC.getStyle(b,"padding-right");if(a&&a.length>0){d=d+"right: "+a+" !important; "}return d},updateStyle:function(e){if(e.length){e=e[0]}var a=document.getElementById("sc-inline-text-field-style"),d=this._updateViewStyle(e),f=this._updateViewPaddingStyle(e),g=".inline-editor input{"+d+"}.inline-editor textarea{"+d+"}.inline-editor .padding{"+f+"}";if(!a){var b=document.getElementsByTagName("head")[0];a=document.createElement("style");a.type="text/css";a.media="screen";a.id="sc-inline-text-field-style";b.appendChild(a)}if(a.styleSheet){a.styleSheet.cssText=g}else{a.innerHTML=g}},positionOverTargetView:function(l,e,d,b,f){var h;if(!d){d=l.get("pane")}if(!f){f=l.$()[0]}if(!b){var j=l.get("frame");b=SC.offset(f);b.height=j.height;b.width=j.width}var k={},a=d.$()[0],g=l.get("layout");k.height=b.height;k.width=b.width;h=SC.browser.isIE&&parseFloat(SC.browser.msie)<8;if(e&&g.left){k.left=b.x-g.left-a.offsetLeft-1;if(h){k.left--}}else{k.left=b.x-a.offsetLeft-1;if(h){k.left--}}if(e&&g.top){k.top=b.y-g.top-a.offsetTop;if(h){k.top=k.top-2}}else{k.top=b.y-a.offsetTop;if(h){k.top=k.top-2}}this.set("layout",k)},multiline:NO,isTextArea:function(){return this.get("multiline")}.property("multiline").cacheable(),beginEditing:function(b,a){if(!b(a)){return NO}var e=a.get("pane"),d=this.get("exampleElement");this.beginPropertyChanges();if(d){if(d.length){d=d[0]}}else{d=a.$()[0]}this.updateStyle(d);this.positionOverTargetView(a,this.get("isCollection"),e,this.get("exampleFrame"),d);this._previousFirstResponder=e?e.get("firstResponder"):null;this.becomeFirstResponder();this.endPropertyChanges();return YES}.enhance(),blurEditor:function(a){if(!this.get("isEditing")){return YES}return this.commitOnBlur?this.commitEditing():this.discardEditing()},_endEditing:function(b){var a=b();if(this.get("isFirstResponder")){var d=this.get("pane");if(d&&this._previousFirstResponder){d.makeFirstResponder(this._previousFirstResponder)}else{this.resignFirstResponder()}}this._previousFirstResponder=null;return a}.enhance(),mouseDown:function(a){arguments.callee.base.call(this,a);return this.get("isEditing")},touchStart:function(a){this.mouseDown(a)},keyDown:function(a){var b=this.interpretKeyEvents(a);this.fieldValueDidChange(true);return !b?NO:b},insertText:null,_scitf_blurInput:function(){var a=this.$input()[0];if(a){a.blur()}a=null},willRemoveFromParent:function(){return this._scitf_blurInput()},willLoseFirstResponder:function(b,a){if(b!==this){return}this._previousFirstResponder=null;this._origEvent=a;this._scitf_blurInput();return this.blurEditor(a)},cancel:function(){this.discardEditing();return YES},insertNewline:function(a){if(this.get("isTextArea")){return arguments.callee.base.apply(this,arguments)}else{this.commitEditing();return YES}},insertTab:function(a){var d=this.target;this.resignFirstResponder();this.commitEditing();if(d){var b=d.get("nextValidKeyView");if(b&&b.beginEditing){b.beginEditing()}}return YES},insertBacktab:function(a){var d=this.target;this.resignFirstResponder();this.commitEditing();if(d){var b=d.get("previousValidKeyView");if(b&&b.beginEditing){b.beginEditing()}}return YES}});SC.mixin(SC.InlineTextFieldView,{inlineEditorDelegate:SC.InlineTextFieldDelegate,label:null,editor:null,beginEditing:function(d){var a,e,b,f,g;if(SC.typeOf(d)===SC.T_HASH){b=d;if(!b.delegate||!b.exampleElement||!b.frame){SC.error("Delegate, exampleElement, and frame options are required.");return NO}d=b.delegate;f=b.value}else{f=d.get("value")}g=SC.beget(d);g.mixin({inlineEditorWillBeginEditing:function(){if(d.inlineEditorWillBeginEditing){d.inlineEditorWillBeginEditing.apply(d,arguments)}},inlineEditorDidBeginEditing:function(){if(d.inlineEditorDidBeginEditing){d.inlineEditorDidBeginEditing.apply(d,arguments)}},inlineEditorWillCommitEditing:function(j,k,h){if(d.inlineEditorWillCommitEditing){d.inlineEditorWillCommitEditing(j,k,h)}if(d.inlineEditorWillEndEditing){d.inlineEditorWillEndEditing(j,k)}},inlineEditorDidCommitEditing:function(j,k,h){if(d.inlineEditorDidCommitEditing){d.inlineEditorDidCommitEditing(j,k,h)}if(d.inlineEditorDidEndEditing){d.inlineEditorDidEndEditing(j,k)}SC.InlineTextFieldView._endEditing()},inlineEditorWillDiscardEditing:function(j,h){if(d.inlineEditorWillDiscardEditing){d.inlineEditorWillDiscardEditing(j,h)}if(d.inlineEditorWillEndEditing){d.inlineEditorWillEndEditing(j,this.get("value"))}},inlineEditorDidDiscardEditing:function(j,h){if(d.inlineEditorDidDiscardEditing){d.inlineEditorDidDiscardEditing(j,h)}if(d.inlineEditorDidEndEditing){d.inlineEditorDidEndEditing(j,this.get("value"))}SC.InlineTextFieldView._endEditing()}});if(d.inlineEditorShouldBeginEditing&&!d.inlineEditorShouldBeginEditing(d,f)){return NO}this.editor=e=this.inlineEditorDelegate.acquireEditor(d);e.set("value",f);if(b){e.set("exampleElement",b.exampleElement);e.set("exampleFrame",b.frame);e.set("multiline",b.multiline);e.set("escapeHTML",b.escapeHTML);e.set("isCollection",b.isCollection);e.set("commitOnBLur",b.commitOnBlur);e.set("validator",b.validator)}if(e){return e.beginEditing(g)}else{return NO}},commitEditing:function(){return this.inlineEditorDelegate.editor?this.inlineEditorDelegate.editor.commitEditing():NO},discardEditing:function(){return this.inlineEditorDelegate.editor?this.inlineEditorDelegate.editor.discardEditing():NO},_endEditing:function(){this.inlineEditorDelegate.releaseEditor(this.editor);this.editor=null}});sc_require("mixins/inline_editable");sc_require("mixins/inline_editor_delegate");sc_require("delegates/inline_text_field");SC.REGULAR_WEIGHT="normal";SC.BOLD_WEIGHT="bold";SC.LabelView=SC.View.extend(SC.Control,SC.InlineEditable,{classNames:["sc-label-view"],displayProperties:["displayTitle","displayHint","escapeHTML","textAlign","fontWeight","icon","needsEllipsis","toolTip"],inlineEditorDelegate:SC.InlineTextFieldDelegate,isEditable:NO,exampleEditor:SC.InlineTextFieldView,fontWeight:null,escapeHTML:YES,escapeHTMLBindingDefault:SC.Binding.oneWay().bool(),localize:NO,localizeBindingDefault:SC.Binding.oneWay().bool(),formatter:null,value:"",hint:null,hintEnabled:function(){return this.get("isEditable")}.property("isEditable").cacheable(),icon:null,textAlign:null,supportsAutoResize:YES,autoResizeLayer:function(){return this.get("layer")}.property("layer").cacheable(),autoResizeText:function(){return this.get("displayTitle")}.property("displayTitle").cacheable(),autoResizePadding:SC.propertyFromRenderDelegate("autoResizePadding",10),renderDelegateName:"labelRenderDelegate",displayTitle:function(){var h,f;h=this.get("value");f=this.getDelegateProperty("formatter",this.displayDelegate);if(f){var g=(SC.typeOf(f)===SC.T_FUNCTION)?f(h,this):f.fieldValueForObject(h,this);if(!SC.none(g)){h=g}}if(SC.typeOf(h)===SC.T_ARRAY){var e=[];for(var b=0,d=h.get("length");b<d;b++){var a=h.objectAt(b);if(!SC.none(a)&&a.toString){a=a.toString()}e.push(a)}h=e.join(",")}if(!SC.none(h)&&h.toString){h=h.toString()}if(h&&this.getDelegateProperty("localize",this.displayDelegate)){h=SC.String.loc(h)}return h}.property("value","localize","formatter").cacheable(),displayHint:function(){var b=this.get("hint"),a=this.get("isEditable");if(a){if(b&&this.getDelegateProperty("localize",this.displayDelegate)){b=SC.String.loc(b)}}else{b=null}return b}.property("hint","localize","isEditable").cacheable(),hintValue:function(){var a=this.get("hint");return a}.property("hint").cacheable(),doubleClick:function(a){return this.beginEditing()},inlineEditorDidBeginEditing:function(b,d,e,a){this._oldOpacity=this.get("layout").opacity||1;this.adjust("opacity",0);b(d,e,a)}.enhance(),inlineEditorDidEndEditing:function(){this.adjust("opacity",this._oldOpacity);this._oldOpacity=null}});SC.allowsBackspaceToPreviousPage=NO;SC.HORIZONTAL_ORIENTATION="horizontal";SC.VERTICAL_ORIENTATION="vertical";SC.BORDER_BEZEL="sc-bezel-border";SC.BORDER_BLACK="sc-black-border";SC.BORDER_GRAY="sc-gray-border";SC.BORDER_TOP="sc-top-border";SC.BORDER_BOTTOM="sc-bottom-border";SC.BORDER_NONE=null;SC.Border={borderTop:0,borderRight:0,borderBottom:0,borderLeft:0,borderStyle:SC.BORDER_GRAY,hasBorder:YES,displayProperties:["borderStyle"],_BORDER_REGEXP:(/-border$/),initMixin:function(){this._sc_border_borderStyleDidChange();this._sc_border_borderDimensionsDidChange()},renderMixin:function(a,d){var b=this.get("borderStyle");if(b){if(this._BORDER_REGEXP.exec(b)){a.addClass(b)}else{a.addStyle("border","1px "+b+" solid")}}},_sc_border_borderStyleDidChange:function(){var a=this.get("borderStyle"),b=SC.Border.dimensions[a];if(b){this.beginPropertyChanges();this.set("borderTop",b);this.set("borderRight",b);this.set("borderBottom",b);this.set("borderLeft",b);this.endPropertyChanges()}},_sc_border_borderDimensionsDidChange:function(){var e=this.get("borderTop"),a=this.get("borderRight"),b=this.get("borderBottom"),d=this.get("borderLeft");this.adjust({borderTop:e,borderRight:a,borderBottom:b,borderLeft:d})}.observes("borderTop","borderRight","borderBottom","borderLeft")};SC.mixin(SC.Border,{dimensions:{"sc-bezel-border":1,"sc-black-border":1,"sc-gray-border":1,"sc-top-border":1,"sc-bottom-border":1}});SC.CollectionFastPath={initMixin:function(){this._indexMap={};this._viewMap={}},poolForExampleView:function(a){var b="_pool_"+SC.guidFor(a);if(!this[b]){this[b]=[]}return this[b]},createItemViewFromExampleView:function(d,b){var a=this.createItemView(d,null,b);if(a.isPoolable){a.owningPool=this.poolForExampleView(d)}a.createdFromExampleView=d;return a},configureItemView:function(b,a){b.beginPropertyChanges();b.setIfChanged("content",a.content);b.setIfChanged("contentIndex",a.contentIndex);b.setIfChanged("parentView",a.parentView);b.setIfChanged("layerId",a.layerId);b.setIfChanged("isEnabled",a.isEnabled);b.setIfChanged("isSelected",a.isSelected);b.setIfChanged("outlineLevel",a.outlineLevel);b.setIfChanged("layout",a.layout);b.setIfChanged("disclosureState",a.disclosureState);b.setIfChanged("isVisibleInWindow",a.isVisibleInWindow);b.setIfChanged("isGroupView",a.isGroupView);b.setIfChanged("page",this.page);b.endPropertyChanges()},wakePooledView:function(b,a){this.configureItemView(b,a);if(b.awakeFromPool){b.awakeFromPool(b.owningPool,this)}},allocateItemView:function(e,b){var a;if(e.prototype.isPoolable){var d=this.poolForExampleView(e);if(d.length>0){a=d.pop();this.wakePooledView(a,b)}}if(!a){a=this.createItemViewFromExampleView(e,b)}return a},releaseItemView:function(b){if(!b.isPoolable){b.destroy();return}var a=b.owningPool;a.push(b);if(b.hibernateInPool){b.hibernateInPool(a,this)}},contentIndexIsGroup:function(a,e,d){var f=this.get("contentDelegate");var b=this.get("_contentGroupIndexes"),g=NO;g=b&&b.contains(d);if(g){g=f.contentIndexIsGroup(this,this.get("content"),d)}return g},exampleViewForItem:function(g,e){var b=this.get("contentDelegate"),d=this.get("_contentGroupIndexes"),f,a,h=this.contentIndexIsGroup(this,this.get("content"),e);if(h){f=this.get("contentGroupExampleViewKey");if(f&&g){a=g.get(f)}if(!a){a=this.get("groupExampleView")||this.get("exampleView")}}else{f=this.get("contentExampleViewKey");if(f&&g){a=g.get(f)}if(!a){a=this.get("exampleView")}}return a},setAttributesForItem:function(g,e,d){var b=this.get("contentDelegate"),h=this.contentIndexIsGroup(this,this.get("content"),e),a=this.exampleViewForItem(g,e),f=this.get("content");d.createdFromExampleView=a;d.parentView=this.get("containerView")||this;d.contentIndex=e;d.owner=d.displayDelegate=this;d.content=g;d.page=this.page;d.layerId=this.layerIdFor(e);d.isEnabled=b.contentIndexIsEnabled(this,f,e);d.isSelected=b.contentIndexIsSelected(this,f,e);d.outlineLevel=b.contentIndexOutlineLevel(this,f,e);d.disclosureState=b.contentIndexDisclosureState(this,f,e);d.isVisibleInWindow=this.get("isVisibleInWindow");d.isGroupView=h;d.layout=this.layoutForContentIndex(e);if(!d.layout){d.layout=a.prototype.layout}},mappedViewsForItem:function(a,b){if(!b){b=this._viewMap}return b[SC.guidFor(a)]},mappedViewForItem:function(d,b,e){if(!e){e=this._viewMap}var a=e[SC.guidFor(d)];if(!a){return undefined}return a[b]},mapView:function(f,d,b,h){if(!h){h=this._viewMap}var e=SC.guidFor(f),a=h[e];if(!a){a=h[e]={_length:0}}a[d]=b;a._length++},unmapView:function(f,d,h){if(!h){h=this._viewMap}var e=SC.guidFor(f),a=h[e];if(!a){return}if(a[d]){var b=a[d];delete a[d];a._length--;if(a._length<=0){delete h[e]}}},itemViewForContentIndex:function(b){var e=this.get("content");if(!e){return}var d=e.objectAt(b);var f=this.exampleViewForItem(d,b),a=this._indexMap[b];if(a&&a.createdFromExampleView!==f){this.removeItemView(a);this.unmapView(d,b);a=null}if(!a){a=this.addItemView(f,d,b)}return a},nearestMappedViewIndexForItem:function(f,d,g){var b=this.mappedViewsForItem(f,g);if(!b){return null}var e=null,j=-1,h=0;for(var a in b){a=parseInt(a,10);if(isNaN(a)){continue}h=Math.abs(d-a);if(j<0||h<j){j=h;e=a}}return e},remapItemViews:function(b){var l=this._viewMap,a=(this._viewMap={}),k=(this._indexMap={}),m=[],j=this.get("content"),p;if(!j){return}var g=this._itemsToAdd;b.forEach(function(q){p=j.objectAt(q);var t=this.mappedViewsForItem(p,l);if(t){if(t[q]){var s=t[q];this.unmapView(p,q,l);this.mapView(p,q,s,a);k[q]=s}else{m.push(q)}}else{g.push(q)}},this);for(var o=0,h=m.length;o<h;o++){var n=m[o];p=j.objectAt(n);var f=this.nearestMappedViewIndexForItem(p,n,l),d;if(!SC.none(f)){d=this.mappedViewForItem(p,f,l);var e=this.exampleViewForItem(p,n);if(e===d.createdFromExampleView){this.unmapView(p,f,l);this.mapView(p,n,d,a);k[n]=d}else{g.push(n)}}else{g.push(n)}}return l},reloadIfNeeded:function(g,b){var e=this.get("content"),f;if(!g||!g.isIndexSet){g=this.get("nowShowing")}if(!b){f=this._invalidIndexes;if(!f||!this.get("isVisibleInWindow")){return this}this._invalidIndexes=NO;if(f.isIndexSet&&f.contains(g)){f=YES}if(this.willReload){this.willReload(f===YES?null:f)}}var h=this._itemsToAdd||(this._itemsToAdd=[]);var a=this.remapItemViews(g);this.processRemovals(a);if(f){this.processUpdates(f===YES?g:f)}this.processAdds();if(!b){this.clearDOMPools()}h.length=0;if(!b){var d=this.computeLayout();if(d){this.adjust(d)}if(this.didReload){this.didReload(f===YES?null:f)}}return this},processRemovals:function(d){var g=this.get("content");for(var e in d){var b=d[e];for(var f in b){f=parseInt(f,10);if(isNaN(f)){continue}var a=b[f];if(this._indexMap[f]===a){delete this._indexMap[f]}a._isInCollection=NO;this.removeItemView(a)}}},processUpdates:function(f){var b=this._itemsToUpdate,e=this.get("content"),d,a;f.forEach(function(g){d=e.objectAt(g);if(a=this.mappedViewForItem(d,g)){if(!a._isInCollection){return}var h=this.exampleViewForItem(d,g);this.updateItemView(a,h,d,g)}},this)},processAdds:function(){var g=this.get("content");var h=this._itemsToAdd,b,a=h.length,f,e;for(b=0;b<a;b++){f=h[b];e=g.objectAt(f);var j=this.exampleViewForItem(e,f);var d=this.addItemView(j,e,f)}},clearDOMPools:function(){var a=this._domPools||(this._domPools={});for(var b in a){this.clearDOMPool(a[b])}},domPoolSize:10,clearDOMPool:function(d){var b,a=d.length,e;for(b=this.domPoolSize;b<a;b++){e=d[b];this.removeChild(e);this.releaseItemView(e)}d.length=Math.min(d.length,this.domPoolSize)},domPoolForExampleView:function(e){var d=this._domPools||(this._domPools={}),a=SC.guidFor(e);var b=d[a];if(!b){b=d[a]=[]}return b},itemFromDOMPool:function(d){var b=this.domPoolForExampleView(d);if(b.length<1){return null}var a=b.shift();if(a.wakeFromDOMPool){a.wakeFromDOMPool()}return a},sendToDOMPool:function(a){var b=this.domPoolForExampleView(a.createdFromExampleView);b.push(a);var d=a.get("frame");a.adjust({top:-d.height});a.set("layerId",SC.guidFor(a));if(a.sleepInDOMPool){a.sleepInDOMPool()}},addItemView:function(f,e,d){var a,b=this._TMP_ATTRS||(this._TMP_ATTRS={});this.setAttributesForItem(e,d,b);if(a=this.itemFromDOMPool(f)){this.configureItemView(a,b);a._isInCollection=YES;this.mapView(e,d,a);this._indexMap[d]=a;return a}a=this.allocateItemView(f,b);this.appendChild(a);a._isInCollection=YES;this.mapView(e,d,a);this._indexMap[d]=a;return a},removeItemView:function(a){if(a.get("layerIsCacheable")){this.sendToDOMPool(a)}else{this.removeChild(a)}a._isInCollection=NO},updateItemView:function(e,f,d,b){if(!e.get("layerIsCacheable")||e.createdFromExampleView!==f){this.unmapView(e,b);delete this._indexMap[b];this.removeItemView(e,d,b);var g=this.addItemView(f,d,b)}else{var a=this._TMP_ATTRS||(this._TMP_ATTRS={});this.setAttributesForItem(d,b,a);this.configureItemView(e,a)}},_lastTopUpdate:0,_lastLeftUpdate:0,_tolerance:100,touchScrollDidChange:function(h,g){if(Date.now()-this._lastTouchScrollTime<25){return}var j=this.get("clippingFrame");var f=this._inScrollClippingFrame||(this._inScrollClippingFrame={x:0,y:0,width:0,height:0});f.x=j.x;f.y=j.y;f.width=j.width;f.height=j.height;f.x=h;f.y=g;var e=this.contentIndexesInRect(f);if(!e){return}var b=this.get("length"),a=e.get("max"),d=e.get("min");if(a>b||d<0){e=e.copy();e.remove(b,a-b).remove(d,0-d).freeze()}if(this._lastNowShowing){if(e.contains(this._lastNowShowing)&&this._lastNowShowing.contains(e)){return}}this._lastNowShowing=e;this.reloadIfNeeded(e,YES);this._lastTouchScrollTime=Date.now()}};SC.CollectionGroup={classNames:["sc-collection-group"]};SC.CollectionRowDelegate={isCollectionRowDelegate:YES,itemHeight:24,rowSpacing:0,rowPadding:0,rowHeight:function(b,d){var a=this.get("rowPadding");var e=this.get("itemHeight");if(d!==undefined){this.set("itemHeight",d-a*2);return d}return e+a*2}.property("itemHeight","rowPadding"),customRowHeightIndexes:null,contentIndexRowHeight:function(a,b,d){return this.get("rowHeight")}};SC.CollectionViewDelegate={isCollectionViewDelegate:YES,collectionViewSelectionForProposedSelection:function(a,b){return b},collectionViewShouldSelectIndexes:function(a,b,d){return b},collectionViewShouldDeselectIndexes:function(a,b){return b},collectionViewShouldDeleteIndexes:function(a,b){return b},collectionViewDeleteContent:function(a,d,b){if(!d){return NO}if(SC.typeOf(d.destroyAt)===SC.T_FUNCTION){d.destroyAt(b);a.selectPreviousItem(NO,1);return YES}else{if(SC.typeOf(d.removeAt)===SC.T_FUNCTION){d.removeAt(b);a.selectPreviousItem(NO,1);return YES}else{return NO}}},collectionViewShouldBeginDrag:function(a){return YES},collectionViewDragDataTypes:function(a){return[]},collectionViewDragDataForType:function(a,d,b){return null},collectionViewComputeDragOperations:function(a,b,d){return d},collectionViewValidateDragOperation:function(b,e,f,d,a){return(a&SC.DROP_ON)?SC.DRAG_NONE:f},collectionViewPerformDragOperation:function(b,e,f,d,a){return SC.DRAG_NONE},collectionViewDragViewFor:function(a,b){return null},ghostActsLikeCursor:NO};SC.NavigationBuilder={isNavigationBuilder:YES,navigationTransitions:NO,initMixin:function(){var b=SC.Animatable;if(b&&!this.isAnimatable){this.mixin(b)}else{if(!b){SC.Logger.error("SC.NavigationView and SC.NavigationBuilder require SC.Animatable to perform animations, but it is not present. Please ensure your app or framework references it.")}}var a=this.get("navigationTransitions");if(!a&&SC.Animatable){a={left:{duration:0.25,timing:SC.Animatable.TRANSITION_EASE_IN_OUT,action:"navigationBuildDidFinish"},transform:{duration:0.25,timing:SC.Animatable.TRANSITION_EASE_IN_OUT,action:"navigationBuildDidFinish"}}}if(SC.Animatable){SC.mixin(this.transitions,a)}},metrics:function(){var a=this.computeFrameWithParentFrame();return a},transform:function(a){if(SC.platform.supportsCSS3DTransforms){this.adjust("transform","translate3d("+a+"px,0px,0px)")}else{this.adjust("transform","translate("+a+"px,0px)")}},buildInNavigation:function(){var a=this.metrics();this.disableAnimation();this.transform(this.get("buildDirection")===SC.TO_LEFT?a.width:-a.width);this.enableAnimation();this.invokeLater("transform",10,0)},buildOutNavigation:function(){var a=this.metrics();this.transform(this.get("buildDirection")===SC.TO_LEFT?-a.width:a.width)},buildIn:function(){this.buildInNavigation()},buildOut:function(){this.buildOutNavigation()},resetBuild:function(){this.transform(0)},navigationBuildDidFinish:function(){if(this.isBuildingIn){this.buildInDidFinish()}else{if(this.isBuildingOut){this.buildOutDidFinish()}}}};SC.Scrollable={isScrollable:true,verticalLineScroll:20,horizontalLineScroll:20,verticalPageScroll:function(){return this.get("innerFrame").height}.property("innerFrame"),horizontalPageScroll:function(){return this.get("innerFrame").width}.property("innerFrame"),hasVerticalScroller:function(){return this.get("scrollFrame").height>this.get("innerFrame").height}.property("scrollFrame"),hasHorizontalScroller:function(){return this.get("scrollFrame").width>this.get("innerFrame").width}.property("scrollFrame"),scrollBy:function(a){var b=this.get("scrollFrame");var d=this.get("innerFrame");if(!this.get("hasVerticalScroller")){a.y=0}if(b.height<=d.height){a.y=0}if(!this.get("hasHorizontalScroller")){a.x=0}if(b.width<=d.width){a.x=0}var e={x:b.x-(a.x||0),y:b.y-(a.y||0)};this.set("scrollFrame",e);e=this.get("scrollFrame");return{x:e.x-b.x,y:e.y-b.y}},scrollTo:function(a,b){this.set("scrollFrame",{x:0-a,y:0-b})},scrollToVisible:function(b){var g=this.get("innerFrame");var e=this.get("scrollFrame");var a=this.convertFrameFromView(b.get("frame"),b);a.x-=(g.x+e.x);a.y-=(g.y+e.y);var d={x:0-e.x,y:0-e.y,width:g.width,height:g.height};d.y-=Math.max(0,SC.minY(d)-SC.minY(a));d.x-=Math.max(0,SC.minX(d)-SC.minX(a));d.y+=Math.max(0,SC.maxY(a)-SC.maxY(d));d.x+=Math.max(0,SC.maxX(a)-SC.maxX(d));this.scrollTo(d.x,d.y)},scrollDownLine:function(a){if(a===undefined){a=1}return this.scrollBy({y:this.get("verticalLineScroll")*a}).y},scrollUpLine:function(a){if(a===undefined){a=1}return 0-this.scrollBy({y:0-this.get("verticalLineScroll")*a}).y},scrollRightLine:function(a){if(a===undefined){a=1}return this.scrollTo({y:this.get("horizontalLineScroll")*a}).x},scrollLeftLine:function(a){if(a===undefined){a=1}return 0-this.scrollTo({y:0-this.get("horizontalLineScroll")*a}).x},scrollDownPage:function(a){if(a===undefined){a=1}return this.scrollBy({y:this.get("verticalPageScroll")*a}).y},scrollUpPage:function(a){if(a===undefined){a=1}return 0-this.scrollBy({y:0-this.get("verticalPageScroll")*a}).y},scrollRightPage:function(a){if(a===undefined){a=1}return this.scrollTo({y:this.get("horizontalPageScroll")*a}).x},scrollLeftPage:function(a){if(a===undefined){a=1}return 0-this.scrollTo({y:0-this.get("horizontalPageScroll")*a}).x}};SC.ModalPane=SC.Pane.extend({classNames:"sc-modal",_openPaneCount:0,paneWillAppend:function(f){var e;this._openPaneCount++;if(!this.get("isVisibleInWindow")){this.append()}var d=SC.RootResponder.responder.panes;for(var b=0,a=d.length;b<a;b++){e=d[b];if(e!==f){this._hideShowTextfields(e,NO)}}return this},paneDidRemove:function(f){var e;this._openPaneCount--;var d=SC.RootResponder.responder.panes;for(var b=0,a=d.length;b<a;b++){e=d[b];if(e!==f){this._hideShowTextfields(e,YES)}}if(this._openPaneCount<=0){this._openPaneCount=0;if(this.get("isVisibleInWindow")){this.remove()}}},_hideShowTextfields:function(d,b){var a;for(a in SC.View.views){a=SC.View.views[a];if(a!==d&&a.get("pane")===d&&a.get("isTextField")){if(b){if(a._scmp_isBrowserFocusable!==undefined){b=a._scmp_isBrowserFocusable;delete a._scmp_isBrowserFocusable}}else{a._scmp_isBrowserFocusable=a.get("isBrowserFocusable")}a.set("isBrowserFocusable",b)}}},mouseDown:function(b){var a=this.get("owner");if(a&&a.modalPaneDidClick){a.modalPaneDidClick(b)}},touchStart:function(a){this.mouseDown(a)}});sc_require("panes/modal");SC.PanelPane=SC.Pane.extend({isPanelPane:YES,classNames:["sc-panel"],acceptsKeyPane:YES,ariaRole:"dialog",ariaLabel:null,ariaLabelledBy:null,ariaDescribedBy:null,isModal:YES,modalPane:SC.ModalPane.extend({classNames:"for-sc-panel"}),contentView:null,contentViewBindingDefault:SC.Binding.single(),replaceContent:function(a){this.removeAllChildren();if(a){this.appendChild(a)}},createChildViews:function(){var a=this.contentView;if(a){a=this.contentView=this.createChildView(a);this.childViews=[a]}},contentViewDidChange:function(){this.replaceContent(this.get("contentView"))}.observes("contentView"),renderDelegateName:"panelRenderDelegate",_modalPane:function(){var a=this.get("modalPane");if(a&&a.isClass){a=a.create({owner:this});this.set("modalPane",a)}return a},appendTo:function(a){var b;if(!this.get("isVisibleInWindow")&&this.get("isModal")&&(b=this._modalPane())){this._isShowingModal=YES;b.paneWillAppend(this)}return arguments.callee.base.apply(this,arguments)},remove:function(){var b,a=arguments.callee.base.apply(this,arguments);if(this._isShowingModal){this._isShowingModal=NO;if(b=this._modalPane()){b.paneDidRemove(this)}}return a},destroy:function(){var a=this.get("modalPane");if(a&&!a.isClass){a.destroy()}arguments.callee.base.apply(this,arguments)},_isModalDidChange:function(){var b,a=this.get("isModal");if(a){if(!this._isShowingModal&&this.get("isVisibleInWindow")&&(b=this._modalPane())){this._isShowingModal=YES;b.paneWillAppend(this)}}else{if(this._isShowingModal&&(b=this._modalPane())){this._isShowingModal=NO;b.paneDidRemove(this)}}}.observes("isModal"),paneDidAttach:function(){var a=arguments.callee.base.apply(this,arguments);this.becomeKeyPane();return a},displayProperties:["ariaLabel","ariaLabelledBy","ariaDescribedBy"]});SC.TOGGLE_BEHAVIOR="toggle";SC.PUSH_BEHAVIOR="push";SC.TOGGLE_ON_BEHAVIOR="on";SC.TOGGLE_OFF_BEHAVIOR="off";SC.HOLD_BEHAVIOR="hold";SC.ButtonView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),classNames:["sc-button-view"],themeName:"square",value:null,toggleOnValue:YES,toggleOffValue:NO,localize:NO,localizeBindingDefault:SC.Binding.bool(),title:"",tooltip:"",contentTitleKey:null,icon:null,contentIconKey:null,needsEllipsis:YES,displayTitle:function(){var a=this.get("title");return(a&&this.get("localize"))?SC.String.loc(a):(a||"")}.property("title","localize").cacheable(),keyEquivalent:null,buttonBehavior:SC.PUSH_BEHAVIOR,holdInterval:100,isDefault:NO,isDefaultBindingDefault:SC.Binding.oneWay().bool(),isCancel:NO,isCancelBindingDefault:SC.Binding.oneWay().bool(),action:null,target:null,supportFocusRing:NO,supportsAutoResize:YES,autoResizeLayer:function(){var a=this.invokeRenderDelegateMethod("getRenderedAutoResizeLayer",this.$());return a||this.get("layer")}.property("layer").cacheable(),autoResizeText:function(){return this.get("displayTitle")}.property("displayTitle").cacheable(),autoResizePadding:SC.propertyFromRenderDelegate("autoResizePadding",10),_labelMinWidthIE7:0,triggerActionAfterDelay:function(a){if(!this.get("isEnabled")){return NO}this.set("isActive",YES);this.invokeLater("triggerAction",200,a);return YES},triggerAction:function(a){this._action(a,YES);this.didTriggerAction();this.set("isActive",NO)},didTriggerAction:function(){},init:function(){arguments.callee.base.apply(this,arguments);var a=this.get("keyEquivalent");if(a){this._defaultKeyEquivalent=a}if(!SC.none(this.get("value"))){this._button_valueDidChange()}},ariaRole:"button",displayProperties:["icon","displayTitle","value","displayToolTip","isDefault","isCancel","escapeHTML","needsEllipsis","tooltip","supportFocusRing","buttonBehavior"],renderDelegateName:"buttonRenderDelegate",contentKeys:{contentValueKey:"value",contentTitleKey:"title",contentIconKey:"icon"},_button_displayObserver:function(){this.displayDidChange()}.observes("title","icon","value"),performKeyEquivalent:function(d,b){if(!this.get("isVisibleInWindow")){return NO}if(!this.get("isEnabled")){return NO}var a=this.get("keyEquivalent");if(a){if(a===d){return this.triggerAction(b)}}else{if((this.get("isDefault")&&(d==="return"))||(this.get("isCancel")&&(d==="escape"))){return this.triggerAction(b)}}return NO},computeIsSelectedForValue:function(e){var b=this.get("toggleOnValue"),d,a;if(SC.typeOf(e)===SC.T_ARRAY){if(e.length===1){d=(e[0]==b)}else{d=null;e.find(function(f){a=(f==b);if(d===null){d=a}else{if(a!==d){d=SC.MIXED_STATE}}return d===SC.MIXED_STATE})}}else{if(e===SC.MIXED_STATE){d=SC.MIXED_STATE}else{d=(e===b)}}return d},_button_valueDidChange:function(){var b=this.get("value"),a=this.computeIsSelectedForValue(b);this.set("isSelected",a)}.observes("value"),_button_isSelectedDidChange:function(){var d=this.get("isSelected"),b=this.computeIsSelectedForValue(this.get("value"));if((d!==SC.MIXED_STATE)&&(b!==d)){var a=(d)?"toggleOnValue":"toggleOffValue";this.set("value",this.get(a))}}.observes("isSelected"),_defaultKeyEquivalent:null,_isDefaultOrCancelDidChange:function(){var b=!!this.get("isDefault"),a=!b&&this.get("isCancel");if(b){this.set("keyEquivalent","return")}else{if(a){this.set("keyEquivalent","escape")}else{this.set("keyEquivalent",this._defaultKeyEquivalent)}}}.observes("isDefault","isCancel"),mouseDown:function(a){var b=this.get("buttonBehavior");if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;if(b===SC.HOLD_BEHAVIOR){this._action(a)}else{if(!this._isFocused&&(b!==SC.PUSH_BEHAVIOR)){this._isFocused=YES;this.becomeFirstResponder()}}return YES},mouseExited:function(a){if(this._isMouseDown){this.set("isActive",NO)}return YES},mouseEntered:function(a){if(this._isMouseDown){this.set("isActive",YES)}return YES},mouseUp:function(b){if(this._isMouseDown){this.set("isActive",NO)}this._isMouseDown=false;if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){var a=this.$().within(b.target);if(a&&this.get("isEnabled")){this._action(b)}}return YES},touchStart:function(b){var a=this.get("buttonBehavior");if(!this.get("isEnabled")){return YES}this.set("isActive",YES);if(a===SC.HOLD_BEHAVIOR){this._action(b)}else{if(!this._isFocused&&(a!==SC.PUSH_BEHAVIOR)){this._isFocused=YES;this.becomeFirstResponder()}}b.preventDefault();return YES},touchesDragged:function(a,b){if(!this.touchIsInBoundary(a)){if(!this._touch_exited){this.set("isActive",NO)}this._touch_exited=YES}else{if(this._touch_exited){this.set("isActive",YES)}this._touch_exited=NO}a.preventDefault();return YES},touchEnd:function(a){this._touch_exited=NO;this.set("isActive",NO);if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){if(this.touchIsInBoundary(a)&&this.get("isEnabled")){this._action()}}a.preventDefault();return YES},keyDown:function(b){if(!this.get("isEnabled")){return YES}if(b.which===9||b.keyCode===9){var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(b.which===13||b.which===32){this.triggerActionAfterDelay(b);return YES}b.allowDefault();return NO},_action:function(a,d){switch(this.get("buttonBehavior")){case SC.TOGGLE_BEHAVIOR:var b=this.get("isSelected");if(b){this.set("value",this.get("toggleOffValue"))}else{this.set("value",this.get("toggleOnValue"))}break;case SC.TOGGLE_ON_BEHAVIOR:this.set("value",this.get("toggleOnValue"));break;case SC.TOGGLE_OFF_BEHAVIOR:this.set("value",this.get("toggleOffValue"));break;case SC.HOLD_BEHAVIOR:this._runHoldAction(a,d);break;default:this._runAction(a)}},_runAction:function(a){var d=this.get("action"),e=this.get("target")||null,b;if(d){if(d&&(SC.typeOf(d)===SC.T_FUNCTION)){this.action(a);return}else{b=this.getPath("pane.rootResponder");if(b){b.sendAction(d,e,this,this.get("pane"),null,this)}}}},_runHoldAction:function(a,b){if(this.get("isActive")){this._runAction();if(!b){SC.RunLoop.begin();this.invokeLater("_runHoldAction",this.get("holdInterval"),a);SC.RunLoop.end()}}},didBecomeKeyResponderFrom:function(a){if(!this._isFocused){this._isFocused=YES;this.becomeFirstResponder();if(this.get("isVisibleInWindow")){this.$().focus()}}},willLoseKeyResponderTo:function(a){if(this._isFocused){this._isFocused=NO}},didAppendToDocument:function(){if(SC.browser.isIE&&SC.browser.compare(SC.browser.engineVersion,"7")===0&&this.get("useStaticLayout")){var f=this.get("layout"),e=this.$(),a=0;if(e&&e[0]&&(a=e[0].clientWidth)&&a!==0&&this._labelMinWidthIE7===0){var d=this.$(".sc-button-label"),j=parseInt(d.css("paddingRight"),0),b=parseInt(d.css("paddingLeft"),0),h=parseInt(d.css("marginRight"),0),g=parseInt(d.css("marginLeft"),0);if(h=="auto"){SC.Logger.log(h+","+g+","+j+","+b)}if(!j&&isNaN(j)){j=0}if(!b&&isNaN(b)){b=0}if(!h&&isNaN(h)){h=0}if(!g&&isNaN(g)){g=0}this._labelMinWidthIE7=a-(j+b)-(h+g);d.css("minWidth",this._labelMinWidthIE7+"px")}else{this.invokeLater(this.didAppendToDocument,1)}}}});SC.ButtonView.CLICK_AND_HOLD_DELAY=SC.browser.isIE?600:300;SC.REGULAR_BUTTON_HEIGHT=24;sc_require("panes/panel");sc_require("views/button");SC.BUTTON1_STATUS="button1";SC.BUTTON2_STATUS="button2";SC.BUTTON3_STATUS="button3";SC.AlertPane=SC.PanelPane.extend({classNames:["sc-alert"],ariaRole:"alertdialog",delegate:null,icon:"sc-icon-alert-48",message:"",ariaLabel:function(){return this.get("message")}.property("message").cacheable(),description:"",displayDescription:function(){var a=this.get("description");if(!a||a.length===0){return a}a=SC.RenderContext.escapeHTML(a);return'<p class="description">'+a.split("\n").join('</p><p class="description">')+"</p>"}.property("description").cacheable(),caption:"",displayCaption:function(){var a=this.get("caption");if(!a||a.length===0){return a}a=SC.RenderContext.escapeHTML(a);return'<p class="caption">'+a.split("\n").join('</p><p class="caption">')+"</p>"}.property("caption").cacheable(),button1:SC.outlet("contentView.childViews.1.childViews.1"),button2:SC.outlet("contentView.childViews.1.childViews.0"),button3:SC.outlet("contentView.childViews.2.childViews.0"),buttonThreeWrapper:SC.outlet("contentView.childViews.2"),layout:{top:0.3,centerX:0,width:500},contentView:SC.View.extend({useStaticLayout:YES,layout:{left:0,right:0,top:0,height:"auto"},childViews:[SC.View.extend(SC.StaticLayout,{classNames:["info"],render:function(a,d){var b=this.get("pane");if(b.get("icon")=="blank"){a.addClass("plain")}a.push('<img src="'+SC.BLANK_IMAGE_URL+'" class="icon '+b.get("icon")+'" />');a.begin("h1").attr("class","header").text(b.get("message")||"").end();a.push(b.get("displayDescription")||"");a.push(b.get("displayCaption")||"");a.push('<div class="separator"></div>')}}),SC.View.extend({layout:{bottom:13,height:24,right:18,width:466},childViews:["cancelButton","okButton"],classNames:["text-align-right"],cancelButton:SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON2_STATUS,localize:YES,layout:{right:5,height:"auto",width:"auto",bottom:0},isCancel:YES,action:"dismiss",isVisible:NO}),okButton:SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON1_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},isDefault:YES,action:"dismiss",isVisible:NO})}),SC.View.extend({layout:{bottom:13,height:24,left:18,width:150},childViews:[SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON3_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},action:"dismiss",isVisible:NO})]})]}),dismiss:function(b){var a=this.delegate,d,e,f;if(a&&a.alertPaneDidDismiss){a.alertPaneDidDismiss(this,b.get("actionKey"))}if(e=(b&&b.get("customAction"))){if(SC.typeOf(e)===SC.T_FUNCTION){e.call(e)}else{d=this.getPath("pane.rootResponder");if(d){f=b.get("customTarget");d.sendAction(e,f||a,this,this,null,this)}}}this.remove()},alertInfoDidChange:function(){var a=this.getPath("contentView.childViews.0");if(a){a.displayDidChange()}}.observes("icon","message","displayDescription","displayCaption")});SC.AlertPane.mixin({show:function(g){g=SC.AlertPane._argumentsCall.apply(this,arguments);var a=this.create(g),l=0,h=g.buttons,f,j,b,e,d;if(h){h.forEach(function(m){l++;if(!m){return}f=a.get("button%@".fmt(l));j=m.title;b=m.action;e=m.target;d=g.themeName||"capsule";f.set("title".fmt(l),j);if(b){f.set("customAction".fmt(l),b)}if(e){f.set("customTarget".fmt(l),e)}f.set("isVisible",!!j);f.set("themeName",d)})}else{f=a.get("button1");f.set("title","OK");f.set("isVisible",YES)}var k=a.append();a.adjust("height",a.childViews[0].$().height());a.updateLayout();return k},warn:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="sc-icon-alert-48";return this.show(a)},info:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="sc-icon-info-48";return this.show(a)},error:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="sc-icon-error-48";return this.show(a)},plain:function(a){a=SC.AlertPane._argumentsCall.apply(this,arguments);a.icon="blank";return this.show(a)},_argumentsCall:function(b){var a=b;if(SC.typeOf(b)!==SC.T_HASH){var d=this._normalizeArguments(arguments);a={message:d[0],description:d[1],caption:d[2],delegate:d[7],icon:(d[6]||"sc-icon-alert-48"),themeName:"capsule"};if(SC.typeOf(d[3])===SC.T_STRING||SC.typeOf(d[4])===SC.T_STRING||SC.typeOf(d[5])===SC.T_STRING){a.buttons=[{title:d[3]},{title:d[4]},{title:d[5]}]}}return a},_normalizeArguments:function(b){b=SC.A(b);var a=b.length,d=b[a-1];if(SC.typeOf(d)!==SC.T_STRING){b[a-1]=null}else{d=null}b[7]=d;return b}});sc_require("panes/panel");SC.PalettePane=SC.PanelPane.extend({classNames:["sc-palette"],isModal:NO,modalPane:SC.ModalPane,isAnchored:NO,_mouseOffsetX:null,_mouseOffsetY:null,mouseDown:function(a){var b=this.get("frame");this._mouseOffsetX=b?(b.x-a.pageX):0;this._mouseOffsetY=b?(b.y-a.pageY):0;return YES},mouseDragged:function(a){if(!this.isAnchored){this.set("layout",{width:this.layout.width,height:this.layout.height,left:this._mouseOffsetX+a.pageX,top:this._mouseOffsetY+a.pageY});this.updateLayout()}return YES},touchStart:function(a){return this.mouseDown(a)},touchesDragged:function(a){return this.mouseDragged(a)}});sc_require("panes/palette");SC.PICKER_MENU="menu";SC.PICKER_FIXED="fixed";SC.PICKER_POINTER="pointer";SC.PICKER_MENU_POINTER="menu-pointer";SC.POINTER_LAYOUT=["perfectRight","perfectLeft","perfectTop","perfectBottom"];SC.PickerPane=SC.PalettePane.extend({classNames:["sc-picker"],isAnchored:YES,isModal:YES,pointerPos:"perfectRight",pointerPosX:0,pointerPosY:0,anchorElement:null,anchorCached:null,preferType:null,preferMatrix:null,pointerOffset:null,extraRightOffset:0,removeTarget:null,removeAction:null,repositionOnWindowResize:YES,_anchorView:null,_anchorHTMLElement:null,popup:function(d,b,e,a){if(d){if(d.isView){this._anchorView=d;this._setupScrollObservers(d)}else{this._anchorHTMLElement=d}}this.beginPropertyChanges();if(b){this.set("preferType",b)}if(e){this.set("preferMatrix",e)}if(a){this.set("pointerOffset",a)}this.endPropertyChanges();this.positionPane();this._hideOverflow();return this.append()},positionPane:function(g){g=g&&this.get("anchorCached");var b=g?this.get("anchorCached"):this.get("anchorElement"),d=this.get("preferType"),e=this.get("preferMatrix"),f=this.get("layout"),a;if(b){if(!g){b=this.computeAnchorRect(b);this.set("anchorCached",b)}if(b.x===0&&b.y===0){return}a=SC.cloneRect(b);if(d){switch(d){case SC.PICKER_MENU:case SC.PICKER_FIXED:if(!e||e.length!==3){this.set("preferMatrix",[1,4,3])}a.x+=((this.preferMatrix[2]===0)?a.width:0)+this.preferMatrix[0];a.y+=((this.preferMatrix[2]===3)?a.height:0)+this.preferMatrix[1];break;default:a.y+=a.height;break}}else{a.y+=a.height}a=this.fitPositionToScreen(a,this.get("frame"),b);this.adjust({width:a.width,height:a.height,left:a.x,top:a.y})}else{this.adjust({width:f.width,height:f.height,centerX:0,centerY:0})}this.updateLayout();return this},computeAnchorRect:function(d){var f,b,e,a=SC.RootResponder.responder.computeWindowSize();if(d.getBoundingClientRect){f=d.getBoundingClientRect();b={x:f.left,y:f.top,width:f.width,height:f.height};if(b.width===undefined||b.height===undefined){e=SC.$(d);b.width=e.outerWidth();b.height=e.outerHeight()}}else{b=SC.offset(d);e=SC.$(d);b.width=e.outerWidth();b.height=e.outerHeight()}b.height=(a.height-b.y)<b.height?(a.height-b.y):b.height;if(!SC.browser.isIE&&window.scrollX>0||window.scrollY>0){b.x+=window.scrollX;b.y+=window.scrollY}else{if(SC.browser.isIE&&(document.documentElement.scrollTop>0||document.documentElement.scrollLeft>0)){b.x+=document.documentElement.scrollLeft;b.y+=document.documentElement.scrollTop}}return b},fitPositionToScreen:function(j,d,b){var a=SC.RootResponder.responder.computeWindowSize(),h={x:0,y:0,width:a.width,height:a.height};var e=SC.RootResponder.responder.mainPane;if(e){var f=e.layout.minWidth,g=e.layout.minHeight;if(f&&h.width<f){h.width=e.layout.minWidth}if(g&&h.height<g){h.height=e.layout.minHeight}}d.x=j.x;d.y=j.y;if(this.preferType){switch(this.preferType){case SC.PICKER_MENU:d=this.fitPositionToScreenMenu(h,d,this.get("isSubMenu"));break;case SC.PICKER_MENU_POINTER:this.setupPointer(b);d=this.fitPositionToScreenMenuPointer(h,d,b);break;case SC.PICKER_POINTER:this.setupPointer(b);d=this.fitPositionToScreenPointer(h,d,b);break;case SC.PICKER_FIXED:break;default:break}}else{d=this.fitPositionToScreenDefault(h,d,b)}this.displayDidChange();return d},fitPositionToScreenDefault:function(d,e,b){if(SC.maxX(e)>d.width){var g=Math.max(SC.maxX(b),e.width);e.x=Math.min(g,d.width)-e.width}if(SC.minX(e)<0){e.x=SC.minX(Math.max(b,0));if(SC.maxX(e)>d.width){e.x=Math.max(0,d.width-e.width)}}if(SC.maxY(e)>d.height){g=Math.max((b.y-e.height),0);if(g>d.height){e.y=Math.max(0,d.height-e.height)}else{e.y=g}}if(SC.minY(e)<0){g=Math.min(SC.maxY(b),(d.height-b.height));e.y=Math.max(g,0)}return e},fitPositionToScreenMenu:function(d,b,a){if(a){b.x-=this.get("submenuOffsetX");b.y-=Math.floor(this.get("menuHeightPadding")/2)}if((b.x+b.width)>(d.width-20)){if(a){b.x=b.x-(b.width*2)}else{b.x=d.width-b.width-20}}if(b.x<7){b.x=7}if(b.y<7){b.height+=b.y;b.y=7}if(b.height+b.y+35>=d.height){if(b.height+50>=d.height){b.y=SC.MenuPane.VERTICAL_OFFSET;b.height=d.height-(SC.MenuPane.VERTICAL_OFFSET*2)}else{b.y+=(d.height-(b.height+b.y+35))}}return b},fitPositionToScreenMenuPointer:function(d,e,b){e=this.fitPositionToScreenPointer(d,e,b);if(e.height+e.y+35>=d.height){e.height=d.height-e.y-(SC.MenuPane.VERTICAL_OFFSET*2)}return e},fitPositionToScreenPointer:function(p,n,o){var j=[this.pointerOffset[0],this.pointerOffset[1],this.pointerOffset[2],this.pointerOffset[3]];var g=[[o.x+o.width+j[0],o.y+parseInt(o.height/2,0)-40],[o.x-n.width+j[1],o.y+parseInt(o.height/2,0)-40],[o.x+parseInt((o.width/2)-(n.width/2),0),o.y-n.height+j[2]],[o.x+parseInt((o.width/2)-(n.width/2),0),o.y+o.height+j[3]]];var d=[[o.x+o.width+n.width+j[0],o.y+parseInt(o.height/2,0)+n.height-24],[o.x+j[1],o.y+parseInt(o.height/2,0)+n.height-24],[o.x+parseInt((o.width/2)-(n.width/2),0)+n.width,o.y+j[2]],[o.x+parseInt((o.width/2)-(n.width/2),0)+n.width,o.y+o.height+n.height+j[3]]];var h=[[g[0][1]>0?0:0-g[0][1],d[0][0]<p.width?0:d[0][0]-p.width,d[0][1]<p.height?0:d[0][1]-p.height,g[0][0]>0?0:0-g[0][0]],[g[1][1]>0?0:0-g[1][1],d[1][0]<p.width?0:d[1][0]-p.width,d[1][1]<p.height?0:d[1][1]-p.height,g[1][0]>0?0:0-g[1][0]],[g[2][1]>0?0:0-g[2][1],d[2][0]<p.width?0:d[2][0]-p.width,d[2][1]<p.height?0:d[2][1]-p.height,g[2][0]>0?0:0-g[2][0]],[g[3][1]>0?0:0-g[3][1],d[3][0]<p.width?0:d[3][0]-p.width,d[3][1]<p.height?0:d[3][1]-p.height,g[3][0]>0?0:0-g[3][0]]];var e=this.preferMatrix;if(e[4]===-1){n.x=o.x+parseInt(o.width/2,0);n.y=o.y+parseInt(o.height/2,0)-parseInt(n.height/2,0);this.set("pointerPos",SC.POINTER_LAYOUT[0]+" fallback");this.set("pointerPosY",parseInt(n.height/2,0)-40)}else{n.x=g[e[4]][0];n.y=g[e[4]][1];this.set("pointerPos",SC.POINTER_LAYOUT[e[4]]);this.set("pointerPosY",0)}this.set("pointerPosX",0);for(var k=0,b,l=SC.POINTER_LAYOUT.length;k<l;k++){b=e[k];if(h[b][0]===0&&h[b][1]===0&&h[b][2]===0&&h[b][3]===0){if(e[4]!==b){n.x=g[b][0];n.y=g[b][1];this.set("pointerPosY",0);this.set("pointerPos",SC.POINTER_LAYOUT[b])}k=SC.POINTER_LAYOUT.length}else{if((b===0||b===1)&&h[b][0]===0&&h[b][1]===0&&h[b][2]<n.height-91&&h[b][3]===0){if(e[4]!==b){n.x=g[b][0];this.set("pointerPos",SC.POINTER_LAYOUT[b])}n.y=g[b][1]-h[b][2];this.set("pointerPosY",h[b][2]);k=SC.POINTER_LAYOUT.length}else{if((b===0||b===1)&&h[b][0]===0&&h[b][1]===0&&h[b][2]<=n.height-51&&h[b][3]===0){if(e[4]!==b){n.x=g[b][0]}n.y=g[b][1]-(n.height-51);this.set("pointerPosY",(n.height-53));this.set("pointerPos",SC.POINTER_LAYOUT[b]+" extra-low");k=SC.POINTER_LAYOUT.length}else{if((b===2||b===3)&&h[b][0]===0&&h[b][1]<=parseInt(n.width/2,0)-this.get("extraRightOffset")&&h[b][2]===0&&h[b][3]===0){if(e[4]!==b){n.y=g[b][1]}n.x=g[b][0]-(parseInt(n.width/2,0)-this.get("extraRightOffset"));this.set("pointerPos",SC.POINTER_LAYOUT[b]+" extra-right");k=SC.POINTER_LAYOUT.length}else{if((b===2||b===3)&&h[b][0]===0&&h[b][1]===0&&h[b][2]===0&&h[b][3]<=parseInt(n.width/2,0)-this.get("extraRightOffset")){if(e[4]!==b){n.y=g[b][1]}n.x=g[b][0]+(parseInt(n.width/2,0)-this.get("extraRightOffset"));this.set("pointerPos",SC.POINTER_LAYOUT[b]+" extra-left");k=SC.POINTER_LAYOUT.length}}}}}}return n},setupPointer:function(g){var h=this.pointerOffset,f=SC.PickerPane;if(!h||h.length!==4){if(this.get("preferType")==SC.PICKER_MENU_POINTER){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:this.set("pointerOffset",f.TINY_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.TINY_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.SMALL_CONTROL_SIZE:this.set("pointerOffset",f.SMALL_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.SMALL_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.REGULAR_CONTROL_SIZE:this.set("pointerOffset",f.REGULAR_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.REGULAR_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.LARGE_CONTROL_SIZE:this.set("pointerOffset",f.LARGE_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.LARGE_PICKER_MENU_EXTRA_RIGHT_OFFSET);break;case SC.HUGE_CONTROL_SIZE:this.set("pointerOffset",f.HUGE_PICKER_MENU_POINTER_OFFSET);this.set("extraRightOffset",f.HUGE_PICKER_MENU_EXTRA_RIGHT_OFFSET);break}}else{var e=(g.width<16)?((g.width<4)?9:6):0,b=(g.height<16)?((g.height<4)?9:6):0,d=f.PICKER_POINTER_OFFSET;var j=[d[0]+e,d[1]-e,d[2]-b,d[3]+b];this.set("pointerOffset",j);this.set("extraRightOffset",f.PICKER_EXTRA_RIGHT_OFFSET)}}if(!this.preferMatrix||this.preferMatrix.length!==5){this.set("preferMatrix",this.get("preferType")===SC.PICKER_MENU_POINTER?[3,2,1,0,3]:[0,1,2,3,2])}},displayProperties:["preferType","pointerPos","pointerPosY"],renderDelegateName:"pickerRenderDelegate",modalPaneDidClick:function(a){var e=this.get("frame"),g=this.get("removeTarget")||null,d=this.get("removeAction"),b=this.get("rootResponder");if(!this.clickInside(e,a)){if(d){b.sendAction(d,g,this,this,null,this)}else{this.remove()}return YES}return NO},mouseDown:function(a){return this.modalPaneDidClick(a)},clickInside:function(b,a){return SC.pointInRect({x:a.pageX,y:a.pageY},b)},windowSizeDidChange:function(b,a){if(this.repositionOnWindowResize){this.positionPane()}},remove:function(){if(this.get("isVisibleInWindow")&&this.get("isPaneAttached")){this._withdrawOverflowRequest()}this._removeScrollObservers();return arguments.callee.base.apply(this,arguments)},anchorElement:function(a,b){var d;if(b===undefined){d=this._anchorView;return d?d.get("layer"):this._anchorHTMLElement}else{if(!b){throw"You must set 'anchorElement' to either a view or a DOM element"}else{if(b.isView){this._anchorView=b;this._anchorHTMLElement=null}else{this._anchorView=null;this._anchorHTMLElement=b}}}}.property("layer").cacheable(),_hideOverflow:function(){var b=SC.$(document.body),a=SC.$(".sc-main"),e=parseInt(a.css("minWidth"),0),f=parseInt(a.css("minHeight"),0),d=SC.RootResponder.responder.get("currentWindowSize");if(d.width>=e&&d.height>=f){SC.bodyOverflowArbitrator.requestHidden(this)}},_withdrawOverflowRequest:function(){SC.bodyOverflowArbitrator.withdrawRequest(this)},_getScrollViewOfView:function(b){var a=b;while(YES){if(!a){return null}if(a.isScrollable){return a}a=a.get("parentView")}},_setupScrollObservers:function(b){var a=this._getScrollViewOfView(b);if(a){a.addObserver("horizontalScrollOffset",this,this._scrollOffsetDidChange);a.addObserver("verticalScrollOffset",this,this._scrollOffsetDidChange);this._scrollView=a}},_removeScrollObservers:function(){var a=this._scrollView;if(a){a.removeObserver("horizontalScrollOffset",this,this._scrollOffsetDidChange);a.removeObserver("verticalScrollOffset",this,this._scrollOffsetDidChange)}},_scrollOffsetDidChange:function(){this.positionPane()}});SC.PickerPane.PICKER_POINTER_OFFSET=[9,-9,-18,18];SC.PickerPane.PICKER_EXTRA_RIGHT_OFFSET=20;SC.PickerPane.TINY_PICKER_MENU_POINTER_OFFSET=[9,-9,-18,18];SC.PickerPane.TINY_PICKER_MENU_EXTRA_RIGHT_OFFSET=12;SC.PickerPane.SMALL_PICKER_MENU_POINTER_OFFSET=[9,-9,-8,8];SC.PickerPane.SMALL_PICKER_MENU_EXTRA_RIGHT_OFFSET=11;SC.PickerPane.REGULAR_PICKER_MENU_POINTER_OFFSET=[9,-9,-12,12];SC.PickerPane.REGULAR_PICKER_MENU_EXTRA_RIGHT_OFFSET=12;SC.PickerPane.LARGE_PICKER_MENU_POINTER_OFFSET=[9,-9,-16,16];SC.PickerPane.LARGE_PICKER_MENU_EXTRA_RIGHT_OFFSET=17;SC.PickerPane.HUGE_PICKER_MENU_POINTER_OFFSET=[9,-9,-18,18];SC.PickerPane.HUGE_PICKER_MENU_EXTRA_RIGHT_OFFSET=12;SC.SeparatorView=SC.View.extend({classNames:["sc-separator-view"],tagName:"span",layoutDirection:SC.LAYOUT_HORIZONTAL,render:function(a,b){if(b){a.push("<span></span>")}a.addClass(this.get("layoutDirection"))}});sc_require("views/button");sc_require("views/separator");SC.MenuItemView=SC.View.extend(SC.ContentDisplay,{classNames:["sc-menu-item"],displayProperties:["title","isEnabled","isSeparator","isChecked"],ariaRole:"menuitem",escapeHTML:YES,acceptsFirstResponder:YES,blocksIEDeactivate:YES,isContextMenuEnabled:NO,content:null,isSeparator:function(){return this.getContentProperty("itemSeparatorKey")===YES}.property("content").cacheable(),isEnabled:function(){return this.getContentProperty("itemIsEnabledKey")!==NO&&this.getContentProperty("itemSeparatorKey")!==YES}.property("content.isEnabled").cacheable(),isChecked:function(){return this.getContentProperty("itemCheckboxKey")}.property(),subMenu:function(){var d=this.get("content"),b,a;if(!d){return null}a=this.get("parentMenu");b=d.get(a.itemSubMenuKey);if(b){if(SC.kindOf(b,SC.MenuPane)){b.set("isModal",NO);b.set("isSubMenu",YES);b.set("parentMenu",a);return b}else{return SC.MenuPane.create({layout:{width:200},items:b,isModal:NO,isSubMenu:YES,parentMenu:a,controlSize:a.get("controlSize"),exampleView:a.get("exampleView")})}}return null}.property("content").cacheable(),hasSubMenu:function(){return !!this.get("subMenu")}.property("subMenu").cacheable(),init:function(){arguments.callee.base.apply(this,arguments);this.contentDidChange()},render:function(b,j){var d=this.get("content"),a,g,f=this.get("parentMenu"),e=this.get("itemWidth")||f.layout.width,h=this.get("itemHeight")||SC.DEFAULT_MENU_ITEM_HEIGHT;this.set("itemWidth",e);this.set("itemHeight",h);if(this.get("isSeparator")){b.attr("role","separator")}else{if(this.get("isChecked")){b.attr("role","menuitemcheckbox");b.attr("aria-checked",true)}}b=b.begin("a").addClass("menu-item");if(this.get("isSeparator")){b.push('<span class="separator"></span>');b.addClass("disabled")}else{g=d.get(f.itemIconKey);if(g){this.renderImage(b,g);b.addClass("has-icon")}g=this.get("title");if(SC.typeOf(g)!==SC.T_STRING){g=g.toString()}this.renderLabel(b,g);if(this.get("isChecked")){b.push('<div class="checkbox"></div>')}if(this.get("hasSubMenu")){this.renderBranch(b)}g=this.getContentProperty("itemShortCutKey");if(g){this.renderShortcut(b,g)}}b=b.end()},renderImage:function(b,e){var a,d;if(e&&SC.ImageView.valueIsUrl(e)){a=e;d=""}else{d=e;a=SC.BLANK_IMAGE_URL}b.begin("img").addClass("image").addClass(d).attr("src",a).end()},renderLabel:function(b,a){if(this.get("escapeHTML")){a=SC.RenderContext.escapeHTML(a)}b.push("<span class='value ellipsis'>"+a+"</span>")},renderBranch:function(a){a.push('<span class="has-branch"></span>')},renderShortcut:function(b,a){b.push('<span class = "shortcut">'+a+"</span>")},showSubMenu:function(){var a=this.get("subMenu");if(a){a.set("mouseHasEntered",NO);a.popup(this,[0,0,0])}this._subMenuTimer=null},title:function(){var b=this.getContentProperty("itemTitleKey"),a=this.getPath("parentMenu.localize");if(a&&b){b=SC.String.loc(b)}return b||""}.property("content.title").cacheable(),getContentProperty:function(b){var a=this.get("content"),d=this.get("parentMenu");if(a){return a.get(d.get(b))}},mouseUp:function(b){var a;a=this.getPath("parentMenu.rootMenu.targetMenuItem");if(a){a.performAction()}return YES},performAction:function(){if(!this.get("isEnabled")){this.getPath("parentMenu.rootMenu").remove();return YES}if(this.get("hasSubMenu")){return NO}var b=this.getContentProperty("itemDisableMenuFlashKey"),a;if(b){this.sendAction()}else{this._flashCounter=0;a=this.getPath("parentMenu.rootMenu");a._isFlashing=YES;this.invokeLater(this.flashHighlight,25);this.invokeLater(this.sendAction,150)}return YES},sendAction:function(){var d=this.getContentProperty("itemActionKey"),e=this.getContentProperty("itemTargetKey"),b=this.getPath("parentMenu.rootMenu"),a;this.getPath("parentMenu.rootMenu").remove();b._isFlashing=NO;d=(d===undefined)?b.get("action"):d;e=(e===undefined)?b.get("target"):e;b.set("selectedItem",this.get("content"));if(SC.typeOf(d)===SC.T_FUNCTION){d.apply(e,[b])}else{a=this.getPath("pane.rootResponder")||SC.RootResponder.responder;if(a){a.sendAction(d,e,b)}}},flashHighlight:function(){var a=this._flashCounter,b=this.$();if(a%2===0){b.addClass("focus")}else{b.removeClass("focus")}if(a<=2){this.invokeLater(this.flashHighlight,50);this._flashCounter++}},mouseDown:function(a){return YES},mouseEntered:function(a){var d=this.get("parentMenu"),b=d.get("rootMenu");if(b._isFlashing){return}d.set("mouseHasEntered",YES);this.set("mouseHasEntered",YES);d.set("currentMenuItem",this);if(this.get("isEnabled")){this.becomeFirstResponder()}if(this.get("hasSubMenu")){this._subMenuTimer=this.invokeLater(this.showSubMenu,100)}return YES},mouseExited:function(a){var b,d;if(this.get("hasSubMenu")){d=this._subMenuTimer;if(d){d.invalidate()}else{this.invokeLater(this.checkMouseLocation,100)}}else{b=this.get("parentMenu");if(b.get("currentMenuItem")===this){b.set("currentMenuItem",null)}}return YES},touchStart:function(a){this.mouseEntered(a);return YES},touchEnd:function(a){return this.mouseUp(a)},touchEntered:function(a){return this.mouseEntered(a)},touchExited:function(a){return this.mouseExited(a)},checkMouseLocation:function(){var b=this.get("subMenu"),d=this.get("parentMenu"),a,e;if(!b.get("mouseHasEntered")){a=d.get("currentMenuItem");if(a===this||a===null){e=d.get("previousMenuItem");if(e){e.resignFirstResponder()}this.resignFirstResponder();b.remove()}}},moveUp:function(b,a){var d=this.get("parentMenu");if(d){d.moveUp(this)}return YES},moveDown:function(b,a){var d=this.get("parentMenu");if(d){d.moveDown(this)}return YES},moveRight:function(b,a){this.showSubMenu();return YES},insertText:function(b,a){var d=this.get("parentMenu");if(d){d.insertText(b,a)}},keyDown:function(a){return this.interpretKeyEvents(a)},keyUp:function(a){return YES},cancel:function(a){this.getPath("parentMenu.rootMenu").remove();return YES},didBecomeFirstResponder:function(a){if(a!==this){return}var b=this.get("parentMenu");if(b){b.set("currentSelectedMenuItem",this)}},willLoseFirstResponder:function(a){if(a!==this){return}var b=this.get("parentMenu");if(b){b.set("currentSelectedMenuItem",null);b.set("previousSelectedMenuItem",this)}},insertNewline:function(b,a){this.mouseUp(a)},closeParent:function(){this.$().removeClass("focus");var a=this.get("parentMenu");if(a){a.remove()}},clickInside:function(b,a){return SC.pointInRect({x:a.pageX,y:a.pageY},b)},contentDidChange:function(){var b=this.get("content"),a=this._content;if(b===a){return}var d=this.contentPropertyDidChange;if(a&&a.removeObserver){a.removeObserver("*",this,d)}this._content=b;if(b&&b.addObserver){b.addObserver("*",this,d)}this.contentPropertyDidChange(b,"*")}.observes("content"),contentPropertyDidChange:function(h,k){var b=this.get("parentMenu");if(!b){return}var a=SC.MenuItemView._contentPropertyToMenuItemPropertyMapping,j=SC.keys(a),f,g,e,d;if(k==="*"){for(f=0,g=j.length;f<g;++f){e=j[f];d=a[e];this.notifyPropertyChange(d)}}else{for(f=0,g=j.length;f<g;++f){e=j[f];if(b.get(e)===k){d=a[e];this.notifyPropertyChange(d)}}}}});SC.MenuItemView._contentPropertyToMenuItemPropertyMapping={itemTitleKey:"title",itemIsEnabledKey:"isEnabled",itemSeparatorKey:"isSeparator",itemSubMenuKey:"subMenu"};sc_require("panes/picker");sc_require("views/menu_item");SC.MenuPane=SC.PickerPane.extend({classNames:["sc-menu"],ariaRole:"menu",items:[],controlSize:SC.REGULAR_CONTROL_SIZE,itemHeight:SC.propertyFromRenderDelegate("itemHeight",20),itemSeparatorHeight:SC.propertyFromRenderDelegate("itemSeparatorHeight",9),menuHeight:0,menuHeightPadding:SC.propertyFromRenderDelegate("menuHeightPadding",6),submenuOffsetX:SC.propertyFromRenderDelegate("submenuOffsetX",2),selectedItem:null,exampleView:SC.MenuItemView,anchor:null,isSubMenu:NO,localize:YES,acceptsMenuPane:YES,isContextMenuEnabled:NO,popup:function(b,d){var a;this.beginPropertyChanges();if(b){if(b.isView){this._anchorView=b;this._setupScrollObservers(b)}else{this._anchorHTMLElement=b}}if(d){this.set("preferMatrix",d)}this.adjust("height",this.get("menuHeight"));this.positionPane();this.set("defaultResponder",this);this.endPropertyChanges();this._hideOverflow();this.append()},remove:function(){var a=this.get("parentMenu");this.set("currentMenuItem",null);this.closeOpenMenus();this.resignMenuPane();if(a){a.becomeMenuPane()}return arguments.callee.base.apply(this,arguments)},itemTitleKey:"title",itemIsEnabledKey:"isEnabled",itemValueKey:"value",itemIconKey:"icon",itemHeightKey:"height",itemSubMenuKey:"subMenu",itemSeparatorKey:"isSeparator",itemTargetKey:"target",itemActionKey:"action",itemCheckboxKey:"checkbox",itemShortCutKey:"shortcut",itemKeyEquivalentKey:"keyEquivalent",itemDisableMenuFlashKey:"disableMenuFlash",itemLayerIdKey:"layerId",itemExampleViewKey:"exampleView",menuItemKeys:["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemSeparatorKey","itemActionKey","itemCheckboxKey","itemShortCutKey","itemHeightKey","itemSubMenuKey","itemKeyEquivalentKey","itemTargetKey","itemLayerIdKey"],preferType:SC.PICKER_MENU,isModal:YES,_menuView:null,init:function(){return arguments.callee.base.apply(this,arguments)},displayProperties:["controlSize"],renderDelegateName:"menuRenderDelegate",createChildViews:function(){var b,a,d;b=this._menuScrollView=this.createChildView(SC.MenuScrollView,{borderStyle:SC.BORDER_NONE,controlSize:this.get("controlSize")});a=this._menuView=SC.View.create({parentViewDidResize:function(){this.notifyPropertyChange("frame")},viewDidResize:function(){}});d=this.get("menuItemViews");a.set("layout",{top:0,left:0,height:this.get("menuHeight")});a.replaceAllChildren(d);b.set("contentView",a);this.childViews=[b];return this},paneDidAttach:function(){var a=(this.rootResponder=SC.RootResponder.responder);a.panes.add(this);this.set("currentWindowSize",a.computeWindowSize());this.set("isPaneAttached",YES);this.parentViewDidChange();this._notifyDidAppendToDocument();this.becomeMenuPane();return this},becomeMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(this)}return this},resignMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(null)}return this},menuItemViews:function(){return this.createMenuItemViews()}.property("displayItems").cacheable(),createMenuItemViews:function(){var k=[],t=this.get("displayItems"),a=this.get("exampleView"),w,e,n,m,f,s,p,h,b,l,u,d,g,o,j,q,y,x,v;if(!t){return k}p=this.get("itemHeightKey");h=this.get("itemSeparatorKey");m=this.get("itemExampleViewKey");b=this.get("itemHeight");g=this.get("itemKeyEquivalentKey");l=this.get("itemSeparatorHeight");y=this.get("itemLayerIdKey");d=Math.floor(this.get("menuHeightPadding")/2);u=d;j=this.menuItemKeys.map(SC._menu_fetchKeys,this);v=t.get("length");for(q=0;q<v;q++){w=t[q];s=w.get(p);if(!s){s=w.get(h)?l:b}x={layout:{height:s,top:u},contentDisplayProperties:j,content:w,parentMenu:this};if(w.get(y)){x.layerId=w.get(y)}f=w.get(m);if(f){e=f}else{e=a}n=this._menuView.createChildView(e,x);k[q]=n;u+=s;o=w.get(g);if(o){if(SC.typeOf(o)===SC.T_ARRAY){o.forEach(function(z){this._keyEquivalents[z]=n},this)}else{this._keyEquivalents[o]=n}}}this.set("menuHeight",u+d);return k},menuItemViewForContentIndex:function(a){var b=this.get("menuItemViews");if(!b){return undefined}return b.objectAt(a)},_keyEquivalents:{},rootMenu:function(){if(this.get("isSubMenu")){return this.getPath("parentMenu.rootMenu")}return this}.property("isSubMenu").cacheable(),windowSizeDidChange:function(b,a){this.remove();return arguments.callee.base.apply(this,arguments)},displayItems:function(){var e=this.get("items"),d=this.get("localize"),j=this.get("itemHeight"),b,f=[],a,g,h;if(!e){return null}b=e.get("length");for(a=0;a<b;a++){g=e.objectAt(a);if(!g){continue}h=SC.typeOf(g);if(h===SC.T_STRING){g=SC.Object.create({title:g,value:g,isEnabled:YES})}else{if(h===SC.T_HASH){g=SC.Object.create(g)}else{if(h===SC.T_ARRAY){g=this.convertArrayMenuItemToObject(g)}}}g.contentIndex=a;f.push(g)}return f}.property("items").cacheable(),_sc_menu_itemsDidChange:function(){var a=this.get("menuItemViews");this._menuView.replaceAllChildren(a);this._menuView.adjust("height",this.get("menuHeight"))}.observes("items"),convertArrayMenuItemToObject:function(g){SC.Logger.warn("Support for Array-based menu items has been deprecated.  Please update your menus to use a hash.");var f,d=SC._menu_fetchKeys,b=SC._menu_fetchItem,j,e=SC.Object.create(),a,h;f=this.menuItemKeys.map(d,this);e[f[0]]=g[0];e[f[1]]=g[1];e[f[2]]=g[2];e[f[3]]=g[3];e[f[4]]=g[4];e[f[5]]=g[5];e[f[6]]=g[6];e[f[7]]=g[7];e[f[8]]=g[8];e[f[9]]=g[9];e[f[10]]=g[10];e[f[11]]=g[11];e[f[12]]=g[12];return e},currentMenuItem:function(a,b){if(b!==undefined){if(this._currentMenuItem!==null){this.set("previousMenuItem",this._currentMenuItem)}this._currentMenuItem=b;this.setPath("rootMenu.targetMenuItem",b);return b}return this._currentMenuItem}.property().cacheable(),_sc_menu_currentMenuItemDidChange:function(){var a=this.get("currentMenuItem"),b=this.get("previousMenuItem");if(b){if(b.get("hasSubMenu")&&a===null){}else{b.resignFirstResponder();this.closeOpenMenusFor(b)}}if(a&&a.get("isEnabled")){a.scrollToVisible()}}.observes("currentMenuItem"),closeOpenMenusFor:function(a){if(!a){return}var b=a.get("parentMenu");while(b&&a){b=a.get("subMenu");if(b){b.remove();a.resignFirstResponder();a=b.get("previousMenuItem")}}},closeOpenMenus:function(){this.closeOpenMenusFor(this.get("previousMenuItem"))},mouseDown:function(a){this.modalPaneDidClick(a);return YES},mouseEntered:function(a){this.set("mouseHasEntered",YES)},keyUp:function(a){var b=this.interpretKeyEvents(a);return !b?NO:b},moveUp:function(){var d=this.get("currentMenuItem"),e=this.get("menuItemViews"),b,f,a;if(!d){a=e.get("length")-1}else{b=d.getPath("content.contentIndex");if(b===0){return YES}a=b-1}while(a>=0){if(e[a].get("isEnabled")){this.set("currentMenuItem",e[a]);e[a].becomeFirstResponder();break}a--}return YES},moveDown:function(){var e=this.get("currentMenuItem"),f=this.get("menuItemViews"),b=f.get("length"),d,g,a;if(!e){a=0}else{d=e.getPath("content.contentIndex");if(d===b){return YES}a=d+1}while(a<b){if(f[a].get("isEnabled")){this.set("currentMenuItem",f[a]);f[a].becomeFirstResponder();break}a++}return YES},moveToBeginningOfDocument:function(){var d=this.get("menuItemViews"),b=d.get("length"),a=0;while(a<b){if(d[a].get("isEnabled")){this.set("currentMenuItem",d[a]);d[a].becomeFirstResponder();break}++a}return YES},moveToEndOfDocument:function(){var d=this.get("menuItemViews"),b=d.get("length"),a=b-1;while(a>=0){if(d[a].get("isEnabled")){this.set("currentMenuItem",d[a]);d[a].becomeFirstResponder();break}--a}return YES},pageDown:function(){var d=this.get("currentMenuItem"),j,f=this.get("menuItemViews"),b=f.get("length"),a=0,h,e=0,g;if(this._menuScrollView&&this._menuScrollView.verticalScrollerView2){if(d){a=d.getPath("content.contentIndex")}h=a;g=this._menuScrollView.get("verticalPageScroll");for(a;a<b;a++){j=f[a];e+=j.get("layout").height;if(e>g){break}else{if(j.get("isEnabled")){h=a}}}j=f[h];this.set("currentMenuItem",j);j.becomeFirstResponder()}else{this.moveToEndOfDocument()}return YES},pageUp:function(){var d=this.get("currentMenuItem"),j,f=this.get("menuItemViews"),b=f.get("length"),a=b-1,h,e=0,g;if(this._menuScrollView&&this._menuScrollView.verticalScrollerView){if(d){a=d.getPath("content.contentIndex")}h=a;g=this._menuScrollView.get("verticalPageScroll");for(a;a>=0;a--){j=f[a];e+=j.get("layout").height;if(e>g){break}else{if(j.get("isEnabled")){h=a}}}j=f[h];this.set("currentMenuItem",j);j.becomeFirstResponder()}else{this.moveToBeginningOfDocument()}return YES},insertText:function(b,a){var e=this._timer,d=this._keyBuffer;if(e){e.invalidate()}e=this._timer=SC.Timer.schedule({target:this,action:"clearKeyBuffer",interval:500,isPooled:NO});d=d||"";d+=b.toUpperCase();this.selectMenuItemForString(d);this._keyBuffer=d;return YES},performKeyEquivalent:function(e,a,b){if(!b&&!this.get("isVisibleInWindow")){return NO}var d=this._keyEquivalents[e];if(d){d.performAction(YES);return YES}if(e==="escape"||e==="return"){this.remove();return YES}return NO},selectMenuItemForString:function(d){var e=this.get("menuItemViews"),g,h,b,a,f;if(!e){return}f=d.length;a=e.get("length");for(b=0;b<a;b++){g=e.objectAt(b);h=g.get("title");if(!h){continue}h=h.replace(/ /g,"").substr(0,f).toUpperCase();if(h===d){this.set("currentMenuItem",g);g.becomeFirstResponder();break}}},clearKeyBuffer:function(){this._keyBuffer=""},modalPaneDidClick:function(a){this.remove();return YES}});SC._menu_fetchKeys=function(a){return this.get(a)};SC._menu_fetchItem=function(a){if(!a){return null}return this.get?this.get(a):this[a]};SC.MenuPane.VERTICAL_OFFSET=23;sc_require("panes/panel");SC.SheetPane=SC.PanelPane.extend({classNames:["sc-sheet"],modalPane:SC.ModalPane,transitionDuration:200,_state:"NO_VIEW",init:function(){arguments.callee.base.apply(this,arguments);if(SC.Animatable){SC.SheetPane.ANIMATABLE_AVAILABLE=YES;this.mixin(SC.Animatable);if(!this.transitions){this.transitions={}}if(!this.transitions.top){this.transitions.top={duration:this.transitionDuration===200?0.3:this.transitionDuration/1000,action:"_complete",target:this}}}},append:function(){var a=this.get("layout");if(!a.height||!a.top){a=SC.View.convertLayoutToAnchoredLayout(a,this.computeParentDimensions())}a.top=-1*a.height;if(this.disableAnimation){this.disableAnimation()}this.adjust(a);this.updateLayout();if(this.enableAnimation){this.enableAnimation()}return arguments.callee.base.apply(this,arguments)},remove:function(){var b=this,a=arguments;this.invokeLater(function(){a.callee.base.apply(b,a)},this.transitionDuration);this.slideUp();return this},paneDidAttach:function(){var a=arguments.callee.base.apply(this,arguments);this.slideDown();return a},slideDown:function(){this._state=SC.SheetPane.ANIMATING;this._direction=SC.SheetPane.SLIDE_DOWN;if(SC.SheetPane.ANIMATABLE_AVAILABLE){this.transitions.top.timing=SC.Animatable.TRANSITION_EASE_OUT;this.adjust("top",0)}else{this._start=Date.now();this._end=this._start+this.get("transitionDuration");this.tick()}},slideUp:function(){this._state=SC.SheetPane.ANIMATING;this._direction=SC.SheetPane.SLIDE_UP;if(SC.SheetPane.ANIMATABLE_AVAILABLE){var a=this.get("layout");this.transitions.top.timing=SC.Animatable.TRANSITION_EASE_IN;this.adjust("top",-1*a.height)}else{this._start=Date.now();this._end=this._start+this.get("transitionDuration");this.tick()}},_complete:function(){var a=this._direction;if(a===SC.SheetPane.SLIDE_DOWN){if(!SC.SheetPane.ANIMATABLE_AVAILABLE){this.adjust("top",0)}this.adjust({centerX:0,left:null});if(SC.browser.isMozilla){this.parentViewDidChange()}}else{var b=this.get("layout");if(!SC.SheetPane.ANIMATABLE_AVAILABLE){this.adjust("top",-1*b.height)}}this._state=SC.SheetPane.READY;this.updateLayout()},blurTo:function(a){this.setFirstResponder("")},tick:function(){this._timer=null;var b=Date.now();var f=(b-this._start)/(this._end-this._start),h=this,a=this._direction,d=this.get("layout"),e,g;if(f<0){f=0}if(f>=1){this._complete();return this}g=Math.floor(d.height*f);if(a==SC.SheetPane.SLIDE_DOWN){h.adjust("top",0-(d.height-g))}else{if(a==SC.SheetPane.SLIDE_UP){h.adjust("top",0-g)}}this._timer=this.invokeLater(this.tick,20);h.updateLayout();return this}});SC.SheetPane.mixin({ANIMATABLE_AVAILABLE:NO,NO_VIEW:"NO_VIEW",ANIMATING:"ANIMATING",READY:"READY",SLIDE_DOWN:"SLIDEDOWN",SLIDE_UP:"SLIDEUP"});SC.BaseTheme.buttonRenderDelegate=SC.RenderDelegate.create({className:"button","sc-small-size":{height:18,autoResizePadding:{width:15,height:0}},"sc-regular-size":{height:24,autoResizePadding:{width:20,height:0}},"sc-huge-size":{height:30,autoResizePadding:{width:30,height:0}},"sc-jumbo-size":{height:44,autoResizePadding:{width:50,height:0}},render:function(a,g){this.addSizeClassName(a,g);var f,b=a.get("toolTip"),h=a.get("isSelected")||NO,l=a.get("isActive")||NO,j=a.get("isDefault")||NO,k=a.get("isCancel")||NO,e=(a.get("buttonBehavior")===SC.TOGGLE_BEHAVIOR),d=SC.guidFor(a)+"-label";g.setClass({icon:!!a.get("icon"),def:j,cancel:k&&!j,active:l,sel:h});if(b){g.attr("title",b);g.attr("alt",b)}this.includeSlices(a,g,SC.THREE_SLICE);if(a.get("isSegment")){g.attr("aria-selected",h.toString())}else{if(e){g.attr("aria-pressed",l.toString())}}g.attr("aria-labelledby",d);g=g.begin("label").addClass("sc-button-label").id(d);a.get("theme").labelRenderDelegate.render(a,g);g=g.end();if(a.get("supportFocusRing")){g=g.begin("div").addClass("focus-ring");this.includeSlices(a,g,SC.THREE_SLICE);g=g.end()}},update:function(f,a){var e=(f.get("buttonBehavior")===SC.TOGGLE_BEHAVIOR);this.updateSizeClassName(f,a);if(f.get("isActive")){a.addClass("active")}var d=f.get("isDefault"),b=f.get("isCancel");if(f.get("isSegment")){a.attr("aria-selected",f.get("isSelected").toString())}else{if(e){a.attr("aria-pressed",f.get("isActive").toString())}}a.attr("title",f.get("toolTip"));a.setClass("icon",!!f.get("icon"));a.setClass("def",!!d);a.setClass("cancel",!!b&&!d);f.get("theme").labelRenderDelegate.update(f,a.find("label"))},getRenderedAutoResizeLayer:function(a,b){return b.find(".sc-button-label")[0]}});SC.BaseTheme.checkboxRenderDelegate=SC.RenderDelegate.create({className:"checkbox",render:function(a,d){this.addSizeClassName(a,d);var f=a.get("theme"),g,b;b=SC.guidFor(a)+"-label";var e=a.get("isSelected")||NO;var k=a.get("isActive");var j=!a.get("isEnabled");var h;if(e===SC.MIXED_STATE){h="mixed"}else{if(e){h="true"}else{h="false"}}d.attr("role","checkbox");d.attr("aria-checked",h);d.attr("aria-labelledby",b);d.setClass({sel:e,active:k,disabled:j});d.push('<span class = "button"></span>');d=d.begin("span").addClass("label").id(b);f.labelRenderDelegate.render(a,d);d=d.end()},update:function(h,d){this.updateSizeClassName(h,d);var g=h.get("theme");var e=h.get("isSelected");var f=h.get("isActive");var b=!h.get("isEnabled");var a;if(e===SC.MIXED_STATE){a="mixed"}else{if(e){a="true"}else{a="false"}}d.attr("aria-checked",a);g.labelRenderDelegate.update(h,d.find("span.label"));d.setClass({sel:e,active:f,disabled:b})}});SC.BaseTheme.collectionRenderDelegate=SC.RenderDelegate.create({className:"collection",render:function(b,a){a.setClass("focus",b.get("hasFirstResponder"));a.setClass("disabled",!b.get("isEnabled"));a.setClass("active",b.get("isActive"))},update:function(b,a){a.setClass("focus",b.get("hasFirstResponder"));a.setClass("disabled",!b.get("isEnabled"));a.setClass("active",b.get("isActive"))}});SC.BaseTheme.disclosureRenderDelegate=SC.RenderDelegate.create({className:"disclosure",render:function(h,a){this.addSizeClassName(h,a);var g=h.get("theme"),e=h.get("value"),b=["sc-button-label","sc-disclosure-label"];var f=SC.guidFor(h)+"-label";a.attr("aria-expanded",e);a.attr("aria-labelledby",f);if(h.get("isSelected")){a.addClass("sel")}var d="";d+=h.get("isSelected")?"open":"closed";if(h.get("isActive")){d+=" active"}a.push('<img src = "'+SC.BLANK_IMAGE_URL+'" class = "disclosure button '+d+'" />');a=a.begin("span").addClass(b).id(f);g.labelRenderDelegate.render(h,a);a=a.end()},update:function(e,a){this.updateSizeClassName(e,a);var d=e.get("theme"),b=e.get("value");a.attr("aria-expanded",b);if(e.get("isSelected")){a.addClass("sel")}a.find("img").setClass({open:e.get("isSelected"),closed:!e.get("isSelected"),active:e.get("isActive")});d.labelRenderDelegate.update(e,a.find("span.sc-disclosure-label"))}});SC.THREE_SLICE=["left","middle","right"];SC.NINE_SLICE=["top-left","top","top-right","left","middle","right","bottom-left","bottom","bottom-right"];SC.RenderDelegate.reopen({includeSlices:function(f,d,e){for(var b=0,a=e.length;b<a;b++){d.push('<div class="'+e[b]+'"></div>')}}});SC.BaseTheme.imageButtonRenderDelegate=SC.RenderDelegate.create({className:"image-button",render:function(e,b){var d=e.get("image"),a=e.get("toolTip");this.addSizeClassName(e,b);b.addClass("no-min-width");if(a){b.attr("title",a);b.attr("alt",a)}if(d){b.push("<div class='img "+d+"'></div>")}else{b.push("<div class='img'></div>")}},update:function(e,b){var d,a;this.updateSizeClassName(e,b);if(e.didChangeFor("imageButtonRenderDelegate","toolTip")){a=e.get("toolTip");b.attr("title",a);b.attr("alt",a)}d=e.get("image");if(d&&e.didChangeFor("imageButtonRenderDelegate","image")){b.children()[0].className="img "+d}}});SC.BaseTheme.MASTER_DETAIL_DIVIDER_WIDTH=1;SC.BaseTheme.masterDetailRenderDelegate=SC.RenderDelegate.create({className:"master-detail",dividerWidth:1,render:function(b,a){a.setClass("round-toolbars",SC.platform.touch)},update:function(b,a){a.setClass("round-toolbars",SC.platform.touch)}});SC.BaseTheme.panelRenderDelegate=SC.RenderDelegate.create({className:"panel",render:function(f,b){b=b.begin("div").addClass("panel-background");this.includeSlices(f,b,SC.NINE_SLICE);b=b.end();var a=f.get("ariaLabel"),d=f.get("ariaLabelledBy"),e=f.get("ariaDescribedBy");if(a){b.attr("aria-label",a)}if(d){b.attr("aria-labelledby",d)}if(e){b.attr("aria-describedby",e)}},update:function(f,d){var a=f.get("ariaLabel"),b=f.get("ariaLabelledBy"),e=f.get("ariaDescribedBy");if(a){d.attr("aria-label",a)}if(b){d.attr("aria-labelledby",b)}if(e){d.attr("aria-describedby",e)}}});sc_require("render_delegates/panel");SC.BaseTheme.pickerRenderDelegate=SC.RenderDelegate.create({className:"picker",render:function(g,d){var a=g.get("theme").panelRenderDelegate;a.render(g,d);var b=g.get("preferType");var f=g.get("pointerPos");var e=g.get("pointerPosY");if(b==SC.PICKER_POINTER||b==SC.PICKER_MENU_POINTER){d.push('<div class="sc-pointer '+f+'" style="margin-top: '+e+'px"></div>');d.addClass(f)}},update:function(h,g){var a=h.get("theme").panelRenderDelegate;a.update(h,g);var b=h.get("preferType");var f=h.get("pointerPos");var e=h.get("pointerPosY");if(b==SC.PICKER_POINTER||b==SC.PICKER_MENU_POINTER){var d=g.find(".sc-pointer");d.attr("class","sc-pointer "+f);d.attr("style","margin-top: "+e+"px");g.addClass(f)}}});sc_require("render_delegates/picker");SC.BaseTheme.menuRenderDelegate=SC.BaseTheme.pickerRenderDelegate.create({className:"menu",render:function(d,b,a){this.addSizeClassName(b,a);d(b,a)}.enhance(),update:function(d,b,a){this.updateSizeClassName(b,a);d(b,a)}.enhance(),itemHeight:20,itemSeparatorHeight:9,menuHeightPadding:6,menuWidthPadding:50,minimumMenuWidth:50,submenuOffsetX:2,verticalOffset:23,"sc-tiny-size":{itemHeight:10,itemSeparatorHeight:2,menuHeightPadding:2,submenuOffsetX:0},"sc-small-size":{itemHeight:16,itemSeparatorHeight:7,menuHeightPadding:4,submenuOffsetX:2},"sc-large-size":{itemHeight:60,itemSeparatorHeight:20,menuHeightPadding:0,submenuOffsetX:4},"sc-huge-size":{itemHeight:20,itemSeparatorHeight:9,menuHeightPadding:0,submenuOffsetX:0}});SC.BaseTheme.popupButtonRenderDelegate=SC.BaseTheme.buttonRenderDelegate.create({render:function(b,a){a.attr("aria-haspopup","true");arguments.callee.base.apply(this,arguments)},update:function(b,a){arguments.callee.base.apply(this,arguments)}});SC.BaseTheme.PROGRESS_OFFSET=0.5;SC.BaseTheme.PROGRESS_OFFSET_RANGE=42;SC.BaseTheme.progressRenderDelegate=SC.RenderDelegate.create({className:"progress",render:function(j,d){this.addSizeClassName(j,d);var a=j.get("isIndeterminate"),h=j.get("theme"),b=j.get("maximum"),f=j.get("minimum"),e=j.get("ariaValue");var g;if(a){g=1}else{g=j.get("value")}d.attr("aria-valuemax",b);d.attr("aria-valuemin",f);d.attr("aria-valuenow",e);d.attr("aria-valuetext",e);d.setClass({indeterminate:a,running:j.get("isRunning")&&a,disabled:!j.get("isEnabled"),"sc-empty":(g<=0),"sc-complete":(g>=1&&!a)});d=d.begin("div").addClass("track");this.includeSlices(j,d,SC.THREE_SLICE);d=d.end();d=d.begin("div").addClass("content");d.css("width",(g*100)+"%");this.includeSlices(j,d,SC.THREE_SLICE);d=d.end()},update:function(a,b){this.updateSizeClassName(a,b);var f=a.get("theme"),k,l=a.get("maximum"),g=a.get("minimum"),d=a.get("ariaValue"),e=a.get("isIndeterminate"),m=a.get("isRunning"),j=a.get("isEnabled"),h=a.get("isVisibleInWindow");b.attr("aria-valuemax",l);b.attr("aria-valuemin",g);b.attr("aria-valuenow",d);b.attr("aria-valuetext",d);if(e){k=1}else{k=a.get("value")}b.setClass({indeterminate:e,running:m&&e,disabled:!j,"sc-empty":(k<=0),"sc-complete":(k>=1&&!e)});b.find(".content").css("width",(k*100)+"%");if(!SC.platform.supportsCSSTransitions){if(!this._queue[b[0].id]){this._queue[b[0].id]={offset:0,element:SC.$(b).find(".content .middle"),shouldAnimate:false}}if(e&&m&&h){this._queue[b[0].id].shouldAnimate=true;this.animate(a)}else{if(!e){this._queue[b[0].id].element.css("background-position","")}else{this._queue[b[0].id].shouldAnimate=false}}}},_queue:{},_animating:false,animate:function(b){var a=this;if(this._animating){return}function d(){var j,f,g,e=a._queue,l=0,h;var k;for(k in e){if(e.hasOwnProperty(k)){h=e[k];if(h.shouldAnimate){a._animating=true;l++;f=h.offset||0;j=(f+SC.BaseTheme.PROGRESS_OFFSET)%SC.BaseTheme.PROGRESS_OFFSET_RANGE;g=Math.round(j);if(g>Math.round(f)){h.element.css("background-position",g+"px 0px")}h.offset=j}}}if(l===0){a._animating=false}else{window.requestAnimationFrame(d)}}d()}});SC.BaseTheme.radioRenderDelegate=SC.RenderDelegate.create({className:"radio",render:function(g,b){if(g){this.addSizeClassName(g,b);var f=g.get("theme");var a=g.get("isSelected"),d=g.get("width"),e=SC.guidFor(g)+"-label";b.setClass({active:g.get("isActive"),mixed:g.get("isMixed"),sel:g.get("isSelected"),disabled:!g.get("isEnabled")});b.attr("role","radio");b.attr("aria-checked",a);b.attr("aria-labelledby",e);b.attr("aria-disabled",g.get("isEnabled")?"false":"true");if(d){b.css("width",d)}b.push('<span class = "button"></span>');b=b.begin("span").addClass("sc-button-label").id(e);f.labelRenderDelegate.render(g,b);b=b.end()}else{b.begin("span").removeClass("sc-button-label")}},update:function(g,a){this.updateSizeClassName(g,a);var f=g.get("theme");var b=g.get("isSelected"),d=g.get("width"),e=g.get("value");a.setClass({active:g.get("isActive"),mixed:g.get("isMixed"),sel:g.get("isSelected"),disabled:!g.get("isEnabled")});a.attr("aria-disabled",g.get("isEnabled")?"false":"true");a.attr("aria-checked",b);a.css("width",d?d:null);f.labelRenderDelegate.update(g,a.find(".sc-button-label"))}});SC.BaseTheme.radioGroupRenderDelegate=SC.RenderDelegate.create({className:"radio-group",render:function(j,f){this.addSizeClassName(j,f);var h=j.get("theme"),e=SC.guidFor(this),d=j.get("items"),b,a=d.length,g;f.addClass(j.get("layoutDirection"));f.attr("role","radiogroup");f.attr("aria-disabled",j.get("isEnabled")?"false":"true");for(b=0;b<a;b++){g=d[b];f=f.begin("div").addClass("radio-"+b).attr("index",b).addClass(h.classNames).addClass(h.radioRenderDelegate.className).addClass("sc-radio-button");h.radioRenderDelegate.render(g,f);f=f.end()}if(!a){h.radioRenderDelegate.render(null,f)}j.get("renderState").radioCount=b},update:function(a,e){this.updateSizeClassName(a,e);var f=a.get("theme"),b=SC.guidFor(this),h=a.get("items"),j,g=h.length,k;e.addClass(a.get("layoutDirection"));e.attr("aria-disabled",a.get("isEnabled")?"false":"true");if(a.get("renderState").radioCount!==g){var d=SC.RenderContext(e[0]);this.render(a,d);d.update();return}for(j=0;j<g;j++){k=h[j];f.radioRenderDelegate.update(k,e.find(".radio-"+j))}},updateRadioAtIndex:function(e,a,b){var d=e.get("items")[b];e.get("theme").radioRenderDelegate.update(d,a.find(".radio-"+b))},indexForEvent:function(e,b,a){var d=$(a.target).closest(".sc-radio-button").attr("index");if(isNaN(d)){return undefined}return parseInt(d,0)}});SC.BaseTheme.segmentRenderDelegate=SC.RenderDelegate.create({className:"segment",render:function(f,b){var d=f.get("theme"),e,a;a={"sc-first-segment":f.get("isFirstSegment"),"sc-middle-segment":f.get("isMiddleSegment"),"sc-last-segment":f.get("isLastSegment"),"sc-overflow-segment":f.get("isOverflowSegment"),vertical:f.get("layoutDirection")!==SC.LAYOUT_HORIZONTAL};if(!SC.none(f.get("index"))){a["sc-segment-"+f.get("index")]=YES}b.setClass(a);e=d.buttonRenderDelegate;e.render(f,b)},update:function(f,a){var d=f.get("theme"),e,b={};b={"sc-first-segment":f.get("isFirstSegment"),"sc-middle-segment":f.get("isMiddleSegment"),"sc-last-segment":f.get("isLastSegment"),"sc-overflow-segment":f.get("isOverflowSegment")||NO,vertical:f.get("layoutDirection")!==SC.LAYOUT_HORIZONTAL};if(!SC.none(f.get("index"))){b["sc-segment-"+f.get("index")]=YES}a.setClass(b);e=d.buttonRenderDelegate;e.update(f,a)}});SC.BaseTheme.segmentedRenderDelegate=SC.RenderDelegate.create({className:"segmented",render:function(b,a){this.addSizeClassName(b,a);a.addStyle("text-align",b.get("align"))},update:function(b,a){this.updateSizeClassName(b,a);a.css("text-align",b.get("align"))}});SC.BaseTheme.sliderRenderDelegate=SC.RenderDelegate.create({className:"slider",render:function(g,d){this.addSizeClassName(g,d);var b=SC.BLANK_IMAGE_URL,a=g.get("maximum"),f=g.get("minimum"),e=g.get("ariaValue");d.attr("aria-valuemax",a);d.attr("aria-valuemin",f);d.attr("aria-valuenow",e);if(f!==0||a!==100){d.attr("aria-valuetext",e)}d.attr("aria-orientation","horizontal");d=d.begin("span").addClass("track");this.includeSlices(g,d,SC.THREE_SLICE);d.push('<img src="'+b+'" class="sc-handle" style="left: '+g.get("value")+'%" /></span>');d=d.end();g.get("renderState")._cachedHandle=null},update:function(j,b){this.updateSizeClassName(j,b);var a=j.get("maximum"),e=j.get("minimum"),d=j.get("ariaValue");b.attr("aria-valuemax",a);b.attr("aria-valuemin",e);b.attr("aria-valuenow",d);if(e!==0||a!==100){b.attr("aria-valuetext",d)}b.attr("aria-orientation","horizontal");if(j.didChangeFor("sliderRenderDelegate","value")){var g=j.get("renderState")._cachedHandle;if(!g){g=j.get("renderState")._cachedHandle=b.find(".sc-handle")}var h=j.get("frame"),f=j.get("value");g.css("left",f+"%")}}});SC.BaseTheme.SourceList=SC.BaseTheme.subtheme("source-list");SC.BaseTheme.toolbarRenderDelegate=SC.RenderDelegate.create({className:"toolbar",render:function(b,a){},update:function(){}});SC.BaseTheme.wellRenderDelegate=SC.RenderDelegate.create({className:"well",render:function(b,a){this.includeSlices(b,a,SC.NINE_SLICE)},update:function(){}});SC.BaseTheme.workspaceRenderDelegate=SC.RenderDelegate.create({className:"workspace",render:function(){},update:function(){}});SC.DRAG_LINK=4;SC.DRAG_COPY=1;SC.DRAG_MOVE=2;SC.DRAG_NONE=0;SC.DRAG_ANY=15;SC.DRAG_DATA=8;SC.DRAG_AUTOSCROLL_ZONE_THICKNESS=20;SC.View.reopen({init:function(a){a();if(this.get("isDropTarget")){SC.Drag.addDropTarget(this)}if(this.get("isScrollable")){SC.Drag.addScrollableView(this)}}.enhance(),destroy:function(a){if(this.get("isDropTarget")){SC.Drag.removeDropTarget(this)}if(this.get("isScrollable")){SC.Drag.removeScrollableView(this)}return a()}.enhance()});SC.Drag=SC.Object.extend({source:null,ghostView:null,ghostActsLikeCursor:NO,dragView:null,ghost:YES,sourceIsDraggable:YES,slideBack:YES,ghostOffset:{x:0,y:0},location:{},dataTypes:function(){if(this.dataSource){return this.dataSource.get("dragDataTypes")||[]}var e=this.data;if(e){var a=[];for(var b in e){if(e.hasOwnProperty(b)){a.push(b)}}return a}var d=this.get("source");if(d&&d.dragDataTypes){return d.get("dragDataTypes")||[]}return[]}.property().cacheable(),hasDataType:function(a){return(this.get("dataTypes").indexOf(a)>=0)},dataForType:function(a){if(this.dataSource){return this.dataSource.dragDataForType(this,a)}else{if(this.data){return this.data[a]}else{var b=this.get("source");if(b&&SC.typeOf(b.dragDataForType)===SC.T_FUNCTION){return b.dragDataForType(this,a)}else{return null}}}},dataSource:null,data:null,allowedDragOperations:SC.DRAG_ANY,_dragInProgress:YES,_dragViewWasVisible:null,startDrag:function(){if(this.get("sourceIsDraggable")){this._createGhostView()}var j=this.event;var f={x:j.pageX,y:j.pageY};this.set("location",f);if(this.get("sourceIsDraggable")){var b=this._getDragView();var k=b.get("parentView");var h=k?k.convertFrameToView(b.get("frame"),null):b.get("frame");if(this.get("ghost")){this._dragViewWasVisible=b.get("isVisible");b.set("isVisible",NO)}if(this.ghostActsLikeCursor){this.ghostOffset={x:14,y:14}}else{this.ghostOffset={x:(f.x-h.x),y:(f.y-h.y)}}if(!this._ghostViewHidden){this._positionGhostView(j)}if(j.makeTouchResponder){var l=this;SC.Timer.schedule({target:j,action:function(){if(!j.hasEnded){j.makeTouchResponder(l,YES)}},interval:1})}else{this.ghostView.rootResponder.dragDidStart(this,j)}}var a=this.source;if(a&&a.dragDidBegin){a.dragDidBegin(this,f)}var d=this._dropTargets();for(var g=0,e=d.length;g<e;g++){d[g].tryToPerform("dragStarted",this,j)}},cancelDrag:function(){var b=this._lastTarget,d=this.get("location");if(b&&b.dragExited){b.dragExited(this,this._lastMouseDraggedEvent)}if(this.get("sourceIsDraggable")){this._destroyGhostView();if(this.get("ghost")){if(this._dragViewWasVisible){this._getDragView().set("isVisible",YES)}this._dragViewWasVisible=null}}var a=this.source;if(a&&a.dragDidEnd){a.dragDidEnd(this,d,SC.DRAG_NONE)}this._lastTarget=null;this._dragInProgress=NO},touchStart:function(a){return YES},mouseDragged:function(a){var b=this._autoscroll(a);var g=this.get("location");if(!b&&(a.pageX===g.x)&&(a.pageY===g.y)){return}g={x:a.pageX,y:a.pageY};this.set("location",g);this._lastMouseDraggedEvent=a;var e=this.source;var d=this._lastTarget;var f=this._findDropTarget(a);var h=SC.DRAG_NONE;while(f&&(f!==d)&&(h===SC.DRAG_NONE)){if(f&&e&&e.dragSourceOperationMaskFor){h=e.dragSourceOperationMaskFor(this,f)}else{h=SC.DRAG_ANY}if((h!==SC.DRAG_NONE)&&f&&f.computeDragOperations){h=h&f.computeDragOperations(this,a,h)}else{h=SC.DRAG_NONE}if(h===SC.DRAG_NONE){f=this._findNextDropTarget(f)}}if(f!==d){this.allowedDragOperations=h}if(f!==d){if(d&&d.dragExited){d.dragExited(this,a)}if(f){if(f.dragEntered){f.dragEntered(this,a)}if(f.dragUpdated){f.dragUpdated(this,a)}}this._lastTarget=f}else{if(f&&f.dragUpdated){f.dragUpdated(this,a)}}if(e&&e.dragDidMove){e.dragDidMove(this,g)}if(this.get("sourceIsDraggable")&&!this._ghostViewHidden){this._positionGhostView(a)}},touchesDragged:function(a){this.mouseDragged(a)},mouseUp:function(n){var h={x:n.pageX,y:n.pageY},j=this._lastTarget,f=this.allowedDragOperations;this.set("location",h);try{if(j&&j.acceptDragOperation&&j.acceptDragOperation(this,f)){f=j.performDragOperation?j.performDragOperation(this,f):SC.DRAG_NONE}else{f=SC.DRAG_NONE}}catch(k){SC.Logger.error("Exception in SC.Drag.mouseUp(acceptDragOperation|performDragOperation): %@".fmt(k))}try{if(j&&j.dragExited){j.dragExited(this,n)}}catch(l){SC.Logger.error("Exception in SC.Drag.mouseUp(target.dragExited): %@".fmt(l))}var d=this._dropTargets();for(var m=0,g=d.length;m<g;m++){try{d[m].tryToPerform("dragEnded",this,n)}catch(b){SC.Logger.error("Exception in SC.Drag.mouseUp(dragEnded on %@): %@".fmt(d[m],b))}}if(this.get("sourceIsDraggable")){this._destroyGhostView();if(this.get("ghost")){if(this._dragViewWasVisible){this._getDragView().set("isVisible",YES)}this._dragViewWasVisible=null}}var a=this.source;if(a&&a.dragDidEnd){a.dragDidEnd(this,h,f)}this._lastTarget=null;this._dragInProgress=NO},touchEnd:function(a){this.mouseUp(a)},_getDragView:function(){if(!this.dragView){if(!this.source||!this.source.isView){throw"Source can't be used as dragView, because it's not a view."}this.dragView=this.source}return this.dragView},_createGhostView:function(){var d=this,b=this._getDragView(),e=b.get("frame"),a;a=this.ghostView=SC.Pane.create({classNames:["sc-ghost-view"],layout:{top:e.y,left:e.x,width:e.width,height:e.height},owner:this,didCreateLayer:function(){if(b){var f=b.get("layer");if(f){f=f.cloneNode(true);f.style.top="0px";f.style.left="0px";this.get("layer").appendChild(f)}}}});a.append()},_positionGhostView:function(a){var d=this.get("location");d.x-=this.ghostOffset.x;d.y-=this.ghostOffset.y;var b=this.ghostView;if(b){b.adjust({top:d.y,left:d.x});b.invokeOnce("updateLayout")}},_ghostViewHidden:NO,hideGhostView:function(){if(this.ghostView&&!this._ghostViewHidden){this.ghostView.remove();this._ghostViewHidden=YES}},unhideGhostView:function(){if(this._ghostViewHidden){this._ghostViewHidden=NO;this._createGhostView()}},_destroyGhostView:function(){if(this.ghostView){this.ghostView.remove();this.ghostView=null;this._ghostViewHidden=NO}},_dropTargets:function(){if(this._cachedDropTargets){return this._cachedDropTargets}var b=[];var e=SC.Drag._dropTargets;for(var d in e){if(e.hasOwnProperty(d)){b.push(e[d])}}var g={};var f=SC.Drag._dropTargets;var a=function(h){if(!h){return 0}var k=SC.guidFor(h);var j=g[k];if(!j){j=1;while(h=h.get("parentView")){if(f[SC.guidFor(h)]!==undefined){j=j+1}if(h.isPane&&h.isMainPane){j=j+10000}}g[k]=j}return j};b.sort(function(j,h){if(j===h){return 0}j=a(j);h=a(h);return(j>h)?-1:1});this._cachedDropTargets=b;return b},_findDropTarget:function(d){var h={x:d.pageX,y:d.pageY};var f,g;var e=this._dropTargets();for(var b=0,a=e.length;b<a;b++){f=e[b];if(!f.get("isVisibleInWindow")){continue}g=f.convertFrameToView(f.get("clippingFrame"),null);if(SC.pointInRect(h,g)){return f}}return null},_findNextDropTarget:function(a){var b=SC.Drag._dropTargets;while(a=a.get("parentView")){if(b[SC.guidFor(a)]){return a}}return null},_autoscroll:function(n){if(!n){n=this._lastAutoscrollEvent}if(!this._dragInProgress){return NO}var h=n?{x:n.pageX,y:n.pageY}:this.get("location"),j=this._findScrollableView(h),o=null,m,d,e,k,b,a,g;while(j&&!o){m=j.get("canScrollVertical")?1:0;d=j.get("canScrollHorizontal")?1:0;if(m||d){a=j.get("containerView");if(a){g=j.convertFrameToView(a.get("frame"),null)}else{m=d=0}}if(m){k=SC.maxY(g);e=k-SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(h.y>=e&&h.y<=k){m=1}else{e=SC.minY(g);k=e+SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(h.y>=e&&h.y<=k){m=-1}else{m=0}}}if(d){k=SC.maxX(g);e=k-SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(h.x>=e&&h.x<=k){d=1}else{e=SC.minX(g);k=e+SC.DRAG_AUTOSCROLL_ZONE_THICKNESS;if(h.x>=e&&h.x<=k){d=-1}else{d=0}}}if(m||d){o=j}else{j=this._findNextScrollableView(j)}}if(o&&(this._lastScrollableView===o)){if((Date.now()-this._hotzoneStartTime)>100){this._horizontalScrollAmount*=1.05;this._verticalScrollAmount*=1.05}}else{this._lastScrollableView=o;this._horizontalScrollAmount=15;this._verticalScrollAmount=15;this._hotzoneStartTime=(o)?Date.now():null;d=m=0}if(o&&(d||m)){var l={x:d*this._horizontalScrollAmount,y:m*this._verticalScrollAmount};o.scrollBy(l)}if(o){if(n){this._lastAutoscrollEvent={pageX:n.pageX,pageY:n.pageY}}this.invokeLater(this._autoscroll,100,null);return YES}else{this._lastAutoscrollEvent=null;return NO}},_scrollableViews:function(){if(this._cachedScrollableView){return this._cachedScrollableView}var a=[];var d=SC.Drag._scrollableViews;for(var b in d){if(d.hasOwnProperty(b)){a.push(d[b])}}a=a.sort(function(g,e){var f=g;while(f=f.get("parentView")){if(e===f){return -1}}return 1});this._cachedScrollableView=a;return a},_findScrollableView:function(g){var d=this._scrollableViews(),b=d?d.length:0,e,f,a;for(a=0;a<b;a++){e=d[a];if(!e.get("isVisibleInWindow")){continue}f=e.convertFrameToView(e.get("clippingFrame"),null);if(SC.pointInRect(g,f)){return e}}return null},_findNextScrollableView:function(a){var b=SC.Drag._scrollableViews;while(a=a.get("parentView")){if(b[SC.guidFor(a)]){return a}}return null}});SC.Drag.mixin({start:function(b){var a=this.create(b);a.startDrag();return a},_dropTargets:{},_scrollableViews:{},addDropTarget:function(a){this._dropTargets[SC.guidFor(a)]=a},removeDropTarget:function(a){delete this._dropTargets[SC.guidFor(a)]},addScrollableView:function(a){this._scrollableViews[SC.guidFor(a)]=a},removeScrollableView:function(a){delete this._scrollableViews[SC.guidFor(a)]}});SC.UndoManager=SC.Object.extend({undoActionName:function(){return this.undoStack?this.undoStack.name:null}.property("undoStack"),redoActionName:function(){return this.redoStack?this.redoStack.name:null}.property("redoStack"),canUndo:function(){return this.undoStack!=null}.property("undoStack"),canRedo:function(){return this.redoStack!=null}.property("redoStack"),undo:function(){this._undoOrRedo("undoStack","isUndoing")},redo:function(){this._undoOrRedo("redoStack","isRedoing")},isUndoing:NO,isRedoing:NO,groupingLevel:0,registerUndo:function(b,a){this.beginUndoGroup(a);this._activeGroup.actions.push(b);this.endUndoGroup(a)},beginUndoGroup:function(b){if(this._activeGroup){this.groupingLevel++}else{var a=this.isUndoing?"redoStack":"undoStack";this._activeGroup={name:b,actions:[],prev:this.get(a)};this.set(a,this._activeGroup);this.groupingLevel=1}},endUndoGroup:function(a){if(!this._activeGroup){raise("endUndoGroup() called outside group.")}if(this.groupingLevel>1){this.groupingLevel--}else{this._activeGroup=null;this.groupingLevel=0}this.propertyDidChange(this.isUndoing?"redoStack":"undoStack")},setActionName:function(a){if(!this._activeGroup){raise("setActionName() called outside group.")}this._activeGroup.name=a},_activeGroup:null,undoStack:null,redoStack:null,_undoOrRedo:function(a,d){if(this._activeGroup){return false}if(this.get(a)==null){return true}this.set(d,true);var f=this.get(a);this.set(a,f.prev);var b;var e=f.actions.length>1;if(e){this.beginUndoGroup(f.name)}while(b=f.actions.pop()){b()}if(e){this.endUndoGroup(f.name)}this.set(d,false)}});SC.CheckboxView=SC.ButtonView.extend(SC.StaticLayout,{classNames:["sc-checkbox-view","sc-checkbox-control"],ariaRole:"checkbox",themeName:null,renderDelegateName:"checkboxRenderDelegate",needsEllipsis:NO,acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),_toggleValue:function(){var a=this.get("value")===this.get("toggleOnValue");this.set("value",a?this.get("toggleOffValue"):this.get("toggleOnValue"))},mouseDown:function(a){if(!this.get("isEnabled")){return YES}if($(a.target).hasClass("sc-checkbox-view")){return YES}this.set("isActive",YES);this._isMouseDown=YES;if(a&&this.get("acceptsFirstResponder")){a.allowDefault()}return YES},mouseUp:function(a){if(!this.get("isEnabled")){return YES}if($(a.target).hasClass("sc-checkbox-view")){return YES}this.set("isActive",NO);this._isMouseDown=NO;if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){if(this.$().within(a.target)){this._toggleValue();this._action(a)}}return YES},keyDown:function(b){if(!this.get("isEnabled")){return YES}if(b.which===9||b.keyCode===9){var a=b.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES}if(b.which===13||b.which===32){this._toggleValue();if(this.get("buttonBehavior")!==SC.HOLD_BEHAVIOR){if(this.$().within(b.target)){this._action(b)}}return YES}b.allowDefault();return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)}});SC.LIST_ITEM_ACTION_CANCEL="sc-list-item-cancel-action";SC.LIST_ITEM_ACTION_REFRESH="sc-list-item-cancel-refresh";SC.LIST_ITEM_ACTION_EJECT="sc-list-item-cancel-eject";SC.ListItemView=SC.View.extend(SC.InlineEditable,SC.Control,{classNames:["sc-list-item-view"],displayProperties:["disclosureState","escapeHTML","isDropTarget"],content:null,contentIndex:null,hasContentIcon:NO,hasContentRightIcon:NO,hasContentBranch:NO,contentCheckboxKey:null,icon:null,isDropTarget:NO,contentIconKey:null,rightIcon:null,contentRightIconKey:null,contentValueKey:null,escapeHTML:YES,contentUnreadCountKey:null,contentIsBranchKey:null,outlineIndent:16,outlineLevel:0,disclosureState:SC.LEAF_NODE,validator:null,contentKeys:{contentValueKey:"title",contentCheckboxKey:"checkbox",contentIconKey:"icon",contentRightIconKey:"rightIcon",contentUnreadCountKey:"count",contentIsBranchKey:"branch"},contentPropertyDidChange:function(){if(this.get("contentIsEditable")!==this.contentIsEditable()){this.notifyPropertyChange("contentIsEditable")}this.displayDidChange()},contentIsEditable:function(){var a=this.get("content");return a&&(a.get?a.get("isEditable")!==NO:NO)}.property("content").cacheable(),inlineEditorDelegate:SC.InlineTextFieldDelegate,$label:function(){return this.$("label")},_isInsideElementWithClassName:function(f,a){var d=this.get("layer");if(!d){return NO}var e=SC.$(a.target);var b=NO;while(!b&&e.length>0&&(e[0]!==d)){if(e.hasClass(f)){b=YES}e=e.parent()}e=d=null;return b},_isInsideCheckbox:function(b){var a=this.displayDelegate;var d=this.getDelegateProperty("contentCheckboxKey",a);return d&&this._isInsideElementWithClassName("sc-checkbox-view",b)},_isInsideDisclosure:function(a){if(this.get("disclosureState")===SC.LEAF_NODE){return NO}return this._isInsideElementWithClassName("sc-disclosure-view",a)},_isInsideRightIcon:function(d){var b=this.displayDelegate;var a=this.getDelegateProperty("hasContentRightIcon",b)||!SC.none(this.rightIcon);return a&&this._isInsideElementWithClassName("right-icon",d)},mouseDown:function(a){if(!this.get("contentIsEditable")){return NO}if(this._isInsideCheckbox(a)){this._addCheckboxActiveState();this._isMouseDownOnCheckbox=YES;this._isMouseInsideCheckbox=YES;return YES}else{if(this._isInsideDisclosure(a)){this._addDisclosureActiveState();this._isMouseDownOnDisclosure=YES;this._isMouseInsideDisclosure=YES;return YES}else{if(this._isInsideRightIcon(a)){this._addRightIconActiveState();this._isMouseDownOnRightIcon=YES;this._isMouseInsideRightIcon=YES;return YES}}}return NO},mouseUp:function(j){var d=NO,k,e,b,a,h,g;if(this._isMouseDownOnCheckbox){if(this._isInsideCheckbox(j)){k=this.displayDelegate;e=this.getDelegateProperty("contentCheckboxKey",k);b=this.get("content");if(b&&b.get){var f=b.get(e);f=(f===SC.MIXED_STATE)?YES:!f;b.set(e,f);this.displayDidChange()}}this._removeCheckboxActiveState();d=YES}else{if(this._isMouseDownOnDisclosure){if(this._isInsideDisclosure(j)){a=this.get("disclosureState");h=this.get("contentIndex");g=(!SC.none(h))?SC.IndexSet.create(h):null;k=this.get("displayDelegate");if(a===SC.BRANCH_OPEN){if(g&&k&&k.collapse){k.collapse(g)}else{this.set("disclosureState",SC.BRANCH_CLOSED)}this.displayDidChange()}else{if(a===SC.BRANCH_CLOSED){if(g&&k&&k.expand){k.expand(g)}else{this.set("disclosureState",SC.BRANCH_OPEN)}this.displayDidChange()}}}this._removeDisclosureActiveState();d=YES}else{if(this._isMouseDownOnRightIcon){this._removeRightIconActiveState();d=YES}}}this._isMouseInsideCheckbox=this._isMouseDownOnCheckbox=NO;this._isMouseDownOnDisclosure=this._isMouseInsideDisclosure=NO;this._isMouseInsideRightIcon=this._isMouseDownOnRightIcon=NO;return d},mouseMoved:function(a){if(this._isMouseDownOnCheckbox&&this._isInsideCheckbox(a)){this._addCheckboxActiveState();this._isMouseInsideCheckbox=YES}else{if(this._isMouseDownOnCheckbox){this._removeCheckboxActiveState();this._isMouseInsideCheckbox=NO}else{if(this._isMouseDownOnDisclosure&&this._isInsideDisclosure(a)){this._addDisclosureActiveState();this._isMouseInsideDisclosure=YES}else{if(this._isMouseDownOnDisclosure){this._removeDisclosureActiveState();this._isMouseInsideDisclosure=NO}else{if(this._isMouseDownOnRightIcon&&this._isInsideRightIcon(a)){this._addRightIconActiveState();this._isMouseInsideRightIcon=YES}else{if(this._isMouseDownOnRightIcon){this._removeRightIconActiveState();this._isMouseInsideRightIcon=NO}}}}}}return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},touchEntered:function(a){return this.mouseEntered(a)},touchExited:function(a){return this.mouseExited(a)},_addCheckboxActiveState:function(){if(this.get("isEnabled")){if(this._checkboxRenderDelegate){var a=this._checkboxRenderSource;a.set("isActive",YES);this._checkboxRenderDelegate.update(a,this.$(".sc-checkbox-view"))}else{this.$(".sc-checkbox-view").addClass("active")}}},_removeCheckboxActiveState:function(){if(this._checkboxRenderer){var a=this._checkboxRenderSource;a.set("isActive",NO);this._checkboxRenderDelegate.update(a,this.$(".sc-checkbox-view"))}else{this.$(".sc-checkbox-view").removeClass("active")}},_addDisclosureActiveState:function(){if(this.get("isEnabled")){if(this._disclosureRenderDelegate){var a=this._disclosureRenderSource;a.set("isActive",YES);this._disclosureRenderDelegate.update(a,this.$(".sc-disclosure-view"))}else{this.$(".sc-disclosure-view").addClass("active")}}},_removeDisclosureActiveState:function(){if(this._disclosureRenderer){var a=this._disclosureRenderSource;a.set("isActive",NO);this._disclosureRenderDelegate.update(a,this.$(".sc-disclosure-view"))}else{this.$(".sc-disclosure-view").addClass("active")}},_addRightIconActiveState:function(){this.$("img.right-icon").setClass("active",YES)},_removeRightIconActiveState:function(){this.$("img.right-icon").removeClass("active")},contentHitTest:function(b){var a=this.displayDelegate;var d=this.getDelegateProperty("contentValueKey",a);if(!d){return NO}var f=this.$label()[0];if(!f){return NO}var g=b.target,e=this.get("layer");while(g&&(g!==e)&&(g!==window)){if(g===f){return YES}g=g.parentNode}return NO},beginEditing:function(e,d){var g=this.$label(),f=this.get("parentView");if(d&&this.scrollToVisible()){var b=this.get("owner"),a=this.get("contentIndex");this.invokeLast(function(){var h=b.itemViewForContentIndex(a);if(h&&h.beginEditing){h.beginEditing(NO)}});return YES}else{if(!f||!g||g.get("length")===0){return NO}else{return e()}}}.enhance(),inlineEditorWillBeginEditing:function(e,q,p){var s=this.get("content"),k=this.get("displayDelegate"),j=this.getDelegateProperty("contentValueKey",k),l=this.get("parentView"),a=this.$label(),g=this.get("validator"),u,m,h,b,n,d,o,w,t,x;m=(j&&s)?(s.get?s.get(j):s[j]):s;u=this.computeFrameWithParentFrame(null);d=this._oldLineHeight=a.css("lineHeight");b=a.css("fontSize");n=this.$().css("top");if(n){n=parseInt(n.substring(0,n.length-2),0)}else{n=0}w=0;if(b&&d){t=b*1.5;if(t<d){a.css({lineHeight:"1.5"});w=(d-t)/2}else{oldLineHeight=null}}a=a[0];h=SC.offset(a);u.x=h.x;u.y=h.y+n+w;u.height=a.offsetHeight;u.width=a.offsetWidth;o=this.get("escapeHTML");e.set({value:m,exampleFrame:u,exampleElement:a,multiline:NO,isCollection:YES,validator:g,escapeHTML:o})},inlineEditorShouldBeginEditing:function(a){return YES},inlineEditorDidBeginEditing:function(b,e,f,a){b(e,f,a);var d=this.$label();this._oldOpacity=d.css("opacity");d.css("opacity",0);if(this._oldLineHeight){d.css({lineHeight:this._oldLineHeight})}}.enhance(),inlineEditorDidCommitEditing:function(e,g,d){var f=this.get("content");var a=this.displayDelegate;var b=this.getDelegateProperty("contentValueKey",a);if(b&&f){if(f.set){f.set(b,g)}else{f[b]=g}}else{this.set("content",g)}this.displayDidChange();this._endEditing()},_endEditing:function(a){this.$label().css("opacity",this._oldOpacity);a()}.enhance(),render:function(d,a){var g=this.get("content"),o=this.displayDelegate,b=this.get("outlineLevel"),f=this.get("outlineIndent"),n,l,k,p=[];p.push((this.get("contentIndex")%2===0)?"even":"odd");d.setClass("disabled",!this.get("isEnabled"));d.setClass("drop-target",this.get("isDropTarget"));k=d.begin("div").addClass("sc-outline");if(b>=0&&f>0){k.addStyle("left",f*(b+1))}l=this.get("disclosureState");if(l!==SC.LEAF_NODE){this.renderDisclosure(k,l);p.push("has-disclosure")}n=this.getDelegateProperty("contentCheckboxKey",o);if(n){l=g?(g.get?g.get(n):g[n]):NO;if(l!==null){this.renderCheckbox(k,l);p.push("has-checkbox")}}if(this.getDelegateProperty("hasContentIcon",o)){n=this.getDelegateProperty("contentIconKey",o);l=(n&&g)?(g.get?g.get(n):g[n]):null;if(l){this.renderIcon(k,l);p.push("has-icon")}}else{if(this.get("icon")){l=this.get("icon");this.renderIcon(k,l);p.push("has-icon")}}n=this.getDelegateProperty("contentValueKey",o);l=(n&&g)?(g.get?g.get(n):g[n]):g;if(l&&SC.typeOf(l)!==SC.T_STRING){l=l.toString()}if(this.get("escapeHTML")){l=SC.RenderContext.escapeHTML(l)}this.renderLabel(k,l);if(this.getDelegateProperty("hasContentRightIcon",o)){n=this.getDelegateProperty("contentRightIconKey",o);l=(n&&g)?(g.get?g.get(n):g[n]):null;this.renderRightIcon(k,l);p.push("has-right-icon")}n=this.getDelegateProperty("contentUnreadCountKey",o);l=(n&&g)?(g.get?g.get(n):g[n]):null;if(!SC.none(l)&&(l!==0)){this.renderCount(k,l);var e=["zero","one","two","three","four","five"];var m=l.toString().length;var j=e.length;var h=(m<j)?e[m]:e[j-1];p.push("has-count "+h+"-digit")}n=this.getDelegateProperty("listItemActionProperty",o);l=(n&&g)?(g.get?g.get(n):g[n]):null;if(l){this.renderAction(k,l);p.push("has-action")}if(this.getDelegateProperty("hasContentBranch",o)){n=this.getDelegateProperty("contentIsBranchKey",o);l=(n&&g)?(g.get?g.get(n):g[n]):NO;this.renderBranch(k,l);p.push("has-branch")}d.addClass(p);d=k.end()},renderDisclosure:function(a,e){var d=this.get("theme").disclosureRenderDelegate;a=a.begin("div").addClass("sc-disclosure-view").addClass("sc-regular-size").addClass(this.get("theme").classNames).addClass(d.get("className"));var b=this._disclosureRenderSource;if(!b){this._disclosureRenderSource=b=SC.Object.create({renderState:{},theme:this.get("theme")})}b.set("isSelected",e===SC.BRANCH_OPEN).set("isEnabled",this.get("isEnabled")).set("title","");d.render(b,a);a=a.end();this._disclosureRenderDelegate=d},renderCheckbox:function(a,e){var d=this.get("theme").checkboxRenderDelegate;a=a.begin("div").addClass("sc-checkbox-view").addClass("sc-regular-size").addClass(this.get("theme").classNames).addClass(d.get("className"));var b=this._checkboxRenderSource;if(!b){b=this._checkboxRenderSource=SC.Object.create({renderState:{},theme:this.get("theme")})}b.set("isSelected",e&&(e!==SC.MIXED_STATE)).set("isEnabled",this.get("isEnabled")&&this.get("contentIsEditable")).set("isActive",this._checkboxIsActive).set("title","");d.render(b,a);a=a.end();this._checkboxRenderDelegate=d},renderIcon:function(d,f){var b=null,e=null,a=[];if(f&&SC.ImageView.valueIsUrl(f)){b=f;e=""}else{e=f;b=SC.BLANK_IMAGE_URL}a.push(e,"icon");d.begin("img").addClass(a).attr("src",b).end()},renderLabel:function(b,a){b.push("<label>",a||"","</label>")},renderRightIcon:function(d,f){var b=null,e=null,a=[];if(f&&SC.ImageView.valueIsUrl(f)){b=f;e=""}else{e=f;b=SC.BLANK_IMAGE_URL}a.push("right-icon",e);d.begin("img").addClass(a).attr("src",b).end()},renderCount:function(a,b){a.push('<span class="count"><span class="inner">',b.toString(),"</span></span>")},renderAction:function(a,b){a.push('<img src="',SC.BLANK_IMAGE_URL,'" class="action" />')},renderBranch:function(d,b){var a=[];a.push("branch",b?"branch-visible":"branch-hidden");d.begin("span").addClass(a).push("&nbsp;").end()}});SC.ListItemView._deprecatedRenderWarningHasBeenIssued=false;sc_require("mixins/collection_view_delegate");sc_require("views/list_item");SC.DRAG_REORDER=16;SC.BENCHMARK_RELOAD=NO;SC.CollectionView=SC.View.extend(SC.CollectionViewDelegate,SC.CollectionContent,{classNames:["sc-collection-view"],displayProperties:["hasFirstResponder","isEnabled","isActive"],renderDelegateName:"collectionRenderDelegate",ACTION_DELAY:200,useFastPath:NO,content:null,contentBindingDefault:SC.Binding.multiple(),length:0,nowShowing:function(){return this.computeNowShowing()}.property("length","clippingFrame").cacheable(),selection:null,isSelectable:YES,isSelectableBindingDefault:SC.Binding.bool(),isEnabled:YES,isEnabledBindingDefault:SC.Binding.bool(),isEditable:YES,isEditableBindingDefault:SC.Binding.bool(),canReorderContent:NO,canReorderContentBindingDefault:SC.Binding.bool(),canDeleteContent:NO,canDeleteContentBindingDefault:SC.Binding.bool(),canEditContent:NO,canEditContentBindingDefault:SC.Binding.bool(),isDropTarget:NO,useToggleSelection:NO,actOnSelect:NO,selectOnMouseDown:YES,exampleView:SC.ListItemView,contentExampleViewKey:null,groupExampleView:null,contentGroupExampleViewKey:null,action:null,target:null,contentValueKey:null,acceptsFirstResponder:NO,isActive:NO,calculatedHeight:0,calculatedWidth:0,computeLayout:function(){return null},layoutForContentIndex:function(a){return null},allContentIndexes:function(){return SC.IndexSet.create(0,this.get("length")).freeze()}.property("length").cacheable(),contentIndexesInRect:function(a){return null},computeNowShowing:function(){var d=this.contentIndexesInRect(this.get("clippingFrame"));if(!d){d=this.get("allContentIndexes")}else{var b=this.get("length"),a=d.get("max");if(a>b){d=d.copy().remove(b,a-b).freeze()}}return d},showInsertionPoint:function(a,b){},hideInsertionPoint:function(){},delegate:null,selectionDelegate:function(){var a=this.get("delegate"),b=this.get("content");return this.delegateFor("isCollectionViewDelegate",a,b)}.property("delegate","content").cacheable(),contentDelegate:function(){var a=this.get("delegate"),b=this.get("content");return this.delegateFor("isCollectionContent",a,b)}.property("delegate","content").cacheable(),_contentGroupIndexes:function(){return this.get("contentDelegate").contentGroupIndexes(this,this.get("content"))}.property("contentDelegate","content").cacheable(),contentRangeDidChange:function(e,b,d,a){if(!b&&(d==="[]")){this.notifyPropertyChange("_contentGroupIndexes");this.reload(a)}else{this.contentPropertyDidChange(b,d,a)}},contentPropertyDidChange:function(d,b,a){},updateContentRangeObserver:function(){var e=this.get("nowShowing"),a=this._cv_contentRangeObserver,d=this.get("content");if(!d){return}if(a){d.updateRangeObserver(a,e)}else{var b=this.contentRangeDidChange;a=d.addRangeObserver(e,this,b,null);this._cv_contentRangeObserver=a}},removeContentRangeObserver:function(){var b=this.get("content"),a=this._cv_contentRangeObserver;if(a){if(b){b.removeRangeObserver(a)}this._cv_contentRangeObserver=null}},contentLengthDidChange:function(){var a=this.get("content");this.set("length",a?a.get("length"):0);this.computeLayout()},_cv_contentDidChange:function(){var b=this.get("content"),a=this.contentLengthDidChange;if(b===this._content){return}this.removeContentRangeObserver();if(this._content){this._content.removeObserver("length",this,a)}this._content=b;if(b){b.addObserver("length",this,a)}this.contentLengthDidChange();this.contentRangeDidChange(b,null,"[]",null)}.observes("content"),_invalidIndexes:NO,reload:function(a){var b=this._invalidIndexes;if(a&&b!==YES){if(b){b.add(a)}else{b=this._invalidIndexes=a.clone()}}else{this._invalidIndexes=YES}if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadIfNeeded)}return this},reloadIfNeeded:function(){var z=this._invalidIndexes;if(!z||!this.get("isVisibleInWindow")){return this}this._invalidIndexes=NO;var w=this.get("content"),x,y,o,B=this.computeLayout(),A=SC.BENCHMARK_RELOAD,d=this.get("nowShowing"),C=this._sc_itemViews,p=this.get("containerView")||this,a,t,v,u,m,q,j,s,f,n,l,D,e,b,h,k,g;if(z.isIndexSet&&z.contains(d)){z=YES}if(this.willReload){this.willReload(z===YES?null:z)}a=this.get("exampleView");v=a?a.isReusableInCollections:NO;t=this.get("groupExampleView");u=t?t.isReusableInCollections:NO;if(z.isIndexSet){if(A){SC.Benchmark.start(A="%@#reloadIfNeeded (Partial)".fmt(this),YES)}q=[];j=[];s=[];z.forEach(function(E){o=C?C[E]:null;if(d.contains(E)){if(o&&o.parentView===p){j.push(E)}else{s.push(E)}}else{if(o&&o.parentView===p){q.push(E)}}},this);for(x=0,y=q.length;x<y;++x){n=q[x];o=C?C[n]:null;delete C[n];h=this.get("contentDelegate");k=this.get("_contentGroupIndexes");g=k&&k.contains(n);if(g){g=h.contentIndexIsGroup(this,w,n)}m=g?u:v;if(m){b=g?this._GROUP_VIEW_POOL:this._VIEW_POOL;b.push(o);o.destroyLayer()}D=o.get("layer");if(D&&D.parentNode){D.parentNode.removeChild(D)}p.removeChild(o);if(!m){o.destroy()}}for(x=0,y=j.length;x<y;++x){n=j[x];o=C?C[n]:null;l=this.itemViewForContentIndex(n,YES);o.destroyLayer();p.replaceChild(l,o)}for(x=0,y=s.length;x<y;++x){n=s[x];l=this.itemViewForContentIndex(n,YES);p.insertBefore(l,null)}if(A){SC.Benchmark.end(A)}}else{if(A){SC.Benchmark.start(A="%@#reloadIfNeeded (Full)".fmt(this),YES)}if(C){C.length=0}f=p.get("childViews");if(f){f=f.copy()}p.beginPropertyChanges();if(this.willRemoveAllChildren){this.willRemoveAllChildren()}p.destroyLayer().removeAllChildren();if(f){for(x=0,y=f.length;x<y;++x){l=f[x];g=l.get("isGroupView");m=g?u:v;if(m){b=g?this._GROUP_VIEW_POOL:this._VIEW_POOL;b.push(l);l.destroyLayer()}else{l.destroy()}}}f=[];d.forEach(function(E){f.push(this.itemViewForContentIndex(E,YES))},this);p.set("childViews",f);p.replaceLayer();p.endPropertyChanges();if(A){SC.Benchmark.end(A)}}if(B){this.adjust(B)}if(this.didReload){this.didReload(z===YES?null:z)}return this},_TMP_ATTRS:{},_COLLECTION_CLASS_NAMES:["sc-collection-item"],_GROUP_COLLECTION_CLASS_NAMES:["sc-collection-item","sc-group-item"],_VIEW_POOL:null,_GROUP_VIEW_POOL:null,itemViewForContentIndex:function(n,a){var y;var x=this._sc_itemViews;if(!x){x=this._sc_itemViews=[]}else{if(!a&&(y=x[n])){return y}}var p=this.get("content"),s=p.objectAt(n),j=this.get("contentDelegate"),l=this.get("_contentGroupIndexes"),k=NO,z,m,t,g,u,e,b,d,w,h,f,q,v;k=l&&l.contains(n);if(k){k=j.contentIndexIsGroup(this,p,n)}if(k){z=this.get("contentGroupExampleViewKey");if(z&&s){m=s.get(z)}if(!m){m=this.get("groupExampleView")||this.get("exampleView")}u="_GROUP_VIEW_POOL"}else{z=this.get("contentExampleViewKey");if(z&&s){m=s.get(z)}if(!m){m=this.get("exampleView")}u="_VIEW_POOL"}d=this.get("containerView")||this;g=this.layerIdFor(n);w=j.contentIndexIsEnabled(this,p,n);h=j.contentIndexIsSelected(this,p,n);f=j.contentIndexOutlineLevel(this,p,n);q=j.contentIndexDisclosureState(this,p,n);v=this.isVisibleInWindow;t=this.layoutForContentIndex(n);if(m&&m.isReusableInCollections){e=this[u];if(!e){e=this[u]=[]}if(e.length>0){y=e.pop();b=y.prepareForReuse;if(b){b.call(y)}y.beginPropertyChanges();y.set("contentIndex",n);y.set("layerId",g);y.set("isEnabled",w);y.set("isSelected",h);y.set("outlineLevel",f);y.set("disclosureState",q);y.set("isVisibleInWindow",v);y.set("parentView",d);SC.View.views[g]=y;if(t){y.set("layout",t)}else{y.set("layout",m.prototype.layout)}y.set("content",s);y.endPropertyChanges()}}if(!y){var o=this._TMP_ATTRS;o.contentIndex=n;o.content=s;o.owner=o.displayDelegate=this;o.parentView=d;o.page=this.page;o.layerId=g;o.isEnabled=w;o.isSelected=h;o.outlineLevel=f;o.disclosureState=q;o.isGroupView=k;o.isVisibleInWindow=v;if(k){o.classNames=this._GROUP_COLLECTION_CLASS_NAMES}else{o.classNames=this._COLLECTION_CLASS_NAMES}if(t){o.layout=t}else{delete o.layout}y=this.createItemView(m,n,o)}x[n]=y;return y},itemViewForContentObject:function(a){return this.itemViewForContentIndex(this.get("content").indexOf(a))},_TMP_LAYERID:[],createItemView:function(d,a,b){return d.create(b)},layerIdFor:function(a){var b=this._TMP_LAYERID;b[0]=SC.guidFor(this);b[1]=a;return b.join("-")},contentIndexForLayerId:function(d){if(!d||!(d=d.toString())){return null}var b=this._baseLayerId;if(!b){b=this._baseLayerId=SC.guidFor(this)+"-"}if((d.length<=b.length)||(d.indexOf(b)!==0)){return null}var a=Number(d.slice(d.lastIndexOf("-")+1));return isNaN(a)?null:a},itemViewForEvent:function(l){var e=this.getPath("pane.rootResponder");if(!e){return null}var d=SC.guidFor(this)+"-",a=d.length,f=l.target,h=this.get("layer"),g=null,b,k,j;while(f&&f!==document&&f!==h){b=f?SC.$(f).attr("id"):null;if(b&&(g=this.contentIndexForLayerId(b))!==null){break}f=f.parentNode}if(g===null||(f===h)){f=h=null;return null}if(g>=this.get("length")){throw"layout for item view %@ was found when item view does not exist (%@)".fmt(b,this)}return this.itemViewForContentIndex(g)},expand:function(b){if(!b){return this}var a=this.get("contentDelegate"),d=this.get("content");b.forEach(function(e){var f=a.contentIndexDisclosureState(this,d,e);if(f===SC.BRANCH_CLOSED){a.contentIndexExpand(this,d,e)}},this);return this},collapse:function(b){if(!b){return this}var a=this.get("contentDelegate"),d=this.get("content");b.forEach(function(e){var f=a.contentIndexDisclosureState(this,d,e);if(f===SC.BRANCH_OPEN){a.contentIndexCollapse(this,d,e)}},this);return this},_cv_selectionDidChange:function(){var d=this.get("selection"),b=this._cv_selection,a=this._cv_selectionContentDidChange;if(d===b){return}if(b){b.removeObserver("[]",this,a)}if(d){d.addObserver("[]",this,a)}this._cv_selection=d;this._cv_selectionContentDidChange()}.observes("selection"),_cv_selectionContentDidChange:function(){var d=this.get("selection"),b=this._cv_selindexes,a=this.get("content"),e;this._cv_selindexes=d?d.frozenCopy():null;if(b){b=b.indexSetForSource(a)}if(d){d=d.indexSetForSource(a)}if(d&&b){e=d.without(b).add(b.without(d))}else{e=d||b}if(e&&e.get("length")>0){this.reloadSelectionIndexes(e)}},_invalidSelection:NO,reloadSelectionIndexes:function(a){var b=this._invalidSelection;if(a&&(b!==YES)){if(b){b.add(a)}else{b=this._invalidSelection=a.copy()}}else{this._invalidSelection=YES}if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadSelectionIndexesIfNeeded)}return this},reloadSelectionIndexesIfNeeded:function(){var f=this._invalidSelection;if(!f||!this.get("isVisibleInWindow")){return this}var e=this.get("nowShowing"),b=this._invalidIndexes,a=this.get("content"),d=this.get("selection");this._invalidSelection=NO;if(b===YES||!e){return this}if(f===YES){f=e}if(b&&b.isIndexSet){f=f.without(b)}f.forEach(function(g){if(!e.contains(g)){return}var h=this.itemViewForContentIndex(g,NO);if(h){h.set("isSelected",d?d.contains(a,g):NO)}},this);return this},select:function(d,g){var e=this.get("content"),a=this.get("selectionDelegate"),b=this.get("_contentGroupIndexes"),f;if(!this.get("isSelectable")||!this.get("isEnabled")){return this}if(SC.typeOf(d)===SC.T_NUMBER){d=SC.IndexSet.create(d,1)}if(d&&d.get("length")>0){if(b&&b.get("length")>0){d=d.copy().remove(b)}d=a.collectionViewShouldSelectIndexes(this,d,g);if(!d||d.get("length")===0){return this}}else{d=null}if(g&&(f=this.get("selection"))){f=f.copy()}else{f=SC.SelectionSet.create()}if(d&&d.get("length")>0){if(d.get("length")===1){f.addObject(e.objectAt(d.get("firstObject")))}else{f.add(e,d)}}f=a.collectionViewSelectionForProposedSelection(this,f);if(!f){f=SC.SelectionSet.create()}this._selectionAnchor=null;this.set("selection",f.freeze());return this},deselect:function(b){var e=this.get("selection"),d=this.get("content"),a=this.get("selectionDelegate");if(!this.get("isSelectable")||!this.get("isEnabled")){return this}if(!e||e.get("length")===0){return this}if(SC.typeOf(b)===SC.T_NUMBER){b=SC.IndexSet.create(b,1)}b=a.collectionViewShouldDeselectIndexes(this,b);if(!b||b.get("length")===0){return this}e=e.copy().remove(d,b);e=a.collectionViewSelectionForProposedSelection(this,e);if(!e){e=SC.SelectionSet.create()}this.set("selection",e.freeze());return this},_findNextSelectableItemFromIndex:function(j,a){var d=this.get("length"),e=SC.IndexSet.create(),f=this.get("content"),k=this.get("selectionDelegate"),h=this.get("_contentGroupIndexes"),g,b;if(!h&&(k.collectionViewShouldSelectIndexes===this.collectionViewShouldSelectIndexes)){return j}while(j<d){if(!h||!h.contains(j)){e.add(j);g=k.collectionViewShouldSelectIndexes(this,e);if(g&&g.get("length")>=1){return j}e.remove(j)}j++}if(a===undefined){b=this.get("selection");a=b?b.get("max"):-1}return a},_findPreviousSelectableItemFromIndex:function(b,j){var d=SC.IndexSet.create(),g=this.get("content"),a=this.get("selectionDelegate"),f=this.get("_contentGroupIndexes"),e;if(SC.none(b)){b=-1}if(!f&&(a.collectionViewShouldSelectIndexes===this.collectionViewShouldSelectIndexes)){return b}while(b>=0){if(!f||!f.contains(b)){d.add(b);e=a.collectionViewShouldSelectIndexes(this,d);if(e&&e.get("length")>=1){return b}d.remove(b)}b--}if(j===undefined){var h=this.get("selection");j=h?h.get("min"):-1}if(SC.none(j)){j=-1}return j},selectPreviousItem:function(j,b){if(SC.none(b)){b=1}if(SC.none(j)){j=false}var g=this.get("selection"),f=this.get("content");if(g){g=g.indexSetForSource(f)}var h=g?g.get("min"):-1,a=g?g.get("max")-1:-1,e=this._selectionAnchor;if(SC.none(e)){e=h}if(j){if(a>e){a=a-b}else{h=this._findPreviousSelectableItemFromIndex(h-b)}if(SC.none(h)||(h<0)){h=0}if(!f.objectAt(h)){h=g?g.get("min"):-1}if(a<h){a=h}}else{h=this._findPreviousSelectableItemFromIndex(h-b);if(SC.none(h)||(h<0)){h=0}if(!f.objectAt(h)){h=g?g.get("min"):-1}a=h;e=null}var d=h;g=SC.IndexSet.create(h,a+1-h);this.scrollToContentIndex(d);this.select(g);this._selectionAnchor=e;return this},selectNextItem:function(j,k){if(SC.none(k)){k=1}if(SC.none(j)){j=false}var b=this.get("selection"),h=this.get("content");if(b){b=b.indexSetForSource(h)}var a=b?b.get("min"):-1,e=b?b.get("max")-1:-1,f=this._selectionAnchor,d=this.get("length");if(SC.none(f)){f=a}if(j){if(a<f){a=a+k}else{e=this._findNextSelectableItemFromIndex(e+k,e)}if(e>=d){e=d-1}if(!h.objectAt(e)){e=b?b.get("max")-1:-1}if(a>e){a=e}}else{e=this._findNextSelectableItemFromIndex(e+k,e);if(e>=d){e=d-1}if(!h.objectAt(e)){e=b?b.get("max")-1:-1}a=e;f=null}var g=e;b=SC.IndexSet.create(a,e-a+1);this.scrollToContentIndex(g);this.select(b);this._selectionAnchor=f;return this},deleteSelection:function(){if(!this.get("canDeleteContent")){return NO}var e=this.get("selection"),d=this.get("content"),a=this.get("selectionDelegate"),b=e&&d?e.indexSetForSource(d):null;if(!d||!b||b.get("length")===0){return NO}b=a.collectionViewShouldDeleteIndexes(this,b);if(!b||b.get("length")===0){return NO}a.collectionViewDeleteContent(this,this.get("content"),b);return YES},scrollToContentIndex:function(b){var a=this.itemViewForContentIndex(b);if(a){this.scrollToItemView(a)}return this},scrollToItemView:function(a){if(a){a.scrollToVisible()}return this},keyDown:function(a){var b=this.interpretKeyEvents(a);return !b?NO:b},keyUp:function(){return true},insertText:function(b,a){if(b===" "){var d=this.get("selection");if(d&&d.get("length")>0){this.invokeLater(this._cv_action,0,null,a)}return YES}else{return NO}},selectAll:function(a){var b=this.get("content"),d=b?SC.IndexSet.create(0,b.get("length")):null;this.select(d,NO);return YES},deselectAll:function(){var a=this.get("content"),b=a?SC.IndexSet.create(0,a.get("length")):null;this.deselect(b,NO);return YES},deleteBackward:function(a){return this.deleteSelection()},deleteForward:function(a){return this.deleteSelection()},moveDown:function(b,a){this.selectNextItem(false,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveUp:function(b,a){this.selectPreviousItem(false,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveLeft:function(m){if(m.ctrlKey||m.metaKey){return NO}if((this.get("itemsPerRow")||1)>1){this.selectPreviousItem(false,1);this._cv_performSelectAction(null,m,this.ACTION_DELAY)}else{var d=this.get("selection"),k=this.get("content"),h=d?d.indexSetForSource(k):null;if(h){var n=undefined,g=false,j=undefined;if(h.get("length")===1){j=h.get("firstObject");n=this.get("contentDelegate");var b=n.contentIndexDisclosureState(this,k,j);if(b!==SC.BRANCH_OPEN){g=true}}if(g){var a=n.contentIndexOutlineLevel(this,k,j)-1;if(a>=0){var f=-1;while(f<0){var e=this._findPreviousSelectableItemFromIndex(j-1);if(e<0){return false}j=e;var l=n.contentIndexOutlineLevel(this,k,j);if(l===a){f=e}}if(f!==-1){this.select(j)}}}else{this.collapse(h)}}}return true},moveRight:function(a){if(a.ctrlKey||a.metaKey){return NO}if((this.get("itemsPerRow")||1)>1){this.selectNextItem(false,1);this._cv_performSelectAction(null,a,this.ACTION_DELAY)}else{var e=this.get("selection"),d=this.get("content"),b=e?e.indexSetForSource(d):null;if(b){this.expand(b)}}return true},moveDownAndModifySelection:function(b,a){this.selectNextItem(true,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveUpAndModifySelection:function(b,a){this.selectPreviousItem(true,this.get("itemsPerRow")||1);this._cv_performSelectAction(null,a,this.ACTION_DELAY);return true},moveLeftAndModifySelection:function(b,a){if((this.get("itemsPerRow")||1)>1){this.selectPreviousItem(true,1);this._cv_performSelectAction(null,a,this.ACTION_DELAY)}return true},moveRightAndModifySelection:function(b,a){if((this.get("itemsPerRow")||1)>1){this.selectNextItem(true,1);this._cv_performSelectAction(null,a,this.ACTION_DELAY)}return true},insertNewline:function(e,d){var b=this.get("isEditable")&&this.get("canEditContent"),h,g,j,a,f;if(b){h=this.get("selection");g=this.get("content");if(h&&h.get("length")===1){j=h.indexSetForSource(g);a=j?j.get("min"):-1;b=a>=0}}if(b){f=this.itemViewForContentIndex(a);b=f&&SC.typeOf(f.beginEditing)===SC.T_FUNCTION}if(b){this.scrollToContentIndex(a);f=this.itemViewForContentIndex(a);f.beginEditing()}else{this.invokeLater(this._cv_action,0,f,null)}return YES},insertTab:function(b){var a=this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},insertBacktab:function(b){var a=this.get("previousValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},mouseDown:function(l){var h=this.get("content");if(!h){return this.get("isSelectable")}var j=this.itemViewForEvent(l),f=j?j.get("contentIndex"):-1,d,e,b,a,m,g=NO,k=h.get("allowsMultipleSelection");if(!this.get("isEnabled")){return f>-1}if(!this.get("isSelectable")){return NO}this.becomeFirstResponder();if(this.get("useToggleSelection")){if(this.get("selectOnMouseDown")){if(!j){return}b=this.get("selection");a=b&&b.containsObject(j.get("content"));if(a){this.deselect(f)}else{if(!k){this.select(f,NO);g=YES}else{this.select(f,YES);g=YES}}if(g&&this.get("actOnSelect")){this._cv_performSelectAction(j,l)}}return YES}if(!j){if(this.get("allowDeselectAll")){this.select(null,false)}return YES}b=this.get("selection");if(b){b=b.indexSetForSource(h)}d=this.mouseDownInfo={event:l,itemView:j,contentIndex:f,at:Date.now()};a=b?b.contains(f):NO;d.modifierKeyPressed=m=l.ctrlKey||l.metaKey;if(m&&a){d.shouldDeselect=f>=0}else{if(l.shiftKey&&b&&b.get("length")>0&&k){b=this._findSelectionExtendedByShift(b,f);e=this._selectionAnchor;this.select(b);this._selectionAnchor=e}else{if(!m&&a){d.shouldReselect=f>=0}else{if((l.shiftKey||m)&&!k){this.select(null,false)}if(this.get("selectOnMouseDown")){this.select(f,m)}else{d.shouldSelect=f>=0}}}}d.previousContentIndex=f;return YES},mouseUp:function(k){var l=this.itemViewForEvent(k),e=this.mouseDownInfo,g=this.get("content"),f=l?l.get("contentIndex"):-1,d,a,b,h,m,j=g.get("allowsMultipleSelection");if(!this.get("isEnabled")){return f>-1}if(!this.get("isSelectable")){return NO}if(this.get("useToggleSelection")){if(!l||this.get("selectOnMouseDown")){return NO}d=this.get("selection");a=d&&d.containsObject(l.get("content"));if(a){this.deselect(f)}else{if(!j){this.select(f,NO)}else{this.select(f,YES)}}}else{if(e){m=e.contentIndex;f=(l)?l.get("contentIndex"):-1;if(e.shouldSelect){this.select(m,e.modifierKeyPressed)}if(e.shouldDeselect){this.deselect(m)}if(e.shouldReselect){b=this.get("isEditable")&&this.get("canEditContent");if(b){d=this.get("selection");b=d&&(d.get("length")===1)}if(b){h=this.itemViewForContentIndex(m);b=h&&(!h.contentHitTest||h.contentHitTest(k));b=(b&&h.beginEditing)?h.beginEditing():NO}if(!b){if(this._cv_reselectTimer){this._cv_reselectTimer.invalidate()}this._cv_reselectTimer=this.invokeLater(this.select,300,m,false)}}this._cleanupMouseDown()}}this._cv_performSelectAction(l,k,0,k.clickCount);return NO},_cleanupMouseDown:function(){var b=this.mouseDownInfo,a;if(b){for(a in b){if(!b.hasOwnProperty(a)){continue}delete b[a]}}this.mouseDownInfo=null},mouseMoved:function(d){var a=this.itemViewForEvent(d),b=this._lastHoveredItem;if(a!==b){if(b&&b.mouseExited){b.mouseExited(d)}if(a&&a.mouseEntered){a.mouseEntered(d)}}this._lastHoveredItem=a;if(a&&a.mouseMoved){a.mouseMoved(d)}return YES},mouseExited:function(b){var a=this._lastHoveredItem;this._lastHoveredItem=null;if(a&&a.mouseExited){a.mouseExited(b)}return YES},touchStart:function(b,a){this.mouseDown(b)},touchesDragged:function(a,b){this.mouseDragged(a)},touchEnd:function(g){var b=this._touchSelectedView,f=b?b.get("contentIndex"):-1,a=NO,d,e=this.getPath("content.allowsMultipleSelection");if(!this.get("isEnabled")){return f>-1}if(f>-1){if(this.get("useToggleSelection")){d=this.get("selection");a=d&&d.containsObject(b.get("content"))}if(a){this.deselect(f)}else{this.select(f,e?YES:NO);this._cv_performSelectAction(b,g,0)}}this._touchSelectedView=null},touchCancelled:function(a){if(this._touchSelectedView){this._touchSelectedView.set("isSelected",NO);this._touchSelectedView=null}},_findSelectionExtendedByShift:function(f,j){if(!f||f.get("length")===0){return SC.IndexSet.create(j)}var e=this.get("content"),h=e.get("length")-1,d=f.get("min"),a=f.get("max")-1,g=this.mouseDownInfo,b=this._selectionAnchor;if(SC.none(b)){b=-1}if(j<d){d=j;if(b<0){this._selectionAnchor=b=a}}else{if(j>a){a=j;if(b<0){this._selectionAnchor=b=d}}else{if(j>=d&&j<=a){if(b<0){this._selectionAnchor=b=d}if(j===b){d=a=j}else{if(j>b){d=b;a=j}else{if(j<b){d=j;a=b}}}}}}return SC.IndexSet.create(d,a-d+1)},reorderDataType:function(){return"SC.CollectionView.Reorder."+SC.guidFor(this)}.property().cacheable(),dragContent:null,proposedInsertionIndex:null,proposedDropOperation:null,mouseDragged:function(j){var k=this.get("selectionDelegate"),f=this.get("content"),a=this.get("selection"),d=this.mouseDownInfo,g=this.get("_contentGroupIndexes"),e,b,h;if(!d||d.contentIndex<0){return YES}if((Date.now()-d.at)<123){return YES}if(k.collectionViewShouldBeginDrag(this)){if(!this.get("selectOnMouseDown")){e=SC.IndexSet.create(d.contentIndex)}else{e=a?a.indexSetForSource(f):null}if(e&&g&&g.get("length")>0){e=e.copy().remove(g);if(e.get("length")===0){e=null}else{e.freeze()}}if(!e){return YES}else{e=e.frozenCopy()}e={content:f,indexes:e};this.set("dragContent",e);b=this.get("dragDataTypes");if(b&&b.get("length")>0){h=k.collectionViewDragViewFor(this,e.indexes);if(!h){h=this._cv_dragViewFor(e.indexes)}h.createLayer();SC.Drag.start({event:d.event,source:this,dragView:h,ghost:NO,ghostActsLikeCursor:k.ghostActsLikeCursor,slideBack:YES,dataSource:this});this._cleanupMouseDown();this._lastInsertionIndex=null}else{this.set("dragContent",null)}return YES}},_cv_dragViewFor:function(g){var d=this.get("nowShowing").without(g),e=this.get("layer").cloneNode(false),b=SC.View.create({layer:e,parentView:this}),a=0,f;d=this.get("nowShowing").without(d);SC.$(e).css("backgroundColor","transparent").css("border","none").css("top",0).css("left",0);d.forEach(function(k){var l=this.itemViewForContentIndex(k),h,j;if(l){h=l.get("isSelected");l.set("isSelected",NO);l.updateLayerIfNeeded();j=l.get("layer");if(j){j=j.cloneNode(true)}l.set("isSelected",h);l.updateLayerIfNeeded()}if(j){e.appendChild(j);f=l.get("layout");if(f.height+f.top>a){a=f.height+f.top}}j=null},this);b.set("layout",{height:a});e=null;return b},dragDataTypes:function(){var a=this.get("selectionDelegate"),b=a.collectionViewDragDataTypes(this),d;if(this.get("canReorderContent")){b=b?b.copy():[];d=this.get("reorderDataType");if(b.indexOf(d)<0){b.push(d)}}return b?b:[]}.property(),dragDataForType:function(d,b){if(this.get("canReorderContent")){if(b===this.get("reorderDataType")){return this.get("dragContent")}}var a=this.get("selectionDelegate");return a.collectionViewDragDataForType(this,d,b)},computeDragOperations:function(d,b){var e=SC.DRAG_NONE,a=this.get("selectionDelegate");if(this.get("canReorderContent")){if(d.get("dataTypes").indexOf(this.get("reorderDataType"))>=0){e=SC.DRAG_REORDER}}e=a.collectionViewComputeDragOperations(this,d,e);if(e&SC.DRAG_REORDER){e=SC.DRAG_MOVE}return e},_computeDropOperationState:function(d,n,f){var h=this.convertFrameFromView(d.get("location"),null),m=SC.DROP_BEFORE,o=this.get("selectionDelegate"),e=this.get("canReorderContent"),p,j,a,k,g,b;var l=this.insertionIndexForLocation(h,SC.DROP_ON);if(SC.typeOf(l)===SC.T_ARRAY){m=l[1];l=l[0]}if(m===SC.DROP_ON){this.set("proposedInsertionIndex",l);this.set("proposedDropOperation",m);b=o.collectionViewValidateDragOperation(this,d,f,l,m);l=this.get("proposedInsertionIndex");m=this.get("proposedDropOperation");this._dropInsertionIndex=this._dropOperation=null;if(b!==SC.DRAG_NONE){return[l,m,b]}else{m=SC.DROP_BEFORE;l=this.insertionIndexForLocation(h,SC.DROP_BEFORE);if(SC.typeOf(l)===SC.T_ARRAY){m=l[1];l=l[0]}}}if((l>=0)&&e&&(m!==SC.DROP_ON)){p=d.dataForType(this.get("reorderDataType"));if(p){j=this.get("content");if(m===SC.DROP_BEFORE){a=p.indexes.contains(l-1);k=p.indexes.contains(l)}else{a=p.indexes.contains(l);k=p.indexes.contains(l-1)}if(a&&k){if(SC.none(this._lastInsertionIndex)){if(m===SC.DROP_BEFORE){while((l>=0)&&p.indexes.contains(l)){l--}}else{g=j?j.get("length"):0;while((l<g)&&p.indexes.contains(l)){l++}}}else{l=this._lastInsertionIndex}}if(l>=0){f=SC.DRAG_REORDER}}}this.set("proposedInsertionIndex",l);this.set("proposedDropOperation",m);f=o.collectionViewValidateDragOperation(this,d,f,l,m);l=this.get("proposedInsertionIndex");m=this.get("proposedDropOperation");this._dropInsertionIndex=this._dropOperation=null;return[l,m,f]},dragUpdated:function(g,b){var j=g.get("allowedDragOperations"),h=this._computeDropOperationState(g,b,j),a=h[0],d=h[1],f=h[2];if(f!==SC.DRAG_NONE){if((this._lastInsertionIndex!==a)||(this._lastDropOperation!==d)){var e=this.itemViewForContentIndex(a);this.showInsertionPoint(e,d)}this._lastInsertionIndex=a;this._lastDropOperation=d}else{this.hideInsertionPoint();this._lastInsertionIndex=this._lastDropOperation=null}return(f&SC.DRAG_REORDER)?SC.DRAG_MOVE:f},dragExited:function(){this.hideInsertionPoint();this._lastInsertionIndex=this._lastDropOperation=null},acceptDragOperation:function(a,b){return YES},performDragOperation:function(f,h){var a=this._computeDropOperationState(f,null,h),m=a[0],l=a[1],j=a[2],n=this.get("selectionDelegate"),d,o,e,k,b,g;if(j&SC.DRAG_REORDER){h=(h&SC.DRAG_MOVE)?SC.DRAG_REORDER:SC.DRAG_NONE}else{h=h&j}if(h===SC.DRAG_NONE){return h}d=n.collectionViewPerformDragOperation(this,f,h,m,l);if((d===SC.DRAG_NONE)&&(h&SC.DRAG_REORDER)){e=f.dataForType(this.get("reorderDataType"));if(!e){return SC.DRAG_NONE}k=this.get("content");g=e.indexes;if(g.get("length")===1){if(((l===SC.DROP_BEFORE)||(l===SC.DROP_AFTER))&&(g.get("min")===m)){return SC.DRAG_MOVE}}k.beginPropertyChanges();o=[];e.indexes.forEach(function(p){o.push(k.objectAt(p))},this);if(l===SC.DROP_AFTER){m++}k.replace(m,0,o,l);b=0;e.indexes.forEach(function(p){if(p<m){k.removeAt(p-b);b++;m--}else{k.removeAt(p-b+o.length)}},this);this.select(SC.IndexSet.create(m,o.length));k.endPropertyChanges();h=SC.DRAG_MOVE}return h},collectionViewShouldBeginDrag:function(a){return this.get("canReorderContent")},insertionIndexForLocation:function(a,b){return -1},_cv_isVisibleInWindowDidChange:function(){if(this.get("isVisibleInWindow")){if(this._invalidIndexes){this.invokeOnce(this.reloadIfNeeded)}if(this._invalidSelection){this.invokeOnce(this.reloadSelectionIndexesIfNeeded)}}}.observes("isVisibleInWindow"),collectionViewShouldSelectItem:function(a,b){return this.get("isSelectable")},_TMP_DIFF1:SC.IndexSet.create(),_TMP_DIFF2:SC.IndexSet.create(),_cv_nowShowingDidChange:function(){var b=this.get("nowShowing"),a=this._sccv_lastNowShowing,e,f,d;if(a!==b){if(a&&b){f=this._TMP_DIFF1.add(a).remove(b);d=this._TMP_DIFF2.add(b).remove(a);e=f.add(d)}else{e=a||b}}if(e&&e.get("length")>0){this._sccv_lastNowShowing=b?b.frozenCopy():null;this.updateContentRangeObserver();this.reload(e)}if(f){f.clear()}if(d){d.clear()}}.observes("nowShowing"),init:function(){arguments.callee.base.apply(this,arguments);if(this.useFastPath){this.mixin(SC.CollectionFastPath)}if(this.get("canReorderContent")){this._cv_canReorderContentDidChange()}this._sccv_lastNowShowing=this.get("nowShowing").clone();if(this.content){this._cv_contentDidChange()}if(this.selection){this._cv_selectionDidChange()}},_cv_canReorderContentDidChange:function(){if(this.get("canReorderContent")){if(!this.get("isDropTarget")){this.set("isDropTarget",YES)}SC.Drag.addDropTarget(this)}}.observes("canReorderContent"),_cv_performSelectAction:function(b,e,d,a){var f;if(d===undefined){d=0}if(a===undefined){a=1}if((a>1)||this.get("actOnSelect")){if(this._cv_reselectTimer){this._cv_reselectTimer.invalidate()}f=this.get("selection");f=f?f.toArray():[];if(this._cv_actionTimer){this._cv_actionTimer.invalidate()}this._cv_actionTimer=this.invokeLater(this._cv_action,d,b,e,f)}},_cv_action:function(b,a,d){var e=this.get("action");var f=this.get("target")||null;this._cv_actionTimer=null;if(e){if(SC.typeOf(e)===SC.T_FUNCTION){return this.action(b,a)}var g=this.get("pane");if(g){g.rootResponder.sendAction(e,f,this,g,d)}}else{if(!b){return}else{if(SC.typeOf(b._action)==SC.T_FUNCTION){return b._action(a)}else{if(SC.typeOf(b.action)==SC.T_FUNCTION){return b.action(a)}}}}}});SC.DateFieldView=SC.TextFieldView.extend({value:null,showDate:YES,showTime:NO,formatTime:"%I:%M %p",formatDate:"%d/%m/%Y",formatDateTime:"%d/%m/%Y %I:%M %p",_dtConstants:["%a","%b","%d","%H","%I","%j","%m","%M","%p","%S","%U","%W","%y","%Y"],_wtConstants:[3,3,2,2,2,3,2,2,2,2,2,2,2,4],activeSelection:0,format:function(){var a=this.get("showTime");var b=this.get("showDate");if(a===YES&&b===YES){return this.get("formatDateTime")}if(a===YES){return this.get("formatTime")}return this.get("formatDate")}.property("showTime","showDate").cacheable(),validator:function(){return SC.Validator.DateTime.extend({format:this.get("format")})}.property("format").cacheable(),tabsSelections:function(){var g=[];var e=this.get("format");var k=this.get("_dtConstants");var b=this.get("_wtConstants");if(SC.empty(e)){throw"The format string is empty, and must be a valid string."}var h,l,d,f=0,a=0,j=0;while(f<e.length&&e.indexOf("%",f)!==-1){h=e.indexOf("%",f);l=e.substring(h,h+2);f=h+2;d=k.indexOf(l);if(d===-1){throw"SC.DateFieldView: The format's key '%@' is not supported.".fmt(l)}a=a+h-j;g.push(SC.Object.create({key:l,textSelection:SC.TextSelection.create({start:a,end:a+b[d]})}));a=a+b[d];j=f}h=l=d=null;return g}.property("format").cacheable(),updateTextSelectionObserver:function(){var a=this.get("activeSelection");var b=this.get("tabsSelections");if(this.get("isEditing")){this.selection(null,b[a].get("textSelection"))}}.observes("activeSelection","value"),updateValue:function(b,d){var f=(d===0)?-1:1;var e=this.get("value"),a;switch(b){case"%a":case"%d":case"%j":this.set("value",e.advance({day:f}));break;case"%b":case"%m":this.set("value",e.advance({month:f}));break;case"%H":case"%I":this.set("value",e.advance({hour:f}));break;case"%M":this.set("value",e.advance({minute:f}));break;case"%p":a=e.get("hour")>=12?-12:12;this.set("value",e.advance({hour:a}));break;case"%S":this.set("value",e.advance({second:f}));break;case"%U":this.set("value",e.advance({week1:f}));break;case"%W":this.set("value",e.advance({week0:f}));break;case"%y":case"%Y":this.set("value",e.advance({year:f}));break}},_selectRootElement:function(){},keyDown:function(a){if(this.interpretKeyEvents(a)){a.stop();return YES}return arguments.callee.base.apply(this,arguments)},ctrl_a:function(){return YES},moveUp:function(b){var a=this.get("activeSelection");var d=this.get("tabsSelections");this.updateValue(d[a].get("key"),1);return YES},moveDown:function(b){var a=this.get("activeSelection");var d=this.get("tabsSelections");this.updateValue(d[a].get("key"),0);return YES},insertText:function(a){return YES},moveRight:function(a){var d=this.get("tabsSelections");var b=this.get("activeSelection")+1;if(b===d.length){b=0}this.set("activeSelection",b);return YES},moveLeft:function(a){var d=this.get("tabsSelections");var b=this.get("activeSelection")-1;if(b===-1){b=d.length-1}this.set("activeSelection",b);return YES},insertTab:function(a){var d=this.get("tabsSelections");var b=this.get("activeSelection")+1;if(b<d.length){this.set("activeSelection",b);return YES}return NO},insertBacktab:function(a){var b=this.get("activeSelection")-1;if(b!==-1){this.set("activeSelection",b);return YES}return NO},mouseUp:function(b){var d=arguments.callee.base.apply(this,arguments);var f=this.get("selection");if(SC.none(f)){this.set("activeSelection",0)}else{var j=f.get("start");var h=this.get("tabsSelections");var a=h.length,g;for(var e=0;e<a;e++){g=h[e].get("textSelection");if(j>=g.get("start")&&j<=g.get("end")){this.set("activeSelection",e)}}}return d},deleteBackward:function(a){return YES},deleteForward:function(a){return YES}});SC.DisclosureView=SC.ButtonView.extend({classNames:["sc-disclosure-view"],renderDelegateName:"disclosureRenderDelegate",buttonBehavior:SC.TOGGLE_BEHAVIOR,toggleOnValue:YES,toggleOffValue:NO,valueBindingDefault:SC.Binding.bool(),keyDown:function(a){if(a.which===37||a.which===38){this.set("value",this.get("toggleOffValue"));return YES}if(a.which===39||a.which===40){this.set("value",this.get("toggleOnValue"));return YES}arguments.callee.base.apply(this,arguments)}});sc_require("views/collection");sc_require("mixins/collection_row_delegate");SC.ListView=SC.CollectionView.extend(SC.CollectionRowDelegate,{classNames:["sc-list-view"],acceptsFirstResponder:YES,showAlternatingRows:NO,render:function(a,b){a.setClass("alternating",this.get("showAlternatingRows"));return arguments.callee.base.apply(this,arguments)},rowDelegate:function(){var a=this.delegate,b=this.get("content");return this.delegateFor("isCollectionRowDelegate",a,b)}.property("delegate","content").cacheable(),_sclv_rowDelegateDidChange:function(){var e=this._sclv_rowDelegate,b=this.get("rowDelegate"),d=this._sclv_rowHeightDidChange,a=this._sclv_customRowHeightIndexesDidChange;if(e===b){return this}this._sclv_rowDelegate=b;if(e){e.removeObserver("rowHeight",this,d);e.removeObserver("customRowHeightIndexes",this,a)}if(!b){throw"Internal Inconsistancy: ListView must always have CollectionRowDelegate"}b.addObserver("rowHeight",this,d);b.addObserver("customRowHeightIndexes",this,a);this._sclv_rowHeightDidChange()._sclv_customRowHeightIndexesDidChange();return this}.observes("rowDelegate"),_sclv_rowHeightDidChange:function(){var b=this.get("rowDelegate"),a=b.get("rowHeight"),d;if(a===this._sclv_rowHeight){return this}this._sclv_rowHeight=a;d=SC.IndexSet.create(0,this.get("length"));this.rowHeightDidChangeForIndexes(d);return this},_sclv_customRowHeightIndexesDidChange:function(){var a=this.get("rowDelegate"),b=a.get("customRowHeightIndexes"),e=this._sclv_customRowHeightIndexes,d=this._sclv_customRowHeightIndexesContentDidChange;if((b===e)||(e&&e.isEqual(b))){return this}if(e&&this._sclv_isObservingCustomRowHeightIndexes){e.removeObserver("[]",this,d)}if(this._sclv_isObservingCustomRowHeightIndexes=b&&!b.get("isFrozen")){b.addObserver("[]",this,d)}this._sclv_customRowHeightIndexesContentDidChange();return this},_sclv_customRowHeightIndexesContentDidChange:function(){var a=this.get("rowDelegate"),b=a.get("customRowHeightIndexes"),d=this._sclv_customRowHeightIndexes,e;if(b&&d){e=b.copy().add(d)}else{e=b||d}this._sclv_customRowHeightIndexes=b?b.frozenCopy():null;this.rowHeightDidChangeForIndexes(e);return this},rowOffsetForContentIndex:function(j){if(j===0){return 0}var l=this.get("rowDelegate"),a=l.get("rowHeight"),g,f,d,b,k,h,e;f=j*a;g=this.get("rowSpacing");if(g){f+=j*g}if(l.customRowHeightIndexes&&(d=l.get("customRowHeightIndexes"))){b=this._sclv_offsetCache;if(!b){b=[];k=h=0;d.forEach(function(m){k+=this.rowHeightForContentIndex(m)-a;b[m+1]=k;h=m},this);this._sclv_max=h+1;this._sclv_offsetCache=b}k=b[j];if(k===undefined){k=b[j]=b[j-1];if(k===undefined){h=this._sclv_max;if(j<h){h=d.indexBefore(j)+1}k=b[j]=b[h]||0}}f+=k}return f},rowHeightForContentIndex:function(a){var b=this.get("rowDelegate"),f,d,g,e;if(b.customRowHeightIndexes&&(e=b.get("customRowHeightIndexes"))){d=this._sclv_heightCache;if(!d){d=[];g=this.get("content");e.forEach(function(h){d[h]=b.contentIndexRowHeight(this,g,h)},this);this._sclv_heightCache=d}f=d[a];if(f===undefined){f=b.get("rowHeight")}}else{f=b.get("rowHeight")}return f},rowHeightDidChangeForIndexes:function(b){var a=this.get("length");this._sclv_heightCache=this._sclv_offsetCache=null;if(b&&b.isIndexSet){b=b.get("min")}this.reload(SC.IndexSet.create(b,a-b));return this},_sclv_lengthDidChange:function(){this.adjust(this.computeLayout())}.observes("length"),computeLayout:function(){var a=this._sclv_layout;if(!a){a=this._sclv_layout={}}a.minHeight=this.rowOffsetForContentIndex(this.get("length"));this.set("calculatedHeight",a.minHeight);return a},layoutForContentIndex:function(b){var a=this.get("rowDelegate");return{top:this.rowOffsetForContentIndex(b),height:this.rowHeightForContentIndex(b)-a.get("rowPadding")*2,left:0,right:0}},contentIndexesInRect:function(j){var a=this.get("rowDelegate").get("rowHeight"),h=SC.minY(j),b=SC.maxY(j),k=j.height||0,g=this.get("length"),f,d,e;d=(h-(h%a))/a;f=this.rowOffsetForContentIndex(d);while(d>0&&f>h){d--;f-=this.rowHeightForContentIndex(d)}f+=this.rowHeightForContentIndex(d);while(d<g&&f<=h){d++;f+=this.rowHeightForContentIndex(d)}if(d<0){d=0}if(d>=g){d=g}e=d+((k-(k%a))/a);if(e>g){e=g}f=this.rowOffsetForContentIndex(e);while(e>=d&&f>=b){e--;f-=this.rowHeightForContentIndex(e)}f+=this.rowHeightForContentIndex(e);while(e<g&&f<b){e++;f+=this.rowHeightForContentIndex(e)}e++;if(e<d){e=d}if(e>g){e=g}return SC.IndexSet.create(d,e-d)},insertionPointView:SC.View.extend({classNames:"sc-list-insertion-point",render:function(a,b){if(b){a.push('<div class="anchor"></div>')}}}),showInsertionPoint:function(h,g){var j=this._insertionPointView;if(!j){j=this._insertionPointView=this.get("insertionPointView").create()}var e=h.get("contentIndex"),f=this.get("length"),d=SC.clone(h.get("layout")),a=h.get("outlineLevel"),b=h.get("outlineIndent")||0,k;if((e>=f)&&e>0){k=this.itemViewForContentIndex(f-1);if(k.get("isGroupView")){a=1;b=k.get("outlineIndent")}}if(SC.none(a)){a=-1}if(g&SC.DROP_ON){if(h!==this._lastDropOnView){this.hideInsertionPoint();h.set("isDropTarget",YES);this._lastDropOnView=h}}else{if(this._lastDropOnView){this._lastDropOnView.set("isDropTarget",NO);this._lastDropOnView=null}if(g&SC.DROP_AFTER){d.top+=d.height}d.height=2;d.right=0;d.left=((a+1)*b)+12;delete d.width;j.set("layout",d);this.appendChild(j)}},hideInsertionPoint:function(){if(this._lastDropOnView){this._lastDropOnView.set("isDropTarget",NO);this._lastDropOnView=null}var a=this._insertionPointView;if(a){a.removeFromParent().destroy()}this._insertionPointView=null},insertionIndexForLocation:function(h,m){var b={x:h.x,y:h.y,width:1,height:1},g=this.contentIndexesInRect(b),j=g.get("min"),k=this.get("length"),d,n,o,f,q,e,p,l,a;if(SC.none(j)||j<0){if((k===0)||(h.y<=this.rowOffsetForContentIndex(0))){j=0}else{if(h.y>=this.rowOffsetForContentIndex(k)){j=k}}}d=this.rowOffsetForContentIndex(j);n=d+this.rowHeightForContentIndex(j);if(m==SC.DROP_ON){if(this.get("isEditable")){o=Math.min(Math.floor((n-d)*0.2),5)}else{o=0}if(h.y>=(d+o)||h.y<=(n+o)){return[j,SC.DROP_ON]}}if(j>0){l=this.itemViewForContentIndex(j-1);p=(l?l.get("outlineIndent"):0)||0;e=l?l.get("outlineLevel"):0;if(j<k){l=this.itemViewForContentIndex(j);f=l?l.get("outlineLevel"):0;q=(l?l.get("outlineIndent"):0)||0;q*=f}else{f=l.get("isGroupView")?1:0;q=p*f}p*=e;if((f!==e)&&(q!==p)){if(p>q){j--;m=SC.DROP_AFTER}}}if(m===SC.DROP_BEFORE){l=(j<k)?this.itemViewForContentIndex(j):null;if(!l||l.get("isGroupView")){if(j>0){l=this.itemViewForContentIndex(j-1);if(!l.get("isGroupView")||(l.get("disclosureState")===SC.BRANCH_OPEN)){j=j-1;m=SC.DROP_AFTER}else{j=-1}}else{j=-1}}if(j<0){m=SC.DRAG_NONE}}return[j,m]},mouseWheel:function(a){var b=SC.InlineTextFieldView.editor;if(b&&b.get("isEditing")){if(b.get("delegate").get("displayDelegate")===this){SC.InlineTextFieldView.commitEditing()}}return NO},init:function(){arguments.callee.base.apply(this,arguments);this._sclv_rowDelegateDidChange()}});sc_require("views/list");SC.GridView=SC.ListView.extend({classNames:["sc-grid-view"],layout:{left:0,right:0,top:0,bottom:0},rowHeight:48,columnWidth:64,exampleView:SC.LabelView,insertionOrientation:SC.HORIZONTAL_ORIENTATION,itemsPerRow:function(){var b=this.get("frame"),a=this.get("columnWidth")||0;return(a<=0)?1:Math.floor(b.width/a)}.property("frame","columnWidth").cacheable(),contentIndexesInRect:function(f){var e=this.get("rowHeight")||48,b=this.get("itemsPerRow"),d=Math.floor(SC.minY(f)/e)*b,a=Math.ceil(SC.maxY(f)/e)*b;return SC.IndexSet.create(d,a-d)},layoutForContentIndex:function(h){var e=this.get("rowHeight")||48,a=this.get("frame").width,b=this.get("itemsPerRow"),f=Math.floor(a/b),g=Math.floor(h/b),d=h-(b*g);return{left:d*f,top:g*e,height:e,width:f}},computeLayout:function(){var f=this.get("content"),e=(f)?f.get("length"):0,d=this.get("rowHeight")||48,a=this.get("itemsPerRow"),g=Math.ceil(e/a);var b=this._cachedLayoutHash;if(!b){b=this._cachedLayoutHash={}}b.minHeight=g*d;this.calculatedHeight=b.minHeight;return b},insertionPointClass:SC.View.extend({classNames:["grid-insertion-point"],render:function(a,b){if(b){a.push('<span class="anchor"></span>')}}}),showInsertionPoint:function(d,g){if(!d){return}if(g&SC.DROP_ON){if(d!==this._lastDropOnView){this.hideInsertionPoint();d.set("isDropTarget",YES);this._lastDropOnView=d}}else{if(this._lastDropOnView){this._lastDropOnView.set("isDropTarget",NO);this._lastDropOnView=null}if(!this._insertionPointView){this._insertionPointView=this.insertionPointClass.create()}var b=this._insertionPointView;var a=d.get("frame");var e={height:a.height-6,x:a.x,y:a.y+6,width:0};if(!SC.rectsEqual(b.get("frame"),e)){b.set("frame",e)}if(b.parentNode!==d.parentNode){d.parentNode.appendChild(b)}}},hideInsertionPoint:function(){if(this._lastDropOnView){this._lastDropOnView.set("isDropTarget",NO);this._lastDropOnView=null}var a=this._insertionPointView;if(a){a.removeFromParent().destroy()}this._insertionPointView=null},insertionIndexForLocation:function(e,l){var g=this.get("frame"),h=this.get("clippingFrame"),m=this.get("itemsPerRow"),a=Math.floor(g.width/m),o=Math.floor((e.y-g.y-h.y)/this.get("rowHeight"));var k=SC.DROP_BEFORE,d=(e.x-g.x-h.x),b=Math.floor(d/a),n=(d/a)-b;if(l===SC.DROP_ON){if(n>0.8){b++}if((n>=0.2)&&(n<=0.8)){k=SC.DROP_ON}}else{if(n>0.45){b++}}var j=(o*m)+b;return[j,k]},_gv_frameDidChange:function(){var f=this.get("frame"),d;d=f.width;if(this._lastFrameWidth&&d!==this._lastFrameWidth){this.notifyPropertyChange("itemsPerRow");var a,b,e=this.get("nowShowing");e.forEach(function(g){b=this.itemViewForContentIndex(g);b.adjust(this.layoutForContentIndex(g))},this)}this._lastFrameWidth=d}.observes("frame")});SC.ImageButtonView=SC.ButtonView.extend({classNames:["sc-image-button-view"],themeName:null,renderDelegateName:"imageButtonRenderDelegate",displayProperties:["image"],image:null});SC.ANCHOR_TOP={top:0};SC.ANCHOR_LEFT={left:0};SC.ANCHOR_TOP_LEFT={top:0,left:0};SC.ANCHOR_BOTTOM={bottom:0};SC.ANCHOR_RIGHT={right:0};SC.ANCHOR_BOTTOM_RIGHT={bottom:0,right:0};SC.ToolbarView=SC.View.extend({classNames:["sc-toolbar-view"],ariaRole:"toolbar",renderDelegateName:"toolbarRenderDelegate",anchorLocation:null,layout:{left:0,height:32,right:0},init:function(){if(this.anchorLocation){this.layout=SC.merge(this.layout,this.anchorLocation)}arguments.callee.base.apply(this,arguments)}});sc_require("views/toolbar");SC.WorkspaceView=SC.View.extend({classNames:["sc-workspace-view"],displayProperties:["hasTopToolbar","hasBottomToolbar"],renderDelegateName:"workspaceRenderDelegate",topToolbar:SC.ToolbarView.extend(),bottomToolbar:null,contentView:SC.View.extend(),autoResizeToolbars:NO,defaultToolbarSize:44,largeToolbarSize:44,smallToolbarSize:30,toolbarSize:function(){if(!this.get("autoResizeToolbars")){return this.get("defaultToolbarSize")}if(this.get("orientation")===SC.HORIZONTAL_ORIENTATION){return this.get("smallToolbarSize")}return this.get("largeToolbarSize")}.property("autoHideMaster","orientation"),orientation:function(){var a=this.get("frame");if(a.width>a.height){return SC.HORIZONTAL_ORIENTATION}else{return SC.VERTICAL_ORIENTATION}}.property("frame").cacheable(),masterIsHidden:NO,masterIsHiddenDidChange:function(){var a,b=this.get("masterIsHidden");if(a=this.get("topToolbar")){a.set("masterIsHidden",b)}if(a=this.get("bottomToolbar")){a.set("masterIsHidden",b)}}.observes("masterIsHidden"),_scmd_tilePropertyDidChange:function(){this.invokeOnce("_scws_tile")}.observes("toolbarSize"),createChildViews:function(){arguments.callee.base.apply(this,arguments);var a=this.get("topToolbar");if(a){a=this.topToolbar=this.activeTopToolbar=this.createChildView(a);this.appendChild(a)}var d=this.get("bottomToolbar");if(d){d=this.bottomToolbar=this.activeBottomToolbar=this.createChildView(d);this.appendChild(d)}var b=this.get("contentView");b=this.contentView=this.activeContentView=this.createChildView(b);this.appendChild(b);this.invokeOnce("_scws_tile")},_scws_tile:function(){var b=0,f=0,a=this.get("topToolbar"),g=this.get("bottomToolbar"),e=this.get("contentView"),d=this.get("toolbarSize");if(a){a.set("layout",{left:0,right:0,top:0,height:d});b+=d}if(g){g.set("layout",{left:0,right:0,bottom:0,height:d});f+=d}this.contentView.set("layout",{left:0,right:0,top:b,bottom:f})},hasTopToolbar:function(){if(this.get("topToolbar")){return YES}return NO}.property("topToolbar").cacheable(),hasBottomToolbar:function(){if(this.get("bottomToolbar")){return YES}return NO}.property("bottomToolbar").cacheable(),childDidChange:function(){this._scws_tile()},activeTopToolbar:null,activeBottomToolbar:null,activeContentView:null,topToolbarDidChange:function(){var b=this.activeTopToolbar,a=this.get("topToolbar");if(b){this.removeChild(b)}if(a){this.appendChild(a)}this.activeTopToolbar=a;this.invokeLast("childDidChange")}.observes("topToolbar"),bottomToolbarDidChange:function(){var b=this.activeBottomToolbar,a=this.get("bottomToolbar");if(b){this.removeChild(b)}if(a){this.appendChild(a)}this.activeBottomToolbar=a;this.invokeLast("childDidChange")}.observes("bottomToolbar"),contentViewDidChange:function(){var b=this.activeContentView,a=this.get("contentView");if(b){this.removeChild(b)}if(a){this.appendChild(a)}this.activeContentView=a;this.invokeLast("childDidChange")}.observes("contentView")});sc_require("views/workspace");sc_require("views/toolbar");SC.MasterDetailView=SC.View.extend({classNames:["sc-master-detail-view"],renderDelegateName:"masterDetailRenderDelegate",masterView:SC.WorkspaceView.extend({topToolbar:SC.ToolbarView.extend({}),contentView:SC.View.extend({backgroundColor:"white"})}),detailView:SC.WorkspaceView.extend({topToolbar:SC.ToolbarView.extend({childViews:["showHidePicker"],showHidePicker:SC.ButtonView.extend({layout:{left:7,centerY:0,height:30,width:100},controlSize:SC.AUTO_CONTROL_SIZE,title:"Picker",action:"toggleMasterPicker",isVisible:NO,isVisibleBinding:".parentView.masterIsHidden"})})}),autoHideMaster:function(){if(SC.platform.touch){return YES}return NO}.property().cacheable(),masterWidth:250,dividerWidth:SC.propertyFromRenderDelegate("dividerWidth",1),masterIsHidden:function(){if(!this.get("autoHideMaster")){return NO}if(this.get("orientation")===SC.HORIZONTAL_ORIENTATION){return NO}return YES}.property("autoHideMaster","orientation"),orientation:SC.VERTICAL_ORIENTATION,_scmd_frameDidChange:function(){var b=this.get("frame"),a;if(b.width>b.height){a=SC.HORIZONTAL_ORIENTATION}else{a=SC.VERTICAL_ORIENTATION}this.setIfChanged("orientation",a)}.observes("frame"),init:function(){arguments.callee.base.apply(this,arguments);this._scmd_frameDidChange();this._scmd_masterIsHiddenDidChange()},toggleMasterPicker:function(a){if(!this.get("masterIsHidden")){return}if(this._picker&&this._picker.get("isVisibleInWindow")){this.hideMasterPicker()}else{this.showMasterPicker(a)}},showMasterPicker:function(b){if(this._picker&&this._picker.get("isVisibleInWindow")){return}if(!this._picker){var a=this.get("pickerPane");this._picker=a.create({})}this._picker.set("contentView",this.get("masterView"));this._picker.set("extraRightOffset",this.get("pointerDistanceFromEdge"));this.showPicker(this._picker,b)},hideMasterPicker:function(){if(this._picker&&this._picker.get("isVisibleInWindow")){this.hidePicker(this._picker)}},showPicker:function(b,a){b.popup(a,SC.PICKER_POINTER,[3,0,1,2,3],[9,-9,-18,18])},hidePicker:function(a){a.remove()},pickerPane:SC.PickerPane.extend({layout:{width:250,height:480},themeName:"popover"}),_picker:null,pointerDistanceFromEdge:46,_scmd_masterIsHiddenDidChange:function(){var a=this.get("masterIsHidden");this.get("masterView").set("masterIsHidden",a);this.get("detailView").set("masterIsHidden",a)}.observes("masterIsHidden"),_scmd_orientationDidChange:function(){this.invokeOnce("_scmd_tile")}.observes("orientation"),_scmd_retileProperties:function(){this.invokeOnce("_scmd_tile")}.observes("masterIsHidden","masterWidth"),createChildViews:function(){var b=this.get("masterView");b=this.masterView=this.createChildView(b);var a=this.get("detailView");a=this.detailView=this.createChildView(a);this.appendChild(a);this.invokeOnce("_scmd_tile")},_masterIsDrawn:NO,_scmd_tile:function(){var b=!this.get("masterIsHidden");var f=this.get("masterWidth"),e=this.get("masterView"),d=this.get("detailView");if(b){this.hideMasterPicker();if(!this._masterIsDrawn){if(this._picker){this._picker.set("contentView",null)}this.appendChild(e);this._masterIsDrawn=YES}e.set("layout",{left:0,top:0,bottom:0,width:f});var a=this.get("dividerWidth");d.set("layout",{left:f+a,right:0,top:0,bottom:0})}else{if(this._masterIsDrawn){this.removeChild(e);this._masterIsDrawn=NO}d.set("layout",{left:0,right:0,top:0,bottom:0})}}});SC.ScrollerView=SC.View.extend({classNames:["sc-scroller-view"],displayProperties:["thumbPosition","thumbLength","isEnabled","controlsHidden"],ariaRole:"scrollbar",shouldScrollToClick:NO,_touchScrollValue:NO,value:function(a,d){var b=this.get("minimum");if(d!==undefined){this._scs_value=d}d=this._scs_value||b;return Math.max(Math.min(d,this.get("maximum")),b)}.property("maximum","minimum").cacheable(),displayValue:function(){var a;if(this.get("_touchScrollValue")){a=this.get("_touchScrollValue")}else{a=this.get("value")}return a}.property("value","_touchScrollValue").cacheable(),proportion:0,maximum:100,minimum:0,isEnabled:function(a,b){if(b!==undefined){this._scsv_isEnabled=b}if(this._scsv_isEnabled!==undefined){return this._scsv_isEnabled}return this.get("proportion")<1}.property("proportion").cacheable(),_scsv_isEnabled:undefined,layoutDirection:SC.LAYOUT_VERTICAL,hasButtons:YES,scrollbarThickness:14,capLength:18,capOverlap:14,buttonLength:41,buttonOverlap:11,minimumThumbLength:20,render:function(d,a){var k="vertical",b={},m="",s=this.get("parentView"),j=this.get("layoutDirection"),f,o,h,g,p,n,l,e,q;switch(j){case SC.LAYOUT_VERTICAL:b["sc-vertical"]=YES;break;case SC.LAYOUT_HORIZONTAL:b["sc-horizontal"]=YES;k="horizontal";break}b.disabled=!this.get("isEnabled");b["controls-hidden"]=this.get("controlsHidden");d.setClass(b);o=this.get("thumbLength");f=this.get("thumbPosition");if(a){this._thumbPosition=null;this._thumbSize=null;d.push('<div class="track"></div>','<div class="cap"></div>');this.renderButtons(d,this.get("hasButtons"));this.renderThumb(d,j,o,f);d.attr("aria-orientation",k);d.attr("aria-valuemax",this.get("maximum"));d.attr("aria-valuemin",this.get("minimum"));d.attr("aria-valuenow",this.get("value"));d.attr("aria-controls",s.getPath("contentView.layerId"))}else{if(this.get("controlsHidden")){return}g=this.$(".thumb");this.adjustThumb(g,f,o);d.attr("aria-valuenow",this.get("value"))}},renderThumb:function(e,f,b,d){var a;if(f===SC.LAYOUT_HORIZONTAL){a="width: "+b+"px; left: "+d+"px;"}else{a="height: "+b+"px; top: "+d+"px;"}e.push('<div class="thumb" style="%@">'.fmt(a),'<div class="thumb-center"></div>','<div class="thumb-top"></div>','<div class="thumb-bottom"></div></div>')},renderButtons:function(b,a){if(a){b.push('<div class="button-bottom"></div><div class="button-top"></div>')}else{b.push('<div class="endcap"></div>')}},touchScrollDidStart:function(a){this.set("_touchScrollValue",a)},touchScrollDidEnd:function(a){this.set("_touchScrollValue",NO)},touchScrollDidChange:function(a){this.set("_touchScrollValue",a)},adjustThumb:function(b,a,d){this.adjustThumbPosition(b,a);this.adjustThumbSize(b,d)},adjustThumbPosition:function(b,a){if(this._thumbPosition===a){return}switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:b.css("top",a);break;case SC.LAYOUT_HORIZONTAL:b.css("left",a);break}this._thumbPosition=a},adjustThumbSize:function(a,b){if(this._thumbSize===b){return}switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:a.css("height",Math.max(b,this.get("minimumThumbLength")));break;case SC.LAYOUT_HORIZONTAL:a.css("width",Math.max(b,this.get("minimumThumbLength")));break}this._thumbSize=b},trackLength:function(){var a=this.get("scrollerLength");a-=this.capLength-this.capOverlap;a-=this.buttonLength-this.buttonOverlap;return a}.property("scrollerLength").cacheable(),scrollerLength:function(){switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:return this.get("frame").height;case SC.LAYOUT_HORIZONTAL:return this.get("frame").width}return 0}.property("frame").cacheable(),thumbLength:function(){var a;a=Math.floor(this.get("trackLength")*this.get("proportion"));a=isNaN(a)?0:a;return Math.max(a,this.get("minimumThumbLength"))}.property("trackLength","proportion").cacheable(),thumbPosition:function(){var h=this.get("displayValue"),d=this.get("maximum"),b=this.get("trackLength"),e=this.get("thumbLength"),g=this.get("capLength"),f=this.get("capOverlap"),a;a=(h/d)*(b-e);a+=g-f;return Math.floor(isNaN(a)?0:a)}.property("displayValue","maximum","trackLength","thumbLength").cacheable(),controlsHidden:function(){return this.get("proportion")>=1}.property("proportion").cacheable(),valueForPosition:function(h){var b=this.get("maximum"),a=this.get("trackLength"),d=this.get("thumbLength"),g=this.get("capLength"),e=this.get("capOverlap"),f;f=h-(g-e);f=f/(a-d);f=f*b;return f},mouseDown:function(l){if(!this.get("isEnabled")){return NO}this._altIsDown=l.altKey;this._shiftIsDown=l.shiftKey;var f=l.target,d=this.get("thumbPosition"),k,e,h,g=this.get("scrollerLength");if(f.className.indexOf("thumb")>=0){e=this.convertFrameFromView({x:l.pageX,y:l.pageY});e.x-=d;e.y-=d;this._thumbDragging=YES;this._thumbOffset=e;this._mouseDownLocation={x:l.pageX,y:l.pageY};this._thumbPositionAtDragStart=this.get("thumbPosition");this._valueAtDragStart=this.get("value")}else{if(f.className.indexOf("button-top")>=0){this.decrementProperty("value",(this._altIsDown?g:30));this.makeButtonActive(".button-top");this.startMouseDownTimer("scrollUp");this._isScrollingUp=YES}else{if(f.className.indexOf("button-bottom")>=0){this.incrementProperty("value",(this._altIsDown?g:30));this.makeButtonActive(".button-bottom");this.startMouseDownTimer("scrollDown");this._isScrollingDown=YES}else{var n=this.get("shouldScrollToClick");if(l.altKey){n=!n}var a=this.get("trackLength"),j=this.get("thumbLength"),b=this.convertFrameFromView({x:l.pageX,y:l.pageY}),m;switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:this._mouseDownLocation=m=b.y;break;case SC.LAYOUT_HORIZONTAL:this._mouseDownLocation=m=b.x;break}if(n){this.set("value",this.valueForPosition(m-(j/2)));d=this.get("thumbPosition");this._thumbDragging=YES;this._thumbOffset={x:b.x-d,y:b.y-d};this._mouseDownLocation={x:l.pageX,y:l.pageY};this._thumbPositionAtDragStart=d;this._valueAtDragStart=this.get("value")}else{if(m<d){this.decrementProperty("value",g);this.startMouseDownTimer("page")}else{this.incrementProperty("value",g);this.startMouseDownTimer("page")}}}}}return YES},mouseUp:function(a){var d=this._scs_buttonActive,b=NO,e;if(d){d.removeClass("active");b=YES}e=this._mouseDownTimer;if(e){e.invalidate();this._mouseDownTimer=null}this._thumbDragging=NO;this._isScrollingDown=NO;this._isScrollingUp=NO;return b},mouseDragged:function(o){var m,b,n,d,k=o.target,f=this._thumbPositionAtDragStart,h=this._isScrollingUp,q=this._isScrollingDown,e=this._scs_buttonActive,a;if(this._thumbDragging){switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:n=(o.pageY-this._mouseDownLocation.y);break;case SC.LAYOUT_HORIZONTAL:n=(o.pageX-this._mouseDownLocation.x);break}if(o.altKey){if(!this._altIsDown||(this._shiftIsDown!==o.shiftKey)){f=this._thumbPositionAtDragStart=f+n;n=0;this._mouseDownLocation={x:o.pageX,y:o.pageY};this._valueAtDragStart=this.get("value")}if(o.shiftKey){n=-n}this.set("value",Math.round(this._valueAtDragStart+n*2))}else{d=f+n;b=this.get("trackLength")-this.get("thumbLength");this.set("value",Math.round((d/b)*this.get("maximum")))}}else{if(h||q){var p=NO,g=NO;var l=this.$(".button-top")[0].getBoundingClientRect();var j=this.$(".button-bottom")[0].getBoundingClientRect();switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:if(o.clientY<l.bottom){p=YES}else{g=YES}break;case SC.LAYOUT_HORIZONTAL:if(o.clientX<l.right){p=YES}else{g=YES}break}if((p||g)&&p!==h){if(e){e.removeClass("active")}this._mouseDownTimerAction=p?"scrollUp":"scrollDown";if(p){this.makeButtonActive(".button-top")}else{if(g){this.makeButtonActive(".button-bottom")}}this._isScrollingUp=p;this._isScrollingDown=g}}}this._altIsDown=o.altKey;this._shiftIsDown=o.shiftKey;return YES},startMouseDownTimer:function(b,a){var d;this._mouseDownTimerAction=b;this._mouseDownTimer=SC.Timer.schedule({target:this,action:this.mouseDownTimerDidFire,interval:a?0:300})},mouseDownTimerDidFire:function(){var e=this.get("scrollerLength"),a=SC.device.get("mouseLocation"),d=this.get("thumbPosition"),b=this.get("thumbLength"),f=50;switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:a=this.convertFrameFromView(a).y;break;case SC.LAYOUT_HORIZONTAL:a=this.convertFrameFromView(a).x;break}switch(this._mouseDownTimerAction){case"scrollDown":this.incrementProperty("value",this._altIsDown?e:30);break;case"scrollUp":this.decrementProperty("value",this._altIsDown?e:30);break;case"page":f=150;if(a<d){this.decrementProperty("value",e)}else{if(a>d+b){this.incrementProperty("value",e)}}}this._mouseDownTimer=SC.Timer.schedule({target:this,action:this.mouseDownTimerDidFire,interval:f})},makeButtonActive:function(a){this._scs_buttonActive=this.$(a).addClass("active")}});SC.TouchScrollerView=SC.ScrollerView.extend({classNames:["sc-touch-scroller-view"],scrollbarThickness:12,capLength:5,capOverlap:0,hasButtons:NO,buttonOverlap:36,adjustThumb:function(e,b,g){var d=this.$(".thumb-inner");var a=this.get("scrollerLength")-this.capLength,f=this.get("minimum")+this.capLength;if(b+g>a){b=Math.min(a-20,b);g=a-b}if(b<f){g-=f-b;b=f}switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:if(this._thumbPosition!==b){e.css("-webkit-transform","translate3d(0px,"+b+"px,0px)")}if(this._thumbSize!==g){d.css("-webkit-transform","translate3d(0px,"+Math.round(g-1044)+"px,0px)")}break;case SC.LAYOUT_HORIZONTAL:if(this._thumbPosition!==b){e.css("-webkit-transform","translate3d("+b+"px,0px,0px)")}if(this._thumbSize!==g){d.css("-webkit-transform","translate3d("+Math.round(g-1044)+"px,0px,0px)")}break}this._thumbPosition=b;this._thumbSize=g;arguments.callee.base.apply(this,arguments)},render:function(d,a){var b=[],f,l,h,g,m,k,j,e,n;switch(this.get("layoutDirection")){case SC.LAYOUT_VERTICAL:b.push("sc-vertical");break;case SC.LAYOUT_HORIZONTAL:b.push("sc-horizontal");break}if(!this.get("isEnabled")){b.push("disabled")}if(this.get("controlsHidden")){b.push("controls-hidden")}d.addClass(b);l=this.get("thumbLength");f=this.get("thumbPosition");if(a){this._thumbPosition=null;this._thumbSize=null;d.push('<div class="track"></div><div class="cap"></div>');this.renderButtons(d,this.get("hasButtons"));this.renderThumb(d,this.get("layoutDirection"),l)}else{if(this.get("controlsHidden")){return}g=this.$(".thumb");this.adjustThumb(g,f,l)}},renderThumb:function(b,d,a){a-=1044;d=(d===SC.LAYOUT_HORIZONTAL?"X":"Y");b.push('<div class="thumb"><div class="thumb-top"></div><div class="thumb-clip">'+'<div class="thumb-inner" style="-webkit-transform: translate%@(%@px);">'.fmt(d,a)+'<div class="thumb-center"></div><div class="thumb-bottom"></div></div></div></div>')}});sc_require("views/scroller");SC.NORMAL_SCROLL_DECELERATION=0.95;SC.FAST_SCROLL_DECELERATION=0.85;SC.ScrollView=SC.View.extend({classNames:["sc-scroll-view"],isScrollable:YES,contentView:null,horizontalAlign:SC.ALIGN_LEFT,verticalAlign:SC.ALIGN_TOP,horizontalScrollOffset:function(b,e){if(e!==undefined){var d=this.minimumHorizontalScrollOffset(),a=this.get("maximumHorizontalScrollOffset");this._scroll_horizontalScrollOffset=Math.max(d,Math.min(a,e))}return this._scroll_horizontalScrollOffset||0}.property().cacheable(),verticalScrollOffset:function(b,e){if(e!==undefined){var d=this.get("minimumVerticalScrollOffset"),a=this.get("maximumVerticalScrollOffset");this._scroll_verticalScrollOffset=Math.max(d,Math.min(a,e))}return this._scroll_verticalScrollOffset||0}.property().cacheable(),maximumScrollOffset:function(b,a,d){if(b>=a){return b-a}if(d===SC.ALIGN_LEFT||d===SC.ALIGN_TOP){return 0}else{if(d===SC.ALIGN_MIDDLE||d===SC.ALIGN_CENTER){return 0-Math.round((a-b)/2)}else{return 0-(a-b)}}},minimumScrollOffset:function(b,a,d){if(b>a){return 0}if(d===SC.ALIGN_LEFT||d===SC.ALIGN_TOP){return 0}else{if(d===SC.ALIGN_MIDDLE||d===SC.ALIGN_CENTER){return 0-Math.round((a-b)/2)}else{return 0-(a-b)}}},maximumHorizontalScrollOffset:function(){var d=this.get("contentView");var b=d?d.get("frame").width:0,a=d?d.get("calculatedWidth"):0;if(a){b=d.calculatedWidth}b*=this._scale;var e=this.get("containerView").get("frame").width;if(!this.get("canScrollHorizontal")){b=Math.min(b,e)}return this.maximumScrollOffset(b,e,this.get("horizontalAlign"))}.property(),maximumVerticalScrollOffset:function(){var a=this.get("contentView"),d=(a&&a.get("frame"))?a.get("frame").height:0,b=a?a.get("calculatedHeight"):0;if(b){d=b}d*=this._scale;var e=this.get("containerView").get("frame").height;if(!this.get("canScrollVertical")){d=Math.min(d,e)}return this.maximumScrollOffset(d,e,this.get("verticalAlign"))}.property(),minimumHorizontalScrollOffset:function(){var d=this.get("contentView");var b=d?d.get("frame").width:0,a=d?d.get("calculatedWidth"):0;if(a){b=a}b*=this._scale;var e=this.get("containerView").get("frame").width;if(!this.get("canScrollHorizontal")){b=Math.min(b,e)}return this.minimumScrollOffset(b,e,this.get("horizontalAlign"))}.property(),minimumVerticalScrollOffset:function(){var a=this.get("contentView");var d=(a&&a.get("frame"))?a.get("frame").height:0,b=a?a.get("calculatedHeight"):0;if(b){d=a.calculatedHeight}d*=this._scale;var e=this.get("containerView").get("frame").height;if(!this.get("canScrollVertical")){d=Math.min(d,e)}return this.minimumScrollOffset(d,e,this.get("verticalAlign"))}.property(),verticalLineScroll:20,horizontalLineScroll:20,verticalPageScroll:function(){return this.get("frame").height}.property("frame"),horizontalPageScroll:function(){return this.get("frame").width}.property("frame"),hasHorizontalScroller:YES,horizontalScrollerView:SC.ScrollerView,horizontalTouchScrollerView:SC.TouchScrollerView,isHorizontalScrollerVisible:YES,canScrollHorizontal:function(){return !!(this.get("hasHorizontalScroller")&&this.get("horizontalScrollerView")&&this.get("isHorizontalScrollerVisible"))}.property("isHorizontalScrollerVisible").cacheable(),autohidesHorizontalScroller:YES,hasVerticalScroller:YES,verticalScrollerView:SC.ScrollerView,verticalTouchScrollerView:SC.TouchScrollerView,isVerticalScrollerVisible:YES,canScrollVertical:function(){return !!(this.get("hasVerticalScroller")&&this.get("verticalScrollerView")&&this.get("isVerticalScrollerVisible"))}.property("isVerticalScrollerVisible").cacheable(),autohidesVerticalScroller:YES,verticalScrollerBottom:0,verticalOverlay:function(){if(SC.platform.touch){return YES}return NO}.property().cacheable(),horizontalOverlay:function(){if(SC.platform.touch){return YES}return NO}.property().cacheable(),verticalScrollerLayout:null,horizontalScrollerLayout:null,containerView:SC.ContainerView.extend({}),scrollTo:function(a,b){if(b===undefined&&SC.typeOf(a)===SC.T_HASH){b=a.y;a=a.x}if(!SC.none(a)){this.set("horizontalScrollOffset",a)}if(!SC.none(b)){this.set("verticalScrollOffset",b)}return this},scrollBy:function(a,b){if(b===undefined&&SC.typeOf(a)===SC.T_HASH){b=a.y;a=a.x}a=(a)?this.get("horizontalScrollOffset")+a:null;b=(b)?this.get("verticalScrollOffset")+b:null;return this.scrollTo(a,b)},scrollToVisible:function(b){if(arguments.length===0){return arguments.callee.base.apply(this,arguments)}var d=this.get("contentView");if(!d){return NO}var a=b.get("frame");if(!a){return NO}a=d.convertFrameFromView(a,b.get("parentView"));return this.scrollToRect(a)},scrollToRect:function(b){var a=SC.cloneRect(this.get("containerView").get("frame"));a.x=this.get("horizontalScrollOffset");a.y=this.get("verticalScrollOffset");var e=a.x,d=a.y;a.y-=Math.max(0,SC.minY(a)-SC.minY(b));a.x-=Math.max(0,SC.minX(a)-SC.minX(b));a.y+=Math.max(0,SC.maxY(b)-SC.maxY(a));a.x+=Math.max(0,SC.maxX(b)-SC.maxX(a));if((e!==a.x)||(d!==a.y)){this.scrollTo(a.x,a.y);return YES}else{return NO}},scrollDownLine:function(a){if(a===undefined){a=1}return this.scrollBy(null,this.get("verticalLineScroll")*a)},scrollUpLine:function(a){if(a===undefined){a=1}return this.scrollBy(null,0-this.get("verticalLineScroll")*a)},scrollRightLine:function(a){if(a===undefined){a=1}return this.scrollTo(this.get("horizontalLineScroll")*a,null)},scrollLeftLine:function(a){if(a===undefined){a=1}return this.scrollTo(0-this.get("horizontalLineScroll")*a,null)},scrollDownPage:function(a){if(a===undefined){a=1}return this.scrollBy(null,this.get("verticalPageScroll")*a)},scrollUpPage:function(a){if(a===undefined){a=1}return this.scrollBy(null,0-(this.get("verticalPageScroll")*a))},scrollRightPage:function(a){if(a===undefined){a=1}return this.scrollBy(this.get("horizontalPageScroll")*a,null)},scrollLeftPage:function(a){if(a===undefined){a=1}return this.scrollBy(0-(this.get("horizontalPageScroll")*a),null)},tile:function(){var d=this.get("hasHorizontalScroller")?this.get("horizontalScrollerView"):null;var j=d&&this.get("isHorizontalScrollerVisible");var l=this.get("hasVerticalScroller")?this.get("verticalScrollerView"):null;var g=l&&this.get("isVerticalScrollerVisible");var f=this.get("containerView");var o={left:0,top:0};var n,h,b,p,e,a;var k=((j)?d.get("scrollbarThickness"):0);var m=(g)?l.get("scrollbarThickness"):0;if(j){a=this.get("horizontalScrollerLayout");h={left:(a?a.left:0),bottom:(a?a.bottom:0),right:(a?a.right+m-1:m-1),height:k};d.set("layout",h);p=this.get("horizontalOverlay");o.bottom=p?0:(h.bottom+k)}else{o.bottom=0}if(d){d.set("isVisible",j)}if(g){k=k+this.get("verticalScrollerBottom");e=this.get("verticalScrollerLayout");h={top:(e?e.top:0),bottom:(e?e.bottom+k:k),right:(e?e.right:0),width:m};l.set("layout",h);b=this.get("verticalOverlay");o.right=b?0:(h.right+m)}else{o.right=0}if(l){l.set("isVisible",g)}f.adjust(o)},scrollerVisibilityDidChange:function(){this.tile()}.observes("isVerticalScrollerVisible","isHorizontalScrollerVisible"),_scroll_wheelDeltaX:0,_scroll_wheelDeltaY:0,mouseWheel:function(a){var d=this.get("horizontalScrollOffset"),g=this.get("maximumHorizontalScrollOffset"),f=this.get("maximumVerticalScrollOffset"),b=NO,e=this.get("verticalScrollOffset");b=((this.get("canScrollHorizontal")&&(a.wheelDeltaX<0&&d>0)||(a.wheelDeltaX>0&&d<g))||(this.get("canScrollVertical")&&(a.wheelDeltaY<0&&e>0)||(a.wheelDeltaY>0&&e<f)));if(b){this._scroll_wheelDeltaX+=a.wheelDeltaX;this._scroll_wheelDeltaY+=a.wheelDeltaY;this.invokeLater(this._scroll_mouseWheel,10)}return b},_scroll_mouseWheel:function(){this.scrollBy(this._scroll_wheelDeltaX,this._scroll_wheelDeltaY);if(SC.WHEEL_MOMENTUM&&this._scroll_wheelDeltaY>0){this._scroll_wheelDeltaY=Math.floor(this._scroll_wheelDeltaY*0.95);this._scroll_wheelDeltaY=Math.max(this._scroll_wheelDeltaY,0);this.invokeLater(this._scroll_mouseWheel,10)}else{if(SC.WHEEL_MOMENTUM&&this._scroll_wheelDeltaY<0){this._scroll_wheelDeltaY=Math.ceil(this._scroll_wheelDeltaY*0.95);this._scroll_wheelDeltaY=Math.min(this._scroll_wheelDeltaY,0);this.invokeLater(this._scroll_mouseWheel,10)}else{this._scroll_wheelDeltaY=0;this._scroll_wheelDeltaX=0}}},canScale:NO,_scale:1,scale:function(a,b){if(b!==undefined){this._scale=Math.min(Math.max(this.get("minimumScale"),b),this.get("maximumScale"))}return this._scale}.property().cacheable(),minimumScale:0.25,maximumScale:2,autoScaleRange:NO,_scale_css:"",updateScale:function(b){var a=this.get("contentView");if(!a){return}if(a.isScalable){this.get("contentView").applyScale(b);this._scale_css=""}else{this._scale_css="scale3d("+b+", "+b+", 1)"}},acceptsMultitouch:YES,decelerationRate:SC.NORMAL_SCROLL_DECELERATION,alwaysBounceHorizontal:NO,alwaysBounceVertical:YES,delaysContentTouches:YES,_touchScrollDidChange:function(){if(this.get("contentView").touchScrollDidChange){this.get("contentView").touchScrollDidChange(this._scroll_horizontalScrollOffset,this._scroll_verticalScrollOffset)}if(this.verticalScrollerView&&this.verticalScrollerView.touchScrollDidChange){this.verticalScrollerView.touchScrollDidChange(this._scroll_verticalScrollOffset)}if(this.horizontalScrollerView&&this.horizontalScrollerView.touchScrollDidChange){this.horizontalScrollerView.touchScrollDidChange(this._scroll_horizontalScrollOffset)}},_touchScrollDidStart:function(){if(this.get("contentView").touchScrollDidStart){this.get("contentView").touchScrollDidStart(this._scroll_horizontalScrollOffset,this._scroll_verticalScrollOffset)}if(this.verticalScrollerView&&this.verticalScrollerView.touchScrollDidStart){this.verticalScrollerView.touchScrollDidStart(this._touch_verticalScrollOffset)}if(this.horizontalScrollerView&&this.horizontalScrollerView.touchScrollDidStart){this.horizontalScrollerView.touchScrollDidStart(this._touch_horizontalScrollOffset)}},_touchScrollDidEnd:function(){if(this.get("contentView").touchScrollDidEnd){this.get("contentView").touchScrollDidEnd(this._scroll_horizontalScrollOffset,this._scroll_verticalScrollOffset)}if(this.verticalScrollerView&&this.verticalScrollerView.touchScrollDidEnd){this.verticalScrollerView.touchScrollDidEnd(this._touch_verticalScrollOffset)}if(this.horizontalScrollerView&&this.horizontalScrollerView.touchScrollDidEnd){this.horizontalScrollerView.touchScrollDidEnd(this._touch_horizontalScrollOffset)}},_applyCSSTransforms:function(b){var a="";this.updateScale(this._scale);a+="translate3d("+-this._scroll_horizontalScrollOffset+"px, "+-Math.round(this._scroll_verticalScrollOffset)+"px,0) ";a+=this._scale_css;if(b){var d=b.style;d.webkitTransform=a;d.webkitTransformOrigin="top left"}},captureTouch:function(a){return YES},touchGeneration:0,touchStart:function(b){var a=++this.touchGeneration;if(!this.tracking&&this.get("delaysContentTouches")){this.invokeLater(this.beginTouchesInContent,150,a)}else{if(!this.tracking){this.invokeLater(this.beginTouchesInContent,1,a)}}this.beginTouchTracking(b,YES);return YES},beginTouchesInContent:function(b){if(b!==this.touchGeneration){return}var d=this.touch,a;if(d&&this.tracking&&!this.dragging&&!d.touch.scrollHasEnded&&!d.touch.hasEnded){d.touch.captureTouch(this,YES);if(!d.touch.touchResponder){d.touch.makeTouchResponder(this)}else{if(d.needsScrollEnd){this._touchScrollDidEnd()}}}},beginTouchTracking:function(g,t){var s=g.averagedTouchesForView(this,t);var l=this._scroll_verticalScrollOffset||0,a=this._scroll_horizontalScrollOffset||0,n=a,m=l,f=NO,q=0,u=0,p,k;if(this.touch&&this.touch.timeout){clearTimeout(this.touch.timeout);this.touch.timeout=null;n=this.touch.startClipOffset.x;m=this.touch.startClipOffset.y;f=YES}k=this.get("contentView");if(k){p=k.get("frame");q=p.width;u=p.height}if(k.calculatedWidth&&k.calculatedWidth!==0){q=k.calculatedWidth}if(k.calculatedHeight&&k.calculatedHeight!==0){u=k.calculatedHeight}var h=this.get("containerView").get("frame"),j=h.width,o=h.height;var b=this.convertFrameToView(this.get("frame"),null),e=(a+(s.x-b.x))/this._scale,d=(l+(s.y-b.y))/this._scale;this.touch={startTime:g.timeStamp,notCalculated:YES,enableScrolling:{x:q*this._scale>j||this.get("alwaysBounceHorizontal"),y:u*this._scale>o||this.get("alwaysBounceVertical")},scrolling:{x:NO,y:NO},enableBouncing:SC.platform.bounceOnScroll,startClipOffset:{x:n,y:m},lastScrollOffset:{x:a,y:l},startTouchOffset:{x:s.x,y:s.y},scrollVelocity:{x:0,y:0},startTouchOffsetInContent:{x:e,y:d},containerSize:{width:j,height:o},contentSize:{width:q,height:u},startScale:this._scale,startDistance:s.d,canScale:this.get("canScale")&&SC.platform.pinchToZoom,minimumScale:this.get("minimumScale"),maximumScale:this.get("maximumScale"),globalFrame:b,layer:k.get("layer"),resistanceCoefficient:0.998,resistanceAsymptote:320,decelerationFromEdge:0.05,accelerationToEdge:0.1,scrollTolerance:{x:15,y:15},scaleTolerance:5,secondaryScrollTolerance:30,scrollLock:500,decelerationRate:this.get("decelerationRate"),lastEventTime:g.timeStamp,touch:(t?g:(this.touch?this.touch.touch:null)),needsScrollEnd:f};if(!this.tracking){this.tracking=YES;this.dragging=NO}},_adjustForEdgeResistance:function(g,e,b,d,a){var f;if(g<e){f=g-e}else{if(g>b){f=b-g}else{return g}}f=Math.pow(d,Math.abs(f))*a;if(g<e){f=f-a}else{f=-f+a}return Math.min(Math.max(e,g),b)+f},touchesDragged:function(a,d){if(SC.browser.isiOS){window.focus();$(".field").blur()}var b=a.averagedTouchesForView(this);this.updateTouchScroll(b.x,b.y,b.d,a.timeStamp)},updateTouchScroll:function(m,l,f,j){var h=this.touch,a=m-h.globalFrame.x,o=l-h.globalFrame.y,y,p,z,q,F,D,d=h.scrolling,u=this.get("horizontalAlign"),n=this.get("verticalAlign");var e=((this._scroll_horizontalScrollOffset||0)+a)/this._scale,b=((this._scroll_verticalScrollOffset||0)+o)/this._scale;var C=e-h.startTouchOffsetInContent.x,B=b-h.startTouchOffsetInContent.y;var k=h.dragging;if(!d.x&&Math.abs(C)>h.scrollTolerance.x&&h.enableScrolling.x){k=YES;d.x=YES;h.scrollTolerance.y=h.secondaryScrollTolerance;h.startTouchOffset.x=m;C=0}if(!d.y&&Math.abs(B)>h.scrollTolerance.y&&h.enableScrolling.y){k=YES;d.y=YES;h.scrollTolerance.x=h.secondaryScrollTolerance;h.startTouchOffset.y=l;B=0}if(k&&!h.dragging){h.dragging=YES;this.dragging=YES;this._touchScrollDidStart()}if(!d.x&&!d.y&&!h.canScale){return}if(d.x&&!d.y){if(C>h.scrollLock&&!d.y){h.enableScrolling.y=NO}}if(d.y&&!d.x){if(B>h.scrollLock&&!d.x){h.enableScrolling.x=NO}}if(h.canScale){var t=h.startDistance,A=f-t;if(Math.abs(A)>h.scaleTolerance){d.y=YES;d.x=YES;var E=h.startScale*(f/Math.max(t,50));var v=this._adjustForEdgeResistance(E,h.minimumScale,h.maximumScale,h.resistanceCoefficient,h.resistanceAsymptote);this.dragging=YES;this._scale=v;var x=e*this._scale,w=b*this._scale}}F=this.minimumScrollOffset(h.contentSize.width*this._scale,h.containerSize.width,u);D=this.minimumScrollOffset(h.contentSize.height*this._scale,h.containerSize.height,n);q=this.maximumScrollOffset(h.contentSize.width*this._scale,h.containerSize.width,u);p=this.maximumScrollOffset(h.contentSize.height*this._scale,h.containerSize.height,n);z=h.startTouchOffsetInContent.x*this._scale-a;y=h.startTouchOffsetInContent.y*this._scale-o;if(h.enableBouncing){z=this._adjustForEdgeResistance(z,F,q,h.resistanceCoefficient,h.resistanceAsymptote);y=this._adjustForEdgeResistance(y,D,p,h.resistanceCoefficient,h.resistanceAsymptote)}else{z=Math.max(F,Math.min(q,z));y=Math.max(D,Math.min(p,y))}if(d.x){this._scroll_horizontalScrollOffset=z}if(d.y){this._scroll_verticalScrollOffset=y}this._applyCSSTransforms(h.layer);this._touchScrollDidChange();if(j-h.lastEventTime>=1||h.notCalculated){h.notCalculated=NO;var g=this._scroll_horizontalScrollOffset;var s=this._scroll_verticalScrollOffset;h.scrollVelocity.x=((g-h.lastScrollOffset.x)/Math.max(1,j-h.lastEventTime));h.scrollVelocity.y=((s-h.lastScrollOffset.y)/Math.max(1,j-h.lastEventTime));h.lastScrollOffset.x=g;h.lastScrollOffset.y=s;h.lastEventTime=j}},touchEnd:function(d){var a=this.touch,b=d.averagedTouchesForView(this);d.scrollHasEnded=YES;if(b.touchCount>0){this.beginTouchTracking(d,NO)}else{if(this.dragging){a.dragging=NO;a.lastEventTime=d.timeStamp;this.startDecelerationAnimation()}else{if(a.needsScrollEnd){this._touchScrollDidEnd()}d.captureTouch(this,YES);if(d.touchResponder&&d.touchResponder!==this){d.end()}else{if(!d.touchResponder||d.touchResponder===this){if(d.nextTouchResponder){d.makeTouchResponder(d.nextTouchResponder)}}else{}}this.touch=null}this.tracking=NO;this.dragging=NO}},touchCancelled:function(d){var a=this.touch,b=d.averagedTouchesForView(this);if(!this.touch||!this.touch.timeout){this.beginPropertyChanges();this.set("scale",this._scale);this.set("verticalScrollOffset",this._scroll_verticalScrollOffset);this.set("horizontalScrollOffset",this._scroll_horizontalScrollOffset);this.endPropertyChanges();this.tracking=NO;if(this.dragging){this._touchScrollDidEnd()}this.dragging=NO;this.touch=null}},startDecelerationAnimation:function(a){var b=this.touch;b.decelerationVelocity={x:b.scrollVelocity.x*10,y:b.scrollVelocity.y*10};this.decelerateAnimation()},bouncyBounce:function(d,f,e,g,h,b,a){if(f<e){if(d<0){d=d+((e-f)*h)}else{d=Math.min((e-f)*b+a,e-f-0.01)}}else{if(f>g){if(d>0){d=d-((f-g)*h)}else{d=-Math.min((f-g)*b+a,f-g-0.01)}}}return d},decelerateAnimation:function(){var d=this.touch,z=this._scale,p=d.contentSize,q=d.containerSize,o=this.get("horizontalAlign"),f=this.get("verticalAlign"),y=this.minimumScrollOffset(p.width*this._scale,q.width,o),x=this.minimumScrollOffset(p.height*this._scale,q.height,f),k=this.maximumScrollOffset(p.width*this._scale,q.width,o),j=this.maximumScrollOffset(p.height*this._scale,q.height,f),a=Date.now(),g=40;newX=this._scroll_horizontalScrollOffset+d.decelerationVelocity.x*(g/10),newY=this._scroll_verticalScrollOffset+d.decelerationVelocity.y*(g/10);SC.Logger.debug("SC.Scroller decelerateAnimation, minOffsetY:"+x+",maxOffsetY:"+j+", newY:"+newY);var u=d.decelerationFromEdge,v=d.accelerationToEdge;var n=!d.enableBouncing,m=!d.enableBouncing;if(newX>=y&&newX<=k){n=YES}if(newY>=x&&newY<=j){m=YES}newX/=this._scale;newY/=this._scale;var l=0;l=this.bouncyBounce(l,z,d.minimumScale,d.maximumScale,u,v,0);this._scale=z=z+l;newX*=this._scale;newY*=this._scale;y=this.minimumScrollOffset(p.width*this._scale,q.width,o);x=this.minimumScrollOffset(p.height*this._scale,q.height,f);k=this.maximumScrollOffset(p.width*this._scale,q.width,o);j=this.maximumScrollOffset(p.height*this._scale,q.height,f);if(n&&(newX<y||newX>k)){newX=Math.max(y,Math.min(newX,k));d.decelerationVelocity.x=0}if(m&&(newY<x||newY>j)){newY=Math.max(x,Math.min(newY,j));d.decelerationVelocity.y=0}this._scroll_horizontalScrollOffset=newX;this._scroll_verticalScrollOffset=newY;this._applyCSSTransforms(d.layer);this._touchScrollDidChange();var w=d.decelerationRate,b=Math.pow(w,(g/10));d.decelerationVelocity.y*=b;d.decelerationVelocity.x*=b;d.decelerationVelocity.x=this.bouncyBounce(d.decelerationVelocity.x,newX,y,k,u,v,0.3);d.decelerationVelocity.y=this.bouncyBounce(d.decelerationVelocity.y,newY,x,j,u,v,0.3);var s=Math.abs(d.decelerationVelocity.x),e=Math.abs(d.decelerationVelocity.y);if(e<0.05&&s<0.05&&Math.abs(l)<0.05){d.timeout=null;this.touch=null;this._touchScrollDidEnd();this.beginPropertyChanges();this.set("scale",this._scale);this.set("verticalScrollOffset",this._scroll_verticalScrollOffset);this.set("horizontalScrollOffset",this._scroll_horizontalScrollOffset);this.endPropertyChanges();return}var h=this;d.lastEventTime=Date.now();this.touch.timeout=setTimeout(function(){SC.run(h.decelerateAnimation(),h)},30)},createChildViews:function(){var b=[],a;if(SC.none(a=this.containerView)){a=SC.ContainerView}b.push(this.containerView=this.createChildView(a,{contentView:this.contentView,isScrollContainer:YES}));this.contentView=this.containerView.get("contentView");a=SC.platform.touch?this.get("horizontalTouchScrollerView"):this.get("horizontalScrollerView");if(a){if(this.get("hasHorizontalScroller")){a=this.horizontalScrollerView=this.createChildView(a,{layoutDirection:SC.LAYOUT_HORIZONTAL,valueBinding:"*owner.horizontalScrollOffset"});b.push(a)}else{this.horizontalScrollerView=null}}a=SC.platform.touch?this.get("verticalTouchScrollerView"):this.get("verticalScrollerView");if(a){if(this.get("hasVerticalScroller")){a=this.verticalScrollerView=this.createChildView(a,{layoutDirection:SC.LAYOUT_VERTICAL,valueBinding:"*owner.verticalScrollOffset"});b.push(a)}else{this.verticalScrollerView=null}}this.childViews=b;this.contentViewDidChange();this.tile()},init:function(){arguments.callee.base.apply(this,arguments);this._scroll_contentView=this.get("contentView");var a=this._scroll_contentView;if(a){a.addObserver("frame",this,this.contentViewFrameDidChange);a.addObserver("calculatedWidth",this,this.contentViewFrameDidChange);a.addObserver("calculatedHeight",this,this.contentViewFrameDidChange)}if(this.get("isVisibleInWindow")){this._scsv_registerAutoscroll()}},_scsv_registerAutoscroll:function(){if(this.get("isVisibleInWindow")){SC.Drag.addScrollableView(this)}else{SC.Drag.removeScrollableView(this)}}.observes("isVisibleInWindow"),contentViewDidChange:function(){var e=this.get("contentView"),a=this._scroll_contentView,b=this.contentViewFrameDidChange,d=this.contentViewLayerDidChange;if(e!==a){if(a){a.removeObserver("calculatedWidth",this,this.contentViewFrameDidChange);a.removeObserver("calculatedHeight",this,this.contentViewFrameDidChange);a.removeObserver("frame",this,b);a.removeObserver("layer",this,d)}this._scroll_contentView=e;if(e){e.addObserver("frame",this,b);e.addObserver("calculatedWidth",this,this.contentViewFrameDidChange);e.addObserver("calculatedHeight",this,this.contentViewFrameDidChange);e.addObserver("layer",this,d)}this.containerView.set("contentView",e);this.contentViewFrameDidChange()}}.observes("contentView"),render:function(a,b){this.invokeLast(this.adjustElementScroll);if(b){a.push('<div class="corner"></div>')}return arguments.callee.base.apply(this,arguments)},oldMaxHOffset:0,oldMaxVOffset:0,contentViewFrameDidChange:function(b){var q=this.get("contentView"),n=(q)?q.get("frame"):null,j=this._scale,d=0,t=0,l,k,o,u,p;if(!q||!n){return}d=q.get("calculatedWidth")||n.width||0;t=q.get("calculatedHeight")||n.height||0;d*=j;t*=j;if(!b&&(d===this._scroll_contentWidth)&&(t===this._scroll_contentHeight)){return}this._scroll_contentWidth=d;this._scroll_contentHeight=t;l=this.getPath("containerView.frame");k=l.width;o=l.height;if(this.get("hasHorizontalScroller")&&(q=this.get("horizontalScrollerView"))){if(this.get("autohidesHorizontalScroller")){this.set("isHorizontalScrollerVisible",d>k)}q.setIfChanged("maximum",d-k);q.setIfChanged("proportion",k/d)}if(this.get("hasVerticalScroller")&&(q=this.get("verticalScrollerView"))){if(this.get("autohidesVerticalScroller")){this.set("isVerticalScrollerVisible",t>o)}q.setIfChanged("maximum",t-o);q.setIfChanged("proportion",o/t)}if(!this.get("isVerticalScrollerVisible")&&(this.get("verticalScrollOffset")!==0)&&this.get("autohidesVerticalScroller")){this.set("verticalScrollOffset",0)}if(!this.get("isHorizontalScrollerVisible")&&(this.get("horizontalScrollOffset")!==0)&&this.get("autohidesHorizontalScroller")){this.set("horizontalScrollOffset",0)}var s=this.get("maximumVerticalScrollOffset"),m=this.get("verticalScrollOffset"),h=this.get("maximumHorizontalScrollOffset"),a=this.get("horizontalScrollOffset"),g=s<m,e=h<a;if(g||e){this.forceDimensionsRecalculation(e,g,m,a)}this.notifyPropertyChange("maximumVerticalScrollOffset");this.notifyPropertyChange("maximumHorizontalScrollOffset")},frameDidChange:function(){this.contentViewFrameDidChange(YES)}.observes("frame"),contentViewLayerDidChange:function(){if(this._verticalScrollOffset!==0){this._verticalScrollOffset=-1}if(this._horizontalScrollOffset!==0){this._horizontalScrollOffset=-1}this.invokeLast(this.adjustElementScroll)},_scroll_horizontalScrollOffsetDidChange:function(){this.invokeLast(this.adjustElementScroll)}.observes("horizontalScrollOffset"),_scroll_verticalScrollOffsetDidChange:function(){this.invokeLast(this.adjustElementScroll)}.observes("verticalScrollOffset"),adjustElementScroll:function(){var a=this.get("containerView"),e=this.get("contentView"),d=this.get("verticalScrollOffset"),b=this.get("horizontalScrollOffset");if(e){if(SC.platform.touch){this._applyCSSTransforms(e.get("layer"))}if(e._viewFrameDidChange){e._viewFrameDidChange()}}if(a&&!SC.platform.touch){a=a.$()[0];if(a){if(d!==this._verticalScrollOffset){a.scrollTop=d;this._verticalScrollOffset=d}if(b!==this._horizontalScrollOffset){a.scrollLeft=b;this._horizontalScrollOffset=b}}}},forceDimensionsRecalculation:function(b,d,f,a){var g=a;var e=f;this.scrollTo(0,0);if(b&&d){this.scrollTo(this.get("maximumHorizontalScrollOffset"),this.get("maximumVerticalScrollOffset"))}if(b&&!d){this.scrollTo(this.get("maximumHorizontalScrollOffset"),e)}if(!b&&d){this.scrollTo(g,this.get("maximumVerticalScrollOffset"))}},_scroll_verticalScrollOffset:0,_scroll_horizontalScrollOffset:0});sc_require("views/scroll");SC.MenuScrollerView=SC.ScrollerView.extend({classNames:["sc-menu-scroller-view"],scrollDown:NO,value:function(a,d){if(d!==undefined){this._value=d}else{var b=this._value||0;return Math.min(b,this.get("maximum"))}}.property("maximum").cacheable(),maximum:0,isEnabled:YES,layoutDirection:SC.LAYOUT_VERTICAL,verticalLineScroll:20,ownerScrollValueKey:function(){return"verticalScrollOffset"}.property("layoutDirection").cacheable(),init:function(){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.TINY_SCROLLER_THICKNESS);break;case SC.SMALL_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.SMALL_SCROLLER_THICKNESS);break;case SC.REGULAR_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.REGULAR_SCROLLER_THICKNESS);break;case SC.LARGE_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.LARGE_SCROLLER_THICKNESS);break;case SC.HUGE_CONTROL_SIZE:this.set("scrollerThickness",SC.MenuScrollerView.HUGE_SCROLLER_THICKNESS);break}return arguments.callee.base.apply(this,arguments)},render:function(a,d){a.addClass("sc-vertical");a.addClass(this.get("controlSize"));if(d){var b=this.get("scrollDown")?"arrowDown":"arrowUp";a.push('<span class="scrollArrow '+b+'">&nbsp;</span>')}a.setClass("disabled",!this.get("isEnabled"))},didCreateLayer:function(){},willDestroyLayer:function(){var a=this._sc_scroller_scrollDidChange;SC.Event.remove(this.$(),"scroll",this,a)},mouseEntered:function(a){this.set("isMouseOver",YES);this._invokeScrollOnMouseOver()},mouseExited:function(a){this.set("isMouseOver",NO)},_sc_scroller_valueDidChange:function(){}.observes("value"),_sc_scroller_armScrollTimer:function(){if(!this._sc_scrollTimer){SC.RunLoop.begin();var a=this._sc_scroller_scrollDidChange;this._sc_scrollTimer=this.invokeLater(a,50);SC.RunLoop.end()}},_sc_scroller_scrollDidChange:function(){var b=Date.now(),e=this._sc_lastScroll,d=this.get("layer"),a=0;if(e&&(b-e)<50){return this._sc_scroller_armScrollTimer()}this._sc_scrollTimer=null;this._sc_lastScroll=b;SC.RunLoop.begin();if(!this.get("isEnabled")){return}this._sc_scrollValue=a=d.scrollTop;this.set("value",a);SC.RunLoop.end()},_scrollMenu:function(){var b=this.get("value"),a;if(this.get("scrollDown")){a=b+this.verticalLineScroll;if(a<=this.get("maximum")){this.set("value",a)}}else{a=b-this.verticalLineScroll;if(a>=0){this.set("value",a)}else{if(b<=this.verticalLineScroll&&b>0){this.set("value",0)}}}return YES},_invokeScrollOnMouseOver:function(){this._scrollMenu();if(this.get("isMouseOver")){this.invokeLater(this._invokeScrollOnMouseOver,50)}}});SC.MenuScrollerView.REGULAR_SCROLLER_THICKNESS=18;SC.MenuScrollerView.TINY_SCROLLER_THICKNESS=10;SC.MenuScrollerView.SMALL_SCROLLER_THICKNESS=14;SC.MenuScrollerView.LARGE_SCROLLER_THICKNESS=23;SC.MenuScrollerView.HUGE_SCROLLER_THICKNESS=26;SC.MenuScrollView=SC.ScrollView.extend({classNames:["sc-menu-scroll-view"],maximumHorizontalScrollOffset:0,hasHorizontalScroller:NO,horizontalScrollerView:SC.MenuScrollerView,isHorizontalScrollerVisible:NO,canScrollHorizontal:NO,autohidesHorizontalScroller:NO,hasVerticalScroller:YES,verticalScrollerView:SC.MenuScrollerView,verticalScrollerView2:SC.MenuScrollerView,isVerticalScrollerVisible:YES,canScrollVertical:YES,autohidesVerticalScroller:YES,verticalScrollerBottom:0,controlSize:SC.REGULAR_CONTROL_SIZE,containerView:SC.ContainerView,scrollToVisible:function(b){if(arguments.length===0){return arguments.callee.base.apply(this,arguments)}var f=this.get("contentView");if(!f){return NO}var a=b.get("frame");if(!a){return NO}a=f.convertFrameFromView(a,b.get("parentView"));var d=this.get("verticalScrollerView2");if(d&&d.get("isVisible")){a.height+=d.get("frame").height}var e=this.get("verticalScrollerView");if(e&&e.get("isVisible")){a.top-=e.get("frame").height}return this.scrollToRect(a)},tile:function(){var h,v,j,b,t,k,d;h=this.get("hasVerticalScroller");v=h?this.get("verticalScrollerView"):null;j=h?this.get("verticalScrollerView2"):null;b=v&&this.get("isVerticalScrollerVisible");t=this.get("containerView");k={left:0,top:0};if(b){d=0;var a=v.get("scrollerThickness")||j.get("scrollerThickness");var l=this.get("contentView"),q,s=(l)?l.get("frame"):null,m=(s)?s.height:0,u=this.containerView.$()[0],n=this.get("verticalScrollOffset"),g={height:0,top:0,right:0,left:0},p={height:a,top:0,right:0,left:0},e={height:a,bottom:0,right:0,left:0},o={height:0,bottom:0,right:0,left:0};if(u){d=u.offsetHeight}if(n===0){k.top=0;k.bottom=a;v.set("layout",g);j.set("layout",e)}else{if(n>=(m-d-a)){k.top=a;k.bottom=0;v.set("layout",p);j.set("layout",o)}else{k.top=a;k.bottom=a;v.set("layout",p);j.set("layout",e)}}}if(v){v.set("isVisible",b);j.set("isVisible",b)}t.set("layout",k)},scrollerVisibilityDidChange:function(){this.tile()}.observes("isVerticalScrollerVisible","isHorizontalScrollerVisible","verticalScrollOffset"),createChildViews:function(){var d=[],b,a,e=this.get("controlSize");if(SC.none(b=this.containerView)){b=SC.ContainerView}d.push(this.containerView=this.createChildView(b,{contentView:this.contentView}));this.contentView=this.containerView.get("contentView");if((b=this.verticalScrollerView)&&(a=this.verticalScrollerView2)){if(this.get("hasVerticalScroller")){b=this.verticalScrollerView=this.createChildView(b,{layout:{top:0,left:0,right:0},controlSize:e,valueBinding:"*owner.verticalScrollOffset"});d.push(b);a=this.verticalScrollerView2=this.createChildView(a,{scrollDown:YES,layout:{bottom:0,left:0,right:0},controlSize:e,valueBinding:"*owner.verticalScrollOffset"});d.push(a)}else{this.verticalScrollerView=null;this.verticalScrollerView2=null}}this.childViews=d;this.contentViewFrameDidChange();this.tile()},init:function(){arguments.callee.base.apply(this,arguments);this._scroll_contentView=this.get("contentView");var a=this._scroll_contentView;if(a){a.addObserver("frame",this,this.contentViewFrameDidChange)}if(this.get("isVisibleInWindow")){this._scsv_registerAutoscroll()}},_scsv_registerAutoscroll:function(){if(this.get("isVisibleInWindow")){SC.Drag.addScrollableView(this)}else{SC.Drag.removeScrollableView(this)}}.observes("isVisibleInWindow"),contentViewFrameDidChange:function(){var d=this.get("contentView"),b,j=(d)?d.get("frame"):null,g=(j)?j.width:0,a=(j)?j.height:0,k=this.get("frame"),e,h;this._scroll_contentWidth=g;this._scroll_contentHeight=a;if(this.get("hasVerticalScroller")&&(d=this.get("verticalScrollerView"))&&(b=this.get("verticalScrollerView2"))){a-=1;if(this.get("autohidesVerticalScroller")){this.set("isVerticalScrollerVisible",a>k.height)}a-=this.get("verticalScrollerBottom");e=0;h=this.containerView.$()[0];if(h){e=h.offsetHeight}a=a-e;d.setIfChanged("maximum",a);b.setIfChanged("maximum",a)}},_scroll_horizontalScrollOffsetDidChange:function(){},_scroll_verticalScrollOffsetDidChange:function(){var b=this.get("verticalScrollOffset");var a=this.get("contentView");if(a){a.$().css("top",(0-b)+"px")}}.observes("verticalScrollOffset")});sc_require("views/workspace");SC.TO_LEFT="TOLEFT";SC.TO_RIGHT="TORIGHT";SC.NavigationView=SC.WorkspaceView.extend({_views:null,_current:null,navigationContentView:SC.View,init:function(){arguments.callee.base.apply(this,arguments);this._views=[]},createChildViews:function(){arguments.callee.base.apply(this,arguments);var a=this.get("navigationContentView");if(a.isClass){a=this.createChildView(a)}this._defaultContent=this.navigationContentView=a;this.contentView.appendChild(a)},changeNavigationContent:function(a){var d=null,b=null;if(a){d=a.get("topToolbar");b=a.get("bottomToolbar")}if(d&&d.isClass){a.set("topToolbar",d=d.create())}if(b&&b.isClass){a.set("bottomToolbar",b=b.create())}this.beginPropertyChanges();this._current=a;this.set("navigationContentView",a?a:this._defaultContent);this.set("topToolbar",d);this.set("bottomToolbar",b);this.endPropertyChanges()},push:function(a){this._currentDirection=this._current?SC.TO_LEFT:null;if(this._current){this._views.push(this._current)}this.changeNavigationContent(a)},pop:function(){this._currentDirection=SC.TO_RIGHT;var a=this._views.pop();this.changeNavigationContent(a)},popToView:function(b){this._currentDirection=SC.TO_RIGHT;var e=this._views,a=e.length-1,d=e[a];while(d&&d!==b){this._views.pop();a--;d=e[a]}this.changeNavigationContent(d)},topToolbarDidChange:function(){var b=this.activeTopToolbar,a=this.get("topToolbar");if(b){if(this._currentDirection!==null){b.set("buildDirection",this._currentDirection);this.buildOutChild(b)}else{this.removeChild(b)}}if(a){if(this._currentDirection!==null){a.set("buildDirection",this._currentDirection);this.buildInChild(a)}else{this.appendChild(a)}}this.activeTopToolbar=a;this.invokeOnce("childDidChange")}.observes("topToolbar"),bottomToolbarDidChange:function(){var b=this.activeBottomToolbar,a=this.get("bottomToolbar");if(b){if(this._currentDirection!==null){b.set("buildDirection",this._currentDirection);this.buildOutChild(b)}else{this.removeChild(b)}}if(a){if(this._currentDirection!==null){a.set("buildDirection",this._currentDirection);this.buildInChild(a)}else{this.appendChild(a)}}this.activeBottomToolbar=a;this.invokeOnce("childDidChange")}.observes("topToolbar"),contentViewDidChange:function(){var b=this.activeNavigationContentView,a=this.get("navigationContentView");if(!a.isNavigationBuilder){a.mixin(SC.NavigationBuilder)}this._pendingBuildOut=b;this._pendingBuildIn=a;this.activeNavigationContentView=a;this.invokeOnce("childDidChange")}.observes("navigationContentView"),childDidChange:function(){var a=this._pendingBuildIn,b=this._pendingBuildOut;if(b){if(this._currentDirection!==null){b.set("buildDirection",this._currentDirection);this.contentView.buildOutChild(b)}else{this.contentView.removeChild(b)}}this._scws_tile();if(a){if(this._currentDirection!==null){a.set("buildDirection",this._currentDirection);this.contentView.buildInChild(a)}else{this.contentView.appendChild(a)}}}});sc_require("views/toolbar");SC.NavigationBarView=SC.ToolbarView.extend(SC.Gesturable,{init:function(){arguments.callee.base.apply(this,arguments);if(!SC.Animatable){SC.Logger.error("NavigationBarView requires SC.Animatable. Please make your app or framework require the animation framework. CRASH.")}},mixinAnimatable:function(){this.mixin(SC.Animatable);this.transitions=this.navigationTransitions},navigationTransitions:{opacity:{duration:0.25,action:"didFinishTransition"}},style:{opacity:1},gestures:["swipeGesture"],swipeGesture:SC.SwipeGesture,swipe:function(e,j,g){var f=(g===SC.SWIPE_LEFT)?"isSwipeLeft":"isSwipeRight",d=this.get("childViews"),h,b,a=d.get("length");for(b=0;b<a;b++){h=d[b];if(h.get(f)){j.makeTouchResponder(h);j.end();return}}},resetBuild:function(){if(!this.isAnimatable){this.mixinAnimatable()}},didFinishTransition:function(){if(this.isBuildingIn){this.buildInDidFinish()}else{if(this.isBuildingOut){this.buildOutDidFinish()}}},preBuildIn:function(){this.disableAnimation();this.adjust("opacity",0).updateLayout();this.enableAnimation();var d=this.get("childViews"),e,b,a=d.get("length");for(b=0;b<a;b++){e=d[b];if(e.disableNavigationTransition){continue}if(!e._nv_mixedIn){this.mixinNavigationChild(e)}e.disableAnimation();e.transform(this.buildDirection===SC.TO_LEFT?100:-100);e.enableAnimation()}},buildIn:function(){this.preBuildIn();this.invokeLater("startBuildIn",10)},startBuildIn:function(){this.adjust("opacity",1);var d=this.get("childViews"),e,b,a=d.get("length");for(b=0;b<a;b++){e=d[b];if(e.disableNavigationTransition){continue}e.transform(0)}},buildOut:function(){this.adjust("opacity",0);var d=this.get("childViews"),e,b,a=d.get("length");for(b=0;b<a;b++){e=d[b];if(e.disableNavigationTransition){continue}if(!e._nv_mixedIn){this.mixinNavigationChild(e)}e.transform(this.buildDirection===SC.TO_LEFT?-100:100)}},mixinNavigationChild:function(a){if(a.isAnimatable){return}a.mixin(SC.Animatable);a.mixin({transitions:{transform:{timing:SC.Animatable.TRANSITION_EASE_IN_OUT,duration:0.25}},naturalLayout:a.get("layout"),transform:function(b){if(SC.platform.supportsCSS3DTransforms){this.adjust("transform","translate3d("+b+"px,0px,0px)")}else{this.adjust("transform","translate("+b+"px,0px)")}}});a._nv_mixedIn=YES}});sc_require("views/button");SC.PopupButtonView=SC.ButtonView.extend({classNames:["sc-popup-button"],renderDelegateName:"popupButtonRenderDelegate",preferMatrix:null,menu:null,shouldLoadInBackground:NO,init:function(){arguments.callee.base.apply(this,arguments);this._setupMenu();if(this.get("shouldLoadInBackground")){SC.backgroundTaskQueue.push(SC.PopupButtonMenuLoader.create({popupButton:this}))}},_setupMenu:function(){var a=this.get("instantiatedMenu");if(this.isActiveBinding){this.isActiveBinding.disconnect()}this.isActiveBinding=null;if(a&&!a.isClass){this.isActiveBinding=this.bind("isActive",a,"isVisibleInWindow")}},_popup_menuDidChange:function(){this._setupMenu()}.observes("menu"),isActive:NO,_instantiateMenu:function(){var a=this.get("menu");if(!a||!a.isClass){return}this.menu=a.create();this._setupMenu()},instantiatedMenu:function(){var a=this.get("menu");if(a&&a.isClass){this._instantiateMenu();a=this.get("menu")}return a}.property("menu").cacheable(),action:function(a){var b=this.get("instantiatedMenu");if(!b){return NO}b.popup(this,this.get("preferMatrix"));return YES},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this._isMouseDown=YES;this._action();this._menuRenderedTimestamp=0;var b=this;setTimeout(function(){SC.run(function(){b._menuRenderedTimestamp=Date.now()})},1);this.becomeFirstResponder();return YES},mouseUp:function(b){var e=new Date().getTime(),d=this._menuRenderedTimestamp,f=this.get("instantiatedMenu"),g=SC.platform.touch,a;if(d===0){d=Date.now()}if(f){a=f.getPath("rootMenu.targetMenuItem");if(a){if(!a.performAction()){f.remove()}}else{if(!g&&(e-d>SC.ButtonView.CLICK_AND_HOLD_DELAY)){f.remove()}}}this._isMouseDown=NO;arguments.callee.base.apply(this,arguments);return YES},mouseExited:function(a){return YES},performKeyEquivalent:function(b,a){if(!this.get("isEnabled")){return NO}var d=this.get("instantiatedMenu");return(!!d&&d.performKeyEquivalent(b,a,YES))}});SC.PopupButtonMenuLoader=SC.Task.extend({popupButton:null,run:function(){if(this.popupButton){this.popupButton._instantiateMenu()}}});SC.ProgressView=SC.View.extend(SC.Control,{classNames:["sc-progress-view"],displayProperties:["displayValue","ariaValue","minimum","maximum","isEnabled","isIndeterminate","isRunning","isVisibleInWindow"],renderDelegateName:"progressRenderDelegate",value:0.5,valueBindingDefault:SC.Binding.single().notEmpty(),displayValue:function(){var b=this.get("minimum")||0,d=this.get("maximum")||1,a=this.get("value")||0;a=(a-b)/(d-b);if(a>1){a=1}if(isNaN(a)){a=0}if(a<b){a=0}if(a>d){a=1}return a}.property("value","maximum","minimum").cacheable(),ariaRole:"progressbar",ariaValue:function(){return this.get("value")}.property("value").cacheable(),minimum:0,minimumBindingDefault:SC.Binding.single().notEmpty(),contentMinimumKey:null,maximum:1,maximumBindingDefault:SC.Binding.single().notEmpty(),contentMaximumKey:null,isIndeterminate:NO,isIndeterminateBindingDefault:SC.Binding.bool(),isRunning:NO,isRunningBindingDefault:SC.Binding.bool(),contentIsIndeterminateKey:null,contentPropertyDidChange:function(d,a){var b=this.get("content");this.beginPropertyChanges().updatePropertyFromContent("value",a,"contentValueKey",b).updatePropertyFromContent("minimum",a,"contentMinimumKey",b).updatePropertyFromContent("maximum",a,"contentMaximumKey",b).updatePropertyFromContent("isIndeterminate",a,"contentIsIndeterminateKey",b).endPropertyChanges()},didCreateLayer:function(){if(this.get("isIndeterminate")&&this.get("isRunning")&&this.get("isVisibleInWindow")){this.displayDidChange()}}});SC.RadioView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),classNames:["sc-radio-view"],ariaRole:"radiogroup",displayProperties:["displayItems","isEnabled","layoutDirection"],renderDelegateName:"radioGroupRenderDelegate",itemAriaLabeledByKey:null,itemAriaLabelKey:null,value:null,layoutDirection:SC.LAYOUT_VERTICAL,escapeHTML:YES,items:[],itemTitleKey:null,itemWidthKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemsDidChange:function(){if(this._items){this._items.removeObserver("[]",this,this.itemContentDidChange)}this._items=this.get("items");if(this._items){this._items.addObserver("[]",this,this.itemContentDidChange)}this.itemContentDidChange()}.observes("items"),itemContentDidChange:function(){this._renderAsFirstTime=YES;this.notifyPropertyChange("displayItems")},displayItems:function(){var m=this.get("items"),s=this.get("value"),j=SC.isArray(s),g=this.get("localize"),e=this.get("itemTitleKey"),f=this.get("itemValueKey"),q=this.get("itemWidthKey"),d=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,l=this.get("itemIsEnabledKey"),z=this.get("itemIconKey"),h=this.get("itemAriaLabeledByKey"),B=this.get("itemAriaLabelKey"),y=this._displayItems||[],t=(m)?m.get("length"):0,w,A,n,o,k,x,v,p,b,a,u;for(k=0;k<t;k++){w=m.objectAt(k);if(SC.typeOf(w)===SC.T_ARRAY){A=w[0];o=w[1]}else{if(w){if(e){A=w.get?w.get(e):w[e]}else{A=(w.toString)?w.toString():null}if(q&&d){n=w.get?w.get(q):w[q]}if(f){o=w.get?w.get(f):w[f]}else{o=w}if(l){x=w.get?w.get(l):w[l]}else{x=YES}if(z){v=w.get?w.get(z):w[z]}else{v=null}if(h){a=w.get?w.get(h):w[h]}else{a=null}if(B){u=w.get?w.get(B):w[B]}else{u=null}}else{A=o=v=null;x=NO}}x=x&&this.get("isEnabled");if(w){p=(j)?(s.indexOf(o)>=0):(s===o)}else{p=NO}if(g){A=SC.String.loc(A)}y.push(SC.Object.create({title:A,icon:v,width:n,value:o,isEnabled:x,isSelected:(j&&s.indexOf(o)>=0&&s.length===1)||(s===o),isMixed:(j&&s.indexOf(o)>=0),isActive:this._activeRadioButton===k,theme:this.get("theme"),renderState:{}}))}return y}.property("isEnabled","value","items","itemTitleKey","itemWidthKey","itemValueKey","itemIsEnabledKey","localize","itemIconKey","itemAriaLabeledByKey","itemAriaLabelKey").cacheable(),mouseDown:function(a){if(!this.get("isEnabled")){return YES}if($(a.target).hasClass("sc-radio-button")){return YES}var e=this.get("renderDelegate"),d=this.get("renderDelegateProxy"),g=this.$(),b=e.indexForEvent(d,g,a);this._activeRadioButton=b;if(b!==undefined){var f=this.get("displayItems")[b];if(f.get("isEnabled")){f.set("isActive",YES);e.updateRadioAtIndex(d,g,b)}}a.allowDefault();return YES},mouseUp:function(a){if(!this.get("isEnabled")){return YES}if($(a.target).hasClass("sc-radio-button")){return YES}var e=this.get("renderDelegate"),d=this.get("renderDelegateProxy"),g=this.$(),h=this.get("displayItems"),b=e.indexForEvent(d,g,a);if(this._activeRadioButton!==undefined&&b!==this._activeRadioButton){h[this._activeRadioButton].set("isActive",NO);e.updateRadioAtIndex(d,g,this._activeRadioButton)}this._activeRadioButton=undefined;if(b!==undefined){var f=this.get("displayItems")[b];if(f.get("isEnabled")){f.set("isActive",NO);e.updateRadioAtIndex(d,g,b);this.set("value",f.value)}}a.allowDefault();return YES},keyDown:function(k){if(!this.get("isEnabled")){return YES}if(k.which===9||k.keyCode===9){var j=k.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(j){j.becomeFirstResponder()}else{k.allowDefault()}return YES}if(k.which>=37&&k.which<=40){var h=this.get("renderDelegate"),g=this.get("renderDelegateProxy"),d=this.$(),f=this.get("displayItems"),b=this.get("value");for(var e=0,a=f.length;e<a;e++){if(b===f[e].value){break}}if(k.which===37||k.which===38){if(e<=0){e=f.length-1}else{e--}}if(k.which===39||k.which===40){if(e>=f.length-1){e=0}else{e++}}h.updateRadioAtIndex(g,d,e);this.set("value",f[e].value)}k.allowDefault();return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)}});SC.SceneView=SC.ContainerView.extend({scenes:["master","detail"],nowShowing:null,transitionDuration:200,_state:"NO_VIEW",replaceContent:function(a){if(a&&this._state===this.READY){this.animateScene(a)}else{this.replaceScene(a)}return this},replaceScene:function(d){var e=this._targetView,f=this.STANDARD_LAYOUT,b=this.get("scenes"),a=b?b.indexOf(this.get("nowShowing")):-1;this._targetView=d;this._targetIndex=a;if(this._timer){this._timer.invalidate()}this._leftView=this._rightView=this._start=this._end=null;this._timer=null;this.removeAllChildren();if(e){e.set("layout",f)}if(d){d.set("layout",f)}if(d){this.appendChild(d)}this._state=d?this.READY:this.NO_VIEW},animateScene:function(b){var d=this._targetView,g=this._targetIndex,a=this.get("scenes"),f=a?a.indexOf(this.get("nowShowing")):-1,e;if(g<0||f<0||g===f){return this.replaceScene(b)}this._targetView=b;this._targetIndex=f;if(f>g){this._leftView=d;this._rightView=b;this._target=-1}else{this._leftView=b;this._rightView=d;this._target=1}this.removeAllChildren();if(d){this.appendChild(d)}if(b){this.appendChild(b)}this._start=Date.now();this._end=this._start+this.get("transitionDuration");this._state=this.ANIMATING;this.tick()},tick:function(){this._timer=null;var a=Date.now(),e=(a-this._start)/(this._end-this._start),h=this._target,g=this._leftView,b=this._rightView,d,f;if(e<0){e=0}if(!this.get("isVisibleInWindow")||(e>=1)){return this.replaceScene(this._targetView)}d=SC.clone(this.get("frame"));f=Math.floor(d.width*e);if(h>0){d.left=0-(d.width-f);g.set("layout",d);d=SC.clone(d);d.left=f;b.set("layout",d)}else{d.left=0-f;g.set("layout",d);d=SC.clone(d);d.left=d.width-f;b.set("layout",d)}this._timer=this.invokeLater(this.tick,20);return this},NO_VIEW:"NO_VIEW",ANIMATING:"ANIMATING",READY:"READY",STANDARD_LAYOUT:{top:0,left:0,bottom:0,right:0}});SC.SegmentView=SC.View.extend(SC.Control,{ariaRole:"button",isSegment:YES,classNames:["sc-segment-view"],toolTip:null,isEnabled:YES,isActive:NO,isSelected:NO,layoutDirection:SC.LAYOUT_HORIZONTAL,controlSize:null,supportFocusRing:NO,displayProperties:["icon","displayTitle","value","displayToolTip","isDefault","isCancel","width","isSegment","isFirstSegment","isMiddleSegment","isLastSegment","isOverflowSegment","index","layoutDirection"],renderDelegateName:"segmentRenderDelegate",useStaticLayout:YES,title:"",value:null,icon:null,localize:NO,keyEquivalent:null,escapeHTML:YES,needsEllipsis:YES,displayTitle:function(){var a=this.get("title");if(this.get("localize")){a=SC.String.loc(a)}return a}.property("title","localize").cacheable(),width:null,localItem:null,widthDidChange:function(){this.adjust("width",this.get("width"))}.observes("width"),updateItem:function(e,d){var h=e.get("itemKeys"),g,a=e.get("viewKeys"),f,b;for(b=h.get("length")-1;b>=0;b--){g=e.get(h.objectAt(b));f=a.objectAt(b);if(!SC.none(d.get(g))){this.set(f,d.get(g))}}this.set("localItem",d)}});sc_require("views/segment");SC.SegmentedView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled").cacheable(),ariaRole:"group",classNames:["sc-segmented-view"],theme:"square",value:null,isEnabled:YES,allowsEmptySelection:NO,allowsMultipleSelection:NO,selectSegmentWhenTriggeringAction:NO,localize:YES,align:SC.ALIGN_CENTER,layoutDirection:SC.LAYOUT_HORIZONTAL,items:null,itemTitleKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemWidthKey:null,itemActionKey:null,itemTargetKey:null,itemLayerIdKey:null,itemKeyEquivalentKey:null,shouldHandleOverflow:YES,overflowTitle:"&raquo;",overflowToolTip:"More&hellip;",overflowIcon:null,segmentViewClass:SC.SegmentView,itemKeys:["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemWidthKey","itemToolTipKey","itemKeyEquivalentKey","itemLayerIdKey"],viewKeys:["title","value","isEnabled","icon","width","toolTip","keyEquivalent","layerId"],init:function(){arguments.callee.base.apply(this,arguments);var e=this.get("overflowTitle"),a=this.get("overflowToolTip"),b=this.get("overflowIcon"),d;d=this.get("segmentViewClass").create({controlSize:this.get("controlSize"),localize:this.get("localize"),title:e,toolTip:a,icon:b,isLastSegment:YES,isOverflowSegment:YES,layoutDirection:this.get("layoutDirection"),isVisible:this.get("shouldHandleOverflow")});this.set("overflowView",d);this.appendChild(d);this.itemsDidChange()},shouldHandleOverflowDidChange:function(){if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}else{this.get("overflowView").set("isVisible",NO)}}.observes("shouldHandleOverflow"),itemsDidChange:function(){var n=this.get("items")||[],t,d,k,p=this.get("childViews"),l,e=p.lastObject(),q=this.get("value"),b,s=this.get("itemKeys"),a,o=this.get("viewKeys"),g,m=this.get("segmentViewClass"),h,f;if(p.get("length")-1>n.get("length")){for(h=p.get("length")-2;h>=n.get("length");h--){l=p.objectAt(h);d=l.get("localItem");if(d instanceof SC.Object){for(f=s.get("length")-1;f>=0;f--){a=this.get(s.objectAt(f));if(a){d.removeObserver(a,this,this.itemContentDidChange)}}}if(SC.isArray(q)){q.removeObject(d)}else{if(q===d){q=null}}this.removeChild(l)}this.set("value",q)}else{if(p.get("length")-1<n.get("length")){for(h=p.get("length")-1;h<n.get("length");h++){l=m.create({controlSize:this.get("controlSize"),localize:this.get("localize"),layoutDirection:this.get("layoutDirection")});this.insertBefore(l,e)}}}p=this.get("childViews");for(h=0;h<n.get("length");h++){d=n.objectAt(h);l=p.objectAt(h);k=l.get("localItem");if(k instanceof SC.Object&&!n.contains(k)){for(f=s.get("length")-1;f>=0;f--){a=this.get(s.objectAt(f));if(a){k.removeObserver(a,this,this.itemContentDidChange)}}}if(SC.none(d)){continue}if(SC.typeOf(d)===SC.T_STRING){d=SC.Object.create({title:d.humanize().titleize(),value:d});this.set("itemTitleKey","title");this.set("itemValueKey","value")}else{if(SC.typeOf(d)===SC.T_HASH){d=SC.Object.create(d)}else{if(d instanceof SC.Object){for(f=s.get("length")-1;f>=0;f--){a=this.get(s.objectAt(f));if(a){d.removeObserver(a,this,this.itemContentDidChange);d.addObserver(a,this,this.itemContentDidChange,h)}}}else{SC.Logger.error("SC.SegmentedView items may be Strings, Objects (ie. Hashes) or SC.Objects only")}}}b=NO;if(SC.isArray(q)?q.indexOf(d.get(this.get("itemValueKey")))>=0:q===d.get(this.get("itemValueKey"))){b=YES}l.set("isSelected",b);l.set("index",h);l.set("isFirstSegment",h===0);l.set("isMiddleSegment",h<n.get("length")-1&&h>0);l.set("isLastSegment",h===n.get("length")-1);l.updateItem(this,d)}if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}}.observes("*items.[]"),itemContentDidChange:function(f,e,b,d){var a=this.get("items"),g=this.get("childViews"),h;h=g.objectAt(d);if(h){h.updateItem(this,f)}else{SC.Logger.warn("Item content change was observed on item without matching segment child view.")}if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}},viewDidResize:function(){var b=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,a=b?this.$().width():this.$().height();if(this.get("shouldHandleOverflow")&&(this.isOverflowing||a<=this.cachedMinimumDim)){this.adjustOverflow()}},isVisibleInWindowDidChange:function(){if(this.get("shouldHandleOverflow")){this.invokeLast(this.remeasure)}}.observes("isVisibleInWindow"),remeasure:function(){if(!this.get("shouldHandleOverflow")){return}var a=this.get("renderDelegate"),e=this.get("childViews"),d;if(this.get("isVisibleInWindow")){d=e.lastObject();d.set("isVisible",YES);for(var b=e.get("length")-1;b>=0;b--){e.objectAt(b).set("isVisible",YES)}this.cachedDims=this.segmentDimensions();this.cachedOverflowDim=this.overflowSegmentDim();this.adjustOverflow()}},adjustOverflow:function(){if(!this.get("shouldHandleOverflow")){return}var g=this.get("childViews"),f,j=this.get("value"),b=g.lastObject(),h=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,l=h?this.$().width():this.$().height(),e=0,k,a,d;this.isOverflowing=NO;b.set("isSelected",NO);this.overflowItems=[];a=this.cachedDims.length;for(d=0;d<a;d++){f=g.objectAt(d);e+=this.cachedDims[d];k=(d===a-1)?e:e+this.cachedOverflowDim;if(k>l){overflowItem={};localItem=f.get("localItem");overflowItem[this.get("itemTitleKey")]=localItem.get(this.get("itemTitleKey"));overflowItem[this.get("itemIconKey")]=localItem.get(this.get("itemIconKey"));overflowItem[this.get("itemIsEnabledKey")]=localItem.get(this.get("itemIsEnabledKey"));overflowItem[this.get("itemKeyEquivalentKey")]=localItem.get(this.get("itemKeyEquivalentKey"));overflowItem[this.get("itemValueKey")]=localItem.get(this.get("itemValueKey"));this.overflowItems.pushObject(overflowItem);this.isOverflowing=YES;f.set("isVisible",NO);if(d===0){b.set("isFirstSegment",YES)}if(SC.isArray(j)?j.indexOf(f.get("value"))>=0:j===f.get("value")){b.set("isSelected",YES)}}else{f.set("isVisible",YES);if(d===0){b.set("isFirstSegment",NO)}}}if(this.isOverflowing){b.set("isVisible",YES)}else{b.set("isVisible",NO)}this.cachedMinimumDim=e+this.cachedOverflowDim},segmentDimensions:function(){var b=this.get("childViews"),a,g,j=[],h=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL;for(var d=0,e=b.length;d<e-1;d++){a=b[d];g=a.get("frame");j[d]=h?g.width:g.height}return j},overflowSegmentDim:function(){var b=this.get("childViews"),a,d,e=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL;a=b.length&&b[b.length-1];if(a){d=a.get("frame");return e?d.width:d.height}return 0},indexForClientPosition:function(b,j){var e=this.get("childViews"),h,f,d,g,a;a={x:b,y:j};for(f=0,h=e.length;f<h;f++){d=e[f];g=d.get("layer").getBoundingClientRect();g={x:g.left,y:g.top,width:(g.right-g.left),height:(g.bottom-g.top)};if(SC.pointInRect(a,g)){return f}}return -1},displayProperties:["align"],renderDelegateName:"segmentedRenderDelegate",displayItemIndexForEvent:function(b){var d=this.get("renderDelegate");var a=b.clientX;var g=b.clientY;if(a===0&&g===0){var e=b.target;if(e){var f=SC.offset(e);a=f.x+Math.round(e.offsetWidth/2);g=f.y+Math.round(e.offsetHeight/2)}}if(d&&d.indexForClientPosition){return d.indexForClientPosition(this,a,g)}return this.indexForClientPosition(b.clientX,b.clientY)},keyDown:function(d){var h,j,e,f,g,b;if(d.which===9||d.keyCode===9){var a=d.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{d.allowDefault()}return YES}if(!this.get("allowsMultipleSelection")){h=this.get("childViews");f=h.get("length");g=this.get("value");b=SC.isArray(g);if(d.which===39||d.which===40){if(g){for(e=0;e<f-2;e++){j=h.objectAt(e);if(b?(g.indexOf(j.get("value"))>=0):(j.get("value")===g)){this.triggerItemAtIndex(e+1)}}}else{this.triggerItemAtIndex(0)}return YES}else{if(d.which===37||d.which===38){if(g){for(e=1;e<f-1;e++){j=h.objectAt(e);if(b?(g.indexOf(j.get("value"))>=0):(j.get("value")===g)){this.triggerItemAtIndex(e-1)}}}else{this.triggerItemAtIndex(f-2)}return YES}}}return NO},mouseDown:function(a){var d=this.get("childViews"),f,e=d.get("length")-1,b;if(!this.get("isEnabled")){return YES}b=this.displayItemIndexForEvent(a);if(b>=0){f=d.objectAt(b);if(f.get("isEnabled")){f.set("isActive",YES)}this.activeChildView=f;if(b===e){this.showOverflowMenu()}else{this._isMouseDown=YES}}return YES},mouseUp:function(a){var d,b;b=this.displayItemIndexForEvent(a);if(this._isMouseDown&&(b>=0)){this.triggerItemAtIndex(b);d=this.activeChildView;if(d){d.set("isActive",NO);this.activeChildView=null}}this._isMouseDown=NO;return YES},mouseMoved:function(a){var e=this.get("childViews"),f=e.get("length")-1,d,g,b;if(this._isMouseDown){b=this.displayItemIndexForEvent(a);d=this.activeChildView;g=e.objectAt(b);if(g&&g!==d){if(d){d.set("isActive",NO)}if(g.get("isEnabled")){g.set("isActive",YES)}this.activeChildView=g;if(b===f){this.showOverflowMenu();this._isMouseDown=NO}}}return YES},mouseEntered:function(a){var d=this.get("childViews"),f,e=d.get("length")-1,b;if(this._isMouseDown){b=this.displayItemIndexForEvent(a);if(b===e){this.showOverflowMenu();this._isMouseDown=NO}else{if(b>=0){f=d.objectAt(b);if(f.get("isEnabled")){f.set("isActive",YES)}this.activeChildView=f}}}return YES},mouseExited:function(a){var b;if(this._isMouseDown){b=this.activeChildView;if(b){b.set("isActive",NO)}this.activeChildView=null}return YES},touchStart:function(f){var b=this.get("childViews"),e,d=b.get("length")-1,a;if(!this.get("isEnabled")){return YES}a=this.displayItemIndexForEvent(f);if(a>=0){e=b.objectAt(a);e.set("isActive",YES);this.activeChildView=e;if(a===d){this.showOverflowMenu()}else{this._isTouching=YES}}return YES},touchEnd:function(d){var b,a;a=this.displayItemIndexForEvent(d);if(this._isTouching&&(a>=0)){this.triggerItemAtIndex(a);b=this.activeChildView;b.set("isActive",NO);this.activeChildView=null;this._isTouching=NO}return YES},touchesDragged:function(a,f){var j=this.touchIsInBoundary(a),e=this.get("childViews"),g=e.get("length")-1,d,h,b;if(j){if(!this._isTouching){this._touchDidEnter(a)}b=this.displayItemIndexForEvent(a);d=this.activeChildView;h=e[b];if(h&&h!==d){if(d){d.set("isActive",NO)}h.set("isActive",YES);this.activeChildView=h;if(b===g){this.showOverflowMenu();this._isMouseDown=NO}}}else{if(this._isTouching){this._touchDidExit(a)}}this._isTouching=j;return YES},_touchDidExit:function(a){var b;if(this.isTouching){b=this.activeChildView;b.set("isActive",NO);this.activeChildView=null}return YES},_touchDidEnter:function(a){var d=this.get("childViews"),f,e=d.get("length")-1,b;b=this.displayItemIndexForEvent(a);if(b===e){this.showOverflowMenu();this._isTouching=NO}else{if(b>=0){f=d.objectAt(b);f.set("isActive",YES);this.activeChildView=f}}return YES},triggerItemAtIndex:function(k){var m=this.get("childViews"),h,b,n,d,j,g;h=m.objectAt(k);if(!h.get("isEnabled")){return this}j=this.get("allowsEmptySelection");g=this.get("allowsMultipleSelection");b=h.get("value");n=d=this.get("value");if(SC.empty(n)){n=[]}else{if(!SC.isArray(n)){n=[n]}}if(!g){if(j&&(n.get("length")===1)&&(n.objectAt(0)===b)){n=[]}else{n=[b]}}else{if(n.indexOf(b)>=0){if(n.get("length")>1||(n.objectAt(0)!==b)||j){n=n.without(b)}}else{n=n.concat([b])}}switch(n.get("length")){case 0:n=null;break;case 1:n=n.objectAt(0);break;default:break}var p=this.get("itemActionKey"),a=this.get("itemTargetKey"),f,l=null,e=this.getPath("pane.rootResponder"),o;if(p&&(o=this.get("items").objectAt(k))){f=o.get?o.get(p):o[p];if(a){l=o.get?o.get(a):o[a]}if(e){e.sendAction(f,l,this,this.get("pane"),n)}}if(d!==undefined&&(!f||this.get("selectSegmentWhenTriggeringAction"))){this.set("value",n)}f=this.get("action");if(f&&e){e.sendAction(f,this.get("target"),this,this.get("pane"),n)}},selectOverflowItem:function(b){var a=b.get("selectedItem");this.triggerItemAtIndex(a.get("index"));b.removeObserver("selectedItem",this,"selectOverflowItem");this.activeChildView.set("isActive",NO);this.activeChildView=null},showOverflowMenu:function(){var g=this.get("childViews"),b=g.get("length")-1,p=this.overflowItems,l,k,f,j;l=p.get("length");k=g.get("length")-1-l;j=this.get("value");f=SC.isArray(j);for(var d=0;d<l;d++){var o=p.objectAt(d),m=this.get("itemValueKey");if(f?j.indexOf(o[m])>=0:j===o[m]){o.isChecked=YES}else{o.isChecked=NO}o.index=k+d}var n=this;var a=SC.MenuPane.create({layout:{width:200},items:p,itemTitleKey:this.get("itemTitleKey"),itemIconKey:this.get("itemIconKey"),itemIsEnabledKey:this.get("itemIsEnabledKey"),itemKeyEquivalentKey:this.get("itemKeyEquivalentKey"),itemCheckboxKey:"isChecked",modalPaneDidClick:function(){arguments.callee.base.apply(this,arguments);this.removeObserver("selectedItem",n,"selectOverflowItem");n.activeChildView.set("isActive",NO);n.activeChildView=null}});var e=this.get("layer");var h=e.childNodes[e.childNodes.length-1];a.popup(h);a.addObserver("selectedItem",this,"selectOverflowItem")},valueDidChange:function(){var e=this.get("value"),d,g=this.get("childViews"),h=Infinity,f=g.lastObject(),j,a;if(this.overflowItems){d=this.overflowItems.get("length");h=g.get("length")-1-d;f.set("isSelected",NO)}for(var b=g.get("length")-2;b>=0;b--){j=g.objectAt(b);if(SC.isArray(e)?e.indexOf(j.get("value"))>=0:e===j.get("value")){j.set("isSelected",YES);if(b>=h){f.set("isSelected",YES)}}else{j.set("isSelected",NO)}}}.observes("value")});sc_require("views/button");SC.SelectView=SC.ButtonView.extend({acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),escapeHTML:YES,escapeHTMLBindingDefault:SC.Binding.oneWay().bool(),items:[],itemsBindingDefault:SC.Binding.multiple(),itemTitleKey:null,itemSortKey:null,itemValueKey:null,itemIconKey:null,itemSeparatorKey:"separator",itemIsEnabledKey:"isEnabled",localize:YES,disableSort:YES,classNames:["sc-select-view"],menu:null,_itemList:[],_itemIdx:null,value:null,checkboxEnabled:YES,showCheckbox:YES,emptyName:null,_defaultVal:null,_defaultTitle:null,_defaultIcon:null,theme:"popup",displayProperties:["icon","value","controlSize","items","escapeHTML","emptyName"],preferMatrix:null,CUSTOM_MENU_ITEM_HEIGHT:20,isActiveBinding:"*menu.isVisibleInWindow",isDefaultPosition:NO,lastMenuWidth:null,exampleView:null,customViewMenuOffsetWidth:0,needsEllipsis:YES,menuPaneHeightPadding:0,menuItemPadding:35,isContextMenuEnabled:NO,supportFocusRing:YES,leftAlign:function(){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:return SC.SelectView.TINY_OFFSET_X;case SC.SMALL_CONTROL_SIZE:return SC.SelectView.SMALL_OFFSET_X;case SC.REGULAR_CONTROL_SIZE:return SC.SelectView.REGULAR_OFFSET_X;case SC.LARGE_CONTROL_SIZE:return SC.SelectView.LARGE_OFFSET_X;case SC.HUGE_CONTROL_SIZE:return SC.SelectView.HUGE_OFFSET_X}return 0}.property("controlSize"),sortObjects:function(b){if(!this.get("disableSort")){var a=this.get("itemSortKey")||this.get("itemTitleKey");b=b.sort(function(e,d){if(a){e=e.get?e.get(a):e[a];d=d.get?d.get(a):d[a]}return(e<d)?-1:((e>d)?1:0)})}return b},render:function(b,h){arguments.callee.base.apply(this,arguments);var t,e,n,u,w,B,j,g,z,k,q,a,p,f,m,A,v,s,x,o,l,y,d;n=this.get("items")||[];n=this.sortObjects(n);u=n.length;w=this.get("itemTitleKey");B=this.get("itemIconKey");j=this.get("itemValueKey");g=this.get("itemSeparatorKey");z=this.get("showCheckbox");l=this.get("itemIsEnabledKey");t=this.get("escapeHTML");k=this.get("value");q=this.get("localize");p=[];f=YES;m=0;y=this.get("emptyName");if(!SC.none(y)){y=q?SC.String.loc(y):y;y=t?SC.RenderContext.escapeHTML(y):y;x=SC.Object.create({separator:NO,title:y,icon:null,value:null,isEnabled:YES,checkbox:NO,target:this,action:"displaySelectedItem"});if(SC.none(k)){this.set("title",y)}p.push(x)}n.forEach(function(C){if(C||C===0){a=g?(C.get?C.get(g):C[g]):NO;if(!a){A=w?(C.get?C.get(w):C[w]):C.toString();A=q?SC.String.loc(A):A;v=B?(C.get?C.get(B):C[B]):null;if(SC.none(C[B])){v=null}s=j?(C.get?C.get(j):C[j]):C;if(!SC.none(k)&&!SC.none(s)){d=false;if(SC.kindOf(k,SC.Record)&&SC.kindOf(s,SC.Record)){d=k.get("storeKey")===s.get("storeKey")}if(k===s||d){this.set("title",A);this.set("icon",v)}}if(s===this.get("value")){this.set("_itemIdx",m);f=!z?NO:YES}else{f=NO}o=(C.get?C.get(l):C[l]);if(NO!==o){o=YES}if(SC.none(this._defaultVal)&&o){this._defaultVal=s;this._defaultTitle=A;this._defaultIcon=v}}x=SC.Object.create({separator:a,title:A,icon:v,value:s,isEnabled:o,checkbox:f,target:this,action:"displaySelectedItem"});p.push(x)}m+=1},this);this.set("_itemList",p);if(p.length==0&&this.get("value")==""){this.set("title","")}if(h){this.invokeLast(function(){var C=this.get("value");if(SC.none(C)){if(SC.none(y)){this.set("value",this._defaultVal);this.set("title",this._defaultTitle);this.set("icon",this._defaultIcon)}else{this.set("title",y)}}})}this.changeSelectPreferMatrix(this.get("_itemIdx"))},_action:function(n){var k,a,l,m,t,p,B,f,A,d,o,v,q,y,g,h,b,z,j,u;k=this.$(".sc-button-label")[0];var C=SC.SelectView.MENU_WIDTH_OFFSET;if(!this.get("isDefaultPosition")){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:C+=SC.SelectView.TINY_POPUP_MENU_WIDTH_OFFSET;break;case SC.SMALL_CONTROL_SIZE:C+=SC.SelectView.SMALL_POPUP_MENU_WIDTH_OFFSET;break;case SC.REGULAR_CONTROL_SIZE:C+=SC.SelectView.REGULAR_POPUP_MENU_WIDTH_OFFSET;break;case SC.LARGE_CONTROL_SIZE:C+=SC.SelectView.LARGE_POPUP_MENU_WIDTH_OFFSET;break;case SC.HUGE_CONTROL_SIZE:C+=SC.SelectView.HUGE_POPUP_MENU_WIDTH_OFFSET;break}}a=this.get("layer").offsetWidth+C;a=this.get("layer").offsetWidth;l=k.scrollWidth;m=this.get("lastMenuWidth");if(l){t=k.offsetWidth;if(l&&t){a=a+l-t}}if(!m||(a>m)){m=a}p=this.get("_itemList");var w=this.get("customViewClassName");var s=this.get("customViewMenuOffsetWidth");var e="sc-view sc-pane sc-panel sc-palette sc-picker sc-menu select-button sc-scroll-view sc-menu-scroll-view sc-container-view menuContainer sc-button-view sc-menu-item sc-regular-size";e=w?(e+" "+w):e;SC.prepareStringMeasurement("",e);for(o=0,z=p.length;o<z;++o){A=p.objectAt(o);B=SC.measureString(A.title).width;if(!f||(B>f)){f=B}}SC.teardownStringMeasurement();m=(f+this.menuItemPadding>m)?f+this.menuItemPadding:m;var x=SC.RootResponder.responder.get("currentWindowSize").width;if(m>x){m=(x-25)}this.set("lastMenuWidth",m);v=this.get("value");q=this.get("_itemList");y=this.get("controlSize");g=this.get("menuPaneHeightPadding");u=this.get("escapeHTML");h=this.get("exampleView")||SC.MenuItemView.extend({escapeHTML:u});b=SC.MenuPane.create({classNames:["select-button"],items:q,exampleView:h,isEnabled:YES,menuHeightPadding:g,preferType:SC.PICKER_MENU,itemHeightKey:"height",layout:{width:m},controlSize:y,itemWidth:m});if(!b){return NO}b.popup(this,this.preferMatrix);this.set("menu",b);j=this._itemIdx;if(!SC.empty(j)&&j>-1){h=b.menuItemViewForContentIndex(j);if(h){h.becomeFirstResponder()}}this.set("isActive",YES);return YES},displaySelectedItem:function(a){var b=a.get("selectedItem");this.set("value",b.get("value"));this.set("title",b.get("title"));this.set("_itemIdx",b.get("contentIndex"))},changeSelectPreferMatrix:function(){var d=0,h=0;switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:d=SC.SelectView.TINY_OFFSET_Y;h=SC.MenuPane.TINY_MENU_ITEM_HEIGHT;break;case SC.SMALL_CONTROL_SIZE:d=SC.SelectView.SMALL_OFFSET_Y;h=SC.MenuPane.SMALL_MENU_ITEM_HEIGHT;break;case SC.REGULAR_CONTROL_SIZE:d=SC.SelectView.REGULAR_OFFSET_Y;h=SC.MenuPane.REGULAR_MENU_ITEM_HEIGHT;break;case SC.LARGE_CONTROL_SIZE:d=SC.SelectView.LARGE_OFFSET_Y;h=SC.MenuPane.LARGE_MENU_ITEM_HEIGHT;break;case SC.HUGE_CONTROL_SIZE:d=SC.SelectView.HUGE_OFFSET_Y;h=SC.MenuPane.HUGE_MENU_ITEM_HEIGHT;break}var f=d,b=this.get("_itemIdx"),a=this.get("leftAlign"),g,e;if(this.get("isDefaultPosition")){g=[1,0,3];this.set("preferMatrix",g)}else{if(b){f=b*h+d}e=[a,-f,2];this.set("preferMatrix",e)}},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;this.becomeFirstResponder();this._action();return YES},mouseUp:function(b){var e=this.get("menu"),a,d;if(e){a=e.getPath("rootMenu.targetMenuItem");if(a&&e.get("mouseHasEntered")){if(!a.performAction()){e.remove()}}else{if(b.timeStamp-this._mouseDownTimestamp>400){e.remove()}}}this._isMouseDown=NO;this.set("isActive",NO);return YES},mouseExited:function(){return YES},keyDown:function(a){if(this.interpretKeyEvents(a)){return YES}else{return arguments.callee.base.apply(this,arguments)}},interpretKeyEvents:function(a){if(a){if((a.keyCode===38||a.keyCode===40)){this._action()}else{if(a.keyCode===27){this.resignFirstResponder()}}}return arguments.callee.base.apply(this,arguments)},_button_isSelectedDidChange:function(){}.observes("isSelected")});SC.SelectView.TINY_OFFSET_X=0;SC.SelectView.TINY_OFFSET_Y=0;SC.SelectView.TINY_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectView.SMALL_OFFSET_X=-18;SC.SelectView.SMALL_OFFSET_Y=3;SC.SelectView.SMALL_POPUP_MENU_WIDTH_OFFSET=7;SC.SelectView.REGULAR_OFFSET_X=-17;SC.SelectView.REGULAR_OFFSET_Y=0;SC.SelectView.REGULAR_POPUP_MENU_WIDTH_OFFSET=4;SC.SelectView.LARGE_OFFSET_X=-17;SC.SelectView.LARGE_OFFSET_Y=6;SC.SelectView.LARGE_POPUP_MENU_WIDTH_OFFSET=3;SC.SelectView.HUGE_OFFSET_X=0;SC.SelectView.HUGE_OFFSET_Y=0;SC.SelectView.HUGE_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectView.MENU_WIDTH_OFFSET=-2;sc_require("views/button");SC.SelectButtonView=SC.ButtonView.extend({init:function(){arguments.callee.base.apply(this,arguments)},escapeHTML:YES,objects:[],objectsBindingDefault:SC.Binding.multiple(),nameKey:null,sortKey:null,valueKey:null,iconKey:null,isEnabledKey:"isEnabled",localize:YES,disableSort:YES,classNames:["select-button"],menu:null,itemList:[],itemIdx:null,value:null,checkboxEnabled:YES,separatorPosition:null,_defaultVal:null,_defaultTitle:null,_defaultIcon:null,theme:"popup",displayProperties:["icon","value","controlSize","objects","objects.[]"],preferMatrix:null,SELECT_BUTTON_SPRITE_WIDTH:28,isActiveBinding:"*menu.isVisibleInWindow",isDefaultPosition:NO,lastMenuWidth:null,customView:null,customViewClassName:null,customViewMenuOffsetWidth:0,needsEllipsis:YES,menuPaneHeightPadding:0,supportFocusRing:YES,isContextMenuEnabled:NO,leftAlign:function(){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:return SC.SelectButtonView.TINY_OFFSET_X;case SC.SMALL_CONTROL_SIZE:return SC.SelectButtonView.SMALL_OFFSET_X;case SC.REGULAR_CONTROL_SIZE:return SC.SelectButtonView.REGULAR_OFFSET_X;case SC.LARGE_CONTROL_SIZE:return SC.SelectButtonView.LARGE_OFFSET_X;case SC.HUGE_CONTROL_SIZE:return SC.SelectButtonView.HUGE_OFFSET_X}return 0}.property("controlSize"),sortObjects:function(b){if(!this.get("disableSort")){var a=this.get("sortKey")||this.get("nameKey");b=b.sort(function(e,d){if(a){e=e.get?e.get(a):e[a];d=d.get?d.get(a):d[a]}return(e<d)?-1:((e>d)?1:0)})}return b},render:function(b,f){arguments.callee.base.apply(this,arguments);var d,a,p,s,w,g,u,h,n,v,m,e,k,x,q,o,t,l,j;d=this.layout.width;if(f&&d){this.adjust({width:d-this.SELECT_BUTTON_SPRITE_WIDTH})}a=this.get("objects");a=this.sortObjects(a);p=a.length;s=this.get("nameKey");w=this.get("iconKey");g=this.get("valueKey");j=this.get("isEnabledKey");u=this.get("checkboxEnabled");h=this.get("value");n=this.get("localize");v=this.get("separatorPosition");m=[];e=YES;k=0;a.forEach(function(y){if(y){x=s?(y.get?y.get(s):y[s]):y.toString();x=n?SC.String.loc(x):x;q=w?(y.get?y.get(w):y[w]):null;if(SC.none(y[w])){q=null}o=(g)?(y.get?y.get(g):y[g]):y;if(!SC.none(h)&&!SC.none(o)){if(this._equals(h,o)){this.set("title",x);this.set("icon",q)}}if(this._equals(o,this.get("value"))){if(v>0&&v<p&&k>=p-v){k++}this.set("itemIdx",k);e=!u?NO:YES}else{e=NO}l=(j)?(y.get?y.get(j):y[j]):y;if(NO!==l){l=YES}if(k===0){this._defaultVal=o;this._defaultTitle=x;this._defaultIcon=q}var z=SC.Object.create({title:x,icon:q,value:o,isEnabled:l,checkbox:e,target:this,action:"displaySelectedItem"});m.push(z)}k+=1;if(v&&k===(p-v)){var A=SC.Object.create({separator:YES});m.push(A)}this.set("itemList",m)},this);if(f){b.attr("aria-haspopup","true");this.invokeLast(function(){var y=this.get("value");if(SC.none(y)){this.set("value",this._defaultVal);this.set("title",this._defaultTitle);this.set("icon",this._defaultIcon)}})}this.changeSelectButtonPreferMatrix(this.itemIdx)},_equals:function(b,a){var d=YES;if(b&&SC.typeOf(b)===SC.T_HASH&&a&&SC.typeOf(a)===SC.T_HASH){for(var e in b){if(b[e]!==a[e]){d=NO}}}else{d=(b===a)}return d},_action:function(q){var k,a,n,o,w,t,D,f,C,d,s,x,u,A,g,h,p,b,B,j,m,E,l;k=this.$(".sc-button-label")[0];E=SC.SelectButtonView.MENU_WIDTH_OFFSET;if(!this.get("isDefaultPosition")){switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:E+=SC.SelectButtonView.TINY_POPUP_MENU_WIDTH_OFFSET;break;case SC.SMALL_CONTROL_SIZE:E+=SC.SelectButtonView.SMALL_POPUP_MENU_WIDTH_OFFSET;break;case SC.REGULAR_CONTROL_SIZE:E+=SC.SelectButtonView.REGULAR_POPUP_MENU_WIDTH_OFFSET;break;case SC.LARGE_CONTROL_SIZE:E+=SC.SelectButtonView.LARGE_POPUP_MENU_WIDTH_OFFSET;break;case SC.HUGE_CONTROL_SIZE:E+=SC.SelectButtonView.HUGE_POPUP_MENU_WIDTH_OFFSET;break}}a=this.get("layer").offsetWidth+E;n=k.scrollWidth;o=this.get("lastMenuWidth");if(n){w=k.offsetWidth;if(n&&w){a=a+n-w}}if(!o||(a>o)){o=a}t=this.get("itemList");var y=this.get("customViewClassName"),v=this.get("customViewMenuOffsetWidth"),e="sc-view sc-pane sc-panel sc-palette sc-picker sc-menu select-button menu sc-scroll-view sc-menu-scroll-view sc-container-view sc-menu-item menu-item value sc-regular-size";e=y?(e+" "+y):e;j=(this.get("customView")||SC.MenuItemView).create();m=j.get("escapeHTML");l=document.body;for(s=0,B=t.length;s<B;++s){C=t.objectAt(s);d=document.createElement("div");d.style.cssText="top:-10000px; left: -10000px;  position: absolute;";d.className=e;d.innerHTML=m?SC.RenderContext.escapeHTML(C.title):C.title;l.appendChild(d);D=d.offsetWidth+v;if(!f||(D>f)){f=D}l.removeChild(d)}f=(f>o)?f:o;var z=SC.RootResponder.responder.get("currentWindowSize").width;if(f>z){f=(z-25)}this.set("lastMenuWidth",o);x=this.get("value");u=this.get("itemList");A=this.get("controlSize");h=this.get("customView");p=h?h:SC.MenuItemView;b=SC.MenuPane.create({classNames:["select-button"],items:u,exampleView:p,isEnabled:YES,preferType:SC.PICKER_MENU,itemHeightKey:"height",layout:{width:f},controlSize:A,itemWidth:o,performKeyEquivalent:function(G,F){switch(G){case"tab":case"shift_tab":return YES;default:return arguments.callee.base.apply(this,arguments)}}});if(!b){return NO}b.popup(this,this.preferMatrix);this.set("menu",b);h=b.menuItemViewForContentIndex(this.get("itemIdx"));b.set("currentMenuItem",h);if(h){h.becomeFirstResponder()}this.set("isActive",YES);return YES},displaySelectedItem:function(a){var b=this.getPath("menu.selectedItem");if(!b){return NO}this.set("value",b.get("value"));this.set("title",b.get("title"));this.set("itemIdx",b.get("contentIndex"));return YES},changeSelectButtonPreferMatrix:function(){var b=0,j=0,e=0,f=0,k,g;switch(this.get("controlSize")){case SC.TINY_CONTROL_SIZE:b=SC.SelectButtonView.TINY_OFFSET_Y;j=SC.MenuPane.TINY_MENU_ITEM_HEIGHT;e=SC.MenuPane.TINY_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.SMALL_CONTROL_SIZE:b=SC.SelectButtonView.SMALL_OFFSET_Y;j=SC.MenuPane.SMALL_MENU_ITEM_HEIGHT;e=SC.MenuPane.SMALL_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.REGULAR_CONTROL_SIZE:b=SC.SelectButtonView.REGULAR_OFFSET_Y;j=SC.MenuPane.REGULAR_MENU_ITEM_HEIGHT;e=SC.MenuPane.REGULAR_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.LARGE_CONTROL_SIZE:b=SC.SelectButtonView.LARGE_OFFSET_Y;j=SC.MenuPane.LARGE_MENU_ITEM_HEIGHT;e=SC.MenuPane.LARGE_MENU_ITEM_SEPARATOR_HEIGHT;break;case SC.HUGE_CONTROL_SIZE:b=SC.SelectButtonView.HUGE_OFFSET_Y;j=SC.MenuPane.HUGE_MENU_ITEM_HEIGHT;e=SC.MenuPane.HUGE_MENU_ITEM_SEPARATOR_HEIGHT;break}var h=b,a=this.get("itemIdx"),m=this.get("leftAlign"),l,d;if(this.get("isDefaultPosition")){l=[1,0,3];this.set("preferMatrix",l)}else{if(a){h=a*j+b;k=this.get("separatorPosition");g=this.get("objects").length;if(k>0&&k<g&&a>=g-k){f=j-e;h-=f}}d=[m,-h,2];this.set("preferMatrix",d)}},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;this.becomeFirstResponder();this._action();this._menuRenderedTimestamp=0;var b=this;setTimeout(function(){SC.run(function(){b._menuRenderedTimestamp=Date.now()})},1);return YES},_recordMouseDownTimestamp:function(){this._menuRenderedTimestamp=new Date().getTime()},mouseUp:function(b){var e=new Date().getTime(),d=this._menuRenderedTimestamp,f=this.get("menu"),g=SC.platform.touch,a;if(d===0){d=Date.now()}if(f){a=f.getPath("rootMenu.targetMenuItem");if(a&&a.get("mouseHasEntered")){if(!a.performAction()){f.remove()}}else{if(!g&&(e-d>SC.ButtonView.CLICK_AND_HOLD_DELAY)){if(!f.get("mouseHasEntered")&&!this.get("isDefaultPosition")){a=f.get("currentMenuItem");if(a&&!a.performAction()){f.remove()}}else{f.remove()}}}}this._isMouseDown=NO;this.set("isActive",NO);return YES},mouseExited:function(){return YES},keyDown:function(a){if(this.interpretKeyEvents(a)){return YES}else{return arguments.callee.base.apply(this,arguments)}},interpretKeyEvents:function(a){if(a){if((a.keyCode===38||a.keyCode===40)){this._action()}else{if(a.keyCode===27){this.resignFirstResponder()}}}return arguments.callee.base.apply(this,arguments)},acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),insertTab:function(b){var a=this.get("nextValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},insertBacktab:function(b){var a=this.get("previousValidKeyView");if(a){a.becomeFirstResponder()}else{b.allowDefault()}return YES},_button_isSelectedDidChange:function(){}.observes("isSelected"),didAppendToDocument:function(){}});SC.SelectButtonView.TINY_OFFSET_X=0;SC.SelectButtonView.TINY_OFFSET_Y=0;SC.SelectButtonView.TINY_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectButtonView.SMALL_OFFSET_X=-18;SC.SelectButtonView.SMALL_OFFSET_Y=3;SC.SelectButtonView.SMALL_POPUP_MENU_WIDTH_OFFSET=7;SC.SelectButtonView.REGULAR_OFFSET_X=-17;SC.SelectButtonView.REGULAR_OFFSET_Y=3;SC.SelectButtonView.REGULAR_POPUP_MENU_WIDTH_OFFSET=4;SC.SelectButtonView.LARGE_OFFSET_X=-17;SC.SelectButtonView.LARGE_OFFSET_Y=6;SC.SelectButtonView.LARGE_POPUP_MENU_WIDTH_OFFSET=3;SC.SelectButtonView.HUGE_OFFSET_X=0;SC.SelectButtonView.HUGE_OFFSET_Y=0;SC.SelectButtonView.HUGE_POPUP_MENU_WIDTH_OFFSET=0;SC.SelectButtonView.MENU_WIDTH_OFFSET=-2;SC.MenuPane.TINY_MENU_ITEM_HEIGHT=10;SC.MenuPane.TINY_MENU_ITEM_SEPARATOR_HEIGHT=2;SC.MenuPane.TINY_MENU_HEIGHT_PADDING=2;SC.MenuPane.TINY_SUBMENU_OFFSET_X=0;SC.MenuPane.SMALL_MENU_ITEM_HEIGHT=16;SC.MenuPane.SMALL_MENU_ITEM_SEPARATOR_HEIGHT=7;SC.MenuPane.SMALL_MENU_HEIGHT_PADDING=4;SC.MenuPane.SMALL_SUBMENU_OFFSET_X=2;SC.MenuPane.REGULAR_MENU_ITEM_HEIGHT=22;SC.MenuPane.REGULAR_MENU_ITEM_SEPARATOR_HEIGHT=9;SC.MenuPane.REGULAR_MENU_HEIGHT_PADDING=6;SC.MenuPane.REGULAR_SUBMENU_OFFSET_X=2;SC.MenuPane.LARGE_MENU_ITEM_HEIGHT=31;SC.MenuPane.LARGE_MENU_ITEM_SEPARATOR_HEIGHT=20;SC.MenuPane.LARGE_MENU_HEIGHT_PADDING=0;SC.MenuPane.LARGE_SUBMENU_OFFSET_X=4;SC.MenuPane.HUGE_MENU_ITEM_HEIGHT=20;SC.MenuPane.HUGE_MENU_ITEM_SEPARATOR_HEIGHT=9;SC.MenuPane.HUGE_MENU_HEIGHT_PADDING=0;SC.MenuPane.HUGE_SUBMENU_OFFSET_X=0;SC.SelectFieldView=SC.FieldView.extend({displayProperties:["objects","nameKey","valueKey","isEnabled"],acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),tagName:"select",classNames:["sc-select-field-view"],objects:[],objectsBindingDefault:SC.Binding.multiple(),nameKey:null,sortKey:null,valueKey:null,emptyName:null,localize:NO,cpDidChange:YES,disableSort:NO,validateMenuItem:function(b,a){return YES},sortObjects:function(b){if(!this.get("disableSort")){var a=this.get("sortKey")||this.get("nameKey");if(a){b=b.sortProperty(a)}else{b=b.sort(function(e,d){if(a){e=e.get?e.get(a):e[a];d=d.get?d.get(a):d[a]}return(e<d)?-1:((e>d)?1:0)})}}return b},render:function(d,a){if(a||this.get("cpDidChange")){this.set("cpDidChange",NO);var g=this.get("nameKey");var l=this.get("valueKey");var k=this.get("objects");var b=this.get("value");var e,h;if(!this.get("isEnabled")){d.attr("disabled","disabled")}var j=this.get("localize");if(!l&&b){b=SC.guidFor(b)}if((b===null)||(b==="")){b="***"}if(k){k=this.sortObjects(k);if(!a){h=this.$input()[0];if(!h){return}h.innerHTML=""}var f=this.get("emptyName");if(f){if(j){f=SC.String.loc(f)}if(a){d.push('<option value="***">'+f+"</option>",'<option disabled="disabled"></option>')}else{e=document.createElement("option");e.value="***";e.innerHTML=f;h.appendChild(e);e=document.createElement("option");e.disabled="disabled";h.appendChild(e)}}k.forEach(function(p,o){if(p){var n=g?(p.get?p.get(g):p[g]):p.toString();if(j){n=SC.String.loc(n)}var q=(l)?(p.get?p.get(l):p[l]):p;if(!f&&o===0&&b==="***"){this.set("value",q)}if(q!==null&&q!==undefined){q=(SC.guidFor(q))?SC.guidFor(q):q.toString()}var m=(this.validateMenuItem&&this.validateMenuItem(q,n))?"":'disabled="disabled" ';if(a){d.push("<option "+m+'value="'+q+'">'+n+"</option>")}else{e=document.createElement("option");e.value=q;e.innerHTML=n;if(m.length>0){e.disable="disabled"}h.appendChild(e)}}else{if(a){d.push('<option disabled="disabled"></option>')}else{e=document.createElement("option");e.disabled="disabled";h.appendChild(e)}}},this);this.setFieldValue(b)}else{this.set("value",null)}}else{this.$().prop("disabled",!this.get("isEnabled"))}},_objectsObserver:function(){this.set("cpDidChange",YES)}.observes("objects"),_objectArrayObserver:function(){this.set("cpDidChange",YES);this.propertyDidChange("objects")}.observes("*objects.[]"),_nameKeyObserver:function(){this.set("cpDidChange",YES)}.observes("nameKey"),_valueKeyObserver:function(){this.set("cpDidChange",YES)}.observes("valueKey"),_isEnabledObserver:function(){this.set("cpDidChange",YES)}.observes("isEnabled"),$input:function(){return this.$()},mouseDown:function(a){if(!this.get("isEnabled")){a.stop();return YES}else{return arguments.callee.base.apply(this,arguments)}},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},getFieldValue:function(){var g=arguments.callee.base.apply(this,arguments);var d=this.get("valueKey");var f=this.get("objects");var e=null;var a;if(g=="***"){g=null}else{if(g&&f){var h=(SC.typeOf(f.length)===SC.T_FUNCTION)?f.length():f.length;while(!e&&(--h>=0)){a=f.objectAt?f.objectAt(h):f[h];if(a===null||a===undefined){continue}if(d){a=(a.get)?a.get(d):a[d]}var b=(a!==null&&a!==undefined)?(SC.guidFor(a)?SC.guidFor(a):a.toString()):null;if(g==b){e=a}}}}return(d||e)?e:g},setFieldValue:function(a){if(SC.none(a)){a="***"}else{a=((a!==null&&a!==undefined)?(SC.guidFor(a)?SC.guidFor(a):a.toString()):null)}this.$input().val(a);return this},fieldDidFocus:function(){var a=this.get("isFocused");if(!a){this.set("isFocused",true)}},fieldDidBlur:function(){var a=this.get("isFocused");if(a){this.set("isFocused",false)}},_isFocusedObserver:function(){this.$().setClass("focus",this.get("isFocused"))}.observes("isFocused"),didCreateLayer:function(){var a=this.$input();if(this.get("isEnabled")===false){this.$()[0].disabled=true}SC.Event.add(a,"blur",this,this.fieldDidBlur);SC.Event.add(a,"focus",this,this.fieldDidFocus);SC.Event.add(a,"change",this,this._field_fieldValueDidChange)},willDestroyLayer:function(){var a=this.$input();SC.Event.remove(a,"focus",this,this.fieldDidFocus);SC.Event.remove(a,"blur",this,this.fieldDidBlur);SC.Event.remove(a,"change",this,this._field_fieldValueDidChange)}});SC.SliderView=SC.View.extend(SC.Control,{classNames:"sc-slider-view",ariaRole:"slider",value:0.5,valueBindingDefault:SC.Binding.single().notEmpty(),minimum:0,minimumBindingDefault:SC.Binding.single().notEmpty(),contentMinimumKey:null,maximum:1,maximumBindingDefault:SC.Binding.single().notEmpty(),contentMaximumKey:null,step:0.1,displayProperties:["displayValue","ariaValue","minimum","maximum","step","frame"],ariaValue:function(){return this.get("value")}.property("value").cacheable(),renderDelegateName:"sliderRenderDelegate",displayValue:function(){var b=this.get("minimum"),a=this.get("maximum"),e=this.get("value"),d=this.get("step");e=Math.min(Math.max(e,b),a);if(!SC.none(d)&&d!==0){e=Math.round(e/d)*d}if(e!==0){e=Math.floor((e-b)/(a-b)*100)}return e}.property("value","minimum","maximum","step").cacheable(),_isMouseDown:NO,mouseDown:function(a){if(!this.get("isEnabled")){return YES}this.set("isActive",YES);this._isMouseDown=YES;return this._triggerHandle(a,YES)},mouseDragged:function(a){return this._isMouseDown?this._triggerHandle(a):YES},mouseUp:function(a){if(this._isMouseDown){this.set("isActive",NO)}var b=this._isMouseDown?this._triggerHandle(a):YES;this._isMouseDown=NO;return b},mouseWheel:function(b){if(!this.get("isEnabled")){return YES}var e=this.get("minimum"),a=this.get("maximum"),f=this.get("step"),d=this.get("value")+((b.wheelDeltaX+b.wheelDeltaY)*f),g=Math.round(d/f)*f;if(d<e){this.setIfChanged("value",e)}else{if(d>a){this.setIfChanged("value",a)}else{this.setIfChanged("value",d)}}return YES},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},touchesDragged:function(a){return this.mouseDragged(a)},_triggerHandle:function(k,f){var a=this.get("frame").width,d=this.get("minimum"),g=this.get("maximum"),b=this.get("step"),j=this.get("value"),e;if(f){e=this.convertFrameFromView({x:k.pageX}).x;this._evtDiff=k.pageX-e}else{e=k.pageX-this._evtDiff}e=Math.max(0,Math.min(e/a,1));if(f){var h=this.get("value");h=(h-d)/(g-d);if(Math.abs(h*a-e*a)<16){this._offset=h-e}else{this._offset=0}}e=Math.max(0,Math.min(e+this._offset,1));e=d+((g-d)*e);if(b!==0){e=Math.round(e/b)*b}if(Math.abs(j-e)>=0.01){this.set("value",e)}return YES},acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),keyDown:function(j){if(j.which===9||j.keyCode===9){var g=j.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(g){g.becomeFirstResponder()}else{j.allowDefault()}return YES}if(j.which>=33&&j.which<=40){var e=this.get("minimum"),h=this.get("maximum"),b=this.get("step"),k=h-e,a=0,d,f=this.get("value");if(j.which===37||j.which===38||j.which===34){if(b===0){if(k<100){a=f-1}else{d=Math.abs(k/100);if(d<2){d=2}a=f-d}}else{a=f-b}}if(j.which===39||j.which===40||j.which===33){if(b===0){if(k<100){a=f+2}else{d=Math.abs(k/100);if(d<2){d=2}a=f+d}}else{a=f+b}}if(j.which===36){a=h}if(j.which===35){a=e}if(a>=e&&a<=h){this.set("value",a)}}else{j.allowDefault();return NO}return YES},contentKeys:{contentValueKey:"value",contentMinimumKey:"minimum",contentMaximumKey:"maximum",contentIsIndeterminateKey:"isIndeterminate"}});sc_require("mixins/collection_group");sc_require("views/disclosure");SC.SourceListGroupView=SC.View.extend(SC.Control,SC.CollectionGroup,{classNames:["sc-source-list-group"],content:null,isGroupVisible:YES,hasGroupTitle:YES,groupTitleKey:null,groupVisibleKey:null,render:function(a,b){a.push('<div role="button" class="sc-source-list-label sc-disclosure-view sc-button-view button disclosure no-disclosure">','<img src="'+SC.BLANK_IMAGE_URL+'" class="button" />','<span class="label"></span></div>')},createChildViews:function(){},contentPropertyDidChange:function(g,d){var f=this.get("content");var j=this.outlet("labelView");if(f===null){j.setIfChanged("isVisible",NO);this.setIfChanged("hasGroupTitle",NO);return}else{j.setIfChanged("isVisible",YES);this.setIfChanged("hasGroupTitle",YES)}var b=this.getDelegateProperty("groupTitleKey",this.displayDelegate);if((d=="*")||(b&&(d==b))){var h=(f&&f.get&&b)?f.get(b):f;if(h!=this._title){this._title=h;if(h){h=h.capitalize()}j.set("title",h)}}var e=this.getDelegateProperty("groupVisibleKey",this.displayDelegate);if((d=="*")||(e&&(d==e))){if(e){j.removeClassName("no-disclosure");var a=(f&&f.get)?!!f.get(e):YES;if(a!=this.get("isGroupVisible")){this.set("isGroupVisible",a);j.set("value",a)}}else{j.addClassName("no-disclosure")}}},disclosureValueDidChange:function(d){if(d==this.get("isGroupVisible")){return}var b=this.get("content");var a=this.getDelegateProperty("groupVisibleKey",this.displayDelegate);if(b&&b.set&&a){b.set(a,d)}this.set("isGroupVisible",d);if(this.owner&&this.owner.updateChildren){this.owner.updateChildren(true)}},labelView:SC.DisclosureView.extend({value:YES,_valueObserver:function(){if(this.owner){this.owner.disclosureValueDidChange(this.get("value"))}}.observes("value")})});sc_require("views/list");sc_require("views/source_list_group");SC.SourceListView=SC.ListView.extend({theme:"source-list",classNames:["sc-source-list"],rowHeight:32,selectOnMouseDown:NO,actOnSelect:YES});SC.SplitDividerView=SC.View.extend({classNames:["sc-split-divider-view"],mouseDown:function(a){var b=this.get("splitView");return(b)?b.mouseDownInThumbView(a,this):arguments.callee.base.apply(this,arguments)},doubleClick:function(a){var b=this.get("splitView");return(b)?b.doubleClickInThumbView(a,this):arguments.callee.base.apply(this,arguments)},touchStart:function(a){return this.mouseDown(a)}});sc_require("views/split_divider");SC.RESIZE_BOTH="resize-both";SC.RESIZE_TOP_LEFT="resize-top-left";SC.RESIZE_BOTTOM_RIGHT="resize-bottom-right";SC.SplitView=SC.View.extend({classNames:["sc-split-view"],displayProperties:["layoutDirection"],delegate:null,layoutDirection:SC.LAYOUT_HORIZONTAL,canCollapseViews:YES,autoresizeBehavior:SC.RESIZE_BOTTOM_RIGHT,defaultThickness:0.5,topLeftMinThickness:null,topLeftMaxThickness:null,bottomRightMinThickness:null,bottomRightMaxThickness:null,dividerThickness:null,isSplitView:YES,topLeftView:SC.View,dividerView:SC.SplitDividerView,bottomRightView:SC.View,topLeftThickness:function(){var a=this.get("topLeftView");return a?this.thicknessForView(a):0}.property("topLeftView").cacheable(),bottomRightThickness:function(){var a=this.get("bottomRightView");return a?this.thicknessForView(a):0}.property("bottomRightView").cacheable(),thumbViewCursor:null,canCollapseView:function(a){return this.invokeDelegateMethod(this.delegate,"splitViewCanCollapse",this,a)},thicknessForView:function(a){var d=this.get("layoutDirection"),b=a.get("frame");return(d===SC.LAYOUT_HORIZONTAL)?b.width:b.height},createChildViews:function(){var f=[],d=["topLeftView","dividerView","bottomRightView"],b=d.length,a,e;for(e=0;e<b;++e){if(a=this.get(d[e])){a=this[d[e]]=this.createChildView(a,{layoutView:this,rootElementPath:[e]});f.push(a)}}this.set("childViews",f);return this},updateChildLayout:function(){var b=this.get("topLeftView"),d=this.get("bottomRightView"),k=this.get("dividerView"),f=this.get("autoresizeBehavior"),l=this.get("layoutDirection"),a=this.get("frame"),e=this._desiredTopLeftThickness,m=this.get("dividerThickness"),j=(l===SC.LAYOUT_HORIZONTAL)?a.width:a.height,n=j-m-e,h,g;m=(!SC.none(m))?m:7;g=b.get("isCollapsed")||NO;b.setIfChanged("isVisible",!g);h=SC.clone(b.get("layout"));if(l===SC.LAYOUT_HORIZONTAL){h.top=0;h.left=0;h.bottom=0;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:h.right=n+m;delete h.width;break;case SC.RESIZE_BOTTOM_RIGHT:delete h.right;delete h.height;h.width=e;break}}else{h.top=0;h.left=0;h.right=0;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:h.bottom=n+m;delete h.height;break;case SC.RESIZE_BOTTOM_RIGHT:h.height=e;delete h.bottom;delete h.width;break}}b.set("layout",h);if(k){h=SC.clone(k.get("layout"));if(l===SC.LAYOUT_HORIZONTAL){h.width=m;h.top=0;h.bottom=0;delete h.height;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:h.right=n;delete h.left;delete h.centerX;delete h.centerY;break;case SC.RESIZE_BOTTOM_RIGHT:h.left=e;delete h.right;delete h.centerX;delete h.centerY;break}}else{h.height=m;h.left=0;h.right=0;delete h.width;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_TOP_LEFT:h.bottom=n;delete h.top;delete h.centerX;delete h.centerY;break;case SC.RESIZE_BOTTOM_RIGHT:h.top=e;delete h.bottom;delete h.centerX;delete h.centerY;break}}k.set("layout",h)}g=d.get("isCollapsed")||NO;d.setIfChanged("isVisible",!g);h=SC.clone(d.get("layout"));if(l===SC.LAYOUT_HORIZONTAL){h.top=0;h.bottom=0;h.right=0;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_BOTTOM_RIGHT:h.left=e+m;delete h.width;break;case SC.RESIZE_TOP_LEFT:h.width=n;delete h.left;break}}else{h.left=0;h.right=0;h.bottom=0;switch(f){case SC.RESIZE_BOTH:throw"SC.RESIZE_BOTH is currently unsupported.";case SC.RESIZE_BOTTOM_RIGHT:h.top=e+m;delete h.height;break;case SC.RESIZE_TOP_LEFT:delete h.top;h.height=n;break}}d.set("layout",h);this.notifyPropertyChange("topLeftThickness").notifyPropertyChange("bottomRightThickness")},renderLayout:function(b,a){if(a||this._recalculateDivider){var g=this.get("layoutDirection"),d=this.get("frame"),f=this.$(),k=this.get("defaultThickness"),e=this.get("autoresizeBehavior"),j=this.get("dividerThickness"),h;if(!this.get("thumbViewCursor")){this.set("thumbViewCursor",SC.Cursor.create())}j=!SC.none(j)?j:7;if(this._recalculateDivider===undefined&&k<1){this._recalculateDivider=YES}else{if(this._recalculateDivider){this._recalculateDivider=NO}}if(f[0]){h=(g===SC.LAYOUT_HORIZONTAL)?f[0].offsetWidth:f[0].offsetHeight}else{h=(g===SC.LAYOUT_HORIZONTAL)?d.width:d.height}if(SC.none(k)||(k>0&&k<1)){k=Math.floor((h-(j))*(k||0.5))}if(e===SC.RESIZE_BOTTOM_RIGHT){this._desiredTopLeftThickness=k}else{this._desiredTopLeftThickness=h-j-k}this._topLeftView=this.get("topLeftView");this._bottomRightView=this.get("bottomRightView");this._topLeftViewThickness=this.thicknessForView(this.get("topLeftView"));this._bottomRightThickness=this.thicknessForView(this.get("bottomRightView"));this._dividerThickness=this.get("dividerThickness");this._layoutDirection=this.get("layoutDirection");this._updateTopLeftThickness(0);this._setCursorStyle();this.updateChildLayout()}arguments.callee.base.apply(this,arguments)},render:function(a,b){arguments.callee.base.apply(this,arguments);if(this._inLiveResize){this._setCursorStyle()}if(this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL){a.addClass("sc-horizontal")}else{a.addClass("sc-vertical")}},mouseDownInThumbView:function(a,d){var b=this.getPath("pane.rootResponder");if(!b){return NO}b.dragDidStart(this);this._mouseDownX=a.pageX;this._mouseDownY=a.pageY;this._thumbView=d;this._topLeftView=this.get("topLeftView");this._bottomRightView=this.get("bottomRightView");this._topLeftViewThickness=this.thicknessForView(this.get("topLeftView"));this._bottomRightThickness=this.thicknessForView(this.get("bottomRightView"));this._dividerThickness=this.get("dividerThickness");this._layoutDirection=this.get("layoutDirection");this.beginLiveResize();this._inLiveResize=YES;return YES},mouseDragged:function(a){var b=(this._layoutDirection===SC.LAYOUT_HORIZONTAL)?a.pageX-this._mouseDownX:a.pageY-this._mouseDownY;this._updateTopLeftThickness(b);return YES},mouseUp:function(a){if(this._inLiveResize===YES){this._thumbView=null;this._inLiveResize=NO;this.endLiveResize();return YES}this._setCursorStyle();return NO},touchesDragged:function(a){return this.mouseDragged(a)},touchEnd:function(a){return this.mouseUp(a)},doubleClickInThumbView:function(b,e){var a=this._topLeftView,d=a.get("isCollapsed")||NO;if(!d&&!this.canCollapseView(a)){a=this._bottomRightView;d=a.get("isCollapsed")||NO;if(!d&&!this.canCollapseView(a)){return NO}}if(!d){this._uncollapsedThickness=this.thicknessForView(a);if(a===this._topLeftView){this._updateTopLeftThickness(this.topLeftThickness()*-1)}else{this._updateBottomRightThickness(this.bottomRightThickness()*-1)}if(!a.get("isCollapsed")){this._uncollapsedThickness=null}}else{if(a===this._topLeftView){this._updateTopLeftThickness(this._uncollapsedThickness)}else{this._updateBottomRightThickness(this._uncollapsedThickness)}a._uncollapsedThickness=null}this._setCursorStyle();return true},_updateTopLeftThickness:function(f){var a=this._topLeftView,d=this._bottomRightView,g=this.thicknessForView(a),h=this.thicknessForView(d),l=this._dividerThickness,k=0,b=this._topLeftViewThickness+f,o=this._layoutDirection,q=this.canCollapseView(d),n=b,m=this.get("topLeftMaxThickness"),e=this.get("topLeftMinThickness"),p,j,s;if(!a.get("isCollapsed")){k+=g}if(!d.get("isCollapsed")){k+=h}if(!SC.none(m)){n=Math.min(m,n)}if(!SC.none(e)){n=Math.max(e,n)}m=this.get("bottomRightMaxThickness");e=this.get("bottomRightMinThickness");p=k-n;if(!SC.none(m)){p=Math.min(m,p)}if(!SC.none(e)){p=Math.max(e,p)}n=k-p;n=this.invokeDelegateMethod(this.delegate,"splitViewConstrainThickness",this,a,n);n=Math.min(n,k);n=Math.max(0,n);j=a.get("collapseAtThickness");if(!j){j=0}s=d.get("collapseAtThickness");s=SC.none(s)?k:(k-s);if((b<=j)&&this.canCollapseView(a)){m=d.get("maxThickness");if(!m||(l+k)<=m){n=0}}else{if(b>=s&&this.canCollapseView(d)){m=a.get("maxThickness");if(!m||(l+k)<=m){n=k}}}if(n!=this.thicknessForView(a)){this._desiredTopLeftThickness=n;a.set("isCollapsed",n===0);d.set("isCollapsed",n>=k);this.updateChildLayout();this.displayDidChange()}},_updateBottomRightThickness:function(f){var a=this._topLeftView,d=this._bottomRightView,g=this.thicknessForView(a),h=this.thicknessForView(d),l=this._dividerThickness,k=0,b=this._topLeftViewThickness+f,o=this._layoutDirection,q=this.canCollapseView(d),n=b,m=this.get("topLeftMaxThickness"),e=this.get("topLeftMinThickness"),p,j,s;if(!a.get("isCollapsed")){k+=g}if(!d.get("isCollapsed")){k+=h}if(!SC.none(m)){n=Math.min(m,n)}if(!SC.none(e)){n=Math.max(e,n)}m=this.get("bottomRightMaxThickness");e=this.get("bottomRightMinThickness");p=k-n;if(!SC.none(m)){p=Math.min(m,p)}if(!SC.none(e)){p=Math.max(e,p)}n=k-p;n=this.invokeDelegateMethod(this.delegate,"splitViewConstrainThickness",this,a,n);n=Math.min(n,k);n=Math.max(0,n);j=a.get("collapseAtThickness");if(!j){j=0}s=d.get("collapseAtThickness");s=SC.none(s)?k:(k-s);if((b<=j)&&this.canCollapseView(a)){m=d.get("maxThickness");if(!m||(l+k)<=m){n=0}}else{if(b>=s&&this.canCollapseView(d)){m=a.get("maxThickness");if(!m||(l+k)<=m){n=k}}}if(n!=this.thicknessForView(a)){this._desiredTopLeftThickness=n;a.set("isCollapsed",n===0);d.set("isCollapsed",n>=k);this.updateChildLayout();this.displayDidChange()}},_setCursorStyle:function(){var f=this._topLeftView,g=this._bottomRightView,b=this.get("thumbViewCursor"),d=this.thicknessForView(f),e=this.thicknessForView(g),a=this.get("dividerView");this._layoutDirection=this.get("layoutDirection");if(f.get("isCollapsed")||d===this.get("topLeftMinThickness")||e==this.get("bottomRightMaxThickness")){b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"e-resize":"s-resize")}else{if(g.get("isCollapsed")||d===this.get("topLeftMaxThickness")||e==this.get("bottomRightMinThickness")){b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"w-resize":"n-resize")}else{if(SC.browser.isIE){b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"e-resize":"n-resize")}else{b.set("cursorStyle",this._layoutDirection===SC.LAYOUT_HORIZONTAL?"ew-resize":"ns-resize")}}}a.set("cursor",b);if(this._inLiveResize){this.set("cursor",b)}}.observes("layoutDirection"),splitViewCanCollapse:function(b,a){if(b.get("canCollapseViews")===NO){return NO}if(a.get("canCollapse")===NO){return NO}return YES},splitViewConstrainThickness:function(d,a,b){return b},_forceSplitCalculation:function(){this.updateLayout()}.observes("*pane.isPaneAttached"),viewDidResize:function(){arguments.callee.base.apply(this,arguments);this.notifyPropertyChange("topLeftThickness").notifyPropertyChange("bottomRightThickness")}.observes("layout")});SC.mixin(SC.View.prototype,{splitView:function(){var a=this;while(a&&!a.isSplitView){a=a.get("parentView")}return a}.property("parentView").cacheable()});sc_require("views/collection");SC.StackedView=SC.CollectionView.extend({classNames:["sc-stacked-view"],layout:{top:0,left:0,right:0,height:1},computeNowShowing:function(a){return this.get("allContentIndexes")},updateHeight:function(a){if(a){this._updateHeight()}else{this.invokeLast(this._updateHeight)}return this},_updateHeight:function(){var f=this.get("childViews"),b=f.get("length"),d,e,a;if(b===0){a=1}else{d=f.objectAt(b-1);e=d?d.get("layer"):null;a=e?(e.offsetTop+e.offsetHeight):1;e=null}this.adjust("height",a)},didReload:function(a){return this.updateHeight()},didCreateLayer:function(){return this.updateHeight()}});SC.StaticContentView=SC.View.extend(SC.StaticLayout,{classNames:["sc-static-content-view"],displayProperties:["content"],content:null,contentLayoutDidChange:function(){this._viewFrameDidChange()},useStaticLayout:YES,frame:function(){var a=this.get("layer"),b;if(!a){return{x:0,y:0,width:0,height:0}}if(a.getBoundingClientRect&&!SC.browser.isIE8OrLower){b=a.getBoundingClientRect();return{x:0,y:0,width:b.width,height:b.height}}else{return{x:0,y:0,width:a.clientWidth,height:a.clientHeight}}}.property("content").cacheable(),parentViewDidResize:function(){this.contentLayoutDidChange()},didUpdateLayer:function(){this.contentLayoutDidChange()},render:function(a,d){var b=this.get("content");a.push(b||"")},touchStart:function(a){a.allowDefault();return YES},touchEnd:function(a){a.allowDefault();return YES}});sc_require("views/segmented");SC.TOP_LOCATION="top";SC.TOP_TOOLBAR_LOCATION="top-toolbar";SC.BOTTOM_LOCATION="bottom";SC.TabView=SC.View.extend({classNames:["sc-tab-view"],displayProperties:["nowShowing"],nowShowing:null,items:[],isEnabled:YES,itemTitleKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemWidthKey:null,itemToolTipKey:null,tabHeight:SC.REGULAR_BUTTON_HEIGHT,tabLocation:SC.TOP_LOCATION,userDefaultKey:null,_tab_nowShowingDidChange:function(){var a=this.get("nowShowing");this.get("containerView").set("nowShowing",a);this.get("segmentedView").set("value",a);return this}.observes("nowShowing"),_tab_saveUserDefault:function(){var a=this.get("nowShowing");var b=this.get("userDefaultKey");if(b){SC.userDefaults.set([b,"nowShowing"].join(":"),a)}}.observes("nowShowing"),_tab_itemsDidChange:function(){this.get("segmentedView").set("items",this.get("items"));return this}.observes("items"),init:function(){arguments.callee.base.apply(this,arguments);this._tab_nowShowingDidChange()._tab_itemsDidChange()},awake:function(){arguments.callee.base.apply(this,arguments);var a=this.get("userDefaultKey");if(a){a=[a,"nowShowing"].join(":");var b=SC.userDefaults.get(a);if(!SC.none(b)){this.set("nowShowing",b)}}},createChildViews:function(){var f=[],e,d,b=this.get("tabLocation"),a=this.get("tabHeight"),g=this.get("controlSize");if(b===SC.TOP_LOCATION){d={top:a/2+1,left:0,right:0,bottom:0,border:1}}else{if(b===SC.TOP_TOOLBAR_LOCATION){d={top:a+1,left:0,right:0,bottom:0,border:1}}else{d={top:0,left:0,right:0,bottom:(a/2)-1,border:1}}}e=this.containerView.extend({layout:d,ariaRole:"tabpanel"});this.containerView=this.createChildView(e);d=(b===SC.TOP_LOCATION||b===SC.TOP_TOOLBAR_LOCATION)?{height:a,left:0,right:0,top:0}:{height:a,left:0,right:0,bottom:0};this.segmentedView=this.get("segmentedView").extend({layout:d,controlSize:g,_sc_tab_segmented_valueDidChange:function(){var h=this.get("parentView");if(h){h.set("nowShowing",this.get("value"))}}.observes("value"),init:function(){var h=this.get("parentView");if(h){SC._TAB_ITEM_KEYS.forEach(function(j){this[j]=h.get(j)},this)}return arguments.callee.base.apply(this,arguments)}});this.segmentedView=this.createChildView(this.segmentedView);f.push(this.segmentedView);f.push(this.containerView);this.set("childViews",f);return this},containerView:SC.ContainerView.extend({renderDelegateName:"wellRenderDelegate"}),segmentedView:SC.SegmentedView});SC._TAB_ITEM_KEYS=["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemWidthKey","itemToolTipKey","itemActionKey","itemTargetKey"];SC.ThumbView=SC.View.extend({classNames:["sc-thumb-view"],isEnabled:YES,isEnabledBindingDefault:SC.Binding.bool(),prepareContext:function(a,d){var b=this.get("splitView");if(b){this.set("cursor",b.get("thumbViewCursor"))}return arguments.callee.base.apply(this,arguments)},mouseDown:function(a){if(!this.get("isEnabled")){return NO}var b=this.get("splitView");return(b)?b.mouseDownInThumbView(a,this):arguments.callee.base.apply(this,arguments)},touchStart:function(a){return this.mouseDown(a)}});SC.WebView=SC.View.extend(SC.Control,{classNames:"sc-web-view",displayProperties:["value","shouldAutoResize"],shouldAutoResize:NO,render:function(a,e){var d=this.get("value"),b;if(e){a.push('<iframe src="'+d+'" style="position: absolute; width: 100%; height: 100%; border: 0px; margin: 0px; padding: 0px;"></iframe>')}else{if(d!==this._lastSrc){b=this.$("iframe");b.attr("src","javascript:;");b.attr("src",d)}}this._lastSrc=d},didCreateLayer:function(){var a=this.$("iframe");SC.Event.add(a,"load",this,this.iframeDidLoad)},willDestroyLayer:function(){var a=this.$("iframe");SC.Event.remove(a,"load",this,this.iframeDidLoad)},iframeDidLoad:function(){if(this.get("shouldAutoResize")===YES){var a;var d=this.$("iframe")[0];if(d&&d.contentWindow){a=d.contentWindow;if(a&&a.document&&a.document.documentElement){var b=a.document.documentElement;if(!SC.browser.isIE){this.$().width(b.scrollWidth);this.$().height(b.scrollHeight)}else{this.$().width(b.scrollWidth+12);this.$().height(b.scrollHeight+5)}}}}}});SC.WELL_CONTAINER_PADDING=15;SC.WellView=SC.ContainerView.extend({classNames:"sc-well-view",contentLayout:{top:SC.WELL_CONTAINER_PADDING,bottom:SC.WELL_CONTAINER_PADDING,left:SC.WELL_CONTAINER_PADDING,right:SC.WELL_CONTAINER_PADDING},renderDelegateName:"wellRenderDelegate",createChildViews:function(){var a=this.get("contentView");if(a){a=this.contentView=this.createChildView(a);a.set("layout",this.contentLayout);this.childViews=[a]}},contentViewDidChange:function(){var a=this.get("contentView");a.set("layout",this.contentLayout);this.replaceContent(a)}.observes("contentView")});SC.MIXED_STATE="__MIXED__";SC.DataSource=SC.Object.extend({fetch:function(a,b){return NO},retrieveRecords:function(a,d,b){return this._handleEach(a,d,this.retrieveRecord,b)},commitRecords:function(d,b,h,g,j){var f,a,e;if(b.length>0){e=this.createRecords.call(this,d,b,j)}if(h.length>0){f=this.updateRecords.call(this,d,h,j);e=SC.none(e)?f:(e===f)?e:SC.MIXED_STATE}if(g.length>0){a=this.destroyRecords.call(this,d,g,j);e=SC.none(e)?a:(e===a)?e:SC.MIXED_STATE}return e||NO},cancel:function(a,b){return NO},updateRecords:function(a,b,d){return this._handleEach(a,b,this.updateRecord,null,d)},createRecords:function(a,b,d){return this._handleEach(a,b,this.createRecord,null,d)},destroyRecords:function(a,b,d){return this._handleEach(a,b,this.destroyRecord,null,d)},_handleEach:function(j,f,d,a,b){var g=f.length,k,h,l,e;for(k=0;k<g;k++){e=a?a[k]:b;l=d.call(this,j,f[k],e);if(h===undefined){h=l}else{if(h===YES){h=(l===YES)?YES:SC.MIXED_STATE}else{if(h===NO){h=(l===NO)?NO:SC.MIXED_STATE}}}}return !SC.none(h)?h:null},updateRecord:function(a,b,d){return NO},retrieveRecord:function(a,b,d){return NO},createRecord:function(a,b,d){return NO},destroyRecord:function(a,b,d){return NO}});sc_require("data_sources/data_source");SC.CascadeDataSource=SC.DataSource.extend({dataSources:null,from:function(a){var b=this.get("dataSources");if(!b){this.set("dataSources",b=[])}b.push(a);return this},fetch:function(d,h){var f=this.get("dataSources"),b=f?f.length:0,e=NO,j,g,a;for(a=0;(e!==YES)&&a<b;a++){g=f.objectAt(a);j=g.fetch?g.fetch.apply(g,arguments):NO;e=this._handleResponse(e,j)}return e},retrieveRecords:function(j,e,b){var d=this.get("dataSources"),f=d?d.length:0,g=NO,k,a,h;for(h=0;(g!==YES)&&h<f;h++){a=d.objectAt(h);k=a.retrieveRecords.apply(a,arguments);g=this._handleResponse(g,k)}return g},commitRecords:function(l,d,j,f,e){var b=this.get("dataSources"),g=b?b.length:0,h=NO,m,a,k;for(k=0;(h!==YES)&&k<g;k++){a=b.objectAt(k);m=a.commitRecords.apply(a,arguments);h=this._handleResponse(h,m)}return h},cancel:function(d,g){var f=this.get("dataSources"),b=f?f.length:0,e=NO,j,h,a;for(a=0;(e!==YES)&&a<b;a++){h=f.objectAt(a);j=h.cancel.apply(h,arguments);e=this._handleResponse(e,j)}return e},init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("dataSources"),a=b?b.get("length"):0,d;while(--a>=0){d=b[a];if(SC.typeOf(d)===SC.T_STRING){b[a]=this.get(d)}}},_handleResponse:function(b,a){if(a===YES){return YES}else{if(b===NO){return(a===NO)?NO:SC.MIXED_STATE}else{return SC.MIXED_STATE}}}});sc_require("core");sc_require("models/record");SC.Query=SC.Object.extend(SC.Copyable,SC.Freezable,{isQuery:YES,conditions:null,orderBy:null,recordType:null,recordTypes:null,expandedRecordTypes:function(){var b=SC.CoreSet.create(),a,d;if(a=this.get("recordType")){this._scq_expandRecordType(a,b)}else{if(a=this.get("recordTypes")){a.forEach(function(e){this._scq_expandRecordType(e,b)},this)}else{this._scq_expandRecordType(SC.Record,b)}}d=SC.Query._scq_queriesWithExpandedRecordTypes;if(!d){d=SC.Query._scq_queriesWithExpandedRecordTypes=SC.CoreSet.create()}d.add(this);return b.freeze()}.property("recordType","recordTypes").cacheable(),_scq_expandRecordType:function(b,a){if(a.contains(b)){return}a.add(b);if(SC.typeOf(b)===SC.T_STRING){b=SC.objectForPropertyPath(b)}b.subclasses.forEach(function(d){this._scq_expandRecordType(d,a)},this)},parameters:null,location:"local",scope:null,isRemote:function(){return this.get("location")===SC.Query.REMOTE}.property("location").cacheable(),isLocal:function(){return this.get("location")===SC.Query.LOCAL}.property("location").cacheable(),isEditable:NO,contains:function(a,e){var f,b=YES;if(f=this.get("recordTypes")){b=f.find(function(g){return SC.kindOf(a,g)})}else{if(f=this.get("recordType")){b=SC.kindOf(a,f)}}if(!b){return NO}var d=this.get("scope");if(d&&!d.contains(a)){return NO}if(!this._isReady){this.parse()}if(!this._isReady){return NO}if(e===undefined){e=this.parameters||this}return this._tokenTree.evaluate(a,e)},containsRecordTypes:function(a){var b=this.get("recordType");if(b){return !!a.find(function(d){return SC.kindOf(d,b)})}else{if(b=this.get("recordTypes")){return !!b.find(function(d){return !!a.find(function(e){return SC.kindOf(e,d)})})}else{return YES}}},compare:function(h,e){var d=0,g,b,a,j,f;if(h===e){return 0}if(!this._isReady){this.parse()}if(!this._isReady){return SC.compare(h.get("storeKey"),e.get("storeKey"))}b=this._order;if(SC.typeOf(b)===SC.T_FUNCTION){d=b.call(null,h,e)}else{a=b?b.length:0;for(j=0;d===0&&(j<a);j++){g=b[j].propertyName;f=/\./.test(g)?"getPath":"get";if(SC.Query.comparisons[g]){d=SC.Query.comparisons[g](h[f](g),e[f](g))}else{d=SC.compare(h[f](g),e[f](g))}if((d!==0)&&b[j].descending){d=(-1)*d}}}if(d!==0){return d}else{return SC.compare(h.get("storeKey"),e.get("storeKey"))}},_isReady:NO,parse:function(){var d=this.get("conditions"),e=this.get("queryLanguage"),b,a;b=this._tokenList=this.tokenizeString(d,e);a=this._tokenTree=this.buildTokenTree(b,e);this._order=this.buildOrder(this.get("orderBy"));this._isReady=!!a&&!a.error;if(a&&a.error){throw a.error}return this._isReady},queryWithScope:function(d){var b=SC.keyFor("__query__",SC.guidFor(this)),a=d[b];if(!a){d[b]=a=this.copy();a.set("scope",d);a.freeze()}return a},copyKeys:["conditions","orderBy","recordType","recordTypes","parameters","location","scope"],concatenatedProperties:["copyKeys"],copy:function(){var e={},d=this.get("copyKeys"),g=d?d.length:0,b,f,a;while(--g>=0){b=d[g];f=this.get(b);if(f!==undefined){e[b]=f}}a=this.constructor.create(e);e=null;return a},queryLanguage:{UNKNOWN:{firstCharacter:/[^\s'"\w\d\(\)\{\}]/,notAllowed:/[\-\s'"\w\d\(\)\{\}]/},PROPERTY:{firstCharacter:/[a-zA-Z_]/,notAllowed:/[^a-zA-Z_0-9\.]/,evalType:"PRIMITIVE",evaluate:function(f,b){var g=this.tokenValue.split(".");var a=g.length;if(a<2){return f.get(this.tokenValue)}var d=f;for(var e=0;e<a;e++){if(!d){return}if(d.get){d=d.get(g[e])}else{d=d[g[e]]}}return d}},NUMBER:{firstCharacter:/[\d\-]/,notAllowed:/[^\d\-\.]/,format:/^-?\d+$|^-?\d+\.\d+$/,evalType:"PRIMITIVE",evaluate:function(b,a){return parseFloat(this.tokenValue)}},STRING:{firstCharacter:/['"]/,delimited:true,evalType:"PRIMITIVE",evaluate:function(b,a){return this.tokenValue}},PARAMETER:{firstCharacter:/\{/,lastCharacter:"}",delimited:true,evalType:"PRIMITIVE",evaluate:function(b,a){return a[this.tokenValue]}},"%@":{rememberCount:true,reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return a[this.tokenValue]}},OPEN_PAREN:{firstCharacter:/\(/,singleCharacter:true},CLOSE_PAREN:{firstCharacter:/\)/,singleCharacter:true},AND:{reservedWord:true,leftType:"BOOLEAN",rightType:"BOOLEAN",evalType:"BOOLEAN",evaluate:function(d,a){var e=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);return e&&b}},OR:{reservedWord:true,leftType:"BOOLEAN",rightType:"BOOLEAN",evalType:"BOOLEAN",evaluate:function(d,a){var e=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);return e||b}},NOT:{reservedWord:true,rightType:"BOOLEAN",evalType:"BOOLEAN",evaluate:function(d,a){var b=this.rightSide.evaluate(d,a);return !b}},"=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var e=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);return SC.isEqual(e,b)}},"!=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var e=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);return !SC.isEqual(e,b)}},"<":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var e=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);return SC.compare(e,b)==-1}},"<=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var e=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);return SC.compare(e,b)!=1}},">":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var e=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);return SC.compare(e,b)==1}},">=":{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var e=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);return SC.compare(e,b)!=-1}},BEGINS_WITH:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var b=this.leftSide.evaluate(d,a);var e=this.rightSide.evaluate(d,a);return(b&&b.indexOf(e)===0)}},ENDS_WITH:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(e,b){var d=this.leftSide.evaluate(e,b);var a=this.rightSide.evaluate(e,b);return(d&&d.length>=a.length&&d.lastIndexOf(a)===(d.length-a.length))}},CONTAINS:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(f,a){var e=this.leftSide.evaluate(f,a)||[];var h=this.rightSide.evaluate(f,a);var d=SC.typeOf(e);if(d===SC.T_STRING){return(e.indexOf(h)!==-1)}else{if(d===SC.T_ARRAY||e.toArray){if(d!==SC.T_ARRAY){e=e.toArray()}var g=false;var b=0;while(g===false&&b<e.length){if(h==e[b]){g=true}b++}return g}}}},ANY:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(e,a){var g=this.leftSide.evaluate(e,a);var b=this.rightSide.evaluate(e,a);var f=false;var d=0;while(f===false&&d<b.length){if(g==b[d]){f=true}d++}return f}},MATCHES:{reservedWord:true,leftType:"PRIMITIVE",rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(d,a){var e=this.leftSide.evaluate(d,a);var b=this.rightSide.evaluate(d,a);return b.test(e)}},TYPE_IS:{reservedWord:true,rightType:"PRIMITIVE",evalType:"BOOLEAN",evaluate:function(e,a){var d=SC.Store.recordTypeFor(e.storeKey);var b=this.rightSide.evaluate(e,a);var f=SC.objectForPropertyPath(b);return d==f}},"null":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return null}},"undefined":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return undefined}},"false":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return false}},"true":{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return true}},YES:{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return true}},NO:{reservedWord:true,evalType:"PRIMITIVE",evaluate:function(b,a){return false}}},tokenizeString:function(v,p){var j=[],s=null,g=null,f=null,u=null,a=null,h=null,d=null,w=null,q=false,b=false,l=false,m=false,n={};function e(y,t){g=p[y];if(g.format&&!g.format.test(t)){y="UNKNOWN"}if(g.delimited){m=true}if(!g.delimited){for(var x in p){if(p[x].reservedWord&&x==t){y=x}}}g=p[y];if(g&&g.rememberCount){if(!n[y]){n[y]=0}t=n[y];n[y]+=1}j.push({tokenType:y,tokenValue:t});a=null;h=null;d=null}if(!v){return[]}var k=v.length;for(var o=0;o<k;o++){q=(o===k-1);s=v.charAt(o);m=false;if(a){g=p[a];b=g.delimited?s===w:g.notAllowed.test(s);if(!b){d+=s}if(b||q){e(a,d)}if(q&&!b){m=true}}if(!a&&!m){for(f in p){g=p[f];if(g.firstCharacter&&g.firstCharacter.test(s)){a=f}}if(a){g=p[a];d=s;if(g.delimited){d="";if(g.lastCharacter){w=g.lastCharacter}else{w=s}}if(g.singleCharacter||q){e(a,d)}}}}return j},buildTokenTree:function(m,a){var p=m.slice();var s=0;var u=[];var d=false;var q=[];if(!m||m.length===0){return{evaluate:function(){return true}}}function t(l){var y=l;if(y<0){return false}var x=a[p[y].tokenType];if(!x){q.push("logic for token '"+p[y].tokenType+"' is not defined");return false}p[y].evaluate=x.evaluate;return x}function b(y,l){var z=l;var x=t(z);if(!x){return false}if(y=="left"){return x.leftType}if(y=="right"){return x.rightType}}function o(l){var y=l;var x=t(y);if(!x){return false}else{return x.evalType}}function g(l){p.splice(l,1);if(l<=s){s--}}function v(l){var x=l||s;if(x>0){return true}else{return false}}function k(l){var x=l;if(x<0){return true}return(b("left",x)&&!p[x].leftSide)||(b("right",x)&&!p[x].rightSide)}function j(x,y){var l=(y<x)?"left":"right";if(x<0||y<0){return false}if(!b(l,x)){return false}if(!o(y)){return false}if(b(l,x)==o(y)){return true}else{return false}}function n(l){var x=l;if(!k(x)){return false}if(!v(x)){return false}if(j(x,x-1)){return true}else{return false}}function e(l){var x=l;if(k(x)){return false}if(!v(x)){return false}if(!k(x-1)){return false}if(j(x-1,x)){return true}else{return false}}function h(l){var x=l;if(x<1){return false}p[x].leftSide=p[x-1];g(x-1)}function w(l){var x=l;if(x<1){return false}p[x-1].rightSide=p[x];g(x)}function f(l){g(l);g(u.pop())}for(s=0;s<p.length;s++){d=false;if(p[s].tokenType=="UNKNOWN"){q.push("found unknown token: "+p[s].tokenValue)}if(p[s].tokenType=="OPEN_PAREN"){u.push(s)}if(p[s].tokenType=="CLOSE_PAREN"){f(s)}if(n(s)){h(s)}if(e(s)){w(s);d=true}if(d){s--}}if(p.length==1){p=p[0]}else{q.push("string did not resolve to a single tree")}if(q.length>0){return{error:q.join(",\n"),tree:p}}else{return p}},buildOrder:function(a){if(!a){return[]}else{if(SC.typeOf(a)===SC.T_FUNCTION){return a}else{var e=a.split(",");for(var b=0;b<e.length;b++){var d=e[b];d=d.replace(/^\s+|\s+$/,"");d=d.replace(/\s+/,",");d=d.split(",");e[b]={propertyName:d[0]};if(d[1]&&d[1]=="DESC"){e[b].descending=true}}return e}}}});SC.Query.mixin({LOCAL:"local",REMOTE:"remote",storeKeyFor:function(a){return a?a.get("storeKey"):null},containsRecords:function(h,f,e){var g=[];for(var b=0,a=f.get("length");b<a;b++){var d=f.objectAt(b);if(d&&h.contains(d)){g.push(d.get("storeKey"))}}g=SC.Query.orderStoreKeys(g,h,e);return g},orderStoreKeys:function(d,e,a){if(d){var b=d.sort(function(g,f){return SC.Query.compareStoreKeys(e,a,g,f)})}return d},compareStoreKeys:function(g,d,f,e){var b=d.materializeRecord(f),a=d.materializeRecord(e);return g.compare(b,a)},build:function(j,d,h,e){var a=null,g,b,k,f;if(d&&d.isQuery){if(d.get("location")===j){return d}else{return d.copy().set("location",j).freeze()}}if(typeof d===SC.T_STRING){g=SC.objectForPropertyPath(d);if(!g){throw"%@ did not resolve to a class".fmt(d)}d=g}else{if(d&&d.isEnumerable){g=[];d.forEach(function(l){if(typeof l===SC.T_STRING){l=SC.objectForPropertyPath(l)}if(!l){throw"cannot resolve record types: %@".fmt(d)}g.push(l)},this);d=g}else{if(!d){d=SC.Record}}}if(e===undefined){e=null}if(h===undefined){h=null}if(!e&&(typeof h!==SC.T_STRING)){a=h;h=null}if(!e&&!a){f=SC.Query._scq_recordTypeCache;if(!f){f=SC.Query._scq_recordTypeCache={}}b=f[j];if(!b){b=f[j]={}}if(d.isEnumerable){k=d.map(function(l){return SC.guidFor(l)});k=k.sort().join(":")}else{k=SC.guidFor(d)}if(h){k=[k,h].join("::")}g=b[k];if(!g){if(d.isEnumerable){a={recordTypes:d.copy()}}else{a={recordType:d}}a.location=j;a.conditions=h;g=b[k]=SC.Query.create(a).freeze()}}else{if(!a){a={}}if(!a.location){a.location=j}if(d&&d.isEnumerable){a.recordTypes=d}else{a.recordType=d}if(h){a.conditions=h}if(e){a.parameters=e}g=SC.Query.create(a).freeze()}return g},local:function(d,a,b){return this.build(SC.Query.LOCAL,d,a,b)},remote:function(d,a,b){return this.build(SC.Query.REMOTE,d,a,b)},_scq_didDefineRecordType:function(){var a=SC.Query._scq_queriesWithExpandedRecordTypes;if(a){a.forEach(function(b){b.notifyPropertyChange("expandedRecordTypes")},this);a.clear()}}});SC.Query.comparisons={};SC.Query.registerComparison=function(a,b){SC.Query.comparisons[a]=b};SC.Query.registerQueryExtension=function(b,a){SC.Query.prototype.queryLanguage[b]=a};SC.Q=SC.Query.from;sc_require("system/query");SC.Record=SC.Object.extend({isRecord:YES,isParentRecord:NO,primaryKey:"guid",id:function(a,b){if(b!==undefined){this.writeAttribute(this.get("primaryKey"),b);return b}else{return SC.Store.idFor(this.storeKey)}}.property("storeKey").cacheable(),status:function(){return this.store.readStatus(this.storeKey)}.property("storeKey").cacheable(),store:null,storeKey:null,isDestroyed:function(){return !!(this.get("status")&SC.Record.DESTROYED)}.property("status").cacheable(),isEditable:function(a,b){if(b!==undefined){this._screc_isEditable=b}if(this.get("status")&SC.Record.READY){return this._screc_isEditable}else{return NO}}.property("status").cacheable(),_screc_isEditable:YES,isLoaded:function(){var b=SC.Record,a=this.get("status");return !((a===b.EMPTY)||(a===b.BUSY_LOADING)||(a===b.ERROR))}.property("status").cacheable(),relationships:null,attributes:function(){var a=this.get("store"),b=this.storeKey;return a.readEditableDataHash(b)}.property(),readOnlyAttributes:function(){var a=this.get("store"),d=this.storeKey,b=a.readDataHash(d);if(b){b=SC.clone(b,YES)}return b}.property(),nestedRecordNamespace:null,isNestedRecord:function(){var d=this.get("store"),e,b=this.get("storeKey"),a=d.parentStoreKeyExists(b);e=a?YES:NO;return e}.property().cacheable(),parentRecord:function(){var a=this.storeKey,b=this.get("store");return b.materializeParentRecord(a)}.property(),refresh:function(f,h){var d=this.get("store"),g,e,b=this.get("storeKey"),a=d.parentStoreKeyExists();e=f||(SC.none(f)&&SC.none(a));if(e){d.refreshRecord(null,null,b,h)}else{if(a){g=d.materializeRecord(a);g.refresh(f,h)}}return this},destroy:function(f){var d=this.get("store"),g,e,b=this.get("storeKey"),a=d.parentStoreKeyExists();e=f||(SC.none(f)&&SC.none(a));if(e){d.destroyRecord(null,null,b);this.notifyPropertyChange("status");this.propagateToAggregates()}else{if(a){g=d.materializeRecord(a);g.destroy(f)}}return this},recordDidChange:function(a){var b=this.get("parentRecord");if(b){b.recordDidChange()}this.get("store").recordDidChange(null,null,this.get("storeKey"),a);this.notifyPropertyChange("status");this.propagateToAggregates();return this},toJSON:function(){return this.get("attributes")},_editLevel:0,beginEditing:function(){this._editLevel++;return this},endEditing:function(a){if(--this._editLevel<=0){this._editLevel=0;this.recordDidChange(a)}return this},readAttribute:function(d){var a=this.get("store"),e=this.storeKey;var b=a.readDataHash(e);return b?b[d]:undefined},writeAttribute:function(d,g,f){var a=this.get("store"),e=this.storeKey,b;b=a.readEditableDataHash(e);if(!b){throw SC.Record.BAD_STATE_ERROR}if(g!==b[d]){if(!f){this.beginEditing()}b[d]=g;if(d===this.get("primaryKey")){SC.Store.replaceIdFor(e,g);this.propertyDidChange("id")}if(!f){this.endEditing(d)}else{a.dataHashDidChange(e,null,undefined,d)}}return this},propagateToAggregates:function(){var o=this.get("storeKey"),e=SC.Store.recordTypeFor(o),g=e.__sc_aggregate_keys,m,h,n,b,d,l;if(!g){g=[];for(n in this){b=this[n];if(b&&b.isRecordAttribute&&b.aggregate===YES){g.push(n)}}e.__sc_aggregate_keys=g}var k=SC.Record,a=k.DIRTY,f=k.READY_NEW,p=k.DESTROYED,q=k.READY_CLEAN,j;j=function(w){var s,t,u,v;if(w){s=this.get("status");if((s&a)||(s&f)||(s&p)){t=w.get("store");u=w.get("storeKey");v=t.peekStatus(u);if(v===q){w.get("store").recordDidChange(w.constructor,null,w.get("storeKey"),null,YES)}}}};for(m=0,h=g.length;m<h;++m){n=g[m];d=this.get(n);l=SC.kindOf(d,SC.ManyArray)?d:[d];l.forEach(j,this)}},storeDidChangeProperties:function(a,b){if(a){this.notifyPropertyChange("status")}else{if(b){this.beginPropertyChanges();b.forEach(function(f){this.notifyPropertyChange(f)},this);this.notifyPropertyChange("status");this.endPropertyChanges()}else{this.allPropertiesDidChange()}var e=this.relationships,d=e?e.length:0;while(--d>=0){e[d].recordPropertyDidChange(b)}}},normalize:function(a){var d=this.primaryKey,b=this.get("id"),g=this.get("store"),f=this.get("storeKey"),k={},u,q,e,t,l,s,n,h,p,j,o;var m=g.readEditableDataHash(f)||{};m[d]=b;t=g.readDataHash(f);for(u in this){q=this[u];if(q){e=q.typeClass;if(e){j=q.get("key")||u;k[j]=YES;n=SC.typeOf(e.call(q))===SC.T_CLASS;h=q.isNestedRecordTransform;if(!n&&!h){l=this.get(u);if(l!==undefined&&(l!==null||a)){o=this[u];if(SC.instanceOf(o,SC.RecordAttribute)){l=o.fromType(this,u,l)}m[j]=l}else{if(!a){k[j]=NO}}}else{if(h){l=this.get(u);if(l&&l.normalize){l.normalize()}}else{if(n){l=t[j];if(l!==undefined){m[j]=l}else{p=q.get("defaultValue");if(SC.typeOf(p)===SC.T_FUNCTION){m[j]=p(this,u,p)}else{m[j]=p}}}}}}}}for(u in m){if(!k[u]){SC.debug("%@:  Deleting key from underlying data hash due to normalization:  %@",this,u);delete m[u]}}return this},unknownProperty:function(b,e){if(e!==undefined){var d=this.get("storeKey"),f=SC.Store.recordTypeFor(d);if(f.ignoreUnknownProperties===YES){this[b]=e;return e}var a=this.get("primaryKey");this.writeAttribute(b,e);if(b===a){SC.Store.replaceIdFor(d,e)}}return this.readAttribute(b)},commitRecord:function(h,f,j){var d=this.get("store"),g,e,b=this.get("storeKey"),a=d.parentStoreKeyExists();e=f||(SC.none(f)&&SC.none(a));if(e){d.commitRecord(undefined,undefined,this.get("storeKey"),h,j)}else{if(a){g=d.materializeRecord(a);g.commitRecord(h,f,j)}}return this},isError:function(){return !!(this.get("status")&SC.Record.ERROR)}.property("status").cacheable(),errorValue:function(){return this.get("isError")?SC.val(this.get("errorObject")):null}.property("isError").cacheable(),errorObject:function(){if(this.get("isError")){var a=this.get("store");return a.readError(this.get("storeKey"))||SC.Record.GENERIC_ERROR}else{return null}}.property("isError").cacheable(),set:function(a,d){var b=this[a];if(b&&b.isProperty&&b.get&&!b.get("isEditable")){return this}return arguments.callee.base.apply(this,arguments)},toString:function(){var a=this.get("store").readDataHash(this.get("storeKey"));return"%@(%@) %@".fmt(this.constructor.toString(),SC.inspect(a),this.statusString())},statusString:function(){var b=[],a=this.get("status");for(var d in SC.Record){if(d.match(/[A-Z_]$/)&&SC.Record[d]===a){b.push(d)}}return b.join(" ")},registerNestedRecord:function(g,f,h){var d,e=this.get("storeKey"),b,a,j;if(SC.none(h)){h=f}if(g&&g.get&&g.get("isRecord")){a=g}else{j=this._materializeNestedRecordType(g,f);a=this.createNestedRecord(j,g,e,h)}if(a){this.isParentRecord=YES;d=this.get("store");b=a.get("storeKey");d.registerChildToParent(e,b,h)}return a},unregisterNestedRecord:function(e){var b,a,d;d=this.get("store");b=this.getPath(e);a=b.get("storeKey");d.unregisterChildFromParent(a)},_materializeNestedRecordType:function(e,d){var a,f,b;if(SC.typeOf(e)===SC.T_HASH){a=this.get("nestedRecordNamespace");if(e.type&&!SC.none(a)){f=a[e.type]}}if(!f&&d&&this[d]){f=this[d].get("typeClass")}if(!f||!SC.kindOf(f,SC.Record)){throw"SC.Child: Error during transform: Invalid record type."}return f},createNestedRecord:function(b,f,h,k){var j=this.get("store"),a,d,e,g=null;f=f||{};if(SC.none(j)){throw"Error: during the creation of a child record: NO STORE ON PARENT!"}a=f[b.prototype.primaryKey];if(!a){this.generateIdForChild(g)}if(!a){a=h+"."+k}d=j.storeKeyExists(b,a);if(d){j.writeDataHash(d,f);g=j.materializeRecord(d)}else{g=j.createRecord(b,f,a)}return g},_nestedRecordKey:0,generateIdForChild:function(a){}});SC.Record.mixin({ignoreUnknownProperties:NO,CLEAN:1,DIRTY:2,EMPTY:256,ERROR:4096,READY:512,READY_CLEAN:513,READY_DIRTY:514,READY_NEW:515,DESTROYED:1024,DESTROYED_CLEAN:1025,DESTROYED_DIRTY:1026,BUSY:2048,BUSY_LOADING:2052,BUSY_CREATING:2056,BUSY_COMMITTING:2064,BUSY_REFRESH:2080,BUSY_REFRESH_CLEAN:2081,BUSY_REFRESH_DIRTY:2082,BUSY_DESTROYING:2112,BAD_STATE_ERROR:SC.$error("Internal Inconsistency"),RECORD_EXISTS_ERROR:SC.$error("Record Exists"),NOT_FOUND_ERROR:SC.$error("Not found "),BUSY_ERROR:SC.$error("Busy"),GENERIC_ERROR:SC.$error("Generic Error"),_nextChildKey:0,attr:function(a,b){return SC.RecordAttribute.attr(a,b)},fetch:function(b,a){return SC.FetchedAttribute.attr(b,a)},toMany:function(e,b){b=b||{};var d=b.nested||b.isNested;var a;this._throwUnlessRecordTypeDefined(e,"toMany");if(d){a=SC.ChildrenAttribute.attr(e,b)}else{a=SC.ManyAttribute.attr(e,b)}return a},toOne:function(e,b){b=b||{};var d=b.nested||b.isNested;var a;this._throwUnlessRecordTypeDefined(e,"toOne");if(d){a=SC.ChildAttribute.attr(e,b)}else{a=SC.SingleAttribute.attr(e,b)}return a},_throwUnlessRecordTypeDefined:function(b,a){if(!b){throw"Attempted to create "+a+" attribute with undefined recordType. Did you forget to sc_require a dependency?"}},storeKeysById:function(){var b=SC.keyFor("storeKey",SC.guidFor(this)),a=this[b];if(!a){a=this[b]={}}return a},storeKeyFor:function(d){var b=this.storeKeysById(),a=b[d];if(!a){a=SC.Store.generateStoreKey();SC.Store.idsByStoreKey[a]=d;SC.Store.recordTypesByStoreKey[a]=this;b[d]=a}return a},storeKeyExists:function(d){var b=this.storeKeysById(),a=b[d];return a},find:function(a,b){return a.find(this,b)},extend:function(){var a=SC.Object.extend.apply(this,arguments);if(SC.Query){SC.Query._scq_didDefineRecordType(a)}return a}});sc_require("data_sources/data_source");sc_require("models/record");SC.FixturesDataSource=SC.DataSource.extend({simulateRemoteResponse:NO,latency:50,cancel:function(a,b){return NO},fetch:function(a,b){if(b.get("location")!==SC.Query.LOCAL){throw SC.$error("SC.Fixture data source can only fetch local queries")}if(!b.get("recordType")&&!b.get("recordTypes")){throw SC.$error("SC.Fixture data source can only fetch queries with one or more record types")}if(this.get("simulateRemoteResponse")){this.invokeLater(this._fetch,this.get("latency"),a,b)}else{this._fetch(a,b)}},_fetch:function(a,d){var e=d.get("recordType"),b=d.get("recordTypes")||[e];b.forEach(function(f){if(SC.typeOf(f)===SC.T_STRING){f=SC.objectForPropertyPath(f)}if(f){this.loadFixturesFor(a,f)}},this);a.dataSourceDidFetchQuery(d)},retrieveRecords:function(a,d){var e=this.get("latency"),b=this.hasFixturesFor(d);if(!b){return b}if(this.get("simulateRemoteResponse")){this.invokeLater(this._retrieveRecords,e,a,d)}else{this._retrieveRecords(a,d)}return b},_retrieveRecords:function(a,b){b.forEach(function(e){var d=[],h=SC.Store.recordTypeFor(e),g=a.idFor(e),f=this.fixtureForStoreKey(a,e);d.push(e);a.dataSourceDidComplete(e,f,g)},this)},updateRecords:function(a,d,f){var e=this.get("latency"),b=this.hasFixturesFor(d);if(!b){return b}if(this.get("simulateRemoteResponse")){this.invokeLater(this._updateRecords,e,a,d)}else{this._updateRecords(a,d)}return b},_updateRecords:function(a,b){b.forEach(function(d){var e=a.readDataHash(d);this.setFixtureForStoreKey(a,d,e);a.dataSourceDidComplete(d)},this)},createRecords:function(a,b,e){var d=this.get("latency");if(this.get("simulateRemoteResponse")){this.invokeLater(this._createRecords,d,a,b)}else{this._createRecords(a,b)}return YES},_createRecords:function(a,b){b.forEach(function(f){var h=a.idFor(f),g=a.recordTypeFor(f),e=a.readDataHash(f),d=this.fixturesFor(g);if(!h){h=this.generateIdFor(g,e,a,f)}this._invalidateCachesFor(g,f,h);d[h]=e;a.dataSourceDidComplete(f,null,h)},this)},destroyRecords:function(a,d,f){var e=this.get("latency"),b=this.hasFixturesFor(d);if(!b){return b}if(this.get("simulateRemoteResponse")){this.invokeLater(this._destroyRecords,e,a,d)}else{this._destroyRecords(a,d)}return b},_destroyRecords:function(a,b){b.forEach(function(e){var g=a.idFor(e),f=a.recordTypeFor(e),d=this.fixturesFor(f);this._invalidateCachesFor(f,e,g);if(g){delete d[g]}a.dataSourceDidDestroy(e)},this)},loadFixturesFor:function(a,h,d){var b=[],f,e,g;f=this.fixturesFor(h);for(e in f){g=h.storeKeyFor(e);if(a.peekStatus(g)===SC.Record.EMPTY){b.push(f[e])}if(d){d.push(g)}}if(b&&b.length>0){a.loadRecords(h,b)}return this},generateIdFor:function(e,b,a,d){return"@id%@".fmt(SC.Store.generateStoreKey())},fixtureForStoreKey:function(a,d){var f=a.idFor(d),e=a.recordTypeFor(d),b=this.fixturesFor(e);return b?b[f]:null},setFixtureForStoreKey:function(a,e,d){var g=a.idFor(e),f=a.recordTypeFor(e),b=this.fixturesFor(f);this._invalidateCachesFor(f,e,g);b[g]=d;return this},fixturesFor:function(j){if(!this._fixtures){this._fixtures={}}var g=this._fixtures[SC.guidFor(j)];if(g){return g}var f=j?j.FIXTURES:null,b=f?f.length:0,d=j?j.prototype.primaryKey:"guid",a,e,h;this._fixtures[SC.guidFor(j)]=g={};for(a=0;a<b;a++){e=f[a];h=e[d];if(!h){h=this.generateIdFor(j,e)}g[h]=e}return g},fixturesLoadedFor:function(d){if(!this._fixtures){return NO}var a=[],b=this._fixtures[SC.guidFor(d)];return b?YES:NO},reset:function(){this._fixtures=null;return this},hasFixturesFor:function(b){var a=NO;b.forEach(function(e){if(a!==SC.MIXED_STATE){var f=SC.Store.recordTypeFor(e),d=f?f.FIXTURES:null;if(d&&d.length&&d.length>0){if(a===NO){a=YES}}else{if(a===YES){a=SC.MIXED_STATE}}}},this);return a},_invalidateCachesFor:function(e,b,d){var a=this._storeKeyCache;if(a){delete a[SC.guidFor(e)]}return this}});SC.Record.fixtures=SC.FixturesDataSource.create();SC.RelationshipSupport={_srs_inverseDidRelinquishRelationships:function(e,d,a,b){d.forEach(function(f){this._srs_inverseDidRelinquishRelationship(e,f,a,b)},this)},_srs_inverseDidRelinquishRelationship:function(j,h,g,b){var f=j.storeKeyFor(h),d=this.readDataHash(f),a=g.inverse,e=j.prototype;if(!d||!a){return}if(SC.instanceOf(e[a],SC.SingleAttribute)){delete d[a]}else{if(SC.instanceOf(e[a],SC.ManyAttribute)&&SC.typeOf(d[a])===SC.T_ARRAY){d[a].removeObject(b)}}this.pushRetrieve(j,h,d,undefined,true)},_srs_inverseDidAddRelationships:function(e,d,a,b){d.forEach(function(f){this._srs_inverseDidAddRelationship(e,f,a,b)},this)},_srs_inverseDidAddRelationship:function(b,a,k,m){var l=b.storeKeyFor(a),h=this.readDataHash(l),e=this.peekStatus(l),g=b.prototype,j=k.inverse,n=g[j],d=g[g.primaryKey],f=false;n=(n&&n.get&&n.get("key")||n.key)||j;if((e===SC.Record.EMPTY)&&(SC.typeOf(k.lazilyInstantiate)===SC.T_FUNCTION&&k.lazilyInstantiate()||SC.typeOf(k.lazilyInstantiate)!==SC.T_FUNCTION&&k.lazilyInstantiate)){if(!SC.none(d)&&d.typeClass&&SC.typeOf(d.typeClass())===SC.T_CLASS){f=true}h={};h[g.primaryKey]=a}if(!h||!j){return}if(SC.instanceOf(g[j],SC.SingleAttribute)){h[n]=m}else{if(SC.instanceOf(g[j],SC.ManyAttribute)){h[n]=h[n]||[];if(h[n].indexOf(m)<0){h[n].push(m)}}}this.pushRetrieve(b,a,h,undefined,!f)},_srs_pushIterator:function(e,b,k,g){var f=e.prototype,h,d,j,a;if(typeof k==="undefined"){k=e.storeKeyFor(b)}d=this.readDataHash(k)||{};for(j in f){h=f[j];if(h&&h.typeClass&&h.inverse&&h.isMaster){a=h.typeClass();if(SC.typeOf(a)!==SC.T_CLASS){continue}g.apply(this,[a,d,h,h.get&&h.get("key")||j])}}},pushDestroy:function(a,f,e,d){var b;this._srs_pushIterator(f,e,d,function(g,h,k,j){b=[h[j]||null].flatten().compact().uniq();this._srs_inverseDidRelinquishRelationships(g,b,k,e)});return a(f,e,d)}.enhance(),pushRetrieve:function(b,j,h,d,f,g){if(!g){var e,a;this._srs_pushIterator(j,h,f,function(k,l,n,m){e=[l[m]||null].flatten().compact().uniq();a=[d[m]||null].flatten().compact().uniq();this._srs_inverseDidRelinquishRelationships(k,e.filter(function(o){return a.indexOf(o)===-1}),n,h);this._srs_inverseDidAddRelationships(k,a,n,h)})}f=f||j.storeKeyFor(h);return b(j,h,d,f)}.enhance()};sc_require("models/record");SC.RecordAttribute=SC.Object.extend({isRecordAttribute:YES,defaultValue:null,type:String,key:null,isRequired:NO,isEditable:YES,useIsoDate:YES,aggregate:NO,lazilyInstantiate:NO,typeClass:function(){var a=this.get("type");if(SC.typeOf(a)===SC.T_STRING){a=SC.requiredObjectForPropertyPath(a)}return a}.property("type").cacheable(),transform:function(){var a=this.get("typeClass")||String,d=SC.RecordAttribute.transforms,b;while(a&&!(b=d[SC.guidFor(a)])){if(a.superclass.hasOwnProperty("create")){a=a.superclass}else{a=SC.T_FUNCTION}}return b}.property("typeClass").cacheable(),toType:function(f,k,j){var d=this.get("transform"),h=this.get("typeClass"),b;if(d&&d.to){j=d.to(j,this,h,f,k);if(!SC.none(j)&&(b=d.observesChildren)){var e,g=b.length,a={record:f,key:k};for(e=0;e<g;e++){j.addObserver(b[e],this,this._SCRA_childObserver,a)}}}return j},_SCRA_childObserver:function(e,b,d,a){this.call(a.record,a.key,e);a.record.notifyPropertyChange(a.key)},fromType:function(a,d,f){var b=this.get("transform"),e=this.get("typeClass");if(b&&b.from){f=b.from(f,this,e,a,d)}return f},call:function(a,b,d){var e=this.get("key")||b,f;if((d!==undefined)&&this.get("isEditable")){f=this.fromType(a,b,d);a.writeAttribute(e,f)}d=a.readAttribute(e);if(SC.none(d)&&(d=this.get("defaultValue"))){if(typeof d===SC.T_FUNCTION){d=d(a,b,this)}}d=this.toType(a,b,d);return d},apply:function(b,a){return this.call.apply(b,a)},isProperty:YES,isCacheable:YES,dependentKeys:[],init:function(){arguments.callee.base.apply(this,arguments);this.cacheKey="__cache__recattr__"+SC.guidFor(this);this.lastSetValueKey="__lastValue__recattr__"+SC.guidFor(this)}});SC.RecordAttribute.mixin({attr:function(a,b){if(!b){b={}}if(!b.type){b.type=a||String}return this.create(b)},transforms:{},registerTransform:function(a,b){SC.RecordAttribute.transforms[SC.guidFor(a)]=b}});SC.RecordAttribute.registerTransform(Boolean,{to:function(a){return SC.none(a)?null:!!a}});SC.RecordAttribute.registerTransform(Number,{to:function(a){return SC.none(a)?null:Number(a)}});SC.RecordAttribute.registerTransform(String,{to:function(a){if(!(typeof a===SC.T_STRING)&&!SC.none(a)&&a.toString){a=a.toString()}return a}});SC.RecordAttribute.registerTransform(Array,{to:function(a){if(!SC.isArray(a)&&!SC.none(a)){a=[]}return a},observesChildren:["[]"]});SC.RecordAttribute.registerTransform(Object,{to:function(a){if(!(typeof a==="object")&&!SC.none(a)){a={}}return a}});SC.RecordAttribute.registerTransform(SC.Record,{to:function(f,a,e,d){var b=d.get("store");if(SC.none(f)||(f==="")){return null}else{return b.find(e,f)}},from:function(a){return a?a.get("id"):null}});SC.RecordAttribute.registerTransform(SC.T_FUNCTION,{to:function(f,a,e,d){e=e.apply(d);var b=d.get("store");return b.find(e,f)},from:function(a){return a.get("id")}});SC.RecordAttribute.registerTransform(Date,{to:function(k,a){if(SC.none(k)){return k}var e;k=k.toString()||"";if(a.get("useIsoDate")){var f="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",j=k.match(new RegExp(f)),h=0,b=new Date(j[1],0,1),g;if(j[3]){b.setMonth(j[3]-1)}if(j[5]){b.setDate(j[5])}if(j[7]){b.setHours(j[7])}if(j[8]){b.setMinutes(j[8])}if(j[10]){b.setSeconds(j[10])}if(j[12]){b.setMilliseconds(Number("0."+j[12])*1000)}if(j[14]){h=(Number(j[16])*60)+Number(j[17]);h*=((j[15]==="-")?1:-1)}h-=b.getTimezoneOffset();g=(Number(b)+(h*60*1000));e=new Date();e.setTime(Number(g))}else{e=new Date(Date.parse(k))}return e},_dates:{},_zeropad:function(a){return((a<0)?"-":"")+((a<10)?"0":"")+Math.abs(a)},from:function(b){if(SC.none(b)){return null}var a=this._dates[b.getTime()];if(a){return a}var e=this._zeropad,d=0-b.getTimezoneOffset()/60;d=(d===0)?"Z":"%@:00".fmt(e(d));this._dates[b.getTime()]=a="%@-%@-%@T%@:%@:%@%@".fmt(e(b.getFullYear()),e(b.getMonth()+1),e(b.getDate()),e(b.getHours()),e(b.getMinutes()),e(b.getSeconds()),d);return a}});if(SC.DateTime&&!SC.RecordAttribute.transforms[SC.guidFor(SC.DateTime)]){SC.RecordAttribute.registerTransform(SC.DateTime,{to:function(d,a){if(a.get("useUnixTime")){if(SC.typeOf(d)===SC.T_STRING){d=parseInt(d)}if(isNaN(d)||SC.typeOf(d)!==SC.T_NUMBER){d=0}return SC.DateTime.create({milliseconds:d*1000,timezone:0})}if(SC.none(d)||SC.instanceOf(d,SC.DateTime)){return d}if(SC.none(d)||SC.instanceOf(d,Date)){return SC.DateTime.create(d.getTime())}var b=a.get("format");return SC.DateTime.parse(d,b?b:SC.DateTime.recordFormat)},from:function(b,a){if(SC.none(b)){return b}if(a.get("useUnixTime")){return b.get("milliseconds")/1000}var d=a.get("format");return b.toFormattedString(d?d:SC.DateTime.recordFormat)}})}SC.RecordAttribute.registerTransform(SC.Set,{to:function(f,a,e,b,d){return SC.Set.create(f)},from:function(f,a,e,b,d){return f.toArray()},observesChildren:["[]"]});sc_require("models/record");sc_require("models/record_attribute");SC.ChildAttribute=SC.RecordAttribute.extend({isNestedRecordTransform:YES,toType:function(b,e,f){var d=null,a,g=this.get("typeClass");if(!b){throw"SC.Child: Error during transform: Unable to retrieve parent record."}if(!SC.none(f)){d=b.registerNestedRecord(f,e)}return d},fromType:function(b,f,g){var a,d,e;if(b){if(b.readAttribute(f)){b.unregisterNestedRecord(f)}if(SC.none(g)){b.writeAttribute(f,g);e=g}else{e=b.registerNestedRecord(g,f);if(e){a=e.get("storeKey");d=e.get("store");b.writeAttribute(f,d.readDataHash(a))}else{if(g){b.writeAttribute(f,g)}}}}return e},call:function(a,b,d){var e=this.get("key")||b;if(d!==undefined){d=this.fromType(a,b,d)}else{d=a.readAttribute(e);if(SC.none(d)&&(d=this.get("defaultValue"))){if(typeof d===SC.T_FUNCTION){d=this.defaultValue(a,b,this);if(a.attributes()){a.writeAttribute(e,d,true)}}}else{d=this.toType(a,b,d)}}return d}});sc_require("models/record");SC.ChildRecord=SC.Record.extend({});SC.ChildRecord.extend=function(){return SC.Record.extend.apply(this,arguments)};SC.ChildArray=SC.Object.extend(SC.Enumerable,SC.Array,{defaultRecordType:null,record:null,propertyName:null,children:null,store:function(){return this.getPath("record.store")}.property("record").cacheable(),storeKey:function(){return this.getPath("record.storeKey")}.property("record").cacheable(),readOnlyChildren:function(){return this.get("record").readAttribute(this.get("propertyName"))}.property(),editableChildren:function(){var a=this.get("store"),e=this.get("storeKey"),d=this.get("propertyName"),b,f;b=a.readEditableProperty(e,d);if(!b){f=a.readEditableDataHash(e);b=f[d]=[]}return b}.property(),length:function(){var a=this.get("readOnlyChildren");return a?a.length:0}.property("readOnlyChildren"),objectAt:function(b){var h=this._records,f=this.get("readOnlyChildren"),j,d,e=this.get("propertyName"),g=this.get("record");var a=f?f.length:0;if(!f){return undefined}if(h&&(d=h[b])){return d}if(!h){this._records=h=[]}if(b>=a){return undefined}j=f.objectAt(b);if(!j){return undefined}h[b]=d=g.registerNestedRecord(j,e,e+"."+b);return d},replace:function(l,a,k){var b=this.get("editableChildren"),h=k?(k.get?k.get("length"):k.length):0,g=this.get("record"),e,f=this.get("propertyName"),j,d;e=this._processRecordsToHashes(k);if(e!==this._prevChildren){this._performRecordPropertyChange(null,false)}b.replace(l,a,e);g.recordDidChange(f);return this},_processRecordsToHashes:function(d){var b,a;d=d||[];d.forEach(function(f,e){if(f.isNestedRecord){b=f.get("store");a=f.storeKey;d[e]=b.readDataHash(a)}});return d},normalize:function(){this.forEach(function(b,a){if(b.normalize){b.normalize()}})},recordPropertyDidChange:function(a){this._performRecordPropertyChange(a,true);return this},_performRecordPropertyChange:function(g,j){if(g&&!g.contains(this.get("propertyName"))){return this}var b=this.get("readOnlyChildren"),a=0,d=0;var e=this._prevChildren,h=this._childrenContentDidChange;j=SC.none(j)?true:j;if(b===e){return this}if(e){e.removeArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:h});a=e.get("length")}if(b){b.addArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:h});d=b.get("length")}this._prevChildren=b;if(j){this.arrayContentWillChange(0,a,d);this._childrenContentDidChange(0,a,d)}return this},_childrenContentDidChange:function(d,a,b){this._records=null;this.arrayContentDidChange(d,a,b)},init:function(){arguments.callee.base.apply(this,arguments);this.recordPropertyDidChange()}});sc_require("models/record");sc_require("models/record_attribute");sc_require("models/child_attribute");sc_require("system/child_array");SC.ChildrenAttribute=SC.ChildAttribute.extend({toType:function(b,e,f){var h=this.get("key")||e,g=SC.keyFor("__kidsArray__",SC.guidFor(this)),d=b[g],j=this.get("typeClass"),a;if(!d){d=SC.ChildArray.create({record:b,propertyName:h,defaultRecordType:j});b[g]=d;a=b.get("relationships");if(!a){b.set("relationships",a=[])}a.push(d)}return d},fromType:function(b,f,g){var a,d,h=SC.keyFor("__kidsArray__",SC.guidFor(this)),e=b[h];if(b){b.writeAttribute(f,g);if(e){e=e.recordPropertyDidChange()}}return e},call:function(a,d,e){var f=this.get("key")||d,b,g=SC.keyFor("__kid__",SC.guidFor(this));if(e!==undefined){e=this.fromType(a,d,e)}else{e=a.readAttribute(f);if(SC.none(e)&&(e=this.get("defaultValue"))){if(typeof e===SC.T_FUNCTION){e=this.defaultValue(a,d,this);if(a.attributes()){if(e instanceof Array){e=this.toType(a,d,e).replace(0,e.length,e)}else{a.writeAttribute(f,e,true)}}}}else{e=this.toType(a,d,e)}}return e}});sc_require("models/record");sc_require("models/record_attribute");SC.FetchedAttribute=SC.RecordAttribute.extend({paramValueKey:"link",paramOwnerKey:"owner",paramRelKey:"rel",queryKey:null,isEditable:NO,toType:function(e,k,h){var j=e.get("store");if(!j){return null}var b=this.get("paramValueKey"),a=this.get("paramOwnerKey"),g=this.get("paramRelKey"),f=this.get("queryKey")||this.get("typeClass"),d={};if(b){d[b]=h}if(a){d[a]=e}if(g){d[g]=this.get("key")||k}return j.findAll(f,d)},fromType:function(a,b,d){return d}});SC.ManyArray=SC.Object.extend(SC.Enumerable,SC.Array,{recordType:null,record:null,propertyName:null,manyAttribute:null,store:function(){return this.get("record").get("store")}.property("record").cacheable(),storeKey:function(){return this.get("record").get("storeKey")}.property("record").cacheable(),readOnlyStoreIds:function(){return this.get("record").readAttribute(this.get("propertyName"))}.property(),editableStoreIds:function(){var a=this.get("store"),e=this.get("storeKey"),d=this.get("propertyName"),b,f;b=a.readEditableProperty(e,d);if(!b){f=a.readEditableDataHash(e);b=f[d]=[]}if(b!==this._prevStoreIds){this.recordPropertyDidChange()}return b}.property(),isEditable:function(){var a=this.manyAttribute;return a?a.get("isEditable"):NO}.property("manyAttribute").cacheable(),inverse:function(){var a=this.manyAttribute;return a?a.get("inverse"):null}.property("manyAttribute").cacheable(),isMaster:function(){var a=this.manyAttribute;return a?a.get("isMaster"):null}.property("manyAttribute").cacheable(),orderBy:function(){var a=this.manyAttribute;return a?a.get("orderBy"):null}.property("manyAttribute").cacheable(),length:function(){var a=this.get("readOnlyStoreIds");return a?a.get("length"):0}.property("readOnlyStoreIds"),objectAt:function(a){var h=this._records,g=this.get("readOnlyStoreIds"),d=this.get("store"),j=this.get("recordType"),f,e,b;if(!g||!d){return undefined}if(h&&(e=h[a])){return e}if(!h){this._records=h=[]}b=g.objectAt(a);if(b){f=d.storeKeyFor(j,b);if(d.readStatus(f)===SC.Record.EMPTY){d.retrieveRecord(j,null,f)}h[a]=e=d.materializeRecord(f)}return e},replace:function(o,e,n){if(!this.get("isEditable")){throw"%@.%@[] is not editable".fmt(this.get("record"),this.get("propertyName"))}var d=this.get("editableStoreIds"),l=n?(n.get?n.get("length"):n.length):0,j=this.get("record"),f=this.get("propertyName"),h,a,b,g,m,k;a=[];for(h=0;h<l;h++){a[h]=n.objectAt(h).get("id")}g=this.get("inverse");if(g&&e>0){b=SC.ManyArray._toRemove;if(b){SC.ManyArray._toRemove=null}else{b=[]}for(h=0;h<e;h++){b[h]=this.objectAt(o+h)}}d.replace(o,e,a);if(g){for(h=0;h<e;h++){k=b[h];m=k?k[g]:null;if(m&&m.inverseDidRemoveRecord){m.inverseDidRemoveRecord(k,g,j,f)}}if(b){b.length=0;if(!SC.ManyArray._toRemove){SC.ManyArray._toRemove=b}}for(h=0;h<l;h++){k=n.objectAt(h);m=k?k[g]:null;if(m&&m.inverseDidAddRecord){m.inverseDidAddRecord(k,g,j,f)}}}if(j&&(!g||this.get("isMaster"))){j.recordDidChange(f)}this.enumerableContentDidChange(o,e,l-e);return this},removeInverseRecord:function(d){if(!d){return this}var f=d.get("id"),e=this.get("editableStoreIds"),a=(e&&f)?e.indexOf(f):-1,b;if(a>=0){e.removeAt(a);if(this.get("isMaster")&&(b=this.get("record"))){b.recordDidChange(this.get("propertyName"))}}return this},addInverseRecord:function(e){if(!e){return this}var f=this.get("editableStoreIds"),g=this.get("orderBy"),b=f.get("length"),a,d;if(g){a=this._findInsertionLocation(e,0,b,g)}else{a=b}f.insertAt(a,e.get("id"));if(this.get("isMaster")&&(d=this.get("record"))){d.recordDidChange(this.get("propertyName"))}return this},_findInsertionLocation:function(h,e,d,g){var b=e+Math.floor((d-e)/2),f=this.objectAt(b),a=this._compare(h,f,g);if(a<0){if(b===0){return b}else{return this._findInsertionLocation(h,0,b-1,g)}}else{if(a>0){if(b>=d){return b+1}else{return this._findInsertionLocation(h,b+1,d,g)}}else{return b}}},_compare:function(g,f,k){var j=SC.typeOf(k),h,e,d;if(j===SC.T_FUNCTION){h=k(g,f)}else{if(j===SC.T_STRING){h=SC.compare(g,f)}else{d=k.get("length");h=0;for(e=0;(h===0)&&(e<d);e++){h=SC.compare(g,f)}}}return h},recordPropertyDidChange:function(e){if(e&&!e.contains(this.get("propertyName"))){return this}var h=this.get("readOnlyStoreIds"),a,b;var d=this._prevStoreIds,g=this._storeIdsContentDidChange;if(h===d){return this}if(d){d.removeArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:g});a=d.get("length")}else{a=0}if(h){h.addArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:g});b=h.get("length")}else{b=0}this.arrayContentWillChange(0,a,b);this._prevStoreIds=h;this._storeIdsContentDidChange(0,a,b)},_storeIdsContentDidChange:function(d,a,b){this._records=null;this.arrayContentDidChange(d,a,b)},unknownProperty:function(b,d){var a;if(SC.typeOf(b)===SC.T_STRING){a=this.reducedProperty(b,d)}return a===undefined?arguments.callee.base.apply(this,arguments):a},init:function(){arguments.callee.base.apply(this,arguments);this.recordPropertyDidChange()}});sc_require("models/record");sc_require("models/record_attribute");sc_require("system/many_array");SC.ManyAttribute=SC.RecordAttribute.extend({inverse:null,isMaster:YES,orderBy:null,toType:function(b,e,g){var f=this.get("typeClass"),j=this.get("key")||e,h=SC.keyFor("__manyArray__",SC.guidFor(this)),d=b[h],a;if(!d){d=SC.ManyArray.create({recordType:f,record:b,propertyName:j,manyAttribute:this});b[h]=d;a=b.get("relationships");if(!a){b.set("relationships",a=[])}a.push(d)}return d},fromType:function(b,f,g){var d=[];if(!SC.isArray(g)){throw"Expects toMany attribute to be an array"}var a=g.get("length");for(var e=0;e<a;e++){d[e]=g.objectAt(e).get("id")}return d},inverseDidRemoveRecord:function(a,b,d,e){var f=a.get(b);if(f){f.removeInverseRecord(d)}},inverseDidAddRecord:function(a,b,d,e){var f=a.get(b);if(f){f.addInverseRecord(d)}}});sc_require("models/record");sc_require("models/record_attribute");SC.SingleAttribute=SC.RecordAttribute.extend({inverse:null,isMaster:YES,call:function(d,k,b){var a=this.get("key")||k,j,h,l,g,f,e;if(b!==undefined&&this.get("isEditable")){if(b&&!SC.kindOf(b,SC.Record)){throw"%@ is not an instance of SC.Record".fmt(b)}j=this.get("inverse");if(j){l=this._scsa_call(d,k)}e=this.fromType(d,k,b);d.writeAttribute(a,e,!this.get("isMaster"));f=b;if(j&&(l!==b)){if(l&&(g=l[j])){g.inverseDidRemoveRecord(l,j,d,k)}if(b&&(g=b[j])){g.inverseDidAddRecord(b,j,d,k)}}}else{f=this._scsa_call(d,k,b)}return f},_scsa_call:SC.RecordAttribute.prototype.call,inverseDidRemoveRecord:function(d,g,h,j){var b=this.get("inverse"),f=this._scsa_call(d,g),e=this.get("isMaster"),a;d.writeAttribute(this.get("key")||g,null,!e);d.notifyPropertyChange(g);if((f!==h)||(j!==b)){if(f&&(a=f[b])){a.inverseDidRemoveRecord(f,b,d,g)}}},inverseDidAddRecord:function(a,j,d,h){var f=this.get("inverse"),k=this._scsa_call(a,j),g=this.get("isMaster"),e,b;b=this.fromType(a,j,d);a.writeAttribute(this.get("key")||j,b,!g);a.notifyPropertyChange(j);if((k!==d)||(h!==f)){if(k&&(e=k[f])){e.inverseDidRemoveRecord(k,f,a,j)}}}});sc_require("models/record");SC.Store=SC.Object.extend({name:null,nestedStores:null,dataSource:null,isNested:NO,commitRecordsAutomatically:NO,from:function(a){this.set("dataSource",a);return this},_getDataSource:function(){var a=this.get("dataSource");if(typeof a===SC.T_STRING){a=SC.requiredObjectForPropertyPath(a);if(a.isClass){a=a.create()}this.set("dataSource",a)}return a},cascade:function(a){var b=SC.A(arguments);a=SC.CascadeDataSource.create({dataSources:b});return this.from(a)},chain:function(b,d){if(!b){b={}}b.parentStore=this;if(d){if(SC.typeOf(d)!=="class"){throw new Error("%@ is not a valid class".fmt(d))}if(!SC.kindOf(d,SC.NestedStore)){throw new Error("%@ is not a type of SC.NestedStore".fmt(d))}}else{d=SC.NestedStore}b.childRecords=this.childRecords?SC.clone(this.childRecords):{};b.parentRecords=this.parentRecords?SC.clone(this.parentRecords):{};var a=d.create(b),e=this.nestedStores;if(!e){e=this.nestedStores=[]}e.push(a);return a},willDestroyNestedStore:function(a){if(this.nestedStores){this.nestedStores.removeObject(a)}return this},hasNestedStore:function(a){while(a&&(a!==this)){a=a.get("parentStore")}return a===this},dataHashes:null,statuses:null,revisions:null,editables:null,changelog:null,recordErrors:null,queryErrors:null,childRecords:null,parentRecords:null,storeKeyEditState:function(b){var d=this.editables,a=this.locks;return(d&&d[b])?SC.Store.EDITABLE:SC.Store.LOCKED},readDataHash:function(a){return this.dataHashes[a]},readEditableDataHash:function(b){var a=this.dataHashes[b];if(!a){return a}var d=this.editables;if(!d){d=this.editables=[]}if(!d[b]){d[b]=1;a=this.dataHashes[b]=SC.clone(a,YES)}return a},readEditableProperty:function(d,a){var f=this.readEditableDataHash(d),e=this.editables[d],b=f[a];if(e===1){e=this.editables[d]={}}if(!e[a]){b=f[a];if(b&&b.isCopyable){b=f[a]=b.copy(YES)}e[a]=YES}return b},writeDataHash:function(d,f,a){if(f){this.dataHashes[d]=f}if(a){this.statuses[d]=a}var e=this.editables;if(!e){e=this.editables=[]}e[d]=1;var b=this;this._propagateToChildren(d,function(g){b.writeDataHash(g,null,a)});return this},removeDataHash:function(b,a){this.dataHashes[b]=null;this.statuses[b]=a||SC.Record.EMPTY;var d=this.editables;if(d){d[b]=0}return this},readStatus:function(a){this.readDataHash(a);return this.statuses[a]||SC.Record.EMPTY},peekStatus:function(a){return this.statuses[a]||SC.Record.EMPTY},writeStatus:function(b,a){return this.writeDataHash(b,null,a)},dataHashDidChange:function(f,b,a,j){if(!b){b=SC.Store.generateStoreKey()}var d,g,h,k;d=SC.typeOf(f)===SC.T_ARRAY;if(d){g=f.length}else{g=1;k=f}var e=this;for(h=0;h<g;h++){if(d){k=f[h]}this.revisions[k]=b;this._notifyRecordPropertyChange(k,a,j);this._propagateToChildren(k,function(l){e.dataHashDidChange(l,null,a,j)})}return this},_notifyRecordPropertyChange:function(o,f,n){var a=this.records,h=this.get("nestedStores"),j=SC.Store,d,b,g,m,l,e,p;g=h?h.length:0;for(m=0;m<g;m++){l=h[m];e=l.peekStatus(o);b=l.storeKeyEditState(o);if(b===j.INHERITED){l._notifyRecordPropertyChange(o,f,n)}else{if(e&SC.Record.BUSY){if(l.get("hasChanges")){throw j.CHAIN_CONFLICT_ERROR}l.reset()}}}var k=this.recordPropertyChanges;if(!k){k=this.recordPropertyChanges={storeKeys:SC.CoreSet.create(),records:SC.CoreSet.create(),hasDataChanges:SC.CoreSet.create(),propertyForStoreKeys:{}}}k.storeKeys.add(o);if(a&&(d=a[o])){k.records.push(o);if(!f){k.hasDataChanges.push(o)}if(n){if(!(p=k.propertyForStoreKeys[o])){p=k.propertyForStoreKeys[o]=SC.CoreSet.create()}if(p!=="*"){p.add(n)}}else{k.propertyForStoreKeys[o]="*"}}this.invokeOnce(this.flush);return this},flush:function(){if(!this.recordPropertyChanges){return this}var k=this.recordPropertyChanges,j=k.storeKeys,n=k.hasDataChanges,a=k.records,g=k.propertyForStoreKeys,e=SC.CoreSet.create(),d,b,f,l,h,m,o;j.forEach(function(p){if(a.contains(p)){f=n.contains(p)?NO:YES;d=this.records[p];o=g?g[p]:null;if(o==="*"){o=null}a.remove(p);if(d){d.storeDidChangeProperties(f,o)}}b=SC.Store.recordTypeFor(p);e.add(b)},this);if(j.get("length")>0){this._notifyRecordArrays(j,e)}j.clear();n.clear();a.clear();this.recordPropertyChanges.propertyForStoreKeys={};return this},reset:function(){this.dataHashes={};this.revisions={};this.statuses={};this.chainedChanges=this.locks=this.editables=null;this.changelog=null;this.recordErrors=null;this.queryErrors=null;var d=this.get("dataSource");if(d&&d.reset){d.reset()}var a=this.records,b;if(a){for(b in a){if(!a.hasOwnProperty(b)){continue}this._notifyRecordPropertyChange(parseInt(b,10),NO)}}this.set("hasChanges",NO)},commitChangesFromNestedStore:function(k,v,e){if(!e){this._verifyLockRevisions(v,k.locks)}var q=v.length,p,g,d,m,f,b,j,a,s,t,h,n,l;b=this.revisions;d=this.dataHashes;m=this.statuses;f=this.editables;j=this.parentRecords?this.parentRecords:this.parentRecords={};a=this.childRecords?this.childRecords:this.childRecords={};if(!f){f=this.editables=[]}s=k.dataHashes;h=k.revisions;t=k.statuses;n=k.parentRecords||{};l=k.childRecords||{};for(p=0;p<q;p++){g=v[p];d[g]=s[g];m[g]=t[g];b[g]=h[g];j[g]=n[g];a[g]=l[g];f[g]=0;this._notifyRecordPropertyChange(g,NO)}var o=this.changelog,u=k.changelog;if(u){if(!o){o=this.changelog=SC.CoreSet.create()}o.addEach(u)}this.changelog=o;if(!this.get("parentStore")){this.flush()}return this},_verifyLockRevisions:function(g,j){var a=g.length,d=this.revisions,f,h,e,b;if(j&&d){for(f=0;f<a;f++){h=g[f];e=j[h]||1;b=d[h]||1;if(e<b){throw SC.Store.CHAIN_CONFLICT_ERROR}}}return this},find:function(b,a){if(SC.typeOf(b)===SC.T_STRING){b=SC.objectForPropertyPath(b)}if((arguments.length===1)&&!(b&&b.get&&b.get("isRecord"))){if(!b){throw new Error("SC.Store#find() must pass recordType or query")}if(!b.isQuery){b=SC.Query.local(b)}return this._findQuery(b,YES,YES)}else{return this._findRecord(b,a)}},findAll:function(d,a,b){SC.Logger.warn("SC.Store#findAll() will be removed in a future version of SproutCore.  Use SC.Store#find() instead");if(!d||!d.isQuery){d=SC.Query.local(d,a,b)}return this._findQuery(d,YES,YES)},_findQuery:function(g,a,f){var b=this._scst_recordArraysByQuery,e=SC.guidFor(g),d,h;if(!b){b=this._scst_recordArraysByQuery={}}d=b[e];if(!d&&a){b[e]=d=SC.RecordArray.create({store:this,query:g});h=this.get("recordArrays");if(!h){this.set("recordArrays",h=SC.Set.create())}h.add(d);if(f){this.refreshQuery(g)}}this.flush();return d},_findRecord:function(d,b){var a;if(d&&d.get&&d.get("isRecord")){a=d.get("storeKey")}else{a=b?d.storeKeyFor(b):null}if(a&&(this.readStatus(a)===SC.Record.EMPTY)){a=this.retrieveRecord(d,b)}return a?this.materializeRecord(a):null},recordArrayWillDestroy:function(b){var a=this._scst_recordArraysByQuery,d=this.get("recordArrays");if(a){delete a[SC.guidFor(b.get("query"))]}if(d){d.remove(b)}return this},refreshQuery:function(e){if(!e){throw new Error("refreshQuery() requires a query")}var a=this._scst_recordArraysByQuery,d=a?a[SC.guidFor(e)]:null,b=this._getDataSource();if(b&&b.fetch){if(d){d.storeWillFetchQuery(e)}b.fetch.call(b,this,e)}return this},_notifyRecordArrays:function(b,a){var d=this.get("recordArrays");if(!d){return this}d.forEach(function(e){if(e){e.storeDidChangeStoreKeys(b,a)}},this);return this},recordsFor:function(g){var e=[],a=g.storeKeysById(),f,d,b;for(f in a){d=a[f];if(this.readStatus(d)!==SC.RECORD_EMPTY){e.push(d)}}if(e.length>0){b=SC.RecordArray.create({store:this,storeKeys:e})}else{b=e}return b},_TMP_REC_ATTRS:{},materializeRecord:function(e){var a=this.records,d,f,b;if(!a){a=this.records={}}d=a[e];if(d){return d}f=SC.Store.recordTypeFor(e);if(!f){return null}b=this._TMP_REC_ATTRS;b.storeKey=e;b.store=this;d=a[e]=f.create(b);return d},createRecord:function(e,g,b){var o,n,p,f,m=SC.Record,j,l,k;g=(g?g:{});if(!b&&(o=e.prototype.primaryKey)){b=g[o];l=e.prototype[o]?e.prototype[o].defaultValue:null;if(!b&&SC.typeOf(l)===SC.T_FUNCTION){b=g[o]=l()}}p=b?e.storeKeyFor(b):SC.Store.generateStoreKey();f=this.readStatus(p);if((f&m.BUSY)||(f&m.READY)||(f===m.DESTROYED_DIRTY)){throw b?m.RECORD_EXISTS_ERROR:m.BAD_STATE_ERROR}else{if(!b&&(f===SC.DESTROYED_CLEAN||f===SC.ERROR)){throw m.BAD_STATE_ERROR}}this.writeDataHash(p,g,m.READY_NEW);SC.Store.replaceRecordTypeFor(p,e);this.dataHashDidChange(p);k=this.materializeRecord(p);n=e.prototype;for(var a in n){var h=n[a];if(h&&h.isRecordAttribute){var d=h.key||a;if(!g.hasOwnProperty(d)){if(g.hasOwnProperty(a)){g[d]=g[a];delete g[a]}else{l=h.defaultValue;if(l){if(SC.typeOf(l)===SC.T_FUNCTION){g[d]=SC.copy(l(k,d),YES)}else{g[d]=SC.copy(l,YES)}}}}else{if(d!==a&&g.hasOwnProperty(a)){delete g[a]}}}}j=this.changelog;if(!j){j=SC.Set.create()}j.add(p);this.changelog=j;if(this.get("commitRecordsAutomatically")){this.invokeLast(this.commitRecords)}if(k){k.propagateToAggregates()}return k},createRecords:function(e,k,a){var h=[],d,b,f,g=k.length,j;f=SC.typeOf(e)===SC.T_ARRAY;if(!f){d=e}for(j=0;j<g;j++){if(f){d=e[j]||SC.Record}b=a?a[j]:undefined;h.push(this.createRecord(d,k[j],b))}return h},unloadRecord:function(h,g,f,d){if(f===undefined){f=h.storeKeyFor(g)}var b=this.readStatus(f),a=SC.Record;d=d||a.EMPTY;if((b===a.BUSY_DESTROYING)||(b&a.DESTROYED)){return this}else{if(b&a.BUSY){throw a.BUSY_ERROR}else{b=d}}this.removeDataHash(f,b);this.dataHashDidChange(f);var e=this;this._propagateToChildren(f,function(j){e.unloadRecord(null,null,j,d)});return this},unloadRecords:function(e,a,h,f){var j,g,k,b,d,l;if(h===undefined){g=SC.typeOf(e)===SC.T_ARRAY;if(!g){d=e}if(a===undefined){j=g?e.length:1;for(k=0;k<j;k++){if(g){d=e[k]}h=this.storeKeysFor(d);this.unloadRecords(undefined,undefined,h,f)}}else{j=a.length;for(k=0;k<j;k++){if(g){d=e[k]||SC.Record}b=a?a[k]:undefined;this.unloadRecord(d,b,undefined,f)}}}else{j=h.length;for(k=0;k<j;k++){l=h?h[k]:undefined;this.unloadRecord(undefined,undefined,l,f)}}return this},destroyRecord:function(h,g,f){if(f===undefined){f=h.storeKeyFor(g)}var b=this.readStatus(f),d,a=SC.Record;if((b===a.BUSY_DESTROYING)||(b&a.DESTROYED)){return this}else{if(b===a.EMPTY){throw a.NOT_FOUND_ERROR}else{if(b&a.BUSY){throw a.BUSY_ERROR}else{if(b===a.READY_NEW){b=a.DESTROYED_CLEAN}else{b=a.DESTROYED_DIRTY}}}}this.writeStatus(f,b);this.dataHashDidChange(f);d=this.changelog;if(!d){d=this.changelog=SC.Set.create()}((b&a.DIRTY)?d.add(f):d.remove(f));this.changelog=d;if(this.get("commitRecordsAutomatically")){this.invokeLast(this.commitRecords)}var e=this;this._propagateToChildren(f,function(j){e.destroyRecord(null,null,j)});return this},destroyRecords:function(e,a,g){var h,f,j,b,d,k;if(g===undefined){h=a.length;f=SC.typeOf(e)===SC.T_ARRAY;if(!f){d=e}for(j=0;j<h;j++){if(f){d=e[j]||SC.Record}b=a?a[j]:undefined;this.destroyRecord(d,b,undefined)}}else{h=g.length;for(j=0;j<h;j++){k=g?g[j]:undefined;this.destroyRecord(undefined,undefined,k)}}return this},registerChildToParent:function(d,h,g){var f,b,e,j,a;b=this.childRecords||{};f=this.parentRecords||{};e=b[h];if(e){j=f[e];delete j[h]}a=f[d]||{};a[h]=g||YES;f[d]=a;b[h]=d;this.writeStatus(h,this.statuses[d]);this.childRecords=b;this.parentRecords=f},unregisterChildFromParent:function(d){var a,b;a=this.childRecords;b=a[d];if(b){delete this.parentRecords[b][d]}this.removeDataHash(d);delete this.records[d];delete a[d]},materializeParentRecord:function(d){var b,a;if(SC.none(d)){return null}a=this.childRecords;b=a?this.childRecords[d]:null;if(SC.none(b)){return null}return this.materializeRecord(b)},parentStoreKeyExists:function(b){if(SC.none(b)){return}var a=this.childRecords||{};return a[b]},_propagateToChildren:function(e,d){if(SC.none(this.parentRecords)){return}var b=this.parentRecords[e]||{};if(SC.none(d)){return}for(var a in b){if(b.hasOwnProperty(a)){d(parseInt(a,10))}}},recordDidChange:function(j,h,g,e,d){if(g===undefined){g=j.storeKeyFor(h)}var b=this.readStatus(g),f,a=SC.Record;if(b&a.BUSY){throw a.BUSY_ERROR}else{if(!(b&a.READY)){throw a.NOT_FOUND_ERROR}else{if(b!=a.READY_NEW){this.writeStatus(g,a.READY_DIRTY)}}}this.dataHashDidChange(g,null,d,e);f=this.changelog;if(!f){f=this.changelog=SC.Set.create()}f.add(g);this.changelog=f;if(this.get("commitRecordsAutomatically")){this.invokeLast(this.commitRecords)}return this},recordsDidChange:function(e,a,g){var h,f,j,b,d,k;if(g===undefined){h=a.length;f=SC.typeOf(e)===SC.T_ARRAY;if(!f){d=e}for(j=0;j<h;j++){if(f){d=e[j]||SC.Record}b=a?a[j]:undefined;k=g?g[j]:undefined;this.recordDidChange(d,b,k)}}else{h=g.length;for(j=0;j<h;j++){k=g?g[j]:undefined;this.recordDidChange(undefined,undefined,k)}}return this},retrieveRecords:function(g,o,b,d,t){var n=this._getDataSource(),j=SC.typeOf(g)===SC.T_ARRAY,m=SC.typeOf(t)===SC.T_ARRAY,q=(!b)?o.length:b.length,u=[],s=SC.Store.generateStoreKey(),h=SC.Record,a,l,f,p,k,e;if(!j){a=g}for(l=0;l<q;l++){if(b){f=b[l]}else{if(j){a=g[l]}f=a.storeKeyFor(o[l])}e=m?t[l]:t;p=this.readStatus(f);if((p==h.EMPTY)||(p==h.ERROR)||(p==h.DESTROYED_CLEAN)){this.writeStatus(f,h.BUSY_LOADING);this.dataHashDidChange(f,s,YES);u.push(f);this._setCallbackForStoreKey(f,e,m,b)}else{if(d){if(p&h.READY){this.writeStatus(f,h.BUSY_REFRESH|(p&3));this.dataHashDidChange(f,s,YES);u.push(f);this._setCallbackForStoreKey(f,e,m,b)}else{if((p==h.BUSY_DESTROYING)||(p==h.BUSY_CREATING)||(p==h.BUSY_COMMITTING)){throw h.BUSY_ERROR}else{if(p==h.DESTROYED_DIRTY){throw h.BAD_STATE_ERROR}}}}}}k=NO;if(n){k=n.retrieveRecords.call(n,this,u,o)}if(!k){q=u.length;s=SC.Store.generateStoreKey();for(l=0;l<q;l++){f=u[l];p=this.readStatus(f);if(p===h.BUSY_LOADING){this.writeStatus(f,h.ERROR);this.dataHashDidChange(f,s,YES)}else{if(p&h.BUSY_REFRESH){this.writeStatus(f,h.READY|(p&3));this.dataHashDidChange(f,s,YES)}}}u.length=0}return u},_TMP_RETRIEVE_ARRAY:[],_callback_queue:{},_setCallbackForStoreKey:function(e,f,b,d){var a=this._callback_queue;if(b){a[e]={callback:f,otherKeys:d}}else{a[e]=f}},_retreiveCallbackForStoreKey:function(d){var a=this._callback_queue,f=a[d],e,b;if(f){if(SC.typeOf(f)===SC.T_FUNCTION){f.call();delete a[d]}else{if(SC.typeOf(f)==SC.T_HASH){f.completed=YES;b=f.storeKeys;b.forEach(function(g){if(!a[g].completed){e=YES}});if(e){f.callback.call();b.forEach(function(g){delete a[g]})}}}}},_cancelCallback:function(b){var a=this._callback_queue;if(a[b]){delete a[b]}},retrieveRecord:function(h,g,b,d,f){var e=this._TMP_RETRIEVE_ARRAY,a;if(b){e[0]=b;b=e;g=null}else{e[0]=g;g=e}a=this.retrieveRecords(h,g,b,d,f);e.length=0;return a[0]},refreshRecord:function(e,d,a,b){return !!this.retrieveRecord(e,d,a,YES,b)},refreshRecords:function(b,d,e,f){var a=this.retrieveRecords(b,d,e,YES,f);return a&&a.length>0},commitRecords:function(g,p,b,t,w){var o=this._getDataSource(),j=SC.typeOf(g)===SC.T_ARRAY,m=SC.typeOf(w)===SC.T_ARRAY,d=[],l=[],n=[],u=SC.Store.generateStoreKey(),h=SC.Record,a,k,f,q,x,v,s,e;if(!g&&!p&&!b){b=this.changelog}s=b?b.get("length"):(p?p.get("length"):0);for(k=0;k<s;k++){if(b){f=b[k]}else{if(j){a=g[k]||SC.Record}else{a=g}f=a.storeKeyFor(p[k])}e=m?w[k]:w;q=this.readStatus(f);if(q==h.ERROR){throw h.NOT_FOUND_ERROR}else{if(q==h.READY_NEW){this.writeStatus(f,h.BUSY_CREATING);this.dataHashDidChange(f,u,YES);d.push(f);this._setCallbackForStoreKey(f,e,m,b)}else{if(q==h.READY_DIRTY){this.writeStatus(f,h.BUSY_COMMITTING);this.dataHashDidChange(f,u,YES);l.push(f);this._setCallbackForStoreKey(f,e,m,b)}else{if(q==h.DESTROYED_DIRTY){this.writeStatus(f,h.BUSY_DESTROYING);this.dataHashDidChange(f,u,YES);n.push(f);this._setCallbackForStoreKey(f,e,m,b)}else{if(q==h.DESTROYED_CLEAN){this.dataHashDidChange(f,u,YES)}}}}}}if(o&&(s>0||t)){v=o.commitRecords.call(o,this,d,l,n,t)}if(v&&!g&&!p){if(b===this.changelog){this.changelog=null}else{this.changelog.removeEach(b)}}return v},commitRecord:function(h,g,b,d,f){var e=this._TMP_RETRIEVE_ARRAY,a;if(g===undefined&&b===undefined){return NO}if(b!==undefined){e[0]=b;b=e;g=null}else{e[0]=g;g=e}a=this.commitRecords(h,g,b,d,f);e.length=0;return a},cancelRecords:function(f,b,k){var a=this._getDataSource(),h=SC.typeOf(f)===SC.T_ARRAY,m=SC.Record,l=[],g,j,n,d,e,o;j=(k===undefined)?b.length:k.length;for(n=0;n<j;n++){if(h){e=f[n]||SC.Record}else{e=f||SC.Record}d=b?b[n]:undefined;if(k===undefined){o=e.storeKeyFor(d)}else{o=k?k[n]:undefined}if(o){g=this.readStatus(o);if((g==m.EMPTY)||(g==m.ERROR)){throw m.NOT_FOUND_ERROR}l.push(o);this._cancelCallback(o)}}if(a){a.cancel.call(a,this,l)}return this},cancelRecord:function(f,e,b){var d=this._TMP_RETRIEVE_ARRAY,a;if(b!==undefined){d[0]=b;b=d;e=null}else{d[0]=e;e=d}a=this.cancelRecords(f,e,b);d.length=0;return this},loadRecord:function(h,e,g){var a=SC.Record,d,b,f;h=h||SC.Record;b=h.prototype.primaryKey;g=g||e[b];d=f=h.storeKeyFor(g);if(this.readStatus(f)&a.BUSY){this.dataSourceDidComplete(f,e,g)}else{this.pushRetrieve(h,g,e,f)}return d},loadRecords:function(e,o,a){var g=SC.typeOf(e)===SC.T_ARRAY,h=o.get("length"),j=[],k=SC.Record,d,b,m,l,f,n;if(!g){d=e||SC.Record;m=d.prototype.primaryKey}for(l=0;l<h;l++){f=o.objectAt(l);if(g){d=e.objectAt(l)||SC.Record;m=d.prototype.primaryKey}b=(a)?a.objectAt(l):f[m];j[l]=this.loadRecord(d,f,b)}return j},readError:function(a){var b=this.recordErrors;return b?b[a]:undefined},readQueryError:function(a){var b=this.queryErrors;return b?b[SC.guidFor(a)]:undefined},dataSourceDidCancel:function(d){var b=this.readStatus(d),a=SC.Record;if(!(b&a.BUSY)){throw a.BAD_STATE_ERROR}switch(b){case a.BUSY_LOADING:b=a.EMPTY;break;case a.BUSY_CREATING:b=a.READY_NEW;break;case a.BUSY_COMMITTING:b=a.READY_DIRTY;break;case a.BUSY_REFRESH_CLEAN:b=a.READY_CLEAN;break;case a.BUSY_REFRESH_DIRTY:b=a.READY_DIRTY;break;case a.BUSY_DESTROYING:b=a.DESTROYED_DIRTY;break;default:throw a.BAD_STATE_ERROR}this.writeStatus(d,b);this.dataHashDidChange(d,null,YES);this._cancelCallback(d);return this},dataSourceDidComplete:function(h,g,f){var d=this.readStatus(h),b=SC.Record,e;if(!(d&b.BUSY)){throw b.BAD_STATE_ERROR}if(d===b.BUSY_DESTROYING){throw b.BAD_STATE_ERROR}else{d=b.READY_CLEAN}this.writeStatus(h,d);if(g){this.writeDataHash(h,g,d)}if(f){SC.Store.replaceIdFor(h,f)}e=g||f?NO:YES;this.dataHashDidChange(h,null,e);var a=this.materializeRecord(h);if(a!=null){a.notifyPropertyChange("status")}this._retreiveCallbackForStoreKey(h);return this},dataSourceDidDestroy:function(e){var d=this.readStatus(e),b=SC.Record;if(!(d&b.BUSY)){throw b.BAD_STATE_ERROR}else{d=b.DESTROYED_CLEAN}this.removeDataHash(e,d);this.dataHashDidChange(e);var a=this.materializeRecord(e);if(a!=null){a.notifyPropertyChange("status")}this._retreiveCallbackForStoreKey(e);return this},dataSourceDidError:function(f,e){var d=this.readStatus(f),g=this.recordErrors,b=SC.Record;if(!(d&b.BUSY)){throw b.BAD_STATE_ERROR}else{d=b.ERROR}if(e&&e.isError){if(!g){g=this.recordErrors=[]}g[f]=e}this.writeStatus(f,d);this.dataHashDidChange(f,null,YES);var a=this.materializeRecord(f);if(a!=null){a.notifyPropertyChange("status")}this._retreiveCallbackForStoreKey(f);return this},pushRetrieve:function(g,f,d,e){var b=SC.Record,a;if(e===undefined){e=g.storeKeyFor(f)}a=this.readStatus(e);if(a==b.EMPTY||a==b.ERROR||a==b.READY_CLEAN||a==b.DESTROYED_CLEAN){a=b.READY_CLEAN;if(d===undefined){this.writeStatus(e,a)}else{this.writeDataHash(e,d,a)}if(f&&this.idFor(e)!==f){SC.Store.replaceIdFor(e,f)}this.dataHashDidChange(e);return e}return NO},pushDestroy:function(f,e,d){var b=SC.Record,a;if(d===undefined){d=f.storeKeyFor(e)}a=this.readStatus(d);if(a==b.EMPTY||a==b.ERROR||a==b.READY_CLEAN||a==b.DESTROYED_CLEAN){a=b.DESTROYED_CLEAN;this.removeDataHash(d,a);this.dataHashDidChange(d);return d}return NO},pushError:function(h,g,d,e){var b=SC.Record,a,f=this.recordErrors;if(e===undefined){e=h.storeKeyFor(g)}a=this.readStatus(e);if(a==b.EMPTY||a==b.ERROR||a==b.READY_CLEAN||a==b.DESTROYED_CLEAN){a=b.ERROR;if(d&&d.isError){if(!f){f=this.recordErrors=[]}f[e]=d}this.writeStatus(e,a);this.dataHashDidChange(e,null,YES);return e}return NO},loadQueryResults:function(d,a){if(d.get("location")===SC.Query.LOCAL){throw new Error("Cannot load query results for a local query")}var b=this._findQuery(d,YES,NO);if(b){b.set("storeKeys",a)}this.dataSourceDidFetchQuery(d);return this},dataSourceDidFetchQuery:function(a){return this._scstore_dataSourceDidFetchQuery(a,YES)},_scstore_dataSourceDidFetchQuery:function(e,a){var d=this._findQuery(e,a,NO),b=this.get("nestedStores"),f=b?b.get("length"):0;if(d){d.storeDidFetchQuery(e)}while(--f>=0){b[f]._scstore_dataSourceDidFetchQuery(e,NO)}return this},dataSourceDidCancelQuery:function(a){return this._scstore_dataSourceDidCancelQuery(a,YES)},_scstore_dataSourceDidCancelQuery:function(e,a){var d=this._findQuery(e,a,NO),b=this.get("nestedStores"),f=b?b.get("length"):0;if(d){d.storeDidCancelQuery(e)}while(--f>=0){b[f]._scstore_dataSourceDidCancelQuery(e,NO)}return this},dataSourceDidErrorQuery:function(b,a){var d=this.queryErrors;if(a&&a.isError){if(!d){d=this.queryErrors={}}d[SC.guidFor(b)]=a}return this._scstore_dataSourceDidErrorQuery(b,YES)},_scstore_dataSourceDidErrorQuery:function(e,a){var d=this._findQuery(e,a,NO),b=this.get("nestedStores"),f=b?b.get("length"):0;if(d){d.storeDidErrorQuery(e)}while(--f>=0){b[f]._scstore_dataSourceDidErrorQuery(e,NO)}return this},init:function(){arguments.callee.base.apply(this,arguments);this.reset()},toString:function(){var b=this.get("name");if(!b){return arguments.callee.base.apply(this,arguments)}else{var a=arguments.callee.base.apply(this,arguments);return"%@ (%@)".fmt(b,a)}},idFor:function(a){return SC.Store.idFor(a)},recordTypeFor:function(a){return SC.Store.recordTypeFor(a)},storeKeyFor:function(b,a){return b.storeKeyFor(a)},storeKeyExists:function(b,a){return b.storeKeyExists(a)},storeKeysFor:function(g){var a=[],f=g&&g.isEnumerable,d,e,b;if(!this.statuses){return a}for(e in SC.Store.recordTypesByStoreKey){d=SC.Store.recordTypesByStoreKey[e];if(f){b=g.contains(d)}else{b=d===g}if(b&&this.statuses[e]){a.push(parseInt(e,10))}}return a},storeKeys:function(){var a=[],b;if(!this.statuses){return a}for(b in this.statuses){if(this.statuses[b]!=SC.Record.EMPTY){a.push(parseInt(b,10))}}return a},statusString:function(a){var b=this.materializeRecord(a);return b.statusString()}});SC.Store.mixin({CHAIN_CONFLICT_ERROR:new Error("Nested Store Conflict"),NO_PARENT_STORE_ERROR:new Error("Parent Store Required"),NESTED_STORE_UNSUPPORTED_ERROR:new Error("Unsupported In Nested Store"),NESTED_STORE_RETRIEVE_DIRTY_ERROR:new Error("Cannot Retrieve Dirty Record in Nested Store"),EDITABLE:"editable",LOCKED:"locked",INHERITED:"inherited",idsByStoreKey:[],recordTypesByStoreKey:{},queriesByStoreKey:[],nextStoreKey:1,generateStoreKey:function(){return this.nextStoreKey++},idFor:function(a){return this.idsByStoreKey[a]},queryFor:function(a){return this.queriesByStoreKey[a]},recordTypeFor:function(a){return this.recordTypesByStoreKey[a]},replaceIdFor:function(d,a){var e=this.idsByStoreKey[d],f,b;if(e!==a){f=this.recordTypeFor(d);if(!f){throw new Error("replaceIdFor: storeKey %@ does not exist".fmt(d))}this.idsByStoreKey[d]=a;b=f.storeKeysById();delete b[e];b[a]=d}return this},replaceRecordTypeFor:function(a,b){this.recordTypesByStoreKey[a]=b;return this}});SC.Store.prototype.nextStoreIndex=1;SC.Store._getDefaultStore=function(){var a=this._store;if(!a){this._store=a=SC.Store.create()}return a};SC.Store.updateRecords=function(g,h,j,d){SC.Logger.warn("SC.Store.updateRecords() is deprecated.  Use loadRecords() instead");var e=this._getDefaultStore(),b=g.length,a,f;if(!j){j=[];for(a=0;a<b;a++){j[a]=g[a].recordType}}f=e.loadRecords(j,g);b=f.length;for(a=0;a<b;a++){f[a]=e.materializeRecord(f[a])}return f};SC.Store.find=function(a,b){return this._getDefaultStore().find(b,a)};SC.Store.findAll=function(a,b){return this._getDefaultStore().findAll(a,b)};sc_require("system/store");SC.NestedStore=SC.Store.extend({hasChanges:NO,parentStore:null,isNested:YES,lockOnRead:YES,locks:null,chainedChanges:null,find:function(a){if(a&&a.isQuery&&a.get("location")!==SC.Query.LOCAL){throw"SC.Store#find() can only accept LOCAL queries in nested stores"}return arguments.callee.base.apply(this,arguments)},commitChanges:function(b){if(this.get("hasChanges")){var a=this.get("parentStore");a.commitChangesFromNestedStore(this,this.chainedChanges,b)}this.reset();return this},discardChanges:function(){var d,g;if((d=this.records)&&(g=this.locks)){var b=this.get("parentStore"),j=b.revisions;var h=this.revisions,f,e,a;for(f in d){if(!d.hasOwnProperty(f)){continue}if(!(e=g[f])){continue}a=j[f];if((a!==e)||(h[f]>a)){this._notifyRecordPropertyChange(parseInt(f,10))}}}this.reset();this.flush();return this},destroy:function(){this.discardChanges();var a=this.get("parentStore");if(a){a.willDestroyNestedStore(this)}arguments.callee.base.apply(this,arguments);return this},reset:function(){var d,e,a;var b=this.get("parentStore");if(!b){throw SC.Store.NO_PARENT_STORE_ERROR}this.dataHashes=SC.beget(b.dataHashes);this.revisions=SC.beget(b.revisions);this.statuses=SC.beget(b.statuses);this.childRecords=b.childRecords?SC.beget(b.childRecords):{};this.parentRecords=b.parentRecords?SC.beget(b.parentRecords):{};this.chainedChanges=this.locks=this.editables=null;this.changelog=null;this.set("hasChanges",NO)},refreshQuery:function(b){var a=this.get("parentStore");if(a){a.refreshQuery(b)}return this},readError:function(b){var a=this.get("parentStore");return a?a.readError(b):null},readQueryError:function(b){var a=this.get("parentStore");return a?a.readQueryError(b):null},storeKeyEditState:function(b){var d=this.editables,a=this.locks;return(d&&d[b])?SC.Store.EDITABLE:(a&&a[b])?SC.Store.LOCKED:SC.Store.INHERITED},_lock:function(l){var m=this.locks,g,j,e,a,n,h,f,k;if(m&&m[l]){return this}if(!m){m=this.locks=[]}j=this.editables;if(j){j[l]=0}var b=this.get("parentStore"),d;while(b&&(d=b.storeKeyEditState(l))===SC.Store.INHERITED){b=b.get("parentStore")}if(b&&d===SC.Store.EDITABLE){e=this.childRecords[l];if(e){this._lock(e);a=this.parentRecords[e];if(a){n=a[l];h=n?SC.tupleForPropertyPath(n,this.dataHashes[e]):null;if(h){f=h[0];k=h[1]}this.dataHashes[l]=f&&k?f[k]:null}}else{this.dataHashes[l]=SC.clone(b.dataHashes[l],YES)}if(!j){j=this.editables=[]}j[l]=1}else{this.dataHashes[l]=b.dataHashes[l]}this.statuses[l]=this.statuses[l];g=this.revisions[l]=this.revisions[l];m[l]=g||1;return this},readDataHash:function(a){if(this.get("lockOnRead")){this._lock(a)}return this.dataHashes[a]},readEditableDataHash:function(a){this._lock(a);return arguments.callee.base.apply(this,arguments)},writeDataHash:function(e,g,b){var d=this.locks,h=NO,a;if(g){this.dataHashes[e]=g}else{this._lock(e);h=YES}if(b){this.statuses[e]=b}else{if(!h){this.statuses[e]=(this.statuses[e]||SC.Record.READY_NEW)}}if(!h){a=this.revisions[e]=this.revisions[e];if(!d){d=this.locks=[]}if(!d[e]){d[e]=a||1}}var f=this.editables;if(!f){f=this.editables=[]}f[e]=1;return this},removeDataHash:function(d,a){var b=this.locks;if(!b){b=this.locks=[]}if(!b[d]){b[d]=this.revisions[d]||1}return arguments.callee.base.apply(this,arguments)},dataHashDidChange:function(e,b,a,j){if(!b){b=SC.Store.generateStoreKey()}var d,f,h,k;d=SC.typeOf(e)===SC.T_ARRAY;if(d){f=e.length}else{f=1;k=e}var g=this.chainedChanges;if(!g){g=this.chainedChanges=SC.Set.create()}for(h=0;h<f;h++){if(d){k=e[h]}this._lock(k);this.revisions[k]=b;g.add(k);this._notifyRecordPropertyChange(k,a,j)}this.setIfChanged("hasChanges",YES);return this},commitChangesFromNestedStore:function(f,g,a){arguments.callee.base.apply(this,arguments);var b=this.get("parentStore"),j=b.revisions,d;var l=this.locks,h=this.chainedChanges,e,k;if(!l){l=this.locks=[]}if(!h){h=this.chainedChanges=SC.Set.create()}e=g.length;for(d=0;d<e;d++){k=g[d];if(!l[k]){l[k]=j[k]||1}h.add(k)}this.setIfChanged("hasChanges",h.get("length")>0);this.flush();return this},queryFor:function(d,a,b){return this.get("parentStore").queryFor(d,a,b)},findAll:function(f,b,e,d,a){if(!a){a=this}return this.get("parentStore").findAll(f,b,e,d,a)},retrieveRecords:function(g,o,b,d){var a=this.get("parentStore"),m,e,s,q=(!b)?o.length:b.length,k=SC.Record,p;if(d){for(m=0;m<q;m++){e=!b?a.storeKeyFor(g,o[m]):b[m];p=this.peekStatus(e);if(p&k.DIRTY){throw SC.Store.NESTED_STORE_RETRIEVE_DIRTY_ERROR}else{var h=this.dataHashes,l=this.revisions,j=this.statuses,n=this.editables,u=this.locks;var f=NO;var t=NO;if(h&&h.hasOwnProperty(e)){delete h[e];f=YES}if(l&&l.hasOwnProperty(e)){delete l[e];f=YES}if(n){delete n[e]}if(u){delete u[e]}if(j&&j.hasOwnProperty(e)){delete j[e];if(!f){t=YES}f=YES}if(f){this._notifyRecordPropertyChange(e,t)}}}}return a.retrieveRecords(g,o,b,d)},commitRecords:function(a,b,d){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},commitRecord:function(d,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},cancelRecords:function(a,b,d){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},cancelRecord:function(d,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidCancel:function(a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidComplete:function(d,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidDestroy:function(a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},dataSourceDidError:function(b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},pushRetrieve:function(e,d,a,b){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},pushDestroy:function(d,b,a){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR},pushError:function(e,d,a,b){throw SC.Store.NESTED_STORE_UNSUPPORTED_ERROR}});sc_require("models/record");SC.RecordArray=SC.Object.extend(SC.Enumerable,SC.Array,{store:null,query:null,storeKeys:null,status:SC.Record.EMPTY,isEditable:function(){var a=this.get("query");return a?a.get("isEditable"):YES}.property("query").cacheable(),length:function(){this.flush();var a=this.get("storeKeys");return a?a.get("length"):0}.property("storeKeys").cacheable(),_scra_records:null,objectAt:function(a){this.flush();var g=this._scra_records,f=this.get("storeKeys"),b=this.get("store"),e,d;if(!f||!b){return undefined}if(g&&(d=g[a])){return d}if(!g){this._scra_records=g=[]}e=f.objectAt(a);if(e){if(b.peekStatus(e)===SC.Record.EMPTY){b.retrieveRecord(null,null,e)}g[a]=d=b.materializeRecord(e)}return d},forEach:function(j,e){this.flush();var f=this._scra_records,b=this.get("storeKeys"),g=this.get("store"),d=b?b.get("length"):0,h,k,a;if(!b||!g){return this}if(!f){f=this._scra_records=[]}if(!e){e=this}for(h=0;h<d;h++){a=f[h];if(!a){a=f[h]=g.materializeRecord(b.objectAt(h))}j.call(e,a,h,this)}return this},replace:function(b,h,g){this.flush();var f=this.get("storeKeys"),a=g?(g.get?g.get("length"):g.length):0,d,e;if(!f){throw"Unable to edit an SC.RecordArray that does not have its storeKeys property set."}if(!this.get("isEditable")){throw SC.RecordArray.NOT_EDITABLE}e=[];for(d=0;d<a;d++){e[d]=g.objectAt(d).get("storeKey")}f.replace(b,h,e);return this},contains:function(a){return this.indexOf(a)>=0},indexOf:function(b,a){if(!SC.kindOf(b,SC.Record)){SC.Logger.warn("Using indexOf on %@ with an object that is not an SC.Record".fmt(b));return -1}this.flush();var e=b.get("storeKey"),d=this.get("storeKeys");return d?d.indexOf(e,a):-1},lastIndexOf:function(b,a){if(!SC.kindOf(b,SC.Record)){SC.Logger.warn("Using lastIndexOf on %@ with an object that is not an SC.Record".fmt(b));return -1}this.flush();var e=b.get("storeKey"),d=this.get("storeKeys");return d?d.lastIndexOf(e,a):-1},add:function(a){if(!SC.kindOf(a,SC.Record)){return this}if(this.indexOf(a)<0){this.pushObject(a)}return this},remove:function(a){if(!SC.kindOf(a,SC.Record)){return this}this.removeObject(a);return this},find:function(a,b,d){if(b&&b.isQuery){return this.get("store").find(b.queryWithScope(this))}else{return a.apply(this,SC.$A(arguments).slice(1))}}.enhance(),refresh:function(){this.get("store").refreshQuery(this.get("query"));return this},reload:function(){this.flush(YES);return this},destroy:function(){if(!this.get("isDestroyed")){this.get("store").recordArrayWillDestroy(this)}arguments.callee.base.apply(this,arguments)},storeWillFetchQuery:function(d){var b=this.get("status"),a=SC.Record;if((b===a.EMPTY)||(b===a.ERROR)){b=a.BUSY_LOADING}if(b&a.READY){b=a.BUSY_REFRESH}this.setIfChanged("status",b);return this},storeDidFetchQuery:function(a){this.setIfChanged("status",SC.Record.READY_CLEAN);return this},storeDidCancelQuery:function(d){var b=this.get("status"),a=SC.Record;if(b===a.BUSY_LOADING){b=a.EMPTY}else{if(b===a.BUSY_REFRESH){b=a.READY_CLEAN}}this.setIfChanged("status",b);return this},storeDidErrorQuery:function(a){this.setIfChanged("status",SC.Record.ERROR);return this},storeDidChangeStoreKeys:function(b,a){var d=this.get("query");if(d.get("location")!==SC.Query.LOCAL){return this}if(!d.containsRecordTypes(a)){return this}var e=this._scq_changedStoreKeys;if(!e){e=this._scq_changedStoreKeys=SC.IndexSet.create()}e.addEach(b);this.set("needsFlush",YES);if(this.get("storeKeys")){this.flush()}return this},flush:function(a){if(this._insideFlush){this.set("needsFlush",YES);return this}if(!this.get("needsFlush")&&!a){return this}this.set("needsFlush",NO);var l=this.get("query"),o=this.get("store");if(!o||!l||l.get("location")!==SC.Query.LOCAL){return this}this._insideFlush=YES;var j=this.get("storeKeys"),g=this._scq_changedStoreKeys,h=NO,m=SC.Record,s=[],b=new Date(),e,f,d,t,q,k;var n=j;if(j&&!a){if(g){g.forEach(function(u){if(s.length>0||new Date()-b>SC.RecordArray.QUERY_MATCHING_THRESHOLD){s.push(u);return}f=o.peekStatus(u);if(!(f&m.EMPTY)&&!((f&m.DESTROYED)||(f===m.BUSY_DESTROYING))){e=o.materializeRecord(u);k=!!(e&&l.contains(e))}else{k=NO}if(k){if(j.indexOf(u)<0){if(!h){j=j.copy()}j.pushObject(u)}}else{if(j.indexOf(u)>=0){if(!h){j=j.copy()}j.removeObject(u)}}},this);h=YES}}else{if(q=l.get("scope")){t=q.flush().get("storeKeys")}else{if(d=l.get("expandedRecordTypes")){t=SC.IndexSet.create();d.forEach(function(u){t.addEach(o.storeKeysFor(u))})}}j=[];t.forEach(function(u){if(s.length>0||new Date()-b>SC.RecordArray.QUERY_MATCHING_THRESHOLD){s.push(u);return}f=o.peekStatus(u);if(!(f&m.EMPTY)&&!((f&m.DESTROYED)||(f===m.BUSY_DESTROYING))){e=o.materializeRecord(u);if(e&&l.contains(e)){j.push(u)}}});h=YES}if(s.length>0){var p=this;window.setTimeout(function(){SC.run(function(){if(!p||p.get("isDestroyed")){return}p.set("needsFlush",YES);p._scq_changedStoreKeys=SC.IndexSet.create().addEach(s);p.flush()})},1)}if(g){g.clear()}if(h){if(j&&(j===n)){j=j.copy()}j=SC.Query.orderStoreKeys(j,l,o);if(SC.compare(n,j)!==0){this.set("storeKeys",SC.clone(j))}}this._insideFlush=NO;return this},needsFlush:YES,isError:function(){return !!(this.get("status")&SC.Record.ERROR)}.property("status").cacheable(),errorValue:function(){return this.get("isError")?SC.val(this.get("errorObject")):null}.property("isError").cacheable(),errorObject:function(){if(this.get("isError")){var a=this.get("store");return a.readQueryError(this.get("query"))||SC.Record.GENERIC_ERROR}else{return null}}.property("isError").cacheable(),propertyWillChange:function(b){if(b==="storeKeys"){var d=this.get("storeKeys");var a=d?d.get("length"):0;this.arrayContentWillChange(0,a,0)}return arguments.callee.base.apply(this,arguments)},_storeKeysDidChange:function(){var g=this.get("storeKeys");var e=this._prevStoreKeys,b,d,h=this._storeKeysContentDidChange,a=this._storeKeysStateDidChange;if(g===e){return}if(e){e.removeArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:this._storeKeysContentDidChange});b=e.get("length")}else{b=0}this._prevStoreKeys=g;if(g){g.addArrayObservers({target:this,willChange:this.arrayContentWillChange,didChange:this._storeKeysContentDidChange});d=g.get("length")}else{d=0}this._storeKeysContentDidChange(0,b,d)}.observes("storeKeys"),addArrayObservers:function(){this.flush();return SC.Array.addArrayObservers.apply(this,arguments)},_storeKeysContentDidChange:function(d,a,b){if(this._scra_records){this._scra_records.length=0}this.arrayContentDidChange(d,a,b)},init:function(){arguments.callee.base.apply(this,arguments);this._storeKeysDidChange()}});SC.RecordArray.mixin({NOT_EDITABLE:SC.Error.desc("SC.RecordArray is not editable"),QUERY_MATCHING_THRESHOLD:100});Function.prototype.handleEvents=function(){this.isEventHandler=YES;this.events=arguments;return this};Function.prototype.stateObserves=function(){this.isStateObserveHandler=YES;this.args=SC.A(arguments);return this};SC.StatechartDelegate={isStatechartDelegate:YES,statechartUpdateLocationForState:function(b,a,d){SC.routes.set("location",a)},statechartAcquireLocationForState:function(a,b){return SC.routes.get("location")},statechartBindStateToRoute:function(b,e,a,d){SC.routes.add(a,e,d)},statechartShouldStateHandleTriggeredRoute:function(a,d,b){return YES},statechartStateCancelledHandlingTriggeredRoute:function(a,d,b){}};SC.StatePathMatcher=SC.Object.extend({state:null,expression:null,tokens:null,init:function(){arguments.callee.base.apply(this,arguments);this._parseExpression()},_parseExpression:function(){var j=this.expression?this.expression.split("."):[],b=j.length,g=0,d,f=null,e,h=[];for(;g<b;g+=1){d=j[g];if(d.indexOf("~")>=0){d=d.split("~");if(d.length>2){throw"Invalid use of '~' at part %@".fmt(g)}e=SC.StatePathMatcher._ExpandToken.create({start:d[0],end:d[1]})}else{if(d==="this"){if(h.length>0){throw"Invalid use of 'this' at part %@".fmt(g)}e=SC.StatePathMatcher._ThisToken.create()}else{e=SC.StatePathMatcher._BasicToken.create({value:d})}}e.owner=this;h.push(e)}this.set("tokens",h);var a=SC.clone(h);this._chain=f=a.pop();while(e=a.pop()){f.nextToken=e;f=e}},lastPart:function(){var d=this.get("tokens"),a=d?d.length:0,b=a>0?d[a-1]:null;return b.get("lastPart")}.property("tokens").cacheable(),match:function(a){this._stack=a.split(".");if(SC.empty(a)||SC.typeOf(a)!==SC.T_STRING){return NO}return this._chain.match()},_pop:function(){this._lastPopped=this._stack.pop();return this._lastPopped}});SC.StatePathMatcher._Token=SC.Object.extend({type:null,owner:null,nextToken:null,lastPart:null,match:function(){return NO}});SC.StatePathMatcher._BasicToken=SC.StatePathMatcher._Token.extend({type:"basic",value:null,lastPart:function(){return this.value}.property("value").cacheable(),match:function(){var a=this.owner._pop(),b=this.nextToken;if(this.value!==a){return NO}return b?b.match():YES}});SC.StatePathMatcher._ExpandToken=SC.StatePathMatcher._Token.extend({type:"expand",start:null,end:null,lastPart:function(){return this.end}.property("end").cacheable(),match:function(){var e=this.start,a=this.end,b,d=this.nextToken;b=this.owner._pop();if(b!==a){return NO}while(b=this.owner._pop()){if(b===e){return d?d.match():YES}}return NO}});SC.StatePathMatcher._ThisToken=SC.StatePathMatcher._Token.extend({type:"this",lastPart:"this",match:function(){var f=this.owner.state,d=f.get("substates"),a=d.length,e=0,b;b=this.owner._lastPopped;if(!b||this.owner._stack.length!==0){return NO}for(;e<a;e+=1){if(d[e].get("name")===b){return YES}}return NO}});SC.Async=SC.Object.extend({func:null,arg1:null,arg2:null,tryToPerform:function(e){var d=this.get("func"),b=this.get("arg1"),a=this.get("arg2"),f=SC.typeOf(d);if(f===SC.T_STRING){e.tryToPerform(d,b,a)}else{if(f===SC.T_FUNCTION){d.apply(e,[b,a])}}}});SC.Async.mixin({perform:function(d,b,a){return SC.Async.create({func:d,arg1:b,arg2:a})}});SC.State=SC.Object.extend({name:null,parentState:null,historyState:null,initialSubstate:null,substatesAreConcurrent:NO,substates:null,statechart:null,stateIsInitialized:NO,currentSubstates:null,enteredSubstates:null,representRoute:null,trace:function(){var a=this.getPath("statechart.statechartTraceKey");return this.getPath("statechart.%@".fmt(a))}.property().cacheable(),owner:function(){var d=this.get("statechart"),b=d?d.get("statechartOwnerKey"):null,a=d?d.get(b):null;return a?a:d}.property().cacheable(),statechartDelegate:function(){return this.getPath("statechart.statechartDelegate")}.property().cacheable(),location:function(b,d){var e=this.get("statechart"),a=this.get("statechartDelegate");if(d!==undefined){a.statechartUpdateLocationForState(e,d,this)}return a.statechartAcquireLocationForState(e,this)}.property().idempotent(),init:function(){arguments.callee.base.apply(this,arguments);this._registeredEventHandlers={};this._registeredStringEventHandlers={};this._registeredRegExpEventHandlers=[];this._registeredStateObserveHandlers={};this._registeredSubstatePaths={};this._registeredSubstates=[];this._isEnteringState=NO;this._isExitingState=NO;var b=this.get("statechart"),d=b?b.get("statechartOwnerKey"):null,a=b?b.get("statechartTraceKey"):null;if(b){b.addObserver(d,this,"_statechartOwnerDidChange");b.addObserver(a,this,"_statechartTraceDidChange")}},destroy:function(){var d=this.get("statechart"),e=d?d.get("statechartOwnerKey"):null,a=d?d.get("statechartTraceKey"):null;if(d){d.removeObserver(e,this,"_statechartOwnerDidChange");d.removeObserver(a,this,"_statechartTraceDidChange")}var b=this.get("substates");if(b){b.forEach(function(f){f.destroy()})}this._teardownAllStateObserveHandlers();this.set("substates",null);this.set("currentSubstates",null);this.set("enteredSubstates",null);this.set("parentState",null);this.set("historyState",null);this.set("initialSubstate",null);this.set("statechart",null);this.notifyPropertyChange("trace");this.notifyPropertyChange("owner");this._registeredEventHandlers=null;this._registeredStringEventHandlers=null;this._registeredRegExpEventHandlers=null;this._registeredStateObserveHandlers=null;this._registeredSubstatePaths=null;this._registeredSubstates=null;arguments.callee.base.apply(this,arguments)},initState:function(){if(this.get("stateIsInitialized")){return}this._registerWithParentStates();this._setupRouteHandling();var m=null,l=null,b=null,n=[],k=NO,j=this.get("initialSubstate"),g=this.get("substatesAreConcurrent"),e=this.get("statechart"),d=0,h=0,f=NO,a=null;this.set("substates",n);if(SC.kindOf(j,SC.HistoryState)&&j.isClass){a=this.createSubstate(j);this.set("initialSubstate",a);if(SC.none(a.get("defaultState"))){this.stateLogError("Initial substate is invalid. History state requires the name of a default state to be set");this.set("initialSubstate",null);a=null}}for(m in this){l=this[m];f=SC.typeOf(l)===SC.T_FUNCTION;if(f&&l.isEventHandler){this._registerEventHandler(m,l);continue}if(f&&l.isStateObserveHandler){this._registerStateObserveHandler(m,l);continue}if(f&&l.statePlugin){l=l.apply(this)}if(SC.kindOf(l,SC.State)&&l.isClass&&this[m]!==this.constructor){b=this._addSubstate(m,l);if(m===j){this.set("initialSubstate",b);k=YES}else{if(a&&a.get("defaultState")===m){a.set("defaultState",b);k=YES}}}}if(!SC.none(j)&&!k){this.stateLogError("Unable to set initial substate %@ since it did not match any of state's %@ substates".fmt(j,this))}if(n.length===0){if(!SC.none(j)){this.stateLogWarning("Unable to make %@ an initial substate since state %@ has no substates".fmt(j,this))}}else{if(n.length>0){b=this._addEmptyInitialSubstateIfNeeded();if(!b&&j&&g){this.set("initialSubstate",null);this.stateLogWarning("Can not use %@ as initial substate since substates are all concurrent for state %@".fmt(j,this))}}}this.notifyPropertyChange("substates");this.set("currentSubstates",[]);this.set("enteredSubstates",[]);this.set("stateIsInitialized",YES)},_setupRouteHandling:function(){var b=this.get("representRoute"),d=this.get("statechart"),a=this.get("statechartDelegate");if(!b){return}if(this.get("isConcurrentState")){this.stateLogError("State %@ cannot handle route '%@' since state is concurrent".fmt(this,b));return}a.statechartBindStateToRoute(d,this,b,this.routeTriggered)},routeTriggered:function(g){if(this._isEnteringState){return}var f=this.get("statechart"),b=this.get("statechartDelegate"),e=this.get("location");var a={state:this,location:e,params:g,handler:this.routeTriggered};var d=this.createStateRouteHandlerContext(a);if(b.statechartShouldStateHandleTriggeredRoute(f,this,d)){if(this.get("trace")&&e){this.stateLogTrace("will handle route '%@'".fmt(e))}this.handleTriggeredRoute(d)}else{b.statechartStateCancelledHandlingTriggeredRoute(f,this,d)}},createStateRouteHandlerContext:function(a){return SC.StateRouteHandlerContext.create(a)},handleTriggeredRoute:function(a){this.gotoState(this,a)},_addEmptyInitialSubstateIfNeeded:function(){var d=this.get("initialSubstate"),b=this.get("substatesAreConcurrent");if(d||b){return null}var a=this.createSubstate(SC.EmptyState);this.set("initialSubstate",a);this.get("substates").push(a);this[a.get("name")]=a;a.initState();this.stateLogWarning("state %@ has no initial substate defined. Will default to using an empty state as initial substate".fmt(this));return a},_addSubstate:function(d,e,a){var b=this.get("substates");a=SC.clone(a)||{};a.name=d;e=this.createSubstate(e,a);b.push(e);this[d]=e;e.initState();return e},addSubstate:function(d,f,b){if(SC.empty(d)){this.stateLogError("Can not add substate. name required");return null}if(this[d]!==undefined){this.stateLogError("Can not add substate '%@'. Already a defined property".fmt(d));return null}if(!this.get("stateIsInitialized")){this.stateLogError("Can not add substate '%@'. this state is not yet initialized".fmt(d));return null}var a=arguments.length;if(a===1){f=SC.State}else{if(a===2&&SC.typeOf(f)===SC.T_HASH){b=f;f=SC.State}}var e=SC.kindOf(f,SC.State)&&f.isClass;if(!e){this.stateLogError("Can not add substate '%@'. must provide a state class".fmt(d));return null}f=this._addSubstate(d,f,b);this._addEmptyInitialSubstateIfNeeded();this.notifyPropertyChange("substates");return f},createSubstate:function(b,a){a=a||{};return b.create({parentState:this,statechart:this.get("statechart")},a)},_registerEventHandler:function(b,f){var e=f.events,g=null,a=e.length,d=0;this._registeredEventHandlers[b]=f;for(;d<a;d+=1){g=e[d];if(SC.typeOf(g)===SC.T_STRING){this._registeredStringEventHandlers[g]={name:b,handler:f};continue}if(g instanceof RegExp){this._registeredRegExpEventHandlers.push({name:b,handler:f,regexp:g});continue}this.stateLogError("Invalid event %@ for event handler %@ in state %@".fmt(g,b,this))}},_registerStateObserveHandler:function(e,g){var f=0,d=g.args,b=d.length,a,h=YES;for(;f<b;f+=1){a=d[f];if(SC.typeOf(a)!==SC.T_STRING||SC.empty(a)){this.stateLogError("Invalid argument %@ for state observe handler %@ in state %@".fmt(a,e,this));h=NO}}if(!h){return}this._registeredStateObserveHandlers[e]=g.args},_registerWithParentStates:function(){var a=this.get("parentState");while(!SC.none(a)){a._registerSubstate(this);a=a.get("parentState")}},_registerSubstate:function(b){var d=b.pathRelativeTo(this);if(SC.none(d)){return}this._registeredSubstates.push(b);var a=this._registeredSubstatePaths;if(a[b.get("name")]===undefined){a[b.get("name")]={}}var e=a[b.get("name")];e[d]=b},pathRelativeTo:function(b){var d=this.get("name"),a=this.get("parentState");while(!SC.none(a)&&a!==b){d="%@.%@".fmt(a.get("name"),d);a=a.get("parentState")}if(a!==b&&b!==this){this.stateLogError("Can not generate relative path from %@ since it not a parent state of %@".fmt(b,this));return null}return d},getSubstate:function(g,j,f){if(!g){return null}var b=SC.typeOf(g);if(b===SC.T_OBJECT){return this._registeredSubstates.indexOf(g)>-1?g:null}if(b!==SC.T_STRING){this.stateLogError("Can not find matching subtype. value must be an object or string: %@".fmt(g));return null}var e=SC.StatePathMatcher.create({state:this,expression:g}),d=[],h;if(e.get("tokens").length===0){return null}var l=this._registeredSubstatePaths[e.get("lastPart")];if(!l){return this._notifySubstateNotFound(j,f,g)}for(h in l){if(e.match(h)){d.push(l[h])}}if(d.length===1){return d[0]}if(d.length>1){var k=[];for(h in l){k.push(h)}if(j){return this._notifySubstateNotFound(j,f,g,k)}var a="Can not find substate matching '%@' in state %@. Ambiguous with the following: %@";this.stateLogError(a.fmt(g,this.get("fullPath"),k.join(", ")))}return this._notifySubstateNotFound(j,f,g)},_notifySubstateNotFound:function(e,d,b,a){return e?e.call(d||this,this,b,a):null},getState:function(a){if(a===this.get("name")){return this}if(SC.kindOf(a,SC.State)){return a}return this.getSubstate(a,this._handleSubstateNotFound)},_handleSubstateNotFound:function(e,d,a){var b=this.get("parentState");if(b){return b.getState(d)}if(a){var f="Can not find state matching '%@'. Ambiguous with the following: %@";this.stateLogError(f.fmt(d,a.join(", ")))}return null},gotoState:function(d,a){var b=this.getState(d);if(!b){var e="can not go to state %@ from state %@. Invalid value.";this.stateLogError(e.fmt(d,this));return}var f=this.findFirstRelativeCurrentState(b);this.get("statechart").gotoState(b,f,false,a)},gotoHistoryState:function(e,a,b){var d=this.getState(e);if(!d){var f="can not go to history state %@ from state %@. Invalid value.";this.stateLogError(f.fmt(e,this));return}var g=this.findFirstRelativeCurrentState(d);this.get("statechart").gotoHistoryState(d,g,a,b)},resumeGotoState:function(){this.get("statechart").resumeGotoState()},stateIsCurrentSubstate:function(a){if(SC.typeOf(a)===SC.T_STRING){a=this.get("statechart").getState(a)}var b=this.get("currentSubstates");return !!b&&b.indexOf(a)>=0},stateIsEnteredSubstate:function(b){if(SC.typeOf(b)===SC.T_STRING){b=this.get("statechart").getState(b)}var a=this.get("enteredSubstates");return !!a&&a.indexOf(b)>=0},isRootState:function(){return this.getPath("statechart.rootState")===this}.property(),isCurrentState:function(){return this.stateIsCurrentSubstate(this)}.property("currentSubstates").cacheable(),isConcurrentState:function(){return this.getPath("parentState.substatesAreConcurrent")}.property(),isEnteredState:function(){return this.stateIsEnteredSubstate(this)}.property("enteredSubstates").cacheable(),hasSubstates:function(){return this.getPath("substates.length")>0}.property("substates"),hasCurrentSubstates:function(){var a=this.get("currentSubstates");return !!a&&a.get("length")>0}.property("currentSubstates").cacheable(),hasEnteredSubstates:function(){var a=this.get("enteredSubstates");return !!a&&a.get("length")>0}.property("enteredSubstates").cacheable(),findFirstRelativeCurrentState:function(b){if(this.get("isCurrentState")){return this}var a=this.get("currentSubstates")||[],e=a.get("length"),d=this.get("parentState");if(e===0){return d?d.findFirstRelativeCurrentState():null}if(e>1){b=this.getSubstate(b);if(b){return b.findFirstRelativeCurrentState()}}return a[0]},reenter:function(){if(this.get("isEnteredState")){this.gotoState(this)}else{SC.Logger.error("Can not re-enter state %@ since it is not an entered state in the statechart".fmt(this))}},tryToHandleEvent:function(a,f,e){var d=this.get("trace"),j=this.get("statechart"),h;if(this._registeredEventHandlers[a]){this.stateLogWarning("state %@ can not handle event '%@' since it is a registered event handler".fmt(this,a));return NO}if(this._registeredStateObserveHandlers[a]){this.stateLogWarning("state %@ can not handle event '%@' since it is a registered state observe handler".fmt(this,a));return NO}if(SC.typeOf(this[a])===SC.T_FUNCTION){if(d){this.stateLogTrace("will handle event '%@'".fmt(a))}j.stateWillTryToHandleEvent(this,a,a);h=(this[a](f,e)!==NO);j.stateDidTryToHandleEvent(this,a,a,h);return h}var k=this._registeredStringEventHandlers[a];if(k){if(d){this.stateLogTrace("%@ will handle event '%@'".fmt(k.name,a))}j.stateWillTryToHandleEvent(this,a,k.name);h=(k.handler.call(this,a,f,e)!==NO);j.stateDidTryToHandleEvent(this,a,k.name,h);return h}var g=this._registeredRegExpEventHandlers.length,b=0;for(;b<g;b+=1){k=this._registeredRegExpEventHandlers[b];if(a.match(k.regexp)){if(d){this.stateLogTrace("%@ will handle event '%@'".fmt(k.name,a))}j.stateWillTryToHandleEvent(this,a,k.name);h=(k.handler.call(this,a,f,e)!==NO);j.stateDidTryToHandleEvent(this,a,k.name,h);return h}}if(SC.typeOf(this["unknownEvent"])===SC.T_FUNCTION){if(d){this.stateLogTrace("unknownEvent will handle event '%@'".fmt(a))}j.stateWillTryToHandleEvent(this,a,"unknownEvent");h=(this.unknownEvent(a,f,e)!==NO);j.stateDidTryToHandleEvent(this,a,"unknownEvent",h);return h}return NO},enterState:function(a){},stateWillBecomeEntered:function(a){this._isEnteringState=YES},stateDidBecomeEntered:function(a){this._setupAllStateObserveHandlers();this._isEnteringState=NO},exitState:function(a){},stateWillBecomeExited:function(a){this._isExitingState=YES;this._teardownAllStateObserveHandlers()},stateDidBecomeExited:function(a){this._isExitingState=NO},_setupAllStateObserveHandlers:function(){this._configureAllStateObserveHandlers("addObserver")},_teardownAllStateObserveHandlers:function(){this._configureAllStateObserveHandlers("removeObserver")},_configureAllStateObserveHandlers:function(b){var h,j,g,a,k,e,d,f;for(h in this._registeredStateObserveHandlers){j=this._registeredStateObserveHandlers[h];for(d=0;d<j.length;d+=1){k=j[d];e=h;a=k.indexOf(".");if(a<0){this[b](k,this,e)}else{if(k.indexOf("*")===0){this[b](k.slice(1),this,e)}else{f=null;if(a===0){f=this;k=k.slice(1)}else{if(a===4&&k.slice(0,5)==="this."){f=this;k=k.slice(5)}else{if(a<0&&k.length===4&&k==="this"){f=this;k=""}}}SC.Observers[b](k,this,e,f)}}}}},performAsync:function(d,b,a){return SC.Async.perform(d,b,a)},respondsToEvent:function(e){if(this._registeredEventHandlers[e]){return false}if(SC.typeOf(this[e])===SC.T_FUNCTION){return true}if(this._registeredStringEventHandlers[e]){return true}if(this._registeredStateObserveHandlers[e]){return false}var a=this._registeredRegExpEventHandlers.length,b=0,d;for(;b<a;b+=1){d=this._registeredRegExpEventHandlers[b];if(e.match(d.regexp)){return true}}return SC.typeOf(this["unknownEvent"])===SC.T_FUNCTION},fullPath:function(){var a=this.getPath("statechart.rootState");if(!a){return this.get("name")}return this.pathRelativeTo(a)}.property("name","parentState").cacheable(),toString:function(){return this.get("fullPath")},_enteredSubstatesDidChange:function(){this.notifyPropertyChange("enteredSubstates")}.observes("*enteredSubstates.[]"),_currentSubstatesDidChange:function(){this.notifyPropertyChange("currentSubstates")}.observes("*currentSubstates.[]"),_statechartTraceDidChange:function(){this.notifyPropertyChange("trace")},_statechartOwnerDidChange:function(){this.notifyPropertyChange("owner")},stateLogTrace:function(b){var a=this.get("statechart");a.statechartLogTrace("%@: %@".fmt(this,b))},stateLogWarning:function(b){var a=this.get("statechart");a.statechartLogWarning(b)},stateLogError:function(b){var a=this.get("statechart");a.statechartLogError(b)}});SC.State.plugin=function(d){var a=SC.A(arguments);a.shift();var b=function(){var e=SC.objectForPropertyPath(d);if(!e){console.error("SC.State.plugin: Unable to determine path %@".fmt(d));return undefined}if(!e.isClass||!e.kindOf(SC.State)){console.error("SC.State.plugin: Unable to extend. %@ must be a class extending from SC.State".fmt(d));return undefined}return e.extend.apply(e,a)};b.statePlugin=YES;return b};SC.State.design=SC.State.extend;sc_require("system/state");SC.EMPTY_STATE_NAME="__EMPTY_STATE__";SC.EmptyState=SC.State.extend({name:SC.EMPTY_STATE_NAME,enterState:function(){var a="No initial substate was defined for state %@. Entering default empty state";this.stateLogWarning(a.fmt(this.get("parentState")))}});sc_require("system/state");SC.HistoryState=SC.Object.extend({isRecursive:NO,defaultState:null,statechart:null,parentState:null,state:function(){var b=this.get("defaultState"),a=this.getPath("parentState.historyState");return !!a?a:b}.property().cacheable(),parentHistoryStateDidChange:function(){this.notifyPropertyChange("state")}.observes("*parentState.historyState")});SC.StateRouteHandlerContext=SC.Object.extend({state:null,location:null,params:null,handler:null,retry:function(){var b=this.get("state"),d=this.get("params"),a=this.get("handler");if(SC.typeOf(a)===SC.T_STRING){a=b[a]}if(SC.typeOf(a)===SC.T_FUNCTION){a.apply(b,[d])}}});sc_require("system/state");sc_require("mixins/statechart_delegate");SC.StatechartManager={isResponderContext:YES,isStatechart:YES,statechartIsInitialized:NO,name:null,rootState:null,rootStateExample:SC.State,initialState:null,statesAreConcurrent:NO,monitorIsActive:NO,monitor:null,statechartTraceKey:"trace",trace:NO,statechartOwnerKey:"owner",owner:null,autoInitStatechart:YES,suppressStatechartWarnings:NO,delegate:null,statechartDelegate:function(){var a=this.get("delegate");return this.delegateFor("isStatechartDelegate",a)}.property("delegate"),initMixin:function(){if(this.get("autoInitStatechart")){this.initStatechart()}},destroyMixin:function(){var b=this.get("rootState"),a=this.get("statechartTraceKey");this.removeObserver(a,this,"_statechartTraceDidChange");b.destroy();this.set("rootState",null)},initStatechart:function(){if(this.get("statechartIsInitialized")){return}this._gotoStateLocked=NO;this._sendEventLocked=NO;this._pendingStateTransitions=[];this._pendingSentEvents=[];this.sendAction=this.sendEvent;if(this.get("monitorIsActive")){this.set("monitor",SC.StatechartMonitor.create({statechart:this}))}var a=this.get("statechartTraceKey");this.addObserver(a,this,"_statechartTraceDidChange");this._statechartTraceDidChange();var e=this.get("allowStatechartTracing"),d=this.get("rootState"),f;if(e){this.statechartLogTrace("BEGIN initialize statechart")}if(!d){d=this._constructRootStateClass()}else{if(SC.typeOf(d)===SC.T_FUNCTION&&d.statePlugin){d=d.apply(this)}}if(!(SC.kindOf(d,SC.State)&&d.isClass)){f="Unable to initialize statechart. Root state must be a state class";this.statechartLogError(f);throw f}d=this.createRootState(d,{statechart:this,name:SC.ROOT_STATE_NAME});this.set("rootState",d);d.initState();if(SC.kindOf(d.get("initialSubstate"),SC.EmptyState)){f="Unable to initialize statechart. Root state must have an initial substate explicilty defined";this.statechartLogError(f);throw f}if(!SC.empty(this.get("initialState"))){var b="initialState";this.set(b,d.get(this.get(b)))}this.set("statechartIsInitialized",YES);this.gotoState(d);if(e){this.statechartLogTrace("END initialize statechart")}},createRootState:function(b,a){if(!a){a={}}b=b.create(a);return b},currentStates:function(){return this.getPath("rootState.currentSubstates")}.property().cacheable(),firstCurrentState:function(){var a=this.get("currentStates");return a?a.objectAt(0):null}.property("currentStates").cacheable(),currentStateCount:function(){return this.getPath("currentStates.length")}.property("currentStates").cacheable(),stateIsCurrentState:function(a){return this.get("rootState").stateIsCurrentSubstate(a)},enteredStates:function(){return this.getPath("rootState.enteredSubstates")}.property().cacheable(),stateIsEntered:function(a){return this.get("rootState").stateIsEnteredSubstate(a)},doesContainState:function(a){return !SC.none(this.getState(a))},getState:function(b){var a=this.get("rootState");return a===b?a:a.getSubstate(b)},gotoState:function(b,m,n,d){if(!this.get("statechartIsInitialized")){this.statechartLogError("can not go to state %@. statechart has not yet been initialized".fmt(b));return}if(this.get("isDestroyed")){this.statechartLogError("can not go to state %@. statechart is destroyed".fmt(this));return}var k=this._processGotoStateArgs(arguments);b=k.state;m=k.fromCurrentState;n=k.useHistory;d=k.context;var p=null,l=[],o=[],g=this.get("allowStatechartTracing"),a=this.get("rootState"),j=b,f=m,e;b=this.getState(b);if(SC.none(b)){this.statechartLogError("Can not to goto state %@. Not a recognized state in statechart".fmt(j));return}if(this._gotoStateLocked){this._pendingStateTransitions.push({state:b,fromCurrentState:m,useHistory:n,context:d});return}this._gotoStateLocked=YES;if(m){m=this.getState(m);if(SC.none(m)||!m.get("isCurrentState")){e="Can not to goto state %@. %@ is not a recognized current state in statechart";this.statechartLogError(e.fmt(j,f));this._gotoStateLocked=NO;return}}else{m=b.findFirstRelativeCurrentState();if(!m){m=this.get("firstCurrentState")}}if(g){this.statechartLogTrace("BEGIN gotoState: %@".fmt(b));e="starting from current state: %@";e=e.fmt(m?m:"---");this.statechartLogTrace(e);e="current states before: %@";e=e.fmt(this.getPath("currentStates.length")>0?this.get("currentStates"):"---");this.statechartLogTrace(e)}if(!SC.none(m)){l=this._createStateChain(m)}o=this._createStateChain(b);p=this._findPivotState(l,o);if(p){if(g){this.statechartLogTrace("pivot state = %@".fmt(p))}if(p.get("substatesAreConcurrent")&&p!==b){this.statechartLogError("Can not go to state %@ from %@. Pivot state %@ has concurrent substates.".fmt(b,m,p));this._gotoStateLocked=NO;return}}var h=[];this._traverseStatesToExit(l.shift(),l,p,h);if(p!==b){this._traverseStatesToEnter(o.pop(),o,p,n,h)}else{this._traverseStatesToExit(p,[],null,h);this._traverseStatesToEnter(p,null,null,n,h)}this._gotoStateActions=h;this._executeGotoStateActions(b,h,null,d)},gotoStateActive:function(){return this._gotoStateLocked}.property(),gotoStateSuspended:function(){return this._gotoStateLocked&&!!this._gotoStateSuspendedPoint}.property(),resumeGotoState:function(){if(!this.get("gotoStateSuspended")){this.statechartLogError("Can not resume goto state since it has not been suspended");return}var a=this._gotoStateSuspendedPoint;this._executeGotoStateActions(a.gotoState,a.actions,a.marker,a.context)},_executeGotoStateActions:function(h,g,b,d){var f=null,a=g.length,e=null;b=SC.none(b)?0:b;for(;b<a;b+=1){this._currentGotoStateAction=f=g[b];switch(f.action){case SC.EXIT_STATE:e=this._exitState(f.state,d);break;case SC.ENTER_STATE:e=this._enterState(f.state,f.currentState,d);break}if(SC.kindOf(e,SC.Async)){this._gotoStateSuspendedPoint={gotoState:h,actions:g,marker:b+1,context:d};e.tryToPerform(f.state);return}}this.beginPropertyChanges();this.notifyPropertyChange("currentStates");this.notifyPropertyChange("enteredStates");this.endPropertyChanges();if(this.get("allowStatechartTracing")){this.statechartLogTrace("current states after: %@".fmt(this.get("currentStates")));this.statechartLogTrace("END gotoState: %@".fmt(h))}this._cleanupStateTransition()},_cleanupStateTransition:function(){this._currentGotoStateAction=null;this._gotoStateSuspendedPoint=null;this._gotoStateActions=null;this._gotoStateLocked=NO;this._flushPendingStateTransition()},_exitState:function(e,b){var d;if(e.get("currentSubstates").indexOf(e)>=0){d=e.get("parentState");while(d){d.get("currentSubstates").removeObject(e);d=d.get("parentState")}}d=e;while(d){d.get("enteredSubstates").removeObject(e);d=d.get("parentState")}if(this.get("allowStatechartTracing")){this.statechartLogTrace("<-- exiting state: %@".fmt(e))}e.set("currentSubstates",[]);e.stateWillBecomeExited(b);var a=this.exitState(e,b);e.stateDidBecomeExited(b);if(this.get("monitorIsActive")){this.get("monitor").pushExitedState(e)}e._traverseStatesToExit_skipState=NO;return a},exitState:function(b,a){return b.exitState(a)},_enterState:function(e,f,b){var d=e.get("parentState");if(d&&!e.get("isConcurrentState")){d.set("historyState",e)}if(f){d=e;while(d){d.get("currentSubstates").pushObject(e);d=d.get("parentState")}}d=e;while(d){d.get("enteredSubstates").pushObject(e);d=d.get("parentState")}if(this.get("allowStatechartTracing")){this.statechartLogTrace("--> entering state: %@".fmt(e))}e.stateWillBecomeEntered(b);var a=this.enterState(e,b);e.stateDidBecomeEntered(b);if(this.get("monitorIsActive")){this.get("monitor").pushEnteredState(e)}return a},enterState:function(b,a){if(b.enterStateByRoute&&SC.kindOf(a,SC.StateRouteHandlerContext)){return b.enterStateByRoute(a)}else{return b.enterState(a)}},gotoHistoryState:function(g,f,d,e){if(!this.get("statechartIsInitialized")){this.statechartLogError("can not go to state %@'s history state. Statechart has not yet been initialized".fmt(g));return}var b=this._processGotoStateArgs(arguments);g=b.state;f=b.fromCurrentState;d=b.useHistory;e=b.context;g=this.getState(g);if(!g){this.statechartLogError("Can not to goto state %@'s history state. Not a recognized state in statechart".fmt(g));return}var a=g.get("historyState");if(!d){if(a){this.gotoState(a,f,e)}else{this.gotoState(g,f,e)}}else{this.gotoState(g,f,YES,e)}},sendEvent:function(b,h,g){if(this.get("isDestroyed")){this.statechartLogError("can send event %@. statechart is destroyed".fmt(b));return}var d=NO,m=NO,j=this.get("currentStates").slice(),l={},k=0,f=0,a=null,e=this.get("allowStatechartTracing");if(this._sendEventLocked||this._goStateLocked){this._pendingSentEvents.push({event:b,arg1:h,arg2:g});return}this._sendEventLocked=YES;if(e){this.statechartLogTrace("BEGIN sendEvent: '%@'".fmt(b))}k=j.get("length");for(;f<k;f+=1){m=NO;a=j[f];if(!a.get("isCurrentState")){continue}while(!m&&a){if(!l[a.get("fullPath")]){m=a.tryToHandleEvent(b,h,g);l[a.get("fullPath")]=YES}if(!m){a=a.get("parentState")}else{d=YES}}}this._sendEventLocked=NO;if(e){if(!d){this.statechartLogTrace("No state was able handle event %@".fmt(b))}this.statechartLogTrace("END sendEvent: '%@'".fmt(b))}var n=this._flushPendingSentEvents();return d?this:(n?this:null)},stateWillTryToHandleEvent:function(d,b,a){this._stateHandleEventInfo={state:d,event:b,handler:a}},stateDidTryToHandleEvent:function(d,b,a,e){this._stateHandleEventInfo=null},_createStateChain:function(b){var a=[];while(b){a.push(b);b=b.get("parentState")}return a},_findPivotState:function(d,b){if(d.length===0||b.length===0){return null}var a=d.find(function(f,e){if(b.indexOf(f)>=0){return YES}});return a},_traverseStatesToExit:function(b,l,e,j){if(!b||b===e){return}var f=this.get("allowStatechartTracing");if(b.get("substatesAreConcurrent")){var g=0,h=b.get("currentSubstates"),k=h.length,d=null;for(;g<k;g+=1){d=h[g];if(d._traverseStatesToExit_skipState===YES){continue}var a=this._createStateChain(d);this._traverseStatesToExit(a.shift(),a,b,j)}}j.push({action:SC.EXIT_STATE,state:b});if(b.get("isCurrentState")){b._traverseStatesToExit_skipState=YES}this._traverseStatesToExit(l.shift(),l,e,j)},_traverseStatesToEnter:function(b,f,k,h,e){if(!b){return}var d=this.get("allowStatechartTracing");if(k){if(b!==k){this._traverseStatesToEnter(f.pop(),f,k,h,e)}else{this._traverseStatesToEnter(f.pop(),f,null,h,e)}}else{if(!f||f.length===0){var j={action:SC.ENTER_STATE,state:b,currentState:NO};e.push(j);var g=b.get("initialSubstate"),a=b.get("historyState");if(b.get("substatesAreConcurrent")){this._traverseConcurrentStatesToEnter(b.get("substates"),null,h,e)}else{if(b.get("hasSubstates")&&a&&h){this._traverseStatesToEnter(a,null,null,h,e)}else{if(g){if(SC.kindOf(g,SC.HistoryState)){if(!h){h=g.get("isRecursive")}g=g.get("state")}this._traverseStatesToEnter(g,null,null,h,e)}else{j.currentState=YES}}}}else{if(f.length>0){e.push({action:SC.ENTER_STATE,state:b});var l=f.pop();this._traverseStatesToEnter(l,f,null,h,e);if(b.get("substatesAreConcurrent")){this._traverseConcurrentStatesToEnter(b.get("substates"),l,h,e)}}}}},respondsTo:function(e){var b=this.get("currentStates"),a=b.get("length"),d=0,f=null;for(;d<a;d+=1){f=b.objectAt(d);while(f){if(f.respondsToEvent(e)){return true}f=f.get("parentState")}}return SC.typeOf(this[e])===SC.T_FUNCTION},tryToPerform:function(e,d,b){if(!this.respondsTo(e)){return NO}if(SC.typeOf(this[e])===SC.T_FUNCTION){var a=this[e](d,b);if(a!==NO){return YES}}return !!this.sendEvent(e,d,b)},invokeStateMethod:function(l,k,d){if(l==="unknownEvent"){this.statechartLogError("can not invoke method unkownEvent");return}k=SC.A(arguments);k.shift();var g=k.length,n=g>0?k[g-1]:null,m=SC.typeOf(n)===SC.T_FUNCTION?k.pop():null,f=this.get("currentStates"),e=0,b=null,j={},a,o=undefined,h=0;g=f.get("length");for(;e<g;e+=1){b=f.objectAt(e);while(b){if(j[b.get("fullPath")]){break}j[b.get("fullPath")]=YES;a=b[l];if(SC.typeOf(a)===SC.T_FUNCTION&&!a.isEventHandler){o=a.apply(b,k);if(m){m.call(this,b,o)}h+=1;break}b=b.get("parentState")}}return h===1?o:undefined},_traverseConcurrentStatesToEnter:function(e,d,g,b){var f=0,a=e.length,h=null;for(;f<a;f+=1){h=e[f];if(h!==d){this._traverseStatesToEnter(h,null,null,g,b)}}},_flushPendingStateTransition:function(){if(!this._pendingStateTransitions){this.statechartLogError("Unable to flush pending state transition. _pendingStateTransitions is invalid");return}var a=this._pendingStateTransitions.shift();if(!a){return}this.gotoState(a.state,a.fromCurrentState,a.useHistory,a.context)},_flushPendingSentEvents:function(){var a=this._pendingSentEvents.shift();if(!a){return null}return this.sendEvent(a.event,a.arg1,a.arg2)},_monitorIsActiveDidChange:function(){if(this.get("monitorIsActive")&&SC.none(this.get("monitor"))){this.set("monitor",SC.StatechartMonitor.create())}}.observes("monitorIsActive"),_processGotoStateArgs:function(b){var e={state:null,fromCurrentState:null,useHistory:false,context:null},a=null,d=null;b=SC.$A(b);b=b.filter(function(f){return !(f===undefined)});a=b.length;if(a<1){return e}e.state=b[0];if(a===2){d=b[1];switch(SC.typeOf(d)){case SC.T_BOOL:e.useHistory=d;break;case SC.T_HASH:case SC.T_OBJECT:if(!SC.kindOf(d,SC.State)){e.context=d}break;default:e.fromCurrentState=d}}else{if(a===3){d=b[1];if(SC.typeOf(d)===SC.T_BOOL){e.useHistory=d;e.context=b[2]}else{e.fromCurrentState=d;d=b[2];if(SC.typeOf(d)===SC.T_BOOL){e.useHistory=d}else{e.context=d}}}else{e.fromCurrentState=b[1];e.useHistory=b[2];e.context=b[3]}}return e},_constructRootStateClass:function(){var e="rootStateExample",f=this.get(e),b=this.get("initialState"),d=this.get("statesAreConcurrent"),a=0,k,h,g,j={};if(SC.typeOf(f)===SC.T_FUNCTION&&f.statePlugin){f=f.apply(this)}if(!(SC.kindOf(f,SC.State)&&f.isClass)){this._logStatechartCreationError("Invalid root state example");return null}if(d&&!SC.empty(b)){this._logStatechartCreationError("Can not assign an initial state when states are concurrent")}else{if(d){j.substatesAreConcurrent=YES}else{if(SC.typeOf(b)===SC.T_STRING){j.initialSubstate=b}else{this._logStatechartCreationError("Must either define initial state or assign states as concurrent");return null}}}for(k in this){if(k===e){continue}h=this[k];g=SC.typeOf(h)===SC.T_FUNCTION;if(g&&h.statePlugin){h=h.apply(this)}if(SC.kindOf(h,SC.State)&&h.isClass&&this[k]!==this.constructor){j[k]=h;a+=1}}if(a===0){this._logStatechartCreationError("Must define one or more states");return null}return f.extend(j)},_logStatechartCreationError:function(a){SC.Logger.error("Unable to create statechart for %@: %@.".fmt(this,a))},statechartLogTrace:function(a){SC.Logger.info("%@: %@".fmt(this.get("statechartLogPrefix"),a))},statechartLogError:function(a){SC.Logger.error("ERROR %@: %@".fmt(this.get("statechartLogPrefix"),a))},statechartLogWarning:function(a){if(this.get("suppressStatechartWarnings")){return}SC.Logger.warn("WARN %@: %@".fmt(this.get("statechartLogPrefix"),a))},statechartLogPrefix:function(){var b=SC._object_className(this.constructor),a=this.get("name"),d;if(SC.empty(a)){d="%@<%@>".fmt(b,SC.guidFor(this))}else{d="%@<%@, %@>".fmt(b,a,SC.guidFor(this))}return d}.property().cacheable(),allowStatechartTracing:function(){var a=this.get("statechartTraceKey");return this.get(a)}.property().cacheable(),_statechartTraceDidChange:function(){this.notifyPropertyChange("allowStatechartTracing")},details:function(){var b={initialized:this.get("statechartIsInitialized")};if(this.get("name")){b.name=this.get("name")}if(!this.get("statechartIsInitialized")){return b}b["current-states"]=[];this.get("currentStates").forEach(function(g){b["current-states"].push(g.get("fullPath"))});var a={active:this.get("gotoStateActive"),suspended:this.get("gotoStateSuspended")};if(this._gotoStateActions){a["transition-sequence"]=[];var f=this._gotoStateActions,d=function(h){var g=h.action===SC.ENTER_STATE?"enter":"exit";return"%@ %@".fmt(g,h.state.get("fullPath"))};f.forEach(function(g){a["transition-sequence"].push(d(g))});a["current-transition"]=d(this._currentGotoStateAction)}b["state-transition"]=a;if(this._stateHandleEventInfo){var e=this._stateHandleEventInfo;b["handling-event"]={state:e.state.get("fullPath"),event:e.event,handler:e.handler}}else{b["handling-event"]=false}return b}.property(),toStringWithDetails:function(){var b="",d=this.toString(),a=this.get("details");b+=d+"\n";b+=this._hashToString(a,2);return b},_hashToString:function(e,a){var f="";for(var b in e){var d=e[b];if(d instanceof Array){f+=this._arrayToString(b,d,a)+"\n"}else{if(d instanceof Object){f+="%@%@:\n".fmt(" ".mult(a),b);f+=this._hashToString(d,a+2)}else{f+="%@%@: %@\n".fmt(" ".mult(a),b,d)}}}return f},_arrayToString:function(b,e,a){if(e.length===0){return"%@%@: []".fmt(" ".mult(a),b)}var d="%@%@: [\n".fmt(" ".mult(a),b);e.forEach(function(g,f){d+="%@%@\n".fmt(" ".mult(a+2),g)},this);d+=" ".mult(a)+"]";return d}};SC.mixin(SC.StatechartManager,SC.StatechartDelegate,SC.DelegateSupport);SC.ROOT_STATE_NAME="__ROOT_STATE__";SC.EXIT_STATE=0;SC.ENTER_STATE=1;SC.Statechart=SC.Object.extend(SC.StatechartManager,{autoInitStatechart:NO});SC.Statechart.design=SC.Statechart.extend;var Handlebars={};Handlebars.VERSION="1.0.beta.2";Handlebars.helpers={};Handlebars.partials={};Handlebars.registerHelper=function(b,d,a){if(a){d.not=a}this.helpers[b]=d};Handlebars.registerPartial=function(a,b){this.partials[a]=b};Handlebars.registerHelper("helperMissing",function(a){if(arguments.length===2){return undefined}else{throw new Error("Could not find property '"+a+"'")}});Handlebars.registerHelper("blockHelperMissing",function(g,e){var a=e.inverse||function(){},k=e.fn;var d="";var h=Object.prototype.toString.call(g);if(h==="[object Function]"){g=g()}if(g===true){return k(this)}else{if(g===false||g==null){return a(this)}else{if(h==="[object Array]"){if(g.length>0){for(var f=0,b=g.length;f<b;f++){d=d+k(g[f])}}else{d=a(this)}return d}else{return k(g)}}}});Handlebars.registerHelper("each",function(g,e){var h=e.fn,a=e.inverse;var d="";if(g&&g.length>0){for(var f=0,b=g.length;f<b;f++){d=d+h(g[f])}}else{d=a(this)}return d});Handlebars.registerHelper("if",function(b,a){if(!b||Handlebars.Utils.isEmpty(b)){return a.inverse(this)}else{return a.fn(this)}});Handlebars.registerHelper("unless",function(d,b){var e=b.fn,a=b.inverse;b.fn=a;b.inverse=e;return Handlebars.helpers["if"].call(this,d,b)});Handlebars.registerHelper("with",function(b,a){return a.fn(b)});Handlebars.registerHelper("log",function(a){Handlebars.log(a)});var handlebars=(function(){var g={trace:function d(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,param:27,STRING:28,INTEGER:29,BOOLEAN:30,hashSegments:31,hashSegment:32,ID:33,EQUALS:34,pathSegments:35,SEP:36,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",28:"STRING",29:"INTEGER",30:"BOOLEAN",33:"ID",34:"EQUALS",36:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[25,2],[25,1],[27,1],[27,1],[27,1],[27,1],[26,1],[31,2],[31,1],[32,3],[32,3],[32,3],[32,3],[21,1],[35,3],[35,1]],performAction:function b(h,l,m,p,o,k,n){var j=k.length-1;switch(o){case 1:return k[j-1];break;case 2:this.$=new p.ProgramNode(k[j-2],k[j]);break;case 3:this.$=new p.ProgramNode(k[j]);break;case 4:this.$=new p.ProgramNode([]);break;case 5:this.$=[k[j]];break;case 6:k[j-1].push(k[j]);this.$=k[j-1];break;case 7:this.$=new p.InverseNode(k[j-2],k[j-1],k[j]);break;case 8:this.$=new p.BlockNode(k[j-2],k[j-1],k[j]);break;case 9:this.$=k[j];break;case 10:this.$=k[j];break;case 11:this.$=new p.ContentNode(k[j]);break;case 12:this.$=new p.CommentNode(k[j]);break;case 13:this.$=new p.MustacheNode(k[j-1][0],k[j-1][1]);break;case 14:this.$=new p.MustacheNode(k[j-1][0],k[j-1][1]);break;case 15:this.$=k[j-1];break;case 16:this.$=new p.MustacheNode(k[j-1][0],k[j-1][1]);break;case 17:this.$=new p.MustacheNode(k[j-1][0],k[j-1][1],true);break;case 18:this.$=new p.PartialNode(k[j-1]);break;case 19:this.$=new p.PartialNode(k[j-2],k[j-1]);break;case 20:break;case 21:this.$=[[k[j-2]].concat(k[j-1]),k[j]];break;case 22:this.$=[[k[j-1]].concat(k[j]),null];break;case 23:this.$=[[k[j-1]],k[j]];break;case 24:this.$=[[k[j]],null];break;case 25:k[j-1].push(k[j]);this.$=k[j-1];break;case 26:this.$=[k[j]];break;case 27:this.$=k[j];break;case 28:this.$=new p.StringNode(k[j]);break;case 29:this.$=new p.IntegerNode(k[j]);break;case 30:this.$=new p.BooleanNode(k[j]);break;case 31:this.$=new p.HashNode(k[j]);break;case 32:k[j-1].push(k[j]);this.$=k[j-1];break;case 33:this.$=[k[j]];break;case 34:this.$=[k[j-2],k[j]];break;case 35:this.$=[k[j-2],new p.StringNode(k[j])];break;case 36:this.$=[k[j-2],new p.IntegerNode(k[j])];break;case 37:this.$=[k[j-2],new p.BooleanNode(k[j])];break;case 38:this.$=new p.IdNode(k[j]);break;case 39:k[j-2].push(k[j]);this.$=k[j-2];break;case 40:this.$=[k[j]];break}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,33:[1,25],35:24},{17:26,21:23,33:[1,25],35:24},{17:27,21:23,33:[1,25],35:24},{17:28,21:23,33:[1,25],35:24},{21:29,33:[1,25],35:24},{1:[2,1]},{6:30,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,31],21:23,33:[1,25],35:24},{10:32,20:[1,33]},{10:34,20:[1,33]},{18:[1,35]},{18:[2,24],21:40,25:36,26:37,27:38,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,38],28:[2,38],29:[2,38],30:[2,38],33:[2,38],36:[1,46]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],36:[2,40]},{18:[1,47]},{18:[1,48]},{18:[1,49]},{18:[1,50],21:51,33:[1,25],35:24},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:52,33:[1,25],35:24},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:40,26:53,27:54,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,23]},{18:[2,26],28:[2,26],29:[2,26],30:[2,26],33:[2,26]},{18:[2,31],32:55,33:[1,56]},{18:[2,27],28:[2,27],29:[2,27],30:[2,27],33:[2,27]},{18:[2,28],28:[2,28],29:[2,28],30:[2,28],33:[2,28]},{18:[2,29],28:[2,29],29:[2,29],30:[2,29],33:[2,29]},{18:[2,30],28:[2,30],29:[2,30],30:[2,30],33:[2,30]},{18:[2,33],33:[2,33]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],34:[1,57],36:[2,40]},{33:[1,58]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,59]},{18:[1,60]},{18:[2,21]},{18:[2,25],28:[2,25],29:[2,25],30:[2,25],33:[2,25]},{18:[2,32],33:[2,32]},{34:[1,57]},{21:61,28:[1,62],29:[1,63],30:[1,64],33:[1,25],35:24},{18:[2,39],28:[2,39],29:[2,39],30:[2,39],33:[2,39],36:[2,39]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,34],33:[2,34]},{18:[2,35],33:[2,35]},{18:[2,36],33:[2,36]},{18:[2,37],33:[2,37]}],defaultActions:{16:[2,1],37:[2,23],53:[2,21]},parseError:function e(j,h){throw new Error(j)},parse:function f(s){var z=this,n=[0],I=[null],u=[],J=this.table,j="",t=0,G=0,l=0,q=2,w=1;this.lexer.setInput(s);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;if(typeof this.lexer.yylloc=="undefined"){this.lexer.yylloc={}}var k=this.lexer.yylloc;u.push(k);if(typeof this.yy.parseError==="function"){this.parseError=this.yy.parseError}function y(p){n.length=n.length-2*p;I.length=I.length-p;u.length=u.length-p}function x(){var p;p=z.lexer.lex()||1;if(typeof p!=="number"){p=z.symbols_[p]||p}return p}var F,B,m,E,K,v,D={},A,H,h,o;while(true){m=n[n.length-1];if(this.defaultActions[m]){E=this.defaultActions[m]}else{if(F==null){F=x()}E=J[m]&&J[m][F]}if(typeof E==="undefined"||!E.length||!E[0]){if(!l){o=[];for(A in J[m]){if(this.terminals_[A]&&A>2){o.push("'"+this.terminals_[A]+"'")}}var C="";if(this.lexer.showPosition){C="Parse error on line "+(t+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+o.join(", ")}else{C="Parse error on line "+(t+1)+": Unexpected "+(F==1?"end of input":("'"+(this.terminals_[F]||F)+"'"))}this.parseError(C,{text:this.lexer.match,token:this.terminals_[F]||F,line:this.lexer.yylineno,loc:k,expected:o})}if(l==3){if(F==w){throw new Error(C||"Parsing halted.")}G=this.lexer.yyleng;j=this.lexer.yytext;t=this.lexer.yylineno;k=this.lexer.yylloc;F=x()}while(1){if((q.toString()) in J[m]){break}if(m==0){throw new Error(C||"Parsing halted.")}y(1);m=n[n.length-1]}B=F;F=q;m=n[n.length-1];E=J[m]&&J[m][q];l=3}if(E[0] instanceof Array&&E.length>1){throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+F)}switch(E[0]){case 1:n.push(F);I.push(this.lexer.yytext);u.push(this.lexer.yylloc);n.push(E[1]);F=null;if(!B){G=this.lexer.yyleng;j=this.lexer.yytext;t=this.lexer.yylineno;k=this.lexer.yylloc;if(l>0){l--}}else{F=B;B=null}break;case 2:H=this.productions_[E[1]][1];D.$=I[I.length-H];D._$={first_line:u[u.length-(H||1)].first_line,last_line:u[u.length-1].last_line,first_column:u[u.length-(H||1)].first_column,last_column:u[u.length-1].last_column};v=this.performAction.call(D,j,G,t,this.yy,E[1],I,u);if(typeof v!=="undefined"){return v}if(H){n=n.slice(0,-1*H*2);I=I.slice(0,-1*H);u=u.slice(0,-1*H)}n.push(this.productions_[E[1]][0]);I.push(D.$);u.push(D._$);h=J[n[n.length-2]][n[n.length-1]];n.push(h);break;case 3:return true}}return true}};var a=(function(){var l=({EOF:1,parseError:function n(q,p){if(this.yy.parseError){this.yy.parseError(q,p)}else{throw new Error(q)}},setInput:function(p){this._input=p;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};return this},input:function(){var q=this._input[0];this.yytext+=q;this.yyleng++;this.match+=q;this.matched+=q;var p=q.match(/\n/);if(p){this.yylineno++}this._input=this._input.slice(1);return q},unput:function(p){this._input=p+this._input;return this},more:function(){this._more=true;return this},pastInput:function(){var p=this.matched.substr(0,this.matched.length-this.match.length);return(p.length>20?"...":"")+p.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var p=this.match;if(p.length<20){p+=this._input.substr(0,20-p.length)}return(p.substr(0,20)+(p.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var p=this.pastInput();var q=new Array(p.length+1).join("-");return p+this.upcomingInput()+"\n"+q+"^"},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var u,s,q,p;if(!this._more){this.yytext="";this.match=""}var v=this._currentRules();for(var t=0;t<v.length;t++){s=this._input.match(this.rules[v[t]]);if(s){p=s[0].match(/\n.*/g);if(p){this.yylineno+=p.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:p?p[p.length-1].length-1:this.yylloc.last_column+s[0].length};this.yytext+=s[0];this.match+=s[0];this.matches=s;this.yyleng=this.yytext.length;this._more=false;this._input=this._input.slice(s[0].length);this.matched+=s[0];u=this.performAction.call(this,this.yy,this,v[t],this.conditionStack[this.conditionStack.length-1]);if(u){return u}else{return}}}if(this._input===""){return this.EOF}else{this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function h(){var p=this.next();if(typeof p!=="undefined"){return p}else{return this.lex()}},begin:function j(p){this.conditionStack.push(p)},popState:function o(){return this.conditionStack.pop()},_currentRules:function m(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}});l.performAction=function k(u,q,t,p){var s=p;switch(t){case 0:this.begin("mu");if(q.yytext){return 14}break;case 1:return 14;break;case 2:return 24;break;case 3:return 16;break;case 4:return 20;break;case 5:return 19;break;case 6:return 19;break;case 7:return 23;break;case 8:return 23;break;case 9:q.yytext=q.yytext.substr(3,q.yyleng-5);this.begin("INITIAL");return 15;break;case 10:return 22;break;case 11:return 34;break;case 12:return 33;break;case 13:return 33;break;case 14:return 36;break;case 15:break;case 16:this.begin("INITIAL");return 18;break;case 17:this.begin("INITIAL");return 18;break;case 18:q.yytext=q.yytext.substr(1,q.yyleng-2).replace(/\\"/g,'"');return 28;break;case 19:return 30;break;case 20:return 30;break;case 21:return 29;break;case 22:return 33;break;case 23:q.yytext=q.yytext.substr(1,q.yyleng-2);return 33;break;case 24:return"INVALID";break;case 25:return 5;break}};l.rules=[/^[^\x00]*?(?=(\{\{))/,/^[^\x00]+/,/^\{\{>/,/^\{\{#/,/^\{\{\//,/^\{\{\^/,/^\{\{\s*else\b/,/^\{\{\{/,/^\{\{&/,/^\{\{![\s\S]*?\}\}/,/^\{\{/,/^=/,/^\.(?=[} ])/,/^\.\./,/^[/.]/,/^\s+/,/^\}\}\}/,/^\}\}/,/^"(\\["]|[^"])*"/,/^true(?=[}\s])/,/^false(?=[}\s])/,/^[0-9]+(?=[}\s])/,/^[a-zA-Z0-9_$-]+(?=[=}\s/.])/,/^\[.*\]/,/^./,/^$/];l.conditions={mu:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:false},INITIAL:{rules:[0,1,25],inclusive:true}};return l})();g.lexer=a;return g})();Handlebars.Parser=handlebars;Handlebars.parse=function(a){Handlebars.Parser.yy=Handlebars.AST;return Handlebars.Parser.parse(a)};Handlebars.print=function(a){return new Handlebars.PrintVisitor().accept(a)};Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(b,a){}};Handlebars.log=function(b,a){Handlebars.logger.log(b,a)};(function(){Handlebars.AST={};Handlebars.AST.ProgramNode=function(d,b){this.type="program";this.statements=d;if(b){this.inverse=new Handlebars.AST.ProgramNode(b)}};Handlebars.AST.MustacheNode=function(e,d,b){this.type="mustache";this.id=e[0];this.params=e.slice(1);this.hash=d;this.escaped=!b};Handlebars.AST.PartialNode=function(d,b){this.type="partial";this.id=d;this.context=b};var a=function(b,d){if(b.original!==d.original){throw new Handlebars.Exception(b.original+" doesn't match "+d.original)}};Handlebars.AST.BlockNode=function(d,b,e){a(d.id,e);this.type="block";this.mustache=d;this.program=b};Handlebars.AST.InverseNode=function(d,b,e){a(d.id,e);this.type="inverse";this.mustache=d;this.program=b};Handlebars.AST.ContentNode=function(b){this.type="content";this.string=b};Handlebars.AST.HashNode=function(b){this.type="hash";this.pairs=b};Handlebars.AST.IdNode=function(g){this.type="ID";this.original=g.join(".");var e=[],h=0;for(var f=0,b=g.length;f<b;f++){var d=g[f];if(d===".."){h++}else{if(d==="."||d==="this"){this.isScoped=true}else{e.push(d)}}}this.parts=e;this.string=e.join(".");this.depth=h;this.isSimple=(e.length===1)&&(h===0)};Handlebars.AST.StringNode=function(b){this.type="STRING";this.string=b};Handlebars.AST.IntegerNode=function(b){this.type="INTEGER";this.integer=b};Handlebars.AST.BooleanNode=function(b){this.type="BOOLEAN";this.bool=b};Handlebars.AST.CommentNode=function(b){this.type="comment";this.comment=b}})();Handlebars.Exception=function(b){var a=Error.prototype.constructor.apply(this,arguments);for(var d in a){if(a.hasOwnProperty(d)){this[d]=a[d]}}};Handlebars.Exception.prototype=new Error;Handlebars.SafeString=function(a){this.string=a};Handlebars.SafeString.prototype.toString=function(){return this.string.toString()};(function(){var d={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var e=/&(?!\w+;)|[<>"'`]/g;var b=/[&<>"'`]/;var a=function(f){return d[f]||"&amp;"};Handlebars.Utils={escapeExpression:function(f){if(f instanceof Handlebars.SafeString){return f.toString()}else{if(f==null||f===false){return""}}if(!b.test(f)){return f}return f.replace(e,a)},isEmpty:function(f){if(typeof f==="undefined"){return true}else{if(f===null){return true}else{if(f===false){return true}else{if(Object.prototype.toString.call(f)==="[object Array]"&&f.length===0){return true}else{return false}}}}}}})();Handlebars.Compiler=function(){};Handlebars.JavaScriptCompiler=function(){};(function(g,f){g.OPCODE_MAP={appendContent:1,getContext:2,lookupWithHelpers:3,lookup:4,append:5,invokeMustache:6,appendEscaped:7,pushString:8,truthyOrFallback:9,functionOrFallback:10,invokeProgram:11,invokePartial:12,push:13,assignToHash:15,pushStringParam:16};g.MULTI_PARAM_OPCODES={appendContent:1,getContext:1,lookupWithHelpers:2,lookup:1,invokeMustache:3,pushString:1,truthyOrFallback:1,functionOrFallback:1,invokeProgram:3,invokePartial:1,push:1,assignToHash:1,pushStringParam:1};g.DISASSEMBLE_MAP={};for(var j in g.OPCODE_MAP){var h=g.OPCODE_MAP[j];g.DISASSEMBLE_MAP[h]=j}g.multiParamSize=function(k){return g.MULTI_PARAM_OPCODES[g.DISASSEMBLE_MAP[k]]};g.prototype={compiler:g,disassemble:function(){var u=this.opcodes,s,n;var q=[],w,m,x;for(var t=0,o=u.length;t<o;t++){s=u[t];if(s==="DECLARE"){m=u[++t];x=u[++t];q.push("DECLARE "+m+" = "+x)}else{w=g.DISASSEMBLE_MAP[s];var v=g.multiParamSize(s);var k=[];for(var p=0;p<v;p++){n=u[++t];if(typeof n==="string"){n='"'+n.replace("\n","\\n")+'"'}k.push(n)}w=w+" "+k.join(" ");q.push(w)}}return q.join("\n")},guid:0,compile:function(k,m){this.children=[];this.depths={list:[]};this.options=m;var n=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true};if(n){for(var l in n){this.options.knownHelpers[l]=n[l]}}return this.program(k)},accept:function(k){return this[k.type](k)},program:function(n){var m=n.statements,p;this.opcodes=[];for(var o=0,k=m.length;o<k;o++){p=m[o];this[p.type](p)}this.isSimple=k===1;this.depths.list=this.depths.list.sort(function(q,l){return q-l});return this},compileProgram:function(n){var k=new this.compiler().compile(n,this.options);var o=this.guid++;this.usePartial=this.usePartial||k.usePartial;this.children[o]=k;for(var p=0,m=k.depths.list.length;p<m;p++){depth=k.depths.list[p];if(depth<2){continue}else{this.addDepth(depth-1)}}return o},block:function(q){var n=q.mustache;var p,s,l,m;var o=this.setupStackForMustache(n);var k=this.compileProgram(q.program);if(q.program.inverse){m=this.compileProgram(q.program.inverse);this.declare("inverse",m)}this.opcode("invokeProgram",k,o.length,!!n.hash);this.declare("inverse",null);this.opcode("append")},inverse:function(m){var l=this.setupStackForMustache(m.mustache);var k=this.compileProgram(m.program);this.declare("inverse",k);this.opcode("invokeProgram",null,l.length,!!m.mustache.hash);this.opcode("append")},hash:function(o){var n=o.pairs,q,p;this.opcode("push","{}");for(var m=0,k=n.length;m<k;m++){q=n[m];p=q[1];this.accept(p);this.opcode("assignToHash",q[0])}},partial:function(k){var l=k.id;this.usePartial=true;if(k.context){this.ID(k.context)}else{this.opcode("push","depth0")}this.opcode("invokePartial",l.original);this.opcode("append")},content:function(k){this.opcode("appendContent",k.string)},mustache:function(k){var l=this.setupStackForMustache(k);this.opcode("invokeMustache",l.length,k.id.original,!!k.hash);if(k.escaped){this.opcode("appendEscaped")}else{this.opcode("append")}},ID:function(n){this.addDepth(n.depth);this.opcode("getContext",n.depth);this.opcode("lookupWithHelpers",n.parts[0]||null,n.isScoped||false);for(var m=1,k=n.parts.length;m<k;m++){this.opcode("lookup",n.parts[m])}},STRING:function(k){this.opcode("pushString",k.string)},INTEGER:function(k){this.opcode("push",k.integer)},BOOLEAN:function(k){this.opcode("push",k.bool)},comment:function(){},pushParams:function(m){var k=m.length,l;while(k--){l=m[k];if(this.options.stringParams){if(l.depth){this.addDepth(l.depth)}this.opcode("getContext",l.depth||0);this.opcode("pushStringParam",l.string)}else{this[l.type](l)}}},opcode:function(k,n,m,l){this.opcodes.push(g.OPCODE_MAP[k]);if(n!==undefined){this.opcodes.push(n)}if(m!==undefined){this.opcodes.push(m)}if(l!==undefined){this.opcodes.push(l)}},declare:function(k,l){this.opcodes.push("DECLARE");this.opcodes.push(k);this.opcodes.push(l)},addDepth:function(k){if(k===0){return}if(!this.depths[k]){this.depths[k]=true;this.depths.list.push(k)}},setupStackForMustache:function(k){var l=k.params;this.pushParams(l);if(k.hash){this.hash(k.hash)}this.ID(k.id);return l}};f.prototype={nameLookup:function(m,k,l){if(/^[0-9]+$/.test(k)){return m+"["+k+"]"}else{if(f.isValidJavaScriptVariableName(k)){return m+"."+k}else{return m+"['"+k+"']"}}},appendToBuffer:function(k){if(this.environment.isSimple){return"return "+k+";"}else{return"buffer += "+k+";"}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(k,l,n,m){this.environment=k;this.options=l||{};this.name=this.environment.name;this.isChild=!!n;this.context=n||{programs:[],aliases:{self:"this"},registers:{list:[]}};this.preamble();this.stackSlot=0;this.stackVars=[];this.compileChildren(k,l);var p=k.opcodes,o;this.i=0;for(b=p.length;this.i<b;this.i++){o=this.nextOpcode(0);if(o[0]==="DECLARE"){this.i=this.i+2;this[o[1]]=o[2]}else{this.i=this.i+o[1].length;this[o[0]].apply(this,o[1])}}return this.createFunctionContext(m)},nextOpcode:function(t){var p=this.environment.opcodes,o=p[this.i+t],m,q;var s,k;if(o==="DECLARE"){m=p[this.i+1];q=p[this.i+2];return["DECLARE",m,q]}else{m=g.DISASSEMBLE_MAP[o];s=g.multiParamSize(o);k=[];for(var l=0;l<s;l++){k.push(p[this.i+l+1+t])}return[m,k]}},eat:function(k){this.i=this.i+k.length},preamble:function(){var k=[];if(!this.isChild){var l=this.namespace;var m="helpers = helpers || "+l+".helpers;";if(this.environment.usePartial){m=m+" partials = partials || "+l+".partials;"}k.push(m)}else{k.push("")}if(!this.environment.isSimple){k.push(", buffer = "+this.initializeBuffer())}else{k.push("")}this.lastContext=0;this.source=k},createFunctionContext:function(q){var s=this.stackVars;if(!this.isChild){s=s.concat(this.context.registers.list)}if(s.length>0){this.source[1]=this.source[1]+", "+s.join(", ")}if(!this.isChild){var m=[];for(var p in this.context.aliases){this.source[1]=this.source[1]+", "+p+"="+this.context.aliases[p]}}if(this.source[1]){this.source[1]="var "+this.source[1].substring(2)+";"}if(!this.isChild){this.source[1]+="\n"+this.context.programs.join("\n")+"\n"}if(!this.environment.isSimple){this.source.push("return buffer;")}var t=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var o=0,k=this.environment.depths.list.length;o<k;o++){t.push("depth"+this.environment.depths.list[o])}if(q){t.push(this.source.join("\n  "));return Function.apply(this,t)}else{var n="function "+(this.name||"")+"("+t.join(",")+") {\n  "+this.source.join("\n  ")+"}";Handlebars.log(Handlebars.logger.DEBUG,n+"\n\n");return n}},appendContent:function(k){this.source.push(this.appendToBuffer(this.quotedString(k)))},append:function(){var k=this.popStack();this.source.push("if("+k+" || "+k+" === 0) { "+this.appendToBuffer(k)+" }");if(this.environment.isSimple){this.source.push("else { "+this.appendToBuffer("''")+" }")}},appendEscaped:function(){var l=this.nextOpcode(1),k="";this.context.aliases.escapeExpression="this.escapeExpression";if(l[0]==="appendContent"){k=" + "+this.quotedString(l[1][0]);this.eat(l)}this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+k))},getContext:function(k){if(this.lastContext!==k){this.lastContext=k}},lookupWithHelpers:function(m,n){if(m){var k=this.nextStack();this.usingKnownHelper=false;var l;if(!n&&this.options.knownHelpers[m]){l=k+" = "+this.nameLookup("helpers",m,"helper");this.usingKnownHelper=true}else{if(n||this.options.knownHelpersOnly){l=k+" = "+this.nameLookup("depth"+this.lastContext,m,"context")}else{l=k+" = "+this.nameLookup("helpers",m,"helper")+" || "+this.nameLookup("depth"+this.lastContext,m,"context")}}l+=";";this.source.push(l)}else{this.pushStack("depth"+this.lastContext)}},lookup:function(l){var k=this.topStack();this.source.push(k+" = ("+k+" === null || "+k+" === undefined || "+k+" === false ? "+k+" : "+this.nameLookup(k,l,"context")+");")},pushStringParam:function(k){this.pushStack("depth"+this.lastContext);this.pushString(k)},pushString:function(k){this.pushStack(this.quotedString(k))},push:function(k){this.pushStack(k)},invokeMustache:function(m,l,k){this.populateParams(m,this.quotedString(l),"{}",null,k,function(n,p,o){if(!this.usingKnownHelper){this.context.aliases.helperMissing="helpers.helperMissing";this.context.aliases.undef="void 0";this.source.push("else if("+o+"=== undef) { "+n+" = helperMissing.call("+p+"); }");if(n!==o){this.source.push("else { "+n+" = "+o+"; }")}}})},invokeProgram:function(m,n,l){var k=this.programExpression(this.inverse);var o=this.programExpression(m);this.populateParams(n,null,o,k,l,function(p,s,q){if(!this.usingKnownHelper){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";this.source.push("else { "+p+" = blockHelperMissing.call("+s+"); }")}})},populateParams:function(q,l,v,s,z,y){var m=z||this.options.stringParams||s||this.options.data;var k=this.popStack(),x;var o=[],n,p,w;if(m){this.register("tmp1",v);w="tmp1"}else{w="{ hash: {} }"}if(m){var u=(z?this.popStack():"{}");this.source.push("tmp1.hash = "+u+";")}if(this.options.stringParams){this.source.push("tmp1.contexts = [];")}for(var t=0;t<q;t++){n=this.popStack();o.push(n);if(this.options.stringParams){this.source.push("tmp1.contexts.push("+this.popStack()+");")}}if(s){this.source.push("tmp1.fn = tmp1;");this.source.push("tmp1.inverse = "+s+";")}if(this.options.data){this.source.push("tmp1.data = data;")}o.push(w);this.populateCall(o,k,l||k,y)},populateCall:function(n,q,p,k){var m=["depth0"].concat(n).join(", ");var o=["depth0"].concat(p).concat(n).join(", ");var l=this.nextStack();if(this.usingKnownHelper){this.source.push(l+" = "+q+".call("+m+");")}else{this.context.aliases.functionType='"function"';this.source.push("if(typeof "+q+" === functionType) { "+l+" = "+q+".call("+m+"); }")}k.call(this,l,o,q);this.usingKnownHelper=false},invokePartial:function(k){this.pushStack("self.invokePartial("+this.nameLookup("partials",k,"partial")+", '"+k+"', "+this.popStack()+", helpers, partials);")},assignToHash:function(k){var l=this.popStack();var m=this.topStack();this.source.push(m+"['"+k+"'] = "+l+";")},compiler:f,compileChildren:function(k,o){var q=k.children,t,s;for(var p=0,m=q.length;p<m;p++){t=q[p];s=new this.compiler();this.context.programs.push("");var n=this.context.programs.length;t.index=n;t.name="program"+n;this.context.programs[n]=s.compile(t,o,this.context)}},programExpression:function(m){if(m==null){return"self.noop"}var q=this.environment.children[m],p=q.depths.list;var o=[q.index,q.name,"data"];for(var n=0,k=p.length;n<k;n++){depth=p[n];if(depth===1){o.push("depth0")}else{o.push("depth"+(depth-1))}}if(p.length===0){return"self.program("+o.join(", ")+")"}else{o.shift();return"self.programWithDepth("+o.join(", ")+")"}},register:function(k,l){this.useRegister(k);this.source.push(k+" = "+l+";")},useRegister:function(k){if(!this.context.registers[k]){this.context.registers[k]=true;this.context.registers.list.push(k)}},pushStack:function(k){this.source.push(this.nextStack()+" = "+k+";");return"stack"+this.stackSlot},nextStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return"stack"+this.stackSlot},popStack:function(){return"stack"+this.stackSlot--},topStack:function(){return"stack"+this.stackSlot},quotedString:function(k){return'"'+k.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'}};var a=("break case catch continue default delete do else finally for function if in instanceof new return switch this throw try typeof var void while with null true false").split(" ");var e=f.RESERVED_WORDS={};for(var d=0,b=a.length;d<b;d++){e[a[d]]=true}f.isValidJavaScriptVariableName=function(k){if(!f.RESERVED_WORDS[k]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(k)){return true}return false}})(Handlebars.Compiler,Handlebars.JavaScriptCompiler);Handlebars.precompile=function(e,d){d=d||{};var b=Handlebars.parse(e);var a=new Handlebars.Compiler().compile(b,d);return new Handlebars.JavaScriptCompiler().compile(a,d)};Handlebars.compile=function(b,a){a=a||{};var e;function d(){var h=Handlebars.parse(b);var g=new Handlebars.Compiler().compile(h,a);var f=new Handlebars.JavaScriptCompiler().compile(g,a,undefined,true);return Handlebars.template(f)}return function(g,f){if(!e){e=d()}return e.call(this,g,f)}};Handlebars.VM={template:function(a){var b={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(e,f,g){var d=this.programs[e];if(g){return Handlebars.VM.program(f,g)}else{if(d){return d}else{d=this.programs[e]=Handlebars.VM.program(f);return d}}},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(e,d){d=d||{};return a.call(b,Handlebars,e,d.helpers,d.partials,d.data)}},programWithDepth:function(b,e,d){var a=Array.prototype.slice.call(arguments,2);return function(g,f){f=f||{};return b.apply(this,[g,f.data||e].concat(a))}},program:function(a,b){return function(e,d){d=d||{};return a(e,d.data||b)}},noop:function(){return""},invokePartial:function(a,b,e,f,d){if(a===undefined){throw new Handlebars.Exception("The partial "+b+" could not be found")}else{if(a instanceof Function){return a(e,{helpers:f,partials:d})}else{if(!Handlebars.compile){throw new Handlebars.Exception("The partial "+b+" could not be compiled when running in vm mode")}else{d[b]=Handlebars.compile(a);return d[b](e,{helpers:f,partials:d})}}}}};Handlebars.template=Handlebars.VM.template;sc_require("handlebars");SC.Handlebars={};SC.Handlebars.Compiler=function(){};SC.Handlebars.Compiler.prototype=SC.beget(Handlebars.Compiler.prototype);SC.Handlebars.Compiler.prototype.compiler=SC.Handlebars.Compiler;SC.Handlebars.JavaScriptCompiler=function(){};SC.Handlebars.JavaScriptCompiler.prototype=SC.beget(Handlebars.JavaScriptCompiler.prototype);SC.Handlebars.JavaScriptCompiler.prototype.compiler=SC.Handlebars.JavaScriptCompiler;SC.Handlebars.JavaScriptCompiler.prototype.nameLookup=function(d,a,b){if(b==="context"){return"SC.get("+d+", "+this.quotedString(a)+")"}else{return Handlebars.JavaScriptCompiler.prototype.nameLookup.call(this,d,a,b)}};SC.Handlebars.Compiler.prototype.mustache=function(a){if(a.params.length||a.hash){return Handlebars.Compiler.prototype.mustache.call(this,a)}else{var b=new Handlebars.AST.IdNode(["bind"]);if(a.escaped){a.hash=a.hash||new Handlebars.AST.HashNode([]);a.hash.pairs.push(["escaped",new Handlebars.AST.StringNode("true")])}a=new Handlebars.AST.MustacheNode([b].concat([a.id]),a.hash,!a.escaped);return Handlebars.Compiler.prototype.mustache.call(this,a)}};SC.Handlebars.compile=function(f){var d=Handlebars.parse(f);var e={data:true,stringParams:true};var b=new SC.Handlebars.Compiler().compile(d,e);var a=new SC.Handlebars.JavaScriptCompiler().compile(b,e,undefined,true);return Handlebars.template(a)};Handlebars.registerHelper("helperMissing",function(d,b){var a;a="%@ Handlebars error: Could not find property '%@' on object %@.";throw a.fmt(b.data.view,d,this)});sc_require("ext/handlebars");(function(){var a=function(n,o,k,b){var f=o.data,l=o.fn,e=o.inverse,m=f.view;if(this.isObservable){var g=m.createChildView(SC._BindableSpan,{preserveContext:k,shouldDisplayFunc:b,displayTemplate:l,inverseTemplate:e,property:n,previousContext:this,tagName:(o.hash.tagName||"span"),isEscaped:o.hash.escaped});var j,h;m.get("childViews").push(g);j=function(){if(g.get("layer")){g.rerender()}else{this.removeObserver(n,h)}};h=function(){this.invokeOnce(j)};this.addObserver(n,h);var d=g.renderContext(g.get("tagName"));g.renderToContext(d);return new Handlebars.SafeString(d.join())}else{return SC.getPath(this,n)}};Handlebars.registerHelper("bind",function(d,b){return a.call(this,d,b,false,function(e){return !SC.none(e)})});Handlebars.registerHelper("boundIf",function(d,b){if(b){return a.call(this,d,b,true,function(e){if(SC.typeOf(e)===SC.T_ARRAY){if(e.length!==0){return true}return false}else{return !!e}})}else{throw"Cannot use boundIf helper without a block."}})})();Handlebars.registerHelper("with",function(b,a){return Handlebars.helpers.bind.call(a.contexts[0],b,a)});Handlebars.registerHelper("if",function(b,a){return Handlebars.helpers.boundIf.call(a.contexts[0],b,a)});Handlebars.registerHelper("unless",function(d,b){var e=b.fn,a=b.inverse;b.fn=a;b.inverse=e;return Handlebars.helpers.boundIf.call(b.contexts[0],d,b)});Handlebars.registerHelper("bindAttr",function(g){var f=g.hash;var b=g.data.view;var e=[];var d=jQuery.uuid++;var j=f["class"];if(j!=null){var a=SC.Handlebars.bindClasses(this,j,b,d);e.push('class="'+a.join(" ")+'"');delete f["class"]}var h=SC.keys(f);h.forEach(function(k){var o=f[k];var n=this.getPath(o);var m,l;m=function m(){var p=this.getPath(o);var s=b.$("[data-handlebars-id='"+d+"']");if(s.length===0){this.removeObserver(o,l);return}var q=s.attr(k);if(p===NO&&q){s.removeAttr(k)}else{if(p===YES&&q!==k){s.attr(k,k)}else{if(q!==p){s.attr(k,p)}}}};l=function(){this.invokeOnce(m)};this.addObserver(o,l);if(n===YES){n=k}if(n!==NO){if(SC.typeOf(n)===SC.T_STRING){n=n.replace(/"/g,"&quot;")}e.push(k+'="'+n+'"')}},this);e.push('data-handlebars-id="'+d+'"');return new Handlebars.SafeString(e.join(" "))});SC.Handlebars.bindClasses=function(b,j,h,a){var g=[],f,k,d;var e=function(l){var m=b.getPath(l);if(m===YES){return SC.String.dasherize(l.split(".").get("lastObject"))}else{if(m!==NO&&m!==undefined&&m!==null){return m}else{return null}}};j.split(" ").forEach(function(o){var n;var m,l;m=function(){f=e(o);d=a?h.$("[data-handlebars-id='"+a+"']"):h.$();if(d.length===0){b.removeObserver(o,l)}else{if(n){d.removeClass(n)}if(f){d.addClass(f);n=f}else{n=null}}};l=function(){this.invokeOnce(m)};b.addObserver(o,l);k=e(o);if(k){g.push(k);n=k}});return g};sc_require("ext/handlebars");Handlebars.registerHelper("collection",function(m,n){var l=n.fn;var g=n.data;var e=n.inverse;var f=n.hash;var h,a;h=m?SC.getPath(this,m)||SC.getPath(m):SC.TemplateCollectionView;var k={};if(f){var d={},j;for(var b in f){if(f.hasOwnProperty(b)){j=b.match(/^item(.)(.*)$/);if(j){d[j[1].toLowerCase()+j[2]]=f[b];delete f[b]}}}k=SC.clone(f);k.itemViewOptions=d}if(l){k.itemViewTemplate=l}if(e){k.inverseTemplate=e}if(h.isClass){a=h.extend(k)}else{a=SC.mixin(h,k)}n.fn=function(){return""};return Handlebars.helpers.view.call(this,a,n)});Handlebars.registerHelper("each",function(b,a){a.hash.contentBinding=SC.Binding.from("*"+b,this).oneWay();a.hash.itemContextProperty="content";return Handlebars.helpers.collection.call(this,null,a)});sc_require("ext/handlebars");Handlebars.registerHelper("loc",function(a){return SC.String.loc(a)});sc_require("ext/handlebars");SC.Handlebars.ViewHelper=SC.Object.create({helper:function(n,o,p){var d=p.inverse;var f=p.data;var l=f.view;var k=p.fn;var e=p.hash;var b;if(o.isClass||o.isObject){b=o;if(!b){throw"Null or undefined object was passed to the #view helper. Did you mean to pass a property path string?"}}else{if(o.charAt(0)==="."){b=SC.objectForPropertyPath(o.slice(1),l)}else{b=SC.getPath(n,o);if(!b){b=SC.getPath(o)}}if(!b){throw"Unable to find view at path '"+o+"'"}}if(e.id){e.layerId=e.id}var m={id:e.id,"class":e["class"],classBinding:e.classBinding};delete e.id;delete e["class"];delete e.classBinding;if(b.isClass){b=b.extend(e)}else{SC.mixin(b,e)}var h=f.view;var j=h.get("childViews");var g=h.createChildView(b);if(k){g.template=k}j.pushObject(g);var a=SC.RenderContext(g.get("tagName"));this.applyAttributes(m,g,a);g.applyAttributesToContext(a);g.render(a,YES);return new Handlebars.SafeString(a.join())},applyAttributes:function(a,g,b){var f=a.id;var e=a["class"];if(e){b.addClass(e.split(" "))}if(f){g.set("layerId",f);b.id(f)}var d=a.classBinding;if(d){SC.Handlebars.bindClasses(g,d,g).forEach(function(h){b.setClass(h,YES)})}}});Handlebars.registerHelper("view",function(b,a){return SC.Handlebars.ViewHelper.helper(this,b,a)});sc_require("handlebars");sc_require("ext/handlebars");sc_require("ext/handlebars/bind");sc_require("ext/handlebars/collection");sc_require("ext/handlebars/localization");sc_require("ext/handlebars/view");SC.TEMPLATES=SC.Object.create();SC.TemplateView=SC.CoreView.extend({acceptsFirstResponder:YES,templateName:null,templates:SC.TEMPLATES,template:function(b,e){if(e!==undefined){return e}var a=this.get("templateName"),d=this.get("templates").get(a);if(!d){return function(){return""}}return d}.property("templateName").cacheable(),context:function(a,b){if(b!==undefined){return b}return this}.property().cacheable(),render:function(b){var f,a,d=this.get("template"),e=this.get("context");this._didRenderChildViews=YES;f={view:this,isRenderData:true};a=d(e,{data:f});b.push(a)},update:function(){},mouseDown:function(){if(this.mouseUp){return YES}return NO}});sc_require("views/template");SC.Button=SC.TemplateView.extend(SC.ActionSupport,{classNames:["sc-button"],mouseDown:function(){this.set("isActive",true);this._isMouseDown=YES},mouseExited:function(){this.set("isActive",false)},mouseEntered:function(){if(this._isMouseDown){this.set("isActive",true)}},rootResponder:function(){var a=this.get("pane");return a.get("rootResponder")}.property("pane").cacheable(),mouseUp:function(a){if(this.get("isActive")){this.fireAction();this.set("isActive",false)}this._isMouseDown=NO},touchStart:function(a){this.mouseDown(a)},touchEnd:function(a){this.mouseUp(a)}});sc_require("views/template");SC.Checkbox=SC.TemplateView.extend({title:null,value:null,displayTitle:function(){var a=this.get("title");return a?SC.String.loc(a):null}.property("title").cacheable(),classNames:["sc-checkbox"],template:SC.Handlebars.compile('<label><input type="checkbox">{{displayTitle}}</label>'),didCreateLayer:function(){var a=this;this.$("input").bind("change",function(){a.domValueDidChange(this)})},domValueDidChange:function(a){this.set("value",$(a).prop("checked"))},value:function(a,b){if(b!==undefined){this.$("input").prop("checked",b)}else{b=this.$("input").prop("checked")}return b}.property()});SC.CheckboxSupport={didCreateLayer:function(){this.$("input").change(jQuery.proxy(function(){SC.RunLoop.begin();this.notifyPropertyChange("value");SC.RunLoop.end()},this))},value:function(a,b){if(b!==undefined){this.$("input").prop("checked",b)}else{b=this.$("input").prop("checked")}return b}.property().idempotent()};sc_require("views/template");SC.TextFieldSupport={$input:function(){return this.$("input")},_value:null,value:function(b,d){var a=this.$input();if(d!==undefined){if(this._value!==d){this._value=d}if(a.val()!==d){a.val(d)}}else{if(a.length>0){d=this._value=a.val()}else{d=this._value}}return d}.property().idempotent(),didCreateLayer:function(){var b=this.$input(),a=this;b.val(this._value);if(SC.browser.isIE){SC.Event.add(b,"focusin",this,this.focusIn);SC.Event.add(b,"focusout",this,this.focusOut)}else{SC.Event.add(b,"focus",this,this.focusIn);SC.Event.add(b,"blur",this,this.focusOut)}},willDestroyLayerMixin:function(){var a=this.$input();if(SC.browser.isIE){SC.Event.remove(a,"focusin",this,this.focusIn);SC.Event.remove(a,"focusout",this,this.focusOut)}else{SC.Event.remove(a,"focus",this,this.focusIn);SC.Event.remove(a,"blur",this,this.focusOut)}},focusIn:function(a){this.becomeFirstResponder();this.tryToPerform("focus",a)},focusOut:function(a){this.resignFirstResponder();this.tryToPerform("blur",a)},touchStart:function(a){a.allowDefault();return YES},touchEnd:function(a){a.allowDefault();return YES},willLoseFirstResponder:function(){this.notifyPropertyChange("value")},domValueDidChange:function(a){this.set("value",a.val())},keyUp:function(a){this.domValueDidChange(this.$input());if(a.keyCode===SC.Event.KEY_RETURN){return this.tryToPerform("insertNewline",a)}else{if(a.keyCode===SC.Event.KEY_ESC){return this.tryToPerform("cancel",a)}}},selectStart:function(){return true}};SC.TextField=SC.TemplateView.extend(SC.TextFieldSupport,{classNames:["sc-text-field"],isMultiline:NO,template:function(){return SC.Handlebars.compile(this.get("isMultiline")?"<textarea></textarea>":'<input type="text">')}.property("isMultiline").cacheable(),$input:function(){var a=this.get("isMultiline")?"textarea":"input";return this.$(a)}});SC.TemplatePane=SC.Object.extend({});SC.TemplatePane.mixin({append:function(a){var b=SC.MainPane.extend({childViews:["contentView"],contentView:SC.TemplateView.design(a),touchStart:function(d){d.allowDefault()},touchesDragged:function(d,e){d.allowDefault()},touchEnd:function(d){d.allowDefault()}});b=b.create().append();b.awake();return b}});sc_require("views/template");SC._BindableSpan=SC.TemplateView.extend({tagName:"span",shouldDisplayFunc:null,preserveContext:NO,displayTemplate:null,inverseTemplate:null,property:null,render:function(e){var j=this.get("isEscaped");var a=this.get("shouldDisplayFunc"),g=this.get("property"),f=this.get("preserveContext"),b=this.get("previousContext");var d=this.get("inverseTemplate"),h=this.get("displayTemplate");var k;if(g===""){k=b}else{k=b.getPath(g)}if(a(k)){this.set("template",h);if(f){this.set("context",b)}else{if(h){this.set("context",k)}else{if(k==null){k=""}else{k=String(k)}if(j){k=Handlebars.Utils.escapeExpression(k)}e.push(k);return}}}else{if(d){this.set("template",d);if(f){this.set("context",b)}else{this.set("context",k)}}else{this.set("template",function(){return""})}}return arguments.callee.base.apply(this,arguments)},rerender:function(){var b,a,f,g;f=this.get("childViews");a=f.get("length");for(b=a-1;b>=0;b--){g=f[b];g.$().remove();g.removeFromParent();g.destroy()}var d=this.renderContext(this.get("tagName"));var e;this.renderToContext(d);e=d.element();this.$().replaceWith(e);this.set("layer",e);this._notifyDidCreateLayer()}});sc_require("views/template");SC.TemplateCollectionView=SC.TemplateView.extend({tagName:"ul",content:null,template:SC.Handlebars.compile(""),emptyView:null,init:function(){var a=arguments.callee.base.apply(this,arguments);this._sctcv_contentDidChange();return a},didCreateLayer:function(){if(this._sctcv_layerCreated){return}this._sctcv_layerCreated=true;var a=this.get("content");if(a){this.arrayContentDidChange(0,0,a.get("length"))}},itemView:"SC.TemplateView",itemViewTemplate:null,itemViewTemplateName:null,inverseTemplate:function(b,e){if(e!==undefined){return e}var a=this.get("inverseTemplateName"),d=this.get("templates").get(a);if(!d){return function(){return""}}return d}.property("inverseTemplateName").cacheable(),inverseTemplateName:null,itemContext:null,itemViewClass:function(){var d=this.get("itemView");var a=this.get("itemViewTemplate");var e=this.get("itemViewTemplateName");var b={};if(SC.typeOf(d)===SC.T_STRING){d=SC.objectForPropertyPath(d)}if(!a&&e){a=this.get("templates").get(e)}if(a){b.template=a}if(d.prototype.tagName===SC.TemplateView.prototype.tagName){b.tagName=this.get("itemTagName")}return d.extend(b)}.property("itemView").cacheable(),_sctcv_contentDidChange:function(){this.$().empty();var d=this._content,a=0;var e=this.get("content"),b=0;if(d){d.removeArrayObservers({target:this,willChange:"arrayContentWillChange",didChange:"arrayContentDidChange"});a=d.get("length")}if(e){e.addArrayObservers({target:this,willChange:"arrayContentWillChange",didChange:"arrayContentDidChange"});b=e.get("length")}this.arrayContentWillChange(0,a,b);this._content=this.get("content");this.arrayContentDidChange(0,a,b)}.observes("content"),arrayContentWillChange:function(j,e,g){var d=this.get("emptyView");if(d){d.$().remove();d.removeFromParent()}var f=this.get("childViews"),h,b,a;a=f.get("length");for(b=j+e-1;b>=j;b--){h=f[b];if(h){h.$().remove();h.removeFromParent();h.destroy()}}},arrayContentDidChange:function(f,n,w){if(!this.get("layer")){return}var o=this.get("content"),g=this.get("itemViewClass"),q=this.get("childViews"),a=[],u,v,j,s,h,t,m,l,p;if(o){var k=o.slice(f,f+w);j=this.get("itemViewOptions")||{};s=this.$();h=s.find("li")[f-1]||null;p=k.get("length");var e={id:j.id,"class":j["class"],classBinding:j.classBinding};u=function(x){arguments.callee.base.apply(this,arguments);SC.Handlebars.ViewHelper.applyAttributes(e,this,x)};j=SC.clone(j);delete j.id;delete j["class"];delete j.classBinding;for(l=0;l<p;l++){t=k.objectAt(l);v=this.createChildView(g.extend(j,{content:t,render:u,tagName:j.tagName||g.prototype.tagName}));var d=v.get("contextProperty");if(d){v.set("context",v.get(d))}m=v.createLayer().$();if(!h){s.append(m)}else{m.insertAfter(h)}h=m;a.push(v)}q.replace(f,0,a)}var b=this.get("inverseTemplate");if(q.get("length")===0&&b){v=this.createChildView(SC.TemplateView.extend({template:b,content:this}));this.set("emptyView",v);v.createLayer().$().appendTo(s);this.childViews=[v]}this.invokeLast("invalidateFrame")},itemTagName:function(){switch(this.get("tagName")){case"dl":return"dt";case"ul":case"ol":return"li";case"table":case"thead":case"tbody":case"tfoot":return"tr";case"select":return"option";default:return SC.TemplateView.prototype.tagName}}.property("tagName"),invalidateFrame:function(){this.notifyPropertyChange("frame")}});
/*!
 * ==========================================================================
 * SproutCore -- JavaScript Application Framework
 * Copyright 2008-2011 Apple Inc. All rights reserved.
 * Copyright 2006-2011, Strobe Inc. and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a 
 * copy of this software and associated documentation files (the "Software"), 
 * to deal in the Software without restriction, including without limitation 
 * the rights to use, copy, modify, merge, publish, distribute, sublicense, 
 * and/or sell copies of the Software, and to permit persons to whom the 
 * Software is furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in 
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR 
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE 
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER 
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
 * DEALINGS IN THE SOFTWARE.
 * 
 * SproutCore and the SproutCore logo are trademarks of Strobe Inc.
 * 
 * For more information about SproutCore, visit http://www.sproutcore.com
 * 
 * ==========================================================================
 */
SC.stringsFor("English",{"SC.Date.Era.AD.Abbreviated":"AD","SC.Date.Era.AD.Full":"Anno Domini","SC.Date.Era.AD.Letter":"A","SC.Date.Era.BC.Abbreviated":"BC","SC.Date.Era.BC.Full":"Before Christ","SC.Date.Era.BC.Letter":"B","SC.Date.Quarter.Q1.Abbreviated":"Q1","SC.Date.Quarter.Q1.Full":"1st quarter","SC.Date.Quarter.StandAlone.Q1.Abbreviated":"Q1","SC.Date.Quarter.StandAlone.Q1.Full":"1st Quarter","SC.Date.Quarter.Q2.Abbreviated":"Q2","SC.Date.Quarter.Q2.Full":"2nd quarter","SC.Date.Quarter.StandAlone.Q2.Abbreviated":"Q2","SC.Date.Quarter.StandAlone.Q2.Full":"2nd Quarter","SC.Date.Quarter.Q3.Abbreviated":"Q3","SC.Date.Quarter.Q3.Full":"3rd quarter","SC.Date.Quarter.StandAlone.Q3.Abbreviated":"Q3","SC.Date.Quarter.StandAlone.Q3.Full":"3rd Quarter","SC.Date.Quarter.Q4.Abbreviated":"Q4","SC.Date.Quarter.Q4.Full":"4th quarter","SC.Date.Quarter.StandAlone.Q4.Abbreviated":"Q4","SC.Date.Quarter.StandAlone.Q4.Full":"4th Quarter","SC.Date.Month.January.Abbreviated":"Jan","SC.Date.Month.January.Full":"January","SC.Date.Month.January.Letter":"J","SC.Date.Month.StandAlone.January.Abbreviated":"Jan","SC.Date.Month.StandAlone.January.Full":"January","SC.Date.Month.StandAlone.January.Letter":"J","SC.Date.Month.February.Abbreviated":"Feb","SC.Date.Month.February.Full":"February","SC.Date.Month.February.Letter":"F","SC.Date.Month.StandAlone.February.Abbreviated":"Feb","SC.Date.Month.StandAlone.February.Full":"February","SC.Date.Month.StandAlone.February.Letter":"F","SC.Date.Month.March.Abbreviated":"Mar","SC.Date.Month.March.Full":"March","SC.Date.Month.March.Letter":"M","SC.Date.Month.StandAlone.March.Abbreviated":"Mar","SC.Date.Month.StandAlone.March.Full":"March","SC.Date.Month.StandAlone.March.Letter":"M","SC.Date.Month.April.Abbreviated":"Apr","SC.Date.Month.April.Full":"April","SC.Date.Month.April.Letter":"A","SC.Date.Month.StandAlone.April.Abbreviated":"Apr","SC.Date.Month.StandAlone.April.Full":"April","SC.Date.Month.StandAlone.April.Letter":"A","SC.Date.Month.May.Abbreviated":"May","SC.Date.Month.May.Full":"May","SC.Date.Month.May.Letter":"M","SC.Date.Month.StandAlone.May.Abbreviated":"May","SC.Date.Month.StandAlone.May.Full":"May","SC.Date.Month.StandAlone.May.Letter":"M","SC.Date.Month.June.Abbreviated":"Jun","SC.Date.Month.June.Full":"June","SC.Date.Month.June.Letter":"J","SC.Date.Month.StandAlone.June.Abbreviated":"Jun","SC.Date.Month.StandAlone.June.Full":"June","SC.Date.Month.StandAlone.June.Letter":"J","SC.Date.Month.July.Abbreviated":"Jul","SC.Date.Month.July.Full":"July","SC.Date.Month.July.Letter":"J","SC.Date.Month.StandAlone.July.Abbreviated":"Jul","SC.Date.Month.StandAlone.July.Full":"July","SC.Date.Month.StandAlone.July.Letter":"J","SC.Date.Month.August.Abbreviated":"Aug","SC.Date.Month.August.Full":"August","SC.Date.Month.August.Letter":"A","SC.Date.Month.StandAlone.August.Abbreviated":"Aug","SC.Date.Month.StandAlone.August.Full":"August","SC.Date.Month.StandAlone.August.Letter":"A","SC.Date.Month.September.Abbreviated":"Sep","SC.Date.Month.September.Full":"September","SC.Date.Month.September.Letter":"S","SC.Date.Month.StandAlone.September.Abbreviated":"Sep","SC.Date.Month.StandAlone.September.Full":"September","SC.Date.Month.StandAlone.September.Letter":"S","SC.Date.Month.October.Abbreviated":"Oct","SC.Date.Month.October.Full":"October","SC.Date.Month.October.Letter":"O","SC.Date.Month.StandAlone.October.Abbreviated":"Oct","SC.Date.Month.StandAlone.October.Full":"October","SC.Date.Month.StandAlone.October.Letter":"O","SC.Date.Month.November.Abbreviated":"Nov","SC.Date.Month.November.Full":"November","SC.Date.Month.November.Letter":"N","SC.Date.Month.StandAlone.November.Abbreviated":"Nov","SC.Date.Month.StandAlone.November.Full":"November","SC.Date.Month.StandAlone.November.Letter":"N","SC.Date.Month.December.Abbreviated":"Dec","SC.Date.Month.December.Full":"December","SC.Date.Month.December.Letter":"D","SC.Date.Month.StandAlone.December.Abbreviated":"Dec","SC.Date.Month.StandAlone.December.Full":"December","SC.Date.Month.StandAlone.December.Letter":"D","SC.Date.Day.Monday.Abbreviated":"Mon","SC.Date.Day.Monday.Full":"Monday","SC.Date.Day.Monday.Letter":"M","SC.Date.Day.StandAlone.Monday.Abbreviated":"Mon","SC.Date.Day.StandAlone.Monday.Full":"Monday","SC.Date.Day.StandAlone.Monday.Letter":"M","SC.Date.Day.Tuesday.Abbreviated":"Tue","SC.Date.Day.Tuesday.Full":"Tuesday","SC.Date.Day.Tuesday.Letter":"T","SC.Date.Day.StandAlone.Tuesday.Abbreviated":"Tue","SC.Date.Day.StandAlone.Tuesday.Full":"Tuesday","SC.Date.Day.StandAlone.Tuesday.Letter":"T","SC.Date.Day.Wednesday.Abbreviated":"Wed","SC.Date.Day.Wednesday.Full":"Wednesday","SC.Date.Day.Wednesday.Letter":"W","SC.Date.Day.StandAlone.Wednesday.Abbreviated":"Wed","SC.Date.Day.StandAlone.Wednesday.Full":"Wednesday","SC.Date.Day.StandAlone.Wednesday.Letter":"W","SC.Date.Day.Thursday.Abbreviated":"Thu","SC.Date.Day.Thursday.Full":"Thursday","SC.Date.Day.Thursday.Letter":"R","SC.Date.Day.StandAlone.Thursday.Abbreviated":"Thu","SC.Date.Day.StandAlone.Thursday.Full":"Thursday","SC.Date.Day.StandAlone.Thursday.Letter":"R","SC.Date.Day.Friday.Abbreviated":"Fri","SC.Date.Day.Friday.Full":"Friday","SC.Date.Day.Friday.Letter":"F","SC.Date.Day.StandAlone.Friday.Abbreviated":"Fri","SC.Date.Day.StandAlone.Friday.Full":"Friday","SC.Date.Day.StandAlone.Friday.Letter":"F","SC.Date.Day.Saturday.Abbreviated":"Sat","SC.Date.Day.Saturday.Full":"Saturday","SC.Date.Day.Saturday.Letter":"S","SC.Date.Day.StandAlone.Saturday.Abbreviated":"Sat","SC.Date.Day.StandAlone.Saturday.Full":"Saturday","SC.Date.Day.StandAlone.Saturday.Letter":"S","SC.Date.Day.Sunday.Abbreviated":"Sun","SC.Date.Day.Sunday.Full":"Sunday","SC.Date.Day.Sunday.Letter":"S","SC.Date.Day.StandAlone.Sunday.Abbreviated":"Sun","SC.Date.Day.StandAlone.Sunday.Full":"Sunday","SC.Date.Day.StandAlone.Sunday.Letter":"S","SC.Date.Period.AM":"AM","SC.Date.Period.PM":"PM"});SC.DateFormatter=function(d,g){if(!d){throw"No date passed to date formatter."}else{if(!d.getFullYear){throw"Object passed to date formatter was not a date!"}}if(!g){throw"No formatting string passed to date formatter. Date: "+d}var b=g.length,h=g[0],a;for(a=1;a<b;a++){if(g[a]!==h){throw"Invalid format string for a date; all characters must be the same: "+g+"; date: "+d}}var e=SC.DateFormatter[h];if(!e){throw"No formatter `"+h+"` exists for date: "+d}return e(d,b)};SC.DateFormatter.G=function(b,d){var a="SC.Date.Era.";a+=b.getFullYear()>=0?"AD":"BC";if(d<=3){return(a+".Abbreviated").loc()}else{if(d===4){return(a+".Full").loc()}else{if(d===5){return(a+".Letter").loc()}else{throw"Invalid era format: expected at most 5 digits; found "+d+"."}}}};SC.DateFormatter.y=function(a,d){var b=Math.abs(a.getFullYear()).toString();while(b.length<d){b="0"+b}b=b.substr(b.length-d);return b};SC.DateFormatter.Y=function(a,b){return SC.DateFormatter.y(a,b)};SC.DateFormatter.u=function(a,e){var b=a.getFullYear()<0;var d=Math.abs(a.getFullYear()).toString();while(d.length<e){d="0"+d}d=d.substr(d.length-e);return(b?"-":"")+d};SC.DateFormatter.Q=function(b,e,d){var f=b.getMonth(),a=Math.floor(f/3)+1,g="SC.Date.Quarter."+(d?"StandAlone.":"")+"Q"+a;if(e===1){return""+a}else{if(e===2){return"0"+a}else{if(e===3){return(g+".Abbreviated").loc()}else{if(e==4){return(g+".Full").loc()}else{throw"Unrecognized number of characters for quarter: "+e}}}}};SC.DateFormatter.q=function(a,b){return SC.DateFormatter.Q(a,b,YES)};SC.DateFormatter.ENGLISH_MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"];SC.DateFormatter.M=function(d,f,e){var g=d.getMonth(),b=""+(g+1),a="SC.Date.Month."+(e?"StandAlone.":"")+SC.DateFormatter.ENGLISH_MONTH_NAMES[g];if(f===1){return b}else{if(f===2){if(b.length<2){b="0"+b}return b}else{if(f===3){return(a+".Abbreviated").loc()}else{if(f===4){return(a+".Full").loc()}else{if(f===5){return(a+".Letter").loc()}else{throw"The number of Ms or Ls must be from 1 to 5. Supplied: "+f}}}}}};SC.DateFormatter.L=function(a,b){return SC.DateFormatter.M(a,b,YES)};SC.DateFormatter.l=function(){throw"`l` date formatter not implemented."};SC.DateFormatter.w=function(a,b){throw"Week number currently not supported for date formatting."};SC.DateFormatter.W=function(a,b){throw"Week number currently not supported for date formatting."};SC.DateFormatter.d=function(a,b){var d=""+a.getDate();if(b>d.length){d="0"+d}return d};SC.DateFormatter.D=function(b,d){var a=new Date(b.getFullYear(),0,1),e=a.getTime(),f=b.getTime()-e,g=Math.floor(f/(24*60*60*1000))+1;g=""+g;while(g.length<d){g="0"+g}return g};SC.DateFormatter.F=function(a,b){throw"Day of week in month (F) is not supported in date formatting"};SC.DateFormatter.g=function(a,b){throw"Julian day not supported in date formatting."};SC.DateFormatter.ENGLISH_DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];SC.DateFormatter.E=function(a,b){if(b<3){b=3}return SC.DateFormatter.e(a,b)};SC.DateFormatter.e=function(d,f,e){var b=d.getDay(),g=""+(b+1),a="SC.Date.Day."+(e?"StandAlone.":"")+SC.DateFormatter.ENGLISH_DAY_NAMES[b];if(f===1){return g}else{if(f===2){g="0"+g;return g}else{if(f===3){return(a+".Abbreviated").loc()}else{if(f===4){return(a+".Full").loc()}else{if(f===5){return(a+".Letter").loc()}else{throw"Unrecognized number of `e`s, `c`s, or `E`s in date format string."}}}}}};SC.DateFormatter.c=function(a,b){return SC.DateFormatter.e(a,b,YES)};SC.DateFormatter.a=function(b,d){if(d!==1){throw"`a` can only be included in a date format string once."}var a="SC.Date.Period."+(b.getHours()>11?"PM":"AM");return a.loc()};SC.DateFormatter._h=function(d,e,g,f){var b=d.getHours();if(!g){b=b%12}if(f){if(!g){if(b===0){b=12}}else{if(b===0){b=24}}}var a=""+b;if(a.length<e){a="0"+a}return a};SC.DateFormatter.h=function(a,b){return SC.DateFormatter._h(a,b,NO,1)};SC.DateFormatter.H=function(a,b){return SC.DateFormatter._h(a,b,YES,0)};SC.DateFormatter.K=function(a,b){return SC.DateFormatter._h(a,b,NO,0)};SC.DateFormatter.k=function(a,b){return SC.DateFormatter._h(a,b,YES,1)};SC.DateFormatter.m=function(a,b){var d=""+a.getMinutes();if(d.length<b){d="0"+d}return d};SC.DateFormatter.s=function(a,b){var d=""+a.getSeconds();if(d.length<b){d="0"+d}return d};SC.DateFormatter.S=function(a,d){var b=a.getMilliseconds()/1000,e=Math.pow(10,d);b=Math.round(b*e);b=""+b;while(b.length<d){b="0"+b}return b};SC.DateFormatter.A=function(a,d){var e=new Date(a.getFullYear(),a.getMonth(),a.getDay()).getTime();var b=a.getTime()-e;b=""+b;while(b.length<d){b="0"+b}return b};SC.DateFormatter.z=SC.DateFormatter.Z=SC.DateFormatter.v=SC.DateFormatter.V=function(a,b){throw"Timezone not supported in date format strings."};SC.warn("SC.Animatable is deprecated and will be removed in the next release.  Animation can be achieved by using the .animate method on SC.View.");SC.Animatable={isAnimatable:YES,transitions:{},concatenatedProperties:["transitions"],style:{},_cssTransitionFor:{left:"left",top:"top",right:"right",bottom:"bottom",width:"width",height:"height",opacity:"opacity",transform:(SC.platform.supportsCSSTransforms?"-"+SC.platform.cssPrefix+"-transform":"transform")},_styleProperties:["display","transform"],_layoutStyles:SC.String.w("width height top bottom marginLeft marginTop left right zIndex minWidth maxWidth minHeight maxHeight centerX centerY opacity border borderTop borderRight borderBottom borderLeft"),_animationsToStart:{},_animationOrder:["top","left","bottom","right","width","height","centerX","centerY","opacity","display","transform"],initMixin:function(){this._animatable_original_didCreateLayer=this.didCreateLayer||function(){};this.didCreateLayer=this._animatable_didCreateLayer;this._animatable_original_willDestroyLayer=this.willDestroyLayer||function(){};this.willDestroyLayer=this._animatable_willDestroyLayer;this._animatable_original_willRemoveFromParent=this.willRemoveFromParent||function(){};this.willRemoveFromParent=this._animatable_will_remove_from_parent;this._animatable_original_hasAcceleratedLayer=this.hasAcceleratedLayer||function(){};this.hasAcceleratedLayer=this._animatable_hasAcceleratedLayer;this._animatable_original_animate=this.animate||function(){};this.animate=this._animatable_animate;this.addObserver("style",this,"styleDidChange");this._animateTickPixel.displayName="animate-tick";var b;if(SC.isArray(this.transitions)){var a={};for(b=0;b<this.transitions.length;b++){SC.mixin(a,this.transitions[b])}this.transitions=a}for(b in this.transitions){if(typeof this.transitions[b]=="number"){this.transitions[b]={duration:this.transitions[b]}}}this._animatableCurrentStyle=null;this._animators={};this._animatableSetCSS="";this._last_transition_css="";if(this._disableAnimation===undefined){this._disableAnimation=0}this._transitionCallbacks={};if(!SC.none(this.get("layer"))){var d=this._animatable_original_didCreateLayer;this._animatable_original_didCreateLayer=function(){};this.didCreateLayer();this._animatable_original_didCreateLayer=d}},_animatable_didCreateLayer:function(){this.resetAnimation();SC.Event.add(this.get("layer"),SC.platform.cssPrefix+"TransitionEnd",this,this.transitionEnd);SC.Event.add(this.get("layer"),"transitionend",this,this.transitionEnd);return this._animatable_original_didCreateLayer()},_animatable_willDestroyLayer:function(){SC.Event.remove(this.get("layer"),SC.platform.cssPrefix+"TransitionEnd",this,this.transitionEnd);SC.Event.remove(this.get("layer"),"transitionend",this,this.transitionEnd);return this._animatable_original_willDestroyLayer()},_animatable_will_remove_from_parent:function(){this.resetAnimation()},disableAnimation:function(){if(this._disableAnimation<1){this.updateStyle();this._disableAnimation=1;this.updateStyle()}else{this._disableAnimation++}},enableAnimation:function(){if(this._disableAnimation<=1){this.updateStyle();this._disableAnimation=0;this.updateStyle()}else{this._disableAnimation--}},adjust:function(l,m){if(!SC.none(m)){var n=l;l={};l[n]=m}else{l=SC.clone(l)}var a=SC.clone(this.get("style")),d=NO,h=SC.clone(this.get("layout")),b=NO;var o=this._styleProperties;for(var f in l){var j=NO;var k=(o.indexOf(f)>=0)?a:h;var e=k[f],g=l[f];if(g!==undefined&&e!==g){if(g===null){if(e!==undefined){j=YES}delete k[f]}else{k[f]=g;j=YES}}if(j){if(k===a){d=YES}else{b=YES}}}if(d){this.set("style",a)}if(b){this.set("layout",h)}return this},_animatable_animate:function(){this.disableAnimation();var a=this._animatable_original_animate.apply(this,arguments);this.enableAnimation();return a},transitionEnd:function(a){SC.run(function(){var b=a.originalEvent.propertyName,d=this._transitionCallbacks[b];if(d&&this._disableAnimation<=0){SC.Animatable.runCallback(d)}},this)},getCurrentJavaScriptStyles:function(){return this._animatableCurrentStyle},resetAnimation:function(){this._animatableCurrentStyle=null;this._stopJavaScriptAnimations();this.disableAnimation();this.updateStyle();this.enableAnimation();this.updateStyle()},_stopJavaScriptAnimations:function(){for(var a in this._animators){if(this._animators[a]&&this._animators[a].isQueued){SC.Animatable.removeTimer(this._animators[a])}}},_getStartStyleHash:function(j,h){var g=this.layout;this.layout=j;var e=this.computeParentDimensions();var d=this.computeFrameWithParentFrame(e);this.layout=g;var a={};for(var b in h){if(d){if(b=="left"){a[b]=d.x;continue}else{if(b=="top"){a[b]=d.y;continue}else{if(b=="right"){a[b]=e.width-d.x-d.width;continue}else{if(b=="bottom"){a[b]=e.height-d.y-d.height;continue}else{if(b=="width"){a[b]=d.width;continue}else{if(b=="height"){a[b]=d.height;continue}else{if(b=="centerX"){a[b]=d.x+(d.width/2)-(e.width/2);continue}else{if(b=="centerY"){a[b]=d.y+(d.height/2)-(e.height/2);continue}}}}}}}}}if(SC.none(a[b])){if(!SC.none(j[b])){a[b]=j[b]}else{a[b]=h[b]}}}return a},_TMP_CSS_TRANSITIONS:[],cssTimingStringFor:function(d){var b="linear";if(d.timing||SC.Animatable.defaultTimingFunction){var a=d.timing||SC.Animatable.defaultTimingFunction;if(SC.typeOf(a)!=SC.T_STRING){b="cubic-bezier("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}else{b=a}}return b},styleDidChange:function(){this.invokeLast("updateStyle")},_animatable_hasAcceleratedLayer:function(){var b=this.transitions.left&&this.transitions.left.duration,a=this.transitions.top&&this.transitions.top.duration;if(b!==a){return NO}else{if((a||b)&&!SC.platform.supportsCSSTransitions){return NO}else{return this._animatable_original_hasAcceleratedLayer()}}}.property("wantsAcceleratedLayer","transitions"),updateStyle:function(){var G=this.get("layer");var s=this.get("style");var o=NO,g="";if(this.get("hasAcceleratedLayer")){var v=s.top,b=s.bottom,C=s.height,B=s.left,x=s.right,q=s.width;if((SC.empty(v)||(!SC.isPercentage(v)&&!SC.empty(C)))&&(SC.empty(B)||(!SC.isPercentage(B)&&!SC.empty(q)))&&(this.transitions&&(this.transitions.top||this.transitions.left))){o=YES;this._useSpecialCaseTransform=YES}else{this._useSpecialCaseTransform=NO}}var A;if(!this._animatableCurrentStyle||this._disableAnimation>0||!G){this._animatableSetCSS="";this._animatableCurrentStyle={};for(A in s){if(A[0]!="_"){this._animatableCurrentStyle[A]=s[A]}}if(G){this._animatableApplyStyles(G,s)}return this}if(!G){return}var f=this._getStartStyleHash(this._animatableCurrentStyle,s);var h={};var t;var j=this._TMP_CSS_TRANSITIONS;if(SC.platform.supportsCSSTransitions){var n;if(o){var F=this.transitions.left||this.transitions.top;n=this.cssTimingStringFor(F);j.push("-"+SC.platform.cssPrefix+"-transform "+F.duration+"s "+n)}for(A in this.transitions){if(!this._cssTransitionFor[A]){continue}if(o&&(A=="left"||A=="top")){if(this.transitions.left.action){this._transitionCallbacks["-"+SC.platform.cssPrefix+"-transform"]={source:this,target:(this.transitions.left.target||this),action:this.transitions.left.action}}if(this.transitions.top.action){this._transitionCallbacks["-"+SC.platform.cssPrefix+"-transform"]={source:this,target:(this.transitions.top.target||this),action:this.transitions.top.action}}continue}n=this.cssTimingStringFor(this.transitions[A]);j.push(this._cssTransitionFor[A]+" "+this.transitions[A].duration+"s "+n)}}for(A in s){if(A[0]=="_"){continue}var e=!this.transitions[A]||s[A]==f[A];if(A=="display"&&s[A]!="none"){e=true}if(e){f[A]=s[A];var E=this._animators[A];if(E){E.endValue=s[A];E.end=0}continue}if(SC.platform.supportsCSSTransitions&&this._cssTransitionFor[A]){h[A]=s[A];if(this.transitions[A].action){this._transitionCallbacks[this._cssTransitionFor[A]]={source:this,target:(this.transitions[A].target||this),action:this.transitions[A].action}}continue}var z=this._animateTickPixel,d=A,p=f[A],m=s[A];if(d=="centerX"||d=="centerY"){z=this._animateTickCenter}else{if(d=="opacity"){z=this._animateTickNumber}else{if(d=="display"){z=this._animateTickDisplay}}}if(!this._animators[A]){this._animators[A]={}}var D=this._animators[A];D.start=null;D.duration=Math.floor(this.transitions[A].duration*1000);D.startValue=p;D.endValue=m;D.layer=G;D.property=d;D.action=z;D.style=G.style;D.holder=this;if(this.transitions[A].action){D.callback={source:this,target:(this.transitions[A].target||this),action:this.transitions[A].action}}t=this.transitions[A].timing||SC.Animatable.defaultTimingFunction;if(t&&SC.typeOf(t)!=SC.T_STRING){D.timingFunction=t}if(!D.going){this._animationsToStart[A]=D}}var u=this._animationOrder,w=this._animationOrder.length;for(A=0;A<w;A++){var y=u[A];if(this._animationsToStart[y]){SC.Animatable.addTimer(this._animationsToStart[y]);delete this._animationsToStart[y]}}var k=j.join(",");j.length="";this._animatableSetCSS=k;this._animatableApplyStyles(G,f,h);return this},_animatableApplyStyles:function(b,d,a){if(!b){return}var f=NO;if(d.display&&b.style.display!==d.display){b.style.display=d.display;f=YES}if(this._animatableSetCSS!=this._last_transition_css){b.style[SC.platform.domCSSPrefix+"Transition"]=this._animatableSetCSS;this._last_transition_css=this._animatableSetCSS;f=YES}if(!this._animators["display-styles"]){this._animators["display-styles"]={}}var e=this._animators["display-styles"];e.holder=this;e.action=this._animatableApplyNonDisplayStylesFromTimer;e.inLoopAction=this._animatableApplyNonDisplayStyles;e.layer=b;e.styles=d;e.delayed=a;this._animatableCurrentStyle=d;if(this._disableAnimation>0||!f){e.inLoopAction()}else{SC.Animatable.addTimer(e)}},_animatableApplyNonDisplayStylesFromTimer:function(){SC.run(function(){this.inLoopAction()},this)},_animatableApplyNonDisplayStyles:function(){var h=this.layer,l=this.holder._animatableCurrentStyle;var e={};var j={},m=NO,a=h.style;var b="";for(var g in l){if(g=="display"){continue}if(this.holder._layoutStyles.indexOf(g)>=0){j[g]=l[g];m=YES;continue}else{if(g=="transform"){b+=" "+l[g]}else{if(e[g]){e[g](a,g,l)}else{a[g]=l[g]}}}}if(!SC.empty(b)){a[SC.platform.cssPrefix+"Transform"]=b}if(m){var d=this.holder.layout;this.holder.layout=j;this.holder.notifyPropertyChange("layoutStyle");var f=this.holder.get("layoutStyle");for(var k in f){if(SC.none(f[k])){a[k]=""}else{if(a[k]!=f[k]){a[k]=f[k]}}}this.holder.layout=d}if(this.delayed){SC.mixin(this.holder._animatableCurrentStyle,this.delayed);this.styles=this.delayed;this.delayed=undefined;if(this._disableAnimation>0){this.inLoopAction()}else{SC.Animatable.addTimer(this)}}},updateLayout:function(d,a){var b=SC.clone(this.get("style"));var h=this.get("layout");var e=0,f=this._layoutStyles,j=f.length,g=NO;for(e=0;e<j;e++){var k=f[e];if(b[k]!==h[k]){if(SC.none(h[k])){b[k]=undefined}else{b[k]=h[k]}g=YES}}if(g){this.style=b;this.updateStyle()}return this},_solveBezierForT:function(b,q,n,m,g,e,o,f){var p=1/(200*f);var l,k,j,d,a,h;for(j=o,h=0;h<8;h++){d=((b*j+n)*j+g)*j-o;if(Math.abs(d)<p){return j}a=(3*b*j+2*n)*j+g;if(Math.abs(a)<Math.pow(10,-6)){break}j=j-d/a}l=0;k=1;j=o;if(j<l){return l}if(j>k){return k}while(l<k){d=((b*j+n)*j+g)*j;if(Math.abs(d-o)<p){return j}if(o>d){l=j}else{k=j}j=(k-l)*0.5+l}return j},_solveBezier:function(d,b,l,k,m,f){var g=3*d;var j=3*(l-d)-g;var a=1-g-j;var e=3*b;var h=3*(k-b)-e;var o=1-e-h;var n=this._solveBezierForT(a,o,j,h,g,e,m,f);return((o*n+h)*n+e)*n},_animateTickPixel:function(n){if(SC.none(this.start)){this.start=n;this.end=this.start+this.duration}var o=this.start,g=this.end;var m=this.startValue,k=this.endValue;var h=g-o;var b=k-m;var j=n-o;var f=Math.min(j/h,1);if(this.timingFunction){var a=this.timingFunction;f=this.holder._solveBezier(a[0],a[1],a[2],a[3],f,h)}var l=Math.floor(m+(b*f));this.holder._animatableCurrentStyle[this.property]=l;this.style[this.property]=l+"px";if(n<g){SC.Animatable.addTimer(this)}else{this.going=false;if(this.callback){SC.Animatable.runCallback(this.callback)}this.styles=null;this.layer=null}},_animateTickDisplay:function(a){if(SC.none(this.start)){this.start=a;this.end=this.start+this.duration}var b=this.end;if(a<b){SC.Animatable.addTimer(this);return}this.holder._animatableCurrentStyle[this.property]=this.endValue;this.style[this.property]=this.endValue;this.going=false;if(this.callback){SC.Animatable.runCallback(this.callback)}this.styles=null;this.layer=null},_animateTickNumber:function(n){if(SC.none(this.start)){this.start=n;this.end=this.start+this.duration}var o=this.start,g=this.end;var m=this.startValue,k=this.endValue;var h=g-o;var b=k-m;var j=n-o;var f=Math.min(j/h,1);if(this.timingFunction){var a=this.timingFunction;f=this.holder._solveBezier(a[0],a[1],a[2],a[3],f,h)}var l=Math.round((m+(b*f))*100)/100;this.holder._animatableCurrentStyle[this.property]=l;this.style[this.property]=l;if(this.property=="opacity"){this.style.zoom=1}if(n<g){SC.Animatable.addTimer(this)}else{this.going=false;if(this.callback){SC.Animatable.runCallback(this.callback)}this.styles=null;this.layer=null}},_animateTickCenter:function(p){if(SC.none(this.start)){this.start=p;this.end=this.start+this.duration}var q=this.start,h=this.end;var o=this.startValue,l=this.endValue;var j=h-q;var f=l-o;var k=p-q;var g=Math.min(k/j,1);if(this.timingFunction){var b=this.timingFunction;g=this.holder._solveBezier(b[0],b[1],b[2],b[3],g,j)}var n=o+(f*g);this.holder._animatableCurrentStyle[this.property]=n;var m,a;if(this.property=="centerX"){m="width";a="marginLeft"}else{m="height";a="marginTop"}this.style[a]=Math.round(n-(this.holder._animatableCurrentStyle[m]/2))+"px";if(p<h){SC.Animatable.addTimer(this)}else{this.going=false;if(this.callback){SC.Animatable.runCallback(this.callback)}this.styles=null;this.layer=null}}};SC.mixin(SC.Animatable,{NAMESPACE:"SC.Animatable",VERSION:"0.1.0",TRANSITION_NONE:"linear",TRANSITION_CSS_EASE:"ease",TRANSITION_CSS_EASE_IN:"ease-in",TRANSITION_CSS_EASE_OUT:"ease-out",TRANSITION_CSS_EASE_IN_OUT:"ease-in-out",TRANSITION_EASE:[0.25,0.1,0.25,1],TRANSITION_LINEAR:[0,0,1,1],TRANSITION_EASE_IN:[0.42,0,1,1],TRANSITION_EASE_OUT:[0,0,0.58,1],TRANSITION_EASE_IN_OUT:[0.42,0,0.58,1],defaultTimingFunction:null,baseTimer:{next:null},going:false,_ticks:0,_timer_start_time:null,interval:10,currentTime:new Date().getTime(),stats:SC.Object.create({lastFPS:0}),addTimer:function(a){if(a.isQueued){return}a.prev=SC.Animatable.baseTimer;a.next=SC.Animatable.baseTimer.next;if(SC.Animatable.baseTimer.next){SC.Animatable.baseTimer.next.prev=a}SC.Animatable.baseTimer.next=a;a.isQueued=true;if(!SC.Animatable.going){SC.Animatable.start()}},removeTimer:function(a){if(!a.isQueued){return}if(a.next){a.next.prev=a.prev}a.prev.next=a.next;a.isQueued=false},start:function(){SC.Animatable._ticks=0;SC.Animatable._timer_start_time=new Date().getTime();SC.Animatable.going=true;setTimeout(function(){SC.Animatable.timeout()},SC.Animatable.interval)},timeout:function(){SC.Animatable.currentTime=new Date().getTime();var h=SC.Animatable.currentTime;var f=SC.Animatable.baseTimer.next;SC.Animatable.baseTimer.next=null;var e=0;while(f){var d=f.next;f.isQueued=false;f.next=null;f.prev=null;f.action.call(f,h);f=d;e++}if(SC.Animatable._ticks<1000000){SC.Animatable._ticks++}var b=new Date().getTime();var a=b-h;if(SC.Animatable.baseTimer.next){setTimeout(function(){SC.Animatable.timeout()},Math.max(0,SC.Animatable.interval-a))}else{SC.Animatable.going=false;var g=b-SC.Animatable._timer_start_time;SC.run(function(){SC.Animatable.stats.set("lastFPS",SC.Animatable._ticks/(g/1000))})}},runCallback:function(g){var a=SC.typeOf(g.action);if(a==SC.T_FUNCTION){g.action.call(g.target,g.source)}else{if(a===SC.T_STRING){if(g.action.indexOf(".")>=0){var f=g.action.split(".");var d=f.pop();var e=SC.objectForPropertyPath(f,window);var b=e.get?e.get(d):e[d];if(b&&SC.typeOf(b)==SC.T_FUNCTION){b.call(e,g.source)}else{throw"SC.Animator could not find a function at %@".fmt(g.action)}}else{SC.RootResponder.responder.sendAction(g.action,g.target,g.source,g.source.get("pane"),null,g.source)}}}}});
/*!
 * Raphael 1.5.2 - JavaScript Vector Library
 *
 * Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 * Licensed under the MIT (http://raphaeljs.com/license.html) license.
 */
(function(){function dx(){if(dx.is(arguments[0],dI)){var a=arguments[0],k=cG[da](dx,a.splice(0,3+dx.is(a[0],dA))),g=k.set();for(var h=0,f=a[bg];h<f;h++){var j=a[h]||{};b5[c0](j.type)&&g[bQ](k[j.type]().attr(j))}return g}return cG[da](dx,arguments)}dx.version="1.5.2";var b3=/[, ]+/,b5={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},b7=/\{(\d+)\}/g,c4="prototype",c0="hasOwnProperty",dc=document,dp=window,bJ={was:Object[c4][c0].call(dp,"Raphael"),is:dp.Raphael},de=function(){this.customAttributes={}},b,ca="appendChild",da="apply",bV="concat",cg="createTouch" in dc,dq="",dy=" ",c8=String,cA="split",cn="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[cA](dy),b4={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},di="join",bg="length",cZ=c8[c4].toLowerCase,cR=Math,bO=cR.max,ce=cR.min,cP=cR.abs,b9=cR.pow,dt=cR.PI,dA="number",c2="string",dI="array",dP="toString",dL="fill",dl=Object[c4][dP],bZ={},bQ="push",bT=/^url\(['"]?([^\)]+?)['"]?\)$/i,cD=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,cQ={"NaN":1,"Infinity":1,"-Infinity":1},b0=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,c6=cR.round,cI="setAttribute",cW=parseFloat,cl=parseInt,dK=" progid:DXImageTransform.Microsoft",b6=c8[c4].toUpperCase,bK={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},cT={along:"along",blur:dA,"clip-rect":"csv",cx:dA,cy:dA,fill:"colour","fill-opacity":dA,"font-size":dA,height:dA,opacity:dA,path:"path",r:dA,rotation:"csv",rx:dA,ry:dA,scale:"csv",stroke:"colour","stroke-opacity":dA,"stroke-width":dA,translation:"csv",width:dA,x:dA,y:dA},b1="replace",ck=/^(from|to|\d+%?)$/,co=/\s*,\s*/,bN={hs:1,rg:1},ct=/,?([achlmqrstvxz]),?/gi,dn=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,dz=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,dr=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,b8=function(a,f){return a.key-f.key};dx.type=(dp.SVGAngle||dc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(dx.type=="VML"){var cE=dc.createElement("div"),dE;cE.innerHTML='<v:shape adj="1"/>';dE=cE.firstChild;dE.style.behavior="url(#default#VML)";if(!(dE&&typeof dE.adj=="object")){return dx.type=null}cE=null}dx.svg=!(dx.vml=dx.type=="VML");de[c4]=dx[c4];b=de[c4];dx._id=0;dx._oid=0;dx.fn={};dx.is=function(f,a){a=cZ.call(a);if(a=="finite"){return !cQ[c0](+f)}return(a=="null"&&f===null)||(a==typeof f)||(a=="object"&&f===Object(f))||(a=="array"&&Array.isArray&&Array.isArray(f))||dl.call(f).slice(8,-1).toLowerCase()==a};dx.angle=function(h,f,k,g,l,j){if(l==null){var a=h-k,m=f-g;if(!a&&!m){return 0}return((a<0)*180+cR.atan(-m/-a)*180/dt+360)%360}else{return dx.angle(h,f,l,j)-dx.angle(k,g,l,j)}};dx.rad=function(a){return a%360*dt/180};dx.deg=function(a){return a*180/dt%360};dx.snapTo=function(j,g,a){a=dx.is(a,"finite")?a:10;if(dx.is(j,dI)){var h=j.length;while(h--){if(cP(j[h]-g)<=a){return j[h]}}}else{j=+j;var f=g%j;if(f<a){return g-f}if(f>j-a){return g-f+j}}return g};function bR(){var f=[],a=0;for(;a<32;a++){f[a]=(~~(cR.random()*16))[dP](16)}f[12]=4;f[16]=((f[16]&3)|8)[dP](16);return"r-"+f[di]("")}dx.setWindow=function(a){dp=a;dc=dp.document};var cv=function(j){if(dx.vml){var f=/^\s+|\s+$/g;var g;try{var a=new ActiveXObject("htmlfile");a.write("<body>");a.close();g=a.body}catch(l){g=createPopup().document.body}var k=g.createTextRange();cv=dF(function(o){try{g.style.color=c8(o)[b1](f,dq);var n=k.queryCommandValue("ForeColor");n=((n&255)<<16)|(n&65280)|((n&16711680)>>>16);return"#"+("000000"+n[dP](16)).slice(-6)}catch(m){return"none"}})}else{var h=dc.createElement("i");h.title="Rapha\xebl Colour Picker";h.style.display="none";dc.body[ca](h);cv=dF(function(m){h.style.color=m;return dc.defaultView.getComputedStyle(h,dq).getPropertyValue("color")})}return cv(j)},dD=function(){return"hsb("+[this.h,this.s,this.b]+")"},cw=function(){return"hsl("+[this.h,this.s,this.l]+")"},cN=function(){return this.hex};dx.hsb2rgb=function(f,g,h,a){if(dx.is(f,"object")&&"h" in f&&"s" in f&&"b" in f){h=f.b;g=f.s;f=f.h;a=f.o}return dx.hsl2rgb(f,g,h/2,a)};dx.hsl2rgb=function(q,f,s,n){if(dx.is(q,"object")&&"h" in q&&"s" in q&&"l" in q){s=q.l;f=q.s;q=q.h}if(q>1||f>1||s>1){q/=360;f/=100;s/=100}var j={},m=["r","g","b"],p,k,a,o,l,h;if(!f){j={r:s,g:s,b:s}}else{if(s<0.5){p=s*(1+f)}else{p=s+f-s*f}k=2*s-p;for(var g=0;g<3;g++){a=q+1/3*-(g-1);a<0&&a++;a>1&&a--;if(a*6<1){j[m[g]]=k+(p-k)*6*a}else{if(a*2<1){j[m[g]]=p}else{if(a*3<2){j[m[g]]=k+(p-k)*(2/3-a)*6}else{j[m[g]]=k}}}}}j.r*=255;j.g*=255;j.b*=255;j.hex="#"+(16777216|j.b|(j.g<<8)|(j.r<<16)).toString(16).slice(1);dx.is(n,"finite")&&(j.opacity=n);j.toString=cN;return j};dx.rgb2hsb=function(n,l,k){if(l==null&&dx.is(n,"object")&&"r" in n&&"g" in n&&"b" in n){k=n.b;l=n.g;n=n.r}if(l==null&&dx.is(n,c2)){var g=dx.getRGB(n);n=g.r;l=g.g;k=g.b}if(n>1||l>1||k>1){n/=255;l/=255;k/=255}var m=bO(n,l,k),j=ce(n,l,k),f,o,a=m;if(j==m){return{h:0,s:0,b:m,toString:dD}}else{var h=(m-j);o=h/m;if(n==m){f=(l-k)/h}else{if(l==m){f=2+((k-n)/h)}else{f=4+((n-l)/h)}}f/=6;f<0&&f++;f>1&&f--}return{h:f,s:o,b:a,toString:dD}};dx.rgb2hsl=function(m,k,n){if(k==null&&dx.is(m,"object")&&"r" in m&&"g" in m&&"b" in m){n=m.b;k=m.g;m=m.r}if(k==null&&dx.is(m,c2)){var g=dx.getRGB(m);m=g.r;k=g.g;n=g.b}if(m>1||k>1||n>1){m/=255;k/=255;n/=255}var a=bO(m,k,n),p=ce(m,k,n),f,h,o=(a+p)/2,j;if(p==a){j={h:0,s:0,l:o}}else{var l=a-p;h=o<0.5?l/(a+p):l/(2-a-p);if(m==a){f=(k-n)/l}else{if(k==a){f=2+(n-m)/l}else{f=4+(m-k)/l}}f/=6;f<0&&f++;f>1&&f--;j={h:f,s:h,l:o}}j.toString=cw;return j};dx._path2string=function(){return this.join(",")[b1](ct,"$1")};function dF(f,h,a){function g(){var l=Array[c4].slice.call(arguments,0),j=l[di]("\u25ba"),k=g.cache=g.cache||{},m=g.count=g.count||[];if(k[c0](j)){return a?a(k[j]):k[j]}m[bg]>=1000&&delete k[m.shift()];m[bQ](j);k[j]=f[da](h,l);return a?a(k[j]):k[j]}return g}dx.getRGB=dF(function(m){if(!m||!!((m=c8(m)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1}}if(m=="none"){return{r:-1,g:-1,b:-1,hex:"none"}}!(bN[c0](m.toLowerCase().substring(0,2))||m.charAt()=="#")&&(m=cv(m));var f,k,h,l,n,g,j,a=m.match(cD);if(a){if(a[2]){l=cl(a[2].substring(5),16);h=cl(a[2].substring(3,5),16);k=cl(a[2].substring(1,3),16)}if(a[3]){l=cl((g=a[3].charAt(3))+g,16);h=cl((g=a[3].charAt(2))+g,16);k=cl((g=a[3].charAt(1))+g,16)}if(a[4]){j=a[4][cA](co);k=cW(j[0]);j[0].slice(-1)=="%"&&(k*=2.55);h=cW(j[1]);j[1].slice(-1)=="%"&&(h*=2.55);l=cW(j[2]);j[2].slice(-1)=="%"&&(l*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(n=cW(j[3]));j[3]&&j[3].slice(-1)=="%"&&(n/=100)}if(a[5]){j=a[5][cA](co);k=cW(j[0]);j[0].slice(-1)=="%"&&(k*=2.55);h=cW(j[1]);j[1].slice(-1)=="%"&&(h*=2.55);l=cW(j[2]);j[2].slice(-1)=="%"&&(l*=2.55);(j[0].slice(-3)=="deg"||j[0].slice(-1)=="\xb0")&&(k/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(n=cW(j[3]));j[3]&&j[3].slice(-1)=="%"&&(n/=100);return dx.hsb2rgb(k,h,l,n)}if(a[6]){j=a[6][cA](co);k=cW(j[0]);j[0].slice(-1)=="%"&&(k*=2.55);h=cW(j[1]);j[1].slice(-1)=="%"&&(h*=2.55);l=cW(j[2]);j[2].slice(-1)=="%"&&(l*=2.55);(j[0].slice(-3)=="deg"||j[0].slice(-1)=="\xb0")&&(k/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(n=cW(j[3]));j[3]&&j[3].slice(-1)=="%"&&(n/=100);return dx.hsl2rgb(k,h,l,n)}a={r:k,g:h,b:l};a.hex="#"+(16777216|l|(h<<8)|(k<<16)).toString(16).slice(1);dx.is(n,"finite")&&(a.opacity=n);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},dx);dx.getColor=function(g){var f=this.getColor.start=this.getColor.start||{h:0,s:1,b:g||0.75},a=this.hsb2rgb(f.h,f.s,f.b);f.h+=0.075;if(f.h>1){f.h=0;f.s-=0.2;f.s<=0&&(this.getColor.start={h:0,s:1,b:f.b})}return a.hex};dx.getColor.reset=function(){delete this.start};dx.parsePathString=dF(function(a){if(!a){return null}var f={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},g=[];if(dx.is(a,dI)&&dx.is(a[0],dI)){g=dm(a)}if(!g[bg]){c8(a)[b1](dn,function(k,l,m){var h=[],j=cZ.call(l);m[b1](dz,function(n,o){o&&h[bQ](+o)});if(j=="m"&&h[bg]>2){g[bQ]([l][bV](h.splice(0,2)));j="l";l=l=="m"?"l":"L"}while(h[bg]>=f[j]){g[bQ]([l][bV](h.splice(0,f[j])));if(!f[j]){break}}})}g[dP]=dx._path2string;return g});dx.findDotsAtSegment=function(z,B,g,k,x,f,v,w,o){var q=1-o,s=b9(q,3)*z+b9(q,2)*3*o*g+q*3*o*o*x+b9(o,3)*v,u=b9(q,3)*B+b9(q,2)*3*o*k+q*3*o*o*f+b9(o,3)*w,m=z+2*o*(g-z)+o*o*(x-2*g+z),n=B+2*o*(k-B)+o*o*(f-2*k+B),h=g+2*o*(x-g)+o*o*(v-2*x+g),l=k+2*o*(f-k)+o*o*(w-2*f+k),p=(1-o)*z+o*g,t=(1-o)*B+o*k,j=(1-o)*x+o*v,y=(1-o)*f+o*w,a=(90-cR.atan((m-h)/(n-l))*180/dt);(m>h||n<l)&&(a+=180);return{x:s,y:u,m:{x:m,y:n},n:{x:h,y:l},start:{x:p,y:t},end:{x:j,y:y},alpha:a}};var cX=dF(function(g){if(!g){return{x:0,y:0,width:0,height:0}}g=ci(g);var l=0,n=0,p=[],m=[],k;for(var f=0,h=g[bg];f<h;f++){k=g[f];if(k[0]=="M"){l=k[1];n=k[2];p[bQ](l);m[bQ](n)}else{var a=dJ(l,n,k[1],k[2],k[3],k[4],k[5],k[6]);p=p[bV](a.min.x,a.max.x);m=m[bV](a.min.y,a.max.y);l=k[5];n=k[6]}}var o=ce[da](0,p),j=ce[da](0,m);return{x:o,y:j,width:bO[da](0,p)-o,height:bO[da](0,m)-j}}),dm=function(f){var j=[];if(!dx.is(f,dI)||!dx.is(f&&f[0],dI)){f=dx.parsePathString(f)}for(var k=0,h=f[bg];k<h;k++){j[k]=[];for(var a=0,g=f[k][bg];a<g;a++){j[k][a]=f[k][a]}}j[dP]=dx._path2string;return j},cJ=dF(function(v){if(!dx.is(v,dI)||!dx.is(v&&v[0],dI)){v=dx.parsePathString(v)}var n=[],l=0,m=0,f=0,h=0,p=0;if(v[0][0]=="M"){l=v[0][1];m=v[0][2];f=l;h=m;p++;n[bQ](["M",l,m])}for(var t=p,a=v[bg];t<a;t++){var u=n[t]=[],k=v[t];if(k[0]!=cZ.call(k[0])){u[0]=cZ.call(k[0]);switch(u[0]){case"a":u[1]=k[1];u[2]=k[2];u[3]=k[3];u[4]=k[4];u[5]=k[5];u[6]=+(k[6]-l).toFixed(3);u[7]=+(k[7]-m).toFixed(3);break;case"v":u[1]=+(k[1]-m).toFixed(3);break;case"m":f=k[1];h=k[2];default:for(var g=1,s=k[bg];g<s;g++){u[g]=+(k[g]-((g%2)?l:m)).toFixed(3)}}}else{u=n[t]=[];if(k[0]=="m"){f=k[1]+l;h=k[2]+m}for(var j=0,q=k[bg];j<q;j++){n[t][j]=k[j]}}var o=n[t][bg];switch(n[t][0]){case"z":l=f;m=h;break;case"h":l+=+n[t][o-1];break;case"v":m+=+n[t][o-1];break;default:l+=+n[t][o-2];m+=+n[t][o-1]}}n[dP]=dx._path2string;return n},0,dm),e=dF(function(u){if(!dx.is(u,dI)||!dx.is(u&&u[0],dI)){u=dx.parsePathString(u)}var n=[],l=0,m=0,g=0,j=0,o=0;if(u[0][0]=="M"){l=+u[0][1];m=+u[0][2];g=l;j=m;o++;n[0]=["M",l,m]}for(var s=o,a=u[bg];s<a;s++){var t=n[s]=[],k=u[s];if(k[0]!=b6.call(k[0])){t[0]=b6.call(k[0]);switch(t[0]){case"A":t[1]=k[1];t[2]=k[2];t[3]=k[3];t[4]=k[4];t[5]=k[5];t[6]=+(k[6]+l);t[7]=+(k[7]+m);break;case"V":t[1]=+k[1]+m;break;case"H":t[1]=+k[1]+l;break;case"M":g=+k[1]+l;j=+k[2]+m;default:for(var f=1,q=k[bg];f<q;f++){t[f]=+k[f]+((f%2)?l:m)}}}else{for(var h=0,p=k[bg];h<p;h++){n[s][h]=k[h]}}switch(t[0]){case"Z":l=g;m=j;break;case"H":l=t[1];break;case"V":m=t[1];break;case"M":g=n[s][n[s][bg]-2];j=n[s][n[s][bg]-1];default:l=n[s][n[s][bg]-2];m=n[s][n[s][bg]-1]}}n[dP]=dx._path2string;return n},null,dm),c5=function(h,f,a,g){return[h,f,a,g,a,g]},cc=function(l,j,f,h,a,k){var g=1/3,m=2/3;return[g*l+m*f,g*j+m*h,g*a+m*f,g*k+m*h,a,k]},dd=function(q,M,a,g,p,w,z,s,N,o){var h=dt*120/180,ac=dt/180*(+p||0),I=[],L,Q=dF(function(ah,ae,ad){var af=ah*cR.cos(ad)-ae*cR.sin(ad),ag=ah*cR.sin(ad)+ae*cR.cos(ad);return{x:af,y:ag}});if(!o){L=Q(q,M,-ac);q=L.x;M=L.y;L=Q(s,N,-ac);s=L.x;N=L.y;var ab=cR.cos(dt/180*p),u=cR.sin(dt/180*p),G=(q-s)/2,H=(M-N)/2;var U=(G*G)/(a*a)+(H*H)/(g*g);if(U>1){U=cR.sqrt(U);a=U*a;g=U*g}var aa=a*a,C=g*g,Z=(w==z?-1:1)*cR.sqrt(cP((aa*C-aa*H*H-C*G*G)/(aa*H*H+C*G*G))),k=Z*a*H/g+(q+s)/2,m=Z*-g*G/a+(M+N)/2,x=cR.asin(((M-m)/g).toFixed(9)),y=cR.asin(((N-m)/g).toFixed(9));x=q<k?dt-x:x;y=s<k?dt-y:y;x<0&&(x=dt*2+x);y<0&&(y=dt*2+y);if(z&&x>y){x=x-dt*2}if(!z&&y>x){y=y-dt*2}}else{x=o[0];y=o[1];k=o[2];m=o[3]}var t=y-x;if(cP(t)>h){var j=y,f=s,v=N;y=x+h*(z&&y>x?1:-1);s=k+a*cR.cos(y);N=m+g*cR.sin(y);I=dd(s,N,a,g,p,0,z,f,v,[y,j,k,m])}t=y-x;var l=cR.cos(x),O=cR.sin(x),n=cR.cos(y),P=cR.sin(y),F=cR.tan(t/4),B=4/3*a*F,D=4/3*g*F,T=[q,M],V=[q+B*O,M-D*l],W=[s+B*P,N-D*n],Y=[s,N];V[0]=2*T[0]-V[0];V[1]=2*T[1]-V[1];if(o){return[V,W,Y][bV](I)}else{I=[V,W,Y][bV](I)[di]()[cA](",");var K=[];for(var X=0,J=I[bg];X<J;X++){K[X]=X%2?Q(I[X-1],I[X],ac).y:Q(I[X],I[X+1],ac).x}return K}},c7=function(l,n,o,j,h,k,m,a,g){var f=1-g;return{x:b9(f,3)*l+b9(f,2)*3*g*o+f*3*g*g*h+b9(g,3)*m,y:b9(f,3)*n+b9(f,2)*3*g*j+f*3*g*g*k+b9(g,3)*a}},dJ=dF(function(v,t,j,k,a,f,l,o){var g=(a-2*j+v)-(l-2*a+j),m=2*(j-v)-2*(a-j),q=v-j,s=(-m+cR.sqrt(m*m-4*g*q))/2/g,u=(-m-cR.sqrt(m*m-4*g*q))/2/g,n=[t,o],h=[v,l],p;cP(s)>"1e12"&&(s=0.5);cP(u)>"1e12"&&(u=0.5);if(s>0&&s<1){p=c7(v,t,j,k,a,f,l,o,s);h[bQ](p.x);n[bQ](p.y)}if(u>0&&u<1){p=c7(v,t,j,k,a,f,l,o,u);h[bQ](p.x);n[bQ](p.y)}g=(f-2*k+t)-(o-2*f+k);m=2*(k-t)-2*(f-k);q=t-k;s=(-m+cR.sqrt(m*m-4*g*q))/2/g;u=(-m-cR.sqrt(m*m-4*g*q))/2/g;cP(s)>"1e12"&&(s=0.5);cP(u)>"1e12"&&(u=0.5);if(s>0&&s<1){p=c7(v,t,j,k,a,f,l,o,s);h[bQ](p.x);n[bQ](p.y)}if(u>0&&u<1){p=c7(v,t,j,k,a,f,l,o,u);h[bQ](p.x);n[bQ](p.y)}return{min:{x:ce[da](0,h),y:ce[da](0,n)},max:{x:bO[da](0,h),y:bO[da](0,n)}}}),ci=dF(function(a,m){var u=e(a),l=m&&e(m),k={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},t={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g=function(w,v){var x,y;if(!w){return["C",v.x,v.y,v.x,v.y,v.x,v.y]}!(w[0] in {T:1,Q:1})&&(v.qx=v.qy=null);switch(w[0]){case"M":v.X=w[1];v.Y=w[2];break;case"A":w=["C"][bV](dd[da](0,[v.x,v.y][bV](w.slice(1))));break;case"S":x=v.x+(v.x-(v.bx||v.x));y=v.y+(v.y-(v.by||v.y));w=["C",x,y][bV](w.slice(1));break;case"T":v.qx=v.x+(v.x-(v.qx||v.x));v.qy=v.y+(v.y-(v.qy||v.y));w=["C"][bV](cc(v.x,v.y,v.qx,v.qy,w[1],w[2]));break;case"Q":v.qx=w[1];v.qy=w[2];w=["C"][bV](cc(v.x,v.y,w[1],w[2],w[3],w[4]));break;case"L":w=["C"][bV](c5(v.x,v.y,w[1],w[2]));break;case"H":w=["C"][bV](c5(v.x,v.y,w[1],v.y));break;case"V":w=["C"][bV](c5(v.x,v.y,v.x,w[1]));break;case"Z":w=["C"][bV](c5(v.x,v.y,v.X,v.Y));break}return w},q=function(x,w){if(x[w][bg]>7){x[w].shift();var v=x[w];while(v[bg]){x.splice(w++,0,["C"][bV](v.splice(0,6)))}x.splice(w,1);j=bO(u[bg],l&&l[bg]||0)}},o=function(y,z,w,x,v){if(y&&z&&y[v][0]=="M"&&z[v][0]!="M"){z.splice(v,0,["M",x.x,x.y]);w.bx=0;w.by=0;w.x=y[v][1];w.y=y[v][2];j=bO(u[bg],l&&l[bg]||0)}};for(var p=0,j=bO(u[bg],l&&l[bg]||0);p<j;p++){u[p]=g(u[p],k);q(u,p);l&&(l[p]=g(l[p],t));l&&q(l,p);o(u,l,k,t,p);o(l,u,t,k,p);var s=u[p],f=l&&l[p],h=s[bg],n=l&&f[bg];k.x=s[h-2];k.y=s[h-1];k.bx=cW(s[h-4])||k.x;k.by=cW(s[h-3])||k.y;t.bx=l&&(cW(f[n-4])||t.x);t.by=l&&(cW(f[n-3])||t.y);t.x=l&&f[n-2];t.y=l&&f[n-1]}return l?[u,l]:u},null,dm),E=dF(function(h){var j=[];for(var a=0,g=h[bg];a<g;a++){var n={},l=h[a].match(/^([^:]*):?([\d\.]*)/);n.color=dx.getRGB(l[1]);if(n.color.error){return null}n.color=n.color.hex;l[2]&&(n.offset=l[2]+"%");j[bQ](n)}for(a=1,g=j[bg]-1;a<g;a++){if(!j[a].offset){var k=cW(j[a-1].offset||0),o=0;for(var f=a+1;f<g;f++){if(j[f].offset){o=j[f].offset;break}}if(!o){o=100;f=g}o=cW(o);var m=(o-k)/(f-a+1);for(;a<f;a++){k+=m;j[a].offset=k+"%"}}}return j}),dw=function(a,f,h,g){var j;if(dx.is(a,c2)||dx.is(a,"object")){j=dx.is(a,c2)?dc.getElementById(a):a;if(j.tagName){if(f==null){return{container:j,width:j.style.pixelWidth||j.offsetWidth,height:j.style.pixelHeight||j.offsetHeight}}else{return{container:j,width:f,height:h}}}}else{return{container:1,x:a,y:f,width:h,height:g}}},cm=function(a,g){var h=this;for(var f in g){if(g[c0](f)&&!(f in a)){switch(typeof g[f]){case"function":(function(j){a[f]=a===h?j:function(){return j[da](h,arguments)}})(g[f]);break;case"object":a[f]=a[f]||{};cm.call(this,a[f],g[f]);break;default:a[f]=g[f];break}}}},dB=function(a,f){a==f.top&&(f.top=a.prev);a==f.bottom&&(f.bottom=a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},cU=function(a,f){if(f.top===a){return}dB(a,f);a.next=null;a.prev=f.top;f.top.next=a;f.top=a},bL=function(a,f){if(f.bottom===a){return}dB(a,f);a.next=f.bottom;a.prev=null;f.bottom.prev=a;f.bottom=a},cz=function(g,a,f){dB(g,f);a==f.top&&(f.top=g);a.next&&(a.next.prev=g);g.next=a.next;g.prev=a;a.next=g},du=function(g,a,f){dB(g,f);a==f.bottom&&(f.bottom=g);a.prev&&(a.prev.next=g);g.prev=a.prev;a.prev=g;g.next=a},d=function(a){return function(){throw new Error("Rapha\xebl: you are calling to method \u201c"+a+"\u201d of removed object")}};dx.pathToRelative=cJ;if(dx.svg){b.svgns="http://www.w3.org/2000/svg";b.xlink="http://www.w3.org/1999/xlink";c6=function(a){return +a+(~~a===a)*0.5};var cf=function(f,a){if(a){for(var g in a){if(a[c0](g)){f[cI](g,c8(a[g]))}}}else{f=dc.createElementNS(b.svgns,f);f.style.webkitTapHighlightColor="rgba(0,0,0,0)";return f}};dx[dP]=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var A=function(a,f){var h=cf("path");f.canvas&&f.canvas[ca](h);var g=new dk(h,f);g.type="path";cS(g,{fill:"none",stroke:"#000",path:a});return g};var bU=function(v,g,u){var m="linear",s=0.5,h=0.5,a=v.style;g=c8(g)[b1](dr,function(z,x,y){m="radial";if(x&&y){s=cW(x);h=cW(y);var w=((h>0.5)*2-1);b9(s-0.5,2)+b9(h-0.5,2)>0.25&&(h=cR.sqrt(0.25-b9(s-0.5,2))*w+0.5)&&h!=0.5&&(h=h.toFixed(5)-0.00001*w)}return dq});g=g[cA](/\s*\-\s*/);if(m=="linear"){var t=g.shift();t=-cW(t);if(isNaN(t)){return null}var k=[0,0,cR.cos(t*dt/180),cR.sin(t*dt/180)],j=1/(bO(cP(k[2]),cP(k[3]))||1);k[2]*=j;k[3]*=j;if(k[2]<0){k[0]=-k[2];k[2]=0}if(k[3]<0){k[1]=-k[3];k[3]=0}}var n=E(g);if(!n){return null}var q=v.getAttribute(dL);q=q.match(/^url\(#(.*)\)$/);q&&u.defs.removeChild(dc.getElementById(q[1]));var p=cf(m+"Gradient");p.id=bR();cf(p,m=="radial"?{fx:s,fy:h}:{x1:k[0],y1:k[1],x2:k[2],y2:k[3]});u.defs[ca](p);for(var o=0,f=n[bg];o<f;o++){var l=cf("stop");cf(l,{offset:n[o].offset?n[o].offset:!o?"0%":"100%","stop-color":n[o].color||"#fff"});p[ca](l)}cf(v,{fill:"url(#"+p.id+")",opacity:1,"fill-opacity":1});a.fill=dq;a.opacity=1;a.fillOpacity=1;return 1};var c9=function(f){var a=f.getBBox();cf(f.pattern,{patternTransform:dx.format("translate({0},{1})",a.x,a.y)})};var cS=function(t,h){var p={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},n=t.node,s=t.attrs,w=t.rotate(),B=function(K,L){L=p[cZ.call(L)];if(L){var H=K.attrs["stroke-width"]||"1",J={round:H,square:H,butt:0}[K.attrs["stroke-linecap"]||h["stroke-linecap"]]||0,G=[];var I=L[bg];while(I--){G[I]=L[I]*H+((I%2)?1:-1)*J}cf(n,{"stroke-dasharray":G[di](",")})}};h[c0]("rotation")&&(w=h.rotation);var x=c8(w)[cA](b3);if(!(x.length-1)){x=null}else{x[1]=+x[1];x[2]=+x[2]}cW(w)&&t.rotate(0,true);for(var o in h){if(h[c0](o)){if(!bK[c0](o)){continue}var q=h[o];s[o]=q;switch(o){case"blur":t.blur(q);break;case"rotation":t.rotate(q,true);break;case"href":case"title":case"target":var k=n.parentNode;if(cZ.call(k.tagName)!="a"){var f=cf("a");k.insertBefore(f,n);f[ca](n);k=f}if(o=="target"&&q=="blank"){k.setAttributeNS(t.paper.xlink,"show","new")}else{k.setAttributeNS(t.paper.xlink,o,q)}break;case"cursor":n.style.cursor=q;break;case"clip-rect":var D=c8(q)[cA](b3);if(D[bg]>=4){t.clip&&t.clip.parentNode.parentNode.removeChild(t.clip.parentNode);var C=cf("clipPath"),l=cf("rect");C.id=bR();cf(l,{x:D[0],y:D[1],width:D[2],height:D[3],r:D[4]||0,rx:D[4]||0,ry:D[4]||0});C[ca](l);t.paper.defs[ca](C);cf(n,{"clip-path":"url(#"+C.id+")"});t.clip=l}if(!q){var j=dc.getElementById(n.getAttribute("clip-path")[b1](/(^url\(#|\)$)/g,dq));j&&j.parentNode.removeChild(j);cf(n,{"clip-path":dq});delete t.clip}break;case"path":if(t.type=="path"){cf(n,{d:q?s.path=e(q):"M0,0"})}break;case"width":n[cI](o,q);if(s.fx){o="x";q=s.x}else{break}case"x":if(s.fx){q=-s.x-(s.width||0)}case"rx":if(o=="rx"&&t.type=="rect"){break}case"cx":x&&(o=="x"||o=="cx")&&(x[1]+=q-s[o]);n[cI](o,q);t.pattern&&c9(t);break;case"height":n[cI](o,q);if(s.fy){o="y";q=s.y}else{break}case"y":if(s.fy){q=-s.y-(s.height||0)}case"ry":if(o=="ry"&&t.type=="rect"){break}case"cy":x&&(o=="y"||o=="cy")&&(x[2]+=q-s[o]);n[cI](o,q);t.pattern&&c9(t);break;case"r":if(t.type=="rect"){cf(n,{rx:q,ry:q})}else{n[cI](o,q)}break;case"src":if(t.type=="image"){n.setAttributeNS(t.paper.xlink,"href",q)}break;case"stroke-width":n.style.strokeWidth=q;n[cI](o,q);if(s["stroke-dasharray"]){B(t,s["stroke-dasharray"])}break;case"stroke-dasharray":B(t,q);break;case"translation":var z=c8(q)[cA](b3);z[0]=+z[0]||0;z[1]=+z[1]||0;if(x){x[1]+=z[0];x[2]+=z[1]}cO.call(t,z[0],z[1]);break;case"scale":z=c8(q)[cA](b3);t.scale(+z[0]||1,+z[1]||+z[0]||1,isNaN(cW(z[2]))?null:+z[2],isNaN(cW(z[3]))?null:+z[3]);break;case dL:var a=c8(q).match(bT);if(a){C=cf("pattern");var u=cf("image");C.id=bR();cf(C,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});cf(u,{x:0,y:0});u.setAttributeNS(t.paper.xlink,"href",a[1]);C[ca](u);var g=dc.createElement("img");g.style.cssText="position:absolute;left:-9999em;top-9999em";g.onload=function(){cf(C,{width:this.offsetWidth,height:this.offsetHeight});cf(u,{width:this.offsetWidth,height:this.offsetHeight});dc.body.removeChild(this);t.paper.safari()};dc.body[ca](g);g.src=a[1];t.paper.defs[ca](C);n.style.fill="url(#"+C.id+")";cf(n,{fill:"url(#"+C.id+")"});t.pattern=C;t.pattern&&c9(t);break}var m=dx.getRGB(q);if(!m.error){delete h.gradient;delete s.gradient;!dx.is(s.opacity,"undefined")&&dx.is(h.opacity,"undefined")&&cf(n,{opacity:s.opacity});!dx.is(s["fill-opacity"],"undefined")&&dx.is(h["fill-opacity"],"undefined")&&cf(n,{"fill-opacity":s["fill-opacity"]})}else{if((({circle:1,ellipse:1})[c0](t.type)||c8(q).charAt()!="r")&&bU(n,q,t.paper)){s.gradient=q;s.fill="none";break}}m[c0]("opacity")&&cf(n,{"fill-opacity":m.opacity>1?m.opacity/100:m.opacity});case"stroke":m=dx.getRGB(q);n[cI](o,m.hex);o=="stroke"&&m[c0]("opacity")&&cf(n,{"stroke-opacity":m.opacity>1?m.opacity/100:m.opacity});break;case"gradient":(({circle:1,ellipse:1})[c0](t.type)||c8(q).charAt()!="r")&&bU(n,q,t.paper);break;case"opacity":if(s.gradient&&!s[c0]("stroke-opacity")){cf(n,{"stroke-opacity":q>1?q/100:q})}case"fill-opacity":if(s.gradient){var F=dc.getElementById(n.getAttribute(dL)[b1](/^url\(#|\)$/g,dq));if(F){var y=F.getElementsByTagName("stop");y[y[bg]-1][cI]("stop-opacity",q)}break}default:o=="font-size"&&(q=cl(q,10)+"px");var v=o[b1](/(\-.)/g,function(G){return b6.call(G.substring(1))});n.style[v]=q;n[cI](o,q);break}}}cr(t,h);if(x){t.rotate(x.join(dy))}else{cW(w)&&t.rotate(w,true)}};var bM=1.2,cr=function(o,p){if(o.type!="text"||!(p[c0]("text")||p[c0]("font")||p[c0]("font-size")||p[c0]("x")||p[c0]("y"))){return}var j=o.attrs,m=o.node,g=m.firstChild&&m.firstChild.style["font-size"]!==""?cl(dc.defaultView.getComputedStyle(m.firstChild,dq).getPropertyValue("font-size"),10):cl(m.style["font-size"],10)||10;if(p[c0]("text")){j.text=p.text;while(m.firstChild){m.removeChild(m.firstChild)}var k=c8(p.text)[cA]("\n");for(var f=0,h=k[bg];f<h;f++){if(k[f]){var n=cf("tspan");f&&cf(n,{dy:g*bM,x:j.x});n[ca](dc.createTextNode(k[f]));m[ca](n)}}}else{k=m.getElementsByTagName("tspan");for(f=0,h=k[bg];f<h;f++){f&&cf(k[f],{dy:g*bM,x:j.x})}}cf(m,{y:j.y});var a=o.getBBox(),l=j.y-(a.y+a.height/2);l&&dx.is(l,"finite")&&cf(m,{y:j.y+l})},dk=function(h,a){var f=0,g=0;this[0]=h;this.id=dx._oid++;this.node=h;h.raphael=this;this.paper=a;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!a.bottom&&(a.bottom=this);this.prev=a.top;a.top&&(a.top.next=this);a.top=this;this.next=null};var cp=dk[c4];dk[c4].rotate=function(h,a,f){if(this.removed){return this}if(h==null){if(this._.rt.cx){return[this._.rt.deg,this._.rt.cx,this._.rt.cy][di](dy)}return this._.rt.deg}var g=this.getBBox();h=c8(h)[cA](b3);if(h[bg]-1){a=cW(h[1]);f=cW(h[2])}h=cW(h[0]);if(a!=null&&a!==false){this._.rt.deg=h}else{this._.rt.deg+=h}(f==null)&&(a=null);this._.rt.cx=a;this._.rt.cy=f;a=a==null?g.x+g.width/2:a;f=f==null?g.y+g.height/2:f;if(this._.rt.deg){this.transformations[0]=dx.format("rotate({0} {1} {2})",this._.rt.deg,a,f);this.clip&&cf(this.clip,{transform:dx.format("rotate({0} {1} {2})",-this._.rt.deg,a,f)})}else{this.transformations[0]=dq;this.clip&&cf(this.clip,{transform:dq})}cf(this.node,{transform:this.transformations[di](dy)});return this};dk[c4].hide=function(){!this.removed&&(this.node.style.display="none");return this};dk[c4].show=function(){!this.removed&&(this.node.style.display="");return this};dk[c4].remove=function(){if(this.removed){return}dB(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this){delete this[a]}this.removed=true};dk[c4].getBBox=function(){if(this.removed){return this}if(this.type=="path"){return cX(this.attrs.path)}if(this.node.style.display=="none"){this.show();var k=true}var f={};try{f=this.node.getBBox()}catch(h){}finally{f=f||{}}if(this.type=="text"){try{f={x:f.x,y:Infinity,width:0,height:0};for(var a=0,j=this.node.getNumberOfChars();a<j;a++){var g=this.node.getExtentOfChar(a);(g.y<f.y)&&(f.y=g.y);(g.y+g.height-f.y>f.height)&&(f.height=g.y+g.height-f.y);(g.x+g.width-f.x>f.width)&&(f.width=g.x+g.width-f.x)}}catch(h){}finally{f=f||{x:f.x,y:Infinity,width:0,height:0}}}k&&this.hide();return f};dk[c4].attr=function(o,k){if(this.removed){return this}if(o==null){var l={};for(var f in this.attrs){if(this.attrs[c0](f)){l[f]=this.attrs[f]}}this._.rt.deg&&(l.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(l.scale=this.scale());l.gradient&&l.fill=="none"&&(l.fill=l.gradient)&&delete l.gradient;return l}if(k==null&&dx.is(o,c2)){if(o=="translation"){return cO.call(this)}if(o=="rotation"){return this.rotate()}if(o=="scale"){return this.scale()}if(o==dL&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}return this.attrs[o]}if(k==null&&dx.is(o,dI)){var g={};for(var p=0,a=o.length;p<a;p++){g[o[p]]=this.attr(o[p])}return g}if(k!=null){var m={};m[o]=k}else{if(o!=null&&dx.is(o,"object")){m=o}}for(var h in this.paper.customAttributes){if(this.paper.customAttributes[c0](h)&&m[c0](h)&&dx.is(this.paper.customAttributes[h],"function")){var n=this.paper.customAttributes[h].apply(this,[][bV](m[h]));this.attrs[h]=m[h];for(var j in n){if(n[c0](j)){m[j]=n[j]}}}}cS(this,m);return this};dk[c4].toFront=function(){if(this.removed){return this}this.node.parentNode[ca](this.node);var a=this.paper;a.top!=this&&cU(this,a);return this};dk[c4].toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);bL(this,this.paper);var a=this.paper}return this};dk[c4].insertAfter=function(a){if(this.removed){return this}var f=a.node||a[a.length-1].node;if(f.nextSibling){f.parentNode.insertBefore(this.node,f.nextSibling)}else{f.parentNode[ca](this.node)}cz(this,a,this.paper);return this};dk[c4].insertBefore=function(a){if(this.removed){return this}var f=a.node||a[0].node;f.parentNode.insertBefore(this.node,f);du(this,a,this.paper);return this};dk[c4].blur=function(h){var a=this;if(+h!==0){var g=cf("filter"),f=cf("feGaussianBlur");a.attrs.blur=h;g.id=bR();cf(f,{stdDeviation:+h||1.5});g.appendChild(f);a.paper.defs.appendChild(g);a._blur=g;cf(a.node,{filter:"url(#"+g.id+")"})}else{if(a._blur){a._blur.parentNode.removeChild(a._blur);delete a._blur;delete a.attrs.blur}a.node.removeAttribute("filter")}};var c3=function(k,a,f,g){var h=cf("circle");k.canvas&&k.canvas[ca](h);var j=new dk(h,k);j.attrs={cx:a,cy:f,r:g,fill:"none",stroke:"#000"};j.type="circle";cf(h,j.attrs);return j},cq=function(k,f,m,l,g,a){var h=cf("rect");k.canvas&&k.canvas[ca](h);var j=new dk(h,k);j.attrs={x:f,y:m,width:l,height:g,r:a||0,rx:a||0,ry:a||0,fill:"none",stroke:"#000"};j.type="rect";cf(h,j.attrs);return j},dG=function(l,f,a,g,h){var j=cf("ellipse");l.canvas&&l.canvas[ca](j);var k=new dk(j,l);k.attrs={cx:f,cy:a,rx:g,ry:h,fill:"none",stroke:"#000"};k.type="ellipse";cf(j,k.attrs);return k},R=function(k,f,a,m,l,g){var h=cf("image");cf(h,{x:a,y:m,width:l,height:g,preserveAspectRatio:"none"});h.setAttributeNS(k.xlink,"href",f);k.canvas&&k.canvas[ca](h);var j=new dk(h,k);j.attrs={x:a,y:m,width:l,height:g,src:f};j.type="image";return j},cV=function(k,a,f,g){var h=cf("text");cf(h,{x:a,y:f,"text-anchor":"middle"});k.canvas&&k.canvas[ca](h);var j=new dk(h,k);j.attrs={x:a,y:f,"text-anchor":"middle",text:g,font:bK.font,"font-size":bK["font-size"],stroke:"none",fill:"#000"};j.type="text";cS(j,j.attrs);return j},db=function(f,a){this.width=f||this.width;this.height=a||this.height;this.canvas[cI]("width",this.width);this.canvas[cI]("height",this.height);return this},cG=function(){var j=dw[da](0,arguments),k=j&&j.container,l=j.x,f=j.y,h=j.width,a=j.height;if(!k){throw new Error("SVG container not found.")}var g=cf("svg");l=l||0;f=f||0;h=h||512;a=a||342;cf(g,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:h,height:a});if(k==1){g.style.cssText="position:absolute;left:"+l+"px;top:"+f+"px";dc.body[ca](g)}else{if(k.firstChild){k.insertBefore(g,k.firstChild)}else{k[ca](g)}}k=new de;k.width=h;k.height=a;k.canvas=g;cm.call(k,k,dx.fn);k.clear();return k};b.clear=function(){var a=this.canvas;while(a.firstChild){a.removeChild(a.firstChild)}this.bottom=this.top=null;this.desc=cf("desc");a[ca](this.desc);a[ca](this.defs=cf("defs"))};b.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=d(a)}}}if(dx.vml){var cu={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},ds=/([clmz]),?([^clmz]*)/gi,bS=/ progid:\S+Blur\([^\)]+\)/g,c1=/-?[^,\s-]+/g,dh=1000+dy+1000,S=10,a0={path:1,rect:1},ch=function(g){var l=/[ahqstv]/ig,k=e;c8(g).match(l)&&(k=ci);l=/[clmz]/g;if(k==e&&!c8(g).match(l)){var n=c8(g)[b1](ds,function(t,q,v){var s=[],w=cZ.call(q)=="m",u=cu[q];v[b1](c1,function(x){if(w&&s[bg]==2){u+=s+cu[q=="m"?"l":"L"];s=[]}s[bQ](c6(x*S))});return u+s});return n}var j=k(g),m,o;n=[];for(var f=0,h=j[bg];f<h;f++){m=j[f];o=cZ.call(j[f][0]);o=="z"&&(o="x");for(var p=1,a=m[bg];p<a;p++){o+=c6(m[p]*S)+(p!=a-1?",":dq)}n[bQ](o)}return n[di](dy)};dx[dP]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};A=function(k,l){var g=cC("group");g.style.cssText="position:absolute;left:0;top:0;width:"+l.width+"px;height:"+l.height+"px";g.coordsize=l.coordsize;g.coordorigin=l.coordorigin;var h=cC("shape"),j=h.style;j.width=l.width+"px";j.height=l.height+"px";h.coordsize=dh;h.coordorigin=l.coordorigin;g[ca](h);var f=new dk(h,g,l),a={fill:"none",stroke:"#000"};k&&(a.path=k);f.type="path";f.path=[];f.Path=dq;cS(f,a);l.canvas[ca](g);return f};cS=function(v,n){v.attrs=v.attrs||{};var q=v.node,m=v.attrs,y=q.style,k,o=(n.x!=m.x||n.y!=m.y||n.width!=m.width||n.height!=m.height||n.r!=m.r)&&v.type=="rect",g=v;for(var x in n){if(n[c0](x)){m[x]=n[x]}}if(o){m.path=cL(m.x,m.y,m.width,m.height,m.r);v.X=m.x;v.Y=m.y;v.W=m.width;v.H=m.height}n.href&&(q.href=n.href);n.title&&(q.title=n.title);n.target&&(q.target=n.target);n.cursor&&(y.cursor=n.cursor);"blur" in n&&v.blur(n.blur);if(n.path&&v.type=="path"||o){q.path=ch(m.path)}if(n.rotation!=null){v.rotate(n.rotation,true)}if(n.translation){k=c8(n.translation)[cA](b3);cO.call(v,k[0],k[1]);if(v._.rt.cx!=null){v._.rt.cx+=+k[0];v._.rt.cy+=+k[1];v.setBox(v.attrs,k[0],k[1])}}if(n.scale){k=c8(n.scale)[cA](b3);v.scale(+k[0]||1,+k[1]||+k[0]||1,+k[2]||null,+k[3]||null)}if("clip-rect" in n){var C=c8(n["clip-rect"])[cA](b3);if(C[bg]>=4){C[2]=+C[2]+(+C[0]);C[3]=+C[3]+(+C[1]);if(!C[4]){C[4]=0}var w=q.clipRect||dc.createElement("div"),h=w.style,a=q.parentNode;h.clip=dx.format("rect({1}px {2}px {3}px {0}px)",C);if(!q.clipRect){h.position="absolute";h.top=0;h.left=0;h.width=v.paper.width+"px";h.height=v.paper.height+"px";a.parentNode.insertBefore(w,a);w[ca](a);q.clipRect=w}}if(!n["clip-rect"]){q.clipRect&&(q.clipRect.style.clip=dq)}}if(v.type=="image"&&n.src){q.src=n.src}if(v.type=="image"&&n.opacity){q.filterOpacity=dK+".Alpha(opacity="+(n.opacity*100)+")";y.filter=(q.filterMatrix||dq)+(q.filterOpacity||dq)}n.font&&(y.font=n.font);n["font-family"]&&(y.fontFamily='"'+n["font-family"][cA](",")[0][b1](/^['"]+|['"]+$/g,dq)+'"');n["font-size"]&&(y.fontSize=n["font-size"]);n["font-weight"]&&(y.fontWeight=n["font-weight"]);n["font-style"]&&(y.fontStyle=n["font-style"]);if(n.opacity!=null||n["stroke-width"]!=null||n.fill!=null||n.stroke!=null||n["stroke-width"]!=null||n["stroke-opacity"]!=null||n["fill-opacity"]!=null||n["stroke-dasharray"]!=null||n["stroke-miterlimit"]!=null||n["stroke-linejoin"]!=null||n["stroke-linecap"]!=null){q=v.shape||q;var p=(q.getElementsByTagName(dL)&&q.getElementsByTagName(dL)[0]),l=false;!p&&(l=p=cC(dL));if("fill-opacity" in n||"opacity" in n){var B=((+m["fill-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+dx.getRGB(n.fill).o+1||2)-1);B=ce(bO(B,0),1);p.opacity=B}n.fill&&(p.on=true);if(p.on==null||n.fill=="none"){p.on=false}if(p.on&&n.fill){var z=n.fill.match(bT);if(z){p.src=z[1];p.type="tile"}else{p.color=dx.getRGB(n.fill).hex;p.src=dq;p.type="solid";if(dx.getRGB(n.fill).error&&(g.type in {circle:1,ellipse:1}||c8(n.fill).charAt()!="r")&&bU(g,n.fill)){m.fill="none";m.gradient=n.fill}}}l&&q[ca](p);var f=(q.getElementsByTagName("stroke")&&q.getElementsByTagName("stroke")[0]),j=false;!f&&(j=f=cC("stroke"));if((n.stroke&&n.stroke!="none")||n["stroke-width"]||n["stroke-opacity"]!=null||n["stroke-dasharray"]||n["stroke-miterlimit"]||n["stroke-linejoin"]||n["stroke-linecap"]){f.on=true}(n.stroke=="none"||f.on==null||n.stroke==0||n["stroke-width"]==0)&&(f.on=false);var s=dx.getRGB(n.stroke);f.on&&n.stroke&&(f.color=s.hex);B=((+m["stroke-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+s.o+1||2)-1);var u=(cW(n["stroke-width"])||1)*0.75;B=ce(bO(B,0),1);n["stroke-width"]==null&&(u=m["stroke-width"]);n["stroke-width"]&&(f.weight=u);u&&u<1&&(B*=u)&&(f.weight=1);f.opacity=B;n["stroke-linejoin"]&&(f.joinstyle=n["stroke-linejoin"]||"miter");f.miterlimit=n["stroke-miterlimit"]||8;n["stroke-linecap"]&&(f.endcap=n["stroke-linecap"]=="butt"?"flat":n["stroke-linecap"]=="square"?"square":"round");if(n["stroke-dasharray"]){var t={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};f.dashstyle=t[c0](n["stroke-dasharray"])?t[n["stroke-dasharray"]]:dq}j&&q[ca](f)}if(g.type=="text"){y=g.paper.span.style;m.font&&(y.font=m.font);m["font-family"]&&(y.fontFamily=m["font-family"]);m["font-size"]&&(y.fontSize=m["font-size"]);m["font-weight"]&&(y.fontWeight=m["font-weight"]);m["font-style"]&&(y.fontStyle=m["font-style"]);g.node.string&&(g.paper.span.innerHTML=c8(g.node.string)[b1](/</g,"&#60;")[b1](/&/g,"&#38;")[b1](/\n/g,"<br>"));g.W=m.w=g.paper.span.offsetWidth;g.H=m.h=g.paper.span.offsetHeight;g.X=m.x;g.Y=m.y+c6(g.H/2);switch(m["text-anchor"]){case"start":g.node.style["v-text-align"]="left";g.bbx=c6(g.W/2);break;case"end":g.node.style["v-text-align"]="right";g.bbx=-c6(g.W/2);break;default:g.node.style["v-text-align"]="center";break}}};bU=function(o,n){o.attrs=o.attrs||{};var l=o.attrs,h,f="linear",a=".5 .5";o.attrs.gradient=n;n=c8(n)[b1](dr,function(s,q,t){f="radial";if(q&&t){q=cW(q);t=cW(t);b9(q-0.5,2)+b9(t-0.5,2)>0.25&&(t=cR.sqrt(0.25-b9(q-0.5,2))*((t>0.5)*2-1)+0.5);a=q+dy+t}return dq});n=n[cA](/\s*\-\s*/);if(f=="linear"){var m=n.shift();m=-cW(m);if(isNaN(m)){return null}}var p=E(n);if(!p){return null}o=o.shape||o.node;h=o.getElementsByTagName(dL)[0]||cC(dL);!h.parentNode&&o.appendChild(h);if(p[bg]){h.on=true;h.method="none";h.color=p[0].color;h.color2=p[p[bg]-1].color;var g=[];for(var k=0,j=p[bg];k<j;k++){p[k].offset&&g[bQ](p[k].offset+dy+p[k].color)}h.colors&&(h.colors.value=g[bg]?g[di]():"0% "+h.color);if(f=="radial"){h.type="gradientradial";h.focus="100%";h.focussize=a;h.focusposition=a}else{h.type="gradient";h.angle=(270-m)%360}}return 1};dk=function(h,f,a){var g=0,k=0,l=0,j=1;this[0]=h;this.id=dx._oid++;this.node=h;h.raphael=this;this.X=0;this.Y=0;this.attrs={};this.Group=f;this.paper=a;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!a.bottom&&(a.bottom=this);this.prev=a.top;a.top&&(a.top.next=this);a.top=this;this.next=null};cp=dk[c4];cp.rotate=function(g,a,f){if(this.removed){return this}if(g==null){if(this._.rt.cx){return[this._.rt.deg,this._.rt.cx,this._.rt.cy][di](dy)}return this._.rt.deg}g=c8(g)[cA](b3);if(g[bg]-1){a=cW(g[1]);f=cW(g[2])}g=cW(g[0]);if(a!=null){this._.rt.deg=g}else{this._.rt.deg+=g}f==null&&(a=null);this._.rt.cx=a;this._.rt.cy=f;this.setBox(this.attrs,a,f);this.Group.style.rotation=this._.rt.deg;return this};cp.setBox=function(u,h,o){if(this.removed){return this}var t=this.Group.style,g=(this.shape&&this.shape.style)||this.node.style;u=u||{};for(var s in u){if(u[c0](s)){this.attrs[s]=u[s]}}h=h||this._.rt.cx;o=o||this._.rt.cy;var m=this.attrs,j,k,f,n;switch(this.type){case"circle":j=m.cx-m.r;k=m.cy-m.r;f=n=m.r*2;break;case"ellipse":j=m.cx-m.rx;k=m.cy-m.ry;f=m.rx*2;n=m.ry*2;break;case"image":j=+m.x;k=+m.y;f=m.width||0;n=m.height||0;break;case"text":this.textpath.v=["m",c6(m.x),", ",c6(m.y-2),"l",c6(m.x)+1,", ",c6(m.y-2)][di](dq);j=m.x-c6(this.W/2);k=m.y-this.H/2;f=this.W;n=this.H;break;case"rect":case"path":if(!this.attrs.path){j=0;k=0;f=this.paper.width;n=this.paper.height}else{var q=cX(this.attrs.path);j=q.x;k=q.y;f=q.width;n=q.height}break;default:j=0;k=0;f=this.paper.width;n=this.paper.height;break}h=(h==null)?j+f/2:h;o=(o==null)?k+n/2:o;var p=h-this.paper.width/2,l=o-this.paper.height/2,a;t.left!=(a=p+"px")&&(t.left=a);t.top!=(a=l+"px")&&(t.top=a);this.X=a0[c0](this.type)?-p:j;this.Y=a0[c0](this.type)?-l:k;this.W=f;this.H=n;if(a0[c0](this.type)){g.left!=(a=-p*S+"px")&&(g.left=a);g.top!=(a=-l*S+"px")&&(g.top=a)}else{if(this.type=="text"){g.left!=(a=-p+"px")&&(g.left=a);g.top!=(a=-l+"px")&&(g.top=a)}else{t.width!=(a=this.paper.width+"px")&&(t.width=a);t.height!=(a=this.paper.height+"px")&&(t.height=a);g.left!=(a=j-p+"px")&&(g.left=a);g.top!=(a=k-l+"px")&&(g.top=a);g.width!=(a=f+"px")&&(g.width=a);g.height!=(a=n+"px")&&(g.height=a)}}};cp.hide=function(){!this.removed&&(this.Group.style.display="none");return this};cp.show=function(){!this.removed&&(this.Group.style.display="block");return this};cp.getBBox=function(){if(this.removed){return this}if(a0[c0](this.type)){return cX(this.attrs.path)}return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};cp.remove=function(){if(this.removed){return}dB(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this){delete this[a]}this.removed=true};cp.attr=function(n,m){if(this.removed){return this}if(n==null){var a={};for(var o in this.attrs){if(this.attrs[c0](o)){a[o]=this.attrs[o]}}this._.rt.deg&&(a.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(a.scale=this.scale());a.gradient&&a.fill=="none"&&(a.fill=a.gradient)&&delete a.gradient;return a}if(m==null&&dx.is(n,"string")){if(n=="translation"){return cO.call(this)}if(n=="rotation"){return this.rotate()}if(n=="scale"){return this.scale()}if(n==dL&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}return this.attrs[n]}if(this.attrs&&m==null&&dx.is(n,dI)){var g,j={};for(o=0,g=n[bg];o<g;o++){j[n[o]]=this.attr(n[o])}return j}var l;if(m!=null){l={};l[n]=m}m==null&&dx.is(n,"object")&&(l=n);if(l){for(var k in this.paper.customAttributes){if(this.paper.customAttributes[c0](k)&&l[c0](k)&&dx.is(this.paper.customAttributes[k],"function")){var f=this.paper.customAttributes[k].apply(this,[][bV](l[k]));this.attrs[k]=l[k];for(var h in f){if(f[c0](h)){l[h]=f[h]}}}}if(l.text&&this.type=="text"){this.node.string=l.text}cS(this,l);if(l.gradient&&(({circle:1,ellipse:1})[c0](this.type)||c8(l.gradient).charAt()!="r")){bU(this,l.gradient)}(!a0[c0](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this};cp.toFront=function(){!this.removed&&this.Group.parentNode[ca](this.Group);this.paper.top!=this&&cU(this,this.paper);return this};cp.toBack=function(){if(this.removed){return this}if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);bL(this,this.paper)}return this};cp.insertAfter=function(a){if(this.removed){return this}if(a.constructor==cY){a=a[a.length-1]}if(a.Group.nextSibling){a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling)}else{a.Group.parentNode[ca](this.Group)}cz(this,a,this.paper);return this};cp.insertBefore=function(a){if(this.removed){return this}if(a.constructor==cY){a=a[0]}a.Group.parentNode.insertBefore(this.Group,a.Group);du(this,a,this.paper);return this};cp.blur=function(a){var g=this.node.runtimeStyle,f=g.filter;f=f.replace(bS,dq);if(+a!==0){this.attrs.blur=a;g.filter=f+dy+dK+".Blur(pixelradius="+(+a||1.5)+")";g.margin=dx.format("-{0}px 0 0 -{0}px",c6(+a||1.5))}else{g.filter=f;g.margin=0;delete this.attrs.blur}};c3=function(l,f,m,g){var h=cC("group"),a=cC("oval"),k=a.style;h.style.cssText="position:absolute;left:0;top:0;width:"+l.width+"px;height:"+l.height+"px";h.coordsize=dh;h.coordorigin=l.coordorigin;h[ca](a);var j=new dk(a,h,l);j.type="circle";cS(j,{stroke:"#000",fill:"none"});j.attrs.cx=f;j.attrs.cy=m;j.attrs.r=g;j.setBox({x:f-g,y:m-g,width:g*2,height:g*2});l.canvas[ca](h);return j};function cL(a,f,j,h,g){if(g){return dx.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+g,f,j-g*2,g,-g,h-g*2,g*2-j,g*2-h)}else{return dx.format("M{0},{1}l{2},0,0,{3},{4},0z",a,f,j,h,-j)}}cq=function(k,l,f,j,h,m){var g=cL(l,f,j,h,m),n=k.path(g),a=n.attrs;n.X=a.x=l;n.Y=a.y=f;n.W=a.width=j;n.H=a.height=h;a.r=m;a.path=g;n.type="rect";return n};dG=function(m,g,j,h,k){var f=cC("group"),n=cC("oval"),l=n.style;f.style.cssText="position:absolute;left:0;top:0;width:"+m.width+"px;height:"+m.height+"px";f.coordsize=dh;f.coordorigin=m.coordorigin;f[ca](n);var a=new dk(n,f,m);a.type="ellipse";cS(a,{stroke:"#000"});a.attrs.cx=g;a.attrs.cy=j;a.attrs.rx=h;a.attrs.ry=k;a.setBox({x:g-h,y:j-k,width:h*2,height:k*2});m.canvas[ca](f);return a};R=function(k,m,j,l,g,n){var f=cC("group"),h=cC("image");f.style.cssText="position:absolute;left:0;top:0;width:"+k.width+"px;height:"+k.height+"px";f.coordsize=dh;f.coordorigin=k.coordorigin;h.src=m;f[ca](h);var a=new dk(h,f,k);a.type="image";a.attrs.src=m;a.attrs.x=j;a.attrs.y=l;a.attrs.w=g;a.attrs.h=n;a.setBox({x:j,y:l,width:g,height:n});k.canvas[ca](f);return a};cV=function(m,k,l,h){var f=cC("group"),p=cC("shape"),n=p.style,g=cC("path"),o=g.style,j=cC("textpath");f.style.cssText="position:absolute;left:0;top:0;width:"+m.width+"px;height:"+m.height+"px";f.coordsize=dh;f.coordorigin=m.coordorigin;g.v=dx.format("m{0},{1}l{2},{1}",c6(k*10),c6(l*10),c6(k*10)+1);g.textpathok=true;n.width=m.width;n.height=m.height;j.string=c8(h);j.on=true;p[ca](j);p[ca](g);f[ca](p);var a=new dk(j,f,m);a.shape=p;a.textpath=g;a.type="text";a.attrs.text=h;a.attrs.x=k;a.attrs.y=l;a.attrs.w=1;a.attrs.h=1;cS(a,{font:bK.font,stroke:"none",fill:"#000"});a.setBox();m.canvas[ca](f);return a};db=function(f,a){var g=this.canvas.style;f==+f&&(f+="px");a==+a&&(a+="px");g.width=f;g.height=a;g.clip="rect(0 "+f+" "+a+" 0)";return this};var cC;dc.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!dc.namespaces.rvml&&dc.namespaces.add("rvml","urn:schemas-microsoft-com:vml");cC=function(a){return dc.createElement("<rvml:"+a+' class="rvml">')}}catch(cF){cC=function(a){return dc.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}cG=function(){var j=dw[da](0,arguments),n=j.container,h=j.height,g,l=j.width,k=j.x,m=j.y;if(!n){throw new Error("VML container not found.")}var f=new de,a=f.canvas=dc.createElement("div"),o=a.style;k=k||0;m=m||0;l=l||512;h=h||342;l==+l&&(l+="px");h==+h&&(h+="px");f.width=1000;f.height=1000;f.coordsize=S*1000+dy+S*1000;f.coordorigin="0 0";f.span=dc.createElement("span");f.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";a[ca](f.span);o.cssText=dx.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",l,h);if(n==1){dc.body[ca](a);o.left=k+"px";o.top=m+"px";o.position="absolute"}else{if(n.firstChild){n.insertBefore(a,n.firstChild)}else{n[ca](a)}}cm.call(f,f,dx.fn);return f};b.clear=function(){this.canvas.innerHTML=dq;this.span=dc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas[ca](this.span);this.bottom=this.top=null};b.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=d(a)}return true}}var cj=navigator.userAgent.match(/Version\/(.*?)\s/);if((navigator.vendor=="Apple Computer, Inc.")&&(cj&&cj[1]<4||navigator.platform.slice(0,2)=="iP")){b.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});dp.setTimeout(function(){a.remove()})}}else{b.safari=function(){}}var cs=function(){this.returnValue=false},bX=function(){return this.originalEvent.preventDefault()},dM=function(){this.cancelBubble=true},dC=function(){return this.originalEvent.stopPropagation()},cH=(function(){if(dc.addEventListener){return function(f,h,j,k){var a=cg&&b4[h]?b4[h]:h;var g=function(m){if(cg&&b4[c0](h)){for(var o=0,n=m.targetTouches&&m.targetTouches.length;o<n;o++){if(m.targetTouches[o].target==f){var l=m;m=m.targetTouches[o];m.originalEvent=l;m.preventDefault=bX;m.stopPropagation=dC;break}}}return j.call(k,m)};f.addEventListener(a,g,false);return function(){f.removeEventListener(a,g,false);return true}}}else{if(dc.attachEvent){return function(f,h,j,k){var g=function(l){l=l||dp.event;l.preventDefault=l.preventDefault||cs;l.stopPropagation=l.stopPropagation||dM;return j.call(k,l)};f.attachEvent("on"+h,g);var a=function(){f.detachEvent("on"+h,g);return true};return a}}}})(),dH=[],b2=function(a){var j=a.clientX,l=a.clientY,h=dc.documentElement.scrollTop||dc.body.scrollTop,g=dc.documentElement.scrollLeft||dc.body.scrollLeft,m,k=dH.length;while(k--){m=dH[k];if(cg){var f=a.touches.length,n;while(f--){n=a.touches[f];if(n.identifier==m.el._drag.id){j=n.clientX;l=n.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}}else{a.preventDefault()}j+=g;l+=h;m.move&&m.move.call(m.move_scope||m.el,j-m.el._drag.x,l-m.el._drag.y,j,l,a)}},bW=function(f){dx.unmousemove(b2).unmouseup(bW);var g=dH.length,a;while(g--){a=dH[g];a.el._drag={};a.end&&a.end.call(a.end_scope||a.start_scope||a.move_scope||a.el,f)}dH=[]};for(var cM=cn[bg];cM--;){(function(a){dx[a]=dk[c4][a]=function(f,g){if(dx.is(f,"function")){this.events=this.events||[];this.events.push({name:a,f:f,unbind:cH(this.shape||this.node||dc,a,f,g||this)})}return this};dx["un"+a]=dk[c4]["un"+a]=function(f){var g=this.events,h=g[bg];while(h--){if(g[h].name==a&&g[h].f==f){g[h].unbind();g.splice(h,1);!g.length&&delete this.events;return this}}return this}})(cn[cM])}cp.hover=function(f,a,g,h){return this.mouseover(f,g).mouseout(a,h||g)};cp.unhover=function(f,a){return this.unmouseover(f).unmouseout(a)};cp.drag=function(k,f,g,a,j,h){this._drag={};this.mousedown(function(n){(n.originalEvent||n).preventDefault();var l=dc.documentElement.scrollTop||dc.body.scrollTop,m=dc.documentElement.scrollLeft||dc.body.scrollLeft;this._drag.x=n.clientX+m;this._drag.y=n.clientY+l;this._drag.id=n.identifier;f&&f.call(j||a||this,n.clientX+m,n.clientY+l,n);!dH.length&&dx.mousemove(b2).mouseup(bW);dH.push({el:this,move:k,end:g,move_scope:a,start_scope:j,end_scope:h})});return this};cp.undrag=function(a,f,g){var h=dH.length;while(h--){dH[h].el==this&&(dH[h].move==a&&dH[h].end==g)&&dH.splice(h++,1)}!dH.length&&dx.unmousemove(b2).unmouseup(bW)};b.circle=function(a,f,g){return c3(this,a||0,f||0,g||0)};b.rect=function(a,f,j,h,g){return cq(this,a||0,f||0,j||0,h||0,g||0)};b.ellipse=function(a,f,g,h){return dG(this,a||0,f||0,g||0,h||0)};b.path=function(a){a&&!dx.is(a,c2)&&!dx.is(a[0],dI)&&(a+=dq);return A(dx.format[da](dx,arguments),this)};b.image=function(g,a,f,j,h){return R(this,g||"about:blank",a||0,f||0,j||0,h||0)};b.text=function(a,f,g){return cV(this,a||0,f||0,c8(g))};b.set=function(a){arguments[bg]>1&&(a=Array[c4].splice.call(arguments,0,arguments[bg]));return new cY(a)};b.setSize=db;b.top=b.bottom=null;b.raphael=dx;function cK(){return this.x+dy+this.y}cp.resetScale=function(){if(this.removed){return this}this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};cp.scale=function(K,L,o,q){if(this.removed){return this}if(K==null&&L==null){return{x:this._.sx,y:this._.sy,toString:cK}}L=L||K;!+L&&(L=K);var T,U,B,C,N=this.attrs;if(K!=0){var M=this.getBBox(),z=M.x+M.width/2,Q=M.y+M.height/2,F=cP(K/this._.sx),G=cP(L/this._.sy);o=(+o||o==0)?o:z;q=(+q||q==0)?q:Q;var w=this._.sx>0,x=this._.sy>0,p=~~(K/cP(K)),s=~~(L/cP(L)),l=F*p,n=G*s,J=this.node.style,a=o+cP(z-o)*l*(z>o==w?1:-1),f=q+cP(Q-q)*n*(Q>q==x?1:-1),j=(K*p>L*s?G:F);switch(this.type){case"rect":case"image":var u=N.width*F,h=N.height*G;this.attr({height:h,r:N.r*j,width:u,x:a-u/2,y:f-h/2});break;case"circle":case"ellipse":this.attr({rx:N.rx*F,ry:N.ry*G,r:N.r*j,cx:a,cy:f});break;case"text":this.attr({x:a,y:f});break;case"path":var H=cJ(N.path),v=true,k=w?l:F,m=x?n:G;for(var O=0,g=H[bg];O<g;O++){var D=H[O],t=b6.call(D[0]);if(t=="M"&&v){continue}else{v=false}if(t=="A"){D[H[O][bg]-2]*=k;D[H[O][bg]-1]*=m;D[1]*=F;D[2]*=G;D[5]=+(p+s?!!+D[5]:!+D[5])}else{if(t=="H"){for(var P=1,y=D[bg];P<y;P++){D[P]*=k}}else{if(t=="V"){for(P=1,y=D[bg];P<y;P++){D[P]*=m}}else{for(P=1,y=D[bg];P<y;P++){D[P]*=(P%2)?k:m}}}}}var I=cX(H);T=a-I.x-I.width/2;U=f-I.y-I.height/2;H[0][1]+=T;H[0][2]+=U;this.attr({path:H});break}if(this.type in {text:1,image:1}&&(p!=1||s!=1)){if(this.transformations){this.transformations[2]="scale("[bV](p,",",s,")");this.node[cI]("transform",this.transformations[di](dy));T=(p==-1)?-N.x-(u||0):N.x;U=(s==-1)?-N.y-(h||0):N.y;this.attr({x:T,y:U});N.fx=p-1;N.fy=s-1}else{this.node.filterMatrix=dK+".Matrix(M11="[bV](p,", M12=0, M21=0, M22=",s,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");J.filter=(this.node.filterMatrix||dq)+(this.node.filterOpacity||dq)}}else{if(this.transformations){this.transformations[2]=dq;this.node[cI]("transform",this.transformations[di](dy));N.fx=0;N.fy=0}else{this.node.filterMatrix=dq;J.filter=(this.node.filterMatrix||dq)+(this.node.filterOpacity||dq)}}N.scale=[K,L,o,q][di](dy);this._.sx=K;this._.sy=L}return this};cp.clone=function(){if(this.removed){return null}var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};var dN={},bP=function(k,t,q,s,a,f,g,l,j){var m=0,n=100,w=[k,t,q,s,a,f,g,l].join(),v=dN[w],u,p;!v&&(dN[w]=v={data:[]});v.timer&&clearTimeout(v.timer);v.timer=setTimeout(function(){delete dN[w]},2000);if(j!=null){var h=bP(k,t,q,s,a,f,g,l);n=~~h*10}for(var o=0;o<n+1;o++){if(v.data[j]>o){p=v.data[o*n]}else{p=dx.findDotsAtSegment(k,t,q,s,a,f,g,l,o/n);v.data[o]=p}o&&(m+=b9(b9(u.x-p.x,2)+b9(u.y-p.y,2),0.5));if(j!=null&&m>=j){return p}u=p}if(j==null){return m}},dO=function(a,f){return function(g,l,j){g=ci(g);var n,o,q,t,u="",h={},m,p=0;for(var s=0,k=g.length;s<k;s++){q=g[s];if(q[0]=="M"){n=+q[1];o=+q[2]}else{t=bP(n,o,q[1],q[2],q[3],q[4],q[5],q[6]);if(p+t>l){if(f&&!h.start){m=bP(n,o,q[1],q[2],q[3],q[4],q[5],q[6],l-p);u+=["C",m.start.x,m.start.y,m.m.x,m.m.y,m.x,m.y];if(j){return u}h.start=u;u=["M",m.x,m.y+"C",m.n.x,m.n.y,m.end.x,m.end.y,q[5],q[6]][di]();p+=t;n=+q[5];o=+q[6];continue}if(!a&&!f){m=bP(n,o,q[1],q[2],q[3],q[4],q[5],q[6],l-p);return{x:m.x,y:m.y,alpha:m.alpha}}}p+=t;n=+q[5];o=+q[6]}u+=q}h.end=u;m=a?p:f?h:dx.findDotsAtSegment(n,o,q[1],q[2],q[3],q[4],q[5],q[6],1);m.alpha&&(m={x:m.x,y:m.y,alpha:m.alpha});return m}};var dv=dO(1),cx=dO(),cb=dO(0,1);cp.getTotalLength=function(){if(this.type!="path"){return}if(this.node.getTotalLength){return this.node.getTotalLength()}return dv(this.attrs.path)};cp.getPointAtLength=function(a){if(this.type!="path"){return}return cx(this.attrs.path,a)};cp.getSubpath=function(f,g){if(this.type!="path"){return}if(cP(this.getTotalLength()-g)<"1e-6"){return cb(this.attrs.path,f).end}var a=cb(this.attrs.path,g,1);return f?cb(a,f).end:a};dx.easing_formulas={linear:function(a){return a},"<":function(a){return b9(a,3)},">":function(a){return b9(a-1,3)+1},"<>":function(a){a=a*2;if(a<1){return b9(a,3)/2}a-=2;return(b9(a,3)+2)/2},backIn:function(f){var a=1.70158;return f*f*((a+1)*f-a)},backOut:function(f){f=f-1;var a=1.70158;return f*f*((a+1)*f+a)+1},elastic:function(f){if(f==0||f==1){return f}var g=0.3,a=g/4;return b9(2,-10*f)*cR.sin((f-a)*(2*dt)/g)+1},bounce:function(f){var h=7.5625,g=2.75,a;if(f<(1/g)){a=h*f*f}else{if(f<(2/g)){f-=(1.5/g);a=h*f*f+0.75}else{if(f<(2.5/g)){f-=(2.25/g);a=h*f*f+0.9375}else{f-=(2.625/g);a=h*f*f+0.984375}}}return a}};var cd=[],bY=function(){var z=+new Date;for(var n=0;n<cd[bg];n++){var g=cd[n];if(g.stop||g.el.removed){continue}var f=z-g.start,q=g.ms,s=g.easing,l=g.from,u=g.diff,C=g.to,v=g.t,B=g.el,t={},D;if(f<q){var m=s(f/q);for(var p in l){if(l[c0](p)){switch(cT[p]){case"along":D=m*q*u[p];C.back&&(D=C.len-D);var o=cx(C[p],D);B.translate(u.sx-u.x||0,u.sy-u.y||0);u.x=o.x;u.y=o.y;B.translate(o.x-u.sx,o.y-u.sy);C.rot&&B.rotate(u.r+o.alpha,o.x,o.y);break;case dA:D=+l[p]+m*q*u[p];break;case"colour":D="rgb("+[cy(c6(l[p].r+m*q*u[p].r)),cy(c6(l[p].g+m*q*u[p].g)),cy(c6(l[p].b+m*q*u[p].b))][di](",")+")";break;case"path":D=[];for(var j=0,w=l[p][bg];j<w;j++){D[j]=[l[p][j][0]];for(var k=1,h=l[p][j][bg];k<h;k++){D[j][k]=+l[p][j][k]+m*q*u[p][j][k]}D[j]=D[j][di](dy)}D=D[di](dy);break;case"csv":switch(p){case"translation":var x=m*q*u[p][0]-v.x,y=m*q*u[p][1]-v.y;v.x+=x;v.y+=y;D=x+dy+y;break;case"rotation":D=+l[p][0]+m*q*u[p][0];l[p][1]&&(D+=","+l[p][1]+","+l[p][2]);break;case"scale":D=[+l[p][0]+m*q*u[p][0],+l[p][1]+m*q*u[p][1],(2 in C[p]?C[p][2]:dq),(3 in C[p]?C[p][3]:dq)][di](dy);break;case"clip-rect":D=[];j=4;while(j--){D[j]=+l[p][j]+m*q*u[p][j]}break}break;default:var a=[].concat(l[p]);D=[];j=B.paper.customAttributes[p].length;while(j--){D[j]=+a[j]+m*q*u[p][j]}break}t[p]=D}}B.attr(t);B._run&&B._run.call(B)}else{if(C.along){o=cx(C.along,C.len*!C.back);B.translate(u.sx-(u.x||0)+o.x-u.sx,u.sy-(u.y||0)+o.y-u.sy);C.rot&&B.rotate(u.r+o.alpha,o.x,o.y)}(v.x||v.y)&&B.translate(-v.x,-v.y);C.scale&&(C.scale+=dq);B.attr(C);cd.splice(n--,1)}}dx.svg&&B&&B.paper&&B.paper.safari();cd[bg]&&setTimeout(bY)},df=function(a,j,f,g,h){var k=f-g;j.timeouts.push(setTimeout(function(){dx.is(h,"function")&&h.call(j);j.animate(a,k,a.easing)},g))},cy=function(a){return bO(ce(a,255),0)},cO=function(a,f){if(a==null){return{x:this._.tx,y:this._.ty,toString:cK}}this._.tx+=+a;this._.ty+=+f;switch(this.type){case"circle":case"ellipse":this.attr({cx:+a+this.attrs.cx,cy:+f+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+a+this.attrs.x,y:+f+this.attrs.y});break;case"path":var g=cJ(this.attrs.path);g[0][1]+=+a;g[0][2]+=+f;this.attr({path:g});break}return this};cp.animateWith=function(k,h,f,a,g){for(var l=0,j=cd.length;l<j;l++){if(cd[l].el.id==k.id){h.start=cd[l].start}}return this.animate(h,f,a,g)};cp.animateAlong=dj();cp.animateAlongBack=dj(1);function dj(a){return function(h,j,k,f){var g={back:a};dx.is(k,"function")?(f=k):(g.rot=k);h&&h.constructor==dk&&(h=h.attrs.path);h&&(g.along=h);return this.animate(g,j,f)}}function dg(g,u,q,j,k,p){var o=3*u,l=3*(j-u)-o,t=1-o-l,s=3*q,m=3*(k-q)-s,a=1-s-m;function f(v){return((t*v+l)*v+o)*v}function n(x,v){var w=h(x,v);return((a*w+m)*w+s)*w}function h(x,y){var z,B,D,w,C,v;for(D=x,v=0;v<8;v++){w=f(D)-x;if(cP(w)<y){return D}C=(3*t*D+2*l)*D+o;if(cP(C)<0.000001){break}D=D-w/C}z=0;B=1;D=x;if(D<z){return z}if(D>B){return B}while(z<B){w=f(D);if(cP(w-x)<y){return D}if(x>w){z=D}else{B=D}D=(B-z)/2+z}return D}return n(g,1/(200*p))}cp.onAnimation=function(a){this._run=a||0;return this};cp.animate=function(h,u,v,f){var H=this;H.timeouts=H.timeouts||[];if(dx.is(v,"function")||!v){f=v||null}if(H.removed){f&&f.call(H);return H}var o={},G={},a=false,z={};for(var t in h){if(h[c0](t)){if(cT[c0](t)||H.paper.customAttributes[c0](t)){a=true;o[t]=H.attr(t);(o[t]==null)&&(o[t]=bK[t]);G[t]=h[t];switch(cT[t]){case"along":var k=dv(h[t]);var s=cx(h[t],k*!!h.back);var F=H.getBBox();z[t]=k/u;z.tx=F.x;z.ty=F.y;z.sx=s.x;z.sy=s.y;G.rot=h.rot;G.back=h.back;G.len=k;h.rot&&(z.r=cW(H.rotate())||0);break;case dA:z[t]=(G[t]-o[t])/u;break;case"colour":o[t]=dx.getRGB(o[t]);var q=dx.getRGB(G[t]);z[t]={r:(q.r-o[t].r)/u,g:(q.g-o[t].g)/u,b:(q.b-o[t].b)/u};break;case"path":var D=ci(o[t],G[t]);o[t]=D[0];var x=D[1];z[t]=[];for(var l=0,B=o[t][bg];l<B;l++){z[t][l]=[0];for(var m=1,j=o[t][l][bg];m<j;m++){z[t][l][m]=(x[l][m]-o[t][l][m])/u}}break;case"csv":var I=c8(h[t])[cA](b3),C=c8(o[t])[cA](b3);switch(t){case"translation":o[t]=[0,0];z[t]=[I[0]/u,I[1]/u];break;case"rotation":o[t]=(C[1]==I[1]&&C[2]==I[2])?C:[0,I[1],I[2]];z[t]=[(I[0]-o[t][0])/u,0,0];break;case"scale":h[t]=I;o[t]=c8(o[t])[cA](b3);z[t]=[(I[0]-o[t][0])/u,(I[1]-o[t][1])/u,0,0];break;case"clip-rect":o[t]=c8(o[t])[cA](b3);z[t]=[];l=4;while(l--){z[t][l]=(I[l]-o[t][l])/u}break}G[t]=I;break;default:I=[].concat(h[t]);C=[].concat(o[t]);z[t]=[];l=H.paper.customAttributes[t][bg];while(l--){z[t][l]=((I[l]||0)-(C[l]||0))/u}break}}}}if(!a){var w=[],p;for(var g in h){if(h[c0](g)&&ck.test(g)){t={value:h[g]};g=="from"&&(g=0);g=="to"&&(g=100);t.key=cl(g,10);w.push(t)}}w.sort(b8);if(w[0].key){w.unshift({key:0,value:H.attrs})}for(l=0,B=w[bg];l<B;l++){df(w[l].value,H,u/100*w[l].key,u/100*(w[l-1]&&w[l-1].key||0),w[l-1]&&w[l-1].value.callback)}p=w[w[bg]-1].value.callback;if(p){H.timeouts.push(setTimeout(function(){p.call(H)},u))}}else{var n=dx.easing_formulas[v];if(!n){n=c8(v).match(b0);if(n&&n[bg]==5){var y=n;n=function(J){return dg(J,+y[1],+y[2],+y[3],+y[4],u)}}else{n=function(J){return J}}}cd.push({start:h.start||+new Date,ms:u,easing:n,from:o,diff:z,to:G,el:H,t:{x:0,y:0}});dx.is(f,"function")&&(H._ac=setTimeout(function(){f.call(H)},u));cd[bg]==1&&setTimeout(bY)}return this};cp.stop=function(){for(var a=0;a<cd.length;a++){cd[a].el.id==this.id&&cd.splice(a--,1)}for(a=0,ii=this.timeouts&&this.timeouts.length;a<ii;a++){clearTimeout(this.timeouts[a])}this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};cp.translate=function(a,f){return this.attr({translation:a+" "+f})};cp[dP]=function(){return"Rapha\xebl\u2019s object"};dx.ae=cd;var cY=function(a){this.items=[];this[bg]=0;this.type="set";if(a){for(var g=0,f=a[bg];g<f;g++){if(a[g]&&(a[g].constructor==dk||a[g].constructor==cY)){this[this.items[bg]]=this.items[this.items[bg]]=a[g];this[bg]++}}}};cY[c4][bQ]=function(){var f,a;for(var h=0,g=arguments[bg];h<g;h++){f=arguments[h];if(f&&(f.constructor==dk||f.constructor==cY)){a=this.items[bg];this[a]=this.items[a]=f;this[bg]++}}return this};cY[c4].pop=function(){delete this[this[bg]--];return this.items.pop()};for(var cB in cp){if(cp[c0](cB)){cY[c4][cB]=(function(a){return function(){for(var g=0,f=this.items[bg];g<f;g++){this.items[g][a][da](this.items[g],arguments)}return this}})(cB)}}cY[c4].attr=function(k,f){if(k&&dx.is(k,dI)&&dx.is(k[0],"object")){for(var a=0,g=k[bg];a<g;a++){this.items[a].attr(k[a])}}else{for(var j=0,h=this.items[bg];j<h;j++){this.items[j].attr(k,f)}}return this};cY[c4].animate=function(k,m,a,j){(dx.is(a,"function")||!a)&&(j=a||null);var f=this.items[bg],h=f,g,l=this,n;j&&(n=function(){!--f&&j.call(l)});a=dx.is(a,c2)?a:n;g=this.items[--h].animate(k,m,a,n);while(h--){this.items[h]&&!this.items[h].removed&&this.items[h].animateWith(g,k,m,a,n)}return this};cY[c4].insertAfter=function(f){var a=this.items[bg];while(a--){this.items[a].insertAfter(f)}return this};cY[c4].getBBox=function(){var a=[],f=[],k=[],h=[];for(var j=this.items[bg];j--;){var g=this.items[j].getBBox();a[bQ](g.x);f[bQ](g.y);k[bQ](g.x+g.width);h[bQ](g.y+g.height)}a=ce[da](0,a);f=ce[da](0,f);return{x:a,y:f,width:bO[da](0,k)-a,height:bO[da](0,h)-f}};cY[c4].clone=function(f){f=new cY;for(var a=0,g=this.items[bg];a<g;a++){f[bQ](this.items[a].clone())}return f};dx.registerFont=function(l){if(!l.face){return l}this.fonts=this.fonts||{};var j={w:l.w,face:{},glyphs:{}},k=l.face["font-family"];for(var f in l.face){if(l.face[c0](f)){j.face[f]=l.face[f]}}if(this.fonts[k]){this.fonts[k][bQ](j)}else{this.fonts[k]=[j]}if(!l.svg){j.face["units-per-em"]=cl(l.face["units-per-em"],10);for(var h in l.glyphs){if(l.glyphs[c0](h)){var g=l.glyphs[h];j.glyphs[h]={w:g.w,k:{},d:g.d&&"M"+g.d[b1](/[mlcxtrv]/g,function(m){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[m]||"M"})+"z"};if(g.k){for(var a in g.k){if(g[c0](a)){j.glyphs[h].k[a]=g.k[a]}}}}}}return l};b.getFont=function(k,h,l,o){o=o||"normal";l=l||"normal";h=+h||{normal:400,bold:700,lighter:300,bolder:800}[h]||400;if(!dx.fonts){return}var f=dx.fonts[k];if(!f){var j=new RegExp("(^|\\s)"+k[b1](/[^\w\d\s+!~.:_-]/g,dq)+"(\\s|$)","i");for(var n in dx.fonts){if(dx.fonts[c0](n)){if(j.test(n)){f=dx.fonts[n];break}}}}var a;if(f){for(var m=0,g=f[bg];m<g;m++){a=f[m];if(a.face["font-weight"]==h&&(a.face["font-style"]==l||!a.face["font-style"])&&a.face["font-stretch"]==o){break}}}return a};b.print=function(f,g,y,u,t,j,x){j=j||"middle";x=bO(ce(x||0,1),-1);var n=this.set(),k=c8(y)[cA](dq),m=0,p=dq,h;dx.is(u,y)&&(u=this.getFont(u));if(u){h=(t||16)/u.face["units-per-em"];var w=u.face.bbox.split(b3),v=+w[0],s=+w[1]+(j=="baseline"?w[3]-w[1]+(+u.face.descent):(w[3]-w[1])/2);for(var o=0,a=k[bg];o<a;o++){var q=o&&u.glyphs[k[o-1]]||{},l=u.glyphs[k[o]];m+=o?(q.w||u.w)+(q.k&&q.k[k[o]]||0)+(u.w*x):0;l&&l.d&&n[bQ](this.path(l.d).attr({fill:"#000",stroke:"none",translation:[m,0]}))}n.scale(h,h,v,s).translate(f-v,g-s)}return n};dx.format=function(g,f){var a=dx.is(f,dI)?[0][bV](f):arguments;g&&dx.is(g,c2)&&a[bg]-1&&(g=g[b1](b7,function(h,j){return a[++j]==null?dq:a[j]}));return g||dq};dx.ninja=function(){bJ.was?(dp.Raphael=bJ.is):delete Raphael;return dx};dx.el=cp;dx.st=cY[c4];bJ.was?(dp.Raphael=dx):(Raphael=dx)})();(function(E){var y=typeof module!=="undefined"&&module.exports,J=function(a){return window[a]},I=J("punycode"),H=J("IPv6"),C=J("SecondLevelDomains"),B=function(b,a){if(!(this instanceof B)){return new B(b)}if(b===E){b=location.href+""}this.href(b);if(a!==E){return this.absoluteTo(a)}return this},v=B.prototype;function G(a){return a.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function x(a){return String(Object.prototype.toString.call(a))==="[object Array]"}function z(b,d){var a={},f,e;if(x(d)){for(f=0,e=d.length;f<e;f++){a[d[f]]=true}}else{a[d]=true}for(f=0,e=b.length;f<e;f++){if(a[b[f]]!==E){b.splice(f,1);e--;f--}}return b}B.idn_expression=/[^a-z0-9\.-]/i;B.punycode_expression=/(xn--)/i;B.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;B.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;B.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/ig;B.defaultPorts={http:"80",https:"443",ftp:"21"};B.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/;B.encode=encodeURIComponent;B.decode=decodeURIComponent;B.iso8859=function(){B.encode=escape;B.decode=unescape};B.unicode=function(){B.encode=encodeURIComponent;B.decode=decodeURIComponent};B.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}}};B.encodeQuery=function(a){return B.encode(a+"").replace(/%20/g,"+")};B.decodeQuery=function(a){return B.decode((a+"").replace(/\+/g,"%20"))};B.recodePath=function(d){var e=(d+"").split("/");for(var b=0,a=e.length;b<a;b++){e[b]=B.encodePathSegment(B.decode(e[b]))}return e.join("/")};B.decodePath=function(d){var e=(d+"").split("/");for(var b=0,a=e.length;b<a;b++){e[b]=B.decodePathSegment(e[b])}return e.join("/")};var F={encode:"encode",decode:"decode"},D,A=function(a){return function(b){return B[a](b+"").replace(B.characters.pathname[a].expression,function(d){return B.characters.pathname[a].map[d]})}};for(D in F){B[D+"PathSegment"]=A(F[D])}B.parse=function(e){var a,d,b={};a=e.indexOf("#");if(a>-1){b.fragment=e.substring(a+1)||null;e=e.substring(0,a)}a=e.indexOf("?");if(a>-1){b.query=e.substring(a+1)||null;e=e.substring(0,a)}if(e.substring(0,2)==="//"){b.protocol="";e=e.substring(2);e=B.parseAuthority(e,b)}else{a=e.indexOf(":");if(a>-1){b.protocol=e.substring(0,a);if(e.substring(a+1,a+3)==="//"){e=e.substring(a+3);e=B.parseAuthority(e,b)}else{e=e.substring(a+1);b.urn=true}}}b.path=e;return b};B.parseHost=function(f,d){var a=f.indexOf("/"),e;if(a===-1){a=f.length}if(f[0]==="["){var b=f.indexOf("]");d.hostname=f.substring(1,b)||null;d.port=f.substring(b+2,a)||null}else{if(f.indexOf(":")!==f.lastIndexOf(":")){d.hostname=f.substring(0,a)||null;d.port=null}else{e=f.substring(0,a).split(":");d.hostname=e[0]||null;d.port=e[1]||null}}if(d.hostname&&f.substring(a)[0]!=="/"){a++;f="/"+f}return f.substring(a)||"/"};B.parseAuthority=function(b,a){b=B.parseUserinfo(b,a);return B.parseHost(b,a)};B.parseUserinfo=function(e,b){var a=e.indexOf("@"),f=e.indexOf("/"),d;if(a>-1&&(f===-1||a<f)){d=e.substring(0,a).split(":");b.username=d[0]?B.decode(d[0]):null;b.password=d[1]?B.decode(d[1]):null;e=e.substring(a+1)}else{b.username=null;b.password=null}return e};B.parseQuery=function(a){if(!a){return{}}a=a.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"");if(!a){return{}}var d={},g=a.split("&"),f=g.length;for(var j=0;j<f;j++){var e=g[j].split("="),b=B.decodeQuery(e.shift()),h=e.length?B.decodeQuery(e.join("=")):null;if(d[b]){if(typeof d[b]==="string"){d[b]=[d[b]]}d[b].push(h)}else{d[b]=h}}return d};B.build=function(a){var b="";if(a.protocol){b+=a.protocol+":"}if(!a.urn&&(b||a.hostname)){b+="//"}b+=(B.buildAuthority(a)||"");if(typeof a.path==="string"){if(a.path[0]!=="/"&&typeof a.hostname==="string"){b+="/"}b+=a.path}if(typeof a.query=="string"){b+="?"+a.query}if(typeof a.fragment==="string"){b+="#"+a.fragment}return b};B.buildHost=function(a){var b="";if(!a.hostname){return""}else{if(B.ip6_expression.test(a.hostname)){if(a.port){b+="["+a.hostname+"]:"+a.port}else{b+=a.hostname}}else{b+=a.hostname;if(a.port){b+=":"+a.port}}}return b};B.buildAuthority=function(a){return B.buildUserinfo(a)+B.buildHost(a)};B.buildUserinfo=function(a){var b="";if(a.username){b+=B.encode(a.username);if(a.password){b+=":"+B.encode(a.password)}b+="@"}return b};B.buildQuery=function(a,g){var d="";for(var e in a){if(Object.hasOwnProperty.call(a,e)&&e){if(x(a[e])){var h={};for(var f=0,b=a[e].length;f<b;f++){if(a[e][f]!==E&&h[a[e][f]+""]===E){d+="&"+B.buildQueryParameter(e,a[e][f]);if(g!==true){h[a[e][f]+""]=true}}}}else{if(a[e]!==E){d+="&"+B.buildQueryParameter(e,a[e])}}}}return d.substring(1)};B.buildQueryParameter=function(b,a){return B.encodeQuery(b)+(a!==null?"="+B.encodeQuery(a):"")};B.addQuery=function(a,e,b){if(typeof e==="object"){for(var d in e){if(Object.prototype.hasOwnProperty.call(e,d)){B.addQuery(a,d,e[d])}}}else{if(typeof e==="string"){if(a[e]===E){a[e]=b;return}else{if(typeof a[e]==="string"){a[e]=[a[e]]}}if(!x(b)){b=[b]}a[e]=a[e].concat(b)}else{throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")}}};B.removeQuery=function(g,f,a){if(x(f)){for(var d=0,b=f.length;d<b;d++){g[f[d]]=E}}else{if(typeof f==="object"){for(var e in f){if(Object.prototype.hasOwnProperty.call(f,e)){B.removeQuery(g,e,f[e])}}}else{if(typeof f==="string"){if(a!==E){if(g[f]===a){g[f]=E}else{if(x(g[f])){g[f]=z(g[f],a)}}}else{g[f]=E}}else{throw new TypeError("URI.addQuery() accepts an object, string as the first parameter")}}}};B.commonPath=function(d,e){var b=Math.min(d.length,e.length),a;for(a=0;a<b;a++){if(d[a]!==e[a]){a--;break}}if(a<1){return d[0]===e[0]&&d[0]==="/"?"/":""}if(d[a]!=="/"){a=d.substring(0,a).lastIndexOf("/")}return d.substring(0,a+1)};B.withinString=function(b,a){return b.replace(B.find_uri_expression,a)};B.ensureValidHostname=function(a){if(a.match(B.invalid_hostname_characters)){if(!I){throw new TypeError("Hostname '"+a+"' contains characters other than [A-Z0-9.-] and Punycode.js is not available")}if(I.toASCII(a).match(B.invalid_hostname_characters)){throw new TypeError("Hostname '"+a+"' contains characters other than [A-Z0-9.-]")}}};v.build=function(a){if(a===true){this._deferred_build=true}else{if(a===E||this._deferred_build){this._string=B.build(this._parts);this._deferred_build=false}}return this};v.toString=function(){return this.build(false)._string};v.valueOf=function(){return this.toString()};F={protocol:"protocol",username:"username",password:"password",hostname:"hostname",port:"port"};A=function(a){return function(d,b){if(d===E){return this._parts[a]||""}else{this._parts[a]=d;this.build(!b);return this}}};for(D in F){v[D]=A(F[D])}F={query:"?",fragment:"#"};A=function(b,a){return function(e,d){if(e===E){return this._parts[b]||""}else{if(e!==null){e=e+"";if(e[0]===a){e=e.substring(1)}}this._parts[b]=e;this.build(!d);return this}}};for(D in F){v[D]=A(D,F[D])}F={search:["?","query"],hash:["#","fragment"]};A=function(b,a){return function(e,f){var d=this[b](e,f);return typeof d==="string"&&d.length?(a+d):d}};for(D in F){v[D]=A(F[D][1],F[D][0])}v.pathname=function(d,a){if(d===E||d===true){var b=this._parts.path||(this._parts.urn?"":"/");return d?B.decodePath(b):b}else{this._parts.path=d?B.recodePath(d):"/";this.build(!a);return this}};v.path=v.pathname;v.href=function(f,g){if(f===E){return this.toString()}else{this._string="";this._parts={protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null};var d=f instanceof B,b=typeof f==="object"&&(f.hostname||f.path),e;if(typeof f==="string"){this._parts=B.parse(f)}else{if(d||b){var a=d?f._parts:f;for(e in a){if(Object.hasOwnProperty.call(this._parts,e)){this._parts[e]=a[e]}}}else{throw new TypeError("invalid input")}}this.build(!g);return this}};v.is=function(a){var g=false,f=false,h=false,k=false,b=false,j=false,e=false,d=!this._parts.urn;if(this._parts.hostname){d=false;f=B.ip4_expression.test(this._parts.hostname);h=B.ip6_expression.test(this._parts.hostname);g=f||h;k=!g;b=k&&C&&C.has(this._parts.hostname);j=k&&B.idn_expression.test(this._parts.hostname);e=k&&B.punycode_expression.test(this._parts.hostname)}switch(a.toLowerCase()){case"relative":return d;case"absolute":return !d;case"domain":case"name":return k;case"sld":return b;case"ip":return g;case"ip4":case"ipv4":case"inet4":return f;case"ip6":case"ipv6":case"inet6":return h;case"idn":return j;case"url":return !this._parts.urn;case"urn":return !!this._parts.urn;case"punycode":return e}return null};var p=v.protocol,K=v.port,q=v.hostname;v.protocol=function(b,a){if(b!==E){if(b){b=b.replace(/:(\/\/)?$/,"");if(b.match(/[^a-zA-z0-9\.+-]/)){throw new TypeError("Protocol '"+b+"' contains characters other than [A-Z0-9.+-]")}}}return p.call(this,b,a)};v.scheme=v.protocol;v.port=function(b,a){if(this._parts.urn){return b===E?"":this}if(b!==E){if(b===0){b=null}if(b){b+="";if(b[0]===":"){b=b.substring(1)}if(b.match(/[^0-9]/)){throw new TypeError("Port '"+b+"' contains characters other than [0-9]")}}}return K.call(this,b,a)};v.hostname=function(b,a){if(this._parts.urn){return b===E?"":this}if(b!==E){var d={};B.parseHost(b,d);b=d.hostname}return q.call(this,b,a)};v.host=function(b,a){if(this._parts.urn){return b===E?"":this}if(b===E){return this._parts.hostname?B.buildHost(this._parts):""}else{B.parseHost(b,this._parts);this.build(!a);return this}};v.authority=function(b,a){if(this._parts.urn){return b===E?"":this}if(b===E){return this._parts.hostname?B.buildAuthority(this._parts):""}else{B.parseAuthority(b,this._parts);this.build(!a);return this}};v.userinfo=function(d,a){if(this._parts.urn){return d===E?"":this}if(d===E){if(!this._parts.username){return""}var b=B.buildUserinfo(this._parts);return b.substring(0,b.length-1)}else{if(d[d.length-1]!=="@"){d+="@"}B.parseUserinfo(d,this._parts);this.build(!a);return this}};v.subdomain=function(d,f){if(this._parts.urn){return d===E?"":this}if(d===E){if(!this._parts.hostname||this.is("IP")){return""}var e=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,e)||""}else{var g=this._parts.hostname.length-this.domain().length,a=this._parts.hostname.substring(0,g),b=new RegExp("^"+G(a));if(d&&d[d.length-1]!=="."){d+="."}if(d){B.ensureValidHostname(d)}this._parts.hostname=this._parts.hostname.replace(b,d);this.build(!f);return this}};v.domain=function(d,f){if(this._parts.urn){return d===E?"":this}if(typeof d=="boolean"){f=d;d=E}if(d===E){if(!this._parts.hostname||this.is("IP")){return""}var a=this._parts.hostname.match(/\./g);if(!a){return this._parts.hostname}if(a.length<2){return this._parts.hostname}var e=this._parts.hostname.length-this.tld(f).length-1;e=this._parts.hostname.lastIndexOf(".",e-1)+1;return this._parts.hostname.substring(e)||""}else{if(!d){throw new TypeError("cannot set domain empty")}B.ensureValidHostname(d);if(!this._parts.hostname||this.is("IP")){this._parts.hostname=d}else{var b=new RegExp(G(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(b,d)}this.build(!f);return this}};v.tld=function(e,a){if(this._parts.urn){return e===E?"":this}if(typeof e=="boolean"){a=e;e=E}if(e===E){if(!this._parts.hostname||this.is("IP")){return""}var f=this._parts.hostname.lastIndexOf("."),d=this._parts.hostname.substring(f+1);if(a!==true&&C&&C.list[d.toLowerCase()]){return C.get(this._parts.hostname)||d}return d}else{var b;if(!e){throw new TypeError("cannot set TLD empty")}else{if(e.match(/[^a-zA-Z0-9-]/)){if(C&&C.is(e)){b=new RegExp(G(this.tld())+"$");this._parts.hostname=this._parts.hostname.replace(b,e)}else{throw new TypeError("TLD '"+e+"' contains characters other than [A-Z0-9]")}}else{if(!this._parts.hostname||this.is("IP")){throw new ReferenceError("cannot set TLD on non-domain host")}else{b=new RegExp(G(this.tld())+"$");this._parts.hostname=this._parts.hostname.replace(b,e)}}}this.build(!a);return this}};v.directory=function(b,h){if(this._parts.urn){return b===E?"":this}if(b===E||b===true){if(!this._parts.path||this._parts.path==="/"){return"/"}var d=this._parts.path.length-this.filename().length-1,g=this._parts.path.substring(0,d)||"/";return b?B.decodePath(g):g}else{var f=this._parts.path.length-this.filename().length,e=this._parts.path.substring(0,f),a=new RegExp("^"+G(e));if(!this.is("relative")){if(!b){b="/"}if(b[0]!=="/"){b="/"+b}}if(b&&b[b.length-1]!=="/"){b+="/"}b=B.recodePath(b);this._parts.path=this._parts.path.replace(a,b);this.build(!h);return this}};v.filename=function(d,g){if(this._parts.urn){return d===E?"":this}if(d===E||d===true){if(!this._parts.path||this._parts.path==="/"){return""}var f=this._parts.path.lastIndexOf("/"),a=this._parts.path.substring(f+1);return d?B.decodePathSegment(a):a}else{var e=false;if(d[0]==="/"){d=d.substring(1)}if(d.match(/\.?\//)){e=true}var b=new RegExp(G(this.filename())+"$");d=B.recodePath(d);this._parts.path=this._parts.path.replace(b,d);if(e){this.normalizePath(g)}else{this.build(!g)}return this}};v.suffix=function(d,j){if(this._parts.urn){return d===E?"":this}if(d===E||d===true){if(!this._parts.path||this._parts.path==="/"){return""}var e=this.filename(),g=e.lastIndexOf("."),h,a;if(g===-1){return""}h=e.substring(g+1);a=(/^[a-z0-9%]+$/i).test(h)?h:"";return d?B.decodePathSegment(a):a}else{if(d[0]==="."){d=d.substring(1)}var f=this.suffix(),b;if(!f){if(!d){return this}this._parts.path+="."+B.recodePath(d)}else{if(!d){b=new RegExp(G("."+f)+"$")}else{b=new RegExp(G(f)+"$")}}if(b){d=B.recodePath(d);this._parts.path=this._parts.path.replace(b,d)}this.build(!j);return this}};var w=v.query;v.query=function(b,a){if(b===true){return B.parseQuery(this._parts.query)}else{if(b!==E&&typeof b!=="string"){this._parts.query=B.buildQuery(b);this.build(!a);return this}else{return w.call(this,b,a)}}};v.addQuery=function(e,b,a){var d=B.parseQuery(this._parts.query);B.addQuery(d,e,b);this._parts.query=B.buildQuery(d);if(typeof e!=="string"){a=b}this.build(!a);return this};v.removeQuery=function(e,b,a){var d=B.parseQuery(this._parts.query);B.removeQuery(d,e,b);this._parts.query=B.buildQuery(d);if(typeof e!=="string"){a=b}this.build(!a);return this};v.addSearch=v.addQuery;v.removeSearch=v.removeQuery;v.normalize=function(){if(this._parts.urn){return this.normalizeProtocol(false).normalizeQuery(false).normalizeFragment(false).build()}return this.normalizeProtocol(false).normalizeHostname(false).normalizePort(false).normalizePath(false).normalizeQuery(false).normalizeFragment(false).build()};v.normalizeProtocol=function(a){if(typeof this._parts.protocol==="string"){this._parts.protocol=this._parts.protocol.toLowerCase();this.build(!a)}return this};v.normalizeHostname=function(a){if(this._parts.hostname){if(this.is("IDN")&&I){this._parts.hostname=I.toASCII(this._parts.hostname)}else{if(this.is("IPv6")&&H){this._parts.hostname=H.best(this._parts.hostname)}}this._parts.hostname=this._parts.hostname.toLowerCase();this.build(!a)}return this};v.normalizePort=function(a){if(typeof this._parts.protocol==="string"&&this._parts.port===B.defaultPorts[this._parts.protocol]){this._parts.port=null;this.build(!a)}return this};v.normalizePath=function(g){if(this._parts.urn){return this}if(!this._parts.path||this._parts.path==="/"){return this}var d,e,b=this._parts.path,a,f;if(b[0]!=="/"){if(b[0]==="."){e=b.substring(0,b.indexOf("/"))}d=true;b="/"+b}b=b.replace(/(\/(\.\/)+)|\/{2,}/g,"/");while(true){a=b.indexOf("/../");if(a===-1){break}else{if(a===0){b=b.substring(3);break}}f=b.substring(0,a).lastIndexOf("/");if(f===-1){f=a}b=b.substring(0,f)+b.substring(a+3)}if(d&&this.is("relative")){if(e){b=e+b}else{b=b.substring(1)}}b=B.recodePath(b);this._parts.path=b;this.build(!g);return this};v.normalizePathname=v.normalizePath;v.normalizeQuery=function(a){if(typeof this._parts.query==="string"){if(!this._parts.query.length){this._parts.query=null}else{this.query(B.parseQuery(this._parts.query))}this.build(!a)}return this};v.normalizeFragment=function(a){if(!this._parts.fragment){this._parts.fragment=null;this.build(!a)}return this};v.normalizeSearch=v.normalizeQuery;v.normalizeHash=v.normalizeFragment;v.iso8859=function(){var b=B.encode,a=B.decode;B.encode=escape;B.decode=decodeURIComponent;this.normalize();B.encode=b;B.decode=a;return this};v.unicode=function(){var b=B.encode,a=B.decode;B.encode=encodeURIComponent;B.decode=unescape;this.normalize();B.encode=b;B.decode=a;return this};v.readable=function(){var h=new B(this);h.username("").password("").normalize();var a="";if(h._parts.protocol){a+=h._parts.protocol+"://"}if(h._parts.hostname){if(h.is("punycode")&&I){a+=I.toUnicode(h._parts.hostname);if(h._parts.port){a+=":"+h._parts.port}}else{a+=h.host()}}if(h._parts.hostname&&h._parts.path&&h._parts.path[0]!=="/"){a+="/"}a+=h.path(true);if(h._parts.query){var g="";for(var b=0,d=h._parts.query.split("&"),e=d.length;b<e;b++){var f=(d[b]||"").split("=");g+="&"+B.decodeQuery(f[0]).replace(/&/g,"%26");if(f[1]!==E){g+="="+B.decodeQuery(f[1]).replace(/&/g,"%26")}}a+="?"+g.substring(1)}a+=h.hash();return a};v.absoluteTo=function(a){if(this._parts.urn){throw new Error("URNs do not have any generally defined hierachical components")}if(!this.is("relative")){throw new Error("Cannot resolve non-relative URL")}if(!(a instanceof B)){a=new B(a)}var e=new B(this),b=["protocol","username","password","hostname","port"];for(var d=0,f;f=b[d];d++){e._parts[f]=a._parts[f]}if(e.path()[0]!=="/"){e._parts.path=a.directory()+"/"+e._parts.path;e.normalizePath()}e.build();return e};v.relativeTo=function(h){if(this._parts.urn){throw new Error("URNs do not have any generally defined hierachical components")}if(!(h instanceof B)){h=new B(h)}if(this.path()[0]!=="/"||h.path()[0]!=="/"){throw new Error("Cannot calculate common path from non-relative URLs")}var k=new B(this),e=["protocol","username","password","hostname","port"],f=B.commonPath(k.path(),h.path()),l=h.directory();for(var g=0,j;j=e[g];g++){k._parts[j]=null}if(!f||f==="/"){return k}if(l+"/"===f){k._parts.path="./"+k.filename()}else{var a="../",d=new RegExp("^"+G(f)),b=l.replace(d,"/").match(/\//g).length-1;while(b--){a+="../"}k._parts.path=k._parts.path.replace(d,a)}k.build();return k};v.equals=function(d){var j=new B(this),m=new B(d),h={},f={},e={},g,a,b;j.normalize();m.normalize();if(j.toString()===m.toString()){return true}g=j.query();a=m.query();j.query("");m.query("");if(j.toString()!==m.toString()){return false}if(g.length!==a.length){return false}h=B.parseQuery(g);f=B.parseQuery(a);for(b in h){if(Object.prototype.hasOwnProperty.call(h,b)){if(!x(h[b])){if(h[b]!==f[b]){return false}}else{if(!x(f[b])){return false}if(h[b].length!==f[b].length){return false}h[b].sort();f[b].sort();for(var k=0,l=h[b].length;k<l;k++){if(h[b][k]!==f[b][k]){return false}}}e[b]=true}}for(b in f){if(Object.prototype.hasOwnProperty.call(f,b)){if(!e[b]){return false}}}return true};(window.URI=B)})();sc_require("URI.js");(function(e,f){var d=e.prototype;d.baseEquals=function(a){var b=new e(this).normalize(),j=new e(a).normalize(),k=b.protocol()+"://"+b.domain()+":"+b.port(),l=j.protocol()+"://"+j.domain()+":"+j.port();return k===l}})(window.URI);sc_require("URI.js");(function(e,f){var d=e.prototype;d.sortQuery=function(){var a=this._parts.query;if(!a.length){this._parts.query=null}else{var l=e.parseQuery(a),m,n,k,b;this.query(null);b=CW.invertHash(l).sort();for(m=0,n=b.length;m<n;m++){k=b[m];this.addQuery(k,l[k])}}return this}})(window.URI);(function(){var k=Date,f=k.prototype,j=k.CultureInfo,g=[],h=function(a,b){if(!b){b=2}return("000"+a).slice(b*-1)};k.normalizeFormat=function(a){g=[];var b=new Date().$format(a);return g.join("")};k.strftime=function(a,b){return new Date(b*1000).$format(a)};k.strtotime=function(b){var a=k.parse(b);a.addMinutes(a.getTimezoneOffset()*-1);return Math.round(k.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())/1000)};f.$format=function(b){var e=this,a,d=function(l){g.push(l);return e.toString(l)};return b?b.replace(/(%|\\)?.|%%/g,function(p){if(p.charAt(0)==="\\"||p.substring(0,2)==="%%"){return p.replace("\\","").replace("%%","%")}switch(p){case"d":case"%d":return d("dd");case"D":case"%a":return d("ddd");case"j":case"%e":return d("d");case"l":case"%A":return d("dddd");case"N":case"%u":return e.getDay()+1;case"S":return d("S");case"w":case"%w":return e.getDay();case"z":return e.getOrdinalNumber();case"%j":return h(e.getOrdinalNumber(),3);case"%U":var q=e.clone().set({month:0,day:1}).addDays(-1).moveToDayOfWeek(0),s=e.clone().addDays(1).moveToDayOfWeek(0,-1);return(s<q)?"00":h((s.getOrdinalNumber()-q.getOrdinalNumber())/7+1);case"W":case"%V":return e.getISOWeek();case"%W":return h(e.getWeek());case"F":case"%B":return d("MMMM");case"m":case"%m":return d("MM");case"M":case"%b":case"%h":return d("MMM");case"n":return d("M");case"t":return k.getDaysInMonth(e.getFullYear(),e.getMonth());case"L":return(k.isLeapYear(e.getFullYear()))?1:0;case"o":case"%G":return e.setWeek(e.getISOWeek()).toString("yyyy");case"%g":return e.$format("%G").slice(-2);case"Y":case"%Y":return d("yyyy");case"y":case"%y":return d("yy");case"a":case"%p":return d("tt").toLowerCase();case"A":return d("tt").toUpperCase();case"g":case"%I":return d("h");case"G":return d("H");case"h":return d("hh");case"H":case"%H":return d("HH");case"i":case"%M":return d("mm");case"s":case"%S":return d("ss");case"u":return h(e.getMilliseconds(),3);case"I":return(e.isDaylightSavingTime())?1:0;case"O":return e.getUTCOffset();case"P":a=e.getUTCOffset();return a.substring(0,a.length-2)+":"+a.substring(a.length-2);case"e":case"T":case"%z":case"%Z":return e.getTimezone();case"Z":return e.getTimezoneOffset()*-60;case"B":var m=new Date();return Math.floor(((m.getHours()*3600)+(m.getMinutes()*60)+m.getSeconds()+(m.getTimezoneOffset()+60)*60)/86.4);case"c":return e.toISOString().replace(/\"/g,"");case"U":return k.strtotime("now");case"%c":return d("d")+" "+d("t");case"%C":return Math.floor(e.getFullYear()/100+1);case"%D":return d("MM/dd/yy");case"%n":return"\\n";case"%t":return"\\t";case"%r":return d("hh:mm tt");case"%R":return d("H:mm");case"%T":return d("H:mm:ss");case"%x":return d("d");case"%X":return d("t");default:g.push(p);return p}}):this._toString()};if(!f.format){f.format=f.$format}}());
/*! @license Copyright (c) 2006-2007, Coolite Inc. (http://www.coolite.com/). All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

See also:
	http://www.datejs.com/license/
	http://www.datejs.com/

*/
Date.CultureInfo={name:"zh-CN",englishName:"Chinese (People's Republic of China)",nativeName:"()",dayNames:["","","","","","",""],abbreviatedDayNames:["","","","","","",""],shortestDayNames:["","","","","","",""],firstLetterDayNames:["","","","","","",""],monthNames:["","","","","","","","","","","",""],abbreviatedMonthNames:["","","","","","","","","","","",""],amDesignator:"",pmDesignator:"",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"ymd",formatPatterns:{shortDate:"yyyy/M/d",longDate:"yyyy''M''d''",shortTime:"H:mm",longTime:"H:mm:ss",fullDateTime:"yyyy''M''d'' H:mm:ss",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"M''d''",yearMonth:"yyyy''M''"},regexPatterns:{jan:/^/i,feb:/^/i,mar:/^/i,apr:/^/i,may:/^/i,jun:/^/i,jul:/^/i,aug:/^/i,sep:/^/i,oct:/^/i,nov:/^/i,dec:/^/i,sun:/^/i,mon:/^/i,tue:/^/i,wed:/^/i,thu:/^/i,fri:/^/i,sat:/^/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",MDT:"-0700",PDT:"-0800"}};(function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};var k=Date.Parsing;var q=k.Operators={rtoken:function(a){return function(d){var b=d.match(a);if(b){return([b[0],d.substring(b[0].length)])}else{throw new k.Exception(d)}}},token:function(a){return function(b){return q.rtoken(new RegExp("^s*"+b+"s*"))(b)}},stoken:function(a){return q.rtoken(new RegExp("^"+a))},until:function(a){return function(e){var d=[],f=null;while(e.length){try{f=a.call(this,e)}catch(b){d.push(f[0]);e=f[1];continue}break}return[d,e]}},many:function(a){return function(e){var f=[],d=null;while(e.length){try{d=a.call(this,e)}catch(b){return[f,e]}f.push(d[0]);e=d[1]}return[f,e]}},optional:function(a){return function(e){var d=null;try{d=a.call(this,e)}catch(b){return[null,e]}return[d[0],d[1]]}},not:function(a){return function(d){try{a.call(this,d)}catch(b){return[null,d]}throw new k.Exception(d)}},ignore:function(a){return a?function(d){var b=null;b=a.call(this,d);return[null,b[1]]}:null},product:function(){var d=arguments[0],b=Array.prototype.slice.call(arguments,1),a=[];for(var e=0;e<d.length;e++){a.push(q.each(d[e],b))}return a},cache:function(a){var d={},b=null;return function(e){try{b=d[e]=(d[e]||a.call(this,e))}catch(f){b=d[e]=f}if(b instanceof k.Exception){throw b}else{return b}}},any:function(){var a=arguments;return function(d){var b=null;for(var e=0;e<a.length;e++){if(a[e]==null){continue}try{b=(a[e].call(this,d))}catch(f){b=null}if(b){return b}}throw new k.Exception(d)}},each:function(){var a=arguments;return function(d){var f=[],b=null;for(var e=0;e<a.length;e++){if(a[e]==null){continue}try{b=(a[e].call(this,d))}catch(g){throw new k.Exception(d)}f.push(b[0]);d=b[1]}return[f,d]}},all:function(){var a=arguments,b=b;return b.each(b.optional(a))},sequence:function(d,b,a){b=b||q.rtoken(/^\s*/);a=a||null;if(d.length==1){return d[0]}return function(x){var s=null,h=null;var f=[];for(var y=0;y<d.length;y++){try{s=d[y].call(this,x)}catch(g){break}f.push(s[0]);try{h=b.call(this,s[1])}catch(z){h=null;break}x=h[1]}if(!s){throw new k.Exception(x)}if(h){throw new k.Exception(h[1])}if(a){try{s=a.call(this,s[1])}catch(e){throw new k.Exception(s[1])}}return[f,(s?s[1]:x)]}},between:function(d,b,e){e=e||d;var a=q.each(q.ignore(d),b,q.ignore(e));return function(g){var f=a.call(this,g);return[[f[0][0],r[0][2]],f[1]]}},list:function(d,b,a){b=b||q.rtoken(/^\s*/);a=a||null;return(d instanceof Array?q.each(q.product(d.slice(0,-1),q.ignore(b)),d.slice(-1),q.ignore(a)):q.each(q.many(q.each(d,q.ignore(b))),px,q.ignore(a)))},set:function(d,b,a){b=b||q.rtoken(/^\s*/);a=a||null;return function(e){var A=null,h=null,s=null,K=null,J=[[],e],f=false;for(var H=0;H<d.length;H++){s=null;h=null;A=null;f=(d.length==1);try{A=d[H].call(this,e)}catch(E){continue}K=[[A[0]],A[1]];if(A[1].length>0&&!f){try{s=b.call(this,A[1])}catch(g){f=true}}else{f=true}if(!f&&s[1].length===0){f=true}if(!f){var G=[];for(var I=0;I<d.length;I++){if(H!=I){G.push(d[I])}}h=q.set(G,b).call(this,s[1]);if(h[0].length>0){K[0]=K[0].concat(h[0]);K[1]=h[1]}}if(K[1].length<J[1].length){J=K}if(J[1].length===0){break}}if(J[0].length===0){return J}if(a){try{s=a.call(this,J[1])}catch(F){throw new k.Exception(J[1])}J[1]=s[1]}return J}},forward:function(b,a){return function(d){return b[a].call(this,d)}},replace:function(a,b){return function(e){var d=a.call(this,e);return[b,d[1]]}},process:function(a,b){return function(e){var d=a.call(this,e);return[b.call(this,d[0]),d[1]]}},min:function(b,a){return function(e){var d=a.call(this,e);if(d[0].length<b){throw new k.Exception(e)}return d}}};var l=function(a){return function(){var e=null,f=[];if(arguments.length>1){e=Array.prototype.slice.call(arguments)}else{if(arguments[0] instanceof Array){e=arguments[0]}}if(e){for(var b=0,d=e.shift();b<d.length;b++){e.unshift(d[b]);f.push(a.apply(null,e));e.shift();return f}}else{return a.apply(null,arguments)}}};var m="optional not ignore cache".split(/\s/);for(var p=0;p<m.length;p++){q[m[p]]=l(q[m[p]])}var n=function(a){return function(){if(arguments[0] instanceof Array){return a.apply(null,arguments[0])}else{return a.apply(null,arguments)}}};var o="each any all".split(/\s/);for(var j=0;j<o.length;j++){q[o[j]]=n(q[o[j]])}}());(function(){var w=Date,g=w.prototype,v=w.CultureInfo;var t=1604;var u=function(d){var b=[];for(var a=0;a<d.length;a++){if(d[a] instanceof Array){b=b.concat(u(d[a]))}else{if(d[a]){b.push(d[a])}}}return b};w.Grammar={};w.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");if(b.length){this.timezoneOffset=Number(b)}else{this.timezone=a.toLowerCase()}}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=(a.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(a)/4:Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=((a.length>2)?b:(b+(((b+2000)<v.twoDigitYearMax)?2000:1900)))}},rday:function(a){return function(){switch(a){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break}}},finishExact:function(b){b=(b instanceof Array)?b:[b];for(var d=0;d<b.length;d++){if(b[d]){b[d].call(this)}}var e=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=e.getDate()}if(!this.year){this.year=e.getFullYear()}if(!this.month&&this.month!==0){this.month=e.getMonth()}if(!this.day){this.day=1}if(!this.hour){this.hour=0}if(!this.minute){this.minute=0}if(!this.second){this.second=0}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.day>w.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.")}var a=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){a.set({timezone:this.timezone})}else{if(this.timezoneOffset){a.set({timezoneOffset:this.timezoneOffset})}}return a},finish:function(h){h=(h instanceof Array)?u(h):[h];if(h.length===0){return null}for(var d=0;d<h.length;d++){if(typeof h[d]=="function"){h[d].call(this)}}var j=w.today();if(this.now&&!this.unit&&!this.operator){return new Date()}else{if(this.now){j=new Date()}}if(Date.allowYearless){j.setFullYear(t)}var b=!!(this.days&&this.days!==null||this.orient||this.operator);var a,e,f;f=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){j.setTimeToNow()}if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;b=true}}if(!b&&this.weekday&&!this.day&&!this.days){var k=Date[this.weekday]();this.day=k.getDate();if(!this.month){this.month=k.getMonth()}this.year=Date.allowYearless?t:k.getFullYear()}if(b&&this.weekday&&this.unit!="month"){this.unit="day";a=(w.getDayNumberFromName(this.weekday)-j.getDay());e=7;this.days=a?((a+(f*e))%e):(f*e)}if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1}if(this.month&&!this.day&&this.value){j.set({day:this.value*1});if(!b){this.day=this.value*1}}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;b=true}if(b&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";a=(this.month-j.getMonth());e=12;this.months=a?((a+(f*e))%e):(f*e);this.month=null}if(!this.unit){this.unit="day"}if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*f}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1}this[this.unit+"s"]=this.value*f}}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.weekday&&!this.day&&!this.days){var k=Date[this.weekday]();this.day=k.getDate();if(k.getMonth()!==j.getMonth()){this.month=k.getMonth()}}if((this.month||this.month===0)&&!this.day){this.day=1}if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value)}if(b&&this.timezone&&this.day&&this.days){this.day=this.days}return(b)?j.add(this):j.set(this)}};var s=w.Parsing.Operators,x=w.Grammar,p=w.Translator,z;x.datePartDelimiter=s.rtoken(/^(\s*(de(l)?|||)\s*|[\s\-\.\,\/\x27]+)/);x.timePartDelimiter=s.stoken(":");x.whiteSpace=s.rtoken(/^\s*/);x.generalDelimiter=s.rtoken(/^(([\s\,]|at|@|on)+)/);var A={};x.ctoken=function(b){var d=A[b];if(!d){var a=v.regexPatterns;var f=b.split(/\s+/),h=[];for(var e=0;e<f.length;e++){h.push(s.replace(s.rtoken(a[f[e]]),f[e]))}d=A[b]=s.any.apply(null,h)}return d};x.ctoken2=function(a){return s.rtoken(v.regexPatterns[a])};x.h=s.cache(s.process(s.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),p.hour));x.hh=s.cache(s.process(s.rtoken(/^(0[0-9]|1[0-2])/),p.hour));x.H=s.cache(s.process(s.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),p.hour));x.HH=s.cache(s.process(s.rtoken(/^([0-1][0-9]|2[0-3])/),p.hour));x.m=s.cache(s.process(s.rtoken(/^([0-5][0-9]|[0-9])/),p.minute));x.mm=s.cache(s.process(s.rtoken(/^[0-5][0-9]/),p.minute));x.s=s.cache(s.process(s.rtoken(/^([0-5][0-9]|[0-9])/),p.second));x.ss=s.cache(s.process(s.rtoken(/^[0-5][0-9]/),p.second));x.hms=s.cache(s.sequence([x.H,x.m,x.s],x.timePartDelimiter));x.t=s.cache(s.process(x.ctoken2("shortMeridian"),p.meridian));x.tt=s.cache(s.process(x.ctoken2("longMeridian"),p.meridian));x.z=s.cache(s.process(s.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),p.timezone));x.zz=s.cache(s.process(s.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),p.timezone));x.zzz=s.cache(s.process(x.ctoken2("timezone"),p.timezone));x.timeSuffix=s.each(s.ignore(x.whiteSpace),s.set([x.tt,x.zzz]));x.time=s.each(s.optional(s.ignore(s.stoken("T"))),x.hms,x.timeSuffix);x.d=s.cache(s.process(s.each(s.rtoken(/^([0-2]\d|3[0-1]|\d)/),s.optional(x.ctoken2("ordinalSuffix"))),p.day));x.dd=s.cache(s.process(s.each(s.rtoken(/^([0-2]\d|3[0-1])/),s.optional(x.ctoken2("ordinalSuffix"))),p.day));x.ddd=x.dddd=s.cache(s.process(x.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}}));x.M=s.cache(s.process(s.rtoken(/^(1[0-2]|0\d|\d)/),p.month));x.MM=s.cache(s.process(s.rtoken(/^(1[0-2]|0\d)/),p.month));x.MMM=x.MMMM=s.cache(s.process(x.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),p.month));x.y=s.cache(s.process(s.rtoken(/^(\d\d?)/),p.year));x.yy=s.cache(s.process(s.rtoken(/^(\d\d)/),p.year));x.yyy=s.cache(s.process(s.rtoken(/^(\d\d?\d?\d?)/),p.year));x.yyyy=s.cache(s.process(s.rtoken(/^(\d\d\d\d)/),p.year));z=function(){return s.each(s.any.apply(null,arguments),s.not(x.ctoken2("timeContext")))};x.day=z(x.d,x.dd);x.month=z(x.M,x.MMM);x.year=z(x.yyyy,x.yy);x.orientation=s.process(x.ctoken("past future"),function(a){return function(){this.orient=a}});x.operator=s.process(x.ctoken("add subtract"),function(a){return function(){this.operator=a}});x.rday=s.process(x.ctoken("yesterday tomorrow today now"),p.rday);x.unit=s.process(x.ctoken("second minute hour day week month year"),function(a){return function(){this.unit=a}});x.value=s.process(s.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}});x.expression=s.set([x.rday,x.operator,x.value,x.unit,x.orientation,x.ddd,x.MMM]);z=function(){return s.set(arguments,x.datePartDelimiter)};x.mdy=z(x.ddd,x.month,x.day,x.year);x.ymd=z(x.ddd,x.year,x.month,x.day);x.dmy=z(x.ddd,x.day,x.month,x.year);x.date=function(a){return((x[v.dateElementOrder]||x.mdy).call(this,a))};x.format=s.process(s.many(s.any(s.process(s.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(a){if(x[a]){return x[a]}else{throw w.Parsing.Exception(a)}}),s.process(s.rtoken(/^[^dMyhHmstz]+/),function(a){return s.ignore(s.stoken(a))}))),function(a){return s.process(s.each.apply(null,a),p.finishExact)});var q={};var y=function(a){return q[a]=(q[a]||x.format(a)[0])};x.formats=function(d){if(d instanceof Array){var b=[];for(var a=0;a<d.length;a++){b.push(y(d[a]))}return s.any.apply(null,b)}else{return y(d)}};var B=['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","yyyyMMMMd","MMMMd","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy.MM.dd.","yyyy.MM.d.","yyyy.M.dd.","yyyy.M.d.","MM.dd.","MM.d.","M.dd.","M.d.","yyyy","Mdyy","dMyy","d"];x.changeDateArr=function(b){if(v.dateElementOrder==="dmy"&&b.indexOf("d/M")===-1){var a=b.indexOf("M/d");b.insertAt(a,"d/M")}return b};B=x.changeDateArr(B);x._formats=x.formats(B);x._start=s.process(s.set([x.date,x.time,x.expression],x.generalDelimiter,x.whiteSpace),p.finish);x.start=function(a){try{var d=x._formats.call({},a);if(d[1].length===0){return d}}catch(b){}return x._start.call({},a)};w._parse=w.parse;w.parse=function(a){var d=null;if(!a){return null}if(a instanceof Date){return a}try{d=w.Grammar.start.call({},a.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(b){return null}return((d[1].length===0)?d[0]:null)};w.getParseFunction=function(b){var a=w.Grammar.formats(b);return function(f){var e=null;try{e=a.call({},f)}catch(d){return null}return((e[1].length===0)?e[0]:null)}};w.parseExact=function(a,b){return w.getParseFunction(b)(a)}}());(function(){var B=Date,L=B.prototype,A=B.CultureInfo,H=Number.prototype;L._orient=+1;L._nth=null;L._is=false;L._same=false;L._isSecond=false;H._dateElement="day";L.next=function(){this._orient=+1;return this};B.next=function(){return B.today().next()};L.last=L.prev=L.previous=function(){this._orient=-1;return this};B.last=B.prev=B.previous=function(){return B.today().last()};L.is=function(){this._is=true;return this};L.same=function(){this._same=true;this._isSecond=false;return this};L.today=function(){return this.same().day()};L.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun())}return false};L.at=function(a){return(typeof a==="string")?B.parse(this.toString("d")+" "+a):this.set(a)};H.fromNow=H.after=function(b){var a={};a[this._dateElement]=this;return((!b)?new Date():b.clone()).add(a)};H.ago=H.before=function(b){var a={};a[this._dateElement]=this*-1;return((!b)?new Date():b.clone()).add(a)};var N=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),K=("january february march april may june july august september october november december").split(/\s/),I=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),G=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),Q=("final first second third fourth fifth").split(/\s/),k;L.toObject=function(){var a={};for(var b=0;b<I.length;b++){a[I[b].toLowerCase()]=this["get"+G[b]]()}return a};B.fromObject=function(a){a.week=null;return Date.today().set(a)};var l=function(a){return function(){if(this._is){this._is=false;return this.getDay()==a}if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1)}this._isSecond=false;var b=this._nth;this._nth=null;var d=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(a,b);if(this>d){throw new RangeError(B.getDayName(a)+" does not occur "+b+" times in the month of "+B.getMonthName(d.getMonth())+" "+d.getFullYear()+".")}return this}return this.moveToDayOfWeek(a,this._orient)}};var M=function(a){return function(){var b=B.today(),d=a-b.getDay();if(a===0&&A.firstDayOfWeek===1&&b.getDay()!==0){d=d+7}return b.addDays(d)}};for(var C=0;C<N.length;C++){B[N[C].toUpperCase()]=B[N[C].toUpperCase().substring(0,3)]=C;B[N[C]]=B[N[C].substring(0,3)]=M(C);L[N[C]]=L[N[C].substring(0,3)]=l(C)}var j=function(a){return function(){if(this._is){this._is=false;return this.getMonth()===a}return this.moveToMonth(a,this._orient)}};var J=function(a){return function(){return B.today().set({month:a,day:1})}};for(var D=0;D<K.length;D++){B[K[D].toUpperCase()]=B[K[D].toUpperCase().substring(0,3)]=D;B[K[D]]=B[K[D].substring(0,3)]=J(D);L[K[D]]=L[K[D].substring(0,3)]=j(D)}var P=function(a){return function(){if(this._isSecond){this._isSecond=false;return this}if(this._same){this._same=this._is=false;var e=this.toObject(),f=(arguments[0]||new Date()).toObject(),g="",b=a.toLowerCase();for(var d=(I.length-1);d>-1;d--){g=I[d].toLowerCase();if(e[g]!=f[g]){return false}if(b==g){break}}return true}if(a.substring(a.length-1)!="s"){a+="s"}return this["add"+a](this._orient)}};var O=function(a){return function(){this._dateElement=a;return this}};for(var E=0;E<I.length;E++){k=I[E].toLowerCase();L[k]=L[k+"s"]=P(I[E]);H[k]=H[k+"s"]=O(k)}L._ss=P("Second");var R=function(a){return function(b){if(this._same){return this._ss(arguments[0])}if(b||b===0){return this.moveToNthOccurrence(b,a)}this._nth=a;if(a===2&&(b===undefined||b===null)){this._isSecond=true;return this.addSeconds(this._orient)}return this}};for(var F=0;F<Q.length;F++){L[Q[F]]=(F===0)?R(-1):R(F)}}());var TimeSpan=function(n,s,v,q,w){var o="days hours minutes seconds milliseconds".split(/\s+/);var x=function(a){return function(){return this[a]}};var p=function(a){return function(b){this[a]=b;return this}};for(var t=0;t<o.length;t++){var y=o[t],z=y.slice(0,1).toUpperCase()+y.slice(1);TimeSpan.prototype[y]=0;TimeSpan.prototype["get"+z]=x(y);TimeSpan.prototype["set"+z]=p(y)}if(arguments.length==4){this.setDays(n);this.setHours(s);this.setMinutes(v);this.setSeconds(q)}else{if(arguments.length==5){this.setDays(n);this.setHours(s);this.setMinutes(v);this.setSeconds(q);this.setMilliseconds(w)}else{if(arguments.length==1&&typeof n=="number"){var u=(n<0)?-1:+1;this.setMilliseconds(Math.abs(n));this.setDays(Math.floor(this.getMilliseconds()/86400000)*u);this.setMilliseconds(this.getMilliseconds()%86400000);this.setHours(Math.floor(this.getMilliseconds()/3600000)*u);this.setMilliseconds(this.getMilliseconds()%3600000);this.setMinutes(Math.floor(this.getMilliseconds()/60000)*u);this.setMilliseconds(this.getMilliseconds()%60000);this.setSeconds(Math.floor(this.getMilliseconds()/1000)*u);this.setMilliseconds(this.getMilliseconds()%1000);this.setMilliseconds(this.getMilliseconds()*u)}}}this.getTotalMilliseconds=function(){return(this.getDays()*86400000)+(this.getHours()*3600000)+(this.getMinutes()*60000)+(this.getSeconds()*1000)};this.compareTo=function(a){var b=new Date(1970,1,1,this.getHours(),this.getMinutes(),this.getSeconds()),d;if(a===null){d=new Date(1970,1,1,0,0,0)}else{d=new Date(1970,1,1,a.getHours(),a.getMinutes(),a.getSeconds())}return(b<d)?-1:(b>d)?1:0};this.equals=function(a){return(this.compareTo(a)===0)};this.add=function(a){return(a===null)?this:this.addSeconds(a.getTotalMilliseconds()/1000)};this.subtract=function(a){return(a===null)?this:this.addSeconds(-a.getTotalMilliseconds()/1000)};this.addDays=function(a){return new TimeSpan(this.getTotalMilliseconds()+(a*86400000))};this.addHours=function(a){return new TimeSpan(this.getTotalMilliseconds()+(a*3600000))};this.addMinutes=function(a){return new TimeSpan(this.getTotalMilliseconds()+(a*60000))};this.addSeconds=function(a){return new TimeSpan(this.getTotalMilliseconds()+(a*1000))};this.addMilliseconds=function(a){return new TimeSpan(this.getTotalMilliseconds()+a)};this.get12HourHour=function(){return(this.getHours()>12)?this.getHours()-12:(this.getHours()===0)?12:this.getHours()};this.getDesignator=function(){return(this.getHours()<12)?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator};this.toString=function(a){this._toString=function(){if(this.getDays()!==null&&this.getDays()>0){return this.getDays()+"."+this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds())}else{return this.getHours()+":"+this.p(this.getMinutes())+":"+this.p(this.getSeconds())}};this.p=function(d){return(d.toString().length<2)?"0"+d:d};var b=this;return a?a.replace(/dd?|HH?|hh?|mm?|ss?|tt?/g,function(d){switch(d){case"d":return b.getDays();case"dd":return b.p(b.getDays());case"H":return b.getHours();case"HH":return b.p(b.getHours());case"h":return b.get12HourHour();case"hh":return b.p(b.get12HourHour());case"m":return b.getMinutes();case"mm":return b.p(b.getMinutes());case"s":return b.getSeconds();case"ss":return b.p(b.getSeconds());case"t":return((b.getHours()<12)?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator).substring(0,1);case"tt":return(b.getHours()<12)?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator}}):this._toString()};return this};Date.prototype.getTimeOfDay=function(){return new TimeSpan(0,this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())};var TimePeriod=function(B,I,J,y,A,E,H){var C="years months days hours minutes seconds milliseconds".split(/\s+/);var F=function(a){return function(){return this[a]}};var M=function(a){return function(b){this[a]=b;return this}};for(var z=0;z<C.length;z++){var K=C[z],L=K.slice(0,1).toUpperCase()+K.slice(1);TimePeriod.prototype[K]=0;TimePeriod.prototype["get"+L]=F(K);TimePeriod.prototype["set"+L]=M(K)}if(arguments.length==7){this.years=B;this.months=I;this.setDays(J);this.setHours(y);this.setMinutes(A);this.setSeconds(E);this.setMilliseconds(H)}else{if(arguments.length==2&&arguments[0] instanceof Date&&arguments[1] instanceof Date){var v=B.clone();var w=I.clone();var x=v.clone();var G=(v>w)?-1:+1;this.years=w.getFullYear()-v.getFullYear();x.addYears(this.years);if(G==+1){if(x>w){if(this.years!==0){this.years--}}}else{if(x<w){if(this.years!==0){this.years++}}}v.addYears(this.years);if(G==+1){while(v<w&&v.clone().addDays(Date.getDaysInMonth(v.getYear(),v.getMonth()))<w){v.addMonths(1);this.months++}}else{while(v>w&&v.clone().addDays(-v.getDaysInMonth())>w){v.addMonths(-1);this.months--}}var D=w-v;if(D!==0){var N=new TimeSpan(D);this.setDays(N.getDays());this.setHours(N.getHours());this.setMinutes(N.getMinutes());this.setSeconds(N.getSeconds());this.setMilliseconds(N.getMilliseconds())}}}return this};(function(){var j=Date,k=j.prototype,p=j.CultureInfo,m=function(a,b){if(!b){b=2}return("000"+a).slice(b*-1)};k.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};k.setTimeToNow=function(){var a=new Date();this.setHours(a.getHours());this.setMinutes(a.getMinutes());this.setSeconds(a.getSeconds());this.setMilliseconds(a.getMilliseconds());return this};j.today=function(){return new Date().clearTime()};j.compare=function(a,b){if(isNaN(a)||isNaN(b)){throw new Error(a+" - "+b)}else{if(a instanceof Date&&b instanceof Date){return(a<b)?-1:(a>b)?1:0}else{throw new TypeError(a+" - "+b)}}};j.equals=function(a,b){return(a.compareTo(b)===0)};j.getDayNumberFromName=function(b){var e=p.dayNames,d=p.abbreviatedDayNames,f=p.shortestDayNames,g=b.toLowerCase();for(var a=0;a<e.length;a++){if(e[a].toLowerCase()==g||d[a].toLowerCase()==g||f[a].toLowerCase()==g){return a}}return -1};j.getMonthNumberFromName=function(b){var e=p.monthNames,d=p.abbreviatedMonthNames,f=b.toLowerCase();for(var a=0;a<e.length;a++){if(e[a].toLowerCase()==f||d[a].toLowerCase()==f){return a}}return -1};j.isLeapYear=function(a){return((a%4===0&&a%100!==0)||a%400===0)};j.getDaysInMonth=function(b,a){return[31,(j.isLeapYear(b)?29:28),31,30,31,30,31,31,30,31,30,31][a]};j.getTimezoneAbbreviation=function(a){var b=p.timezones,d;for(var e=0;e<b.length;e++){if(b[e].offset===a){return b[e].name}}return null};j.getTimezoneOffset=function(e){var a=p.timezones,b;for(var d=0;d<a.length;d++){if(a[d].name===e.toUpperCase()){return a[d].offset}}return null};k.clone=function(){return new Date(this.getTime())};k.compareTo=function(a){return Date.compare(this,a)};k.equals=function(a){return Date.equals(this,a||new Date())};k.between=function(a,b){return this.getTime()>=a.getTime()&&this.getTime()<=b.getTime()};k.isAfter=function(a){return this.compareTo(a||new Date())===1};k.isBefore=function(a){return(this.compareTo(a||new Date())===-1)};k.isToday=k.isSameDay=function(a){return this.clone().clearTime().equals((a||new Date()).clone().clearTime())};k.addMilliseconds=function(a){this.setMilliseconds(this.getMilliseconds()+a*1);return this};k.addSeconds=function(a){return this.addMilliseconds(a*1000)};k.addMinutes=function(a){return this.addMilliseconds(a*60000)};k.addHours=function(a){return this.addMilliseconds(a*3600000)};k.addDays=function(a){this.setDate(this.getDate()+a*1);return this};k.addWeeks=function(a){return this.addDays(a*7)};k.addMonths=function(b){var a=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+b*1);this.setDate(Math.min(a,j.getDaysInMonth(this.getFullYear(),this.getMonth())));return this};k.addYears=function(a){return this.addMonths(a*12)};k.add=function(a){if(typeof a=="number"){this._orient=a;return this}var b=a;if(b.milliseconds){this.addMilliseconds(b.milliseconds)}if(b.seconds){this.addSeconds(b.seconds)}if(b.minutes){this.addMinutes(b.minutes)}if(b.hours){this.addHours(b.hours)}if(b.weeks){this.addWeeks(b.weeks)}if(b.months){this.addMonths(b.months)}if(b.years){this.addYears(b.years)}if(b.days){this.addDays(b.days)}return this};var o,n,q;k.getWeek=function(){var x,a,b,d,e,f,g,h,s,w;o=(!o)?this.getFullYear():o;n=(!n)?this.getMonth()+1:n;q=(!q)?this.getDate():q;if(n<=2){x=o-1;a=(x/4|0)-(x/100|0)+(x/400|0);b=((x-1)/4|0)-((x-1)/100|0)+((x-1)/400|0);s=a-b;e=0;f=q-1+(31*(n-1))}else{x=o;a=(x/4|0)-(x/100|0)+(x/400|0);b=((x-1)/4|0)-((x-1)/100|0)+((x-1)/400|0);s=a-b;e=s+1;f=q+((153*(n-3)+2)/5)+58+s}g=(x+a)%7;d=(f+g-e)%7;h=(f+3-d)|0;if(h<0){w=53-((g-s)/5|0)}else{if(h>364+s){w=1}else{w=(h/7|0)+1}}o=n=q=null;return w};k.getISOWeek=function(){o=this.getUTCFullYear();n=this.getUTCMonth()+1;q=this.getUTCDate();return m(this.getWeek())};k.setWeek=function(a){return this.moveToDayOfWeek(1).addWeeks(a-this.getWeek())};var l=function(a,b,e,d){if(typeof a=="undefined"){return false}else{if(typeof a!="number"){throw new TypeError(a+" is not a Number.")}else{if(a<b||a>e){throw new RangeError(a+" is not a valid value for "+d+".")}}}return true};j.validateMillisecond=function(a){return l(a,0,999,"millisecond")};j.validateSecond=function(a){return l(a,0,59,"second")};j.validateMinute=function(a){return l(a,0,59,"minute")};j.validateHour=function(a){return l(a,0,23,"hour")};j.validateDay=function(b,d,a){return l(b,1,j.getDaysInMonth(d,a),"day")};j.validateMonth=function(a){return l(a,0,11,"month")};j.validateYear=function(a){return l(a,0,9999,"year")};k.set=function(a){if(j.validateMillisecond(a.millisecond)){this.addMilliseconds(a.millisecond-this.getMilliseconds())}if(j.validateSecond(a.second)){this.addSeconds(a.second-this.getSeconds())}if(j.validateMinute(a.minute)){this.addMinutes(a.minute-this.getMinutes())}if(j.validateHour(a.hour)){this.addHours(a.hour-this.getHours())}if(j.validateMonth(a.month)){this.addMonths(a.month-this.getMonth())}if(j.validateYear(a.year)){this.addYears(a.year-this.getFullYear())}if(j.validateDay(a.day,this.getFullYear(),this.getMonth())){this.addDays(a.day-this.getDate())}if(a.timezone){this.setTimezone(a.timezone)}if(a.timezoneOffset){this.setTimezoneOffset(a.timezoneOffset)}if(a.week&&l(a.week,0,53,"week")){this.setWeek(a.week)}return this};k.moveToFirstDayOfMonth=function(){return this.set({day:1})};k.moveToLastDayOfMonth=function(){return this.set({day:j.getDaysInMonth(this.getFullYear(),this.getMonth())})};k.moveToNthOccurrence=function(b,a){var d=0;if(a>0){d=a-1}else{if(a===-1){this.moveToLastDayOfMonth();if(this.getDay()!==b){this.moveToDayOfWeek(b,-1)}return this}}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(b,+1).addWeeks(d)};k.moveToDayOfWeek=function(d,b){var a=(d-this.getDay()+7*(b||+1))%7;return this.addDays((a===0)?a+=7*(b||+1):a)};k.moveToMonth=function(a,d){var b=(a-this.getMonth()+12*(d||+1))%12;return this.addMonths((b===0)?b+=12*(d||+1):b)};k.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1};k.getTimezone=function(){return j.getTimezoneAbbreviation(this.getUTCOffset())};k.setTimezoneOffset=function(a){var d=this.getTimezoneOffset(),b=Number(a)*-6/10;return this.addMinutes(b-d)};k.setTimezone=function(a){return this.setTimezoneOffset(j.getTimezoneOffset(a))};k.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset())};k.isDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!=this.getTimezoneOffset()};k.getUTCOffset=function(){var a=this.getTimezoneOffset()*-10/6,b;if(a<0){b=(a-10000).toString();return b.charAt(0)+b.substr(2)}else{b=(a+10000).toString();return"+"+b.substr(1)}};k.getElapsed=function(a){return(a||new Date())-this};if(!k.toISOString){k.toISOString=function(){function a(b){return b<10?"0"+b:b}return'"'+this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+'Z"'}}k._toString=k.toString;k.toString=function(b){var e=this;if(b&&b.length==1){var a=p.formatPatterns;e.t=e.toString;switch(b){case"d":return e.t(a.shortDate);case"D":return e.t(a.longDate);case"F":return e.t(a.fullDateTime);case"m":return e.t(a.monthDay);case"r":return e.t(a.rfc1123);case"s":return e.t(a.sortableDateTime);case"t":return e.t(a.shortTime);case"T":return e.t(a.longTime);case"u":return e.t(a.universalSortableDateTime);case"y":return e.t(a.yearMonth)}}var d=function(f){switch(f*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return b?b.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(f){if(f.charAt(0)==="\\"){return f.replace("\\","")}e.h=e.getHours;switch(f){case"hh":return m(e.h()<13?(e.h()===0?12:e.h()):(e.h()-12));case"h":return e.h()<13?(e.h()===0?12:e.h()):(e.h()-12);case"HH":return m(e.h());case"H":return e.h();case"mm":return m(e.getMinutes());case"m":return e.getMinutes();case"ss":return m(e.getSeconds());case"s":return e.getSeconds();case"yyyy":return m(e.getFullYear(),4);case"yy":return m(e.getFullYear());case"dddd":return p.dayNames[e.getDay()];case"ddd":return p.abbreviatedDayNames[e.getDay()];case"dd":return m(e.getDate());case"d":return e.getDate();case"MMMM":return p.monthNames[e.getMonth()];case"MMM":return p.abbreviatedMonthNames[e.getMonth()];case"MM":return m((e.getMonth()+1));case"M":return e.getMonth()+1;case"t":return e.h()<12?p.amDesignator.substring(0,1):p.pmDesignator.substring(0,1);case"tt":return e.h()<12?p.amDesignator:p.pmDesignator;case"S":return d(e.getDate());default:return f}}):this._toString()}}());sc_require("jquery.animate-enhanced");CW=SC.Object.create({NAMESPACE:"CW",VERSION:"1.0.0",isMobile:function(){if(SC.browser.isiPhone||SC.browser.isiPod){return true}if(SC.browser.isAndroid){return true}return false}.property().cacheable(),isiPad:function(){return SC.browser.isiPad}.property().cacheable(),isApp:function(){if(window.location.search.indexOf("phonegap=1")>=0){return true}else{return false}}.property().cacheable(),isiOSApp:function(){if(!SC.browser.isiOS){return false}if(window.location.search.indexOf("phonegap=1")>=0){return true}return false}.property().cacheable(),isAndroidApp:function(){if(!SC.browser.isAndroid){return false}if(window.location.search.indexOf("phonegap=1")>=0){return true}return false}.property().cacheable(),apps:function(){var b=window.URI.parseQuery(window.URI().query());var a;if(b.apps){return b.apps.split(",")}else{return["workflow","chat","admin"]}}.property().cacheable(),isShell:function(){if(window.location.search.indexOf("shell=1")>=0){return true}else{return false}}.property().cacheable(),isTint:function(){if(window.location.search.indexOf("tint=1")>=0){return true}else{return false}}.property().cacheable(),isOEM:function(){if(window.location.search.indexOf("oem=1")>=0){return true}else{return false}}.property().cacheable(),});CW.mixin({upperCaseUUID:function(){return this.UUID().toString().toUpperCase()},UUID:function(){var e,g="89ab",f=[];for(e=0;e<36;e+=1){f[e]=(Math.random()*16|0).toString(16)}f[8]=f[13]=f[18]=f[23]="-";f[14]="4";f[19]=g.charAt(Math.random()*4|0);return f.join("")},invertArray:function(h){if(!h){CW.fatalError("invertArray():  You must specify an array to invert")}var k,g,j,f={};for(k=0,g=h.length;k<g;++k){j=h[k];f[j]=true}return f},invertArrayWithOrder:function(h){if(!h){CW.fatalError("invertArrayWithOrder():  You must specify an array to invert")}var k,g,j,f={};for(k=0,g=h.length;k<g;++k){j=h[k];f[j]=k}return f},invertHash:function(h,f){if(!h){CW.fatalError("invertHash():  You must specify an hash to invert")}var k,j,g=[];if(f){for(k in h){j=h[k];if(j){g.push(parseInt(k,10))}}}else{for(k in h){j=h[k];if(j){g.push(k)}}}return g},combineHashes:function(g,h){var f=SC.clone(g),e;for(e in h){f[e]=h[e]}return f},hashDifferencesBreakdown:function(E,F,x){if(!E||!F){CW.fatalError("hashDifferencesBreakdown() must be called with two hashes")}if(E===F){CW.fatalError("hashDifferencesBreakdown() must be called with two different hashes")}var y=[],H=[],s=[],G=[];var w,t,C,B;if(x){w=this.invertArray(x)}var I=CW.getSimpleTypes(),u={},z,A,v,D;for(t in E){u[t]=true;if(w&&w[t]){continue}z=E[t];A=F[t];if(A===undefined){s.push(t)}else{v=(z===A);if(!v){D=SC.typeOf(z);if(I[D]){v=false}else{v=CW.valuesAreEqual(z,A,D)}}if(v){y.push(t)}else{H.push(t)}}}for(t in F){if(!u[t]){G.push(t)}}return{equal:y,different:H,firstHashOnly:s,secondHashOnly:G}},valuesAreEqual:function(s,t,v,x){if(s===t){return true}if(!v){v=SC.typeOf(s)}var B=CW.getSimpleTypes();if(B[v]){return false}else{if(!x){x=SC.typeOf(t)}if(v!==x){return false}else{if(v===SC.T_DATE){return s.getTime()===t.getTime()}else{if(v===SC.T_REGEXP){return s.toString()===t.toString()}else{if(v===SC.T_HASH){var A=0,o,p,q,u;for(o in s){++A;p=s[o];q=t[o];if(p!==q){u=SC.typeOf(p);if(B[u]){return false}else{if(!CW.valuesAreEqual(p,q,u)){return false}}}}for(o in t){--A}return(A===0)}else{if(v===SC.T_ARRAY){var y=s.length;var z=t.length;if(y!==z){return false}for(var w=(y-1);w>=0;--w){p=s[w];q=t[w];if(p!==q){u=SC.typeOf(p);if(B[u]){return false}else{if(!CW.valuesAreEqual(p,q,u)){return false}}}}return true}else{CW.fatalError("Unsupported type for CW.valuesAreEqual:  '%@'".fmt(v))}}}}}}},getSimpleTypes:function(){var b=CW._simpleTypes;if(!b){b=CW._simpleTypes={};b[SC.T_STRING]=true;b[SC.T_NUMBER]=true;b[SC.T_BOOL]=true;b[SC.T_UNDEFINED]=true;b[SC.T_NULL]=true}return b},getUrlParameters:function(d){if(!d){d=location.search}var e=new URI.parse(d);return e.query?URI.parseQuery(e.query):{}},escapeRegexCharacters:function(b){return b.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")},formatNumber:function(o,j,k){if(SC.none(o)){return""}if(!j){j=","}if(!k){k="."}o=o.toString();var m=o.split("."),n=m[0],l=m[1],p=/(\d+?)(?=(?:\d{3})+$)/g,q="$1"+j;n=n.replace(p,q);if(l){return n+k+l}else{return n}},preloadTargetImages:function(f){if(SC.APP_IMAGE_ASSETS){for(var d=0,e=SC.APP_IMAGE_ASSETS.length;d<e;d++){if(!f||SC.APP_IMAGE_ASSETS[d].indexOf(f)!==-1){SC.imageQueue.loadImage(SC.APP_IMAGE_ASSETS[d])}}}}});SC.ready(function(){setTimeout(function(){CW.preloadTargetImages()},2000)});sc_require("core");sc_require("system/utils");CW.mixin({fatalError:function(f,e){var g=this.recordStack(YES,YES),h;if(f instanceof Error){h=f}else{h=new Error(f)}if(e){SC.mixin(h,e)}h.recordedStack=g;throw h},recordStack:function(B,C){if(C||!this.get("hasSymbolicated")){try{this.symbolicate()}catch(w){}}var t=arguments.callee,A=t?t.caller:null,x=0,s=[],D={},u,v,j,z,y,e;if(A&&B){A=A.caller}while(A&&x<26){u=A.displayName;if(!u){u=A.name}if(!u){u=A.toString()}if(u.length>150){u=u.substring(0,150)}j={func:u};v=A["arguments"];if(v){z=[];for(y=0;y<5;++y){e=v[y];if(e){if(e.toString){e=e.toString()}else{e="(argument without .toString() method)"}}z.push(e)}j.args=z}s[x++]=j;if(D[u]){s[x++]="(Because "+u+" was called recursively, no more of the stack is available)";break}D[u]=true;A=A.caller}return s},hasSymbolicated:NO,namespacesToSymbolicate:["SC"],symbolicate:function(){if(!SC.Object.toString()){SC.warn("Cannot yet properly symbolicate because SproutCore is not yet in a position to provide class names");return}if(!this.hasSymbolicated){this.hasSymbolicated=true}if(!SC||!SC.typeOf){return}this._symbolicateClassAndSubclasses(SC.Object);var B=this.namespacesToSymbolicate,A=CW.invertArray(B),q,s,z,p,y,x,u,v,e,t;if(!B){return}for(q in window){if(A[q]){continue}s=q.charAt(0);if(s.toUpperCase()===s){try{u=window[q];if(u&&u.isObject){B.push(q)}}catch(w){}}}for(y=0,x=B.length;y<x;++y){z=B[y];p=window[z];for(q in p){if(!p.hasOwnProperty(q)){continue}u=p[q];if(!u){continue}if(u instanceof Function){if(!u.displayName){v=z+"."+q;u.displayName=v}}else{if(u instanceof Object&&!u.isClass){for(e in u){if(!u.hasOwnProperty(e)){continue}t=u[e];if(t instanceof Function){if(!t.displayName){v=z+"."+q+"."+e;t.displayName=v}}}}}}}},_symbolicateClassAndSubclasses:function(k){var m=k.toString(),n,l,q,o,p,j;if(!m){return}for(n in k){if(!k.hasOwnProperty(n)){continue}l=k[n];if(l instanceof Function){if(!l.displayName){q=m+"."+n;l.displayName=q}}}o=k.prototype;for(n in o){if(!o.hasOwnProperty(n)){continue}l=o[n];if(l instanceof Function){if(!l.displayName){q=m+"#"+n;l.displayName=q}}}p=k.subclasses;for(n in p){j=p[n];if(j&&j.isClass){this._symbolicateClassAndSubclasses(j)}}}});CW.mixin({encodeBase64:function(x){var A=this._b64,w=0,p=0,y="",z=[],B,C,D,s,t,u,v,q;if(!x){return x}x=this.encodeUTF8(x+"");do{B=x.charCodeAt(w++);C=x.charCodeAt(w++);D=x.charCodeAt(w++);q=B<<16|C<<8|D;s=q>>18&63;t=q>>12&63;u=q>>6&63;v=q&63;z[p++]=A.charAt(s)+A.charAt(t)+A.charAt(u)+A.charAt(v)}while(w<x.length);y=z.join("");switch(x.length%3){case 1:y=y.slice(0,-2)+"==";break;case 2:y=y.slice(0,-1)+"=";break}return y},decodeBase64:function(u){var x="",v=0,w=this._b64,m,o,q,n,p,s,t;u=u.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(v<u.length){n=w.indexOf(u.charAt(v++));p=w.indexOf(u.charAt(v++));s=w.indexOf(u.charAt(v++));t=w.indexOf(u.charAt(v++));m=(n<<2)|(p>>4);o=((p&15)<<4)|(s>>2);q=((s&3)<<6)|t;x+=String.fromCharCode(m);if(s!==64){x+=String.fromCharCode(o)}if(t!==64){x+=String.fromCharCode(q)}}x=this.decodeUTF8(x);return x},encodeUTF8:function(l){l=l.replace(/\r\n/g,"\n");var g="",k,h,j;for(k=0,h=l.length;k<h;++k){j=l.charCodeAt(k);if(j<128){g+=String.fromCharCode(j)}else{if((j>127)&&(j<2048)){g+=String.fromCharCode((j>>6)|192);g+=String.fromCharCode((j&63)|128)}else{g+=String.fromCharCode((j>>12)|224);g+=String.fromCharCode(((j>>6)&63)|128);g+=String.fromCharCode((j&63)|128)}}}return g},decodeUTF8:function(k){var p="",n=0,l,m,o,j;l=m=o=j=0;while(n<k.length){l=k.charCodeAt(n);if(l<128){p+=String.fromCharCode(l);n++}else{if((l>191)&&(l<224)){o=k.charCodeAt(n+1);p+=String.fromCharCode(((l&31)<<6)|(o&63));n+=2}else{o=k.charCodeAt(n+1);j=k.charCodeAt(n+2);p+=String.fromCharCode(((l&15)<<12)|((o&63)<<6)|(j&63));n+=3}}}return p},_b64:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="});(function(){var A,q="",x,o,z;String.cssWidthData={};var y=String.cssWidthData;var w=function w(){if(!o.parentNode){document.body.appendChild(o)}};String.removeWidthContainer=function(){if(o.parentNode){document.body.removeChild(o)}};var B=String.removeWidthContainer;String.prototype.calculatedWidth=function p(a,b){if(a===undefined){a=""}if(a!==q){q=a;A.style.cssText=a||""}w();A.innerHTML=(function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}).apply(this);return A.offsetWidth};String.prototype.cachedWidth=function u(b,d){var a=b||"nocss";if(!d){d=y[a]}if(!d){y[a]=d={}}var f=d[this];if(f!==undefined){return f}var e;d[this]=e=this.calculatedWidth(b,d);return e};String.prototype.truncateMiddle=function t(b,d){if(b>=this.length){return this}if(d===undefined){d=""}var a=Math.floor(b)/2;return this.substring(0,a)+d+this.substring(this.length-(b-a))};String.prototype.truncateEnd=function s(a,b){if(a>=this.length){return this}if(b===undefined){b=""}return this.substring(0,(a-b.length))+b};String.prototype.truncateStart=function s(a,b){if(a>=this.length){return this}if(b===undefined){b=""}return this.substring(b+(a-b.length),a)};String.prototype.truncateToWidth=function v(e,f,F,d){var l=0;var h,m,a,j=undefined,E=undefined,k=0,b,g,n;if(!(d instanceof Function)){d=String.prototype.truncateEnd}b=e/"i".cachedWidth(F);k=e/"W".cachedWidth(F);g=this.calculatedWidth(F);a=h=this;n=g<e;while(!n){l++;if((k===j&&b===E)||g==e){n=true;continue}j=k;E=b;m=Math.floor((k+b)/2);a=d.call(h,m,f);g=a.calculatedWidth(F);if(g<e){k=m}else{b=m}}return a};A=String.wcon=document.createElement("span");if(!SC.browser.isIE){x=document.createElement("div");x.style.position="absolute";x.style.left="-1000px";x.style.top="-1000px";x.style.visibility="hidden";x.appendChild(A)}if(SC.browser.isIE){o=A}else{o=x}})();(function(b,a){if(typeof define==="function"&&define.amd){define(["jquery"],function(){return a.apply(b,arguments)})}else{a.call(b,b.jQuery)}}(typeof global==="object"?global:this,function(w){var y=w.fn.animate,v=w.fn.stop;var n=["top","right","bottom","left","opacity","height","width"],x=["top","right","bottom","left"],s=["-webkit-","-moz-","-o-",""],B=["avoidTransforms","useTranslate3d","leaveTransforms"],l=/^([+-]=)?([\d+-.]+)(.*)$/,G=/([A-Z])/g,C={secondary:{},meta:{top:0,right:0,bottom:0,left:0}},h="px",q="jQe",e="cubic-bezier(",F=")",d=null,A=false;var o=document.body||document.documentElement,g=o.style,b="webkitTransitionEnd oTransitionEnd transitionend",E=g.WebkitTransition!==undefined||g.MozTransition!==undefined||g.OTransition!==undefined||g.transition!==undefined,k=("WebKitCSSMatrix" in window&&"m11" in new WebKitCSSMatrix()),j=k;if(w.expr&&w.expr.filters){d=w.expr.filters.animated;w.expr.filters.animated=function(K){return w(K).data("events")&&w(K).data("events")[b]?true:d.call(this,K)}}function J(K){return K.match(/\D+$/)}function m(U,O,L,P){if(L=="d"){return}if(!a(U)){return}var R=l.exec(O),M=U.css(L)==="auto"?0:U.css(L),V=typeof M=="string"?H(M):M,N=typeof O=="string"?H(O):O,T=P===true?0:V,S=U.is(":hidden"),K=U.translation();if(L=="left"){T=parseInt(V,10)+K.x}if(L=="right"){T=parseInt(V,10)+K.x}if(L=="top"){T=parseInt(V,10)+K.y}if(L=="bottom"){T=parseInt(V,10)+K.y}if(!R&&O=="show"){T=1;if(S){elem=U[0];if(elem.style){display=elem.style.display;if(!w._data(elem,"olddisplay")&&display==="none"){display=elem.style.display=""}if(display===""&&w.css(elem,"display")==="none"){w._data(elem,"olddisplay",D(elem.tagName))}if(display===""||display==="none"){elem.style.display=w._data(elem,"olddisplay")||""}}U.css("opacity",0)}}else{if(!R&&O=="hide"){T=0}}if(R){var Q=parseFloat(R[2]);if(R[1]){Q=((R[1]==="-="?-1:1)*Q)+parseInt(T,10)}if(R[3]&&R[3]!="px"){Q=Q+R[3]}return Q}else{return T}}function z(K,M,L){return((L===true||((j===true&&L!==false))&&k))?"translate3d("+K+"px, "+M+"px, 0)":"translate("+K+"px,"+M+"px)"}function p(S,X,Q,T,W,M,P,K){var L=S.data(q),R=L&&!f(L)?L:w.extend(true,{},C),O=W,V=w.inArray(X,x)>-1;if(V){var Y=R.meta,N=H(S.css(X))||0,U=X+"_o";O=W-N;Y[X]=O;Y[U]=S.css(X)=="auto"?0+O:N+O||0;R.meta=Y;if(P&&O===0){O=0-Y[U];Y[X]=O;Y[U]=0}}return S.data(q,I(S,R,X,Q,T,O,M,P,K))}function I(ac,W,P,K,Y,Z,Q,N,M){var U=false,T=Q===true&&N===true;W=W||{};if(!W.original){W.original={};U=true}W.properties=W.properties||{};W.secondary=W.secondary||{};var V=W.meta,aa=W.original,R=W.properties,X=W.secondary;for(var ab=s.length-1;ab>=0;ab--){var L=s[ab]+"transition-property",S=s[ab]+"transition-duration",O=s[ab]+"transition-timing-function";P=(T?s[ab]+"transform":P);if(U){aa[L]=ac.css(L)||"";aa[S]=ac.css(S)||"";aa[O]=ac.css(O)||""}X[P]=T?z(V.left,V.top,M):Z;R[L]=(R[L]?R[L]+",":"")+P;R[S]=(R[S]?R[S]+",":"")+K+"ms";R[O]=(R[O]?R[O]+",":"")+Y}return W}function t(L){for(var K in L){if((K=="width"||K=="height")&&(L[K]=="show"||L[K]=="hide"||L[K]=="toggle")){return true}}return false}function f(L){for(var K in L){return false}return true}function D(K){K=K.toUpperCase();var L={LI:"list-item",TR:"table-row",TD:"table-cell",TH:"table-cell",CAPTION:"table-caption",COL:"table-column",COLGROUP:"table-column-group",TFOOT:"table-footer-group",THEAD:"table-header-group",TBODY:"table-row-group"};return typeof L[K]=="string"?L[K]:"block"}function H(K){return parseFloat(K.replace(J(K),""))}function a(K){var L=true;K.each(function(M,N){L=L&&N.ownerDocument;return L});return L}function u(N,M,K){if(!a(K)){return false}var L=w.inArray(N,n)>-1;if((N=="width"||N=="height"||N=="opacity")&&(parseFloat(M)===parseFloat(K.css(N)))){L=false}return L}w.extend({toggle3DByDefault:function(){return j=!j},toggleDisabledByDefault:function(){return A=!A},setDisabledByDefault:function(K){return A=K}});w.fn.translation=function(){if(!this[0]){return null}var O=this[0],L=window.getComputedStyle(O,null),P={x:0,y:0};if(L){for(var N=s.length-1;N>=0;N--){var M=L.getPropertyValue(s[N]+"transform");if(M&&(/matrix/i).test(M)){var K=M.replace(/^matrix\(/i,"").split(/, |\)$/g);P={x:parseInt(K[4],10),y:parseInt(K[5],10)};break}}}return P};w.fn.animate=function(K,L,Q,S){K=K||{};var M=!(typeof K.bottom!=="undefined"||typeof K.right!=="undefined"),R=w.speed(L,Q,S),P=0,O=function(){P--;if(P===0){if(typeof R.complete==="function"){R.complete.apply(this,arguments)}}},N=(typeof K.avoidCSSTransitions!=="undefined")?K.avoidCSSTransitions:A;if(N===true||!E||f(K)||t(K)||R.duration<=0||R.step){return y.apply(this,arguments)}return this[R.queue===true?"queue":"each"](function(){var ad=w(this),U=w.extend({},R),Z=function(ak){var aj=ad.data(q)||{original:{}},ai={};if(ak.eventPhase!=2){return}if(K.leaveTransforms!==true){for(var ah=s.length-1;ah>=0;ah--){ai[s[ah]+"transform"]=""}if(M&&typeof aj.meta!=="undefined"){for(var af=0,ae;(ae=x[af]);++af){var ag=aj.meta[ae+"_o"];if(typeof ag!=="undefined"){ai[ae]=ag+h;w(this).css(ae,ai[ae])}}}}ad.unbind(b).css(aj.original).css(ai).data(q,null);if(K.opacity==="hide"){elem=ad[0];if(elem.style){display=w.css(elem,"display");if(display!=="none"&&!w._data(elem,"olddisplay")){w._data(elem,"olddisplay",display)}elem.style.display="none"}ad.css("opacity","")}O.call(this)},W={bounce:e+"0.0, 0.35, .5, 1.3"+F,linear:"linear",swing:"ease-in-out",easeInQuad:e+"0.550, 0.085, 0.680, 0.530"+F,easeInCubic:e+"0.550, 0.055, 0.675, 0.190"+F,easeInQuart:e+"0.895, 0.030, 0.685, 0.220"+F,easeInQuint:e+"0.755, 0.050, 0.855, 0.060"+F,easeInSine:e+"0.470, 0.000, 0.745, 0.715"+F,easeInExpo:e+"0.950, 0.050, 0.795, 0.035"+F,easeInCirc:e+"0.600, 0.040, 0.980, 0.335"+F,easeInBack:e+"0.600, -0.280, 0.735, 0.045"+F,easeOutQuad:e+"0.250, 0.460, 0.450, 0.940"+F,easeOutCubic:e+"0.215, 0.610, 0.355, 1.000"+F,easeOutQuart:e+"0.165, 0.840, 0.440, 1.000"+F,easeOutQuint:e+"0.230, 1.000, 0.320, 1.000"+F,easeOutSine:e+"0.390, 0.575, 0.565, 1.000"+F,easeOutExpo:e+"0.190, 1.000, 0.220, 1.000"+F,easeOutCirc:e+"0.075, 0.820, 0.165, 1.000"+F,easeOutBack:e+"0.175, 0.885, 0.320, 1.275"+F,easeInOutQuad:e+"0.455, 0.030, 0.515, 0.955"+F,easeInOutCubic:e+"0.645, 0.045, 0.355, 1.000"+F,easeInOutQuart:e+"0.770, 0.000, 0.175, 1.000"+F,easeInOutQuint:e+"0.860, 0.000, 0.070, 1.000"+F,easeInOutSine:e+"0.445, 0.050, 0.550, 0.950"+F,easeInOutExpo:e+"1.000, 0.000, 0.000, 1.000"+F,easeInOutCirc:e+"0.785, 0.135, 0.150, 0.860"+F,easeInOutBack:e+"0.680, -0.550, 0.265, 1.550"+F},Y={},X=W[U.easing||"swing"]?W[U.easing||"swing"]:U.easing||"swing";for(var T in K){if(w.inArray(T,B)===-1){var aa=w.inArray(T,x)>-1,ac=m(ad,K[T],T,(aa&&K.avoidTransforms!==true));if(u(T,ac,ad)){p(ad,T,U.duration,X,ac,aa&&K.avoidTransforms!==true,M,K.useTranslate3d)}else{Y[T]=K[T]}}}ad.unbind(b);var V=ad.data(q);if(V&&!f(V)&&!f(V.secondary)){P++;ad.css(V.properties);var ab=V.secondary;setTimeout(function(){ad.bind(b,Z).css(ab)})}else{U.queue=false}if(!f(Y)){P++;y.apply(ad,[Y,{duration:U.duration,easing:w.easing[U.easing]?U.easing:(w.easing.swing?"swing":"linear"),complete:O,queue:U.queue}])}return true})};w.fn.animate.defaults={};w.fn.stop=function(M,K,L){if(!E){return v.apply(this,[M,K])}if(M){this.queue([])}this.each(function(){var P=w(this),S=P.data(q);if(S&&!f(S)){var Q,R={};if(K){R=S.secondary;if(!L&&typeof S.meta.left_o!==undefined||typeof S.meta.top_o!==undefined){R.left=typeof S.meta.left_o!==undefined?S.meta.left_o:"auto";R.top=typeof S.meta.top_o!==undefined?S.meta.top_o:"auto";for(Q=s.length-1;Q>=0;Q--){R[s[Q]+"transform"]=""}}}else{if(!f(S.secondary)){var O=window.getComputedStyle(P[0],null);if(O){for(var T in S.secondary){if(S.secondary.hasOwnProperty(T)){T=T.replace(G,"-$1").toLowerCase();R[T]=O.getPropertyValue(T);if(!L&&(/matrix/i).test(R[T])){var N=R[T].replace(/^matrix\(/i,"").split(/, |\)$/g);R.left=(parseFloat(N[4])+parseFloat(P.css("left"))+h)||"auto";R.top=(parseFloat(N[5])+parseFloat(P.css("top"))+h)||"auto";for(Q=s.length-1;Q>=0;Q--){R[s[Q]+"transform"]=""}}}}}}}P.unbind(b);P.css(S.original).css(R).data(q,null)}else{v.apply(P,[M,K])}});return this}}));CW.ButtonKeyHandlingHelpers={isDefault:NO,isCancel:NO,keyHandlersDidChange:function(){var e=null,f=this.get("isDefault"),d=this.get("isCancel");if(f){this.registerKeyboardShortcut("return",this,this.triggerActionFromKeyboardShortcut)}else{this.deregisterKeyboardShortcut("return")}if(d){this.registerKeyboardShortcut("escape",this,this.triggerActionFromKeyboardShortcut)}else{this.deregisterKeyboardShortcut("escape")}}.observes("isDefault","isCancel"),initMixin:function(){if(this.get("isDefault")){this.registerKeyboardShortcut("return",this,this.triggerActionFromKeyboardShortcut)}if(this.get("isCancel")){this.registerKeyboardShortcut("escape",this,this.triggerActionFromKeyboardShortcut)}},triggerActionFromKeyboardShortcut:function(b){this.triggerAction();return YES}};SC.time=function(e){var d=SC.beget(fn);d.value=e;return d};(function(){var b=new Date();SC.mixin(SC.time,{month:function(d,a){b.setTime(d);if(a===undefined){return b.getMonth()}b.setMonth(a);return b.getTime()},utc:function(a){b.setTime(a);return a+(b.getTimezoneOffset()*60*1000)},local:function(a){b.setTime(a);return a-(b.getTimezoneOffset()*60*1000)},parse:function(a){},format:function(a){}})})();SC.time.fmt=SC.time.format;SC.time.fn={done:function(){return this.value}};"month day year".split(" ").forEach(function(b){SC.time.fn[b]=function(a){if(a===undefined){return SC.time[b](this.value)}else{this.value=SC.time[b](this.value,a);return this}}});var MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function LZ(b){return(b<0||b>9?"":"0")+b}SC.Locale.define("en",{longMonthNames:"January February March April May".split(" "),shortMonthNames:[],shortDateFormat:"dd/mm/yy",longDateFormat:""});SC.mixin(Date,{isDate:function(f,d){var e=Date.getDateFromFormat(f,d);if(e===0){return false}return true},compareDates:function(k,j,m,l){var g=Date.getDateFromFormat(k,j);var h=Date.getDateFromFormat(m,l);if(g===0||h===0){return -1}else{if(g>h){return 1}}return 0},getDateFromFormat:function(x,F){x=x+"";F=F+"";var y=0;var K=0;var D="";var P="";var A="";var N,O;var S=new Date();var M=S.getFullYear();var B=S.getMonth()+1;var C=1;var R=S.getHours();var E=S.getMinutes();var I=S.getSeconds();var L="";var H=SC.Locale.currentLocale;while(K<F.length){D=F.charAt(K);P="";while((F.charAt(K)==D)&&(K<F.length)){P+=F.charAt(K++)}if(P==="yyyy"||P==="yy"||P==="y"){if(P==="yyyy"){N=4;O=4}if(P==="yy"){N=2;O=2}if(P==="y"){N=2;O=4}M=Date._getInt(x,y,N,O);if(M===null){return 0}y+=M.length;if(M.length===2){if(M>70){M=1900+(M-0)}else{M=2000+(M-0)}}}else{if(P==="MMM"||P==="NNN"){B=0;for(var G=0;G<MONTH_NAMES.length;G++){var Q=MONTH_NAMES[G];if(x.substring(y,y+Q.length).toLowerCase()==Q.toLowerCase()){if(P==="MMM"||(P==="NNN"&&G>11)){B=G+1;if(B>12){B-=12}y+=Q.length;break}}}if((B<1)||(B>12)){return 0}}else{if(P==="EE"||P==="E"){for(G=0;G<DAY_NAMES.length;G++){var J=DAY_NAMES[G];if(x.substring(y,y+J.length).toLowerCase()==J.toLowerCase()){y+=J.length;break}}}else{if(P==="MM"||P==="M"){B=Date._getInt(x,y,P.length,2);if(B===null||(B<1)||(B>12)){return 0}y+=B.length}else{if(P==="dd"||P==="d"){C=Date._getInt(x,y,P.length,2);if(C===null||(C<1)||(C>31)){return 0}y+=C.length}else{if(P==="hh"||P==="h"){R=Date._getInt(x,y,P.length,2);if(R===null||(R<1)||(R>12)){return 0}y+=R.length}else{if(P==="HH"||P==="H"){R=Date._getInt(x,y,P.length,2);if(R===null||(R<0)||(R>23)){return 0}y+=R.length}else{if(P==="KK"||P==="K"){R=Date._getInt(x,y,P.length,2);if(R===null||(R<0)||(R>11)){return 0}y+=R.length}else{if(P==="kk"||P==="k"){R=Date._getInt(x,y,P.length,2);if(R===null||(R<1)||(R>24)){return 0}y+=R.length;R--}else{if(P==="mm"||P==="m"){E=Date._getInt(x,y,P.length,2);if(E===null||(E<0)||(E>59)){return 0}y+=E.length}else{if(P==="ss"||P==="s"){I=Date._getInt(x,y,P.length,2);if(I===null||(I<0)||(I>59)){return 0}y+=I.length}else{if(P==="a"){if(x.substring(y,y+2).toLowerCase()==="am"){L="AM"}else{if(x.substring(y,y+2).toLowerCase()==="pm"){L="PM"}else{return 0}}y+=2}else{if(x.substring(y,y+P.length)!=P){return 0}else{y+=P.length}}}}}}}}}}}}}}if(y!==x.length){return 0}if(B===2){if(((M%4===0)&&(M%100!==0))||(M%400===0)){if(C>29){return 0}}else{if(C>28){return 0}}}if((B===4)||(B===6)||(B===9)||(B===11)){if(C>30){return 0}}if(R<12&&L=="PM"){R=R-0+12}else{if(R>11&&L=="AM"){R-=12}}var T=new Date(M,B-1,C,R,E,I);return T.getTime()},parseDate:function(s){var n=(arguments.length==2)?arguments[1]:false,j=["E NNN dd HH:mm:ss UTC yyyy","y-M-d","y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d","d MMM y","d.MMM.y","y MMM d","y.MMM.d"],p=["M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"],d=["d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"],q=n?j.concat(d,p):j.concat(p,d),m=null;m=0;var t=new Date().getTime();switch(s.toLowerCase()){case SC.String.loc("yesterday"):m=t-(24*60*60*1000);break;case SC.String.loc("today"):case SC.String.loc("now"):m=t;break;case SC.String.loc("tomorrow"):m=t+(24*60*60*1000);break}if(m>0){return new Date(m)}for(var o=0;o<q.length;o++){m=Date.getDateFromFormat(s,q[o]);if(m===0){m=Date.getDateFromFormat(s,q[o]+" H:m:s")}if(m===0){m=Date.getDateFromFormat(s,q[o]+" h:m:s a")}if(m!==0){return new Date(m)}}return null},_isInteger:function(f){var d="1234567890";for(var e=0;e<f.length;e++){if(d.indexOf(f.charAt(e))==-1){return false}}return true},_getInt:function(j,l,k,m){for(var h=m;h>=k;h--){var g=j.substring(l,l+h);if(g.length<k){return null}if(Date._isInteger(g)){return g}}return null}});SC.mixin(Date.prototype,{format:function(K){K=K+"";var m=this;var aa="";var H=0;var y="";var ae="";var ab=m.getFullYear()+"";var ad=m.getMonth()+1;var E=m.getDate();var Y=m.getDay();var Z=m.getHours();var s=m.getMinutes();var V=m.getSeconds();var R,M,ag,S,k,af,Q,T,X,W,d,h,ac,ah,U;var A={};if(ab.length<4){ab=""+(ab-0+1900)}A.y=""+ab;A.yyyy=ab;A.yy=ab.substring(2,4);A.M=ad;A.MM=LZ(ad);A.MMM=MONTH_NAMES[ad-1];A.NNN=MONTH_NAMES[ad+11];A.d=E;A.dd=LZ(E);A.E=DAY_NAMES[Y+7];A.EE=DAY_NAMES[Y];A.H=Z;A.HH=LZ(Z);if(Z===0){A.h=12}else{if(Z>12){A.h=Z-12}else{A.h=Z}}A.hh=LZ(A.h);if(Z>11){A.K=Z-12}else{A.K=Z}A.k=Z+1;A.KK=LZ(A.K);A.kk=LZ(A.k);if(Z>11){A.a="PM"}else{A.a="AM"}A.m=s;A.mm=LZ(s);A.s=V;A.ss=LZ(V);while(H<K.length){y=K.charAt(H);ae="";while((K.charAt(H)==y)&&(H<K.length)){ae+=K.charAt(H++)}if(!SC.none(A[ae])){aa=aa+A[ae]}else{aa=aa+ae}}return aa},utcFormat:function(){var b=new Date(this.getTime()+(this.getTimezoneOffset()*60*1000));return b.format("E NNN dd HH:mm:ss UTC yyyy")}});sc_require("core");CW.DATE_ONLY=0;CW.DATE_TIME=1;CW.DATE_TIME_TO_MIDNIGHT=3;CW.DATE_TIME_SEC=4;CW.DAY_MIN_DUR=1440;CW.DAY_MILLIS_DUR=86400000;CW.Date={value:null,dateType:CW.DATE_ONLY,timeFormat:null,fullDateFormat:null,dateFormat:null,_dateObj:null,_timezoneOffset:0,incrementSeconds:function(b){this.seconds(this.seconds()+b);return this},incrementMinutes:function(b){this.minutes(this.minutes()+b);return this},incrementHours:function(b){this.hours(this.hours()+b);return this},incrementDate:function(b){this.date(this.date()+b);return this},incrementMonth:function(b){this.month(this.month()+b);return this},incrementYear:function(b){this.year(this.year()+b);return this},now:function(){this._dateObj=new Date();var e=this._dateObj.getTime(),d=this._dateObj.getTimezoneOffset()*60000;this._dateObj.setTime(e-d);this._dateObj._isUsingUTC=true;this._dateComponentDidChange();return this},dateComponent:function(){var b=this.value;return b?b[0]:null},date:function(b){if(b!==undefined){this._dateObj.setUTCDate(b);return this._dateComponentDidChange()}else{return this.value[3]}},dateObject:function(){return this._dateObj},day:function(){return this._dateObj.getUTCDay()},fullYear:function(b){if(b!==undefined){this._dateObj.setUTCFullYear(b);return this._dateComponentDidChange()}else{return this.value[1]}},hours:function(b){if(b!==undefined){this._dateObj.setUTCHours(b);return this._dateComponentDidChange()}else{return this.value[4]}},minutes:function(b){if(b!==undefined){this._dateObj.setUTCMinutes(b);return this._dateComponentDidChange()}else{return this.value[5]}},seconds:function(b){if(this.dateType===CW.DATE_TIME_SEC){if(b!==undefined){this._dateObj.setUTCSeconds(b);return this._dateComponentDidChange()}else{return this.value[6]}}return 0},month:function(b){if(b!==undefined){this._dateObj.setUTCMonth(b);return this._dateComponentDidChange()}else{return this._dateObj.getUTCMonth()}},time:function(b){if(b!==undefined){this._dateObj.setTime(b);return this._dateComponentDidChange()}else{return this._dateObj.getTime()}},timezoneOffset:function(b){if(b!==undefined){this.set("_timezoneOffset",b);return this._dateComponentDidChange()}else{return this.get("_timezoneOffset")}},year:function(b){return this.fullYear(b)},changeDateType:function(b){if(b===this.dateType){return this}if(b===CW.DATE_ONLY||b===CW.DATE_TIME||b===CW.DATE_TIME_TO_MIDNIGHT||b===CW.DATE_TIME_SEC){this.dateType=b;this._dateComponentDidChange()}else{CW.fatalError("You must provide a valid date type.")}return this},weekNumber:function(t){t=(t?t:this._dateObj);var s=new Date(t.getUTCFullYear(),0,1),o=1,m=s.getUTCDay()-o,l=Math.floor((t.getTime()-s.getTime())/CW.DAY_MILLIS_DUR)+1,v,p,u,q,n;m=m>=0?m:m+7;if(m<4){v=Math.floor((l+m-1)/7)+1;if(v>52){p=new Date(t.getUTCFullYear()+1,0,1);u=p.getUTCDay()-o;u=u>=0?u:u+7;v=u<4?1:53}}else{q=Math.floor((l+m-1)/7);v=q===0?53:q}n=t.getUTCFullYear();if(v===53&&t.getUTCMonth()===0){n--}else{if(v===1&&t.getUTCMonth()===11){n++}}return[n,v]},weekNumberToDate:function(p,o){p=parseInt(p,0);o=parseInt(o,0);var l=new Date(o,0,10,12,0,0);var j=new Date(o,0,4,12,0,0);var m=new Date(j.getTime()-l.getUTCDay()*CW.DAY_MILLIS_DUR);var k=new Date(m.getTime()+(p-1)*604800000);var n=new Date(k.getTime()+518400000);var q=[k,n];return q},dateRangeOfWeek:function(){var k=this._dateObj;var g=k.getUTCDay(),f;if(g===0){f=6}else{f=g+1}var h=new Date(k.valueOf());h.setDate(k.getUTCDate()-f);var j=new Date(k.valueOf());j.setDate(k.getUTCDate()+(7-k.getUTCDay()));return[h,j]},daysInMonth:function(){var f=this.year(),e=this.month(),d=[31,28,31,30,31,30,31,31,30,31,30,31];return(e===1&&((f%4===0&&f%100!==0)||f%400===0))?29:d[e]},toTimeString:function(b){if(b){return this.format(b)}else{if(this.timeFormat){return this.format(this.timeFormat)}}return this._dateObj.toString().substr(16,5)},toString:function(d){if(d){return this.format(d)}else{if(this.fullDateFormat){return this.format(this.fullDateFormat)}else{var e=this._dateObj;if(e){return e.toString()}else{return"null"}}}},toDateString:function(b){if(b){return this.format(b)}else{if(this.dateFormat){return this.format(this.dateFormat)}}return this._dateObj.toString().substr(0,15)},parse:function(e){var d=this._dateObj;if(SC.typeOf(e)===SC.T_ARRAY){if(!isNaN(e[3])){d.setUTCDate(e[3])}if(!isNaN(e[1])){d.setUTCFullYear(e[1])}if(!isNaN(e[2])){d.setUTCMonth(e[2]-1)}if(!isNaN(e[3])&&e[3]!==d.getUTCDate()){d.setUTCDate(e[3])}if(this.dateType===CW.DATE_ONLY){d.setUTCHours(12);d.setUTCMinutes(0)}else{if(!isNaN(e[4])){d.setUTCHours(e[4])}if(!isNaN(e[5])){d.setUTCMinutes(e[5])}if(this.dateType===CW.DATE_TIME_SEC){if(!isNaN(e[6])){d.setUTCSeconds(e[6])}}}}else{if(e&&e.getTime){if(e._isUsingUTC){d.setUTCFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());d.setUTCHours(e.getUTCHours());d.setUTCMinutes(e.getUTCMinutes());if(this.dateType===CW.DATE_TIME_SEC){d.setUTCSeconds(e.getUTCSeconds())}}else{d.setUTCFullYear(e.getFullYear(),e.getMonth(),e.getDate());d.setUTCHours(e.getHours());d.setUTCMinutes(e.getMinutes());if(this.dateType===CW.DATE_TIME_SEC){d.setUTCSeconds(e.getSeconds())}}}}if(this.dateType!==CW.DATE_TIME_SEC){d.setUTCSeconds(0)}d.setUTCMilliseconds(0);d._isUsingUTC=true;this._dateObj=d;this._dateComponentDidChange();return this},format:function(M,K){M+="";if(K){M=M.loc()}var s=this._dateObj,U=this.value||{},ab=M.length,ai="",V=0,y="",am="",aj=U[1]+"",al=U[2],E=U[3],ag=s.getUTCDay(),ah=U[4],H=U[5],ad=s.getUTCSeconds(),Z,X,ao,aa,m,an,W,Y,af,ae,h,k,ak,ap,ac,d,A;if(aj.length<3){if(aj>=0&&aj<=28){aj=""+(aj+2000)}else{if(aj>=28&&aj<=99){aj=""+(aj+1900)}}}U.y=""+aj;U.yyyy=aj;U.yy=aj.substring(2,4);U.M=al;U.MM=LZ(al);U.MMM=MONTH_NAMES[al-1];U.NNN=MONTH_NAMES[al+11];U.d=E;U.dd=LZ(E);U.E=DAY_NAMES[ag+7];U.EE=DAY_NAMES[ag];U.H=ah;U.HH=LZ(ah);if(ah===0){U.h=12}else{if(ah>12){U.h=ah-12}else{U.h=ah}}U.hh=LZ(U.h);if(ah>11){U.K=ah-12}else{U.K=ah}U.k=ah+1;U.KK=LZ(U.K);U.kk=LZ(U.k);if(ah>11){U.a="SC.Date.Period.PM".loc()}else{U.a="SC.Date.Period.AM".loc()}U.m=H;U.mm=LZ(H);U.s=ad;U.ss=LZ(ad);while(V<ab){y=M.charAt(V);am="";while((M.charAt(V)==y)&&(V<ab)){am+=M.charAt(V++)}d=U[am];if(!SC.none(d)){A=d.toString().loc();ai+=A?A:d}else{ai+=am}}return ai},done:function(){if(CW.Date._pool.indexOf(this)===-1){CW.Date._pool.push(this)}this.timeFormat=this.fullTimeFormat=this.dateFormat=null;return SC.clone(this.value)},components:function(){return SC.clone(this.value)},clone:function(b){return CW.Date.create(SC.clone(this.value),(b)?b:this.dateType)},setValue:function(b){this.value=SC.clone(b);this._dateComponentDidChange()},_dateComponentDidChange:function(){var e=[0,0,0,0,0,0,0];var d=this._dateObj;e[1]=d.getUTCFullYear();e[2]=d.getUTCMonth()+1;e[3]=d.getUTCDate();e[0]=parseInt(e[1]+((e[2]<10)?"0":"")+e[2]+((e[3]<10)?"0":"")+e[3],0);if(this.dateType!==CW.DATE_ONLY){e[4]=d.getUTCHours();e[5]=d.getUTCMinutes();if(this.dateType===CW.DATE_TIME_SEC){e[6]=d.getUTCSeconds()}else{e[6]=(this.dateType===CW.DATE_TIME_TO_MIDNIGHT)?CW.DAY_MIN_DUR-(e[4]*60+e[5]):e[4]*60+e[5]}}this.value=e;return this}};SC.mixin(CW.Date,{_pool:[],parseDate:function(e,d){var f=new Date();if(SC.typeOf(e)!==SC.T_ARRAY){return f}f.setUTCFullYear(e[1]);f.setUTCMonth(e[2]);f.setUTCDate(e[3]);if(!d){f.setUTCHours(e[4]);f.setUTCMinutes(e[5])}f.setUTCSeconds(0);f.setUTCMilliseconds(0);return f},dateComponentsEqual:function(a,b){if(SC.typeOf(a)!==SC.T_ARRAY&&SC.typeOf(b)===SC.T_ARRAY){return NO}else{return(a[0]===b[0])}},datesEqual:function(b,h){if(b===h){return YES}var g=SC.typeOf(b),a=SC.typeOf(h);if(g!==a){return NO}else{return(b.value[0]===h.value[0])}},dateTimesEqual:function(a,b){if(SC.typeOf(a)!==SC.T_ARRAY&&SC.typeOf(b)===SC.T_ARRAY){return NO}else{return(a[0]===b[0]&&a[4]===b[4]&&a[5]===b[5])}},create:function(f,d){var e;if(CW.Date._pool.length>0){e=CW.Date._pool.pop();e.value=null;e.dateType=CW.DATE_ONLY}else{e=SC.beget(CW.Date)}e._dateObj=new Date();e._dateObj._isUsingUTC=true;if(f&&SC.typeOf(f)===SC.T_NUMBER){d=f;f=null}if(d!==undefined){e.dateType=d}e.parse(f);return e},createFromDateObject:function(f,d){var e;if(SC.typeOf(f)===SC.T_HASH){if(CW.Date._pool.length>0){e=CW.Date._pool.pop();e.value=null;e.dateType=CW.DATE_ONLY}else{e=SC.beget(CW.Date)}e._dateObj=f;e.dateType=d||CW.DATE_ONLY}},createFromDateComponent:function(m){if(!m){CW.fatalError("createFromDateComponent():  No date component was specified")}var l=Math.floor(m/10000),j=Math.floor(m/100)-(l*100),h=m-(l*10000)-(j*100),k=[m,l,j,h],g=CW.Date.create(k,CW.DATE_ONLY);return g},areDatesInRange:function(f,g,h,e){if(!f||!g){return NO}if(g[0]===h[0]&&g[6]===1440){return NO}return((f[0]>=h[0]&&f[0]<=e[0])||(g[0]>=h[0]&&g[0]<=e[0])||(f[0]<=h[0]&&g[0]>=e[0]))},compareDates:function(m,h,j){if(!m||!h){return m||h}var k,l,n,o;k=m._dateObj?m.components():m;l=h._dateObj?h.components():h;if(k[0]<l[0]){return(j?h:m)}else{if(k[0]===l[0]){n=k[4]*60+k[5];o=l[4]*60+l[5];if(n<o){return(j?h:m)}else{if(n>o){return(j?m:h)}else{return null}}}else{return(j?m:h)}}},greaterThan:function(f,d){if(SC.typeOf(f)===SC.T_ARRAY){f=CW.Date.create(f)}if(SC.typeOf(d)===SC.T_ARRAY){d=CW.Date.create(d)}var e=this.compareDates(f,d,YES);if(e===f){return YES}else{return NO}}});CW.DateFormatter=function(e,g){var f=e.dateObject(),h=new Date(f.getTime());if(f._isUsingUTC){h.setMinutes(h.getMinutes()+h.getTimezoneOffset())}return SC.DateFormatter(h,g)};CW.DateParser={parseDate:function(N,ab,L,Z){var ac,A,Q,M,J,R,T,K,ae,V,ad,P,ag,ah,U,I,O=["Sunday".loc().toLowerCase(),"Monday".loc().toLowerCase(),"Tuesday".loc().toLowerCase(),"Wednesday".loc().toLowerCase(),"Thursday".loc().toLowerCase(),"Friday".loc().toLowerCase()],b=N.toLowerCase(),S,a,W,Y,aa,af=SC.Locale.currentLocale.language,X;if(!isNaN(N)&&parseInt(N,10)>31){ac=CW.Date.create(ab);I=N.length;if(I===2){if(!L){A=parseInt(N.charAt(0),10)-1;Q=parseInt(N.charAt(1),10)}else{A=parseInt(N.charAt(1),10)-1;Q=parseInt(N.charAt(0),10)}M=new Date().getFullYear()}else{if(I===3){P=N;J=parseInt(N.charAt(0),10);K=parseInt(N.substr(0,2),10);ae=parseInt(N.substr(1,2),10);T=parseInt(N.charAt(2),10);if(!L){A=(K<=12)?(K-1):(J-1);Q=(K<=12)?T:ae}else{A=(ae<=12)?(ae-1):(T-1);Q=(ae<=12)?J:K}M=new Date().getFullYear()}else{if(I===4){ag=N;J=parseInt(N.charAt(0),10);K=parseInt(N.substr(0,2),10);V=parseInt(N.substr(2,2),10);R=parseInt(N.charAt(1),10);if(!L){A=(K<=12&&V<=31)?(K-1):(J-1);Q=(K<=12&&V<=31)?V:R;M=(K<=12&&V<=31)?new Date().getFullYear():2000+V}else{A=(ae<=12)?(ae-1):(T-1);Q=(ae<=12)?J:K}}else{if(I===5){ah=parseInt(N,10).toString();J=parseInt(N.charAt(0),10);K=parseInt(N.substr(0,2),10);ae=parseInt(N.substr(1,2),10);U=parseInt(N.substr(3,2),10);T=parseInt(N.substr(2,1),10);if(!L){A=(K<=12)?(K-1):(J-1);Q=(K<=12)?T:ae}else{A=(ae<=12)?(ae-1):(T-1);Q=(ae<=12)?J:K}M=2000+U}else{if(I>=6&&I<=8){K=parseInt(N.substr(0,2),10);V=parseInt(N.substr(2,2),10);T=parseInt(N.charAt(2),10);U=parseInt(N.substr(3,2),10);ad=parseInt(N.substr(4),10);if(!(I===6&&V===20)&&!(I===7&&U===20)){A=(K<=12)?(K-1):((V<=12&&K>=1&&K<=31)?(V-1):-1);Q=(V>=1&&V<=31&&A===(K-1))?V:((K>=1&&K<=31&&A===(V-1))?K:-1);M=I>6?ad:2000+ad}else{if(I===6&&V===20){if(!L){A=J-1;Q=R}else{A=R-1;Q=J}}else{if(I===7&&U===20){if(!L){A=(K<=12)?(K-1):(J-1);Q=(K<=12)?T:ae}else{A=(ae<=12)?(ae-1):(T-1);Q=(ae<=12)?J:K}}}}}}}}}if(A<0||A>=12||Q<1||Q>31||M<0){ac=null}else{ac._dateObj.set({month:A,day:Q,year:M});ac._dateComponentDidChange()}}else{if(!isNaN(N)&&(X=parseInt(N,10))<31&&X<31){ac=CW.Date.create();ac._dateObj=Date.parse(N);ac._dateComponentDidChange()}}return ac}};CW.FakeReply=SC.Object.extend({isFakeReply:YES,shouldProcessRequestNormally:NO,applyToBackgroundRequests:NO,status:undefined,statusText:undefined,responseText:undefined,urlFilter:undefined,delay:undefined,readyState:undefined,getAllResponseHeaders:function(){return null},abort:function(){},toString:function(){if(this.get("shouldProcessRequestNormally")){return"will be sent normally"}else{var l=[],m=CW.FakeReply.allowableCreationParams,g,h,j,k;for(g=0,h=m.length;g<h;++g){j=m[g];k=this.get(j);if(k!==undefined){if(j==="applyToBackgroundRequests"&&!k){continue}if(SC.typeOf(k)===SC.T_STRING){l.push("%@=%@".fmt(j,k))}else{l.push("%@=%@".fmt(j,k))}}}return l.join(",  ")}}});SC.mixin(CW.FakeReply,{allowableCreationParams:["applyToBackgroundRequests","status","statusText","responseText","responseHash","urlFilter","delay"],_allowableCreationParamsHash:null,createFakeReply:function(A){var s=CW.FakeReply,u=s._allowableCreationParamsHash,B,D,y,x;if(!u){u=s._allowableCreationParamsHash={};D=s.allowableCreationParams;for(y=0,x=D.length;y<x;++y){B=D[y];u[B]=YES}}if(A===null){return s.create({shouldProcessRequestNormally:YES})}else{if(!A){CW.fatalError("You must specify params for the fake reply")}}var t=NO;for(B in A){if(!u[B]){if(console.error){console.error("Fake reply has an unrecognized parameter %@:".fmt(B),A)}t=YES}}if(t){CW.fatalError("Unrecognized parameter in fake reply")}var q=0;var z=A.status;if(z===undefined){if(console.error){console.error("Fake reply does not include a status:",A)}++q}else{if(!z){if(console.error){console.error("Fake reply has an invalid status of 0:",A)}++q}}var v=A.responseText,C=A.responseHash;if(v===undefined&&!C){v=A.responseText="Fake reply with status "+z}else{if(v!==undefined&&C){if(console.error){console.error("Fake reply has both a responseText and a responseHash:",A)}++q}else{if(v!==undefined&&SC.typeOf(v)!==SC.T_STRING){if(console.error){console.error("Fake reply has an invalid responseText (it should be a string):",A)}++q}else{if(C&&SC.typeOf(C)!==SC.T_HASH){if(console.error){console.error("Fake reply has an invalid responseHash (it should be a hash):",A)}++q}}}}var e=A.urlFilter;if(e&&!(e instanceof RegExp)){if(SC.typeOf(e)===SC.T_STRING){A.urlFilter=new RegExp(e)}else{if(console.error){console.error("Fake reply has an invalid urlFilter (it should be a string or a RegExp instance):",A)}++q}}if(C&&q===0){delete A.responseHash;try{A.responseText=SC.json.encode(C)}catch(w){if(console.error){console.error("There was an error encoding JSON from the responseHash:  "+w+",  fake reply:",A)}++q}}if(q===1){CW.fatalError("There was one error with the fake reply parameters")}else{if(q>0){CW.fatalError("There were %@ errors with the fake reply parameters".fmt(q))}else{return s.create(A)}}}});sc_require("core");sc_require("core_error_handling");sc_require("system/fake_reply");CW.mixin({requestLoggingLevel:null,fakeReplyQueue:null,addFakeReply:function(t,p){if(SC.typeOf(t)!==SC.T_ARRAY){t=SC.$A(t)}var e=CW.FakeReply,s=[],x,v,y,A;for(x=0,v=t.length;x<v;++x){y=t[x];A=null;try{A=e.createFakeReply(y)}catch(u){}if(A){s.push(A)}}var w=t.length,q=s.length;if(w!==q){var z=w-q;if(z===1){CW.fatalError("Errors prevented your fake reply from being added.  The fake reply queue was not changed.")}else{CW.fatalError("Errors prevented %@ of your %@ fake replies from being added.  The fake reply queue was not changed.".fmt(z,w))}}var B=this.get("fakeReplyQueue");if(!B){B=[];this.set("fakeReplyQueue",B)}B.beginPropertyChanges();for(x=0,v=s.length;x<v;++x){A=s[x];B.pushObject(A)}B.endPropertyChanges();if(!p){console.log("The fake reply queue is now:");this.listFakeReplyQueue()}},listFakeReplyQueue:function(){var f=this.get("fakeReplyQueue");if(!f){console.log("(no fake reply queue)")}else{var h=[],k,g,j;for(k=0,g=f.length;k<g;++k){j=f[k];h.push("[%@]  %@".fmt(k,j))}console.log(h.join("\n"))}},_recordingCount:0,_logRequestIfAppropriateFor:function(q){if(!q){CW.fatalError("_logRequestIfAppropriateFor():  A response must be specified")}var n=this.get("requestLoggingLevel"),t=++this._recordingCount,p,v,u,s,m,o,l;if(n){q._recordingID=t;q._sentAt=new Date();p=q.get("request");v=p.get("type");u=p.getFullAddress();s=this._sortAndStringifyHeaders(p.get("headers"));m=p.get("cookies");if(p.get("bodyShouldBeLogged")){o=p.get("encodedBody");if(!o){o="(empty)"}}else{o="(omitted)"}l="-->  Request "+t+":   "+v+" to "+u+",  headers: "+s+(m?",  cookies: "+m:"")+",  body: "+o;SC.Logger._handleMessage(n,NO,l)}},_logResponseIfAppropriate:function(w){if(!w){CW.fatalError("_logResponseIfAppropriateFor():  A response must be specified")}var q=this.get("requestLoggingLevel"),s=new Date(),B,x,A,p,y,v,z,u,e;if(q){B=w._recordingID;x=w._sentAt;A=w._receivedAtWhileSuspended;p=w.get("timedOut");if(p){y="  (timed out)"}else{if(A){y=x?("  ("+(A-x)+"ms, suspended for "+(s-A)+"ms)"):"  (unknown)"}else{y=x?("  ("+(s-x)+"ms)"):"  (unknown)"}}v=w.get("status");try{z=this._sortAndStringifyHeaders(w.get("headers"))}catch(t){}if(w.get("bodyShouldBeLogged")){u=w.get("encodedBody");if(!u){u="(empty)"}}else{u="(omitted)"}e="<--  Response "+B+":  "+v+y+",  headers: "+z+"  body: "+u;SC.Logger._handleMessage(q,NO,e)}},_sortAndStringifyHeaders:function(l){var k,m,h,o,j,n=[];for(k in l){n.push(k)}n.sort();h="";for(o=0,j=n.length;o<j;++o){k=n[o];m=l[k];if(o!==0){h+=", "}h+=k+"="+m}return h}});CW.Response=SC.XHRResponse.extend({bodyShouldBeLogged:function(){var b=this.get("status");return(!SC.none(b)&&b!==200)}.property("status"),fakeReply:null,overallTimeoutTimer:null,addedToOutgoingQueueTimestamp:null,getFullAddress:function(){return this.get("request").getFullAddress()},notify:function(){var f=arguments.callee.base.apply(this,arguments),d=CW.RequestManagement,e;if(d){e=d.sharedInstance()}if(e){e.removeOutstandingResponse(this)}return f},fire:function(j){var g=this.get("request"),k=g?g.get("source"):null;if(k&&k.willSend){k.willSend(g,this)}g.freeze();if(!this.get("isCancelled")){this.invokeTransport(j)}var f=g.get("timeout");if(f){var h=SC.Timer.schedule({target:this,action:"timeoutReached",interval:f,repeats:NO});this.set("timeoutTimer",h)}if(!this.get("isCancelled")&&k&&k.didSend){k.didSend(g,this)}},timeoutReached:function(){var b=this.get("timeoutTimer");if(b){b.invalidate()}b=this.get("overallTimeoutTimer");if(b){b.invalidate()}return arguments.callee.base.apply(this,arguments)},receive:function(f,e){var d=this.get("overallTimeoutTimer");if(d){d.invalidate()}return arguments.callee.base.apply(this,arguments)},invokeTransport:function(){var k=this.get("fakeReply"),g;if(k){this.set("rawRequest",k);g=k.get("delay");this.invokeLater(this._triggerFakeReply,g)}else{var l=this.createRequest(),j,h,m;this.set("rawRequest",l);m=!!this.getPath("request.isAsynchronous");if(m){if(!SC.browser.msie&&!SC.browser.opera){SC.Event.add(l,"readystatechange",this,this.finishRequest,l)}else{j=this;h=function(){if(!j){return null}var a=j.finishRequest();if(a){j=null}return a};l.onreadystatechange=h}}l.open(this.get("type"),this.getFullAddress(),m);this.setRequestHeaders();if(this.getPath("request.useCrossDomain")&&this.getPath("request.withCredentials")){l.withCredentials=true}l.send(this.getPath("request.encodedBody"));if(!m){this.finishRequest()}return l}},setRequestHeaders:function(){var d=this.get("rawRequest"),f=this.getPath("request.headers");for(var e in f){d.setRequestHeader(e,f[e])}},cancelTransport:function(){var b=this.get("fakeReply");if(b){return}else{return arguments.callee.base.apply(this,arguments)}},_triggerFakeReply:function(){var b=this.get("fakeReply");if(b){b.set("readyState",4);this.finishRequest(undefined)}}});sc_require("system/response");CW.IFramePostMessageResponse=CW.Response.extend({isCrossDomain:YES,requestId:-1,rawResponse:null,_activeRequests:{},destinationDomain:"",headers:function(){var e=this.get("rawResponse");if(!e){return{}}var f=e.headers,d={};if(!f){return d}f.split("\n").forEach(function(a){var j=a.indexOf(":"),h,b;if(j>=0){h=a.slice(0,j);b=a.slice(j+1).trim();d[h]=b}},this);return d}.property("status").cacheable(),header:function(e){var d=this.get("headers");return d[e]||null},encodedBody:function(){var b=this.get("rawResponse");if(!b){return""}return b.responseText}.property("status").cacheable(),invokeTransport:function(h){var k=this.get("request");var g={requestId:h,url:k.getFullAddress(),type:k.get("type"),headers:k.get("headers"),body:k.get("body"),isAsynchronous:k.get("isAsynchronous")};var e=SC.Request.manager.get("crossDomainIFrames")[k.get("destinationDomain")];try{e.contentWindow.postMessage(SC.json.encode(g),this.get("destinationDomain"))}catch(j){SC.debug('CW.IFramePostMessageResponse: iFrame not properly loaded from "%@". Maybe ajax_sender.html is missing?',e.src)}},finishRequest:function(m){var k=this.get("rawResponse"),h=k.readyState,l,g,j;if(h===4&&!this.get("timedOut")){this.receive(function(d){if(!d){return}g=-1;try{g=k.status||0}catch(a){}if((g<200)||(g>=300)){try{j=k.statusText||""}catch(b){j=""}l=SC.$error(j||"HTTP Request failed","Request",g);l.set("errorValue",this);this.set("isError",YES);this.set("errorObject",l)}this.set("status",g)},this);if(!SC.browser.msie&&!SC.browser.opera){SC.Event.remove(k,"readystatechange",this,this.finishRequest)}else{k.onreadystatechange=null}return YES}return NO},cancelTransport:function(){this.set("rawRequest",null)}});sc_require("core");CW.ImagePreloader=SC.Object.extend({images:null,callBack:null,init:function(){this.loadImages()},loadImages:function(){this._numLoaded=0;this._numProcessed=0;this._allImages=[];this._numImages=this.get("images").length;for(var b=0;b<this._numImages;b++){this.preload(this.get("images")[b])}},preload:function(e){var d=new Image;this._allImages.push(d);theImage=this;d.onload=function(){theImage.onload.call(theImage)};d.onerror=function(){theImage.onerror.call(theImage)};d.onabort=function(){theImage.onabort.call(theImage)};d.sLoaded=false;d.src=e},onComplete:function(){this._numProcessed++;if(this._numProcessed===this._numImages){this.callBack(this._allImages,this._numLoaded)}},onload:function(){this.sLoaded=true;this._numLoaded++;this.onComplete()},onerror:function(){this.sError=true;this.onComplete()},onabort:function(){this.sAbort=true;this.onComplete()}});CW.KeyResponder={_kr_init:function(){var b=this.keyboardShortcuts||{};b=SC.clone(b);this.keyboardShortcuts=b;this._kr_hasInited=YES},registerKeyboardShortcut:function(e,f,d){if(!this._kr_hasInited){this._kr_init()}if(!d){d=f;this.keyboardShortcuts[e]=d}else{this.keyboardShortcuts[e]={target:f,action:d}}},deregisterKeyboardShortcut:function(b){if(!this._kr_hasInited){this._kr_init()}delete this.keyboardShortcuts[b]},performKeyEquivalent:function(k,f){if(!this._kr_hasInited){this._kr_init()}if(CW.LOG_KEYBOARD_SHORTCUTS){SC.Logger.log("Responder attempting to find keyboard shortcut for %s",k)}var g=this.keyboardShortcuts[k];if(g){var j=g,h=this;if(typeof g==="object"){h=g.target;j=g.action}if(typeof j!=="string"){return j.call(h,k,f)}return SC.RootResponder.responder.sendAction(j,h,this,k,f)}return NO}};SC.mixin(CW,{LOG_KEYBOARD_SHORTCUTS:YES,registerKeyboardShortcut:function(e,f,d){CW.globalKeyResponder.registerKeyboardShortcut(e,f,d)},deregisterKeyboardShortcut:function(b){CW.globalKeyResponder.deregisterKeyboardShortcut(b)},keyResponders:[],globalKeyResponder:SC.Object.create(CW.KeyResponder),addKeyResponder:function(b){this.keyResponders.push(b)},removeKeyResponder:function(b){this.keyResponders.removeObject(b)},performKeyEquivalent:function(h,k){if(CW.LOG_KEYBOARD_SHORTCUTS){SC.Logger.log("Attempting to find keyboard shortcut for %s",h)}var j=this.keyResponders,f,g=j.length;for(f=g-1;f>=0;f--){if(j[f].performKeyEquivalent(h,k)){return YES}}return NO},installKeyResponder:function(){}});CW.keyResponders.push(CW.globalKeyResponder);CW.LOG_NOTIFICATIONS=YES;CW.notificationCenter=SC.Object.create({_subscriptions:{},postNotification:function(m){var t=this._subscriptions;if(!t[m]){if(CW.LOG_NOTIFICATIONS){SC.info("Notification Center: Could not find any subscribers for %@, returning.".fmt(m))}return}var n=t[m];var s=n.length;var l=SC.A(arguments).slice(1);if(!l){l=[]}if(CW.LOG_NOTIFICATIONS){SC.info("Notification Center: Posting notification %@".fmt(m))}for(var p=0;p<s;p++){var k=n[p];if(k){var q=k.action;var o=k.target;q.apply(o,l)}}},_targetForTargetName:function(b){if(SC.typeOf(b)===SC.T_STRING){return SC.objectForPropertyPath(b)}return b},_methodForMethodNameInTarget:function(e,d){if(SC.typeOf(e)===SC.T_STRING){return SC.objectForPropertyPath(e,d)}return e},subscribeToNotification:function(m,o,s){o=this._targetForTargetName(o);s=this._methodForMethodNameInTarget(s,o);if(!s){throw"You must pass a action to subscribeToNotification()"}var t=this._subscriptions;var n=t[m];if(!n){n=t[m]=[]}var k=false;var p=n.length;for(var q=0;q<p;q++){var l=n[q];if(l.action===s&&l.target===o){k=true}}if(!k){if(CW.LOG_NOTIFICATIONS){SC.info("Notification Center: Subscribed to %@".fmt(m))}t[m].push({action:s,target:o});this._subscriptions=t}},unsubscribeFromNotification:function(m,o,q){var t=this._subscriptions;o=this._targetForTargetName(o);q=this._methodForMethodNameInTarget(q,o);if(!q){throw"You must pass a action to subscribeToNotification()"}var n=t[m];if(!n){return}var s=n.length;var k=-1;for(var p=0;p<s;p++){var l=n[p];if(l.action===q&&l.target===o){k=p}}if(k!==-1){if(CW.LOG_NOTIFICATIONS){SC.info("Notification Center: Subscribed to %@".fmt(m))}t[m].splice(k,1);this._subscriptions=t}}});sc_require("system/response");CW.Request=SC.Request.extend({COPY_KEYS:SC.Request.prototype.COPY_KEYS.concat(["overallTimeout","addressPrefix","useCrossDomain","withCredentials","id","isCancelled","destinationDomain","cycle","action","isBackgroundRequest","_crossDomainMethod","_queryParameters","_isRead","isRead","isWrite","_isPending","_cycleWhenPended","_cycleWhenSent"]),responseClass:undefined,timeout:30000,overallTimeout:null,addressPrefix:null,useCrossDomain:NO,withCredentials:NO,iFrameScriptLocation:"ajax_sender.html",id:null,isCancelled:NO,cycle:null,action:null,isBackgroundRequest:NO,init:function(){arguments.callee.base.apply(this,arguments);this.queryParameter("lang",String.preferredLanguage)},isRead:function(f,h){if(h===undefined){var g=this._isRead;if(g!==undefined){return g}else{var e=this.get("type");if(!e){CW.fatalError("No type was specified, so we dont know whether this request is a read or a write.")}else{return e.toLowerCase()==="get"}}}else{this._isRead=h;return h}}.property("type").cacheable(),isWrite:function(e,d){if(d===undefined){return !this.get("isRead")}else{this.set("isRead",!d);return d}}.property("isRead").cacheable(),bodyShouldBeLogged:NO,queryParameter:function(e,d){var f;if(SC.typeOf(e)===SC.T_STRING){f=this._queryParameters;if(arguments.length===1){return f?f[e]:null}else{this.propertyWillChange("queryParameters");if(!f){f=this._queryParameters={}}f[e]=d;this.propertyDidChange("queryParameters");return this}}else{if(d===undefined){f=e;this.beginPropertyChanges();for(e in f){if(!f.hasOwnProperty(e)){continue}this.queryParameter(e,f[e])}this.endPropertyChanges();return this}else{CW.fatalError("queryParameter():  You must pass in either a key or a hash of query parameters",{target:this})}}return this},clearQueryParameters:function(){this.propertyWillChange("queryParameters");this._queryParameters={};this.propertyDidChange("queryParameters")},queryParameters:function(){return this._queryParameters}.property().cacheable(),addressWithQueryParameters:function(){var b=URI(this.get("address")).addQuery(this.get("queryParameters")).sortQuery().normalize().toString();return b}.property("address","queryParameters").cacheable(),send:function(u,w){this._determineResponseClassAndMethod();var x;if(this.get("isAsynchronous")===NO){x=this._crossDomainMethod;if(x&&x!=="cors"){CW.fatalError("You cannot send a synchronous request using iframes with postMessage",{target:this})}}var o=CW.RequestManagement,s=o?o.sharedInstance():null,t,n,q,v;this._isPending=NO;this._cycleWhenPended=null;this._cycleWhenSent=this.get("cycle");n=this._getFakeReply();var p=this.get("timeout");if(p&&!this.get("isAsynchronous")){throw"Timeout values cannot be used with synchronous requests"}else{if(p===0){throw"The timeout value must either not be specified or must be greater than 0"}}if(u){this.set("body",u)}var m=SC.clone(this._queryParameters);v=this.copy()._prep();v._queryParameters=m;if(n){v._fakeReplyToUse=n}t=SC.Request.manager.sendRequest(v);if(t&&s){s.addOutstandingResponse(t)}if(w&&s){s.removePendingRequest(this)}return t},sendAfterDelay:function(f,g){if(!g){CW.fatalError("sendAfterDelay():  You must specify a delay",{target:this})}var h=CW.RequestManagement,e=h?h.sharedInstance():null;this._isPending=YES;this._cycleWhenPended=this.get("cycle");if(e){e.addPendingRequest(this)}this.invokeLater(this.send,g,f,YES)},resend:function(m,j){var k=this._getFakeReply(),n,l,o,h;l=this.get("source")?this:this.copy()._prep();if(k){l._fakeReplyToUse=k}n=SC.Request.manager.sendRequest(l,m);if(n){o=CW.RequestManagement;h=o?o.sharedInstance():null;if(h){h.addOutstandingResponse(n)}}if(j&&h){h.removePendingRequest(this)}return n},resendAfterDelay:function(g,h){if(!h){CW.fatalError("resendAfterDelay():  You must specify a delay",{target:this})}var e=CW.RequestManagement,f=e?e.sharedInstance():null;this._isPending=YES;this._cycleWhenPended=this.get("cycle");if(f){f.addPendingRequest(this)}this.invokeLater(this.resend,h,g,YES)},getFullAddress:function(){var d=this.get("addressPrefix"),e=this.get("addressWithQueryParameters");if(d){e=d+e}return e},didSend:function(d,e){var f;CW._logRequestIfAppropriateFor(e);f=e.get("rawRequest");if(f&&f.isFakeReply){SC.info("Using fake reply (%@) for request:  %@",f,d)}},didReceive:function(g,h){var e=CW.Request,f;if(e._responseSuspendCount>0){h._receivedAtWhileSuspended=new Date();f=e._suspendedResponses;if(!f){f=e._suspendedResponses=[h]}else{f.push(h)}if(!h.get("isCancelled")){h._receivedWhenSuspended=YES;h.set("isCancelled",YES)}}else{CW._logResponseIfAppropriate(h)}},destinationDomain:function(){var f=this.getFullAddress(),e=null,g,h;if(f){if(URI(f).protocol()===""||URI(f).host()===""){SC.error("Malformed URL: "+f);return null}e=URI(f).protocol()+"://"+URI(f).host()}return e}.property("addressPrefix","address"),cycleDidChange:function(){var e=CW.RequestManagement,f=e?e.sharedInstance():null,g,h;if(f){g=this.get("cycle");if(this._isPending){if(g!==this._cycleWhenPended){f.cycleDidChangeForPendingRequest()}}else{h=this._cycleWhenSent;if(h&&(g!==h)){f.cycleDidChangeForOutstandingResponse()}}}}.observes("cycle"),toString:function(){var d=arguments.callee.base.apply(this,arguments),e=this.get("address");if(e){d+=" ("+e+")"}return d},_crossDomainMethod:null,_queryParameters:null,_isPending:NO,_cycleWhenPended:null,_cycleWhenSent:null,_determineResponseClassAndMethod:function(){var e=SC.kindOf,d,f;if(this.get("useCrossDomain")){d=this.get("responseClass");if(!d){if(XMLHttpRequest&&"withCredentials" in new XMLHttpRequest()){d=CW.Response}else{if(this._isAppropriateForXDomainRequest()){d=CW.XDRResponse}else{if(window.postMessage){d=CW.IFramePostMessageResponse}else{if(SC.browser.msie&&SC.browser.version<=7){d=CW.IFrameDocumentDomainResponse}}}}}if(!this._crossDomainMethod){if(e(d,CW.IFramePostMessageResponse)){f="postMessage"}else{if(e(d,CW.IFrameDocumentDomainResponse)){f="documentDomain"}else{if(e(d,CW.Response)||e(d,CW.XDRResponse)){f="cors"}}}if(f){this._crossDomainMethod=f}}}else{d=CW.Response}if(!this.get("responseClass")&&d){this.set("responseClass",d)}},_isAppropriateForXDomainRequest:function(){var d=this.get("headers"),e=YES,f;if(d){for(f in d){if(f.toLowerCase()!=="content-type"||d[f]!=="text/plain"){e=NO}}}if(e&&SC.browser.msie&&SC.browser.version<=9&&!this.get("withCredentials")){return YES}return NO},_getFakeReply:function(){var s=CW.get("fakeReplyQueue"),k=s?s.length:0,o=null,n,m,p,q,l,t;if(k>0){n=this.get("isBackgroundRequest");m=null;for(p=0;p<k;++p){q=s[p];if(n&&!q.get("applyToBackgroundRequests")){continue}l=q.get("urlFilter");if(l){t=this.get("address");if(!t||!l.test(t)){continue}}s.removeAt(p,1);m=q;break}if(m){if(!m.get("shouldProcessRequestNormally")){o=m}}}return o}});CW.Request.mixin({suspendResponses:function(){++this._responseSuspendCount},resumeResponses:function(){var l=--this._responseSuspendCount,j,p,k,q,n,m;if(l<0){SC.warn("CW.Response.resumeResponses() was called without a paired suspendResponses() invocation; ignoring");this._responseSuspendCount=0}var o=function(){if(q.get("isCancelled")&&q._receivedWhenSuspended){q.set("isCancelled",NO);n=q.get("request");m=n.get("source");if(m&&m.didReceive){m.didReceive(n,q)}if(!q.get("isCancelled")){q.notify()}}};j=this._suspendedResponses;k=j?j.length:0;for(p=0;p<k;++p){q=j[p];SC.run(o)}},_responseSuspendCount:0,_suspendedResponses:null});SC.Request.manager.mixin({crossDomainIFrames:{},_requestId:0,_crossDomainXHRLoaderURL:"",shouldFireRequest:null,_createCrossDomainIFrame:function(g,h){if(!g){CW.fatalError("_createCrossDomainIFrame():  A destination domain must be specified",{target:this})}if(!h){CW.fatalError("_createCrossDomainIFrame():  An AJAX sender URL must be specified",{target:this,destinationDomain:g})}var f=document.createElement("iframe"),e=this;if(h[0]!=="/"){h="/"+h}f.loaded=false;f.onload=f.onreadystatechange=function(){if(!f.loaded&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){f.loaded=true;e.fireRequestIfNeeded()}};if(g[g.length-1]==="/"){g=g.substr(0,g.length-1)}f.src=g+h;f.style.display="none";document.body.appendChild(f);f.className="crossdomain-iframe";SC.Event.add(window,"message",this,"_messageWasReceived",null,true);this.get("crossDomainIFrames")[g]=f;this.notifyPropertyChange("crossDomainIFrames")},_messageWasReceived:function(q){var j=q.originalEvent;var p=SC.json.decode(j.data);if(!p.isIFramePostMessageResponse){return}var l=p.headers,m=this.get("inflight"),k,n,o;for(o=0,k=m.length;o<k;o++){n=m[o];if(n.requestId===p.requestId){if(!URI(j.origin).baseEquals(URI(n.get("destinationDomain")))){CW.fatalError("Potential cross domain attack, postMessage from unknown origin, %@",j.origin);return}n.set("rawResponse",p);n.set("rawRequest",p);n.finishRequest();return}}},sendRequest:function(p,o){if(!p){return null}var t=this._requestId,s=p.get("responseClass").create({request:p,requestId:t}),l,m,q,u;if(s.get("isCrossDomain")){var n=p.get("destinationDomain"),v=p._crossDomainMethod;if((v==="postMessage"||v==="documentDomain")&&!this.get("crossDomainIFrames")[n]){this._createCrossDomainIFrame(n,p.get("iFrameScriptLocation"))}s.set("destinationDomain",n)}if(o){s.set("retryOf",o)}this._requestId=++t;s.set("addedToOutgoingQueueTimestamp",new Date());l=p._fakeReplyToUse;if(l){s.set("fakeReply",l);delete p._fakeReplyToUse}m=p.get("timeout");q=p.get("overallTimeout");if(q===null&&m){q=m;p.set("overallTimeout",m)}if(q){u=SC.Timer.schedule({target:s,action:"timeoutReached",interval:q,repeats:NO});s.set("overallTimeoutTimer",u)}this.get("pending").pushObject(s);this.fireRequestIfNeeded();return s},fireRequestIfNeeded:function(){var u=this.get("pending"),o=this.get("inflight"),n=this.get("maxRequests"),p=u.length,l,s,m,q;if((p>0)&&(o.length<n)){l=this.shouldFireRequest;if(l){for(q=0;q<p;++q){s=u.objectAt(q);if(l(s)){m=s;u.removeAt(q);break}}}else{m=u.shiftObject()}if(!m){return}if(m.get("isCrossDomain")){var t=this.get("crossDomainIFrames")[m.get("destinationDomain")];if(!t||!t.loaded){SC.debug("CW.Request.manager: postponing the sending of %@ since the necessary iframe is not loaded",m);u.unshift(m);return}}o.pushObject(m);this.set("inflight",o);var v=m.get("requestId");m.fire(v)}this.propertyDidChange("inflight")}});CW.RequestManagement=SC.Object.extend({pendingRequests:null,outstandingResponses:null,addPendingRequest:function(d){var e=this.get("pendingRequests");e.pushObject(d)},addOutstandingResponse:function(d){if(!d.getPath("request.isAsynchronous")){SC.debug("Skipping response registration for synchronous response %@",d);return}var e=this.get("outstandingResponses");e.pushObject(d)},removePendingRequest:function(f){var d=this.get("pendingRequests"),e=d.indexOf(f);if(e!==-1){d.removeAt(e,1)}},removeOutstandingResponse:function(f){var d=this.get("outstandingResponses"),e=d.indexOf(f);if(e!==-1){d.removeAt(e,1)}},pendingRequestsForCycle:function(k){var j=this.get("pendingRequests"),m=null,l,h,g;for(l=0,h=j.length;l<h;++l){g=j[l];if(g.get("cycle")===k){if(!m){m=[g]}else{m.push(g)}}}return m},outstandingResponsesForCycle:function(j){var g=this.get("outstandingResponses"),l=null,k,h,m;for(k=0,h=g.length;k<h;++k){m=g[k];if(m.getPath("request.cycle")===j){if(!l){l=[m]}else{l.push(m)}}}return l},cycleDidChangeForPendingRequest:function(){this.get("pendingRequests").enumerableContentDidChange()},cycleDidChangeForOutstandingResponse:function(){this.get("outstandingResponses").enumerableContentDidChange()},numberOfPendingOrOutstandingReadsForCycle:function(b){return(this.numberOfPendingReadRequestsForCycle(b)+this.numberOfOutstandingReadResponsesForCycle(b))},numberOfPendingReadRequestsForCycle:function(l){var m,h,g,j=0,k=this.pendingRequestsForCycle(l);if(k){for(m=0,h=k.length;m<h;++m){g=k[m];if(g.get("isRead")){j++}}}return j},numberOfOutstandingReadResponsesForCycle:function(k){var l,h,m,j=0,g=this.outstandingResponsesForCycle(k);if(g){for(l=0,h=g.length;l<h;++l){m=g[l];if(m.getPath("request.isRead")){j++}}}return j},numberOfPendingOrOutstandingWritesForCycle:function(b){return(this.numberOfPendingWriteRequestsForCycle(b)+this.numberOfOutstandingWriteResponsesForCycle(b))},numberOfPendingWriteRequestsForCycle:function(l){var m,h,g,j=0,k=this.pendingRequestsForCycle(l);if(k){for(m=0,h=k.length;m<h;++m){g=k[m];if(g.get("isWrite")){j++}}}return j},numberOfOutstandingWriteResponsesForCycle:function(k){var l,h,m,j=0,g=this.outstandingResponsesForCycle(k);if(g){for(l=0,h=g.length;l<h;++l){m=g[l];if(m.getPath("request.isWrite")){j++}}}return j},init:function(){var b=arguments.callee.base.apply(this,arguments);this.pendingRequests=[];this.outstandingResponses=[];return b}});CW.RequestManagement.mixin({sharedInstance:function(){var b=this._singleton;if(!b){b=this._singleton=CW.RequestManagement.create()}return b},_singleton:null});SHA1=SC.Object.create({hexcase:1,b64pad:"",hex_sha1:function(b){return this.rstr2hex(this.rstr_sha1(this.str2rstr_utf8(b)))},b64_sha1:function(b){return this.rstr2b64(this.rstr_sha1(this.str2rstr_utf8(b)))},sha1_vm_test:function(){return this.hex_sha1("abc").toLowerCase()==="a9993e364706816aba3e25717850c26c9cd0d89d"},rstr_sha1:function(b){return this.binb2rstr(this.binb_sha1(this.rstr2binb(b),b.length*8))},rstr2hex:function(k){var h=this.hexcase?"0123456789ABCDEF":"0123456789abcdef";var f="";var g;for(var j=0;j<k.length;j++){g=k.charCodeAt(j);f+=h.charAt((g>>>4)&15)+h.charAt(g&15)}return f},rstr2b64:function(o){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var h="";var j=o.length;for(var m=0;m<j;m+=3){var k=(o.charCodeAt(m)<<16)|(m+1<j?o.charCodeAt(m+1)<<8:0)|(m+2<j?o.charCodeAt(m+2):0);for(var n=0;n<4;n++){if(m*8+n*6>o.length*8){h+=b64pad}else{h+=l.charAt((k>>>6*(3-n))&63)}}}return h},str2rstr_utf8:function(k){var f="";var j=-1;var g,h;while(++j<k.length){g=k.charCodeAt(j);h=j+1<k.length?k.charCodeAt(j+1):0;if(55296<=g&&g<=56319&&56320<=h&&h<=57343){g=65536+((g&1023)<<10)+(h&1023);j++}if(g<=127){f+=String.fromCharCode(g)}else{if(g<=2047){f+=String.fromCharCode(192|((g>>>6)&31),128|(g&63))}else{if(g<=65535){f+=String.fromCharCode(224|((g>>>12)&15),128|((g>>>6)&63),128|(g&63))}else{if(g<=2097151){f+=String.fromCharCode(240|((g>>>18)&7),128|((g>>>12)&63),128|((g>>>6)&63),128|(g&63))}}}}}return f},rstr2binb:function(d){var f;var e=Array(d.length>>2);for(f=0;f<e.length;f++){e[f]=0}for(f=0;f<d.length*8;f+=8){e[f>>5]|=(d.charCodeAt(f/8)&255)<<(24-f%32)}return e},binb2rstr:function(d){var e="";for(var f=0;f<d.length*32;f+=8){e+=String.fromCharCode((d[f>>5]>>>(24-f%32))&255)}return e},binb_sha1:function(F,e){F[e>>5]|=128<<(24-e%32);F[((e+64>>9)<<4)+15]=e;var E=Array(80);var G=1732584193;var H=-271733879;var a=-1732584194;var b=271733878;var d=-1009589776;for(var w=0;w<F.length;w+=16){var j=G;var t=H;var x=a;var A=b;var C=d;for(var B=0;B<80;B++){if(B<16){E[B]=F[w+B]}else{E[B]=this.bit_rol(E[B-3]^E[B-8]^E[B-14]^E[B-16],1)}var D=this.safe_add(this.safe_add(this.bit_rol(G,5),this.sha1_ft(B,H,a,b)),this.safe_add(this.safe_add(d,E[B]),this.sha1_kt(B)));d=b;b=a;a=this.bit_rol(H,30);H=G;G=D}G=this.safe_add(G,j);H=this.safe_add(H,t);a=this.safe_add(a,x);b=this.safe_add(b,A);d=this.safe_add(d,C)}return Array(G,H,a,b,d)},sha1_ft:function(j,b,d,h){if(j<20){return(b&d)|((~b)&h)}if(j<40){return b^d^h}if(j<60){return(b&d)|(b&h)|(d&h)}return b^d^h},sha1_kt:function(b){return(b<20)?1518500249:(b<40)?1859775393:(b<60)?-1894007588:-899497514},safe_add:function(f,g){var h=(f&65535)+(g&65535);var e=(f>>16)+(g>>16)+(h>>16);return(e<<16)|(h&65535)},bit_rol:function(e,d){return(e<<d)|(e>>>(32-d))}});CW.SpritePreloadEnforcement={hasSpritePreloadEnforcement:YES,extraRequiredSrcs:null,extraRequiredImages:null,didFinishWaitingForImages:function(){},initMixin:function(){if(this.didCreateLayer){this._user_didCreateLayer=this.didCreateLayer}this.didCreateLayer=function(){if(this._user_didCreateLayer){var b=this._user_didCreateLayer.apply(this,arguments)}this._preload_didCreateLayer();return b}},_preload_didCreateLayer:function(){if(this.constructor.prototype.__hasPreloadedSprites__){var b=this.constructor.prototype.__preloadedExtraRequiredImages__;if(b){this.extraRequiredImages=b}SC.debug("Creating another instance of "+this.constructor+": all sprite backgrounds are confirmed to have been downloaded. Performing no preload action.");if(this.hasPaneAnimationSupport){SC.debug("Because this is the first append, and this pane has PaneAnimationSupport, we now trigger animateShow() to perform the animation.");this._hasShownFromDidCreateLayer=true;this.animateShow()}return}this.hideForPreload();this.preloadBackgroundSprites(this.getPreloadElementList(),this.showForPreload,this)},getPreloadElementList:function(){return SC.$A(this.$("*"))},hideForPreload:function(){this.set("isVisible",NO)},showForPreload:function(){this.set("isVisible",YES);if(this.hasPaneAnimationSupport){this._hasShownFromDidCreateLayer=true;this.animateShow()}},preloadBackgroundSprites:function(e,f,d){this.__elements__=e;this.__callback__=f;this.__target__=d;this.invokeLast("_preloadBackgroundSprites",e,f,d)},_preloadBackgroundSprites:function(x,I,u){x=this.__elements__;I=this.__callback__;u=this.__target__;this.__target__=this.__callback__=this.__elements__=undefined;var B=CW._backgroundImageLoadedness||(CW._backgroundImageLoadedness={}),L,F=0,H=false,C=this,A=undefined,G=this.get("extraRequiredSrcs"),y=this.extraRequiredImages=G?{}:null,J=function(){F--;SC.debug("Finished loading "+this._src_+". images remaining before callback: "+F);B[this._src_]=true;if(y&&this._extraKey_){y[this._extraKey_]=this}if(F===0){SC.debug("All images are downloaded. Now running callback.");D()}},D=function(a){if(A){clearTimeout(A)}if(H){SC.debug("Performing the callback for all images having finished loading, but it has already been performed. Aborting.");return}if(!a){C.constructor.prototype.__hasPreloadedSprites__=true;if(y){C.constructor.prototype.__preloadedExtraRequiredImages__=y}}C.didFinishWaitingForImages();H=true;SC.run(function(){I.apply(u||C)})};x=SC.$A(x);for(var v=0,M,w,E,z;M=x[v];v++){E=jQuery(M).css("background-image");if(!E){continue}if(E.indexOf("http")===-1){continue}if(E.indexOf("url(")===-1){continue}E=E.substring(4,E.length-1);if((w=E.charAt(0))==='"'||w==="'"){E=E.substring(1)}if((w=E.charAt(E.length-1))==='"'||w==="'"){E=E.substring(0,E.length-1)}if(B[E]){continue}if(L&&L[E]){continue}(L||(L={}))[E]=true;F++;z=new Image();z.onload=J;SC.debug("Preloading "+E);z.src=(z._src_=E)}if(G){for(v in G){if(!G.hasOwnProperty(v)){continue}E=G[v];F++;z=new Image();z.onload=J;SC.debug("Preloading explicitly-specified image "+E);z.src=(z._src_=E);z._extraKey_=v}}if(F===0){SC.debug("Preloading background images, but every image was already loaded. Running callback immediately.");D()}else{var K=SC.buildMode==="debug"?3000:1500;A=setTimeout(function(){SC.debug("Attempted to preload background images, but the loading is taking longer than "+(K/1000)+" seconds. Now running callback regardless of image loadedness.");D(true)},K)}}};CW.TouchApproximation={isTouchApproximationEnabled:YES,distanceThreshold:50,touchStart:function(D){var A=this.convertFrameFromView({x:D.pageX,y:D.pageY}),w=A.x,y=A.y,f,t,x=this.get("touchApproximationViews")||this.get("childViews"),C=this.get("distanceThreshold"),E=null,u=Infinity,F,s,v,B,z;B=x.get("length");for(v=0;v<B;v++){F=x[v];if(!F||!F.get("isVisible")||F.get("isDecorative")){continue}s=F.get("frame");f=-1;t=-1;if(w<s.x){f=s.x-w}else{if(w>(s.x+s.width)){f=w-(s.x+s.width)}}if(y<s.y){t=s.y-y}else{if(y>(s.y+s.height)){t=y-(s.y+s.height)}}if(f!==-1&&t!==-1){f=(f+t)/2}else{if(t!==-1){f=t}}if(f!==-1&&f<u&&f<C){E=F;u=f}}if(E){D.isProxied=YES;D.target=E.get("layer");z=E.tryToPerform("touchStart",D);if(z){this._foundChild=E;return YES}else{this._foundChild=null}}return NO},touchesDragged:function(e,f){var d=this._foundChild;if(d){return d.tryToPerform("touchesDragged",e,f)}return NO},touchEnd:function(d){var e=this._foundChild;if(e){d.isProxied=YES;d.target=e.get("layer");return e.tryToPerform("touchEnd",d)}return NO}};CW.UPLOADER_READY=0;CW.UPLOADER_INCOMPATIBLE_FILE_TYPE=1;CW.UPLOADER_FILE_TOO_BIG=2;CW.UPLOADER_MISSING_XHR=3;CW.Uploader=SC.Object.extend({isUploader:YES,uploadURL:null,maximumFileSize:1024*2000,allowedFileTypes:"png jpeg bmp jpg gif".w(),shouldUploadFile:function(b){return YES},willUploadFile:function(f,d){var e=this;d.upload.onprogress=function(a){SC.run(function(){e.uploadProgressDidChange(d,a)})};d.onload=function(a){SC.run(function(){e.didUploadFile(d,a)})};d.onerror=function(a){SC.run(function(){e.uploadDidFail(d,a)})};d.onreadystatechange=function(a){if(d.readyState===4&&d.status!==200){SC.run(function(){e.uploadDidFail(d,a)})}}},setRequestHeaders:function(h,j){j.setRequestHeader("X-File-Name",h.fileName);j.setRequestHeader("X-File-Size",h.fileSize);var k=this._xhrHeaders;var g=k.length;for(var f in k){j.setRequestHeader(f,k[f])}},uploadProgressDidChange:function(d,e){},didUploadFile:function(d,e){},uploadDidFail:function(d,e){},uploadFiles:function(e){var j=[];for(var h=e.length-1;h>=0;h--){var m=e[h];var k=this._fileIsAcceptableToUpload(m);if((k)!==CW.UPLOADER_READY){j.push(this._errorForFile(m,k))}else{if(this.shouldUploadFile(m)){try{this._createAndSendUploadRequest(m)}catch(l){console.warn(l.toString())}}}}return j},_xhrHeaders:{"If-Modified-Since":"Mon, 26 Jul 1997 05:00:00 GMT","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest","Content-Type":"text/plain"},_fileTooBigDescription:"Uploader.fileTooBigDescription".loc(),_wrongFileTypeDescription:"Uploader.wrongFiletypeDescription".loc(),_createAndSendUploadRequest:function(d){var e=this.get("uploadURL");if(!e){throw"%@: Can't upload file if uploadURL is not set.".fmt(this)}var f=new XMLHttpRequest();if(!f){throw this._errorForFile(d,CW.UPLOADER_MISSING_XHR)}this.willUploadFile(d,f);f.open("POST",e,true);this.setRequestHeaders(d,f);f.send(d)},_fileIsAcceptableToUpload:function(j){var f=CW.UPLOADER_READY;var h=this.get("maximumFileSize");var g=this.get("allowedFileTypes");var k=j.type.split("/")[1];if(j.fileSize>h){f=CW.UPLOADER_FILE_TOO_BIG}if(g.indexOf(k)===-1){f=CW.UPLOADER_INCOMPATIBLE_FILE_TYPE}return f},_errorForFile:function(h,g){var e="";var f="";switch(g){case CW.UPLOADER_INCOMPATIBLE_FILE_TYPE:e=this._wrongFileTypeDescription;break;case CW.UPLOADER_FILE_TOO_BIG:e=this._fileTooBigDescription;break}return SC.$error(e,f,h,g)}});sc_require("system/date_parser");SC.Validator.CalDate=SC.Validator.extend({format:"M/d/yyyy",currentValue:null,fieldValueForObject:function(e,h,g){var f=CW.Date.create(e,CW.DATE_ONLY);e=this._date=f.format(this.get("format"));return e},objectForFieldValue:function(q,y,u){var w=CW.DATE_ONLY,s=this.get("format"),o=["M/d/yyyy","M.d.yyyy","M-d-yyyy"],n=o.indexOf(s)===-1,x=n?[s]:null,t,v,z=u.get("value"),p=this.get("currentValue");q=q.replace(/\s/g,"");v=Date.parseDate(q,x);if(v){q=CW.Date.create(v,w).done()}else{if(Date.isDate(q,"yyyy/MM/dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/MM/dd")),w).done()}else{if(Date.isDate(q,"yyyy.MM.dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.MM.dd")),w).done()}else{if(Date.isDate(q,"yyyy/M/dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/M/dd")),w).done()}else{if(Date.isDate(q,"yyyy.M.dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.M.dd")),w).done()}else{if(Date.isDate(q,"yyyy/MM/d")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/MM/d")),w).done()}else{if(Date.isDate(q,"yyyy.MM.d")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.MM.d")),w).done()}else{if(Date.isDate(q,"yyyy.M.d")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.M.d")),w).done()}else{if(Date.isDate(q,"yyyy/M/d")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/M/d")),w).done()}else{if(Date.isDate(q,"MM/yyyy")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"MM/yyyy")),w).done()}else{if(Date.isDate(q,"MM.yyyy")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"MM.yyyy")),w).done()}else{if(Date.isDate(q,"MM-yyyy")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"MM-yyyy")),w).done()}else{if(Date.isDate(q,"yyyy/MM")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy/MM")),w).done()}else{if(Date.isDate(q,"yyyy.MM")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.MM")),w).done()}else{if(Date.isDate(q,"yyyy-MM")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy-MM")),w).done()}else{if(Date.isDate(q,"dd.MM")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"dd.MM")),w).done()}else{if(Date.isDate(q,"MM.dd")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"MM.dd")),w).done()}else{if(Date.isDate(q,"yyyy.MM.dd.")){q=CW.Date.create(new Date(Date.getDateFromFormat(q,"yyyy.MM.dd.")),w).done()}else{t=CW.DateParser.parseDate(q,z,n,p);q=t?t.done():z}}}}}}}}}}}}}}}}}}return q}});SC.Validator.Email=SC.Validator.extend({validate:function(e,d){return/^([A-Z0-9\.\-\_\+])*([A-Z0-9\+\-\_])+\@[A-Z0-9]+([\-][A-Z0-9]+)*([\.][A-Z0-9\-]+){1,8}$/i.test(d.get("fieldValue")||"")},validateError:function(d,f){var e=f.get("errorLabel")||"Field";return SC.$error("Invalid.Email(%@)".loc(e),e)}});SC.Validator.IsDate=SC.Validator.Date.extend({validate:function(e,g){var h=g.get("fieldValue");var f=!!h;if(f&&h.length){f=Date.isDate(h)}return f},validateError:function(d,f){var e=f.get("errorLabel")||"Field";return $error("Invalid.Date(%@)".loc(),f.get("errorLabel"))}});SC.Validator.CalTime=SC.Validator.extend({format:"hh:mm",separator:":",timeFormat:24,fieldValueForObject:function(e,d,f){return e},objectForFieldValue:function(Q,X,Z){var M=this.get("format"),K=Z.get("value"),Y=this.get("timeFormat"),H=Y===12?13:24,A,I,O,G,U,T=["a","am","p","pm"],S=Q.charAt(Q.length-1),P=Q.substr(Q.length-2),N=T.indexOf(S)!==-1?S:((T.indexOf(P)!==-1)?P:null),J=T.indexOf(N)>=2,W=Q,E=W.length;if(!isNaN(Q)&&(Q<0||Q>=H)){return[K,Y]}if(Date.isDate(Q,"h:m")){G=new Date(Date.getDateFromFormat(Q,"h:m"))}else{if(Date.isDate(Q,"h.m")){G=new Date(Date.getDateFromFormat(Q,"h:m"))}}if(Date.isDate(Q,"h")){G=new Date(Date.getDateFromFormat(Q,"h"));G.setMinutes(0)}if(Date.isDate(Q,"h:")){G=new Date(Date.getDateFromFormat(Q,"h:"));G.setMinutes(0)}else{if(Date.isDate(Q,"h.")){G=new Date(Date.getDateFromFormat(Q,"h."));G.setMinutes(0)}}if(Date.isDate(Q,":m")){G=new Date(Date.getDateFromFormat(Q,":m"));G.setHours(0)}else{if(Date.isDate(Q,".m")){G=new Date(Date.getDateFromFormat(Q,".m"));G.setHours(0)}}if(Date.isDate(Q,"H:m")){G=new Date(Date.getDateFromFormat(Q,"H:m"))}else{if(Date.isDate(Q,"H.m")){G=new Date(Date.getDateFromFormat(Q,"H.m"))}}if(Date.isDate(Q,"H:")){G=new Date(Date.getDateFromFormat(Q,"H:"));G.setMinutes(0)}else{if(Date.isDate(Q,"H.")){G=new Date(Date.getDateFromFormat(Q,"H."));G.setMinutes(0)}}if(Date.isDate(Q,"H")){G=new Date(Date.getDateFromFormat(Q,"H"));G.setMinutes(0)}if(!SC.none(G)){A=Q.split(this.get("separator")).objectAt(0);I=(A.toString().charAt(0)==="0")?parseInt(A.toString().charAt(1),10):parseInt(A,10);if(A.toString().charAt(0)==="0"||I>12){Y=24}else{if(M==="H:mm"&&(I===12||I===11||I===10)){Y=24}}K=G.format(M)}else{if(Q.toLowerCase()==="Now".loc().toLowerCase()){U=CW.Date.create(null,CW.DATE_TIME);U._dateObj=Date.parse(Q);U.parse(Date.parse(Q));K=U.format(M);Y=24}else{if(Q.toLowerCase()==="Midnight".loc().toLowerCase()){U=CW.Date.create(null,CW.DATE_TIME);U.hours(0).minutes(0);K=U.format(M);Y=24}else{if(Q.toLowerCase()==="Noon".loc().toLowerCase()){U=CW.Date.create(null,CW.DATE_TIME);U.hours(12).minutes(0);K=U.format(M);Y=24}else{var L,a,b,R,V;if(N){W=Q.substr(0,Q.indexOf(N));E=W.length}if(!isNaN(W)){if(W<0||W>=H){return[K,Y]}L=parseInt(Q.charAt(0),10);b=parseInt(Q.charAt(1),10);a=parseInt(Q.substr(0,2),10);R=parseInt(Q.substr(2,2),10);V=parseInt(Q.substr(1,2),10);switch(E){case 1:A=L;O=0;break;case 2:A=a<=23?a:L;O=a<=23?0:b;break;case 3:A=L;O=V;break;case 4:A=a;O=R;break}if(A<12&&J){A+=12}if(A===12&&!J){A=0}if(O>=0&&O<=59&&A>=0&&A<=23){U=CW.Date.create(null,CW.DATE_TIME);var F=new Date();F.setHours(parseInt(A,10));F.setMinutes(parseInt(O,10));F.setSeconds(0);F.setMilliseconds(0);U._dateObj=F;U._dateComponentDidChange();Y=24;K=U.format(M)}}}}}}return[K,Y]}});CW.ViewKeyHandlingHelpers={keyboardShortcuts:null,initMixin:function(){this._cwvkh_paneDidChange()},_cwvkh_paneDidChange:function(){var m,n,k,l,o,h=this,j;if(this.keyboardShortcuts&&this._cwvkh_lastPane!==this.get("pane")){k=this.get("pane");m=this.get("keyboardShortcuts");l=this._cwvkh_lastPane;if(l){for(n in m){l.deregisterKeyboardShortcut(n)}}if(k){for(n in m){o=m[n];if(typeof o==="string"||typeof o==="function"){j=o}else{h=o.target;j=o.action}k.registerKeyboardShortcut(n,h,j)}}this._cwvkh_lastPane=k}}.observes("pane"),registerKeyboardShortcut:function(f,j,k){if(!k){k=j;j=this}var g=this.keyboardShortcuts,h=this.get("pane");if(!g){g=this.keyboardShortcuts={}}g[f]={target:j,action:k};if(h&&(h!=this)){h.registerKeyboardShortcut(f,j,k)}},deregisterKeyboardShortcut:function(e){var d=this.keyboardShortcuts,f=this.get("pane");if(d){delete this.keyboardShortcuts[e];if(f&&(f!=this)){f.deregisterKeyboardShortcut(e)}}}};sc_require("system/response");CW.XDRResponse=CW.Response.extend({createRequest:function(){var e=new XDomainRequest(),d=this;e.timeout=null;e.onerror=function(){if(!d){return null}var a=d.finishRequest();if(a){d=null}return a};e.onload=function(){if(!d){return null}var a=d.finishRequest(200);if(a){d=null}return a};return e},setRequestHeaders:function(){},finishRequest:function(e){var d=this.get("rawRequest");d.readyState=4;d.status=e;return arguments.callee.base.apply(this,arguments)}});SC.View.reopen({init:function(b){b();this._lastTheme=this.get("theme");this._sc_view_lastRenderTheme=this.get("renderTheme")}.enhance(),themeName:null,baseThemeName:null,_sc_view_findThemeInParent:function(e,f,g){if(e){var h;if(f){h=f.find(e,g);if(h){return h}}if(!g){h=SC.Theme.find(e);if(h){return h}}return f.invisibleSubtheme(e)}return f},findThemeAtPathInParent:function(l,o,k){if(!l){return o}var m=l.split("."),h,j=m.length,n=o;for(h=0;h<j;h++){n=this._sc_view_findThemeInParent(m[h],n,k);k=YES}return n},theme:function(){return this.findThemeAtPathInParent(this.get("themeName"),this.get("baseTheme"))}.property("baseTheme","themeName").cacheable(),_sc_view_themeDidChange:function(){if(this._lastTheme===this.get("theme")){return}this._lastTheme=this.get("theme");var f=this.childViews,d=f.length,e;for(e=0;e<d;e++){f[e].notifyPropertyChange("baseTheme")}}.observes("theme"),baseTheme:function(){var d;var e=this.get("baseThemeName");if(e){return this.findThemeAtPathInParent(e,SC.Theme)}else{d=this.get("parentView");var f=d&&d.get("theme");return f||this.findThemeAtPathInParent(SC.defaultTheme,SC.Theme)}}.property("baseThemeName","parentView").cacheable(),renderStyle:null,renderTheme:function(){return this.findThemeAtPathInParent(this.get("renderStyle"),this.get("theme"))}.property("theme","renderStyle").cacheable(),_sc_view_renderThemeDidChange:function(){if(this._sc_view_lastRenderTheme===this.get("renderTheme")){return}this._sc_view_lastRenderTheme=this.get("renderTheme");if(this.get("layer")){this.replaceLayer()}}.observes("renderTheme"),renderDelegate:function(h,g){if(g){this._setRenderDelegate=g}if(this._setRenderDelegate){return this._setRenderDelegate}var f=this.get("renderDelegateName"),e;if(f){e=this.get("theme")[f];if(!e){throw'%@: Unable to locate render delegate "%@" in theme.'.fmt(this,f)}return e}return null}.property("renderDelegateName","renderTheme"),renderDelegateName:null,renderDelegateProxy:function(){return SC.View._RenderDelegateProxy.createForView(this)}.property("renderDelegate").cacheable(),render:function(d,f){var e=this.get("renderDelegate");if(e){if(f){e.render(this.get("renderDelegateProxy"),d)}else{e.update(this.get("renderDelegateProxy"),d.$())}}},applyAttributesToContext:function(l,m){var k=this.get("renderTheme");var o=k.classNames,h,j=o.length;for(h=0;h<j;h++){m.addClass(o[h])}l(m);var n=this.get("renderDelegate");if(n&&n.className){m.addClass(n.className)}}.enhance(),invokeRenderDelegateMethod:function(f,d){var e=this.get("renderDelegate");if(!e){return undefined}if(SC.typeOf(e[f])!==SC.T_FUNCTION){return undefined}d=SC.$A(arguments);d.shift();d.unshift(this.get("renderDelegateProxy"));return e[f].apply(e,d)}});SC.View._RenderDelegateProxy={isViewRenderDelegateProxy:YES,createForView:function(m){var l=SC.beget(this);var j=m.get("displayProperties"),k={};for(var g=0,h=j.length;g<h;g++){k[j[g]]=YES}k.theme=YES;l._displayPropertiesLookup=k;l.renderState={};l._view=m;return l},get:function(d){if(this[d]!==undefined){return this[d]}var e="display"+d.capitalize();if(this._displayPropertiesLookup[e]){return this._view.get(e)}else{if(this._displayPropertiesLookup[d]){return this._view.get(d)}}return undefined},didChangeFor:function(j){var f=arguments.length,g;for(g=1;g<f;g++){var h=arguments[g],k="display"+h.capitalize();if(this._displayPropertiesLookup[k]){if(this._view.didChangeFor(j,k)){return YES}}else{if(this._displayPropertiesLookup[h]){if(this._view.didChangeFor(j,h)){return YES}}}}return NO}};SC.propertyFromRenderDelegate=function(e,d){return function(b,a){if(a!==undefined){this["_set_rd_"+b]=a}var j=this["_set_rd_"+b];if(j!==undefined){return j}var k=this.get("renderDelegate");if(k&&k.get){var h=this.get("renderDelegateProxy");j=k.getPropertyFor(h,e)}if(j!==undefined){return j}return d}.property("renderDelegate","controlSize").cacheable()};if(!window.CW){CW=SC.Object.create()}SC.REGULAR_BUTTON_HEIGHT=27;CW.CANVAS_BUTTON_HEIGHT=26;CW.TOOLBAR_BUTTON_HEIGHT=26;CW.SQUARE_BUTTON_LARGE_HEIGHT=30;CW.SQUARE_BUTTON_REGULAR_HEIGHT=27;CW.SELECT_BUTTON_REGULAR_HEIGHT=27;CW.POPUP_BUTTON_REGULAR_HEIGHT=27;CW.SQUARE_BUTTON_REGULAR_MIN_WIDTH=68;CW.SQUARE_BUTTON_SMALL_MIN_WIDTH=56;CW.SQUARE_BUTTON_TINY_MIN_WIDTH=52;CW.HELP_BUTTON_REGULAR_MIN_WIDTH=26;CW.HELP_BUTTON_SMALL_MIN_WIDTH=22;CW.HELP_BUTTON_TINY_MIN_WIDTH=18;SteedOSTheme=SC.BaseTheme.create({name:"htv3",description:"A HotLong theme by Jack Zhuang and contributors. Only supports browsers that implement CSS3."});SC.Theme.addTheme(SteedOSTheme);SteedOSTheme.PointLeft=SteedOSTheme.subtheme("point-left","point-left");SteedOSTheme.PointRight=SteedOSTheme.subtheme("point-right","point-right");SteedOSTheme.Capsule=SteedOSTheme.subtheme("capsule","capsule");SteedOSTheme.Dark=SteedOSTheme.subtheme("dark");SC.defaultTheme="htv3";SteedOSTheme.iOS=SteedOSTheme.subtheme("iOS");SteedOSTheme.iOS.blue=SteedOSTheme.iOS.subtheme("iOSBlue");if(SteedOSTheme.ErrorCallout){SteedOSTheme.addTheme(SteedOSTheme.ErrorCallout)}sc_require("theme");if(SteedOSTheme.iOS.cwPickerBackgroundRenderDelegate){SteedOSTheme.iOS.cwPickerBackgroundRenderDelegate=SteedOSTheme.iOS.cwPickerBackgroundRenderDelegate.create({validPointerLayouts:[{name:"left-or-right-position",classNames:"calculated-pointer",minimumDistanceFromLeft:60,minimumDistanceFromRight:60,needsGap:YES},{name:"top-or-bottom-position",classNames:"calculated-pointer",minimumDistanceFromTop:60,minimumDistanceFromBottom:60,needsGap:YES}]})}sc_require("theme");SteedOSTheme.mainBackgroundRenderDelegate=SC.RenderDelegate.create({className:"cw-main-background",render:function(d,e){this.includeSlices(d,e,SC.NINE_SLICE)}});SteedOSTheme.menuRenderDelegate=SC.BaseTheme.menuRenderDelegate.create({itemHeight:22,itemSeparatorHeight:7,menuHeightPadding:6,"sc-small-size":{itemHeight:18,itemSeparatorHeight:7,menuHeightPadding:6,submenuOffsetX:2},"sc-large-size":{itemHeight:31,itemSeparatorHeight:9,menuHeightPadding:8,submenuOffsetX:4}});CW.SQUARE_MENU_ITEM_HEIGHT=31;CW.SQUARE_MENU_ITEM_SEPARATOR_HEIGHT=7;CW.SQUARE_MENU_HEIGHT_PADDING=6;window.CW||(window.CW={}),function(){var a=CW.Animator=CW.Anim={fps:60,fpsModifier:65/60,tasks:[],speedMultiplier:1,frameCount:0,isActive:!1,isInFrame:!1,extraStatus:{},ENABLE_OLD_IE:!0,_runningCWAguid:0,_hasSC:!!(window.SC&&SC.RunLoop&&SC.Object),_frameTimeNoiseLevelingWindowSize:30,_frameNoiseLevelerLog:[],_movingAverageFrameTime:function(){for(var d=0,f=a._frameNoiseLevelerLog,e=0,b=f.length;d<b;d++){e+=f[d]}return Math.round(10*e/(b||1))/10},init:function(){a.prepareObject(),a.stop(),a.useRAF=a.IS_MOBILE&&window.requestAnimationFrame&&window.cancelRequestAnimationFrame,a.lock16=a.IS_MOBILE&&!a.useRAF},nextFrame:function(w,e){var b,j=a._frameNoiseLevelerLog,x=a._frameTimeNoiseLevelingWindowSize,d,v,q=0;a.isInFrame=a._canAddLastSecondTasks=!0,d=a._lastFrameTime===-1?(new Date).valueOf():a._lastFrameTime,a._lastFrameTime=(new Date).valueOf(),v=d=a._lastFrameTime-d,a.now=a._lastFrameTime,a.firstActiveFrame&&(d=0),d>=300&&d>=(b=Math.max(a._movingAverageFrameTime(),60))*5?(d=0,j.unshift(b/2)):j.unshift(d),j.length<=x||(j.length=x),a.frameTime=d;var m=!a._hasSC||SC.RunLoop.isRunLoopInProgress();if(!a.shouldSkipFrame||!a.shouldSkipFrame()){m||(SC.RunLoop.begin(),a._SCLoopBegan()),a.trigger("preframe");for(var g=0,p;p=a.tasks[g];g++){p.running&&p.elapse(d*a.speedMultiplier)}a._canAddLastSecondTasks=!1;for(g=0;p=a.tasks[g];g++){p.running?p&&(p.fps||a.fps)>q&&(q=p.fps||a.fps):(p._inCWATasks=!1,a.tasks.splice(g--,1))}a.trigger("frame"),m||(SC.RunLoop.end(),a._SCLoopEnded()),a.isActive=!!a.tasks.length,a.frameCount++}else{a._canAddLastSecondTasks=!1}a.frameRate=Math.round(100000/v)/100,a.computeTime=(new Date).valueOf()-a.now;var k=Math.round(1000/(q*a.fpsModifier));a.timeoutWaitTime=Math.max(0,k-a.computeTime),a.clearNextTimeout(),!e&&a.isActive?a.useRAF?a._timeout=window.requestAnimationFrame(a.nextFrame,document.body):a._timeout=setTimeout(a.nextFrame,a.lock16?16:a.timeoutWaitTime):a.stop(),a.firstActiveFrame&&(a.firstActiveFrame=!1),a.isInFrame=!1,a._alreadyExpeditedNextFrame=!1},start:function(){if(a.isActive){a._canAddLastSecondTasks||a.expediteNextFrame();return}a.firstActiveFrame=!0,a.isActive=!0,a._lastFrameTime=-1,a.frameTime=1000/a.fps,a.frameRate=1000/a.frameTime,a.computeTime=0,a.trigger("start"),a.nextFrame()},stop:function(){a.isActive=!1,a.frameTime=Infinity,a.frameRate=0,a.computeTime=NaN,a.timeoutWaitTime=NaN,a.clearNextTimeout(),a.trigger("stop")},clearNextTimeout:function(){if(!a._timeout){return}a.useRAF?window.cancelRequestAnimationFrame(a._timeout):clearTimeout(a._timeout),a._timeout=0},expediteNextFrame:function(){if(a._alreadyExpeditedNextFrame||!a.isActive){return}a._alreadyExpeditedNextFrame=!0,a.clearNextTimeout(),a._timeout=setTimeout(a.nextFrame,0)},handleTask:function(d){if(!d||d.isDestroyed){return}if(!d._inCWATasks){if(d.name){for(var f=0,e=a.tasks,b;b=e[f];f++){b.name===d.name&&b.stop()}}a.tasks.push(d)}d._inCWATasks=!0,a.start()},tellStop:function(){arguments._isArgs_=!0,this.performMethodOn("stop",arguments)},tellFinish:function(){arguments._isArgs_=!0,this.performMethodOn("finish",arguments)},performMethodOn:function(h,d){var k=1,g=arguments;d&&d._isArgs_&&(k=0,g=d);for(var b=k,f,j=g.length;b<j;b++){(f=g[b])&&f[h]&&f[h]()}},trigger:function(h,d){if(this.isDestroyed){return}var j,g;(j=this["on"+h]||this["on"+h.charAt(0).toUpperCase()+h.substring(1)]) instanceof Function&&j.call(this,d);if(!(g=this["__"+h+"Listeners__"])){return}for(var b=0,f;b<g.length;b++){if(!((f=g[b]) instanceof Function)){continue}f.call(this,d)}},clearTrigger:function(d){var b=this["__"+d+"Listeners__"];if(!b){return}b.length=0},listen:function(j,f){if(!j){return}if(!f){f=j;var l=f._listens;if(l){for(var h=0;j=l[h];h++){this.listen(j,f)}}return}var d="__"+j+"Listeners__";if(!this.hasOwnProperty(d)){if(!this[d]){this[d]=[]}else{for(var g=[],k=0,b=this[d].length;k<b;k++){g.push(this[d][k])}this[d]=g}}this[d].push(f)},unlisten:function(m,v){if(!m){return}if(!v){v=m;var g=v._listens;if(g){for(var b=0;m=g[b];b++){this.unlisten(m,v)}}return}var j="__"+m+"Listeners__";if(!this[j]){return}if(!this.hasOwnProperty(j)){for(var w=[],d=0,q=this[j].length;d<q;d++){w.push(this[j][d])}this[j]=w}for(var p=0,k=this[j],h=k.length;p<h;p++){k[p]===v&&(k[p]=undefined)}},setIfChanged:function(d,b){var f=this[d];return this[d]=b,b!==f&&this.trigger(d),b},get:function(b){return this[b]},set:function(d,b){return this[d]=b,this.trigger(d),b},cloneFunction:function(f){var b=f.clonedFrom;if(b){return b.clone()}var g=function(){var j=arguments.callee.clonedFrom,h=j.base,k;return j.base=arguments.callee.base,k=arguments.callee.clonedFrom.apply(this,arguments),j.base=h,k};for(var d in f){f.hasOwnProperty(d)&&(g[d]=f[d])}return g.clonedFrom=f,g.toString=function(){return"Clone of "+this.clonedFrom.toString()},g},toString:function(){return"[The CoreWeb Animator]"},prepareObject:function(){var b=Function.prototype;b.listens=function(){var g=!this._listens,d=this._listens||(this._listens=[]);g&&(d.length=0);for(var h=0,f=arguments.length;h<f;h++){d.push(arguments[h])}return this},b.observes||(b.observes=b.listens),a.Object=a._hasSC?a.prepareSCObject():a.prepareOwnObject()},prepareOwnObject:function(){var b=function(){};return b.prototype={className:"Object",init:function(){this._cwaguid=++a._runningCWAguid},mixin:function(z){if(!arguments.length){return this}for(var j=0,d=arguments.length,m,A,g,y,x,v,k,w,q,e;j<d;j++){g=arguments[j],k=g.isMixin;for(v in g){q=this.suffixes;if(!g.hasOwnProperty(v)||v==="isMixin"){continue}y=this[v],x=g[v],(w=this[v+"Override"])&&(w instanceof Function||(w=this[w]) instanceof Function)&&(x=w.call(this,x,y,v));for(m=0;e=q&&q[m];m++){v.slice(-e.length)===e&&(w=this["*"+e+"Override"])&&(w instanceof Function||(w=this[w]) instanceof Function)&&(x=w.call(this,x,y,v))}y instanceof Function&&(k&&x instanceof Function&&(x=a.cloneFunction(x)),x.base=y,y._listens&&this.unlisten(y)),x instanceof Function&&x._listens&&this.listen(x),this[v]=x}}return this},trigger:a.trigger,listen:a.listen,unlisten:a.unlisten,clearTrigger:a.clearTrigger,toString:a._objectToString,get:a.get,set:a.set,setIfChanged:a.setIfChanged},b.isClass=!0,b.create=function(){var d;return arguments.length?d=new (this.extend.apply(this,arguments)):d=new this,d._type=this,d.init(),d},b.extend=function(){var f=function(){},d=new this;d.mixin.apply(d,arguments);for(var g in this){if(!this.hasOwnProperty(g)){continue}f[g]=this[g]}return f.prototype=d,f},b},prepareSCObject:function(){var d=SC.Object.extend({className:"CW.Anim.Object",init:function(){arguments.callee.base.call(this),this._cwaguid=++a._runningCWAguid},trigger:a.trigger,listen:a.listen,unlisten:a.unlisten,clearTrigger:a.clearTrigger,toString:a._objectToString,setIfChanged:a.setIfChanged}),f=function(l,h){for(var p,k,g,j,m=0;p=l[m];m++){if(typeof p!="object"){continue}for(g in p){if(!p.hasOwnProperty(g)){continue}if(!((k=p[g]) instanceof Function)||!k._listens){continue}h.listen(k)}}},e=function(){var g=arguments.callee.base.apply(this,arguments);return g.prototype._type=this,f(arguments,g.prototype),g};e.base=d.extend,d.extend=e;var b=function(){var g=arguments.callee.base.apply(this,arguments);return f(arguments,g),g};return b.base=d.create,d.create=b,d},_objectToString:function(){return"["+this.className+(this._cwaguid?":"+this._cwaguid:"")+"]"},asHTML:function(b){return b.split("\n").join("<BR>").split("  ").join(" &nbsp;")},toCamel:function(f,b){for(var g=0,d=f.length;g<d;g++){if(f.charAt(g)!=="-"||g==d-1){continue}f=f.substring(0,g)+f.charAt(g+1).toUpperCase()+f.substring(g+2),d--}return b?f.charAt(0).toUpperCase()+f.substring(1):f},toDashed:function(f){for(var b=0,g=f.length;b<g;b++){var d=f.charAt(b);if(d.toLowerCase()===d||b==g-1){continue}f=f.substring(0,b)+"-"+f.charAt(b).toLowerCase()+f.substring(b+1),g++}return f},getStyle:function(b,e){if(b.currentStyle){return b.currentStyle[a.toCamel(e)]}if(b.initialStyle){return b.initialStyle.getPropertyValue(e)}var d;if((d=document.defaultView)&&(d=d.getComputedStyle)){return(b.initialStyle=d(b,null)).getPropertyValue(e)}},IS_MOBILE:!!(/ipad/.test(navigator.userAgent.toLowerCase())||/iphone/.test(navigator.userAgent.toLowerCase())||/ipod/.test(navigator.userAgent.toLowerCase())||/android/.test(navigator.userAgent.toLowerCase())),getOpacity:function(b){if(!b){return -1}var e;if((e=b.cwa$opacity||b.getAttribute("cwa$opacity"))&&(e=parseFloat(e))||e===0){return e}if(SC.browser.isIE8OrLower){try{return e=parseInt(b.filters.item("DXImageTransform.Microsoft.Alpha").opacity,10)/100,e}catch(d){}e=b.style.filter||a.getStyle(b,"filter");if(!e){return 1}e=e.toLowerCase();if(e.indexOf("alpha(opacity=")===-1){return 1}if((e=parseFloat(e.substring(e.indexOf("alpha(opacity=")+14))/100)||e===0){return e}}return(e=b.style.opacity||a.getStyle(b,"opacity"))&&(e=parseFloat(e))||e===0?parseFloat(e):1},setOpacity:function(f,b){var g=SC.browser.isIE8OrLower;if(!f){return -1}b=Math.max(0,Math.min(1,b));if(b>0.9999||isNaN(b)){return this.removeOpacity(f)}f.cwa$opacity=b;if(!g){f.style.opacity=b}else{if(f.hasIEAlpha){try{f.filters.item("DXImageTransform.Microsoft.Alpha").opacity=Math.round(b*100)}catch(d){f.hasIEAlpha=!0,f.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+Math.round(b*100)+")"}}else{f.hasIEAlpha=!0,f.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+Math.round(b*100)+")"}f.isIEAlphaDisabled&&(f.filters.item("DXImageTransform.Microsoft.Alpha").enabled=!0,f.isIEAlphaDisabled=!1)}return b},removeOpacity:function(d){if(!d){return -1}var b=SC.browser.isIE8OrLower;d.cwa$opacity=1;if(!b){d.style.opacity=""}else{if(d.hasIEAlpha){try{d.filters.item("DXImageTransform.Microsoft.Alpha").opacity=100,d.filters.item("DXImageTransform.Microsoft.Alpha").enabled=!1,d.isIEAlphaDisabled=!0}catch(f){d.style.filter=""}}}return 1},encodeColor:function(d,b,f){if(typeof d=="object"&&typeof d.r=="number"&&typeof d.g=="number"&&typeof d.b=="number"){b=d.g,f=d.b,d=d.r}else{if(typeof d=="object"){b=d[1],f=d[2],d=d[0]}else{if(typeof d=="string"){if(d.charAt(0)=="#"&&d.length===7){return d}d=CW.Anim.decodeColor(d),b=d[1],f=d[2],d=d[0]}}}return d=Math.round(Math.max(0,Math.min(255,d))).toString(16),d.length==1&&(d="0"+d),b=Math.round(Math.max(0,Math.min(255,b))).toString(16),b.length==1&&(b="0"+b),f=Math.round(Math.max(0,Math.min(255,f))).toString(16),f.length==1&&(f="0"+f),("#"+d+b+f).toUpperCase()},decodeColor:function(d){a.colors&&a.colors[d]&&(d=a.colors[d]);var h,f,b,e;if((h=typeof d)=="number"||h=="object"){return undefined}d=d.replace(/\s+/g,"");if(d.charAt(0)=="#"){d.length==4&&(d="#"+d.charAt(1)+d.charAt(1)+d.charAt(2)+d.charAt(2)+d.charAt(3)+d.charAt(3)),f=parseInt(d.substring(1,3),16),b=parseInt(d.substring(3,5),16),e=parseInt(d.substring(5,7),16)}else{var g;if(d.indexOf("rgba(")!=-1){g=5}else{if(d.indexOf("rgb(")==-1){return undefined}g=4}d=d.substring(g,d.length-1).split(","),f=parseInt(d[0],10),b=parseInt(d[1],10),e=parseInt(d[2],10)}return[f,b,e]},colors:{red:"#ff0000","orange red":"#ff4500",orange:"#ff7f00",yellow:"#ffff00",green:"#00ff00","forest green":"#228b22",cyan:"#00ffff","light sea green":"#20b2aa",blue:"#0000ff","cornflower blue":"#6495ed","medium blue":"#3232cd",purple:"#a020f0","hot pink":"#ff69b4",magenta:"#ff00ff",white:"#ffffff","light gray":"#d3d3d3",gray:"#bebebe","dark gray":"#a9a9a9","dim gray":"#696969",black:"#000000"},initRandom:function(d,b,f){return{isInitRandom:!0,lo:d,hi:b,round:f}},_improveSCCompatibility:function(){if(!a._hasSC){return}a._runLoopedTrigger=function(){var b=SC.RunLoop.isRunLoopInProgress();b||SC.RunLoop.begin(),a._inSCLoop=!0;var d=a._coreTrigger.apply(this,arguments);return a._inSCLoop=!1,b||SC.RunLoop.end(),d},a._coreTrigger=a.trigger,a.trigger=a._runLoopedTrigger},_SCLoopBegan:function(){a._inSCLoop=!0,a.trigger=a.Object.prototype.trigger=a._coreTrigger},_SCLoopEnded:function(){a._inSCLoop=!1,a.trigger=a.Object.prototype.trigger=a._runLoopedTrigger}}}(),CW.Anim.init(),CW.Anim._improveSCCompatibility(),CW.Anim.Task=CW.Anim.Object.extend({className:"CW.Anim.Task",running:!1,speedMultiplier:1,frameCount:0,elapsedTime:0,ticked:!1,tickCount:0,start:function(){return this.running?this:(this.running=!0,this.elapsedTime=this.frameCount=this.tickCount=0,this.trigger("start"),CW.Anim.handleTask(this),this)},stop:function(){return this.running?(this.running=!1,this.trigger("stop"),this):this},elapse:function(g,b){if(this.isDestroyed){return this.running=!1,this}if(!b&&this.shouldSkipFrame&&this.shouldSkipFrame()){return this}this._forcedZeroes&&(g=0,this._forcedZeroes--),g*=this.speedMultiplier,this.trigger("preframe"),this.elapsedTime+=g;if(!this.ticked){this.trigger("pretick"),this.run instanceof Function&&this.run(g),this.tickCount++,this.trigger("tick")}else{for(var h=this.ticked===!0?1000/CW.Anim.fps:this.ticked,f=1+Math.floor(this.elapsedTime/h),a=f-this.tickCount,d=0;d<a;d++){this.trigger("pretick"),this.run instanceof Function&&this.run(h,d<a-1),this.running&&this.trigger("tick"),this.tickCount++}}return this.running&&(this.trigger("frame"),this.trigger("frame"+this.frameCount)),this.trigger("postFrame"),this.clearTrigger("postFrame"),this.frameCount++,this},destroy:function(){return arguments.callee.base&&arguments.callee.base.apply(this,arguments),this.isDestroyed=!0,this}}),CW.Anim.Task.initiate=function(){var a=this.create.apply(this,arguments);return a.start(),a},CW.Anim.tweens={make:function(d){var a=[];for(var f=1,b=arguments.length;f<b;f++){a.push(arguments[f])}return function(){var g=a;g.l=g.length;var e=CW.Anim.tweens[d]||CW.Anim.tweens.LINEAR;return function(h){return g[g.l]=h,e.apply(this,g)}}()},compound:function(){var d=arguments.length,a=arguments[d-1];for(var f=0,b;f<d-1&&(b=arguments[f]);f++){typeof b=="string"?a=CW.Anim.tweens[b].call(this,a):a=b.call(this,a)}return a},LINEAR:function(a){return a},BOUNCE:function(d){var a;d=1-d;for(var f=0,b=1;1;f+=b,b/=2){if(d>=(7-4*f)/11){a=b*b-Math.pow((11-6*f-11*d)/4,2);break}}return 1-a},SINE_IN_OUT:function(a){return 0.5-0.5*Math.cos(Math.PI*a)},multiSineInOut:function(d,a){var f=d%1;d=Math.floor(d);for(var b=0;b<d;b++){a=0.5-0.5*Math.cos(Math.PI*a)}return f&&(a=(1-f)*a+f*(0.5-0.5*Math.cos(Math.PI*a))),a},QUADRATIC_IN:function(a){return a*a},QUADRATIC_OUT:function(a){return 1-(a=1-a)*a},WEBKIT_EASE:function(a){return CW.Anim.tweens.cubicBezier(0.25,0.1,0.25,1,a)},WEBKIT_LINEAR:function(a){return a},WEBKIT_EASE_IN:function(a){return CW.Anim.tweens.cubicBezier(0.42,0,1,1,a)},WEBKIT_EASE_OUT:function(a){return CW.Anim.tweens.cubicBezier(0,0,0.58,1,a)},WEBKIT_EASE_IN_OUT:function(a){return CW.Anim.tweens.cubicBezier(0.42,0,0.58,1,a)},cubicBezier:function(I,q,B,x,E){var w=5,A=3*I,k=3*(B-I)-A,L=1-A-k,H=3*q,D=3*(x-q)-H,K=1-H-D,F=1/(200*w),z,J,j,C,G,b;for(j=E,b=0;b<8;b++){C=((L*j+k)*j+A)*j-E;if(Math.abs(C)<F){return((K*j+D)*j+H)*j}G=(3*L*j+2*k)*j+A;if(Math.abs(G)<0.000001){break}j-=C/G}z=0,J=1,j=E;if(j<z){return((K*z+D)*z+H)*z}if(j>J){return((K*J+D)*J+H)*J}while(z<J){C=((L*j+k)*j+A)*j;if(Math.abs(C-E)<F){return((K*j+D)*j+H)*j}E>C?z=j:J=j,j=(J-z)*0.5+z}return((K*j+D)*j+H)*j},linearInterpolation:function(h,d){var k=h._length_||(h._length=h.length),g=d*k/k*(k-1),b=Math.floor(g),f=h[b],j=g-b;if(j===0){return f}var a=h[Math.ceil(g)];return f*(1-j)+a*j}},CW.Anim.Animation=CW.Animation=CW.Anim.Task.extend({className:"CW.Animation",isAnimation:!0,init:function(){arguments.callee.base.call(this),this.hasOwnProperty("animateOldIE")||(this.animateOldIE=CW.Anim.ENABLE_OLD_IE),SC.browser.isIE8OrLower&&!this.animateOldIE&&(this.disabled=!0);var g,b,h,f,a,d=this._type.prototype.freevars;typeof this.freevars=="string"&&(this.freevars=this.freevars.split(/\s+/)),this.freevars&&!this.freevars.length&&(this.freevars=[this.freevars]);if(this.freevars&&d&&this.freevars===d){a=[];for(b=0;b<(f||(f=this.freevars.length));b++){a.push(this.freevars[b])}this.freevars=a}this.freevars&&this.speed===undefined&&this.duration===undefined&&!this.signal&&(this.duration=0);for(b=-1,f=!!this.freevars&&this.freevars.length;b<f;b++){g=b===-1?this:this.freevars[b],typeof g=="string"&&(this[g].key=g,this.freevars[b]=g=this[g]),g=this.makeFreevarFromHash(g),g!==this&&(this.freevars[b]=g,g.key&&(this[g.key]=g))}},makeFreevarFromHash:function(k){if(k._isFreevar){return k}var p=CW.Animation.defaultFreevar,g,b,h,q,d,m,l,j=k===this?this:{};for(h in k){if(!k.hasOwnProperty(h)){continue}(q=k[h])&&q.isInitRandom===!0?(l=q.round,q=Math.random()*(q.hi-q.lo)+q.lo,l&&(q=Math.round(q/l)*l),j[h]=q):j!==k&&(j[h]=k[h])}if(j===this){for(h in p){j[h]===undefined&&(j[h]=p[h])}}else{for(h in p){j.hasOwnProperty(h)||(j[h]=p[h])}}if(j.signal){j.tween=undefined,g=this._returnExtendedFreevar(j,CW.Animation._signalFreevar),g._unsignaledCurrent=g.from}else{if(j.inertia){j.tween=undefined,g=this._returnExtendedFreevar(j,CW.Animation._inertiaFreevar),g._undampedCurrent=g.from,g.inertia!==!0||(g.inertia=CW.Animation._inertiaFreevar.prototype.inertia),b=[];for(h=0;h<j.inertia-1;h++){b[h]=g._undampedCurrent}g.inertiaChain=b}else{g=this._returnExtendedFreevar(j,CW.Animation._tweenFreevar),g._untweenedCurrent=j.from,typeof g.speed=="number"&&(g.duration=undefined)}}return g._isFreevar=!0,g.freevarRun(0),g},_returnExtendedFreevar:function(b,a){if(b===this){for(var d in a.prototype){this[d]===undefined&&(this[d]=a.prototype[d])}return this}return new a(b)},addFreevar:function(a){if(!a){return}return a.key&&this[a.key]?!1:(a=this.makeFreevarFromHash(a),a.key&&(this[a.key]=a),(this.freevars||(this.freevars=[])).push(a),this)},removeFreevar:function(b){typeof b=="string"&&(b=this[b]);if(!b||!b._isFreevar){return null}if(!this.freevars||!this.freevars.length){return null}b.key&&(this[b.key]=undefined);for(var a=0;a<this.freevars.length;a++){this.freevars[a]===b&&this.freevars.splice(a--,1)}return b},allFreevarsDo:function(g,b){var j,f,a=arguments.callee.args||(arguments.callee.args=[]);a.length=0;for(var d=1,h=arguments.length;d<h;d++){a.push(arguments[d])}this[g].apply(this,a);if(!(j=this.freevars)){return this}for(d=0;f=j[d];d++){f[g].apply(f,a)}return this},forceAll:function(a){return this.allFreevarsDo("force",a),this},resetAll:function(){return this.allFreevarsDo("reset"),this},reverseAll:function(a){return this.allFreevarsDo("reverse"),this},run:function(h,d){var k=!0,g=1,b=Infinity,f;for(var j=-1,a=!!this.freevars&&this.freevars.length||0;j<a;j++){f=this.freevars&&this.freevars[j]||this,f.freevarRun(h)||(k=!1),f.progress<g&&(g=f.progress),f.tweenedProgress<b&&(b=f.tweenedProgress)}this.freevars&&(this.progress=g,this.tweenedProgress=b),d||this.update(),k&&this.listen("postFrame",this._finishNaturally)},start:function(){if(this.running){return this}this.disabled&&this.allFreevarsDo("zeroOutDuration");if(CW.Animator._hasSC){var b=SC.RunLoop.isRunLoopInProgress();b||SC.RunLoop.begin()}var a=arguments.callee.base.apply(this,arguments);return CW.Anim.isActive&&(this.update(),this.trigger("tick"),this.trigger("frame")),!b&&CW.Animator._hasSC&&SC.RunLoop.end(),a},finish:function(b,a){if(!this.running){return this}b||(this.allFreevarsDo("force"),a||(this.update(),this.trigger("tick"),this.trigger("frame")));var d=this.stop();return this.trigger("finish"),this.repeat>0&&(this.repeat--,this.reverseOnRepeat?this.reverse():this.reset(),this.start()),d},_finishNaturally:function(){this.finish(!0)},update:function(){},toString:function(){var a=arguments.callee.base.apply(this,arguments);return a=a.substring(0,a.length-1)+(this.name?" "+this.name:"")+(this.running?" running":"")+(this.fps?" fps="+this.fps:"")+(this.freevars||this.inertia?"":" "+this.from+"-to-"+this.to+" "+this.duration+"ms "+Math.round(this.progress*100)+"%")+"]",a},destroy:function(){var a=arguments.callee.base.apply(this,arguments);return this.update=this.run=this.finish=function(){},a},recycle:function(){this.tickCount=this.frameCount=this.elapsedTime=this._forcedZeroes=0}}),CW.Animation.defaultFreevar={tween:CW.Anim.tweens.WEBKIT_EASE,discreteness:0},CW.Animation._tweenFreevar=function(){var a=function(d){for(var b in d){d.hasOwnProperty(b)&&(this[b]=d[b])}};return a.prototype={from:0,to:1,duration:1000,importants:undefined,isAlmostFinished:function(b){return Math.abs(this.to-this.current)<b},reverse:function(){var b=this.to;return this.to=this.from,this.from=b,this.freevarRun(0),this},reset:function(){return this._untweenedCurrent=this.from,this.freevarRun(0),this},redirectTo:function(b){return this.from=this.current,this.to=b,this._untweenedCurrent=this.from,this.freevarRun(0),this},redirectFrom:function(b){return this.from=this._untweenedCurrent=b,this.freevarRun(0),this},zeroOutDuration:function(){return !this.duration||(this.duration=0),!this.speed||(this.speed=Infinity),this},force:function(b){return typeof b=="number"&&(this.to=b),this._untweenedCurrent=this.to,this.freevarRun(0),this},freevarRun:function(j){if(this.duration===0||this.speed===Infinity){this._untweenedCurrent=this.to}var f=this,l=f._untweenedCurrent<f.to,h=f.isFinished=f._untweenedCurrent===f.to,d=f.importants?f.importants[f._impSpot||0]||undefined:undefined,g=d!==undefined?f._untweenedCurrent<d:undefined,k,b;if(f.to===f.from){return f.current=f._untweenedCurrent=f.to,f.isFinished=!0}if(!h){b=f.speed||1000/f.duration*Math.abs(f.to-f.from),k=Math.abs(b*j/1000),l?f._untweenedCurrent+=k:f._untweenedCurrent-=k;if(g===!0&&f._untweenedCurrent>d||g===!1&&f._untweenedCurrent<d){f._untweenedCurrent=d,f._impSpot=(f._impSpot||0)+1}if(f.isFinished=l&&f._untweenedCurrent>=f.to||!l&&f._untweenedCurrent<=f.to){f._untweenedCurrent=f.to}}return f.from!==undefined&&f.to!==undefined?(f.progress=(f._untweenedCurrent-f.from)/(f.to-f.from),f.tween instanceof Function&&f.from!=f.to&&(f.from===0&&f.to===1?f.current=f.tweenedProgress=f.tween.call(this,f._untweenedCurrent):f.current=(f.tweenedProgress=f.tween.call(this,f.progress))*(f.to-f.from)+f.from)):f.current=f._untweenedCurrent,f.discreteness&&Math.abs(f.to/f.discreteness)%1<1e-8&&(f.current=Math.round(f.current/f.discreteness)*f.discreteness),f.isFinished}},a._freevarPrototype=a,a}(),CW.Animation._inertiaFreevar=function(){var a=function(d){for(var b in d){d.hasOwnProperty(b)&&(this[b]=d[b])}};return a.prototype={from:0,to:1,speed:1,inertia:3,headStart:0.01,isAlmostFinished:function(b){return Math.abs(this.to-this.current)<b},reverse:function(){var b=this.to;return this.to=this.from,this.from=b,this},reset:function(){var b=this.to;return this.force(this.from),this.to=b,this},redirectTo:function(b){return this.from=this.current,this.to=b,this},redirectFrom:function(f){var b=f-this.current;this.from=f,this._undampedCurrent+=b;for(var g=0,d=this.inertiaChain.length;g<d;g++){this.inertiaChain[g]+=b}return this.freevarRun(0),this},zeroOutDuration:function(){return this.speed=Infinity,this},force:function(d){typeof d=="number"&&(this.to=d),this._undampedCurrent=this.current=this.to;for(var b=0,f=this.inertiaChain.length;b<f;b++){this.inertiaChain[b]=this.to}return this},freevarRun:function(k){this.speed===Infinity&&this.force();var p,g=this,b,h,q=g.speed,d=g.inertiaChain,m,l,j;for(p=0;p<g.inertia;p++){p===0?(b=g._undampedCurrent,h=g.to):p===1?(b=d[0],h=g._undampedCurrent):(b=d[p-1],h=d[p-2]);if(b===h){continue}m=b<h,l=k/1000*q*Math.abs(h+g.headStart*(2*m-1)-b),m?b+=l:b-=l;if(j=m&&b>=h||!m&&b<=h){b=h}p===0?g._undampedCurrent=b:d[p-1]=b}return g.current=b,g.discreteness&&Math.abs(g.to/g.discreteness)%1<1e-8&&(g.current=Math.round(g.current/g.discreteness)*g.discreteness),g.isFinished=g.to===g.current,g.progress=NaN,g.isFinished}},a._freevarPrototype=a,a}(),CW.Animation._signalFreevar=function(){var a=function(d){for(var b in d){d.hasOwnProperty(b)&&(this[b]=d[b])}};return a.prototype={speed:1,from:0,signal:function(b){return 0.5+0.5*Math.sin(b*Math.PI*2)},persistent:!0,isAlmostFinished:function(b){return !this.persistent},reverse:function(){return this.speed=-this.speed,this},reset:function(){return this._unsignaledCurrent=this.from,this},redirectTo:function(){return this},force:function(){return this},advance:function(b){this._unsignaledCurrent+=b},zeroOutDuration:function(){return this},freevarRun:function(b){return this._unsignaledCurrent+=b/1000*this.speed,this.current=this.signal(this._unsignaledCurrent),this.discreteness&&(this.current=Math.round(this.current/this.discreteness)*this.discreteness),this.isFinished=!this.persistent,this.progress=NaN,this.isFinished}},a._freevarPrototype=a,a}(),CW.Anim.Fader=CW.Fader=CW.Animation.extend({className:"CW.Fader",update:function(){CW.Anim.setOpacity(this.element,this.current)},init:function(){this.from===undefined&&(this._untweenedCurrent=this.from=CW.Anim.getOpacity(this.element)),arguments.callee.base.apply(this,arguments)},_removeOnFinish:function(){if(!this.REMOVE_ON_FINISH){return}this.element.parentNode&&this.element.parentNode.removeChild(this.element)}.listens("finish"),saveSelf:function(){var a=this.element._cwaFader;a&&a.stop(),this.element._cwaFader=this}.listens("start"),killSelf:function(){this.element._cwaFader=undefined}.listens("stop")}),CW.Anim.DisplayNoneAtZero={isMixin:!0,setDisplayNone:function(){this.to===0&&(this.element.style.display="none")}.listens("finish"),removeDisplayNone:function(){this.element.style.display=""}.listens("start")},CW.Anim.ColorFader=CW.ColorFader=CW.Animation.extend({className:"CW.ColorFader",style:"color",init:function(){this.colorKey="_cwa"+this.style+"color",this.saveKey="_cwa"+this.style+"Fader";var a;if(this.sR===undefined||this.sG===undefined||this.sB===undefined){(a=CW.Anim.getStyle(this.element,this.style))?a=CW.Anim.decodeColor(a):a=this.element[this.colorKey]||(this.element[this.colorKey]=[0,0,0]),this.sR=a[0],this.sG=a[1],this.sB=a[2]}arguments.callee.base.apply(this,arguments)},update:function(){if(!this.element||!this.style){return}var g=this.current,b=1-g,h,f,a,d=this.element[this.colorKey]||(this.element[this.colorKey]=[]);d[0]=h=this.tR*g+this.sR*b,d[1]=f=this.tG*g+this.sG*b,d[2]=a=this.tB*g+this.sB*b,this.element.style[this.style]=(this.cssBeforeColor||"")+CW.Anim.encodeColor(h,f,a)+(this.cssAfterColor||"")},saveSelf:function(){var a=this.element[this.saveKey];a&&a.stop(),this.element[this.saveKey]=this}.listens("start"),killSelf:function(){this.element[this.saveKey]=undefined}.listens("stop")}),CW.Anim.Mover=CW.Mover=CW.Animation.extend({className:"CW.Mover",getOmittedPositions:function(){var d,a,f,b;if(this.fromX===undefined||this.anchorX===undefined){f="left",d=parseInt(CW.Anim.getStyle(this.element,f),10),isNaN(d)&&(f="right",d=parseInt(CW.Anim.getStyle(this.element,f),10)),isNaN(d)&&(f="left"),this.anchorX!==undefined||(this.anchorX=f),this.fromX!==undefined||(this.fromX=d)}if(this.fromY===undefined||this.anchorY===undefined){b="top",a=parseInt(CW.Anim.getStyle(this.element,b),10),isNaN(a)&&(b="bottom",a=parseInt(CW.Anim.getStyle(this.element,b),10)),isNaN(a)&&(f="top"),this.anchorY!==undefined||(this.anchorY=b),this.fromY!==undefined||(this.fromY=a)}if(isNaN(this.fromX)||isNaN(this.fromY)){this.anchorX="left",this.anchorY="top",this.fromX=this.element.offsetLeft,this.fromY=this.element.offsetTop,this.element.style.position="absolute"}this.toX===undefined&&(this.toX=this.fromX),this.toY===undefined&&(this.toY=this.fromY)}.listens("start"),update:function(){var b=this.element.style,a=this.current,d=1-a;b[this.anchorX]=Math.round(a*this.toX+d*this.fromX)+"px",b[this.anchorY]=Math.round(a*this.toY+d*this.fromY)+"px"}});CW.Animatability={ENABLE_OLD_IE:YES,hasAnimatability:!0,mustKeepLayoutSync:YES,isAnimating:NO,isAnimatingInWindow:NO,isAnimatingWithParent:NO,recomputeIsAnimatingBooleans:function(){var f=this.get("isAnimatingInWindow"),b=!1,g=this,d=this._animCount>0,a;while(g=g.get("parentView")){if(g.hasAnimatability&&g.get("isAnimating")){b=!0;break}}a=b||d,this.isAnimating!==d&&this.set("isAnimating",d),this.isAnimatingInWindow!==a&&this.set("isAnimatingInWindow",a),this.isAnimatingWithParent!==b&&this.set("isAnimatingWithParent",b),a!==f&&this._recomputeChildrenIsAnimatingBooleans()},_recomputeChildrenIsAnimatingBooleans:function(){for(var b=0,a=this.get("childViews"),d;d=a[b];b++){d.hasAnimatability?d.recomputeIsAnimatingBooleans():CW.Animatability._recomputeChildrenIsAnimatingBooleans.apply(d)}},incrementAnimationCount:function(){this._animCount=(this._animCount||0)+1,this.recomputeIsAnimatingBooleans()},decrementAnimationCount:function(){this._animCount=Math.max(this._animCount-1,0),this.recomputeIsAnimatingBooleans()},animateProperty:function(b,a,d){return this.animateProperties.apply(this,arguments)},animateProperties:function(af,M){var X,R,ab,P,W,J,aj,ae,Z,ah,ac,V,ag,I,Y,ad,F,ai,H,K,q,G,j,B,Q,aa,D=SC.A(arguments),U=this._currentlyAnimatingProperties,z=this.get("mustKeepLayoutSync");if(W=typeof af=="string"){(P={})[af]=M,af=P,M=D[2]}if(!af){SC.warn("When using .animateProperties(, either a property name (string)or a hash, keyed by property name, full of destinations (or full freevar optionshashes) must be supplied as the first argument. Aborting the call.");return}af=SC.clone(af);if(M){for((X=W?2:1)&&(ab=D.length)&&!(M=undefined);X<ab;X++){if(typeof(B=D[X])!="object"){continue}for(R in B){(M||(M={}))[R]=B[R]}}}M||(M=this.___emptyHash),typeof(J=M.duration)=="number"&&delete M.duration,(aj=M.tween)&&delete M.tween,(ae=M.speed)&&delete M.speed,(Z=M.inertia)&&delete M.inertia,(ah=M.headStart)&&delete M.headStart,(globalDiscreteness=M.discreteness)&&delete M.discreteness,Y=!0;for(X in M){if(!M.hasOwnProperty(X)){continue}F=M[X],ai=typeof F;if(ai==="object"||ai==="function"){Y=!1}(ad||(ad=[])).push(X)}M.canReuse=Y=Y||M.canReuse,ad&&(M.extraKeys=ad);for(X in af){if(SC.none(ac=af[X])){continue}V=(ag=U[X])?((q||(q={}))[X]=ag).removeProperty(X,!0):undefined,typeof ac=="number"&&(ac=af[X]={to:ac}),ac.from===undefined&&(ac.isLayoutProperty?(V?ac.from=V.current:ac.from=(this._previousLayout||this.get("layout"))[X],typeof ac.from!="number"&&(ac.from=this._DEFAULT_LAYOUT_FROMS[X]||0)):ac.from=this.getPath(X)),typeof J=="number"&&ac.duration===undefined&&ac.inertia===undefined&&ac.speed===undefined&&(ac.duration=J),aj&&ac.tween===undefined&&ac.inertia===undefined&&(ac.tween=aj),ae&&ac.speed===undefined&&ac.duration===undefined&&ac.tween===undefined&&(ac.speed=ae),Z&&ac.inertia===undefined&&ac.tween===undefined&&(ac.inertia=Z),ah&&ac.headStart===undefined&&(ac.headStart=ah),globalDiscreteness&&ac.discreteness===undefined&&(ac.discreteness=globalDiscreteness),V&&V.inertia&&ac.inertia===V.inertia&&(ac.speed&&(V.speed=ac.speed),ac.headStart&&(V.headStart=ac.headStart),V.from=ac.from,V.to=ac.to,ac.discreteness!==undefined&&(V.discreteness=ac.discreteness),af[X]=ac=V),af[X].propertyName=X}K=0,j=0,Q=!this.get("animateOldIE")&&SC.browser.msie&&SC.browser.msie<=8;for(X in af){if(!(ac=af[X])){continue}Q&&(!ac.duration||(ac.duration=0),!ac.speed||(ac.speed=Infinity)),(ac.duration||0)>K&&(K=ac.duration),z||this.adjust(ac.propertyName,ac.to),ac.to===ac.from?(z&&this.adjust(ac.propertyName,ac.to),delete af[X]):j++}if(j===0){Y||(aa=CW.Animation.create({view:this,duration:K||J||0},M).start())}else{if(Y&&(H=this._bestMatchAnimationForProperties(af)||this._animationFromPool())){for(X in af){H.addProperty(af[X])}for(X in M){H[X]=M[X]}aa=H.start()}else{I={freevars:[],properties:[]};for(X in af){I.freevars.push(X),I.properties.push(X)}I.view=this,H=CW.MultiPropertyAnimation.create(I,af,M);for(X in af){U[X]=H}aa=H.start()}}if(q){for(X in q){if(!q.hasOwnProperty(X)){continue}G=q[X];if(G.__checked__){continue}G.__checked__=!0,G.stopIfNoProperties()}for(X in q){if(!q.hasOwnProperty(X)){continue}q[X].__checked__=!1}}return aa},_bestMatchAnimationForProperties:function(h){var d,k,g,b,f,j,a=this._currentlyAnimatingProperties;for(d in a){if(!(b=a[d])||b.___matchCheck){continue}b.___matchCheck=!0,g=b.properties.length,f=0;for(k=0;k<g;k++){f+=h[b.properties[k]]?2:1}b.___matchCount=f}f=0;for(d in a){if(!(b=a[d])||!b.matchCheck){continue}b.___matchCheck=undefined,b.___matchCount>f&&(f=b.___matchCount,j=b),b.___matchCount=undefined}return j||this._animationFromPool()},_propertyAnimPool:null,_addAnimationToPool:function(d){if(!d){return}var a=this._propertyAnimPool;for(var f=0,b=a.length;f<b;f++){if(a[f]===d){return}}a.push(d)},_animationFromPool:function(){var b=this._propertyAnimPool,a=b.length,d=b[a-1];return d&&(b.length=a-1),d},animate:function(k,p){var g,b,h,q,d,m,l,j=SC.A(arguments);if(m=typeof k=="string"){(g={})[k]=p,k=g,p=j[2]}if(!k){SC.warn("When using .animate(, either a property name (string)or a hash, keyed by property name, full of destinations (or full freevar optionshashes) must be supplied as the first argument. Aborting the call.");return}k=SC.clone(k);if(p){for((h=m?2:1)&&(q=j.length)&&!(p=undefined);h<q;h++){if(typeof(l=j[h])!="object"){continue}for(b in l){(p||(p={}))[b]=l[b]}}}typeof(g=k.duration)=="number"&&((p||(p={})).duration=g,delete k.duration);if(g=k.tween){(p||(p={})).tween=g,delete k.tween}if(g=k.speed){(p||(p={})).speed=g,delete k.speed}if(g=k.inertia){(p||(p={})).inertia=g,delete k.inertia}if(g=k.headStart){(p||(p={})).headStart=g,delete k.headStart}p||(p=this.___emptyHash);for(h in k){d=k[h],typeof d=="number"&&(d=k[h]={to:d}),d.isLayoutProperty=!0}return this.animateProperties(k,p)},adjust:function(a){return SC.View.prototype.adjust.apply(this,arguments)},stopAnimation:function(){this._forSaidPropertyAnimationsDo("removeProperty",arguments)},finishAnimation:function(){this._forSaidPropertyAnimationsDo("finishProperty",arguments)},updateToAnimation:function(){this._forSaidPropertyAnimationsDo("updateToProperty",arguments)},_forSaidPropertyAnimationsDo:function(h,l){var f=this._currentlyAnimatingProperties;if(!h||!f){return}var b=this.___keysForDoAll||(this.___keysForDoAll=[]),g=l[0],m,d,k,j;b.length=0,g||(g=f);if(g instanceof Array){d=g.length;for(m=0;m<d;m++){b[m]=g[m]}}else{if(typeof g=="object"){for(m in g){g.hasOwnProperty(m)&&g[m]!==undefined&&b.push(m)}}else{if(typeof g=="string"){d=l.length;for(m=0;m<d;m++){b[m]=l[m]}}}}d=b.length;for(m=0;m<d;m++){j=f[k=b[m]];if(!j){continue}j[h](k)}},_canAvoidAdjust:function(){return this.get("mustKeepLayoutSync")?!1:!0},_quickAdjust:function(b,a){if(!this._isQuickAdjusting){return this.adjust.apply(this,arguments)}},_isQuickAdjusting:!1,_quickAdjustment:null,_beginQuickAdjustment:function(){this._isQuickAdjusting=!0;var b=this._quickAdjustment||(this._quickAdjustment={}),a=this._previousLayout||this.get("layout");for(var d in b){a.hasOwnProperty(d)||delete b[d]}for(d in a){b[d]=a[d]}},_commitQuickAdjustment:function(){this._isQuickAdjusting=!1},_renderQuickAdjustment:function(){},_currentlyAnimatingProperties:null,___emptyHash:{},initMixin:function(){this._currentlyAnimatingProperties={},this._propertyAnimPool=[],this.hasOwnProperty("animateOldIE")||this.set("animateOldIE",CW.Animatability.ENABLE_OLD_IE)},_DEFAULT_LAYOUT_FROMS:{opacity:1,scale:1},discreteForOutsideUnitInterval:{left:YES,top:YES,width:YES,height:YES,right:YES,bottom:YES,centerX:YES,centerY:YES}};CW.MultiPropertyAnimation=CW.Animation.extend({view:null,properties:null,ticked:SC.platform.touch?5:0,stopIfNoProperties:function(){this.properties.length===0&&this.stop()},finishProperty:function(b,a){var d=this.freevarForProperty(b);if(!d){return}d.force(),a||this.update(),this.removeProperty(b)},removeProperty:function(f,b){for(var g=0,d;d=this.properties[g];g++){d===f&&(this.properties.splice(g,1),g--)}this.view._currentlyAnimatingProperties[f]=undefined,b||this.stopIfNoProperties();var a=this.removeFreevar(this.freevarForProperty(f));return a},addProperty:function(d){var a;if(!d||!(a=d.propertyName)){return}d.key=d.propertyName;for(var f=0,b;b=this.properties[f];f++){b===a&&(this.removeProperty(a,!0),f--)}this.properties.push(a),this.view._currentlyAnimatingProperties[a]=this,this.addFreevar(d)},updateToProperty:function(d){var a=CW.Animatability.discreteForOutsideUnitInterval,f=d,b=this.view;b._updatingAnimatedProperty=!0,typeof f=="string"&&(f=this.freevarForProperty(f)),d=f.propertyName,f.isLayoutProperty?(f.discreteness||(f.discreteness=a[d]&&(f.to>1||f.from>1||f.to<0||f.from<0)?1:0.000001),b.get("mustKeepLayoutSync")?b.adjust(d,f.current):b.$().css(d,f.current)):this.view[d]!==f.current&&b.set(d,f.current),b._updatingAnimatedProperty=!1},freevarForProperty:function(a){return this[a]},update:function(){for(var b=0,a,d;a=this.freevars[b];b++){this.updateToProperty(a)}},releaseProperties:function(){for(var b=0,a;a=this.properties[b];b++){this.view._currentlyAnimatingProperties[a]=undefined}}.listens("stop"),poolAnimation:function(){if(!this.canReuse){return}while(this.properties.length){this.removeProperty(this.properties[0],!0)}this.properties.length=0;if(this.extraKeys){for(var a in this.extraKeys){delete this[a]}delete this.extraKeys}this.recycle(),this.view._addAnimationToPool(this)}.listens("stop"),markView:function(){this.view.incrementAnimationCount()}.listens("start"),unmarkView:function(){this.view.decrementAnimationCount()}.listens("stop")});CW.PaneAnimationSupport={hasPaneAnimationSupport:YES,hiddenState:{opacity:0},showingState:{opacity:1},duration:350,showDuration:null,hideDuration:null,tween:CW.Anim.tweens.WEBKIT_EASE,showTween:null,hideTween:null,firstShowDelay:0,hideDelay:0,append:function(a){(!this.hasSpritePreloadEnforcement||this._hasShownFromDidCreateLayer)&&this.animateShow(),a()}.enhance(),animateShow:function(){if(SC.browser.isIE8OrLower){this.paneWillShow(),this.paneDidShow();return}this._hideAnim&&this._hideAnim.finish(),this._showAnim&&this._showAnim.finish(),this._showTimer&&(this._showTimer.invalidate(),this._showTimer=null),this._hideTimer&&(this._hideTimer.invalidate(),this._hideTimer=null),this._animatingShow=YES,this.paneWillShow(),this.invokeLast(function(){this._animatingShow=YES,this.adjust(this.get("hiddenState"));var b=this.get("showDuration"),a=[this.get("showingState"),{duration:typeof b=="number"?b:this.get("duration"),tween:this.get("showTween")||this.get("tween"),notifyFrame:function(){this.view.didFrame(this),this.view.showDidFrame(this)}.listens("frame"),completed:function(){this.view._showAnim=null,this.view.paneDidShow(this)}.listens("finish")}];!this._hasAppendedOnce&&this.get("firstShowDelay")!==0?(this._showTimer=this._delayedFirstShowTimer=this.invokeLater(function(){this._showTimer=this._delayedFirstShowTimer=null,this._showAnim=this.animate.apply(this,a)},this.get("firstShowDelay")),this._hasAppendedOnce=YES):this._showTimer=this.invokeLast(function(){this._showTimer=null,this._showAnim=this.animate.apply(this,a)}),this._animatingShow=NO}),this._animatingShow=NO},remove:function(b){if(SC.browser.isIE8OrLower){this.paneWillHide(),b(),this.paneDidHide();return}var a;this.get("isPanelPane")&&this._isShowingModal&&(this._isShowingModal=NO,(a=this._modalPane())&&a.paneDidRemove(this)),this._hideAnim&&this._hideAnim.finish(),this._showAnim&&this._showAnim.finish(),this._showTimer&&(this._showTimer.invalidate(),this._showTimer=null),this._hideTimer&&(this._hideTimer.invalidate(),this._hideTimer=null),this._animatingHide=YES,this.paneWillHide(),this.invokeLast(function(){this._animatingHide=YES;var d=this.get("hideDuration"),e=[this.get("hiddenState"),{duration:typeof d=="number"?d:this.get("duration"),tween:this.get("hideTween")||this.get("tween"),notifyFrame:function(){this.view.didFrame(this),this.view.hideDidFrame(this)}.listens("frame"),enableClickThrough:function(){this.view.$().css("pointerEvents","none")}.listens("start"),removeClickThrough:function(){this.view.$().css("pointerEvents","")}.listens("stop"),completed:function(){this.view._hideAnim=null,b(),this.view.paneDidHide(this)}.listens("finish")}];this.get("hideDelay")!==0?this._hideTimer=this.invokeLater(function(){this._hideTimer=null,this._hideAnim=this.animate.apply(this,e)},this.get("hideDelay")):this._hideTimer=this.invokeLast(function(){this._hideTimer=null,this._hideAnim=this.animate.apply(this,e)}),this._animatingHide=NO}),this._animatingHide=NO}.enhance(),didFrame:function(a){},showDidFrame:function(a){},hideDidFrame:function(a){},paneDidHide:function(a){},paneWillHide:function(){},paneDidShow:function(a){},paneWillShow:function(){}};CW.PaneFadingSupport=SC.clone(CW.PaneAnimationSupport),SC.mixin(CW.PaneFadingSupport,{paneFadeInDuration:100,paneFadeOutDuration:350,showDuration:function(){return this.get("paneFadeInDuration")}.property("paneFadeInDuration").cacheable(),hideDuration:function(){return this.get("paneFadeOutDuration")}.property("paneFadeOutDuration").cacheable(),showingState:function(){return{opacity:this.get("paneOpacity")||1}}.property("paneOpacity").cacheable(),paneDidHide:function(){return this.paneDidFadeOut()},paneDidFadeOut:function(){}});CW.MergeDelegate={shouldMergeOutdatedChangesWhenCommitting:NO,parentStoreRecordPropertyDidChange:function(f,j,h,g,k){},mergeConflictDuringCommit:function(o,m,l,j,k,n,h){return NO},mergeConflictDuringNotify:function(o,m,l,j,k,n,h){return NO}};sc_require("mixins/merge_delegate");CW.AutoMergingNestedStoreDelegate=SC.Object.extend(CW.MergeDelegate,{shouldMergeOutdatedChangesWhenCommitting:YES,parentStoreRecordPropertyDidChange:function(j,o,m,k,p){if(k){o.propagateStatusIfAppropriateFromStore(j,m);return}var l=j.recordTypeFor(m),q,n;if(!l){SC.warn("%@:  Cannot determine the record type for storeKey=%@, which was changed in our parent store (%@)",this,m,j);return}q=p?"'"+p+"'":"all keys";SC.debug("%@:  Our parent store (%@) changed %@ of storeKey %@, which is a record of type %@.  Merging data",o,j,q,m,l);n=l.propertyMergeGroups;o.propagateStatusIfAppropriateFromStore(j,m);o.mergeDataFromStore(j,m,p,undefined,n)},mergeConflictDuringCommit:function(o,m,l,q,k,n,s){this._reportMergeConflict(m,o,l,k,n,s);var t=o.recordTypeFor(l),p=t.typeString||t.toString();SC.warn("Merge conflict for storeKey %@ (%@) during commit:  %@",l,p,k);return YES},mergeConflictDuringNotify:function(o,m,l,q,k,n,s){var t=o.recordTypeFor(l),p=t.typeString||t.toString();SC.warn("Merge conflict for storeKey %@ (%@) during notify:  %@",l,p,k);return YES},_reportMergeConflict:function(v,o,m,l,n,q){var u=CW.StorageCycleAction,t=CW.errorController,s;if(!t){return}if(!n){n=u.ERROR_CONFLICT}if(!q){q=u.STORAGE_OPERATION_UPDATE}s=u.create({name:"Merging storeKey %@ from %@ to %@".fmt(m,v,o,this),type:u.TYPE_UPDATE,storageOperation:q,storeKeys:[m],status:u.STATUS_ERROR,error:n});var p=this.getPath("storageManager.errorController");if(p){p.addActions([s])}}});CW.HashAttributeCommon={isOrphan:NO,parent:null,parentKey:null,store:function(){var a=this.get("parent");return(a?a.get("store"):undefined)}.property("parent").cacheable(),parentIsRecord:function(){var b=this.get("parent");return(b?b.kindOf(SC.Record):NO)}.property("parent").cacheable(),readAttribute:function(d){var e=this.peekAttributes();return e?e[d]:undefined},attributes:function(){if(this.get("isOrphan")){SC.warn("%@:  Requesting 'attributes' on orphaned instance",this);return null}var f=this.get("parent"),d=this.get("parentKey"),e;if(!f){CW.fatalError("Cannot access 'attributes' because there is no parent",{hashAttributeOrArray:this})}if(SC.none(d)){CW.fatalError("Cannot access 'attributes' because there is no parentKey",{hashAttributeOrArray:this})}if(this.get("parentIsRecord")){e=f.get("store").readEditableDataHash(f.get("storeKey"))}else{e=f.get("attributes")}return(e?e[d]:null)}.property("parent","isOrphan"),hashAttributeDidChange:function(d,e,f){this.childHashDidChange(d,e,f)},destroy:function(){var f=this.get("parent"),d,e;if(f){d=this.get("parentKey");if(!d){CW.fatalError("There is a parent but no parentKey",{target:this,parent:f})}e=f.get("attributes");if(e){delete e[d];this.hashAttributeDidChange();this.orphan()}}arguments.callee.base.apply(this,arguments)},getAncestorRecord:function(){var d=this.get("parent"),e;if(d){if(this.get("parentIsRecord")){e=d}else{e=d.getAncestorRecord()}}return e},orphan:function(){var a=this.parent;if(a.indexOf&&a.indexOf(this)){return}if(this._orphan){this._orphan()}this.beginPropertyChanges();this.set("isOrphan",YES);this.set("parent",null);if(this.parentDidChange){this.parentDidChange()}this.set("parentKey",null);this.destroy();this.allPropertiesDidChange();this.endPropertyChanges()},peekAttributes:function(h){var g=this.get("parent"),e=this.get("parentKey"),f;if(g&&!SC.none(e)){f=g.readAttribute(e)}return f}};CW.HashAttributeSupport={hashAttributeFor:function(h){var e=this._hashAttributes,f=null,g;if(e){g=e[h];if(g){f=g}}return f},childHashDidChange:function(k,f,h){if(!f){if(k){this.notifyPropertyChange(k)}else{this.allPropertiesDidChange()}}var j=this.get("parent");var g=this.get("parentKey");this._ignoreChangePropogation=YES;j.childHashDidChange(g,YES,h);this._ignoreChangePropogation=NO},attributeIsDefault:function(h){var f=this[h],g=this.readAttribute(h),e;if(!f||!f.isRecordAttribute){return g===undefined}e=f.get("defaultValue");if(SC.typeOf(e)===SC.T_FUNCTION){e=e(this,h,f)}return g===e||(SC.none(e)&&SC.none(g))},normalize:function(m,t){var v={},u,s,j,o,q,e,b,a,f,w,g,p=this.get("attributes");for(u in this){s=this[u];if(s){j=s.typeClass;if(j){w=s.get("key")||u;g=j.call(s);o=undefined;v[w]=YES;b=SC.typeOf(j.call(s))===SC.T_CLASS;a=s.isNestedRecordTransform||g.isHashAttribute;if(!b&&!a){o=p[w]}else{if(a){q=this.get(u);if(q){if(q.normalize){q.normalize(m,t)}if(!t&&q.isEmpty&&q.isEmpty()){o=null}else{if(q.get("attributes")){o=q.get("attributes")}else{if(q instanceof SC.ChildArray){o=p[w]}}}}}else{if(b){q=this.get(u);if(q){o=p[w]}}}}if(o===undefined){f=s.get("defaultValue");if(SC.typeOf(f)===SC.T_FUNCTION){o=f(this,u,f)}else{o=f}}if(o!==undefined&&(o!==null||m)){p[w]=o}else{if(!m){delete p[w]}}if(q){if(q.isHashAttribute){q.underlyingContentDidChange()}else{if(q.isHashAttributeArray){q.recordPropertyDidChange()}}}}}}for(u in p){if(!v[u]){SC.debug("%@:  Deleting key from underlying data hash due to normalization:  %@",this,u);delete p[u]}}return this},registerHashAttribute:function(k,h){var f=this._hashAttributes,j,g;if(!f){f=this._hashAttributes={}}j=h.get("parent");g=h.get("parentKey");if(this!==j){CW.fatalError("registerChildHashAttribute():  The specified child hash attribute does not have the proper parent",{key:k,target:this,parent:j})}if(k!==g){CW.fatalError("registerChildHashAttribute():  The specified child hash attribute does not have the proper parentKey",{target:this,key:k,parentKey:g})}f[k]=h},unregisterHashAttribute:function(e,h){var f=this._hashAttributes,g;if(!f){CW.fatalError("unregisterChildHashAttribute():  There is no child hash attributes structure",{target:this})}g=f[e];if(!g){CW.fatalError("unregisterChildHashAttribute():  There is no registered child hash attribute for the specified key",{target:this,key:e})}delete f[e]},_hashAttributes:null};CW.MergeSupport={extendedLogging:YES,propagateStatusIfAppropriateFromStore:function(l,k){var g=SC.Record,h=l.peekStatus(k),j=this.peekStatus(k),m;if(h!==j){if(h===g.ERROR){SC.debug("%@:  Propagating ERROR status for storeKey %@ from %@",this,k,l);m=g.ERROR}else{if(h&g.DESTROYED){if(j===g.READY_NEW){SC.debug("%@:  Propagating destroyed status for storeKey %@ from %@ (it was READY_NEW, so marking it as DESTROYED_CLEAN)",this,k,l);m=g.DESTROYED_CLEAN}else{if(j===g.READY_CLEAN){SC.debug("%@:  Propagating destroyed status for storeKey %@ from %@ (it was READY_CLEAN, so marking it as DESTROYED_CLEAN)",this,k,l);m=g.DESTROYED_CLEAN}else{SC.debug("%@:  Propagating destroyed status for storeKey %@ from %@ (it was not READY_CLEAN, so marking as DESTROYED_DIRTY)",this,k,l);m=g.DESTROYED_DIRTY}}}else{if(j===g.ERROR){if(h===g.READY_CLEAN||h===g.DESTROYED_CLEAN){SC.debug("%@:  Propagating status %@ to override our ERROR status for storeKey %@ from %@",this,h,k,l);m=h}}}}}if(m){this.writeStatus(k,m);this.dataHashDidChange(k,null,true)}},mergeDataFromStore:function(M,O,K,N,A){var w=M.readDataHash(O),G=this.readDataHash(O),H=M.previousDataHashesForNotify[O],I=SC.Record,E,D,C,x,L,z,P,F;if(!M){CW.fatalError("mergeDataFromStore():  A store must be specified",{target:this,storeKey:O})}if(!O){CW.fatalError("mergeDataFromStore():  A storeKey must be specified",{target:this,mergeFromStore:M})}if(!w&&!G){CW.fatalError("mergeDataFromStore():  There is no data for the specified storeKey in either the lower-level store or the nested store.  Merge should never be triggered in this scenario.",{mergeFromStore:M,target:this,storeKey:O})}else{if(!w){E=this.peekStatus(O);if(E===I.READY_NEW){E=I.DESTROYED_CLEAN}else{E=I.DESTROYED_DIRTY}this.writeStatus(O,E);SC.debug("There is no data for storeKey %@ in the lower-level store (%@) but there is in the nested store (%@).  Marking it as destroyed.",O,M,this);return}else{if(!G){CW.fatalError("mergeDataFromStore():  There is data for the specified storeKey in the lower-level store but not in the nested store.  Merge should never be triggered in this scenario.",{mergeFromStore:M,target:this,storeKey:O})}else{if(!H){SC.warn("There is no original data for storeKey %@ in the lower-level store (%@).  We cannot merge without this information.  (This usually means that dataHashDidChange is being called unnecessarily.)",O,M);return}}}}if(K){if(A){for(D=0,C=A.length;D<C;++D){x=A[D];if(x.indexOf(K)!==-1){SC.debug("Merging '%@' for storeKey %@ from %@ up to %@, but since its defined as part of a merge group (%@), merging all properties from %@",K,O,M,this,x,M);L=YES;break}}}if(!L){SC.debug("Merging '%@' for storeKey %@ from %@ up to %@",K,O,M,this);if(N&&N.indexOf(K)!==-1){SC.debug("  >  We were requested to ignore this property.  Skipping merge");return}F=this.mergePropertyAsPossible(K,w,G,H,YES,M.get("name"),this.get("name"));if(F.changed){z=[K]}if(F.mergeConflict){P=[K]}}}if(!F){if(!N){SC.debug("Merging all properties for %@ with storeKey %@ from %@ up to %@",M.materializeRecord(O).get("shortTypeString"),O,M,this)}else{SC.debug("Merging all properties except %@ for %@ with storeKey %@ from %@ up to %@",N,M.materializeRecord(O).get("shortTypeString"),O,M,this)}F=this.mergeHashesAsPossible(w,G,H,A,YES,M.get("name"),this.get("name"),N);z=F.changedKeys.concat(F.addedKeys,F.removedKeys);P=F.mergeConflictKeys}if(z&&z.length>0){this.dataHashDidChange(O,null,NO)}else{var y=SC.Store.generateStoreKey();this.revisions[O]=y}if(P&&P.length>0){var J=NO;var B=this.get("delegate");if(B){J=this.invokeDelegateMethod(B,"mergeConflictDuringNotify",M,this,O,z,P)}if(!J){throw SC.Store.CHAIN_CONFLICT_ERROR}}this._updateLock(O)},mergePropertyAsPossible:function(K,E,P,H,Y,S,N){var V=this.get("extendedLogging"),F,X,M,A,Z,I,Q,D,C,W,G,R,J,O;F=X=false;if(!S){S="mergeFrom"}if(!N){N="mergeTo"}if(Y){M=E;Z=S;A=P;I=N}else{M=P;Z=N;A=E;I=S}Q=E[K];D=P[K];C=H[K];var T=CW.getSimpleTypes();W=(Q===C);if(!W){J=SC.typeOf(Q);O=SC.typeOf(C);if(T[J]){W=false}else{W=CW.valuesAreEqual(Q,C,J,O)}}G=(D===C);if(!G){R=SC.typeOf(D);if(T[R]){G=false}else{G=CW.valuesAreEqual(D,C,R,O)}}if(G){if(W){if(V){SC.debug("  >  no need to merge '%@' ('%@'), since it hasnt changed in any hash",K,Q)}}else{SC.debug("  >  taking value from %@ for '%@' ('%@'), since it didnt change in %@ (it was '%@')",S,K,Q,N,D);X=true}}else{if(W){SC.debug("  >  preserving current value for '%@' ('%@') in %@, since it didnt change in %@",K,D,N,S);F=false;X=false}else{var L=M[K],U=A[K];if(CW.valuesAreEqual(E[K],P[K])){SC.debug("  >  no need to merge '%@' ('%@'), even though it changed in both, since both changed it to the same value",K,L)}else{SC.debug("  >  Merge conflict for '%@' (both changed the value).  Preferring value '%@' from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@, and the original value was '%@')",K,L,Z,U,I,!!Y,H[K]);F=true;if(Y){X=true}}}}if(X){P[K]=E[K]}return{mergeConflict:F,changed:X}},mergeHashesAsPossible:function(a7,bd,ay,bi,ba,bh,av,a9){if(a7===bd){CW.fatalError("'mergeFrom' and 'mergeTo' are both the same hash, which is not allowed",{mergeFrom:a7,original:ay})}if(a7===ay){CW.fatalError("'mergeFrom' and 'original' are both the same hash, which is not allowed",{mergeFrom:a7,mergeTo:bd})}if(bd===ay){CW.fatalError("'mergeTo' and 'original' are both the same hash, which is not allowed",{mergeFrom:a7,mergeTo:bd})}var be=this.get("extendedLogging"),aA=[],bf=[],aw=[],a4=[],aP={},aH,ap,aB,a5,aL,a8;if(!bh){bh="mergeFrom"}if(!av){av="mergeTo"}if(ba){aH=a7;aB=bh;ap=bd;a5=av}else{aH=bd;aB=av;ap=a7;a5=bh}aL=CW.hashDifferencesBreakdown(a7,ay,a9);a8=CW.hashDifferencesBreakdown(bd,ay,a9);var aF=aL.equal,aX=a8.equal,bk=aL.different,aV=a8.different,aY=aL.firstHashOnly,aR=a8.firstHashOnly,a6=aL.secondHashOnly,aE=a8.secondHashOnly,an=CW.invertArray(aF),ar=CW.invertArray(aX),au=CW.invertArray(bk),aJ=CW.invertArray(aV),aO=CW.invertArray(aY),j=CW.invertArray(aR),A=CW.invertArray(a6),az=CW.invertArray(aE);var aZ=bk.concat(aY).concat(a6),ax=aV.concat(aR).concat(aE);var aD=CW.invertArray(aZ),aC=CW.invertArray(ax),aq=CW.combineHashes(aD,aC),a0;for(a0 in aD){aq[a0]=true}for(a0 in aC){aq[a0]=true}var aQ=CW.invertHash(aq);var aI,bg,bj,aK,at,bb=SC.clone(aq,YES),bc=[],aU;if(bi){for(aI=0,bg=bi.length;aI<bg;++aI){aU=[];bj=bi[aI];for(aK=0,at=bj.length;aK<at;++aK){a0=bj[aK];aU.push(a0);delete bb[a0]}bc.push(aU)}}for(a0 in bb){bc.push(a0);delete bb[a0]}var ao,aW,aN,aT,aM,a2,aG,a3;for(aI=0,bg=bc.length;aI<bg;++aI){aU=bc[aI];aW=aN=null;ao=!(aU instanceof Array);if(ao){a0=aU;aW=aD[a0]?a0:null;aN=aC[a0]?a0:null;if(aW||aN){aT=CW.valuesAreEqual(a7[a0],bd[a0]);aW=(aW&&!aT)?a0:null;aN=(aN&&!aT)?a0:null}}else{for(aK=0,at=aU.length;aK<at;++aK){a0=aU[aK];if(aD[a0]){if(aC[a0]){if(!CW.valuesAreEqual(a7[a0],bd[a0])){if(aW){aW.push(a0)}else{aW=[a0]}if(aN){aN.push(a0)}else{aN=[a0]}}else{}}else{if(aW){aW.push(a0)}else{aW=[a0]}}}else{if(aC[a0]){if(aN){aN.push(a0)}else{aN=[a0]}}}}}if(aW&&aN){if(ao){if(aA.indexOf(a0)===-1){aA.push(a0)}aM=aH[a0];a2=ap[a0];if(au[a0]&&aJ[a0]){SC.debug("  >  Merge conflict for '%@' (both changed the value).  Preferring value '%@' from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@, and the original value was '%@')",a0,aM,aB,a2,a5,!!ba,ay[a0]);if(ba){bf.push(a0)}}else{if(aO[a0]&&j[a0]){SC.debug("  >  Merge conflict for '%@' (both added a value for this key, but they do not match).  Preferring value '%@' from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@)",a0,aM,aB,a2,a5,!!ba);if(ba){bf.push(a0)}}else{if(au[a0]&&az[a0]){if(ba){SC.debug("  >  Merge conflict for '%@' (%@ changed the value, %@ removed it).  Preferring value '%@' from %@ over removal from %@ (preferMergeFromIfConflict=%@)",a0,bh,av,aM,aB,a5,!!ba);aw.push(a0)}else{SC.debug("  >  Merge conflict for '%@' (%@ changed the value, %@ removed it).  Preferring removal from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@)",a0,bh,av,aB,a2,a5,!!ba)}}else{if(A[a0]&&aJ[a0]){if(ba){SC.debug("  >  Merge conflict for '%@' (%@ changed the value, %@ removed it).  Preferring removal from %@ over value '%@' from %@ (preferMergeFromIfConflict=%@)",a0,av,bh,aB,a2,a5,!!ba);a4.push(a0)}else{SC.debug("  >  Merge conflict for '%@' (%@ changed the value, %@ removed it).  Preferring value '%@' from %@ over removal from %@ (preferMergeFromIfConflict=%@)",a0,av,bh,aM,aB,a5,!!ba)}}else{CW.fatalError("Bad merge state:  Were claiming that theres a merge conflict for a single key, but the combination doesnt make sense",{key:a0,mergeFrom:bh,mergeFromValue:a7[a0],changedInMergeFrom:au[a0],addedInMergeFrom:aO[a0],removedInMergeFrom:A[a0],mergeTo:av,mergeToValue:bd[a0],changedInMergeTo:aJ[a0],addedInMergeTo:j[a0],removedInMergeTo:az[a0]})}}}}}else{SC.debug("  >  Merge conflict for grouped properties [%@]:  dirty in %@: [%@],  dirty in %@: [%@]",aU,bh,aW,av,aN);if(ba){SC.debug("  >  Will prefer all values for this group as they are in %@",bh);for(aK=0,at=aU.length;aK<at;++aK){a0=aU[aK];if(!an[a0]&&aA.indexOf(a0)===-1){aA.push(a0)}aG=a7[a0];a3=bd[a0];if(a3===undefined){if(aG!==undefined){SC.debug("       -  adding '%@' ('%@') from %@, since its not in %@",a0,aG,bh,av);aw.push(a0)}else{}}else{if(aG===undefined){SC.debug("       -  removing '%@' ('%@') from %@, since its not in %@",a0,a3,av,bh);a4.push(a0)}else{if(!CW.valuesAreEqual(aG,a3)){SC.debug("       -  taking '%@' ('%@') from %@, which will overwrite %@s previous value ('%@')",a0,aG,bh,av,a3);bf.push(a0)}}}}}else{SC.debug("  >  Will prefer all values for this group as they are in %@",av);for(aK=0,at=aU.length;aK<at;++aK){a0=aU[aK];if(!an[a0]&&aA.indexOf(a0)===-1){aA.push(a0)}}}}}else{if(ao){aG=a7[a0];a3=bd[a0];if(au[a0]){if(aJ[a0]){SC.debug("  >  no need to merge '%@' ('%@'), even though it changed in both, since both changed it to the same value",a0,aG)}else{SC.debug("  >  taking value from %@ for '%@' ('%@'), since it didnt change in %@ (it was '%@')",bh,a0,aG,av,a3);bf.push(a0)}}else{if(aO[a0]){if(j[a0]){SC.debug("  >  no need to merge '%@' ('%@'), even though it was added to both, since both added the same value",a0,aG)}else{SC.debug("  >  taking value from %@ for '%@' ('%@'), since it was only added there",bh,a0,aG);aw.push(a0)}}else{if(A[a0]){if(az[a0]){SC.debug("  >  no need to merge '%@' ('%@'), because it was removed from both",a0,aG)}else{SC.debug("  >  removing value for '%@' ('%@') from %@, since it was removed from %@",a0,a3,av,bh);a4.push(a0)}}}}}else{if(be){SC.debug("  >  Considering group of keys [%@]",aU)}for(aK=0,at=aU.length;aK<at;++aK){a0=aU[aK];aG=a7[a0];a3=bd[a0];if(au[a0]){SC.debug("       -  taking '%@' ('%@') from %@, which will overwrite %@s previous value ('%@')",a0,aG,bh,av,a3);bf.push(a0)}else{if(aO[a0]){SC.debug("       -  adding '%@' ('%@') from %@, since its not in %@",a0,aG,bh,av);aw.push(a0)}else{if(A[a0]){SC.debug("       -  removing '%@' ('%@') from %@, since its not in %@",a0,a3,av,bh);a4.push(a0)}else{if(be){SC.debug("       -  no need to take '%@' ('%@') from %@, since its the same value in %@",a0,aG,bh,av)}}}}}}}}var aS=bf.concat(aw),a1;for(aI=0,a1=aS.length;aI<a1;++aI){a0=aS[aI];bd[a0]=SC.clone(a7[a0],YES)}for(aI=0,a1=a4.length;aI<a1;++aI){a0=a4[aI];delete bd[a0]}return{mergeConflictKeys:aA,changedKeys:bf,addedKeys:aw,removedKeys:a4}},_updateLock:function(h){var e=this.locks,f,g;if(!e){CW.fatalError("Store has no locks defined, and we expected the specified storeKey to be locked during the merge.",{target:this,storeKey:h})}if(!e[h]){CW.fatalError("Store has no lock for the specified storeKey, and we expected it to be locked during the merge.",{target:this,storeKey:h})}f=this.revisions[h];e[h]=f||1}};CW.StoreCommon={delegate:null,chain:function(e,d){if(!d){d=CW.NestedStore}return arguments.callee.base.call(this,e,d)},storageManager:null,getCurrentCommitCycle:function(){var d=null,e=this.getPath("storageManager.currentCycle");if(e&&e.get("type")===CW.StorageCycle.COMMIT_CYCLE){d=e}return d},commitAgentsFor:function(d){var e=this.commitAgents;return(e?e[d]:null)},lastCommitAgentWithParam:function(n,l){var o=this.commitAgents,q=null,p,k,j,m;if(o){o=o[n];if(o){for(k=o.length,p=(k-1);p>=0;--p){j=o[p];m=j.get("params");if(m&&m.hasOwnProperty(l)){q=j;break}}}}return q},notifyCommitAgents:function(n,l,o){var p=this.commitAgentsFor(n),j,k,q,m;if(p){for(j=0,k=p.length;j<k;++j){q=p[j];if(q){m=q[l];if(m){m.call(null,n,o)}}}}},previousDataHashesForNotify:null,commitAgents:null,_notifyRecordPropertyChange:function(s,B,t){var F=this.records,z=this.get("nestedStores"),x=SC.Store,D,E,A,u,v,C,q;A=z?z.length:0;for(u=0;u<A;u++){v=z[u];C=v.peekStatus(s);E=v.storeKeyEditState(s);if(E===x.INHERITED){v._notifyRecordPropertyChange(s,B,t)}else{if(C&SC.Record.BUSY){if(v.get("hasChanges")){throw x.CHAIN_CONFLICT_ERROR}v.reset()}else{if(!v._isCommitting){var y=v.get("delegate");if(y){v.invokeDelegateMethod(y,"parentStoreRecordPropertyDidChange",this,v,s,B,t)}else{SC.warn("%@:  Record with storeKey %@ changed underneath us, but since we have no merge delegate set, we wont inherit the changes",v,s)}}}}if(!B&&!this.get("parentStore")){delete this.previousDataHashesForNotify[s];this._savePreviousDataHashForNotify(s)}}var w=this.recordPropertyChanges;if(!w){w=this.recordPropertyChanges={storeKeys:SC.CoreSet.create(),records:SC.CoreSet.create(),hasDataChanges:SC.CoreSet.create(),propertyForStoreKeys:{}}}w.storeKeys.add(s);if(F&&(D=F[s])){w.records.push(s);if(!B){w.hasDataChanges.push(s)}if(t){if(!(q=w.propertyForStoreKeys[s])){q=w.propertyForStoreKeys[s]=SC.CoreSet.create()}if(q!=="*"){q.add(t)}}else{w.propertyForStoreKeys[s]="*"}}this.invokeOnce(this.flush);return this},_verifyLockRevisions:function(ag,ah,T){var ao=this._mergedProperties,am=this._mergedDataHashes;var X=!!T.getPath("delegate.shouldMergeOutdatedChangesWhenCommitting"),Z,R,K,Q;var al=ag.length,ak=this.revisions,P,O,aw,ab;if(ah&&ak){for(P=0;P<al;P++){O=ag[P];aw=ah[O]||1;ab=ak[O]||1;var af=NO;if(aw<ab){var au=SC.Store.recordTypeFor(O);SC.debug("Potential conflict while committing from %@ down to %@:  storeKey %@, of type %@:",T,this,O,au);var ar=SC.Record,A=CW.StorageCycleAction,ap=T.peekStatus(O),aq=this.peekStatus(O),ac=SC.Record.DESTROYED,U=SC.Record.READY_NEW,W=(ap&ac)?A.STORAGE_OPERATION_DESTROY:A.STORAGE_OPERATION_UPDATE,aa=NO,av,ad,Y;if(X){SC.debug("  >  lock=%@,  current revision=%@",aw,ab);SC.debug("Version in %@:",T);SC.debug("%@",T.materializeRecord(O));SC.debug("Version in %@:",this);SC.debug("%@",this.materializeRecord(O));var at,V,ai;if(aq&ac){if(ap&ac){SC.debug("This record was destroyed in both stores, so ignoring it in the commit")}else{ad=A.ERROR_NOT_FOUND}}else{if(ap&ac){ad=A.ERROR_CONFLICT}else{if((ap===U)&&!(aq===U)){T.writeStatus(O,SC.Record.READY_DIRTY)}var ae=T.previousDataHashesForCommit[O];if(!ae){CW.fatalError("The nested store does not have a record of the original values of its data hash for a particular storeKey, which we need in order to commit.",{target:this,nestedStore:T,storeKey:O,recordType:au})}R=SC.clone(this.readDataHash(O),YES);Z=T.readDataHash(O);var aj=this.mergeHashesAsPossible;if(aj){SC.debug("Merging data for storeKey %@ from %@ down into %@",O,T,this);ai=aj.call(this,Z,R,ae,au.propertyMergeGroups,NO,T.get("name"),this.get("name"));at=ai.changedKeys.concat(ai.addedKeys,ai.removedKeys);V=ai.mergeConflictKeys;ao[O]=at;am[O]=R;if(at.length===0){SC.debug("The merge for storeKey %@ resulted in there being no actual changes in %@",O,this.get("name"))}if(V.length===0){aa=YES}}}}if(ad||(V&&V.length>0)){var an=T.get("delegate"),S=NO;if(an){S=T.invokeDelegateMethod(an,"mergeConflictDuringCommit",this,T,O,at,V,ad,W)}if(!S){af=YES}}}else{throw SC.Store.CHAIN_CONFLICT_ERROR}if(!aa){SC.debug("Removing this commit from %@s changelog",this.get("name"));Y=T.changelog;if(Y){Y.remove(O)}Y=T.chainedChanges;if(Y){Y.remove(O)}K=this.getCurrentCommitCycle();if(K){Q=K.get("changelog");if(Q){Q.remove(O)}}this.notifyCommitAgents(O,"commitWasUnnecessaryAtStore")}}if(af){throw SC.Store.CHAIN_CONFLICT_ERROR}}}return this}};sc_require("mixins/hash_attribute_common");sc_require("mixins/hash_attribute_support");CW.HashAttribute=SC.Object.extend(CW.HashAttributeCommon,CW.HashAttributeSupport,{allPropertiesDidChange:function(){var b=this.relationships,a=b?b.length:0;while(--a>=0){if(b[a] instanceof CW.HashAttributeArray){b[a].recordPropertyDidChange()}else{b[a].allPropertiesDidChange()}}return arguments.callee.base.apply(this,arguments)},isHashAttribute:YES,normalize:function(m,n,k){if(this.get("isOrphan")){CW.fatalError("normalize():  Cannot write to an orphan hash attribute",{target:this})}var h=this.get("attributes"),l,o,j;if(!h){if(!this._neverHadAHash){CW.fatalError("normalize():  We once had a hash but no longer do",{target:this})}l=this.get("parent");o=this.get("parentKey");if(!l){CW.fatalError("normalize():  There is no parent",{target:this})}else{if(!o){CW.fatalError("normalize():  There is no parentKey",{target:this,parent:l})}else{if(l.isHashAttributeArray){CW.fatalError("normalize():  There are no attributes but the parent is a hash attribute array",{target:this,parent:l})}}}h={};l.writeAttribute(o,h);this._neverHadAHash=NO}m(n,k)}.enhance(),_checkedKeys:SC.CoreSet.create(),isEmpty:function(){var j,g,h,k=this._checkedKeys.clear();for(j in this){g=this[j];if(!g||!g.isRecordAttribute){continue}h=this.get("key");if((h&&h.isEmpty&&h.isEmpty())||!this.attributeIsDefault(j)){return NO}k.add(j)}var f=this.get("attributes");for(j in f){if(!k.contains(j)){return NO}}return YES},beginEditing:function(){this._editLevel++;return this},endEditing:function(b){if(--this._editLevel<=0){this._editLevel=0;this.hashAttributeDidChange(b)}return this},writeAttribute:function(n,k,l){if(this.get("isOrphan")){SC.debug("writeAttribute():  Cannot write to an orphan hash attribute");return this}var h=this.get("attributes"),m,o,j;if(!h){if(!this._neverHadAHash){CW.fatalError("writeAttribute():  We once had a hash but no longer do",{target:this})}m=this.get("parent");o=this.get("parentKey");if(!m){CW.fatalError("writeAttribute():  There is no parent",{target:this})}else{if(!o){CW.fatalError("writeAttribute():  There is no parentKey",{target:this,parent:m})}else{if(m.isHashAttributeArray){CW.fatalError("writeAttribute():  There are no attributes but the parent is a hash attribute array",{target:this,parent:m})}}}h={};h[n]=k;m.writeAttribute(o,h);this._neverHadAHash=NO}else{if(k!==h[n]){if(!l){this.beginEditing()}h[n]=k;if(!l){this.endEditing(n)}}}return this},storeDidChangeProperties:function(f,e){if(e){this.beginPropertyChanges();e.forEach(function(a){this.notifyPropertyChange(a)},this);this.endPropertyChanges()}else{this.allPropertiesDidChange()}var h=this.relationships,g=h?h.length:0;while(--g>=0){h[g].recordPropertyDidChange(e)}},unknownProperty:function(d,f){var e;if(f!==undefined){e=this.constructor;if(e.ignoreUnknownProperties===YES){this[d]=f}else{this.writeAttribute(d,f)}return f}else{return this.readAttribute(d)}},toString:function(){var d=arguments.callee.base.apply(this,arguments),e=this.peekAttributes();d+="  "+SC.inspect(e);return d},parentDidChange:function(){var f=this._previousParent,h=this.get("parent"),e=this.get("parentKey"),g;if(SC.none(e)){return}if(f!==h){g=this.underlyingContentDidChange;if(f){if(f.unregisterHashAttribute){f.unregisterHashAttribute(e,this)}f.removeObserver(e,this,g)}if(h){if(h.registerHashAttribute){h.registerHashAttribute(e,this)}h.addObserver(e,this,g)}this._previousParent=h;g.call(this)}}.observes("parent"),underlyingContentDidChange:function(){if(this._ignoreChangePropogation){this._ignoreChangePropogation=NO;return}if(this.get("isOrphan")){return}if(!this._neverHadAHash&&!this.peekAttributes()){this.orphan()}else{this.allPropertiesDidChange()}},init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("parent");if(!b){CW.fatalError("A hash attribute must have a parent",{hashAttribute:this})}if(!b.isRecord&&!b.isHashAttribute&&!b.isHashAttributeArray){CW.fatalError("A hash attribute arrays parent must either be a record, a hash attribute, or a hash attribute array",{hashAttribute:this,parent:b})}if(!this.peekAttributes()){this._neverHadAHash=YES}this.parentDidChange()},_editLevel:0,_neverHadAHash:NO});CW.HashAttribute.mixin({instantiateHashAttribute:function(e,f,d){if(!SC.kindOf(e,CW.HashAttribute)){CW.fatalError("%@ is not a kind of CW.HashAttribute".fmt(e))}return e.create({parent:f,parentKey:d})},isComplex:YES,isHashAttribute:YES});SC.RecordAttribute.registerTransform(CW.HashAttribute,{to:function(j,g,h,k,l){var m;if(!k){CW.fatalError("Error during transform:  A parent must be specified")}else{if(!k.kindOf(CW.Record)&&!k.kindOf(CW.HashAttribute)){CW.fatalError("The parent must be either an instance of subclass of either CW.Record or CW.HashAttribute",{parent:k,parentKey:l})}else{m=k.hashAttributeFor(l);if(!m){m=CW.HashAttribute.instantiateHashAttribute(h,k,l)}}}return m},from:function(b){if(b&&b.isHashAttribute){CW.fatalError("You should never set a hash attribute directly",{target:this,instance:b})}}});sc_require("mixins/hash_attribute_common");sc_require("mixins/hash_attribute_support");CW.HashAttributeArray=SC.Object.extend(CW.HashAttributeCommon,CW.HashAttributeSupport,SC.Enumerable,SC.Array,{isHashAttributeArray:YES,objectType:null,manyAttribute:null,normalize:function(g,l){var j=this._getReadOnlyUnderlyingArray(),h=j?j.get("length"):0,m,k;for(m=0;m<h;m++){k=this.objectAt(m);k.normalize(g,l)}return this},length:function(){var b=this._getReadOnlyUnderlyingArray();return(b?b.length:0)}.property("parent","parentKey"),objectAt:function(h){var l=this._hashAttributes,j,k,g,m;if(l){m=l[h]}if(!m){j=this._getReadOnlyUnderlyingArray();if(j){k=j[h];if(k){if(SC.typeOf(k)!==SC.T_HASH){CW.fatalError("objectAt():  The object in the array is not a hash",{hashAttributeArray:this,index:h})}g=this.get("objectType");m=CW.HashAttribute.instantiateHashAttribute(g,this,h);if(!l){l=this._hashAttributes=[]}l[h]=m}}}return m},replace:function(u,v,s){var t=this._getEditableUnderlyingArray(),n=[],q=s?(s.get?s.get("length"):s.length):0,x,o;this.arrayContentWillChange(u,v,q);for(x=0;x<q;++x){o=s.objectAt(x);if(SC.kindOf(o,CW.HashAttribute)){o=SC.clone(o.get("attributes"),YES)}else{if(SC.typeOf(o)!==SC.T_HASH){CW.fatalError("Illegal type of item specified in replace()",{target:this,index:x,items:s})}}n.push(o)}t.replace(u,v,n);var y=this._hashAttributes;if(y){var w=t?t.length:0;var p=u+v,z=u+q;for(x=u;x<p;++x){o=y[x];if(o){o.orphan()}}y.splice(u,v);for(x=u;x<w;++x){if(x<z){y.splice(x,0,null)}else{if(o=y[x]){o.set("parentKey",x)}}}if(w!==y.length){CW.fatalError("Hash attribute array length is different from underlying array length",{target:this})}}this.arrayContentDidChange(u,v,q);this.enumerableContentDidChange();this.hashAttributeDidChange(null,YES);return this},isEmpty:function(){var b=this._getReadOnlyUnderlyingArray();return !b||b.get("length")===0},_getReadOnlyUnderlyingArray:function(){var d=this.get("parent"),e=this.get("parentKey");if(!d){CW.fatalError("No parent defined")}if(!e){CW.fatalError("No parentKey defined")}return d.readAttribute(e)},_getEditableUnderlyingArray:function(){var g=this.get("parent"),h=this.get("parentKey"),f,e;if(!g){CW.fatalError("No parent defined")}if(!h){CW.fatalError("No parentKey defined")}f=g.get("attributes");e=f[h];if(!e){e=f[h]=[];this.recordPropertyDidChange(SC.Set.create([h]));this.hashAttributeDidChange(null,YES,YES)}return e},recordPropertyDidChange:function(n){if(n&&!n.contains(this.get("parentKey"))){return this}var z=this._previousUnderlyingArray,q=this._getReadOnlyUnderlyingArray();var s=0,v=0;if(z){s=z.get("length")}this._previousUnderlyingArray=q;if(q){v=q.get("length")}var u=Math.max(0,s-v),p=Math.max(0,v-s),x=Math.min(v,s);this.arrayContentWillChange(x,u,p);var w=this._hashAttributes;if(w){var t,o,y=Math.max(s,v);for(t=0;t<y;t++){o=w[t];if(o){if(t<v){o.allPropertiesDidChange()}else{o.orphan()}}}w.length=v}this.arrayContentDidChange(x,u,p);this.enumerableContentDidChange()},_orphan:function(){var h=this._hashAttributes,e,f,g;if(h){for(e=0,f=h.length;e<f;++e){g=h[e];if(g){g.orphan()}}this._hashAttributes=null}},init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("parent");if(!b){CW.fatalError("A hash attribute array must have a parent",{hashAttributeArray:this})}if(!b.isRecord&&!b.isHashAttribute){CW.fatalError("A hash attribute arrays parent must either be a record or a hash attribute",{hashAttributeArray:this})}this.recordPropertyDidChange()},_hashAttributes:null,_previousUnderlyingArray:null});CW.HashAttributeArray.mixin({isComplex:YES,isHashAttributeArray:YES});CW.ManyArray=SC.ManyArray.extend({objectAt:function(a){var h=this._records,g=this.get("readOnlyStoreIds"),d=this.get("store"),j=this.get("recordType"),f,e,b;if(!g||!d){return undefined}b=g.objectAt(a);if(h&&(e=h[a])&&e.get("id")==b){return e}if(!h){this._records=h=[]}if(b){f=d.storeKeyFor(j,b);if(d.readStatus(f)===SC.Record.EMPTY){d.retrieveRecord(j,null,f)}h[a]=e=d.materializeRecord(f)}return e},});CW.ManyAttribute=SC.ManyAttribute.extend({toType:function(b,e,g){var f=this.get("typeClass"),j=this.get("key")||e,h=SC.keyFor("__manyArray__",SC.guidFor(this)),d=b[h],a;if(!d){d=CW.ManyArray.create({recordType:f,record:b,propertyName:j,manyAttribute:this});b[h]=d;a=b.get("relationships");if(!a){b.relationships=a=[]}a.push(d)}return d},fromType:function(b,f,g){var d=[];if(!SC.isArray(g)){throw"Expects toMany attribute to be an array"}var a=g.get("length");for(var e=0;e<a;e++){d[e]=g.objectAt(e).get("id")}return d},});CW.ManyHashAttribute=SC.RecordAttribute.extend({toType:function(n,l,o){var p=this.get("typeClass"),t=this.get("key")||l,s=SC.keyFor("__cw__hashAttributeArray__",SC.guidFor(this)),q=n[s],m,k;if(n&&n.isRecord){m=n.get("store");if(m&&!m.isCoreWebStore){CW.fatalError("Hash attribute arrays require the ancestor record to belong to a CoreWeb store rather than an SC.Store",{target:this,parent:n,store:m})}}if(!q){q=CW.HashAttributeArray.create({objectType:p,parent:n,parentKey:t,manyAttribute:this});n[s]=q;k=n.relationships;if(!k){n.relationships=[q]}else{k.push(q);k.enumerableContentDidChange()}}return q},fromType:function(k,l,j){var g=[],m,h;if(!SC.isArray(j)){CW.fatalError("CW.ManyHashAttribute#fromType:  The toMany attribute should be an array")}for(m=0,h=j.get("length");m<h;++m){if(j.objectAt(m) instanceof CW.HashAttribute){g[m]=SC.clone(j.objectAt(m).get("attributes"),YES)}else{g[m]=j.objectAt(m)}}return g}});sc_require("mixins/hash_attribute_support");sc_require("models/hash_attribute");sc_require("models/many_hash_attribute");CW.Record=SC.Record.extend(CW.HashAttributeSupport,{typeString:function(){var e=this.get("store");if(!e){return null}var d=this.get("storeKey");if(!d){return null}var f=e.recordTypeFor(this.get("storeKey"));if(!f){return null}return f.typeString}.property("store","storeKey").cacheable(),childHashDidChange:function(h,e,g){var f=this.get("store");f.recordDidChange(null,null,this.get("storeKey"),h,YES);this.propagateToAggregates();if(!g){f.flush()}},shortTypeString:function(){var e=this.get("store");if(!e){return null}var d=this.get("storeKey");if(!d){return null}var f=e.recordTypeFor(this.get("storeKey"));if(!f){return null}return f.shortTypeString()}.property("store","storeKey").cacheable(),shortString:function(){var e=this.get("shortTypeString"),d;if(e){e=e.toLowerCase();d=this.get("title");if(d){e+=" %@".fmt(d)}else{e+=" with ID %@".fmt(this.get(this.get("primaryKey")))}}else{e=this.toString()}return e},ownerProperty:null,owner:function(){var b=this.get("ownerProperty");return(b?this.get("property"):null)}.property("ownerProperty"),rootOwner:function(){var b=this.get("owner");if(!b){return this}else{return b.get("rootOwner")}}.property("owner"),isAggregate:function(){var d=this.get("ownerProperty"),e=NO,f;if(d){f=this[d];e=(f&&f.aggregate)}return e}.property("ownerProperty"),aggregates:function(){var w=[],t,y,C,G,v,u,j,E,z,D,F,x,B,H,A;for(t in this){y=this[t];if(y){C=y.typeClass;if(C){C=C.call(y);G=SC.typeOf(C)===SC.T_CLASS;if(G){v=y.inverse;if(v){u=C.prototype[v];if(u){j=u.aggregate;if(j){E=this.get(t);if(E){for(z=0,D=E.get("length");z<D;++z){F=E.objectAt(z);w.push(F);x=F.get("aggregates");if(x){for(B=0,H=x.length;B<H;++B){A=x[B];w.push(A)}}}}}}}}}}}return w.length?w:null}.property(),usesHashAttributes:function(){var m=NO,g=this._hashAttributes,k,l,h,j;if(g){if(g.length>0){m=YES}}if(!m){k=this.relationships;if(k){for(l=0,h=k.length;l<h;++l){j=k[l];if(SC.kindOf(j,CW.HashAttributeArray)){m=YES;break}}}}return m}.property().cacheable()});SC.mixin(CW.Record,{toMany:function(d,e){if(SC.kindOf(d,CW.HashAttribute)){return CW.ManyHashAttribute.attr(d,e)}else{if(SC.kindOf(d,CW.Record)){return CW.ManyAttribute.attr(d,e)}else{return SC.Record.toMany(d,e)}}},shortTypeString:function(){var b=this.typeString;if(b){b=b.split(".");b=b[b.length-1]}return b},storeKeyIfValid:function(g,e){if(!g){CW.fatalError("storeKeyIfValid():  You must specify an ID.")}if(!e){CW.fatalError("storeKeyIfValid():  You must specify a store.")}var h=this.storeKeyExists(g),f;if(h){f=e.peekStatus(h);if(f===this.DESTROYED_CLEAN){h=null}}return h}});CW.CommitAgent=SC.Object.extend({storeKeys:null,params:null,recordWasCommittedToStore:function(d,e){},commitWasUnnecessaryAtStore:function(d,e,f){},recordWasCommittedToServer:function(e,d){},commitToServerFailed:function(e,d){}});sc_require("mixins/store_common");CW.NestedStore=SC.NestedStore.extend(CW.StoreCommon,SC.DelegateSupport,{isCoreWebStore:YES,hasChangesInStoreHierarchy:function(){if(this.get("hasChanges")){return YES}var e=this.get("nestedStores"),h,f,g;if(e){for(h=0,f=e.length;h<f;++h){g=e[h];if(g.get("hasChangesInStoreHierarchy")){return YES}}}return NO},commitChanges:function(I,K,G){this._isCommitting=YES;var w=this,z,C,A,B,D,y,e,J,L,x;if(G){C=this.chainedChanges;if(!C){CW.fatalError("Requested to commit a subset of storeKeys but there is no chainedChanges set",{target:this,storeKeys:G})}G.forEach(function(a){if(!C.contains(a)){CW.fatalError("Requested to commit a storeKey that is not in the chainedChanges set",{target:this,storeKeys:G,chainedChanges:C})}});z=this.changelog;if(z){z.removeEach(G)}if(C){C.removeEach(G)}this._dataHashesToRestore={};this._revisionsToRestore={};this._statusesToRestore={};this._locksToRestore={};this._editablesToRestore={};this._previousDataHashesForNotifyToRestore={};this._previousDataHashesForCommitToRestore={};this._commitAgentsToRestore={};B=["dataHashes","revisions","statuses","locks","editables","previousDataHashesForNotify","previousDataHashesForCommit","commitAgents"];D=B.length;C.forEach(function(a){for(y=0;y<D;++y){e=B[y];J=w[e];if(J&&J.hasOwnProperty(a)){L="_"+e+"ToRestore";w[L][a]=J[a]}}});this._changelogAfterCommit=z;this._chainedChangesAfterCommit=C;this.changelog=this.chainedChanges=G}if(K){var H=K.get("storeKeys");if(!H){H=SC.CoreSet.create();C=this.chainedChanges;if(C){H.addEach(C)}}var E=this.commitAgents;if(!E){E=this.commitAgents={}}H.forEach(function(a){var b=E[a];if(!b){b=E[a]=[];b.push(K)}})}var v=arguments.callee.base.apply(this,arguments);if(G){z=this._changelogAfterCommit;C=this._chainedChangesAfterCommit;this._changelogAfterCommit=null;this._chainedChangesAfterCommit=null;if(C.get("length")>0){var F;C.forEach(function(a){for(y=0;y<D;++y){e=B[y];L="_"+e+"ToRestore";J=w[L];if(J.hasOwnProperty(a)){F=w[e];if(!F){F=w[e]={}}F[a]=J[a]}}});this.changelog=z;this.chainedChanges=C;this.set("hasChanges",YES)}}this._isCommitting=NO;return v},reset:function(){var J=this.get("parentStore");if(!J){throw SC.Store.NO_PARENT_STORE_ERROR}var C=this.dataHashes,z=this.statuses;this.dataHashes=SC.beget(J.dataHashes);this.revisions=SC.beget(J.revisions);this.statuses=SC.beget(J.statuses);var H=this.get("nestedStores"),y,x,D;if(H){for(y=0,x=H.length;y<x;++y){D=H[y];if(!D._fixUpProtypeChainsAfterParentReset){CW.fatalError("The nested store is not a CW.NestedStore, and it needs to be for correct behavior.  A critical bugfix we have made for persistent nested stores has not yet made its way into SproutCore.",{target:this,nestedStore:D})}D._fixUpProtypeChainsAfterParentReset()}}this.previousDataHashesForNotify=SC.beget(J.previousDataHashesForNotify);this.previousDataHashesForCommit={};this.commitAgents=null;this.chainedChanges=this.locks=this.editables=null;this.changelog=null;var K={},L={},I;if(C){var u,E,G=this.dataHashes,A=CW.valuesAreEqual;for(I in C){if(!C.hasOwnProperty(I)){continue}u=C[I];E=G[I];if(!A(u,E)){K[I]=YES}}}if(z){var B,w,F=this.statuses;for(I in z){if(!z.hasOwnProperty(I)){continue}B=z[I];w=F[I];if(B!==w){L[I]=YES}}}var v;for(I in L){if(K[I]){v=NO;delete K[I]}else{v=YES}this._notifyRecordPropertyChange(parseInt(I,10),v)}for(I in K){this._notifyRecordPropertyChange(parseInt(I,10),NO)}this.set("hasChanges",NO)},commitChangesFromNestedStore:function(q,p,v){CW.Store.prototype.commitChangesFromNestedStore.apply(this,arguments);var u=this.get("parentStore"),n=u.revisions,t;var l=this.locks,o=this.chainedChanges,s,m;if(!l){l=this.locks=[]}if(!o){o=this.chainedChanges=SC.Set.create()}s=p.length;for(t=0;t<s;t++){m=p[t];if(!l[m]){l[m]=n[m]||1}o.add(m)}this.setIfChanged("hasChanges",o.get("length")>0);this.flush();return this},_isCommitting:NO,previousDataHashesForCommit:null,readEditableDataHash:function(e){var d=this.recordTypeFor(e);this._savePreviousDataHashForNotify(e,d);this._savePreviousDataHashForCommit(e,d);return arguments.callee.base.apply(this,arguments)},writeDataHash:function(d,f,e){if(f){this._savePreviousDataHashForNotify(d);this._savePreviousDataHashForCommit(d)}return arguments.callee.base.apply(this,arguments)},_savePreviousDataHashForNotify:function(e,g){var f=this.get("nestedStores");if(f&&f.length>0){var h=this.previousDataHashesForNotify;if(!h[e]||!h.hasOwnProperty(e)){h[e]=SC.clone(this.dataHashes[e],YES)}}},_savePreviousDataHashForCommit:function(e){var d=this.previousDataHashesForCommit;if(!d[e]||!d.hasOwnProperty(e)){d[e]=SC.clone(this.dataHashes[e],YES)}},_lock:function(m){var n=this.locks,j,l;if(n&&n[m]){return this}if(!n){n=this.locks=[]}l=this.editables;if(l){l[m]=0}var o=this.get("parentStore"),h;while(o&&(h=o.storeKeyEditState(m))===SC.Store.INHERITED){o=o.get("parentStore")}var k=this.recordTypeFor(m);this._savePreviousDataHashForNotify(m,k);this._savePreviousDataHashForCommit(m,k);if(o&&h===SC.Store.EDITABLE){this.dataHashes[m]=SC.clone(o.dataHashes[m],YES);if(!l){l=this.editables=[]}l[m]=1}else{if(o&&h===SC.Store.LOCKED){this.dataHashes[m]=SC.clone(o.dataHashes[m],YES)}else{this.dataHashes[m]=this.dataHashes[m]}}this.statuses[m]=this.statuses[m];j=this.revisions[m]=this.revisions[m];n[m]=j||1;return this},_fixUpProtypeChainsAfterParentReset:function(){var t=this.get("parentStore");if(!t){throw SC.Store.NO_PARENT_STORE_ERROR}var w=this.__fieldsForWhichToFixPrototypes,x,u,q,p,m,n;for(x=0,u=w.length;x<u;++x){q=w[x];p=this[q];m={};for(n in p){if(p.hasOwnProperty(n)){m[n]=p[n]}}var o=SC.beget(t[q]);this[q]=o;for(n in m){o[n]=m[n]}}var v=this.get("nestedStores"),s;if(v){for(x=0,u=v.length;x<u;++x){s=v[x];s._fixUpProtypeChainsAfterParentReset()}}},__fieldsForWhichToFixPrototypes:["dataHashes","revisions","statuses"]});sc_require("system/nested_store");sc_require("mixins/merge_support");CW.ManagedNestedStore=CW.NestedStore.extend(CW.MergeSupport,{storageManager:null,extendedLogging:YES,lockOnRead:NO,commitChanges:function(A,x){var t=this.get("parentStore"),v=this.get("extendedLogging"),s,B,q,u,z,p,w,y;if(!t){CW.fatalError("A managed nested store must have a parent store",{managedNestedStore:this})}if(t.get("parentStore")){CW.fatalError("A managed nested stores parent store must be a root-level store",{managedNestedStore:this})}if(x){s=x.get("storeKeys");if(!s){s=SC.CoreSet.create();B=this.chainedChanges;if(B){s.addEach(B)}}q=this.commitAgents;if(!q){q=this.commitAgents={}}s.forEach(function(a){var b=q[a];if(!b){b=q[a]=[];b.push(x)}})}u=YES;z=CW.StorageCycle.COMMIT_CYCLE;p=this._getStorageManager();if(p.get("currentCycle")){if(v){SC.debug("%@:  The storage manager says theres an ongoing cycle, so we'll enqueue this commit request",this)}var o=p.pendingCycleOfType(z);if(o){if(v){SC.debug("%@:  but there is already a commit cycle pending, so I dont need to schedule another one.",this)}if(A){y=o.get("params");if(!y){y={force:YES};o.set("params",y)}else{y.force=YES;o.notifyPropertyChange("params")}}u=NO}}if(u){w=CW.StorageCycle.createCycle(z,p);if(A){w.set("params",{force:YES})}p.scheduleCycle(w)}return this},commitChangesFromNestedStore:function(d,e,f){arguments.callee.base.apply(this,arguments);if(this.get("extendedLogging")){SC.debug("%@:  Store keys were committed to the managed store:  %@",this,e)}return this.commitChanges(f)},init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("delegate");if(b&&SC.typeOf(b)===SC.T_CLASS){this.set("delegate",b.create())}},_getStorageManager:function(){var b=this.get("storageManager");if(!b){CW.fatalError("Managed nested store has no storage manager defined",{target:this})}return b}});CW.StorageCycle=SC.Object.extend({extendedLogging:YES,type:null,storageManager:null,params:null,currentStageIndex:null,currentStage:function(){var b=this.constructor.stages[this.get("currentStageIndex")];if(!b){b="beginning"}return b}.property("currentStageIndex").cacheable(),getManagedStore:function(){return this.getPath("storageManager.managedStore")},getMainStore:function(){return this.getPath("storageManager.mainStore")},actions:null,addNewAction:function(g,f,h,k){var j=CW.StorageCycleAction.create({name:g,type:f,storageOperation:h});if(k){j.addStoreKeys(k)}this.addAction(j);return j},addAction:function(e){var d=this.get("actions");if(!d){d=[e];this.set("actions",d)}else{d.pushObject(e)}},actionsForStoreKey:function(m){var k=this.get("actions"),h=null,o,j,l,n;if(k){for(o=0,j=k.length;o<j;++o){l=k[o];n=l.get("storeKeys");if(n){if(n.indexOf(m)!==-1){if(!h){h=[l]}else{h.push(l)}}}}}return h},actionsForStoreKeyAndStorageOperation:function(n,k){var l=this.actionsForStoreKey(n),h=null;if(l){var o,j,m;for(o=0,j=l.length;o<j;++o){m=l[o];if(m.get("storageOperation")===k){if(!h){h=[m]}else{h.push(m)}}}}return h},lastActionForStoreKeyAndStorageOperation:function(e,f){var d=this.actionsForStoreKeyAndStorageOperation(e,f);if(d){return d[d.length-1]}else{return null}},dataChangeFunctions:null,scheduleDataChange:function(k){var f=this.get("currentStage"),g=this.constructor,h=g.DATA_CHANGE_STAGE,j;if(f===h){k.call()}else{if(g.scheduleOrderForStage(f)>g.scheduleOrderForStage(h)){CW.fatalError("You cannot schedule a data change after the data change stage has already passed")}else{j=this.get("dataChangeFunctions");if(!j){j=[k];this.set("dataChangeFunctions",j)}else{j.pushObject(k)}}}},"data change":function(){var g=this.get("dataChangeFunctions"),e,f,h;if(g){for(e=0,f=g.length;e<f;++e){h=g[e];h.call()}}},_hasEnded:NO,begin:function(){this.advanceToNextStage()},end:function(){if(this.get("_hasEnded")){return}this.set("_hasEnded",YES);this.invokeLater(this._end)},_end:function(){var b=this.get("storageManager");if(!b){throw new "A storage manager must be defined"}b.cycleDidEnd(this)},advanceToNextStage:function(){if(this.get("_hasEnded")){return}var f=CW.StorageCycle,g=this.constructor.stages,e=this.get("currentStageIndex"),h;if(SC.none(e)){h=0}else{h=e+1}if(h>=g.length){this.end()}else{if(this.get("extendedLogging")){SC.debug("Transitioning ongoing %@ cycle from '%@' to '%@' stage",this.get("type"),this.get("currentStage"),g[h])}this.set("currentStageIndex",h);this.currentStageDidChange()}},stageWillBegin:function(b){},init:function(){arguments.callee.base.apply(this,arguments);if(!this.get("type")){CW.fatalError("Every cycle must have a 'type' specified.",{target:this})}},currentStageDidChange:function(){if(this.get("_hasEnded")){return}var o=CW.StorageCycle,n=this.get("currentStage"),p=this.get("extendedLogging"),u,m,t,l,q,v,s;if(!n){CW.fatalError("There is no stage defined",{target:this,currentStageIndex:this.get("currentStageIndex")})}u=this[n];if(!u){CW.fatalError("There is no method defined for the current stage",{target:this,stage:n})}this.stageWillBegin(n);if(u){u.call(this,this.get("params"))}m=CW.RequestManagement.sharedInstance();t=m.pendingRequestsForCycle(this);l=m.outstandingResponsesForCycle(this);q=t?t.length:0;v=l?l.length:0;s=q+v;if(s===0){if(p){SC.debug("We can automatically advance from the '%@' stage to the next stage",n)}this.advanceToNextStage()}else{if(p){if(s===1){SC.debug("We cannot advance from the '%@' stage to the next stage yet, because there is 1 pending/outstanding request",n)}else{SC.debug("We cannot advance from the '%@' stage to the next stage yet, because there are %@ pending/outstanding requests",n,s)}}}},toString:function(){var e=arguments.callee.base.apply(this,arguments),d=this.get("type");if(d){e=d+" cycle ("+e+")"}return e}});CW.StorageCycle.mixin({stages:null,priority:50,isPreemptible:NO,shouldBeCoalesced:NO,shouldLogLifetime:NO,createCycle:function(g){if(!g){CW.fatalError("createCycle():  You must specify a cycle type")}var h=this._typeToClassMapping,e=CW.StorageCycle,f;if(h){f=h[g]}if(!f){CW.fatalError("There is no registered storage cycle class for the specified type",{type:g})}return f.create()},registerClassForCycleType:function(f,e){if(!f){CW.fatalError("registerClassForCycleType():  You must specify a cycle type")}if(!e){CW.fatalError("registerClassForCycleType():  You must specify a storage cycle subclass",{type:f})}if(!e.isClass){CW.fatalError("registerClassForCycleType():  The specified storage cycle subclass is not a class",{type:f,klass:e})}var d=this._typeToClassMapping;if(!d){d=this._typeToClassMapping={}}d[f]=e},scheduleOrderForStage:function(d){if(!d){CW.fatalError("scheduleOrderForStage():  You must specify a stage")}var f=this.stages,e=f.indexOf(d);if(e===-1){CW.fatalError("scheduleOrderForStage():  Invalid stage specified",{stage:d})}return e},COMMIT_CYCLE:"commit",READ_CYCLE:"read",IDLE_CYCLE:"idle",DATA_CHANGE_STAGE:"data change",_typeToClassMapping:null});sc_require("system/storage_cycles/storage_cycle");CW.CommitCycle=CW.StorageCycle.extend({extendedLogging:YES,type:CW.StorageCycle.COMMIT_CYCLE,changelog:null,dataHashesCheckpointBeforeCycle:null,statusesCheckpointBeforeCycle:null,dataHashesCheckpointBeforeCycleStage:null,statusesCheckpointBeforeCycleStage:null,determineChangelog:function(p){var t=SC.Set.create(),u=p.changelog,A={},s={},o={},y=NO,q=this,x=this.get("extendedLogging");if(u){u.forEach(function(b){if(A[b]){return}var k=p.materializeRecord(b),j;if(!k){CW.fatalError("Could not determine data dependencies because there was an error materializing a record",{store:p,storeKey:b})}if(x){SC.debug("Looking at ancestors of storeKey %@:  %@",b,k.shortString())}var h=NO,D,l,f,e;l=D=k;while((l=l.get("owner"))&&!h){if(x){SC.debug("  >  ancestor:  %@",l.shortString())}f=l.storeKey;if(D.get("isAggregate")){if(!u.contains(f)){CW.fatalError("The ancestor is the aggregate of the child record, but is not in the changelog along with the child",{ancestor:l,child:D})}if(x){SC.debug("  >  ancestor %@ is the aggregate of the child %@, so theres no need to consider the child when scheduling",l.shortString(),D.shortString())}o[b]=l;break}if(u.contains(f)&&!A[f]){e=q._operationOrder(l);if(x){SC.debug("  >  Ordering between child %@ and ancestor %@:  %@",k.shortString(),l.shortString(),e)}if(e===-1){if(x){SC.debug("  >  We must handle ancestor %@ before child %@",l.shortString(),D.shortString())}A[b]=YES;h=YES;break}else{if(e===0){}else{if(e===1){if(x){SC.debug("  >  We must handle child %@ before ancestor %@",D.shortString(),l.shortString())}A[f]=YES}else{CW.fatalError("Unexpected ordering for ancestor and child",{ordering:e,storeKey:b,ancestorStoreKey:f})}}}}D=l}if(!h){var d=k.get("rootOwner"),g=YES,n=NO;if(d){n=(d===k);if(n){if(y){if(x){SC.debug("We cannot include %@ in the current commit cycle because a different root ancestor is already being included",k.shortString())}g=NO}}if(g){var a=d.get("id"),m=o[b];if(!m&&s[a]){if(x){SC.debug("We cannot include %@ in the current commit cycle because a different record from the same root ancestor is already being included (%@)",k.shortString(),s[a].shortString())}g=NO}}}if(g){if(n){y=YES}if(x){SC.debug("We can include %@ in the current commit cycle",k.shortString())}if(!m){s[a]=k}t.add(b)}}else{if(x){SC.debug("We cannot include %@ in the current commit cycle because an ancestor must be handled first",k.shortString())}}})}if(x){var v=t.get("length"),B=(v===1)?"record is":"records are",w;SC.debug("%@ %@ being included in this commit cycle:",v,B);t.forEach(function(b){var a="",d=o[b];if(d){a="  [sent as part of parent %@]".fmt(d.shortString())}w=p.materializeRecord(b);SC.debug("  *  %@%@",w.shortString(),a)});var z=SC.Set.create();u.forEach(function(a){if(!t.contains(a)){z.add(a)}});v=z.get("length");if(v>0){B=(v===1)?"record":"records";SC.debug("%@ %@ will have to wait for a later commit cycle:",v,B);z.forEach(function(a){w=p.materializeRecord(a);SC.debug("  *  %@",w.shortString())})}}return t},_operationOrder:function(d){var e=SC.Record,f=d.get("status");switch(f){case e.READY_NEW:return -1;case e.DESTROYED_DIRTY:return 1;default:return 0}},prepareDataCheckpointForCycle:function(){var d,e;d=this.dataHashesCheckpointBeforeCycle={};e=this.statusesCheckpointBeforeCycle={};this._saveDataCheckpoint(d,e)},prepareDataCheckpointForCycleStage:function(){var d,e;d=this.dataHashesCheckpointBeforeCycleStage={};e=this.statusesCheckpointBeforeCycleStage={};this._saveDataCheckpoint(d,e)},resetCheckpointData:function(){this.dataHashesCheckpointBeforeCycle=null;this.statusesCheckpointBeforeCycle=null;this.dataHashesCheckpointBeforeCycleStage=null;this.statusesCheckpointBeforeCycleStage=null},_saveDataCheckpoint:function(g,h){var e=this.get("changelog"),f=this.getMainStore();if(e){e.forEach(function(b){var d=f.readDataHash(b),p,a,n,q,o,s;g[b]=SC.clone(d,YES);h[b]=f.peekStatus(b);p=f.materializeRecord(b);a=p.get("aggregates");if(a){for(n=0,q=a.length;n<q;++n){o=a[n];s=o.storeKey;d=f.readDataHash(s);g[s]=SC.clone(d,YES);h[s]=f.peekStatus(s)}}})}},removeFromStoreChangelog:function(k){var f=this.get("currentStage"),g=CW.StorageCycle;if(g.scheduleOrderForStage(f)>=g.scheduleOrderForStage(CW.CommitCycle.COMMIT_STAGE)){CW.fatalError("You must call removeFromStoreChangelog() before the commit cycles commit stage")}var h=this.getMainStore(),j=h.changelog;if(j){j.remove(k)}},restoreDataToPreCycleCheckpoint:function(g){if(!g){CW.fatalError("You must specify a storeKey")}var h=this.get("changelog"),k,l,m,j;if(!h){CW.fatalError("restoreDataToPreCycleCheckpoint():  There is no changelog defined, so we cannot restore the previous data",{storeKey:g})}if(!h.contains(g)){CW.fatalError("restoreDataToPreCycleCheckpoint():  The changelog does not include the specified storeKey, so we cannot restore the previous data for it",{storeKey:g})}k=this.getMainStore();l=this.get("dataHashesCheckpointBeforeCycle");m=l[g];j=k.recordTypeFor(g);SC.info("Restoring previous data for storeKey %@, which is a record of type %@, as it was at the beginning of this commit cycle",g,j.typeString);if(m){m=SC.clone(m)}k.writeDataHash(g,m);k.dataHashDidChange(g)},begin:function(){var p=this.get("storageManager"),n=p.get("managedStore"),m=n.get("parentStore"),w=this.get("params"),s=w?w.force:NO,u=CW.StorageCycle,v=this.get("extendedLogging"),q,x,t,o;if(v){SC.debug("%@:  Committing data from managed store (%@) down to main store (%@)",this,n,m)}q=n.changelog;if(q){x=this.determineChangelog(n);if(x.get("length")!==q.get("length")){t=u.COMMIT_CYCLE;o=p.pendingCycleOfType(t);if(!o){o=u.createCycle(t,p);p.scheduleCycle(o)}}this.set("changelog",x);this.prepareDataCheckpointForCycle();this.prepareDataCheckpointForCycleStage();CW.NestedStore.prototype.commitChanges.call(n,s,undefined,x)}else{if(n.get("hasChanges")){SC.debug("Simply resetting the managed store because there are 'chainedChanges' but nothing in the changelog.");n.reset()}}arguments.callee.base.apply(this,arguments)},stageWillBegin:function(e){arguments.callee.base.apply(this,arguments);var d=this.getMainStore();d.flush();this.prepareDataCheckpointForCycleStage()},"commit data":function(u){var l=this.getMainStore(),p=this.get("changelog"),o=p?p.get("length"):0,n;if(o>0){var v=SC.Record.ERROR,s,m,t,q;for(s=0;s<o;++s){m=p[s];t=l.peekStatus(m);if(t===v){q=l.materializeRecord(m);CW.fatalError("Trying to call commitRecords on a record that has status ERROR",{recordType:q.get("shortTypeString"),storeKey:m})}}n=l.commitRecords(null,null,p);if(n===NO){SC.debug("No records were committed to the main store.  This usually means that something was in the changelog but was marked as clean.")}}},"data change":function(){arguments.callee.base.apply(this,arguments);var b=this.getPath("storageManager.errorController");if(b){b.addActions(this.get("actions"))}},end:function(){var f=this.getMainStore(),d=f.commitAgents,e;if(d){e=this.get("changelog");if(e){e.forEach(function(a){delete d[a]})}}this.resetCheckpointData();arguments.callee.base.apply(this,arguments)}});CW.CommitCycle.mixin({stages:["commit data",CW.StorageCycle.DATA_CHANGE_STAGE],priority:2,shouldBeCoalesced:YES,COMMIT_STAGE:"commit data"});CW.StorageCycle.registerClassForCycleType(CW.StorageCycle.COMMIT_CYCLE,CW.CommitCycle);sc_require("system/storage_cycles/storage_cycle");CW.IdleCycle=CW.StorageCycle.extend({type:CW.StorageCycle.IDLE_CYCLE,"issue request":function(b){CW.fatalError("idle cycle 'issue request' stage:  You must implement this method")}});CW.IdleCycle.mixin({stages:["issue request",CW.StorageCycle.DATA_CHANGE_STAGE],priority:1,shouldBeCoalesced:YES,isPreemptible:YES});CW.StorageCycle.registerClassForCycleType(CW.StorageCycle.IDLE_CYCLE,CW.IdleCycle);sc_require("system/storage_cycles/storage_cycle");CW.ReadCycle=CW.StorageCycle.extend({type:CW.StorageCycle.READ_CYCLE,requests:null,addRequest:function(e){if(!e){CW.fatalError("addRequest():  You must specify a request")}var d=this.get("requests");this.propertyWillChange("requests");d.push(e);this.propertyDidChange("requests")},removeRequest:function(d){if(!d){CW.fatalError("removeRequest():  You must specify a request")}var f=this.get("requests"),e=f.indexOf(d);if(e!==-1){f.removeAt(e,1)}},"issue requests":function(j){var h=this.get("requests"),f,g,k;for(f=0,g=h.length;f<g;++f){k=h[f];k.set("cycle",this);k.send()}},init:function(){arguments.callee.base.apply(this,arguments);this.set("requests",[])}});CW.ReadCycle.mixin({stages:["issue requests",CW.StorageCycle.DATA_CHANGE_STAGE],priority:10,shouldBeCoalesced:NO});CW.StorageCycle.registerClassForCycleType(CW.StorageCycle.READ_CYCLE,CW.ReadCycle);CW.StorageCycleAction=SC.Object.extend({name:null,type:null,storageOperation:null,status:null,storeKeys:null,responses:null,params:null,error:null,errorHandled:null,addStoreKeys:function(e){var d=this.get("storeKeys");if(!d){d=[];this.set("storeKeys",d)}if(SC.typeOf(e)===SC.T_ARRAY){d=d.concat(e);this.set("storeKeys",d)}else{d.push(e);d.enumerableContentDidChange()}},getSingleStoreKey:function(){var b=this.get("storeKeys");if(b&&b.length===1){return b[0]}else{return null}},addResponse:function(e){var d=this.get("responses");if(!d){d=[e];this.set("responses",d)}else{d.pushObject(e)}},setParam:function(e,d){var f=this.get("params");if(!f){f={};this.set("params",f)}f[e]=d},paramValueForKey:function(e,d){var f=this.get("params");return f?f[e]:undefined},init:function(){if(!this.get("storageOperation")){CW.fatalError("A storage cycle action must have a storage operation")}if(!this.get("status")){this.set("status",CW.StorageCycleAction.STATUS_ONGOING)}},toString:function(){var o="",l=arguments.callee.base.apply(this,arguments),q=["name","type","storageOperation","status","storeKeys","params","responses","error","errorHandled"],t,p,m,u,s,v,n;for(t=0,p=q.length;t<p;++t){m=q[t];if(m){if(m==="params"){n=[];u=this.get("params");for(s in u){n.push(s+"="+u[s])}n="{"+n.join(", ")+"}";o+=m+"="+n}else{o+=m+"='%@'".fmt(this.get(m))}}if(t!==(p-1)){o+=",  "}}o+="  ("+l+")";return o}});CW.StorageCycleAction.mixin({TYPE_CREATE:"CREATE",TYPE_UPDATE:"UPDATE",TYPE_DESTROY:"DESTROY",STORAGE_OPERATION_CREATE:"CREATE",STORAGE_OPERATION_UPDATE:"UPDATE",STORAGE_OPERATION_DESTROY:"DESTROY",STORAGE_OPERATION_RETRIEVE:"RETRIEVE",STORAGE_OPERATION_FETCH:"FETCH",STATUS_ONGOING:"ongoing",STATUS_SUCCESS:"success",STATUS_ERROR:"error",ERROR_CONFLICT:"CONFLICT",ERROR_NOT_FOUND:"NOT_FOUND",ERROR_NOT_ALLOWED:"NOT_ALLOWED",ERROR_EXCEPTION:"EXCEPTION",ERROR_NOT_AUTHORIZED:"NOT_AUTHORIZED",ERROR_QUOTA_EXCEEDED:"QUOTA_EXCEEDED"});CW.StorageManager=SC.Object.extend({extendedLogging:YES,name:null,managedStore:null,mainStore:function(){return this.getPath("managedStore.parentStore")}.property("managedStore").cacheable(),currentCycle:null,pendingCycles:null,cyclesAreSuspended:function(){return(this._suspendCount>0)}.property(),hasOutstandingCommitCycle:function(){var d=this.get("currentCycle"),e=CW.StorageCycle,f;if(d&&(d.get("type")===e.COMMIT_CYCLE)){return YES}f=this.pendingCycleOfType(e.COMMIT_CYCLE);return(f?YES:NO)}.property("currentCycle","*pendingCycles.[]").cacheable(),scheduleCycle:function(J){if(!J){CW.fatalError("scheduleCycle():  You must specify a cycle")}var G=J.get("storageManager"),L=this.get("currentCycle"),D=(this._suspendCount>0),P=YES,K=J.get("type"),A=J.constructor,E=A.priority,w,y,F,M,N,I,O,C,B,x,H,z;if(G){if(G===this){CW.fatalError("scheduleCycle():  The specified cycle is already registered with this storage manager",{cycle:J,target:this})}else{CW.fatalError("scheduleCycle():  The specified cycle is already registered with a different storage manager",{cycle:J,target:this,storageManager:G})}}J.set("storageManager",this);if(!L&&!D){this.beginCycle(J);P=NO;w=YES}else{if(D){SC.debug("Enqueuing new %@ cycle because cycles are suspended",K)}else{if(L){y=L.constructor;F=y.isPreemptible;if(F){M=y.priority;if(E>M){SC.debug("Canceling current %@ cycle because a new %@ cycle has been scheduled",L.get("type"),K);N=YES}else{SC.debug("Enqueuing new %@ cycle because there is a %@ cycle in progress",K,L.get("type"))}}}}}if(P){I=A.shouldBeCoalesced;O=this.get("pendingCycles");B=O.length;x=0;for(C=B-1;C>=0;--C){H=O[C];if(I&&(K===H.get("type"))){SC.debug("Ignoring registration of %@ cycle because we already have a pending %@ cycle in the queue",K,K);x=-1;break}z=H.constructor.priority;if(z<=E){x=C+1;break}}if(x>=0){O.insertAt(x,J);w=YES}else{w=NO}}if(N){this.cancelCycle(L)}return w},pendingCycleOfType:function(l){var g=CW.StorageCycle,k=this.get("pendingCycles"),m,h,j;for(m=0,h=k.length;m<h;++m){j=k[m];if(j.get("type")===l){return j}}return null},beginCycle:function(e){var f=this.get("currentCycle"),g,h;if(f){CW.fatalError("beginCycle():  Cannot begin a new cycle because there is already a cycle in progress.",{target:this,currentCycle:f,newCycle:e})}else{h=e.constructor.shouldLogLifetime;g=this.get("pendingCycles");if(!g||g.length===0){if(h){SC.Logger.debugGroup("Beginning %@  (no pending cycles)",e)}}else{if(h){SC.Logger.debugGroup("Beginning %@  (pending cycles:  %@)",e,g)}}this.set("currentCycle",e);e.begin()}},cancelCycle:function(x){var v=this.get("currentCycle"),t,o,A,p,w,u,y,z,B,q,s;if(v===x){SC.debug("Canceling current %@ and associated pending/outstanding requests",v);t=SC.Request.manager;o=CW.RequestManagement.sharedInstance();A=o.pendingRequestsForCycle(x);p=o.outstandingResponsesForCycle(x);if(A){for(w=0,u=A.length;w<u;++w){y=A[w];SC.debug("  >  canceling pending request %@",y);y.set("isCancelled",YES);o.removePendingRequest(y)}}if(p){for(w=0,u=p.length;w<u;++w){z=p[w];SC.debug("  >  canceling outstanding request %@",z);t.cancel(z);o.removeOutstandingResponse(z)}}window.status=" ";x.end()}else{B=this.get("pendingCycles");for(w=0,u=B.length;w<u;++w){q=B[w];if(q===x){SC.debug("Canceling pending %@ cycle",x.get("type"));B.removeAt(w,1);s=YES;break}}if(!s){CW.fatalError("cancelCycle():  Requested to cancel a cycle that is neither in progress nor in the pending queue",{target:this,cycle:x})}}},suspendCycles:function(){var b=(this._suspendCount>0);++this._suspendCount;if(!b){this.notifyPropertyChange("cyclesAreSuspended");SC.debug("%@:  Cycles are suspended",this)}},resumeCycles:function(){var b=this._suspendCount;--b;if(b<0){SC.warn("CW.StorageManager#resumeCycles was called without a paired suspendCycles invocation; ignoring");this._suspendCount=0}else{this._suspendCount=b;if(b===0){this.notifyPropertyChange("cyclesAreSuspended");SC.debug("%@:  Cycles have been resumed",this);this._beginFirstPendingCycle()}}},init:function(){arguments.callee.base.apply(this,arguments);this.set("pendingCycles",[]);var d=this.get("managedStore"),f;if(!d){CW.fatalError("You must specify a managed store for the storage manager",{target:this})}f=this.get("mainStore");if(!f){CW.fatalError("The storage manager cannot determine the main store",{target:this,managedStore:d})}if(d.get("storageManager")){CW.fatalError("The managed store is already registered to a different storage manager",{target:this,managedStore:d})}if(f.get("storageManager")){CW.fatalError("The main store is already registered to a different storage manager",{target:this,mainStore:f})}d.set("storageManager",this);f.set("storageManager",this);var e=CW.RequestManagement.sharedInstance();e.addObserver("pendingRequests.[]",this,this.outstandingRequestsDidChange);e.addObserver("outstandingResponses.[]",this,this.outstandingRequestsDidChange)},cycleDidEnd:function(d){var e=this.get("currentCycle");if(!e){CW.fatalError("cycleDidEnd() was invoked but there is no current cycle",{target:this,cycle:d})}if(e!==d){CW.fatalError("cycleDidEnd() was invoked on a cycle that is not the current cycle",{target:this,cycle:d,currentCycle:e})}this.set("currentCycle",null);SC.Logger.debugGroupEnd();if(!this._suspendCount){this._beginFirstPendingCycle()}},outstandingRequestsDidChange:function(){var t=this._previousNumberOfPendingOrOutstandingRequests,x=this.get("currentCycle"),p=CW.RequestManagement.sharedInstance(),B=p.get("pendingRequests"),q=p.get("outstandingResponses"),z=this.get("extendedLogging"),D,C,w,s,v,u,y,A;if(x){D=p.pendingRequestsForCycle(x);C=p.outstandingResponsesForCycle(x);w=D?D.length:0;w+=C?C.length:0;if((t!==undefined)&&(t!==w)){if(w===0){if(x.constructor.shouldLogLifetime){SC.debug("%@:  There are no more pending/outstanding requests",x)}}else{s=p.numberOfPendingOrOutstandingReadsForCycle(x);if(w===1){u=(s>0)?"read":"write";if(x.constructor.shouldLogLifetime){SC.debug("%@:  There is 1 pending/outstanding request  (a %@)",x,u)}}else{v=p.numberOfPendingOrOutstandingWritesForCycle(x);SC.debug("%@:  There are %@ pending/outstanding requests (%@ read, %@ write)",x,w,s,v)}if(z){SC.debug("Outstanding responses:");for(y=0;y<w;++y){A=C[y];SC.debug("  [%@]  %@",y,A)}}}if(w===0){if(x.get("_hasEnded")){CW.fatalError("The number of pending/outstanding requests for the current storage cycle unexpectedly changed to 0 after it ended",{target:this,currentCycle:x,previousNumber:t})}if(z){SC.debug("Advancing to next stage (%@+1) because there are no outstanding requests",x.get("currentStage"))}x.invokeLast(function(){x.advanceToNextStage()})}}}this._previousNumberOfPendingOrOutstandingRequests=w},_beginFirstPendingCycle:function(){var e=this.get("pendingCycles"),d,f;if(e){d=e.length;if(d>0){f=e.shift();this.beginCycle(f);this.get("pendingCycles").enumerableContentDidChange()}}},toString:function(){var d=arguments.callee.base.apply(this,arguments),e=this.get("name");if(e){d=e+" ("+d+")"}return d},_suspendCount:0});sc_require("mixins/store_common");CW.Store=SC.Store.extend(CW.StoreCommon,SC.DelegateSupport,{isCoreWebStore:YES,readEditableDataHash:function(b){this._savePreviousDataHashForNotify(b);return arguments.callee.base.apply(this,arguments)},writeDataHash:function(d,f,e){if(f){this._savePreviousDataHashForNotify(d)}return arguments.callee.base.apply(this,arguments)},placeHolderRecord:function(h,j,f){var k=h.storeKeyFor(j),g;g=this.materializeRecord(k);if(k){this.writeDataHash(k,(f?f:{}));this.writeStatus(k,SC.Record.READY_CLEAN);g.allPropertiesDidChange()}return g},pushRetrieve:function(F,I,A,u,v){var x=SC.Record,D;if(u===undefined){u=F.storeKeyFor(I)}D=this.readStatus(u);if(D==x.EMPTY||D==x.ERROR||D==x.READY_CLEAN||D==x.DESTROYED_CLEAN){D=x.READY_CLEAN;if(A===undefined){this.writeStatus(u,x.EMPTY);this.dataHashDidChange(u)}else{var t=this.getCurrentCommitCycle(),B=t?t.get("changelog"):null;if(B&&B.contains(u)){var E=SC.clone(this.readDataHash(u),YES),w=t.dataHashesCheckpointBeforeCycleStage[u],H=this.mergeHashesAsPossible;if(E&&w&&H){SC.debug("pushRetrieve():  Merging newly-loaded data for storeKey %@ into main store",u);var C=H.call(this,A,E,w,F.propertyMergeGroups,YES,"server-retrieved data",this.get("name"));var G=C.changedKeys.concat(C.addedKeys,C.removedKeys),J=C.mergeConflictKeys;if(G.length||J.length){this.writeDataHash(u,E,D);this.dataHashDidChange(u)}if(J.length>0){var y=this.get("delegate"),z=NO;if(y){z=this.invokeDelegateMethod(y,"mergeConflictDuringNotify",this,null,u,G,J)}}}else{this.writeDataHash(u,A,D);this.dataHashDidChange(u)}}else{this.writeDataHash(u,A,D);this.dataHashDidChange(u)}}return u}return NO},_savePreviousDataHashForNotify:function(a,d){},reset:function(){this.previousDataHashesForNotify={};this.commitAgents=null;return arguments.callee.base.apply(this,arguments)},commitChangesFromNestedStore:function(P,z,T){var C=P.commitAgents,E,R,D,O,N,M,G,A;if(C){E=this.commitAgents;if(!E){E=this.commitAgents={}}for(R in C){R=parseInt(R,10);if(z.contains(R)){D=E[R];O=C[R];if(D){D=D.concat(O)}else{E[R]=O}}}}this._mergedProperties={};this._mergedDataHashes={};if(!T){this._verifyLockRevisions(z,P.locks,P)}N=this._mergedProperties||{};M=this._mergedDataHashes||{};var H=z.length,J,U,L,S,V,I,F,Q;V=this.revisions;U=this.dataHashes;L=this.statuses;S=this.editables;if(!S){S=this.editables=[]}I=P.dataHashes;Q=P.revisions;F=P.statuses;for(J=0;J<H;J++){R=z[J];L[R]=F[R];V[R]=Q[R];S[R]=0;G=N[R];if(G){A=G.length;if(A===0){this._notifyRecordPropertyChange(R,YES);this.notifyCommitAgents(R,"commitWasUnnecessaryAtStore")}else{if(this._savePreviousDataHashForCommit){this._savePreviousDataHashForCommit(R)}U[R]=M[R];this._notifyRecordPropertyChange(R,NO);this.notifyCommitAgents(R,"recordWasCommittedToStore",this)}}else{if(this._savePreviousDataHashForCommit){this._savePreviousDataHashForCommit(R)}U[R]=I[R];this._notifyRecordPropertyChange(R,NO);this.notifyCommitAgents(R,"recordWasCommittedToStore",this)}}var K=this.changelog,B=P.changelog;if(B){if(!K){K=this.changelog=SC.CoreSet.create()}K.addEach(B)}this.changelog=K;if(!this.get("parentStore")){this.flush()}return this}});SC.stringsFor("en-us",{monthHeading:"%@1 %@2",year:"%@",January:"January",February:"February",March:"March",April:"April",May:"May",June:"June",July:"July",August:"August",September:"September",October:"October",November:"November",December:"December",Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday",Sun:"Sun",Mon:"Mon",Tue:"Tue",Wed:"Wed",Thu:"Thu",Fri:"Fri",Sat:"Sat",Yesterday:"Yesterday",Today:"Today",Tomorrow:"Tomorrow",Midnight:"Midnight",Now:"Now",Noon:"Noon",Next:"Next",Last:"Last",English:"English",French:"French",German:"German",Japanese:"Japanese","Button.OK":"OK","Button.Cancel":"Cancel","Button.Reload":"Reload","Button.Save":"Save","Button.Accept":"Accept","Button.Decline":"Decline","Button.Maybe":"Maybe","Button.TryAgain":"Try Again","Status.Loading":"Loading","Status.Sharing":"Sharing","Toolbar.Message.Actions":"Actions","Dialog.Error.Details":"Details","Color.Picker.Custom.Color":"Custom color","CW.DropTarget.SafariWindowsNotSupported.Title":"Drag and drop not supported.","CW.DropTarget.SafariWindowsNotSupported.Description":"Drag and drop of files into this browser is not currently supported."});CW.ScrollerView=SC.ScrollerView.extend({hasButtons:YES,scrollbarThickness:14,capLength:16,capOverlap:10,buttonLength:37,buttonOverlap:6});SC.mixin(SC.ScrollView.prototype,{horizontalScrollerView:CW.ScrollerView,verticalScrollerView:CW.ScrollerView});sc_require("views/scroller");CW.FadingCaplessScrollerView=CW.ScrollerView.extend({hasButtons:NO,classNames:"sc-fading-capless-scroller-view".w(),capLength:0,capOverlap:-2,buttonLength:0,buttonOverlap:-2,scrollbarThickness:10,minimumThumbLength:32,isVisibleDidChange:function(){if(!this.get("isVisible")){return}this.$(".sc-scroller-view").addClass("sc-fading-capless-scroller-view-invisible")}.observes("isVisible")});CW.FadingCaplessScrollerViewSupport={_thumbHidden:NO,didCreateLayer:function(b){this.$(".sc-scroller-view").addClass("sc-fading-capless-scroller-view-invisible");this._thumbHidden=YES;b()}.enhance(),verticalOverlay:YES,horizontalOverlay:YES,mouseExited:function(){if(this._thumbHidden){return}var e=this.get("verticalScrollerView"),d=this.get("horizontalScrollerView");if((e&&!e._thumbDragging)||(d&&!d._thumbDragging)){this.$(".sc-scroller-view").addClass("sc-fading-capless-scroller-view-invisible");this._thumbHidden=YES}},mouseMoved:function(){if(!this._thumbHidden){return}if(!this._thumbView){this._thumbView=this.$(".thumb")}this.$(".sc-scroller-view").removeClass("sc-fading-capless-scroller-view-invisible");this._thumbHidden=NO}};sc_require("views/fading_capless_scroller");CW.MiniFadingCaplessScrollerView=CW.FadingCaplessScrollerView.extend({minimumThumbLength:16,classNames:"sc-mini-fading-capless-scroller-view".w()});CW.MiniFadingCaplessScrollerViewSupport=CW.FadingCaplessScrollerViewSupport;sc_require("views/mini_fading_capless_scroller");CW.Alert=SC.PanelPane.extend({message:"",messageViewPaddingBottom:10,description:null,descriptionViewPadding:{top:0,bottom:4},descriptionViewMinHeight:9,descriptionViewMaxHeight:CW.get("isMobile")?200:300,caption:null,captionViewPadding:{top:4,bottom:7},captionViewMinHeight:0,image:"me-icon-alert-68",rightButton:"OK",middleButton:null,leftButton:null,extraView:null,extraViewPadding:{top:5,bottom:3},extraViewMinHeight:0,escapeHTML:NO,layout:{centerX:0,width:CW.isMobile()?300:450,centerY:-10,height:160},classNames:"cw-alert".w(),ariaRole:"alertdialog",init:function(){arguments.callee.base.apply(this,arguments);if(this.get("extraWide")){this.adjust("width",500)}},modalPane:SC.ModalPane.extend({classNames:"cw-modal".w(),paneFadeInDuration:!SC.browser.webkit?350:function(){return 350*(innerWidth<1983&&innerHeight<1983)}.property(),paneFadeOutDuration:function(){return this.get("paneFadeInDuration")}.property(),paneOpacity:0.5,init:function(){if((SC.browser.webkit)&&(innerWidth>=1983||innerHeight>=1983)){this.classNames.push("no-gpu")}arguments.callee.base.apply(this,arguments);var e=SC.RootResponder.responder.mainPane;if(e){var d=e.layout.minWidth,f=e.layout.minHeight;if(d){this.adjust("minWidth",d)}if(f){this.adjust("minHeight",f)}}}}),contentView:SC.View.design({layout:{left:0,right:0,top:0,bottom:0},escapeHTMLBinding:"*parentView.escapeHTML",separatorView:SC.View.design({layout:{height:2,right:5,left:5,bottom:56},classNames:["separator"]}),createChildViews:function(){SC.Binding.flushPendingChanges();var B=this.get("escapeHTML"),C=this.get("pane"),F=C.get("message"),A=C.get("description"),x=C.get("caption"),D=CW.get("isMobile")?null:C.get("image"),N=C.get("extraView"),J=C.get("rightButton"),I=C.get("middleButton"),K=C.get("leftButton"),w=this.childViews,G=CW.Alert,E="Trying to create a CW.Alert with a %@ button that is neither a string, nor a button view.",H,M,y,O,z,v,L;if(D){if(SC.typeOf(D)===SC.T_STRING){this.imageView=G.ImageView.extend({value:D})}else{if(D.value&&D.width&&D.height){this.imageView=G.ImageView.extend({value:D.value,width:D.width,height:D.height})}else{CW.fatalError("Trying to create a CW.Alert with improper an invalid image hash.")}}w.push("imageView")}if(!F){CW.fatalError("Trying to create a CW.Alert without a message.")}this.messageView=G.MessageView.extend({value:F,escapeHTML:B});w.push("messageView");if(A){this.descriptionView=G.DescriptionView.extend({value:A,escapeHTML:B});w.push("descriptionView")}if(x){this.captionView=G.CaptionView.extend({value:x,escapeHTML:B});w.push("captionView")}if(N){this.extraView=N;w.push("extraView")}w.push("separatorView");if(K){if(SC.typeOf(K)===SC.T_STRING){H={title:K,action:"remove",target:C}}else{if(SC.typeOf(K)===SC.T_HASH){H=K}else{CW.fatalError(E.fmt("left"))}}this.leftButtonView=G.LeftButtonView.extend(H);w.push("leftButtonView")}if(I){if(SC.typeOf(I)===SC.T_STRING){M=I;y="remove";O=C}else{if(SC.typeOf(I)===SC.T_HASH){M=I.title?I.title:"Cancel";y=I.action?I.action:null;O=I.target?I.target:C}else{CW.fatalError(E.fmt("middle"))}}}if(!J){CW.fatalError("Trying to create a CW.Alert without a right button.")}if(SC.typeOf(J)===SC.T_STRING){z=J;v="remove";L=C}else{if(SC.typeOf(J)===SC.T_HASH){z=J.title?J.title:"OK";v=J.action?J.action:null;L=J.target?J.target:C}else{CW.fatalError(E.fmt("right"))}}this.mainButtonsView=G.MainButtonsView.extend({middleButtonIsVisible:I?YES:NO,middleButtonTitle:M,middleButtonAction:y,middleButtonTarget:O,rightButtonTitle:z,rightButtonAction:v,rightButtonTarget:L});w.push("mainButtonsView");return arguments.callee.base.apply(this,arguments)},extraViewFrameDidChange:function(){if(this._resizingExtraView){this._resizingExtraView=NO;return}this.performLayout()},didCreateLayer:function(){var f=this.get("pane");if(SC.browser.isIE8OrLower){f.$()[0].style.filter="alpha(opacity=0)"}else{f.$().css({opacity:0,"-webkit-animation-name":"none",})}var d=this.get("extraView");if(d&&d.isAutoResizingExtraView){d.addObserver("frame",this,this.extraViewFrameDidChange)}var e=this;this.invokeLater(function(){e.performLayout()},100)},performLayout:function(){var I=this.get("pane"),M=this.messageView,ag=this.descriptionView,L=I.get("descriptionViewMinHeight")||0,H=I.get("descriptionViewMaxHeight")||0,S=this.captionView,ac=I.get("captionViewMinHeight")||0,ad=this.extraView,T=I.get("extraViewMinHeight")||0,W=this.imageView,J=I.get("image"),F=M.getPath("layout.top"),ab=this.mainButtonsView,V=CW.Alert,A=V.MIN_ALERT_HEIGHT,af=null,Q,ae,K,G=0,O,E,Z,aa,X,R,N,P,Y;if(SC.browser.isIE8OrLower){I.$()[0].style.filter="alpha(opacity=100)"}else{I.$().css({opacity:1,"-webkit-animation-name":"pop",})}I.set("ariaLabelledBy",SC.guidFor(M));I.set("ariaDescribedBy",SC.guidFor(ag));Q=M.get("value");ae=M.get("layer");E=M.get("frame").width+"px";ae.style.maxWidth=E;K=SC.metricsForString(Q,ae,null,!this.get("escapeHTML")).height;M.adjust("height",K);F+=K;Y=I.get("messageViewPaddingBottom");if(Y){F+=Y}if(ag){N=I.get("descriptionViewPadding");if(N&&(P=N.top)){F+=P}ag.adjust("top",F);Q=ag.get("value");ae=ag.contentView.get("layer");ae.style.maxWidth=E;K=SC.metricsForString(Q,ae,null,!this.get("escapeHTML")).height;if(K<L){K=L}else{if(K>H){af=K;K=H}}ag.adjust("height",K);if(af){ag.contentView.adjust("height",CW.get("isMobile")?af+200:af)}F+=K;if(N&&(Y=N.bottom)){F+=Y}}else{F+=L}if(S){N=S.get("padding");if(N&&(P=N.top)){F+=P}S.adjust("top",F);Q=S.get("value");ae=S.get("layer");ae.style.maxWidth=E;K=SC.metricsForString(Q,ae,null,!this.get("escapeHTML")).height;if(K<ac){K=ac}S.adjust("height",K);F+=K;if(N&&(Y=N.bottom)){F+=Y}}else{F+=ac}if(ad){this._resizingExtraView=YES;N=I.get("extraViewPadding");if(N&&(P=N.top)){F+=P}ad.adjust("top",F);K=undefined;if(ad.isAutoResizingExtraView){K=ad.computeHeight()}if(SC.none(K)){K=ad.get("frame").height}if(SC.none(K)){CW.fatalError("Trying to create a CW.Alert with an extraView which does not have its height specified.")}if(K<T){K=T}F+=K;if(N&&(Y=N.bottom)){F+=Y}}else{F+=T}if(W&&J.width&&J.height){W.adjust("width",J.width);W.adjust("height",J.height);imageViewBottom=W.getPath("frame.bottom")}F+=V.BUTTONS_AND_SEPARATOR_HEIGHT;if(F<A){F=A}Z=ab.middleButton;aa=ab.rightButton;if(this.leftButtonView){R=this.leftButtonView.get("frame");if(R){G=R.width}}if(Z){R=Z.get("frame");if(R){G+=R.width}}if(aa){R=aa.get("frame");if(R){G+=R.width}}I.adjust("height",F);X=V.BUTTONS_REGULAR_PADDING+V.BUTTONS_MIN_PADDING_MIDDLE_AND_LEFT+(V.BUTTONS_SIDE_PADDING*2);if(G+X>I.get("frame").width){I.adjust("width",G+X)}this._resizingExtraView=NO;var U=this.$(".def");setTimeout(function(){U[0].focus()},1000)}})});CW.Alert.BUTTONS_REGULAR_PADDING=8;CW.Alert.BUTTONS_MIN_PADDING_MIDDLE_AND_LEFT=15;CW.Alert.BUTTONS_SIDE_PADDING=20;CW.Alert.BUTTONS_AND_SEPARATOR_HEIGHT=71;CW.Alert.MIN_ALERT_HEIGHT=162;CW.Alert.MessageView=SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,top:26,right:25},classNames:["title-label"],ariaRole:"heading"});CW.Alert.DescriptionView=SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,right:25},classNames:["description"],valueBinding:".parentView.parentView.value",escapeHTMLBinding:".parentView.parentView.escapeHTML",})});CW.Alert.CaptionView=SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,right:25},classNames:["caption"]});CW.Alert.ImageView=SC.ImageView.extend({layout:{left:25,top:22,width:68,height:68},classNames:["cw-alert-image-view"]});CW.Alert.MainButtonsView=SC.View.extend({layout:{height:30,bottom:11,right:16,left:16},classNames:["text-align-right"],childViews:["middleButton","rightButton"],middleButtonIsVisible:YES,middleButtonTitle:"Cancel",middleButtonAction:null,middleButtonTarget:null,rightButtonTitle:"Ok",rightButtonAction:null,rightButtonTarget:null,init:function(){arguments.callee.base.apply(this,arguments);this.middleButton.set("title",this.middleButtonTitle);this.middleButton.set("isVisible",this.middleButtonIsVisible);this.middleButton.set("action",this.middleButtonAction);this.middleButton.set("target",this.middleButtonTarget);this.rightButton.set("title",this.rightButtonTitle);this.rightButton.set("action",this.rightButtonAction);this.rightButton.set("target",this.rightButtonTarget)},middleButton:SC.ButtonView.extend({isCancel:YES,themeName:"square",useStaticLayout:YES,controlSize:SC.HUGE_CONTROL_SIZE,layout:{left:0,height:"auto",width:"auto",bottom:0}}),rightButton:SC.ButtonView.extend({isDefault:YES,themeName:"square",useStaticLayout:YES,controlSize:SC.HUGE_CONTROL_SIZE,layout:{left:0,height:"auto",width:"auto",bottom:0},render:function(b){b.attr("tabindex","0");return arguments.callee.base.apply(this,arguments)}})});CW.Alert.LeftButtonView=SC.ButtonView.extend(SC.AutoResize,{title:"Other...",themeName:"square",controlSize:SC.HUGE_CONTROL_SIZE,layout:{height:30,left:18,bottom:11,minWidth:72}});CW.Alert.ExtraViewAutoResizingSupport={isAutoResizingExtraView:YES,computeHeight:function(){var g=this.get("autoResizeLayer")||this.get("layer"),k=this.getPath("frame.width"),h=this.get("autoResizeText")||"",j=this.get("autoResizePadding")||0,f;if(SC.none(g)||SC.empty(h)){return 0}g.style.maxWidth=k+"px";f=SC.metricsForString(h,g,this.get("classNames"),!this.get("escapeHTML"));return f.height+j}};CW.Alert.show=function(d){if(SC.typeOf(d)===SC.T_HASH){var e=this.create(d);e.append();return e}CW.fatalError("Attempted to show a CW.Alert without options.");return null};CW.AlertPaneListItemView=SC.View.extend(SC.Control,SC.StaticLayout,{useStaticLayout:YES,layout:{height:45},childViews:["message","label"],message:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,layout:{top:8,height:"auto"},escapeHTML:NO,controlSize:SC.TINY_CONTROL_SIZE,classNames:["message"],valueBinding:"*owner.content.message"}),label:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,controlSize:SC.TINY_CONTROL_SIZE,classNames:["label"],layout:{top:10,height:"auto"},valueBinding:"*owner.content.label"})});sc_require("panes/list_item");CW.AlertPaneDetailView=SC.StackedView.extend({layout:{left:0,top:0,right:0,bottom:0},isSelectable:NO,classNames:"alert-pane-list".w(),exampleView:CW.AlertPaneListItemView,contentBinding:"*parentView.owner.pane.alertDetails"});sc_require("views/scroller");CW.CaplessMiniScrollerView=CW.ScrollerView.extend({hasButtons:NO,classNames:"me-capless-mini-scroller-view",capLength:0,capOverlap:0,buttonLength:0,buttonOverlap:0,scrollbarThickness:8});sc_require("panes/alert_pane_detail");sc_require("views/capless_mini_scroller");CW.BUTTON1_STATUS="button1";CW.BUTTON2_STATUS="button2";CW.BUTTON3_STATUS="button3";CW.ACTIONABLE_VIEW_ELEM_CHECKBOX="checkbox";CW.ACTIONABLE_VIEW_ELEM_ONE_TEXTFIELD="oneTextField";CW.ACTIONABLE_VIEW_ELEM_TWO_TEXTFIELDS="twoTextField";CW.DETAIL_VIEW_MAX_HEIGHT=143;CW.AlertPane=SC.PanelPane.extend({classNames:"me-alert",ariaRole:"alertdialog",themeName:"atv3",delegate:null,shouldEscapeHTML:YES,showDetails:NO,alertDetails:null,detailView:CW.AlertPaneDetailView,icon:"sc-icon-alert-48",buttonOne:SC.outlet("contentView.mainActionButtons.okButton"),buttonTwo:SC.outlet("contentView.mainActionButtons.cancelButton"),buttonThree:SC.outlet("contentView.extraActionButton.button"),buttonThreeWrapper:SC.outlet("contentView.extraActionButton"),checkbox:SC.outlet("contentView.info.checkbox"),textField:SC.outlet("contentView.info.textfield.textfieldContent"),textField1:SC.outlet("contentView.info.textfields.left.textfield1Content"),textField2:SC.outlet("contentView.info.textfields.right.textfield2Content"),layout:{top:0.3,centerX:0,width:500},isExtraButtonCancel:null,contentView:SC.View.extend({useStaticLayout:YES,layout:{left:0,right:0,top:0,height:"auto"},childViews:["info","separator","mainActionButtons","extraActionButton"],info:SC.View.extend(SC.StaticLayout,{useStaticLayout:YES,layout:{top:0,left:0,right:460,height:"auto"},classNames:["info"],render:function(f,g){var h=this.get("pane"),e=SC.BLANK_IMAGE_URL;if(g&&h.get("icon")!=="blank"){f.push('<img src="'+e+'" class="icon '+h.get("icon")+'" />')}f.addClass("show-"+h.get("icon"));arguments.callee.base.apply(this,arguments)},childViews:["title","description","detailDisclosure","detail","caption","checkbox","textfield","textfields"],title:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["title-label"],layout:{top:0,left:0,right:0,height:"auto"},tagName:"h1",valueBinding:"*owner.pane.message",escapeHTMLBinding:"*owner.pane.shouldEscapeHTML"}),description:SC.LabelView.design(SC.StaticLayout,{classNames:["description"],useStaticLayout:YES,layout:{top:0,left:0,right:0,height:"auto"},valueBinding:"*owner.pane.description",escapeHTMLBinding:"*owner.pane.shouldEscapeHTML"}),detailDisclosure:SC.DisclosureView.design(SC.StaticLayout,{useStaticLayout:YES,isEnabled:YES,value:NO,layout:{height:15},title:"Dialog.Error.Details".loc(),isVisibleBinding:"*owner.pane.showDetails"}),detail:SC.WellView.design(SC.StaticLayout,{isVisibleBinding:"*owner.detailDisclosure.value",useStaticLayout:YES,layout:{top:0,left:0,right:0,height:CW.DETAIL_VIEW_MAX_HEIGHT},contentLayout:{top:1,left:0,right:0,bottom:2},classNames:"detail".w(),contentView:SC.ScrollView.design({verticalScrollerView:CW.CaplessMiniScrollerView,verticalScrollerLayout:{top:2,right:4,bottom:2},hasHorizontalScroller:NO,hasVerticalScroller:YES,layout:{left:0,top:0,right:0,bottom:0},contentView:function(){var b=this.getPath("owner.pane.detailView");if(SC.typeOf(b)===SC.T_CLASS){b=b.create();this.setPath("owner.pane.detailView",b)}return b}.property()}),detailVisibleDidChange:function(){var e=this.parentView.parentView.parentView;if(e){var d=e.get("layout").height+(this.get("isVisible")?-1:1)*CW.DETAIL_VIEW_MAX_HEIGHT;e.adjust({height:d}).updateLayout()}}.observes("*owner.detailDisclosure.value")}),caption:SC.LabelView.extend(SC.StaticLayout,{useStaticLayout:YES,classNames:["caption"],layout:{top:0,left:0,right:0,height:"auto"},escapeHTMLBinding:"*owner.pane.shouldEscapeHTML",init:function(){var b=this.get("pane").get("caption");if(b===null||b===""){this.set("isVisible",NO)}this.set("value",b);arguments.callee.base.apply(this,arguments)}}),checkbox:SC.CheckboxView.design(SC.StaticLayout,{useStaticLayout:YES,layout:{top:0,left:-1,right:0,height:"auto"},classNames:["checkbox"],valueBinding:"*owner.pane.checkboxValue",titleBinding:"*owner.pane.checkboxTitle",isVisibleBinding:"*owner.pane.checkboxVisible"}),textfield:SC.View.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["one-textfield"],layout:{top:0,left:0,right:0,height:"auto"},isVisibleBinding:"*owner.pane.textFieldVisible",childViews:["textfieldLabel","textfieldContent"],textfieldLabel:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["me-dialog-label"],fontWeight:SC.BOLD_WEIGHT,layout:{top:0,left:0,right:0,height:15},valueBinding:"*owner.pane.textFieldLabel"}),textfieldContent:SC.TextFieldView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["textfield"],layout:{top:0,left:0,right:0,height:22},valueBinding:"*owner.pane.textFieldValue"})}),textfields:SC.View.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["two-textfield"],layout:{top:0,left:0,right:0,height:"auto"},isVisibleBinding:"*owner.pane.textFieldsVisible",childViews:["left","right"],left:SC.View.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["left-half"],layout:{top:0,height:"auto"},tagName:"span",childViews:["textfield1Label","textfield1Content"],textfield1Label:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["me-dialog-label"],fontWeight:SC.BOLD_WEIGHT,layout:{top:0,left:0,right:0,height:15},valueBinding:"*owner.pane.textField1Label"}),textfield1Content:SC.TextFieldView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["textfield"],layout:{top:0,left:0,right:0,height:22},valueBinding:"*owner.pane.textField1Value"})}),right:SC.View.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["right-half"],layout:{top:0,height:"auto"},tagName:"span",childViews:["textfield2Label","textfield2Content"],textfield2Label:SC.LabelView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["me-dialog-label"],fontWeight:SC.BOLD_WEIGHT,layout:{top:0,left:0,right:0,height:15},valueBinding:"*owner.pane.textField2Label"}),textfield2Content:SC.TextFieldView.design(SC.StaticLayout,{useStaticLayout:YES,classNames:["textfield"],layout:{top:0,left:0,right:0,height:22},isPassword:YES,valueBinding:"*owner.pane.textField2Value"})})})}),separator:SC.View.design({classNames:["separator"],layout:{bottom:51,height:2,right:15,left:15}}),mainActionButtons:SC.View.design({layout:{bottom:10,height:CW.SQUARE_BUTTON_REGULAR_HEIGHT,right:18,left:18},childViews:["cancelButton","okButton"],classNames:["text-align-right"],cancelButton:SC.ButtonView.design({useStaticLayout:YES,actionKey:SC.BUTTON2_STATUS,localize:YES,layout:{right:5,height:"auto",width:"auto",bottom:0},themeName:"square",title:"Cancel",isCancel:YES,isCancelBinding:SC.Binding.not("*parentView.owner.pane.isExtraButtonCancel"),action:"dismiss",isVisible:NO,_notifyDidAppendToDocument:function(){arguments.callee.base.apply(this,arguments);this.set("isCancel",!this.getPath("parentView.owner.pane.isExtraButtonCancel"))}}),okButton:SC.ButtonView.extend({useStaticLayout:YES,actionKey:SC.BUTTON1_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},themeName:"square",title:"OK",isDefault:YES,action:"dismiss"})}),extraActionButton:SC.View.design({layout:{bottom:10,height:CW.SQUARE_BUTTON_REGULAR_HEIGHT,left:18,width:150},isVisible:NO,childViews:["button"],button:SC.ButtonView.design({useStaticLayout:YES,actionKey:SC.BUTTON3_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},themeName:"square",title:"Extra",isCancel:NO,isCancelBinding:"*parentView.owner.pane.isExtraButtonCancel",action:"dismiss",isVisible:NO,_notifyDidAppendToDocument:function(){arguments.callee.base.apply(this,arguments);this.set("isCancel",this.getPath("parentView.owner.pane.isExtraButtonCancel"))}})})}),dismiss:function(d){var e=this.delegate;if(e&&e.alertPaneDidDismiss){e.alertPaneDidDismiss(this,d.get("actionKey"))}if(d.get("theme")!="help"){this.set("checkboxValue",this.get("checkbox").value);this.set("textFieldValue",this.get("textField").value);this.set("textField1Value",this.get("textField1").value);this.set("textField2Value",this.get("textField2").value);this.remove()}}});CW.AlertPane._normalizeArguments=function(d){d=SC.A(d);var e=d.length,f=d[e-1];if(SC.typeOf(f)!==SC.T_STRING){d[e-1]=null}else{f=null}d[11]=f;return d};CW.AlertPane.show=function(ac,aa,R,aj,ao,ae,ab,am,ai,T,A,V,L){var ak=!L?this._normalizeArguments(arguments):arguments;var N,ah,af,P,ag,Q,ad,Y;var X=YES,S=NO,Z=NO,U=NO;if(aj!==null&&aj!==CW.ACTIONABLE_VIEW_ELEM_CHECKBOX&&aj!==CW.ACTIONABLE_VIEW_ELEM_ONE_TEXTFIELD&&aj!==CW.ACTIONABLE_VIEW_ELEM_TWO_TEXTFIELDS){SC.error("Extra element must be either of the following three values: CW.ACTIONABLE_VIEW_ELEM_CHECKBOX, CW.ACTIONABLE_VIEW_ELEM_ONE_TEXTFIELD, CW.ACTIONABLE_VIEW_ELEM_TWO_TEXTFIELDS")}if(aj!==null&&ao===null){SC.error("Please provide the element details when you want the display a checkbox or text field(s) in the alert pane.")}if(ao!==null){if(aj===CW.ACTIONABLE_VIEW_ELEM_CHECKBOX){N=ao[0];ah=ao[1];S=YES}else{if(aj===CW.ACTIONABLE_VIEW_ELEM_ONE_TEXTFIELD){af=ao[0];P=ao[1];Z=YES}else{if(aj===CW.ACTIONABLE_VIEW_ELEM_TWO_TEXTFIELDS){ag=ao[0];Q=ao[1];ad=ao[2];Y=ao[3];U=YES}}}}var M={message:ak[0]||"",description:ak[1]||null,caption:ak[2]||null,checkboxVisible:S,checkboxTitle:N,checkboxValue:ah,textFieldVisible:Z,textFieldLabel:af,textFieldValue:P,textField1Label:ag,textField1Value:Q,textFieldsVisible:U,textField2Label:ad,textField2Value:Y,icon:ak[8]||"sc-icon-alert-48",showDetails:SC.none(ak[9])?NO:YES,alertDetails:!SC.kindOf(ak[9],SC.View)?ak[9]:null,shouldEscapeHTML:ak[10]!==NO?YES:NO,delegate:ak[11],isExtraButtonCancel:ak[12]||NO};if(SC.kindOf(ak[9],SC.View)){M.detailView=ak[9]}M=this.create(M);var an="buttonOne buttonTwo buttonThree".w(),ap,K,al=97;for(var W=0;W<3;W++){ap=M.get(an[W]);K=ak[W+5];if(K){ap.set("title",K).set("isVisible",YES);if(W==2){if(K=="?"){ap.set("title","").set("theme","help")}M.get("buttonThreeWrapper").set("isVisible",YES)}}}var O=M.append();SC.RunLoop.begin();O.awake();SC.RunLoop.end();if(M.get("buttonThreeWrapper").get("isVisible")){M.get("buttonThreeWrapper").adjust({width:M.get(an[2]).$().width()+16})}al+=M.get(an[0]).$().width()+M.get(an[1]).$().width()+M.get(an[2]).$().width();if(al>M.get("layout").width){M.adjust("width",al);M.updateLayout()}M.adjust("height",M.childViews[0].$().height());M.updateLayout();return O};CW.AlertPane.warn=function(l,o,n,t,p,v,u,m,q){var s=this._normalizeArguments(arguments);s[8]="me-icon-alert-68";return this.show.apply(this,s)};CW.AlertPane.info=function(l,o,n,t,p,v,u,m,q){var s=this._normalizeArguments(arguments);s[8]="me-icon-info-68";return this.show.apply(this,s)};CW.AlertPane.plain=function(o,t,q,x,u,z,y,p,A,B,s,v){var w=this._normalizeArguments(arguments);w[8]="blank";return this.show.apply(this,w)};CW.AlertPane.detail=function(p,u,s,z,v,B,A,q,C,D,t,x){var y=this._normalizeArguments(arguments),w=y[8];if(!w||(w&&!w.length)){y[8]="me-icon-info-68"}return this.show.apply(this,y)};CW.AlertPane.plainWithExtraButtonCancel=function(o,t,q,x,u,z,y,p,A,B,s,v){var w=this._normalizeArguments(arguments);w[8]="blank";w[12]=YES;return this.show.apply(this,w)};CW.COMMIT="Commit";CW.DISCARD="Discard";CW.ColorPickerPane=SC.PickerPane.extend({classNames:"sc-menu color-picker".w(),_h:0,_s:1,_v:1,POINTER_CANVAS:1,SLIDER_CANVAS:2,selectedColor:"",displayProperties:["selectedColor"],colorCanvas:"",showButtons:NO,delegate:null,layout:{width:191,height:225},colorPointer:SC.outlet("contentView.colorBoxView.colorBackgroundView.colorPointerView"),colorSlider:SC.outlet("contentView.colorBoxView.colorBackgroundView.colorSliderView"),render:function(k,h){arguments.callee.base.apply(this,arguments);if(h){if(this.showButtons){return}var j=this.get("objects"),g=this.get("selectedColor");var f=this.getPath("contentView.swatchView");j.forEach(function(a,d){if(a){var b=SC.View.create({layout:{left:(26*d),top:0,height:26,width:26},backgroundColor:a,classNames:["color-swatch-default"],render:function(l,e){if(this.get("backgroundColor")===g){l.begin("div").addClass("color-swatch-selected").end()}arguments.callee.base.apply(this,arguments)},eventManager:0,viewClicked:"",mouseDown:function(n){if(this.get("eventManager")===0){this.set("eventManager",1);this.viewClicked=n.target;var m=this.viewClicked,e=m.className;m.className=e.replace("color-swatch-default","color-swatch-pressed")}return YES},touchStart:function(e){return this.mouseDown(e)},mouseUp:function(m){var n=this.getPath("parentView.parentView.parentView");var e=this.get("eventManager");if(e===1||e===3){n.set("selectedColor",this.get("backgroundColor"));n.commitAndDismiss()}if(this.get("eventManager")>0){this.set("eventManager",0)}return YES},touchEnd:function(e){return this.mouseUp(e)},mouseEntered:function(n){if(this.get("eventManager")===2){this.set("eventManager",3);var m=this.viewClicked,e=m.className;m.className=e.replace("color-swatch-default","color-swatch-pressed")}return YES},mouseExited:function(n){if(this.get("eventManager")===1||this.get("eventManager")===3){this.set("eventManager",2);var m=this.viewClicked,e=m.className;m.className=e.replace("color-swatch-pressed","color-swatch-default")}return YES}});f.appendChild(b)}})}},init:function(){arguments.callee.base.apply(this,arguments);var m=this.get("objects"),j=this.get("selectedColor");this.set("_originalColor",j);var k=this.get("pane"),n=YES,l=this.get("contentView"),h=this.getPath("contentView.colorBoxView"),o=this.getPath("contentView.customColorLabelView");if(this.showButtons){h.set("isVisible",YES);o.set("isVisible",NO);l.generateButtons();h.adjust({top:7});k.adjust({height:217}).updateLayout()}else{m.forEach(function(a){if(a===j){n=NO;h.set("isVisible",NO);o.set("isVisible",YES);k.adjust({height:61}).updateLayout()}});if(n){h.set("isVisible",YES);o.set("isVisible",NO);k.adjust({height:215}).updateLayout()}}this.initColor(j)},contentView:SC.View.extend({layout:{left:3,right:3,top:3,bottom:3},childViews:["swatchView","customColorLabelView","colorBoxView"],swatchView:SC.View.design({layout:{top:4,left:1,width:183,height:26}}),customColorLabelView:SC.LabelView.design({tagName:"a",layout:{bottom:5,left:0,height:18,width:179},value:"Color.Picker.Custom.Color",localize:YES,fontWeight:SC.BOLD_WEIGHT,controlSize:SC.SMALL_CONTROL_SIZE,classNames:["custom-color-switcher-label"],textAlign:"center",isVisible:NO,mouseDown:function(){var d=this.get("pane");var e=this.getPath("parentView.colorBoxView");e.set("isVisible",YES);this.set("isVisible",NO);d.adjust({height:215}).updateLayout();d.positionPane();return true},touchStart:function(b){return this.mouseDown(b)}}),colorBoxView:SC.View.design({childViews:["selectedColorView","colorCanvasView","colorBackgroundView"],layout:{top:35,left:0,width:185,height:171},isVisible:YES,selectedColorView:SC.View.design({wantsAcceleratedLayer:YES,classNames:"color_selected".w(),layout:{top:0,left:7,width:166,height:24},render:function(e,f){var d=this.get("pane");e.addStyle({backgroundColor:d.get("selectedColor")})}}),colorCanvasView:SC.View.design({wantsAcceleratedLayer:YES,classNames:"color_canvas".w(),layout:{top:34,left:7,width:132,height:132},render:function(e,f){var d=this.get("pane");e.addStyle({backgroundColor:d.get("colorCanvas")})}}),colorBackgroundView:SC.View.design({wantsAcceleratedLayer:YES,layout:{top:0,left:7,width:168,height:166},classNames:"color-picker-background".w(),childViews:"colorPointerView colorSliderView".w(),colorPointerView:SC.View.design({wantsAcceleratedLayer:YES,layout:{width:11,height:11},classNames:"color-picker-pointer".w()}),colorSliderView:SC.View.design({wantsAcceleratedLayer:YES,layout:{right:-2,width:32,height:11},classNames:"color-picker-slider".w()})})}),generateButtons:function(){var d=this.get("pane");if(d.get("showButtons")){var e=SC.View.create({layout:{bottom:7,height:22,right:7,width:166},classNames:["text-align-right"],childViews:["cancelButtonView","okButtonView"],cancelButtonView:SC.ButtonView.design({useStaticLayout:YES,layout:{top:0,height:22,width:"auto",left:0},title:"Button.Cancel",localize:YES,controlSize:SC.SMALL_CONTROL_SIZE,isCancel:YES,action:"discardAndDismiss",actionKey:CW.DISCARD}),okButtonView:SC.ButtonView.design({useStaticLayout:YES,layout:{top:0,height:22,width:"auto",left:2},title:"Button.OK",localize:YES,controlSize:SC.SMALL_CONTROL_SIZE,isDefault:YES,action:"dismissPane",actionKey:CW.COMMIT})});this.appendChild(e)}return}}),mouseDown:function(b){if(this.clickedOnCustomColorSwatch(b)){this.commitAndDismiss()}else{this._canvas=this.clickPositionOnColorCanvas(b);switch(this._canvas){case this.POINTER_CANVAS:this.calculatePointerPosition();break;case this.SLIDER_CANVAS:this.calculateSliderPosition();break;default:}}return YES},touchStart:function(b){return this.mouseDown(b)},mouseUp:function(b){this._canvas=0;return YES},touchEnd:function(b){return this.mouseUp(b)},mouseDragged:function(b){this.calculateClickEventPosition(b);switch(this._canvas){case this.POINTER_CANVAS:this.calculatePointerPosition();break;case this.SLIDER_CANVAS:this.calculateSliderPosition();break;default:}return YES},modalPaneDidClick:function(e){var d=this.get("frame");if(!this.clickInside(d,e)){this.commitAndDismiss()}return YES},performKeyEquivalent:function(d,e){switch(d){case"tab":case"shift_tab":this.commitAndDismiss(d);return YES;case"escape":this.discardAndDismiss(d);return YES;case"return":this.commitAndDismiss(d);return YES;default:return NO}},clickedOnCustomColorSwatch:function(h){var o=this.getPath("contentView.colorBoxView");if(!o||!o.get("isVisible")){return NO}var m=this.get("frame"),n=m.x+11,l=m.y+(this.get("showButtons")?12:40),j=h.pageX-n,k=h.pageY-l;if(j>=0&&j<166&&k>=0&&k<24){return YES}return NO},clickPositionOnColorCanvas:function(e){this.calculateClickEventPosition(e);var f=this._x,g=this._y,h=0;if(f>=0&&f<132&&g>=0&&g<132){h=this.POINTER_CANVAS}else{if(f>=136&&f<=167&&g>=-5&&g<132){h=this.SLIDER_CANVAS}}return h},calculateClickEventPosition:function(g){if(!this._frameCache){this._frameCache=this.get("frame")}var l=this._frameCache,m=l.x+13,k=l.y+(this.get("showButtons")?46:75),h=g.pageX-m,j=g.pageY-k;this._x=h;this._y=j},calculatePointerPosition:function(){var h=this._s,e=this._v,f=this._x,g=this._y;f-=3;g-=3;f=Math.max(Math.min(f,121),0);g=Math.max(Math.min(g,121),0);this.get("colorPointer").adjust({left:f,top:g+34});this._s=f/124;this._v=(124-g)/124;if(h!=this._s||e!=this._v){this.set("selectedColor",SC.convertHsvToHex(this._h,this._s,this._v))}},calculateSliderPosition:function(){var e=this._h,d=Math.max(Math.min(this._y,131),0);this.get("colorSlider").adjust({top:d+29});this._h=d/131;if(e!=this._h){this.set("colorCanvas",SC.convertHsvToHex(this._h,1,1));this.set("selectedColor",SC.convertHsvToHex(this._h,this._s,this._v))}},dismissPane:function(d){var e=this.delegate;if(e&&e.colorPickerPaneDidDismiss){e.colorPickerPaneDidDismiss(this,d.get("actionKey"))}this.remove()},commitAndDismiss:function(d){this.remove();var e=this.delegate;if(e&&e.colorPickerPaneDidDismiss){e.colorPickerPaneDidDismiss(this,CW.COMMIT,d)}},discardAndDismiss:function(){this.remove();var b=this.delegate;if(b&&b.colorPickerPaneDidDismiss){this.set("selectedColor",this.get("_originalColor"));b.colorPickerPaneDidDismiss(this,CW.DISCARD)}},selectedColorDidChange:function(){var d=this.getPath("contentView.colorBoxView.selectedColorView");if(d){d.displayDidChange()}var e=this.delegate;if(e&&e.pointerMovedOnCustomColorCanvas){e.pointerMovedOnCustomColorCanvas(this)}}.observes("selectedColor"),colorCanvasDidChange:function(){var b=this.getPath("contentView.colorBoxView.colorCanvasView");if(b){b.displayDidChange()}}.observes("colorCanvas"),initColor:function(s){var p=SC.convertHexToHsv(s),q=p[0],h=p[1],l=p[2],t=SC.convertHsvToHex(q,1,1),m=Math.round(121*h),n=Math.round(124*(1-l)),o=Math.round(131*q);this.set("colorCanvas",t||"");this.set("_h",q||"");this.set("_s",h||"");this.set("_v",l||"");this.get("colorPointer").adjust({left:m,top:n+34});this.get("colorSlider").adjust({top:o+29})}});CW.ErrorPicker=SC.PickerPane.extend({layout:{left:0,top:0,height:15,right:0,minWidth:36},classNames:["error-picker"],errorText:"Please fill in required info",pointerOffset:[10,20,-17,19],preferType:SC.PICKER_POINTER,acceptsKeyPane:NO,acceptsFirstResponder:NO,isModal:NO,contentView:SC.LabelView.extend({layout:{width:192,bottom:0,top:0,minWidth:36},classNames:["error-picker-label"],valueBinding:"*parentView.errorText",textAlign:SC.ALIGN_CENTER,controlSize:SC.SMALL_CONTROL_SIZE,render:function(g,j){arguments.callee.base.apply(this,arguments);var l=this.get("parentView"),h=l.layout.height||26,m;var k=this.getPath("parentView.classNames").toString().replace(/,/g," ")+" "+this.get("classNames").toString().replace(/,/g," ")+" sc-small-size";m=this.getViewWidth(h,this.get("value"),k)+1;this.adjust({width:m}).updateLayout();l.adjust({width:m-46}).updateLayout();l.positionPane()},getViewWidth:function(g,f,h){var k=document.createElement("div");k.style.cssText="height: %@px; top:-10000px; left: -10000px; position: absolute; text-wrap: normal; word-wrap: break-word;".fmt(g);k.className=h;k.innerHTML=SC.RenderContext.escapeHTML(f);document.body.appendChild(k);var j=k.offsetWidth;document.body.removeChild(k);return j}}),preferMatrix:[2,3,2,2,2],render:function(e,g){var f=this.get("pointerPos");if(e.needsContent){this.renderChildViews(e,g);e.push("<div class='top-left-edge'></div>","<div class='top-edge'></div>","<div class='top-right-edge'></div>");if(f.indexOf(SC.POINTER_LAYOUT[2])!==-1){e.push('<div class="top-middle-edge" style="margin-top: '+this.get("pointerPosY")+'px"></div>')}else{if(f.indexOf(SC.POINTER_LAYOUT[3])!==-1){e.push('<div class="bottom-middle-edge" style="margin-top: '+this.get("pointerPosY")+'px"></div>')}}}else{var h=this.$(".sc-pointer");if(f===SC.POINTER_LAYOUT[2]){h.attr("class","top-middle-edge");h.attr("style","margin-top: "+this.get("pointerPosY")+"px")}else{if(f===SC.POINTER_LAYOUT[3]){h.attr("class","bottom-middle-edge");h.attr("style","margin-top: "+this.get("pointerPosY")+"px")}}}e.addClass(f)}});CW.ErrorPicker.showError=function(e,d){var f=this.create({errorText:d});f.popup(e,SC.PICKER_POINTER);return f};CW.BottomPaneView=SC.View.extend(SC.StaticLayout,{useStaticLayout:NO,childViews:["leftView","rightView"],buttonOne:SC.outlet("rightView.okButton"),buttonTwo:SC.outlet("rightView.cancelButton"),buttonThree:SC.outlet("leftView.extraButton"),leftButtonsContainerWidth:null,rightButtonsContainerWidth:null,leftViewLayout:function(){return{bottom:1,height:26,width:this.get("leftButtonsContainerWidth"),left:8}}.property("leftButtonsContainerWidth").cacheable(),rightViewLayout:function(){return{bottom:1,height:26,width:this.get("rightButtonsContainerWidth"),right:8}}.property("rightButtonsContainerWidth").cacheable(),delegate:null,action:null,buttonOneHash:{useStaticLayout:YES,actionKey:SC.BUTTON1_STATUS,localize:YES,layout:{right:0,height:"auto",width:"auto",bottom:0},title:"Button.OK",icon:null,action:"dismiss",isDefault:YES},buttonTwoHash:{useStaticLayout:YES,actionKey:SC.BUTTON2_STATUS,localize:YES,layout:{right:5,height:"auto",width:"auto",bottom:0},title:"Button.Cancel",icon:null,action:"dismiss",isVisible:YES,isCancel:YES},buttonThreeHash:{useStaticLayout:YES,actionKey:SC.BUTTON3_STATUS,localize:YES,layout:{left:0,height:"auto",width:"auto",bottom:0},title:"Extra",icon:null,action:"dismiss",isVisible:NO},rightView:SC.View.extend({layoutBinding:"*owner.rightViewLayout",classNames:["text-align-right"],buttonOneHashBinding:"*parentView.buttonOneHash",buttonTwoHashBinding:"*parentView.buttonTwoHash",cancelButton:SC.ButtonView.extend(),okButton:SC.ButtonView.extend(),buttonHashObserver:function(){var d,e;d=this.okButton=SC.ButtonView.create(this.get("buttonOneHash"));e=this.cancelButton=SC.ButtonView.create(this.get("buttonTwoHash"));this.replaceAllChildren([e,d])}.observes("buttonOneHash","buttonTwoHash")}),leftView:SC.View.extend({layoutBinding:"*owner.leftViewLayout",classNames:["text-align-left"],isVisible:YES,buttonThreeHashBinding:"*parentView.buttonThreeHash",extraButton:SC.ButtonView.extend(),buttonHashObserver:function(){var b;b=this.extraButton=SC.ButtonView.create(this.get("buttonThreeHash"));this.replaceAllChildren([b])}.observes("buttonThreeHash")})});CW.FallOffScrollView=SC.ScrollView.extend({fallOffWidth:null,fallOffSize:SC.REGULAR_CONTROL_SIZE,classNames:["falloff-scroll"],showGradientOnlyIfScrollerVisible:NO,scrollerViewOffset:function(){return(this.get("isVerticalScrollerVisible")&&!this.get("verticalOverlay"))?this.getPath("verticalScrollerView.scrollbarThickness"):0}.property("isVerticalScrollerVisible"),applyScrollerViewOffset:function(){var f=this._falloffTop,e=this._falloffBottom;if(!SC.none(this.get("falloffWidth"))||!(f&&e)){return}var d=this._cssHash||(this._cssHash={});d.right=this.get("scrollerViewOffset");f.css(d);e.css(d)}.observes("scrollerViewOffset"),calculateFalloffVisibility:function(){var f,e,h=this.get("verticalScrollOffset"),g=this.get("maximumVerticalScrollOffset");if(!this.get("isVerticalScrollerVisible")&&this.get("showGradientOnlyIfScrollerVisible")){f=NO;e=NO}else{f=h!==0;e=h!==g}this.setIfChanged("showingTopFalloff",f);this.setIfChanged("showingBottomFalloff",e)},_calculateFalloffVisibilityOnce:function(){this.invokeOnce(this.calculateFalloffVisibility)}.observes("isVerticalScrollerVisible","verticalScrollOffset","showGradientOnlyIfScrollerVisible","maximumVerticalScrollOffset"),showingTopFalloff:NO,showOrHideTopFalloff:function(){var k=this.$(".falloff.top")[0];if(!k){return}var f=SC.browser.isIE8OrLower?0:300,h=this.get("showingTopFalloff")?1:0,j=this._wasShowingTopFalloff?1:0;this._wasShowingTopFalloff=this.get("showingTopFalloff");if(this._cwfs_topFalloffAnimation){this._cwfs_topFalloffAnimation.redirectTo(h)}else{if(h>0){k.style.display="block"}var g=this;this._cwfs_topFalloffAnimation=CW.Animation.create({duration:f,from:j,to:h,update:function(){k.style.opacity=this.current},cleanup:function(){if(this.to<1){k.style.display="none"}g._cwfs_topFalloffAnimation=null}.listens("finish")});this._cwfs_topFalloffAnimation.start()}}.observes("showingTopFalloff"),showingBottomFalloff:NO,showOrHideBottomFalloff:function(){var f=this.$(".falloff.bottom")[0];if(!f){return}var k=SC.browser.isIE8OrLower?0:300,h=this.get("showingBottomFalloff")?1:0,j=this._wasShowingBottomFalloff?1:0;this._wasShowingBottomFalloff=this.get("showingBottomFalloff");if(this._cwfs_bottomFalloffAnimation){this._cwfs_bottomFalloffAnimation.redirectTo(h)}else{if(h>0){f.style.display="block"}var g=this;this._cwfs_bottomFalloffAnimation=CW.Animation.create({duration:k,from:j,to:h,update:function(){f.style.opacity=this.current},cleanup:function(){if(this.to<1){f.style.display="none"}g._cwfs_bottomFalloffAnimation=null}.listens("finish")});this._cwfs_bottomFalloffAnimation.start()}}.observes("showingBottomFalloff"),render:function(t,x){arguments.callee.base.apply(this,arguments);if(SC.platform.touch){return}if(x){var s=this.get("fallOffWidth"),w=this.get("fallOffSize"),v="",u=this.get("showingTopFalloff"),n=this.get("showingBottomFalloff"),q,p,m=(w===SC.SMALL_CONTROL_SIZE)?"small":(w===SC.REGULAR_CONTROL_SIZE)?"regular":"large",o='<span class="right"/><span class="middle"/><span class="left"/>';if(!SC.none(s)){v+="width: %@px;".fmt(s)}else{v+="right: %@px;".fmt(this.get("scrollerViewOffset"))}if(!u){q=v+"display: none; opacity: 0;"}else{q=v}this._wasShowingTopFalloff=u;if(!n){p=v+"display: none; opacity: 0;"}else{p=v}this._wasShowingBottomFalloff=n;t.push('<div class="falloff %@1 top" style="%@2">%@4</div><div class="falloff %@1 bottom" style="%@3">%@4</div>'.fmt(m,q,p,o))}},didCreateLayer:function(b){this._falloffBottom=this.$(".falloff.bottom");this._falloffTop=this.$(".falloff.top");b()}.enhance()});sc_require("views/pane_bottom");sc_require("views/falloff_scroll");CW.PICKER_BOTTOM_BORDER_HEIGHT=28;CW.DEFAULT_POINTER_POSITION_FROM_TOP=33;CW.ADJUST_PARENT_DEBUGGING=NO;CW.PopOver=SC.PickerPane.extend({classNames:["pop-over"],innerScrollView:SC.outlet("contentView.wellView.contentView"),innerTitleView:SC.outlet("contentView.titleView"),innerContentOfScrollView:SC.outlet("contentView.wellView.contentView.contentView"),innerContent:SC.outlet("contentView.wellView.contentView"),innerBottomView:SC.outlet("contentView.bottomView"),contentViewHasScrollerView:NO,titleView:null,hasBottomView:NO,bottomViewWidthDistribution:null,leftButtonsContainerWidth:function(){return this.bottomViewWidthDistribution?this.bottomViewWidthDistribution.leftButtonsContainerWidth:".30"}.property("bottomViewWidthDistribution").cacheable(),rightButtonsContainerWidth:function(){return this.bottomViewWidthDistribution?this.bottomViewWidthDistribution.rightButtonsContainerWidth:".70"}.property("bottomViewWidthDistribution").cacheable(),delegate:null,action:null,verticalOverlay:YES,setInitialLayout:YES,popup:function(){arguments.callee.base.apply(this,arguments)},bottomView:CW.BottomPaneView.extend({layout:{height:32,left:0,right:0,bottom:0},leftButtonsContainerWidthBinding:"*parentView.parentView.leftButtonsContainerWidth",rightButtonsContainerWidthBinding:"*parentView.parentView.rightButtonsContainerWidth",delegateBinding:"*parentView.delegate",actionBinding:"*parentView.action"}),initialLayout:null,wellViewLayout:{top:10,left:12,right:12,bottom:10},wellView:SC.WellView.extend({}),contentViewLayout:{top:4,left:0,right:0,bottom:4},alwaysPositionBottom:NO,adjustLayout:YES,isLoading:NO,loadingText:null,isVerticalScrollerVisible:function(){if(this.get("contentViewHasScrollerView")){var b=this.get("innerScrollView");return b.get("isVerticalScrollerVisible")}return NO}.property(),render:function(n,k){var o=this.get("pointerPosY"),h=this.get("pointerPos"),m=0,l;if(h===SC.POINTER_LAYOUT[0]){m=0}else{if(h===SC.POINTER_LAYOUT[1]){l=this.get("layout");m=(l)?l.width:0}else{if(h===SC.POINTER_LAYOUT[2]||h===SC.POINTER_LAYOUT[3]){l=this.get("layout");m=(l)?l.width/2:0}}}if(h!==SC.POINTER_LAYOUT[3]&&h!==SC.POINTER_LAYOUT[2]){o+=CW.DEFAULT_POINTER_POSITION_FROM_TOP}n.addClass("popme");if(!SC.none(n.styles()["-webkit-transform-origin"])){n.removeStyle("-webkit-transform-origin")}if(!SC.none(n.styles()["-moz-transform-origin"])){n.removeStyle("-moz-transform-origin")}n.addStyle("-webkit-transform-origin","%@px %@px".fmt(m,o));n.addStyle("-moz-transform-origin","%@px %@px".fmt(m,o));var j=arguments.callee.base.apply(this,arguments);return j},contentView:SC.View.extend({classNames:["picker-contentView"],layout:{top:0,left:0,right:0,bottom:0},createChildViews:function(){var v=[],n=this.parentView,o=n.innerContentView,s=n.scrollView,p=n.titleView,z=n.contentViewLayout,w=n.hasBottomView,y=n.bottomView,t=n.get("contentViewHasScrollerView"),x=n.get("wellView"),u=n.get("wellViewLayout"),q=this.parentView.get("verticalOverlay");if(p){p=this.titleView=this.createChildView(p);this.childViews.pushObject(p)}if(w){this.bottomView=y=this.createChildView(y);this.childViews.pushObject(y)}if(t){this.wellView=x=this.createChildView(x,{layout:u,contentLayout:z,contentView:CW.FallOffScrollView.extend({classNames:["pop-over-scroll"],fallOffSize:SC.REGULAR_CONTROL_SIZE,verticalOverlay:q,hasHorizontalScroller:NO,verticalScrollerLayout:{right:4,top:3,bottom:4},verticalScrollerView:CW.CaplessMiniScrollerView,contentView:o,showGradientOnlyIfScrollerVisible:YES,delaysContentTouches:NO})});this.childViews.pushObject(x)}else{this.wellView=x=this.createChildView(x,{layout:u,contentLayout:z,contentView:o});this.childViews.pushObject(x)}}}),paneDidAttach:function(){arguments.callee.base.apply(this,arguments);this.set("initialLayout",this.get("layout"))},getContentView:function(){if(this.get("contentViewHasScrollerView")){return this.get("innerContentOfScrollView")}else{return this.get("innerContent")}},remove:function(){var e=this.get("initialLayout");var d=this.get("setInitialLayout");if(e&&d){this.set("layout",e)}arguments.callee.base.apply(this,arguments)},dismiss:function(d){var e=this.get("delegate");var f=this.get("action");if(e&&f){SC.RootResponder.responder.sendAction(f,e,d.get("actionKey"))}else{CW.fatalError("Delegate and action were not provided")}},name:"Pop Over",readableName:function(){return this.name||this.toString()}.property("name").cacheable(),updateHeight:function(g,f){var e=this.get("frame").height,h=(e+g);if(CW.ADJUST_PARENT_DEBUGGING){CW.debug("%@ current height ---> %@",this,e);CW.debug("%@ pickerHeightChange ---> %@",this,h)}this.adjust({height:h});if(f){this.adjustChildViewsLayout(g,f)}this.windowSizeDidChange(null,SC.RootResponder.responder.computeWindowSize())},fitPositionToScreenPointer:function(a,p,f){if(this.get("alwaysPositionBottom")){var m=(f.height>12)?0:1;var o=(f.height>12)?0:3;var v;var s=[[f.x+f.width+(7+m),f.y+parseInt(f.height/2,0)-40],[f.x-p.width-(7+m),f.y+parseInt(f.height/2,0)-40],[f.x+parseInt((f.width/2)-(p.width/2),0),f.y-p.height-(17+o)],[f.x+parseInt((f.width/2)-(p.width/2),0),f.y+f.height+(17+o)]];var t=[[f.x+f.width+p.width+(7+m),f.y+parseInt(f.height/2,0)+p.height-24],[f.x-(7+m),f.y+parseInt(f.height/2,0)+p.height-24],[f.x+parseInt((f.width/2)-(p.width/2),0)+p.width,f.y-(17+o)],[f.x+parseInt((f.width/2)-(p.width/2),0)+p.width,f.y+f.height+p.height+(17+o)]];var q=[[s[0][1]>0?0:0-s[0][1],t[0][0]<a.width?0:t[0][0]-a.width,t[0][1]<a.height?0:t[0][1]-a.height,s[0][0]>0?0:0-s[0][0]],[s[1][1]>0?0:0-s[1][1],t[1][0]<a.width?0:t[1][0]-a.width,t[1][1]<a.height?0:t[1][1]-a.height,s[1][0]>0?0:0-s[1][0]],[s[2][1]>0?0:0-s[2][1],t[2][0]<a.width?0:t[2][0]-a.width,t[2][1]<a.height?0:t[2][1]-a.height,s[2][0]>0?0:0-s[2][0]],[s[3][1]>0?0:0-s[3][1],t[3][0]<a.width?0:t[3][0]-a.width,t[3][1]<a.height?0:t[3][1]-a.height,s[3][0]>0?0:0-s[3][0]]];if(!this.preferMatrix||this.preferMatrix.length!==5){this.set("preferMatrix",[0,1,2,3,0])}var u=this.preferMatrix;if(u[4]===-1){p.x=f.x+parseInt(f.width/2,0);p.y=f.y+parseInt(f.height/2,0)-parseInt(p.height/2,0);this.set("pointerPos",SC.POINTER_LAYOUT[0]+" fallback");this.set("pointerPosY",parseInt(p.height/2,0)-40)}else{p.x=s[u[4]][0];p.y=s[u[4]][1];this.set("pointerPos",SC.POINTER_LAYOUT[u[4]]);this.set("pointerPosY",0)}this.set("pointerPosX",0);v=u[0];p.x=s[v][0];p.y=s[v][1];this.set("pointerPosY",0);this.set("pointerPos",SC.POINTER_LAYOUT[v])}else{p=arguments.callee.base.apply(this,arguments)}return p},windowSizeDidChange:function(s,n){var m=this.get("innerScrollView"),k,p,o,t,q,l;if(!this.get("isPaneAttached")){return}if(s&&n&&s.height===n.height&&s.width===n.width){return this}if(this.get("alwaysPositionBottom")&&this.get("contentViewHasScrollerView")&&this.get("adjustLayout")){SC.RunLoop.begin();SC.RunLoop.end();k=m.get("containerView").get("frame").height;p=m.get("contentView").get("frame").height;o=p-k;t=n.height;q=this.get("frame");l=t-(q.y+q.height+CW.PICKER_BOTTOM_BORDER_HEIGHT);l=o>l?l:o;this.adjust({height:q.height+l})}this.positionPane(s===null?YES:NO);return this},setButtonHash:function(g,k,h){var l=["buttonOne","buttonTwo","buttonThree"];var j=this.get("hasBottomView");if(!j){CW.fatalError("there is no bottomView provided")}if(l.indexOf(h)===-1){CW.fatalError("buttonNumber provided is invalid")}var m=SC.clone(this.getPath("pane.innerBottomView."+h+"Hash"));m[g]=k;this.getPath("pane.innerBottomView").set(h+"Hash",m)},setHash:function(e,f){var h=["buttonOne","buttonTwo","buttonThree"];var g=this.get("hasBottomView");if(!g){CW.fatalError("there is no bottomView provided")}if(h.indexOf(f)===-1){CW.fatalError("buttonNumber provided is invalid")}this.getPath("pane.innerBottomView").set(f+"Hash",e)},addViewToTheContentView:function(e){var d=this.get("contentViewHasScrollerView"),f;if(d){f=this.get("innerContentOfScrollView")}else{f=this.get("innerContent")}f.appendChild(e)},removeViewFromTheContentView:function(e){var d=this.get("contentViewHasScrollerView"),f;if(d){f=this.get("innerContentOfScrollView")}else{f=this.get("innerContent")}f.removeChild(e)},isLoadingObserver:function(){var e=this.get("loadingText"),f=this.get("isLoading"),h=this.get("loadingView"),g=this.getPath("contentView.wellView").get("frame");if(f){h=CW.LoadingView.show(g.width-4,g.height-4,e,"overlay-loading-view");this.set("loadingView",h);this.getPath("contentView.wellView").appendChild(h)}else{if(h){this.getPath("contentView.wellView").removeChild(h)}else{SC.error("There is no Loading View")}}}.observes("isLoading"),adjustHeightAndPositionPane:function(b){if(b&&b>0){this.adjust({height:b}).positionPane()}return this},positionPane:function(w){var t=this.get("anchorElement"),u=this.get("anchorView"),o=this.get("preferType"),p=this.get("preferMatrix"),q=this.get("layout"),m,x,n,v,s;if(t){if(!w){if(u){x=u.get("frame");n=x.width;v=x.height}t=this.computeAnchorRect(t,n,v);if(t.x===0&&t.y===0){return}m=SC.cloneRect(t);if(o){switch(o){case SC.PICKER_MENU:case SC.PICKER_FIXED:if(!p||p.length!==3){this.set("preferMatrix",[1,4,3])}m.x+=((this.preferMatrix[2]===0)?m.width:0)+this.preferMatrix[0];m.y+=((this.preferMatrix[2]===3)?m.height:0)+this.preferMatrix[1];break;default:m.y+=m.height;break}}else{m.y+=m.height}this._originCached=m;this._anchorCached=t}else{m=this._originCached;t=this._anchorCached}s=this.fitPositionToScreen(m,this.get("frame"),t);this.adjust({width:s.width,height:s.height,left:s.x,top:s.y})}else{this.adjust({width:q.width,height:q.height,centerX:0,centerY:0})}this.updateLayout();return this}});sc_require("views/mini_fading_capless_scroller");CW.Prompt=SC.PanelPane.extend({message:"",messageViewPaddingBottom:10,description:null,descriptionViewPadding:{top:0,bottom:4},descriptionViewMinHeight:9,descriptionViewMaxHeight:CW.get("isMobile")?200:300,caption:null,captionViewPadding:{top:4,bottom:7},captionViewMinHeight:0,image:"me-icon-alert-68",rightButton:"OK",middleButton:null,leftButton:null,extraView:null,extraViewPadding:{top:5,bottom:3},extraViewMinHeight:0,escapeHTML:NO,layout:{centerX:0,width:450,centerY:-10,height:160},defaultText:null,classNames:["cw-alert cw-prompt"],ariaRole:"alertdialog",init:function(){arguments.callee.base.apply(this,arguments);if(this.get("extraWide")){this.adjust("width",500)}if(CW.isMobile()){this.layout={left:20,centerY:0,right:20}}},append:function(){arguments.callee.base.apply(this,arguments);layerId="#"+this.layerId();$(layerId).addClass("animated zoomIn")},remove:function(){layerId="#"+this.layerId();$(layerId).removeClass("animated zoomIn");arguments.callee.base.apply(this,arguments)},modalPane:SC.ModalPane.extend({classNames:"cw-modal animated fadeIn".w(),paneFadeInDuration:!SC.browser.webkit?350:function(){return 350*(innerWidth<1983&&innerHeight<1983)}.property(),paneFadeOutDuration:function(){return this.get("paneFadeInDuration")}.property(),paneOpacity:0.5,init:function(){if((SC.browser.webkit)&&(innerWidth>=1983||innerHeight>=1983)){this.classNames.push("no-gpu")}arguments.callee.base.apply(this,arguments);var e=SC.RootResponder.responder.mainPane;if(e){var d=e.layout.minWidth,f=e.layout.minHeight;if(d){this.adjust("minWidth",d)}if(f){this.adjust("minHeight",f)}}}}),contentView:SC.View.design({layout:{left:0,right:0,top:0,bottom:0},escapeHTMLBinding:"*parentView.escapeHTML",separatorView:SC.View.design({layout:{height:2,right:5,left:5,bottom:56},classNames:["separator"]}),createChildViews:function(){SC.Binding.flushPendingChanges();var C=this.get("escapeHTML"),D=this.get("pane"),G=D.get("message"),A=D.get("description"),x=D.get("caption"),B=D.get("defaultText"),E=(CW.get("isMobile")||(SC.typeOf(B)===SC.T_STRING))?null:D.get("image"),O=D.get("extraView"),K=D.get("rightButton"),J=D.get("middleButton"),L=D.get("leftButton"),w=this.childViews,H=CW.Prompt,F="Trying to create a CW.Prompt with a %@ button that is neither a string, nor a button view.",I,N,y,P,z,v,M;if(E){if(SC.typeOf(E)===SC.T_STRING){this.imageView=H.ImageView.extend({value:E})}else{if(E.value&&E.width&&E.height){this.imageView=H.ImageView.extend({value:E.value,width:E.width,height:E.height})}else{CW.fatalError("Trying to create a CW.Prompt with improper an invalid image hash.")}}w.push("imageView")}if(!G){CW.fatalError("Trying to create a CW.Prompt without a message.")}this.messageView=H.MessageView.extend({value:G,escapeHTML:C});w.push("messageView");if(A){this.descriptionView=H.DescriptionView.extend({value:A,escapeHTML:C});w.push("descriptionView")}if(SC.typeOf(B)===SC.T_STRING){this.promptView=H.PromptView.extend({value:B,escapeHTML:C});w.push("promptView")}if(x){this.captionView=H.CaptionView.extend({value:x,escapeHTML:C});w.push("captionView")}if(O){this.extraView=O;w.push("extraView")}w.push("separatorView");if(L){if(SC.typeOf(L)===SC.T_STRING){I={title:L,action:"remove",target:D}}else{if(SC.typeOf(L)===SC.T_HASH){I=L}else{CW.fatalError(F.fmt("left"))}}this.leftButtonView=H.LeftButtonView.extend(I);w.push("leftButtonView")}if(J){if(SC.typeOf(J)===SC.T_STRING){N=J;y="remove";P=D}else{if(SC.typeOf(J)===SC.T_HASH){N=J.title?J.title:"Cancel";y=J.action?J.action:null;P=J.target?J.target:D}else{CW.fatalError(F.fmt("middle"))}}}if(!K){CW.fatalError("Trying to create a CW.Prompt without a right button.")}if(SC.typeOf(K)===SC.T_STRING){z=K;v="remove";M=D}else{if(SC.typeOf(K)===SC.T_HASH){z=K.title?K.title:"OK";v=K.action?K.action:null;M=K.target?K.target:D}else{CW.fatalError(F.fmt("right"))}}this.mainButtonsView=H.MainButtonsView.extend({middleButtonIsVisible:J?YES:NO,middleButtonTitle:N,middleButtonAction:y,middleButtonTarget:P,rightButtonTitle:z,rightButtonAction:v,rightButtonTarget:M});w.push("mainButtonsView");return arguments.callee.base.apply(this,arguments)},extraViewFrameDidChange:function(){if(this._resizingExtraView){this._resizingExtraView=NO;return}this.performLayout()},didCreateLayer:function(){var f=this.get("pane");if(SC.browser.isIE8OrLower){f.$()[0].style.filter="alpha(opacity=0)"}else{f.$().css({opacity:0,"-webkit-animation-name":"none",})}var d=this.get("extraView");if(d&&d.isAutoResizingExtraView){d.addObserver("frame",this,this.extraViewFrameDidChange)}var e=this;this.invokeLater(function(){e.performLayout()},100)},performLayout:function(){var J=this.get("pane"),N=this.messageView,ah=this.descriptionView,A=this.promptView,M=J.get("descriptionViewMinHeight")||0,I=J.get("descriptionViewMaxHeight")||0,T=this.captionView,ad=J.get("captionViewMinHeight")||0,ae=this.extraView,U=J.get("extraViewMinHeight")||0,X=this.imageView,K=J.get("image"),G=N.getPath("layout.top"),ac=this.mainButtonsView,W=CW.Prompt,E=W.MIN_Prompt_HEIGHT,ag=null,R,af,L,H=0,P,F,aa,ab,Y,S,O,Q,Z;if(SC.browser.isIE8OrLower){J.$()[0].style.filter="alpha(opacity=100)"}else{J.$().css({opacity:1,"-webkit-animation-name":"pop",})}J.set("ariaLabelledBy",SC.guidFor(N));J.set("ariaDescribedBy",SC.guidFor(ah));R=N.get("value");af=N.get("layer");F=N.get("frame").width+"px";af.style.maxWidth=F;L=SC.metricsForString(R,af,null,!this.get("escapeHTML")).height;if(A){N.adjust("left",25)}N.adjust("height",L);G+=L;Z=J.get("messageViewPaddingBottom");if(Z){G+=Z}if(ah){O=J.get("descriptionViewPadding");if(O&&(Q=O.top)){G+=Q}ah.adjust("top",G);R=ah.get("value");af=ah.contentView.get("layer");af.style.maxWidth=F;L=SC.metricsForString(R,af,null,!this.get("escapeHTML")).height;if(L<M){L=M}else{if(L>I){ag=L;L=I}}if(A&&ah.contentView){ah.contentView.adjust("left",25)}ah.adjust("height",L);if(ag){ah.contentView.adjust("height",CW.get("isMobile")?ag+200:ag)}G+=L;if(O&&(Z=O.bottom)){G+=Z}}else{G+=M}if(A){A.adjust("top",G+5);promptViewHeight=A.get("frame").height;G+=promptViewHeight+5}if(T){O=T.get("padding");if(O&&(Q=O.top)){G+=Q}T.adjust("top",G);R=T.get("value");af=T.get("layer");af.style.maxWidth=F;L=SC.metricsForString(R,af,null,!this.get("escapeHTML")).height;if(L<ad){L=ad}if(A){T.adjust("left",25)}T.adjust("height",L);G+=L;if(O&&(Z=O.bottom)){G+=Z}}else{G+=ad}if(ae){this._resizingExtraView=YES;O=J.get("extraViewPadding");if(O&&(Q=O.top)){G+=Q}ae.adjust("top",G);L=undefined;if(ae.isAutoResizingExtraView){L=ae.computeHeight()}if(SC.none(L)){L=ae.get("frame").height}if(SC.none(L)){CW.fatalError("Trying to create a CW.Prompt with an extraView which does not have its height specified.")}if(L<U){L=U}G+=L;if(O&&(Z=O.bottom)){G+=Z}}else{G+=U}if(X&&K.width&&K.height){X.adjust("width",K.width);X.adjust("height",K.height);imageViewBottom=X.getPath("frame.bottom")}G+=W.BUTTONS_AND_SEPARATOR_HEIGHT;if(G<E){G=E}aa=ac.middleButton;ab=ac.rightButton;if(this.leftButtonView){S=this.leftButtonView.get("frame");if(S){H=S.width}}if(aa){S=aa.get("frame");if(S){H+=S.width}}if(ab){S=ab.get("frame");if(S){H+=S.width}}J.adjust("height",G);Y=W.BUTTONS_REGULAR_PADDING+W.BUTTONS_MIN_PADDING_MIDDLE_AND_LEFT+(W.BUTTONS_SIDE_PADDING*2);if(H+Y>J.get("frame").width){J.adjust("width",H+Y)}this._resizingExtraView=NO;var V=this.$(".def");setTimeout(function(){V[0].focus()},1000)}})});CW.Prompt.BUTTONS_REGULAR_PADDING=8;CW.Prompt.BUTTONS_MIN_PADDING_MIDDLE_AND_LEFT=15;CW.Prompt.BUTTONS_SIDE_PADDING=20;CW.Prompt.BUTTONS_AND_SEPARATOR_HEIGHT=71;CW.Prompt.MIN_Prompt_HEIGHT=162;CW.Prompt.MessageView=SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,top:26,right:25},classNames:["title-label"],ariaRole:"heading"});CW.Prompt.DescriptionView=SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,right:25},classNames:["description"],valueBinding:".parentView.parentView.value",escapeHTMLBinding:".parentView.parentView.escapeHTML",})});CW.Prompt.CaptionView=SC.LabelView.extend({layout:{left:CW.get("isMobile")?25:110,right:25},classNames:["caption"]});CW.Prompt.ImageView=SC.ImageView.extend({layout:{left:25,top:22,width:68,height:68},classNames:["cw-alert-image-view"]});CW.Prompt.PromptView=SC.TextFieldView.extend({layout:{left:25,right:25,height:70},isTextArea:true,classNames:["prompt"],render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){this.$(".field").css("font-size","23px");this.becomeFirstResponder()})}});CW.Prompt.MainButtonsView=SC.View.extend({layout:{height:30,bottom:11,right:16,left:16},classNames:["text-align-right"],childViews:["middleButton","rightButton"],middleButtonIsVisible:YES,middleButtonTitle:"Cancel",middleButtonAction:null,middleButtonTarget:null,rightButtonTitle:"Ok",rightButtonAction:null,rightButtonTarget:null,init:function(){arguments.callee.base.apply(this,arguments);this.middleButton.set("title",this.middleButtonTitle);this.middleButton.set("isVisible",this.middleButtonIsVisible);this.middleButton.set("action",this.middleButtonAction);this.middleButton.set("target",this.middleButtonTarget);this.rightButton.set("title",this.rightButtonTitle);this.rightButton.set("action",this.rightButtonAction);this.rightButton.set("target",this.rightButtonTarget)},middleButton:SC.ButtonView.extend({isCancel:YES,themeName:"square",useStaticLayout:YES,controlSize:SC.HUGE_CONTROL_SIZE,layout:{left:0,height:"auto",width:"auto",bottom:0}}),rightButton:SC.ButtonView.extend({isDefault:YES,themeName:"square",useStaticLayout:YES,controlSize:SC.HUGE_CONTROL_SIZE,layout:{left:0,height:"auto",width:"auto",bottom:0},render:function(b){b.attr("tabindex","0");return arguments.callee.base.apply(this,arguments)}})});CW.Prompt.LeftButtonView=SC.ButtonView.extend(SC.AutoResize,{title:"Other...",themeName:"square",controlSize:SC.HUGE_CONTROL_SIZE,layout:{height:30,left:18,bottom:11,minWidth:72}});CW.Prompt.ExtraViewAutoResizingSupport={isAutoResizingExtraView:YES,computeHeight:function(){var g=this.get("autoResizeLayer")||this.get("layer"),k=this.getPath("frame.width"),h=this.get("autoResizeText")||"",j=this.get("autoResizePadding")||0,f;if(SC.none(g)||SC.empty(h)){return 0}g.style.maxWidth=k+"px";f=SC.metricsForString(h,g,this.get("classNames"),!this.get("escapeHTML"));return f.height+j}};CW.Prompt.show=function(d){if(SC.typeOf(d)===SC.T_HASH){var e=this.create(d);e.append();return e}CW.fatalError("Attempted to show a CW.Prompt without options.");return null};CW.SquareMenuPane=SC.MenuPane.extend({classNames:"me-square-menu",itemHeight:31,itemSeparatorHeight:7,menuHeightPadding:6});CW.CANVAS_BUTTON_HEIGHT=26;CW.TOOLBAR_BUTTON_HEIGHT=26;CW.SQUARE_BUTTON_REGULAR_HEIGHT=27;CW.IOS_BUTTON_REGULAR_HEIGHT=30;CW.IOSMINI_BUTTON_REGULAR_HEIGHT=24;CW.IOSBIG_BUTTON_REGULAR_HEIGHT=46;CW.SELECT_BUTTON_REGULAR_HEIGHT=27;CW.POPUP_BUTTON_REGULAR_HEIGHT=27;CW.SQUARE_BUTTON_REGULAR_MIN_WIDTH=68;CW.SQUARE_BUTTON_SMALL_MIN_WIDTH=56;CW.SQUARE_BUTTON_TINY_MIN_WIDTH=52;CW.HELP_BUTTON_REGULAR_MIN_WIDTH=26;CW.HELP_BUTTON_SMALL_MIN_WIDTH=22;CW.HELP_BUTTON_TINY_MIN_WIDTH=18;CW.CHECKBOX_REGULAR_HEIGHT=18;CW.PROGRESS_REGULAR_HEIGHT=20;CW.PROGRESS_CAPSULE_HEIGHT=19;CW.PROGRESS_CAPSULE_ANIMATED_BACKGROUND_MATRIX=[171,19,31];CW.PROGRESS_REGULAR_OFFSETRANGE=32;CW.PROGRESS_CAPSULE_OFFSETRANGE=20;CW.TEXT_FIELD_SMALL_HEIGHT=18;CW.TEXT_FIELD_REGULAR_HEIGHT=22;CW.TEXT_FIELD_LARGE_HEIGHT=26;CW.TEXT_FIELD_LARGE_TALL_HEIGHT=31;CW.TEXT_FIELD_HUGE_HEIGHT=31;CW.SLIDER_REGULAR_HEIGHT=25;CW.DOCK_HEIGHT=46;CW.SOURCE_LIST_WIDTH=171;CW.TINY_CONTROL_SIZE=SC.TINY_CONTROL_SIZE;CW.SMALL_CONTROL_SIZE=SC.SMALL_CONTROL_SIZE;CW.REGULAR_CONTROL_SIZE=SC.REGULAR_CONTROL_SIZE;CW.LARGE_CONTROL_SIZE=SC.LARGE_CONTROL_SIZE;CW.LARGE_TALL_CONTROL_SIZE="me-large-tall-size";CW.XLARGE_CONTROL_SIZE=SC.HUGE_CONTROL_SIZE;CW.DropTarget={isDropTarget:YES,acceptsFileDrags:YES,dragStarted:function(d,e){},dragEntered:function(d,e){},dragUpdated:function(d,e){},dragExited:function(d,e){},dragEnded:function(d,e){},computeDragOperations:function(d,e){return SC.DRAG_NONE},acceptDragOperation:function(e,d){return YES},performDragOperation:function(e,d){return SC.DRAG_NONE},_isCurrentlyHovered:NO,renderMixin:function(e,d){if(d&&SC.browser.isWebkit&&this.get("acceptsFileDrags")){e.push('<div class="cw-drop-target-container"><input class="cw-drop-target-file" type="file" multiple="multiple"></div>')}},didCreateLayer:function(d){d();if(!this.get("acceptsFileDrags")){return}var f=this.$().children(".cw-drop-target-container").children()[0]||null;if(SC.browser.isWebkit&&f){SC.Event.add(f,"change",this,this._handleDrop)}else{if(SC.browser.mozilla){var e=this.get("layer");SC.Event.add(e,"drop",this,this._handleDrop)}}}.enhance(),_changeFileElementClickability:function(e){if(SC.browser.isWebkit&&this.get("acceptsFileDrags")){var d=this.$().children(".cw-drop-target-container").children()[0]||null;var f=(e)?"block":"none";if(d&&f!==d.style.display){d.style.display=f}}},_handleDragEnter:function(e){if(CW.DropTarget.dealWithSafariWindows()){return}if(SC.browser.isWebkit){if(!(e&&e.target&&e.target.className&&e.target.className.indexOf&&e.target.className.indexOf("cw-drop-target-file")>-1)){this._isCurrentlyHovered=YES;return}}var d=e.dragOperation;if(this._isFileEvent(e)){this._changeFileElementClickability(YES)}if(this.computeDragOperations(d,e)|SC.DRAG_DATA){this.dragEntered(d,e);this._isCurrentlyHovered=YES}},_handleDragOver:function(e){var d=e.dragOperation;if(this._isFileEvent(e)){this._changeFileElementClickability(YES)}if(CW.DropTarget.dealWithSafariWindows()){return}if(this.computeDragOperations(d,e)|SC.DRAG_DATA){if(this._isCurrentlyHovered){this.dragUpdated(d,e)}else{this.dragEntered(d,e);this._isCurrentlyHovered=YES}}},_handleDrop:function(m){var j=m.dragOperation;if(!j){j=this._dragOperationForEvent(m)}this._changeFileElementClickability(NO);if(CW.DropTarget.dealWithSafariWindows()){return}if(this.acceptDragOperation(j,SC.DRAG_DATA)){var l=m.dataTransfer.files;if(l&&l.length>0){j.data=l;for(var g=0,h=l.length;g<h;++g){var k=l[g];if(SC.none(k.fileName)&&k.name){k.fileName=k.name}}}this.performDragOperation(j,SC.DRAG_DATA)}},_handleDragExit:function(e){if(SC.browser.isWebkit){if(!(e&&e.target&&e.target.className&&e.target.className.indexOf&&e.target.className.indexOf("cw-drop-target-file")>-1)){return}}var f=e.dragOperation;var d=e.originalEvent.target;if(d.type&&d.type==="file"){this._changeFileElementClickability(NO)}if(CW.DropTarget.dealWithSafariWindows()){return}this.dragExited(f,e)},_isFileEvent:function(k){var h=k.dataTransfer;if(h){var j=h.types;if(SC.none(j)){return YES}for(var f=0,g=j.length;f<g;++f){if(j[f]==="Files"){return YES}}}return NO},_notifyTargetViewsOfEvent:function(g,f){var e=SC.RootResponder.responder;var h=e.targetViewForEvent(f);if(!this._isFileEvent(f)){f.allowDefault()}else{f.stopPropagation();f.preventDefault()}if(SC.browser.isWindows&&SC.browser.isSafari){return NO}f.dragOperation=this._dragOperationForEvent(f,h);return e.sendEvent(g,f,h)},_dragOperation:null,_dragOperationForEvent:function(f,e){var g=CW.DropTarget._dragOperation;if(g){return g}var h=SC.Drag.start({event:f,source:e,ghost:NO,slideBack:NO,sourceIsDraggable:NO});CW.DropTarget._dragOperation=h;return h},_dragEndedOnDropTargets:function(n,l){if(CW.DropTarget.dealWithSafariWindows()){return}l=n.dragOperation||l;if(!l){return}var m=l._dropTargets();for(var h=0,j=m.length;h<j;h++){var o=m[h];o.tryToPerform("dragEnded",this,n);if(o&&o.get("acceptsFileDrags")){o._isCurrentlyHovered=NO;o._changeFileElementClickability(NO);if(SC.browser.isWebkit&&o.isVisibleInWindow){var k=o.$().children(".cw-drop-target-container").children()[0]||null;if(k){k.value=null}}}}CW.DropTarget._dragOperation=null}};SC.RootResponder.reopen({init:function(b){b();if(!SC.browser.isIE9OrLower){this.listenFor("dragenter dragover dragleave drop".w(),document,null,true)}}.enhance(),_dropTargetViewForEvent:function(e){var d=this.targetViewForEvent(e);while(YES){if(SC.none(d)||d.isDropTarget){return d}else{d=d.get("parentView")}}},dragenter:function(e){this.set("_lastDragEnterTarget",e.target);this._setupDragOverTimer(e);if(SC.browser.isMozilla||SC.browser.isIE10){var d=this._lastEvent;this._lastEvent=e;if(d){if(this._dropTargetViewForEvent(e)===this._dropTargetViewForEvent(d)){return}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragExit",d)}}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragEnter",e)}}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragEnter",e)}},_setupDragOverTimer:function(e){var d=this.get("_dragOverTimer");this.set("_lastDragOverEvent",e);if(d){d.invalidate()}d=SC.Timer.schedule({target:this,action:function(){var a=this.get("_lastDragOverEvent");if(a){this._lastEvent=undefined;CW.DropTarget._dragEndedOnDropTargets(a)}},interval:500,repeats:NO});this.set("_dragOverTimer",d)},dragover:function(b){this._setupDragOverTimer(b);CW.DropTarget._notifyTargetViewsOfEvent("_handleDragOver",b)},dragleave:function(e){if(SC.browser.isMozilla||SC.browser.isIE10){var d=this._lastEvent;this._lastEvent=e;if(d){if(this._dropTargetViewForEvent(d)===this._dropTargetViewForEvent(e)){return}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragEnter",d)}}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragExit",e)}}else{CW.DropTarget._notifyTargetViewsOfEvent("_handleDragExit",e)}},drop:function(e){if(CW.DropTarget.eliminateDoubleDrops){if(CW.DropTarget._droppedRecently){return}CW.DropTarget._droppedRecently=YES;setTimeout(function(){CW.DropTarget._droppedRecently=undefined},1000)}var d=CW.DropTarget._notifyTargetViewsOfEvent("_handleDrop",e);if(!d){CW.DropTarget._dragEndedOnDropTargets(e)}}});CW.DropTarget.dealWithSafariWindows=function(){if(SC.browser.isWindows&&SC.browser.isSafari){CW.Alert.show({message:"CW.DropTarget.SafariWindowsNotSupported.Title".loc(),description:"CW.DropTarget.SafariWindowsNotSupported.Description".loc()});return YES}return NO};CW.PrefsTheme=SC.BaseTheme.create({name:"prefs-theme"});SC.Theme.addTheme(CW.PrefsTheme);CW.PrefsSegmentedView=SC.SegmentedView.extend(SC.Control,{themeName:"prefs-theme"});CW.PrefsTheme.buttonRenderDelegate=SC.RenderDelegate.create({name:"button",render:function(g,f){var h=g.get("title"),e=g.get("icon");f.push('<span class="sc-button-inner"><div class="sc-button-label">','<img src="',SC.BLANK_IMAGE_URL,'" alt="" class="icon '+e+'"/>','<div class="sc-button-title">',h,"</div></div></span>")},update:function(d,e){}});sc_require("views/scroller");CW.CaplessScrollerView=CW.ScrollerView.extend({classNames:"me-capless-scroller-view",hasButtons:NO,capLength:0,capOverlap:0,buttonLength:0,buttonOverlap:0});CW.CollectionFastPath={log:function(){var b=SC.A(arguments);b.unshift(SC.guidFor(this));console.log.apply(console,b)},DOMPoolSize:200,preserveDOMOrder:NO,hasContentForShowing:YES,_curShowing:null,_shouldBeShowing:null,_justCreated:null,_indexMap:null,_viewsForItem:null,_oldLayouts:null,init:function(b){this._curShowing=SC.CoreSet.create();this._shouldBeShowing=SC.CoreSet.create();this._hasNoContent=SC.CoreSet.create();this._justCreated=SC.CoreSet.create();this._indexMap=[];this._pendingPool=SC.CoreSet.create();this._viewsForItem={};this._oldLayouts={};SC.backgroundTaskQueue.minimumIdleDuration=250;SC.backgroundTaskQueue.runLimit=-1;b()}.enhance(),firstKeyView:function(){return this.itemViewForContentIndex(0)}.property(),lastKeyView:function(){return this.itemViewForContentIndex(this.get("length"))}.property(),renderFromPool:function(h){var f,e=this.attributesForIndex(h),g=this.layoutForContentIndex(h);if(f=this._indexMap[h]){if(f.get("content")!==e.content){this.unpool(f);this.sendToOffscreenDOMPool(f);f=null}else{f=this.updateView(f,e,g)}}while(!f&&(f=this.pooledViewForItem(h))){f=this.updateView(f,e,g)}while(!f&&(f=this.viewFromDOMPoolFor(h))){f=this.updateView(f,e,g)}if(!f){f=this.renderItem(this.exampleViewForIndex(h),e,g)}this.mapToItem(f);this.mapToIndex(f);return f},_SCCFP_lastContent:null,_cv_contentDidChange:function(){var h=this.get("content");if(this._SCCFP_lastContent){this._SCCFP_lastContent.removeArrayObservers({target:this})}this._SCCFP_lastContent=h;if(h){this._SCCFP_contentRangeObserver=h.addArrayObservers({target:this})}var j=this._indexMap,k,g=j.length,f;for(k=0;k<g;k++){f=j[k];if(f){this.sendToOffscreenDOMPool(f)}}this.reload();arguments.callee.base.apply(this,arguments)}.observes("content"),contentLengthDidChange:function(){this.invokeLast(this._contentLengthDidChange);this.set("length",this.getPath("content.length"))},_contentLengthDidChange:function(){var k=this.get("content"),l=k?k.get("length"):0,m=this._indexMap,o=m.length;if(l<o){var h,j;for(h=l;h<o;h++){j=m[h];if(j){this.sendToOffscreenDOMPool(j)}}}m.length=l;this.setIfChanged("length",l);var n=this.computeLayout();if(n){this.adjustCollectionView(n)}},_sclv_lengthDidChange:SC.K,adjustCollectionView:function(b){this.adjust(b)},arrayDidChange:function(h,j,k){var f=this.getPath("content.length"),g=f+j-k;this.reload(SC.IndexSet.create(h,j===k?j:Math.max(f,g)-h))},arrayWillChange:SC.K,_cv_nowShowingDidChange:function(){if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadIfNeeded)}}.observes("nowShowing"),_cv_isVisibleInWindowDidChange:function(){if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadIfNeeded)}}.observes("isVisibleInWindow"),reloadSelectionIndexes:function(b){this.reload(b)},reloadSelectionIndexesIfNeeded:function(){this.reloadIfNeeded()},reload:function(d){if(SC.none(d)){var f,e=this._indexMap.length;for(f=0;f<e;f++){this.invalidate(f)}}else{if(d.isIndexSet){d.forEach(this.invalidate,this)}else{this.invalidate(d)}}if(this.get("isVisibleInWindow")){this.invokeOnce(this.reloadIfNeeded)}return this},contentIndexIsGroup:function(f,j){var k=this.get("contentDelegate"),g=this.get("_contentGroupIndexes"),h=NO;h=g&&g.contains(f);if(h){h=k.contentIndexIsGroup(this,this.get("content"),f)}return h},exampleViewForIndex:function(p){var j=this.get("contentDelegate"),q=this.get("_contentGroupIndexes"),o,k,m=this.get("content"),n=m.objectAt(p),l=this.contentIndexIsGroup(p,n);if(l){o=this.get("contentGroupExampleViewKey");if(o&&n){k=n.get(o)}if(!k){k=this.get("groupExampleView")||this.get("exampleView")}}else{o=this.get("contentExampleViewKey");if(o&&n){k=n.get(o)}if(!k){k=this.get("exampleView")}}return k},processNowShowing:function(b){if(b<this._minShowing){this._minShowing=b}if(b>this._maxShowing){this._maxShowing=b}this._shouldBeShowing.add(b)},wantsUpdate:function(b){if(this._justCreated.contains(b)){return}if(this._indexMap[b.contentIndex]===b){this.reload(b.contentIndex)}else{b._SCCFP_dirty=YES}},_SCCFP_resetBackgroundRenderQueue:function(){for(var b in this._DOMPools){this._DOMPools[b]._lastRendered=null}},reloadIfNeeded:function(E,C){var u=this.get("content"),s=u?u.get("length"):0,D=this._curShowing,B=this._shouldBeShowing,F=this._pendingRemovals||(this._pendingRemovals=[]),y=SC.platform.touch,t,A,z,v,w,x;if(!this.get("isVisibleInWindow")){return}if(!E||!E.isIndexSet){E=this.get("nowShowing")}B.clear();this._maxShowing=0;this._minShowing=s;E.forEach(this.processNowShowing,this);this._topBackground=this._maxShowing;this._bottomBackground=this._minShowing;v=D.length;for(z=0;z<v;z++){w=D[z];if(!B.contains(w)){if(!this._indexMap[w]){continue}F.push(this._indexMap[w])}}while(t=F.pop()){this.sendToDOMPool(t)}this._SCCFP_resetBackgroundRenderQueue();CW.CollectionFastPath.backgroundRenderTask.add(this);if(this.visibleDirtyViews){var q=this.visibleDirtyViews();while(t=q.pop()){if(!SC.none(t.contentIndex)&&!B.contains(t.contentIndex)){this.unpool(t);this.sendToOffscreenDOMPool(t)}}}if(y&&C){this.incrementalRenderTask.add(this)}else{while(this.renderNextNowShowing()){}CW.CollectionFastPath.backgroundRenderTask.start()}this.contentLengthDidChange()},DOMPoolSize:200,DOMPoolForExampleView:function(g){var h=this._DOMPools||(this._DOMPools={}),f=SC.guidFor(g),e=h[f];if(!g){"no exampleView to create from"}if(!e){e=h[f]=CW.CollectionFastPath._DoublyLinkedList.create()}return e},sendToDOMPool:function(g,k){if(!g){throw"cannot pool null view"}var j=this._curShowing;j.remove(g.contentIndex);this._hasNoContent.remove(g.contentIndex);this.updateHasContentForShowing();if(!g.isPoolable){return g}var h=g.createdFromExampleView,f=this.DOMPoolForExampleView(h);if(k){if(f._lastRendered){f.insertBetween(g,f._lastRendered,f._lastRendered._SCCFP_next)}else{f.enqueue(g)}f._lastRendered=g}else{f.enqueue(g)}return g},sendToOffscreenDOMPool:function(b){if(!b){throw"cannot pool null view"}this._curShowing.remove(b.contentIndex);if(!b.isPoolable){this.unmapFromIndex(b);this.unmapFromItem(b);b.destroy();return}this._pendingPool.add(b);this.unmapFromIndex(b);b.set("contentIndex",null);this.invokeOnce("flushPool")},flushPool:function(){var d=this._pendingPool;var e;while(e=d.pop()){e._willBePooled=YES;this.configureItemView(e)}},_sendToOffscreenDOMPool:function(l){var k=l.contentIndex,h,m,g,j=this.DOMPoolForExampleView(l.createdFromExampleView);this._hasNoContent.remove(k);this.updateHasContentForShowing();if(this.get("preserveDOMOrder")){l.set("isVisible",NO)}else{l.adjust("top",-1000)}this.unpool(l);j.push(l)},viewFromDOMPoolFor:function(e){var g=this.exampleViewForIndex(e),h=this.DOMPoolForExampleView(g);var f=h.tail();return f},touchScrollDidChange:function(m,n){if(Date.now()-this._lastTouchScrollTime<25){return}var l=this.get("clippingFrame");var o=this._inScrollClippingFrame||(this._inScrollClippingFrame={x:0,y:0,width:0,height:0});o.x=l.x;o.y=l.y;o.width=l.width;o.height=l.height;o.x=m;o.y=n;var p=this.contentIndexesInRect(o);if(!p){return}var j=this.get("length"),k=p.get("max"),q=p.get("min");if(k>j||q<0){p=p.copy();p.remove(j,k-j).remove(q,0-q).freeze()}if(this._lastNowShowing){if(p.contains(this._lastNowShowing)&&this._lastNowShowing.contains(p)){return}}this._lastNowShowing=p;this.reloadIfNeeded(p,YES);this._lastTouchScrollTime=Date.now()},mapToIndex:function(e){var d=e.contentIndex;if(this._indexMap[d]&&this._indexMap[d]!=e){throw"index %@ already mapped".fmt(d)}this._indexMap[d]=e;return e},unmapFromIndex:function(b){this._indexMap[b.contentIndex]=null;return b},mapToItem:function(e){var g=e.content,h=SC.guidFor(g),f=this._viewsForItem[h]||(this._viewsForItem[h]=SC.CoreSet.create());f.add(e);return e},unmapFromItem:function(d){var f=d.content,e=this._viewsForItem[SC.guidFor(f)];if(!e){"no view to unmap"}e.remove(d);return d},pooledViewForItem:function(p){var m=this._viewsForItem,n=this.get("content").objectAt(p),q=m[SC.guidFor(n)],j,l;if(q){var o,k=q.length;for(o=0;o<k;o++){j=q[o];l=j.contentIndex;if(l>p||!this._shouldBeShowing.contains(l)||j._SCCFP_dirty||SC.none(j.contentIndex)){return j}}}return null},contentIndexForLayerId:function(d){var e=SC.View.views[d];if(e&&e.displayDelegate===this&&!SC.none(e.contentIndex)){return e.contentIndex}else{return null}},_tempAttrs:{},attributesForIndex:function(n){var h=this.get("contentDelegate"),l=this.get("content"),m=l.objectAt(n),k=this.contentIndexIsGroup(n),j=this.exampleViewForIndex(n),o=this._tempAttrs;o.createdFromExampleView=j;o.parentView=this.get("containerView")||this;o.contentIndex=n;o.owner=o.displayDelegate=this;o.content=m;o.page=this.page;o.isEnabled=h.contentIndexIsEnabled(this,l,n);o.isSelected=h.contentIndexIsSelected(this,l,n);o.outlineLevel=h.contentIndexOutlineLevel(this,l,n);o.disclosureState=h.contentIndexDisclosureState(this,l,n);o.isGroupView=k;o.isVisible=YES;return o},configureItemView:function(j,f,h){var g=SC.guidFor(f?f.content:j.get("content")),k=this._oldLayouts[g];j.beginPropertyChanges();if(f){j.setIfChanged(f)}this.adjustItemView(j,h,k);this._oldLayouts[g]=h;j.endPropertyChanges();return j},adjustItemView:function(e,f,d){if(f){e.adjust(f)}this.finishAdjust(e)},finishAdjust:function(b){if(b._willBePooled){this._sendToOffscreenDOMPool(b);b._willBePooled=NO}return b},updateView:function(j,h,m){var k=j.contentIndex,o=h?h.contentIndex:k,l=this.exampleViewForIndex(o),n;if(!h){h=this.attributesForIndex(o)}if(!m){m=this.layoutForContentIndex(o)}this.unpool(j);if(l!==j.createdFromExampleView){this.sendToOffscreenDOMPool(j);this.unmapFromItem(j);return null}if(this.get("preserveDOMOrder")&&k!==o){this._insertChildViewAtIndex(j)}this.unmapFromItem(j);if(!SC.none(k)){this.unmapFromIndex(j);this._curShowing.remove(k);this._hasNoContent.remove(k);this.updateHasContentForShowing()}n=j._SCCFP_dirty||h.content!==j.get("content")||h.isSelected!==j.get("isSelected");this._pendingPool.remove(j);j._willBePooled=NO;this.configureItemView(j,h,m);if(n||j._SCCFP_dirty){j.invokeLast(j.updateLayer)}this.mapToIndex(j);this.mapToItem(j);this.validate(o);return j},renderItem:function(g,e,h){if(h){e.layout=h}var f=g.create(e);delete e.layout;this.configureItemView(f,e,h);this._justCreated.add(f);this.invokeOnce(this._appendJustCreated);return f},_appendJustCreated:function(){var b;while(b=this._justCreated.pop()){if(this.get("preserveDOMOrder")){this._insertChildViewAtIndex(b)}else{this.appendChild(b)}}},_insertChildViewAtIndex:function(f){var k=f.get("contentIndex"),j=this._indexMap,h,g=j.length;if(!SC.none(k)){for(k++;k<g;k++){h=j[k];if(h){this.insertBefore(f,h);return}}}this.appendChild(f)},renderNewView:function(h){var f,e=this.attributesForIndex(h),g=this.layoutForContentIndex(h);if(f=this._indexMap[h]){if(f.get("content")!==e.content){this.unpool(f);this.sendToOffscreenDOMPool(f);f=null}else{f=this.updateView(f,e,g)}}if(!f){f=this.renderItem(this.exampleViewForIndex(h),e,g)}this.mapToItem(f);this.mapToIndex(f);return f},unpool:function(e){var d=this.DOMPoolForExampleView(e.createdFromExampleView);if(e===d._lastRendered){d._lastRendered=(e._SCCFP_prev===e?null:e._SCCFP_prev)}d.remove(e);return e},updateHasContentForShowing:function(){this.invokeOnce(this._updateHasContentForShowing)},_updateHasContentForShowing:function(){this.setIfChanged("hasContentForShowing",!this._hasNoContent.length)},renderForeground:function(f){var d;if(this.willReload){this.willReload(d=SC.IndexSet.create(f))}var e=this.renderFromPool(f);this.validate(f);this._curShowing.add(f);if(e.get("content")){this._hasNoContent.remove(f)}else{this._hasNoContent.add(f)}this.updateHasContentForShowing();if(this.didReload){this.didReload(d||SC.IndexSet.create(f))}return e},renderBackground:function(k){var f,h=this.exampleViewForIndex(k),j=this.DOMPoolForExampleView(h),g;if(this.willReload){this.willReload(f=SC.IndexSet.create(k))}if(j.length<this.DOMPoolSize){g=this.renderNewView(k)}else{g=this.renderFromPool(k)}this.sendToDOMPool(g,YES);this.validate(k);if(this.didReload){this.didReload(f||SC.IndexSet.create(k))}return g},itemViewForContentIndex:function(e){var d=this.get("content");if(d&&e>=0&&e<d.get("length")){return this.renderForeground(e)}},getNextNowShowing:function(){var k=this._curShowing,l=this._shouldBeShowing,n,j=l.length,o,m=this._indexMap,h;for(n=0;n<j;n++){o=l[n];h=m[o];if(!k.contains(o)||!h||h._SCCFP_dirty){return o}}},renderNextNowShowing:function(){var b=this.getNextNowShowing();if(b!==undefined){return this.renderForeground(b)}},invalidate:function(d){var e=this._indexMap[d];if(e){e._SCCFP_dirty=YES}},validate:function(d){var e=this._indexMap[d];if(e){e._SCCFP_dirty=NO}},_topBackground:0,_bottomBackground:0,_parity:YES,getNextBackground:function(){var o=this.get("content"),k=o.get("length"),n=this._indexMap,l,m=this._topBackground,t=this._bottomBackground,q=this._parity,s=this.DOMPoolSize,p;while((m-t<s-1)&&(m<k-1||t>0)){q=!q;if(q&&m<k-1){l=n[++m];if(!l||l._SCCFP_dirty){p=m;break}}else{if(t>0){l=n[--t];if(!l||l._SCCFP_dirty){p=t;break}}}}this._topBackground=m;this._bottomBackground=t;this._parity=q;return p},renderNextBackground:function(){var e=this.getNextBackground();if(e===undefined){return}var g=this.exampleViewForIndex(e),h=this.DOMPoolForExampleView(g),f;if(h._lastRendered&&!h.head){throw"New background render cycle started but last rendered view was not cleared"}if(h.length>=this.DOMPoolSize&&h._lastRendered&&(h._lastRendered===h.head._SCCFP_prev)){h._lastRendered=null;return}f=this.renderBackground(e);return f},incrementalRenderQueue:SC.TaskQueue.create({runWhenIdle:YES,runLimit:SC.platform.touch?-1:10,interval:SC.platform.touch?50:1,minimumIdleDuration:-1})};SC.mixin(CW.CollectionFastPath,{backgroundRenderTask:SC.Task.create({_cur:0,rendering:NO,viewsNeedRendering:SC.CoreSet.create(),run:function(e){if(!this.rendering){return}var f=this.viewsNeedRendering,d;if(this._cur>=f.length){this._cur=0}d=f[this._cur];if(d.renderNextBackground()){this._cur++}else{f.remove(d)}if(f.length>0){e.push(this)}else{this.stop()}},add:function(b){this.viewsNeedRendering.add(b)},start:function(){if(!this.rendering&&!CW.CollectionFastPath.incrementalRenderTask.rendering){SC.backgroundTaskQueue.push(this);this.rendering=YES}},stop:function(){this.rendering=NO}}),incrementalRenderTask:SC.Task.create({_cur:0,rendering:NO,viewsNeedRendering:SC.CoreSet.create(),run:function(e){var f=this.viewsNeedRendering,d;if(this._cur>=f.length){this._cur=0}d=f[this._cur];if(d.renderNextNowShowing()){this._cur++}else{f.remove(d)}if(f.length>0){e.push(this)}else{this.rendering=NO;CW.CollectionFastPath.backgroundRenderTask.start()}},add:function(b){this.viewsNeedRendering.add(b);if(!this.rendering){CW.CollectionFastPath.backgroundRenderTask.stop();CW.CollectionFastPath.incrementalRenderQueue.push(this);this.rendering=YES}}}),_DoublyLinkedList:SC.mixin({},{head:null,length:0,create:function(d){var e=SC.beget(this);if(d){e.init(d)}e.enqueue=e.unshift;e.dequeue=e.pop;return e},insertBetween:function(f,d,e){if(!e||!d){throw"invalid insertion"}d._SCCFP_next=f;f._SCCFP_prev=d;e._SCCFP_prev=f;f._SCCFP_next=e;this.length++;return f},remove:function(g){var h=g._SCCFP_prev,e=g._SCCFP_next,f=this.head;if(!(e&&h&&f)){return}e._SCCFP_prev=h;h._SCCFP_next=e;this.length--;if(g===f){if(f._SCCFP_next===f){this.head=null}else{this.head=e}}g._SCCFP_next=null;g._SCCFP_prev=null;return g},init:function(b){this.head=b;b._SCCFP_next=b;b._SCCFP_prev=b;this.length++;return this},push:function(d){var e=this.head;if(e){this.insertBetween(d,e._SCCFP_prev,e)}else{this.init(d)}return this},pop:function(){var b=this.head;if(b){return this.remove(b._SCCFP_prev)}},unshift:function(d){var e=this.head;if(e){this.insertBetween(d,e._SCCFP_prev,e);this.head=d}else{this.init(d)}return this},shift:function(){return this.remove(this.head)},tail:function(){var b=this.head;if(b){return b._SCCFP_prev}}})});CW.CollectionItem={nextKeyView:function(){var f=this.get("contentIndex"),g=this.get("displayDelegate"),e,h=g.get("length")-1;while(f++<h&&!(e=g.itemViewForContentIndex(f))){}return e||null}.property(),previousKeyView:function(){var e=this.get("contentIndex"),f=this.get("displayDelegate"),d;while(e-->0&&!(d=f.itemViewForContentIndex(e))){}return d||null}.property(),requestUpdate:function(){this.displayDelegate.wantsUpdate(this)},isPoolable:YES};CW.ScrollProxy={isScrollProxy:YES,_CSP_scrollView:null,proxyScrollView:function(b){this._CSP_scrollView=b;return this},scrollTo:function(e,f){var d=this._CSP_scrollView;if(d){d.scrollTo(e,f)}return this}};sc_require("views/collection/scroll_proxy");CW.CollectionViewProxy=SC.mixin(SC.clone(CW.ScrollProxy),{isCollectionViewProxy:YES,_CCVSP_collectionView:null,proxyCollectionView:function(e){var d=e;this._CCVSP_collectionView=e;this.set("nowShowingBinding",e.bind("nowShowing",this,"nowShowing"));while(d&&!d.get("isScrollable")){d=d.get("parentView")}if(d){this.proxyScrollView(d)}else{throw"collectionView is not inside a scrollView"}return this},scrollToContentIndex:function(d){var e=this._CCVSP_collectionView;if(e){this._CCVSP_collectionView.scrollToContentIndex(d)}return this},scrollToContentItem:function(g){var f=this._CCVSP_collectionView,h,e;if(!f||!g){return this}h=f.get("content");if(!h){return this}e=h.indexOf(g);if(e>=0){this.scrollToContentIndex(e)}return this},nowShowing:null});sc_require("panes/alert");CW.DetailsDisclosureView=SC.View.extend(CW.Alert.ExtraViewAutoResizingSupport,{layout:{left:25,right:25},contentView:SC.TextFieldView.design({layout:{height:90},isVisible:NO}),caption:null,isExpanded:NO,disclosureTitle:"Details",verticalPadding:7,classNames:["cw-details"],childViews:["contentView","disclosureButtonView"],disclosureButtonView:SC.DisclosureView.design({valueBinding:"*owner.isExpanded",titleBinding:"*owner.disclosureTitle",layout:{height:15}}),init:function(){arguments.callee.base.apply(this,arguments);var b=this.get("contentView");if(b){b.set("isVisible",this.get("isExpanded"))}},_isExpandedDidChange:function(){var j=this.get("isExpanded"),m=this.get("captionView"),g=m?m.getPath("frame.height"):undefined,k=this.get("contentView"),l=k.getPath("frame.height")+this.get("verticalPadding"),h=this.getPath("frame.height");if(j){k.set("isVisible",YES);if(m){m.adjust("top",g+l)}this.adjust("height",h+l)}else{k.set("isVisible",NO);if(m){m.adjust("top",g-l)}this.adjust("height",h-l)}}.observes("isExpanded"),createChildViews:function(){var b=this.get("caption");if(b){this.captionView=CW.DetailsDisclosureView.CaptionView.extend({value:b});this.childViews.push("captionView")}return arguments.callee.base.apply(this,arguments)},computeHeight:function(){var n=this.get("disclosureButtonView"),m=this.get("contentView"),s=this.get("captionView"),t=this.get("isExpanded"),q=this.get("verticalPadding"),k=n.getPath("frame.height")+q,l,o;m.adjust("top",k);if(t){k+=m.getPath("frame.height")+q+9}else{k+=6}if(s){var p=s.get("value");s.adjust("top",k);o=s.get("layer");o.style.maxWidth=s.getPath("frame.width")+"px";l=SC.metricsForString(p,o,"",NO).height;s.adjust("height",l);k+=l}this.adjust("height",k);return k}});CW.DetailsDisclosureView.CaptionView=SC.LabelView.design({escapeHTML:NO,classNames:["cw-caption"],layout:{top:0,left:0,right:0,height:0}});CW.ImageMapView=SC.View.extend({classNames:["me-image-map-view"],regions:[],regionCoordinatesKey:"coordinates",regionTargetKey:"target",regionActionKey:"action",hoveredRegion:null,selectedRegion:null,mouseDown:function(e){var d,f;d=this.convertFrameFromView({x:e.pageX,y:e.pageY});f=this.regionForPoint(d);if(f){this._mouseDownRegion=f;return YES}return NO},touchStart:function(b){return this.mouseDown(b)},mouseUp:function(g){var k,h,j,f;k=this.convertFrameFromView({x:g.pageX,y:g.pageY});h=this.regionForPoint(k);if(h){f=SC.get(h,"regionActionKey");j=SC.get(h,"regionTargetKey")||null;if(j){this.getPath("pane.rootResponder").sendAction(f,j,this,this.get("pane"),{region:h,coords:k})}this.setIfChanged("selectedRegion",h);return YES}return NO},touchEnd:function(b){this.set("hoveredRegion",null);return this.mouseUp(b)},mouseMoved:function(d){var e=this.convertFrameFromView({x:d.pageX,y:d.pageY});this.setIfChanged("hoveredRegion",this.regionForPoint(e))},touchesDragged:function(b){this.mouseMoved(b)},mouseExited:function(b){this.set("hoveredRegion",null)},regionForPoint:function(m){var j=this.get("regions"),g=0,h=j.get("length"),k,l=this.get("regionCoordinatesKey");this._coordinatesCache=this._coordinatesCache||[];for(;g<h;g++){k=(j[g].get?j[g].get(l):j[g][l]);if(SC.typeOf(k)===SC.T_STRING){if(this._coordinatesCache[g]){k=this._coordinatesCache[g]}else{k=this._coordinatesCache[g]=this._coordinateObjectForString(k)}}if(this._pointInPoly(m,k)){return j[g]}}return null},_pointInPoly:function(q,m){var o=m.length,j=q.x,l=q.y,k,p=o-1,n=NO;for(k=0;k<o;k++){if(m[k][1]<l&&m[p][1]>=l||m[p][1]<l&&m[k][1]>=l){if(m[k][0]+(l-m[k][1])/(m[p][1]-m[k][1])*(m[p][0]-m[k][0])<j){n=!n}}p=k}return n},_coordinateObjectForString:function(m){var l=m.split(","),g=0,h=l.length,j=[];if(h%2!==0){var k=SC.Error.desc("SC.ImageMapView: Unable to parse coordinates string because there were an odd number of values.");console.error(k.toString());throw k}for(;g<h;g+=2){j.push([parseInt(l[g],10),parseInt(l[g+1],10)])}return j}});sc_require("views/scroller");CW.MiniScrollerView=CW.ScrollerView.extend({classNames:"me-mini-scroller-view",hasButtons:NO,buttonLength:5,buttonOverlap:2,capLength:5,capOverlap:2,scrollbarThickness:8});sc_require("views/mini_scroller");CW.InsetMiniScrollerView=CW.MiniScrollerView.extend({classNames:["inset"],scrollbarThickness:(CW.MiniScrollerView.prototype.scrollbarThickness-1),capLength:(CW.MiniScrollerView.prototype.capLength-1),buttonLength:(CW.MiniScrollerView.prototype.buttonLength-1)});sc_require("views/scroller");CW.InsetScrollerView=CW.ScrollerView.extend({classNames:["inset"],scrollbarThickness:(CW.ScrollerView.prototype.scrollbarThickness-1),capLength:(CW.ScrollerView.prototype.capLength-1),buttonLength:(CW.ScrollerView.prototype.buttonLength-1)});CW.LoadingView=SC.View.extend({classNames:"",layout:null,icon:"",text:"",adjustParent:NO,render:function(d,e,f){d(e,f);e.push('<table border="0" width="100%" height="100%" valign="center">',"<tr>",'<td align="center">','<span class="spinner-box" style="text-align: middle">','<span style="vertical-align: middle; display: inline-block; float: none;" class="%@ spinner message"/>'.fmt(this.get("icon")),'<span style="vertical-align: middle;" class="me-loading-app text">',this.get("text"),"</span>","</span>","</td>","</tr>","</table>")}.enhance()});CW.LoadingView.show=function(l,h,j,k,m){var g=this.create({layout:{width:l,height:h},classNames:[k||"content-loading-view"],text:j||"Status.Loading".loc(),icon:m||"spinner-32px-f3f5f5"});return g};CW.ProgressVectorView=SC.ProgressView.extend({classNames:"me-progress-vector-view",render:function(g,j){var l=this.get("displayValue"),h=this.get("isIndeterminate"),m=this.get("isEnabled");if(this._lastTimeWasIndeterminate!==h){j=YES;this._lastTimeWasIndeterminate=h}if(h||l<=0||l>=1){var k={"sc-indeterminate":h,"sc-empty":(l<=0),"sc-complete":(l>=1)};g.setClass(k)}if(!j&&!h){this.updatePercentage(l,YES)}},isIndeterminateDidChange:function(){this.replaceLayer()}.observes("isIndeterminate"),didCreateLayer:function(){switch(this.get("isIndeterminate")){case YES:this.drawIndeterminate();break;case NO:this.drawDeterminate();break}},drawDeterminate:function(){var V=this.get("frame"),ad=Raphael.format,L=V.width,J=V.height,I=2,O=(J-1)/2,Z=O-I,P=L,h=L-I*2,ab=O*2+1,K=Raphael(this.$()[0],L+2,ab+2),R=K.set(),N=K.set(),G="M0 "+(Z+I),A="M"+I+" "+(Z+I),aa="a{0},{0} 0 0,1 {0},-{0} h{1} a{0},{0} 0 0,1 {0},{0}",M="a{0},{0} 0 0,1 -{0},{0} h-{1} a{0},{0} 0 0,1 -{0},-{0} ",S=aa+"a{0},{0} -180 0,0 -{2} -{2} h -{1} h-1 a{0},{0} 0 0,0 -{0} {2} z",w=A+ad(aa,Z,h-(2*Z)),ac=ad(M,Z,h-(2*Z)),Q,H,X,T,W,U,Y;Q=K.path(w+ac+" z").attr({fill:"#000","fill-opacity":"0.2",stroke:"none"});H=Q.clone().attr({fill:"90-#949aa7-#d9dee8",stroke:"none","fill-opacity":"1.0"});X=K.path(A+ad(S,Z,h-(2*Z),Z-1)).attr({fill:"#fff","fill-opacity":".5",stroke:"none"});T=X.clone().scale(1,-1).translate(0,Z+1).attr({fill:"#000","fill-opacity":"0.3"});R.push(X,H);N.push(T,Q);W=K.path(G+ad(aa,O,P-(2*O))+ad(M,O,P-(2*O))+"z");W.attr({stroke:"none",fill:"hsb(0,0,0.1)","fill-opacity":"0.6"}).toBack();U=K.path(G+ad(S,O,P-2*O,O-1)).attr({fill:"#101724","fill-opacity":"0.4",stroke:"none"});Y=U.clone().scale(1,-1).translate(0,O+1).attr({fill:"#fff","fill-opacity":"0.3"});this.set("paper",K);this.set("progressSet",R);this.set("shadowSet",N);this.set("innerProgressBar",H);this.updatePercentage(this.get("displayValue"),true);if(this.get("isEnabled")){this._animatePulsation()}},drawIndeterminate:function(){var X,af,N,L,K,Q,ab,R,h,O,M,ad,S,I,A,ac,P,T,w,ae,U,H,Z,V,Y,W,aa,J;X=this.get("frame");af=Raphael.format;N=X.width;L=X.height;K=2;Q=(L-1)/2;ab=Q-K;R=N;h=N-K*2;ad=Q*2+1;M=Raphael(this.$()[0],N+2,ad+2);S=M.set();I="M0 "+(ab+K);A="M"+K+" "+(ab+K);ac="a{0},{0} 0 0,1 {0},-{0} h{1} a{0},{0} 0 0,1 {0},{0}";P="a{0},{0} 0 0,1 -{0},{0} h-{1} a{0},{0} 0 0,1 -{0},-{0} ";T=ac+"a{0},{0} -180 0,0 -{2} -{2} h -{1} h-1 a{0},{0} 0 0,0 -{0} {2} z";J=h-(2*ab);w=A+af(ac,ab,J);ae=af(P,ab,J);U="/applications/reminders/coreweb/views/zh-cn/1N44/source/resources/images/progress/ind-bg-fill.png";H=M.path(w+ae+" z").attr({fill:"url("+U+")",stroke:"none"});Z=M.path(A+af(T,ab,J,ab-1)).attr({fill:"#fff","fill-opacity":".5",stroke:"none"});V=Z.clone().scale(1,-1).translate(0,ab+1).attr({fill:"#000","fill-opacity":"0.3"});S.push(H,Z,V);Y=M.path(I+af(ac,Q,R-(2*Q))+af(P,Q,R-(2*Q))+"z");Y.attr({stroke:"none",fill:"hsb(0,0,0.1)","fill-opacity":"0.6"}).toBack();W=M.path(I+af(T,Q,R-(2*Q),Q-1)).attr({fill:"#101724","fill-opacity":"0.4",stroke:"none"});aa=W.clone().scale(1,-1).translate(0,Q+1).attr({fill:"#fff","fill-opacity":"0.3"});this.set("innerProgressBar",H);if(this.get("isEnabled")){this.animateBg({x:24},400)}},updatePercentage:function(o,h){var k=this.get("frame"),l=k.width,p=k.height,m=l*o,n=this.get("progressSet"),q=this.get("shadowSet");if(!h){n.animate({"clip-rect":[0,0,m,p]},200);q.animateWith(n,{"clip-rect":[0,0,m+1,p]},200)}else{n.attr({"clip-rect":[0,0,m,p]});q.attr({"clip-rect":[0,0,m+1,p]})}},animateBg:function(n,m,k){if(n==="stop"){clearTimeout(this._ticker)}var o=this.get("innerProgressBar"),h=o.pattern||o.node.getElementsByTagName("fill")[0];if(!h){return}if(o._lastOffsetX===undefined){o._lastOffsetX=0}if(o._lastOffsetY===undefined){o._lastOffsetY=0}var j;(function l(){var e=n.x,a=n.y,d,b;if(e||a){b=(o._lastOffsetX+=1)%e;d=(o._lastOffsetY+=1)%e;if(o.paper.raphael.type==="SVG"){if(e){h.setAttribute("x",b)}if(a){h.setAttribute("y",d)}}else{if(h.origin){if(e){h.origin.x=(1-(b/e))}if(a){h.origin.y=(1-(d/a))}}}if(!this._ticker){j=setTimeout(l,m/e)}}})();this._ticker=j},_animatePulsation:function(){var b=this.get("innerProgressBar");if(this._pulseOpacity==1){this._pulseOpacity=0.85}else{this._pulseOpacity=1}b.animate({opacity:this._pulseOpacity},1000,"swing");this.invokeLater(this._animatePulsation,1000)}});CW.SpinnerView=SC.View.extend({imageURL:"/applications/designer/5410/coreweb/views/5410/en-us/source/resources/images/loading.png",size:32,render:function(d,e,f){e.addStyle("display","flex");e.push('<image src="'+this.imageURL+'" class="animate-spin" style="margin: auto; width:'+this.size+"px; height:"+this.size+'px;"></image>')}.enhance()});SC.stringsFor("en-us",{"SC.Date.Era.AD.Abbreviated":"AD","SC.Date.Era.AD.Full":"Anno Domini","SC.Date.Era.AD.Letter":"A","SC.Date.Era.BC.Abbreviated":"BC","SC.Date.Era.BC.Full":"Before Christ","SC.Date.Era.BC.Letter":"B","SC.Date.Quarter.Q1.Abbreviated":"Q1","SC.Date.Quarter.Q1.Full":"1st quarter","SC.Date.Quarter.StandAlone.Q1.Abbreviated":"Q1","SC.Date.Quarter.StandAlone.Q1.Full":"1st Quarter","SC.Date.Quarter.Q2.Abbreviated":"Q2","SC.Date.Quarter.Q2.Full":"2nd quarter","SC.Date.Quarter.StandAlone.Q2.Abbreviated":"Q2","SC.Date.Quarter.StandAlone.Q2.Full":"2nd Quarter","SC.Date.Quarter.Q3.Abbreviated":"Q3","SC.Date.Quarter.Q3.Full":"3rd quarter","SC.Date.Quarter.StandAlone.Q3.Abbreviated":"Q3","SC.Date.Quarter.StandAlone.Q3.Full":"3rd Quarter","SC.Date.Quarter.Q4.Abbreviated":"Q4","SC.Date.Quarter.Q4.Full":"4th quarter","SC.Date.Quarter.StandAlone.Q4.Abbreviated":"Q4","SC.Date.Quarter.StandAlone.Q4.Full":"4th Quarter","SC.Date.Month.January.Abbreviated":"Jan","SC.Date.Month.January.Full":"January","SC.Date.Month.January.Letter":"J","SC.Date.Month.StandAlone.January.Abbreviated":"Jan","SC.Date.Month.StandAlone.January.Full":"January","SC.Date.Month.StandAlone.January.Letter":"J","SC.Date.Month.Prepositional.January.Abbreviated":"Jan","SC.Date.Month.Prepositional.January.Full":"January","SC.Date.Month.Prepositional.January.Letter":"J","SC.Date.Month.February.Abbreviated":"Feb","SC.Date.Month.February.Full":"February","SC.Date.Month.February.Letter":"F","SC.Date.Month.StandAlone.February.Abbreviated":"Feb","SC.Date.Month.StandAlone.February.Full":"February","SC.Date.Month.StandAlone.February.Letter":"F","SC.Date.Month.Prepositional.February.Abbreviated":"Feb","SC.Date.Month.Prepositional.February.Full":"February","SC.Date.Month.Prepositional.February.Letter":"F","SC.Date.Month.March.Abbreviated":"Mar","SC.Date.Month.March.Full":"March","SC.Date.Month.March.Letter":"M","SC.Date.Month.StandAlone.March.Abbreviated":"Mar","SC.Date.Month.StandAlone.March.Full":"March","SC.Date.Month.StandAlone.March.Letter":"M","SC.Date.Month.Prepositional.March.Abbreviated":"Mar","SC.Date.Month.Prepositional.March.Full":"March","SC.Date.Month.Prepositional.March.Letter":"M","SC.Date.Month.April.Abbreviated":"Apr","SC.Date.Month.April.Full":"April","SC.Date.Month.April.Letter":"A","SC.Date.Month.StandAlone.April.Abbreviated":"Apr","SC.Date.Month.StandAlone.April.Full":"April","SC.Date.Month.StandAlone.April.Letter":"A","SC.Date.Month.Prepositional.April.Abbreviated":"Apr","SC.Date.Month.Prepositional.April.Full":"April","SC.Date.Month.Prepositional.April.Letter":"A","SC.Date.Month.May.Abbreviated":"May","SC.Date.Month.May.Full":"May","SC.Date.Month.May.Letter":"M","SC.Date.Month.StandAlone.May.Abbreviated":"May","SC.Date.Month.StandAlone.May.Full":"May","SC.Date.Month.StandAlone.May.Letter":"M","SC.Date.Month.Prepositional.May.Abbreviated":"May","SC.Date.Month.Prepositional.May.Full":"May","SC.Date.Month.Prepositional.May.Letter":"M","SC.Date.Month.June.Abbreviated":"Jun","SC.Date.Month.June.Full":"June","SC.Date.Month.June.Letter":"J","SC.Date.Month.StandAlone.June.Abbreviated":"Jun","SC.Date.Month.StandAlone.June.Full":"June","SC.Date.Month.StandAlone.June.Letter":"J","SC.Date.Month.Prepositional.June.Abbreviated":"Jun","SC.Date.Month.Prepositional.June.Full":"June","SC.Date.Month.Prepositional.June.Letter":"J","SC.Date.Month.July.Abbreviated":"Jul","SC.Date.Month.July.Full":"July","SC.Date.Month.July.Letter":"J","SC.Date.Month.StandAlone.July.Abbreviated":"Jul","SC.Date.Month.StandAlone.July.Full":"July","SC.Date.Month.StandAlone.July.Letter":"J","SC.Date.Month.Prepositional.July.Abbreviated":"Jul","SC.Date.Month.Prepositional.July.Full":"July","SC.Date.Month.Prepositional.July.Letter":"J","SC.Date.Month.August.Abbreviated":"Aug","SC.Date.Month.August.Full":"August","SC.Date.Month.August.Letter":"A","SC.Date.Month.StandAlone.August.Abbreviated":"Aug","SC.Date.Month.StandAlone.August.Full":"August","SC.Date.Month.StandAlone.August.Letter":"A","SC.Date.Month.Prepositional.August.Abbreviated":"Aug","SC.Date.Month.Prepositional.August.Full":"August","SC.Date.Month.Prepositional.August.Letter":"A","SC.Date.Month.September.Abbreviated":"Sep","SC.Date.Month.September.Full":"September","SC.Date.Month.September.Letter":"S","SC.Date.Month.StandAlone.September.Abbreviated":"Sep","SC.Date.Month.StandAlone.September.Full":"September","SC.Date.Month.StandAlone.September.Letter":"S","SC.Date.Month.Prepositional.September.Abbreviated":"Sep","SC.Date.Month.Prepositional.September.Full":"September","SC.Date.Month.Prepositional.September.Letter":"S","SC.Date.Month.October.Abbreviated":"Oct","SC.Date.Month.October.Full":"October","SC.Date.Month.October.Letter":"O","SC.Date.Month.StandAlone.October.Abbreviated":"Oct","SC.Date.Month.StandAlone.October.Full":"October","SC.Date.Month.StandAlone.October.Letter":"O","SC.Date.Month.Prepositional.October.Abbreviated":"Oct","SC.Date.Month.Prepositional.October.Full":"October","SC.Date.Month.Prepositional.October.Letter":"O","SC.Date.Month.November.Abbreviated":"Nov","SC.Date.Month.November.Full":"November","SC.Date.Month.November.Letter":"N","SC.Date.Month.StandAlone.November.Abbreviated":"Nov","SC.Date.Month.StandAlone.November.Full":"November","SC.Date.Month.StandAlone.November.Letter":"N","SC.Date.Month.Prepositional.November.Abbreviated":"Nov","SC.Date.Month.Prepositional.November.Full":"November","SC.Date.Month.Prepositional.November.Letter":"N","SC.Date.Month.December.Abbreviated":"Dec","SC.Date.Month.December.Full":"December","SC.Date.Month.December.Letter":"D","SC.Date.Month.StandAlone.December.Abbreviated":"Dec","SC.Date.Month.StandAlone.December.Full":"December","SC.Date.Month.StandAlone.December.Letter":"D","SC.Date.Month.Prepositional.December.Abbreviated":"Dec","SC.Date.Month.Prepositional.December.Full":"December","SC.Date.Month.Prepositional.December.Letter":"D","SC.Date.Day.Monday.Abbreviated":"Mon","SC.Date.Day.Monday.Full":"Monday","SC.Date.Day.Monday.Letter":"M","SC.Date.Day.StandAlone.Monday.Abbreviated":"Mon","SC.Date.Day.StandAlone.Monday.Full":"Monday","SC.Date.Day.StandAlone.Monday.Letter":"M","SC.Date.Day.Tuesday.Abbreviated":"Tue","SC.Date.Day.Tuesday.Full":"Tuesday","SC.Date.Day.Tuesday.Letter":"T","SC.Date.Day.StandAlone.Tuesday.Abbreviated":"Tue","SC.Date.Day.StandAlone.Tuesday.Full":"Tuesday","SC.Date.Day.StandAlone.Tuesday.Letter":"T","SC.Date.Day.Wednesday.Abbreviated":"Wed","SC.Date.Day.Wednesday.Full":"Wednesday","SC.Date.Day.Wednesday.Letter":"W","SC.Date.Day.StandAlone.Wednesday.Abbreviated":"Wed","SC.Date.Day.StandAlone.Wednesday.Full":"Wednesday","SC.Date.Day.StandAlone.Wednesday.Letter":"W","SC.Date.Day.Thursday.Abbreviated":"Thu","SC.Date.Day.Thursday.Full":"Thursday","SC.Date.Day.Thursday.Letter":"R","SC.Date.Day.StandAlone.Thursday.Abbreviated":"Thu","SC.Date.Day.StandAlone.Thursday.Full":"Thursday","SC.Date.Day.StandAlone.Thursday.Letter":"R","SC.Date.Day.Friday.Abbreviated":"Fri","SC.Date.Day.Friday.Full":"Friday","SC.Date.Day.Friday.Letter":"F","SC.Date.Day.StandAlone.Friday.Abbreviated":"Fri","SC.Date.Day.StandAlone.Friday.Full":"Friday","SC.Date.Day.StandAlone.Friday.Letter":"F","SC.Date.Day.Saturday.Abbreviated":"Sat","SC.Date.Day.Saturday.Full":"Saturday","SC.Date.Day.Saturday.Letter":"S","SC.Date.Day.StandAlone.Saturday.Abbreviated":"Sat","SC.Date.Day.StandAlone.Saturday.Full":"Saturday","SC.Date.Day.StandAlone.Saturday.Letter":"S","SC.Date.Day.Sunday.Abbreviated":"Sun","SC.Date.Day.Sunday.Full":"Sunday","SC.Date.Day.Sunday.Letter":"S","SC.Date.Day.StandAlone.Sunday.Abbreviated":"Sun","SC.Date.Day.StandAlone.Sunday.Full":"Sunday","SC.Date.Day.StandAlone.Sunday.Letter":"S","SC.Date.Period.AM":"AM","SC.Date.Period.PM":"PM","MonthCalendar.MonthYear.Long.Format":"%{date:LLLL} %{date:yyyy}","MonthCalendar.MonthYear.Short.Format":"%{date:LLL} %{date:yyyy}",});CW.DateFormatter=function(d,a){var f=d.dateObject(),b=new Date(f.getTime());return f._isUsingUTC&&b.setMinutes(b.getMinutes()+b.getTimezoneOffset()),SC.DateFormatter(b,a)};CW.ViewController=SC.Responder.extend({isViewController:YES,view:null});CW.SectionedViewDataSource={isSectionedViewDataSource:YES,numberOfSectionsInSectionedView:function(b){return 0},sectionedViewSectionIsVisible:function(e,d){return YES},sectionedViewNumberOfRowsInSection:function(e,d){return 0},sectionedViewTitleForHeaderInSection:function(e,d){return undefined},sectionedViewTitleForFooterInSection:function(e,d){return undefined},sectionedViewCellForRowAtIndexPath:function(e,d){return undefined},sectionedViewContentForRowAtIndexPath:function(e,d){return undefined}};CW.SectionedViewDelegate={isSectionedViewDelegate:YES,sectionedViewHeightForRowAtIndexPath:function(e,d){return undefined},sectionedViewAccessoryButtonTappedForRowAtIndexPath:function(e,d){},sectionedViewWillSelectRowAtIndexPath:function(e,d){return d},sectionedViewDidSelectRowAtIndexPath:function(e,d){},sectionedViewWillDeselectRowAtIndexPath:function(e,d){return d},sectionedViewDidDeselectRowAtIndexPath:function(e,d){},sectionedViewViewForHeaderInSection:function(e,d){return undefined},sectionedViewViewForFooterInSection:function(e,d){return undefined},sectionedViewHeightForHeaderInSection:function(e,d){return undefined},sectionedViewHeightForFooterInSection:function(e,d){return undefined},sectionedViewShouldAutoResizeHeaderTitleInSection:function(e,d){return undefined},sectionedViewShouldAutoResizeFooterTitleInSection:function(e,d){return undefined},sectionedViewCellDisplayDelegateForRowAtIndexPath:function(e,d){return e},sectionedViewWillSetupAllCells:function(b){},sectionedViewDidSetupAllCells:function(b){},sectionedViewWillTearDownAllCells:function(b){},sectionedViewDidTearDownAllCells:function(b){}};sc_require("controllers/view_controller");sc_require("sectioned_view/mixins/sectioned_view_data_source");sc_require("sectioned_view/mixins/sectioned_view_delegate");CW.SectionedViewController=CW.ViewController.extend(CW.SectionedViewDataSource,CW.SectionedViewDelegate,{});CW.ProxyDisplay={concatenatedProperties:"proxyDisplayProperties".w(),proxyDisplayProperties:[],displayDelegateKey:"displayDelegate",initMixin:function(){this._cwps_computedDisplayProxyProperties=[];this._cwps_computedProxyPropertyToPropertyMap={};this._cwps_contentKeys=[];this._cwps_contentKeyToComputedProxyPropertyMap={};this._cwps_computedProxyPropertyToContentKeyMap={};var b=this.get("proxyDisplayProperties");this._cwps_addContentKeyComputedDisplayProxyPropertyMapping(b);this._cwps_addComputedDisplayProxyProperties(b);this._cwps_setupContentPropertiesObserving();this._cwps_propertiesDidChange(this,"*")},destroyMixin:function(){this._cwps_tearDownContentPropertiesObserving()},computedDisplayProxyPropertyKey:function(b){return"display%@".fmt(b.classify())},_cwps_computedContentKey:function(f){var h="content%@Key".fmt(f.classify()),k=this.get(h);if(SC.none(k)){var j=this.get("displayDelegateKey"),g=j?this.get(j):null;k=g?g.get(h):null}return SC.none(k)?f:k},contentPropertyValueForComputedDisplayProxyProperty:function(g){var f=this.get("content"),e=this._cwps_computedProxyPropertyToContentKeyMap;if(!f||!e){return undefined}var h=e[g];return f.get(h)},contentPropertyValueForProxiedProperty:function(f){var e=this.get("content");if(!e){return undefined}var d=this._cwps_computedContentKey(f);return e.get(d)},computedDisplayProxyPropertyValue:function(g){var e=this.contentPropertyValueForComputedDisplayProxyProperty(g),h=this._cwps_computedProxyPropertyToPropertyMap;if(!SC.none(e)){return e}if(!h){return undefined}var f=h[g];return this.get(f)},addProxyDisplayProperty:function(b){this.addProxyDisplayProperties([b])},addProxyDisplayProperties:function(e){this._cwps_addContentKeyComputedDisplayProxyPropertyMapping(e);this._cwps_addComputedDisplayProxyProperties(e);var d=this.get("proxyDisplayProperties");this.set("proxyDisplayProperties",d.concat(e));e.forEach(function(a){this._cwps_propertiesDidChange(this,a)},this)},_cwps_addComputedDisplayProxyProperties:function(h){var f=this._cwps_computedDisplayProxyProperties,e=this._cwps_computedProxyPropertyToPropertyMap;h.forEach(function(a){if(a==="content"){throw"Can not proxy the content property"}var d=this.computedDisplayProxyPropertyKey(a),b=this[d];if(b===undefined){this[d]=null;f.push(d);e[d]=a}else{if(SC.typeOf(b)===SC.T_FUNCTION&&b.isProperty){f.push(d)}else{throw"'%@' is already defined. Can not proxy property '%@'".fmt(d,a)}}},this);var g=this.get("displayProperties");g=g.concat(f);this.set("displayProperties",g)},_cwps_addContentKeyComputedDisplayProxyPropertyMapping:function(e){var f=this._cwps_contentKeys,g=this._cwps_contentKeyToComputedProxyPropertyMap,h=this._cwps_computedProxyPropertyToContentKeyMap;e.forEach(function(a){var b=this._cwps_computedContentKey(a),d=this.computedDisplayProxyPropertyKey(a);f.push(b);g[b]=d;h[d]=b},this)},_cwps_contentDidChange:function(){this._cwps_tearDownContentPropertiesObserving();this._cwps_setupContentPropertiesObserving();this._cwps_contentPropertiesDidChange(this,"*")}.observes("content"),_cwps_setupContentPropertiesObserving:function(){var b=this.get("content");this._cwps_content=b;if(!b){return}b.addObserver("*",this,"_cwps_contentPropertiesDidChange")},_cwps_tearDownContentPropertiesObserving:function(){var b=this._cwps_content;this._cwps_content=null;if(!b){return}b.removeObserver("*",this,"_cwps_contentPropertiesDidChange")},_cwps_propertiesDidChange:function(h,e){var f=this.get("proxyDisplayProperties")||[],g=null;if(e==="*"){g=f}else{if(f.indexOf(e)>=0){g=[e]}}if(!g){return}this.beginPropertyChanges();g.forEach(function(b){var a=this.computedDisplayProxyPropertyKey(b);this._cwps_notifyComputedDisplayProxyPropertyChanged(a)},this);this.endPropertyChanges();this.displayDidChange()}.observes("*"),_cwps_contentPropertiesDidChange:function(k,f){var h=this.get("content"),g=this._cwps_contentKeys||[],j=null;if(f==="*"){j=g}else{if(g.indexOf(f)>=0){j=[f]}}if(!j){return}this.beginPropertyChanges();j.forEach(function(b){var a=this._cwps_contentKeyToComputedProxyPropertyMap[b];this._cwps_notifyComputedDisplayProxyPropertyChanged(a)},this);this.endPropertyChanges();this.displayDidChange()},_cwps_notifyComputedDisplayProxyPropertyChanged:function(e){var f=this.get(e);if(SC.typeOf(f)===SC.T_FUNCTION&&f.isProperty){this.notifyPropertyChange(e)}else{var d=this.computedDisplayProxyPropertyValue(e);this.set(e,d!==undefined?d:null)}}};CW.BAR_OPACITY_DURATION=200;CW.BAR_LEFT_DURATION=350;CW.VIEW_LEFT_DURATION=350;CW.NAVIGATABLE_VIEW_PADDING=0;CW.NavigationController=SC.ObjectController.extend({layout:{top:0,left:0,right:0,bottom:0},viewStack:null,barStack:null,navigationView:null,previousNavigatableView:function(){var b=this.get("viewStack");return b[b.length-2]||null},currentNavigatableView:function(){var b=this.get("viewStack");return b[b.length-1]||null},init:function(){this.viewStack=[];this.barStack=[];this.navigationViewDidChange()},clearStacks:function(){this.get("viewStack").forEach(function(a){a.removeFromParent();a.destroy()});this.get("barStack").forEach(function(a){a.removeFromParent();a.destroy()});this.viewStack=[];this.barStack=[]},navigationViewDidChange:function(){this.clearStacks();var e=this.get("navigationView"),d=this.get("_oldNavigationView");if(e!==d){if(d){d.removeObserver("frame",this,this.navigationViewFrameDidChange)}if(e){e.addObserver("frame",this,this.navigationViewFrameDidChange);this.set("_oldNavigationView",e)}}}.observes("navigationView"),navigationViewFrameDidChange:function(){var k,h=this.getPath("navigationView.frame.width"),f=this.viewStack;for(var j=0,g=f.length;j<g;++j){k=f[j];k.adjust("width",h);this.barStack[j].adjust("width",h)}},push:function(t,s,n){if(s===undefined){s=YES}if(SC.browser.isAndroid){s=NO}if(!t.isNavigatable){SC.error("Tried to push a view which doesn't mix-in the CW.NavigationSupport mixin.")}var u=this.get("viewStack"),m=this.get("barStack"),l=-1*this.getPath("navigationView.frame").width,o=u[u.length-1],p=m[m.length-1];this._pushViewAndBarToStack(t,YES);this.getPath("navigationView.pane").makeFirstResponder(t);var q=u[u.length-1],v=m[m.length-1];this._moveBarAndViewTo(q,v,s,0,1,NO);if(o){this._moveBarAndViewTo(o,p,s,l,0,NO,n)}},pop:function(x,o,s){var C=this.getPath("navigationView.pane");if(!C){return}if(x===undefined){x=YES}if(SC.browser.isAndroid){x=NO}if(o===undefined){o=1}var A=this.get("viewStack"),q=this.get("barStack"),u=A.pop(),B=q.pop(),p,y,t,v,z;for(var w=0;w<o-1;w++){p=A.pop();y=q.pop();p.removeFromParent();y.removeFromParent()}t=A[A.length-1];v=q[q.length-1];z=this.get("navigationView").get("frame").width;C.makeFirstResponder(t);if(o>1){t.adjust({left:-1*z});v.adjust({left:-1*z})}this._moveBarAndViewTo(u,B,x,z,0,YES,undefined,YES);if(t){this._moveBarAndViewTo(t,v,x,0,1,NO,s)}},hidePreviousView:function(){var a=this.previousNavigatableView();if(a){this.invokeLast(function(){a.adjust({opacity:0})})}},showCurrentView:function(){var a=this.currentNavigatableView();if(a){a.adjust({opacity:1})}},_moveBarAndViewTo:function(s,v,z,x,y,p,w,E){CW.testController=this;CW.testView=s;var A=this.get("navigationView"),q=1,t=s.get("frame").x;var F=this;if(E){this.showCurrentView()}if(z){s.adjust({left:t,height:A.get("frame").height-v.get("frame").height,bottom:null});v.adjust({left:t,opacity:q});s.set("wantsAcceleratedLayer",YES);v.set("wantsAcceleratedLayer",YES);var u=Math.max(CW.VIEW_LEFT_DURATION,CW.BAR_LEFT_DURATION,CW.BAR_OPACITY_DURATION);var C=A.$();if(C.find(".overlay").size()===0){var D="position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px; z-index: 1000;";C.append("<div class='overlay' style='%@'></div>".fmt(D))}var B=CW.Animation.create({view:s,bar:v,navigationView:A,tween:CW.Anim.tweens.WEBKIT_EASE_IN_OUT,viewLayer:s.get("layer"),barLayer:v.get("layer"),toLeft:x,fromLeft:t,toOpacity:y,fromOpacity:q,duration:u,name:SC.guidFor(this)+":navigationAnimation:"+SC.guidFor(s),update:function(){var f=this.current;var a=Math.round(this.fromLeft+(this.toLeft-this.fromLeft)*Math.min(1,Math.max(0,f*(this.duration/CW.VIEW_LEFT_DURATION))));var b=Math.round(this.fromLeft+(this.toLeft-this.fromLeft)*Math.min(1,Math.max(0,f*(this.duration/CW.BAR_LEFT_DURATION))));var g=this.fromOpacity+(this.toOpacity-this.fromOpacity)*Math.min(1,Math.max(0,f*(this.duration/CW.BAR_OPACITY_DURATION)));if(!this.viewLayer||!this.barLayer){this.viewLayer=this.view.get("layer");this.barLayer=this.bar.get("layer")}if(this.viewLayer&&this.barLayer){var d=this.viewLayer.style,e=this.barLayer.style;if(SC.platform.supportsCSS3DTransforms){d.width=this.view.get("frame").width;d.webkitTransform="translate3d("+a+"px,0,0)";e.webkitTransform="translate3d("+b+"px,0,0)"}else{d.left=a+"px";e.left=b+"px"}}},cleanUp:function(){if(p){this.view.removeFromParent();this.bar.removeFromParent();this.bar.destroy()}else{this.view.adjust({left:x});this.bar.adjust({left:x,opacity:y})}this.view.adjust({height:null,bottom:0});var a=this.navigationView.$();var b=a.find(".overlay");b.remove();if(w){w()}F.hidePreviousView()}.listens("finish")});setTimeout(function(){B.start()},100)}else{s.adjust({left:x});v.adjust({left:x,opacity:y});F.hidePreviousView();if(p){if(s){s.removeFromParent()}if(v){v.removeFromParent();v.destroy()}}}},_pushViewAndBarToStack:function(m,k){var p=this.get("navigationView"),q=p.createChildView(CW.NavigationBarView),n=p.get("frame").width,o=p.get("frame").height,j=(((k)?1:-1)*n)+CW.NAVIGATABLE_VIEW_PADDING,l=p.get("navigationBarHeight");m.set("navigationController",this);m.set("layout",{top:0,bottom:0,left:j,width:n});q.set("layout",{top:0,left:j/2,width:n,height:l});q.set("navigationController",this);q.set("associatedView",m);p.appendChild(q);p.get("well").appendChild(m);this.get("viewStack").push(m);this.get("barStack").push(q)}});CW.iOScallout=SC.PickerPane.extend(CW.Animatability,CW.PaneFadingSupport,{renderDelegateName:"iOSCalloutRenderDelegate",themeName:"iOS",preferMatrix:[2,2,2,2,2],layout:{height:43,width:215,minWidth:150},classNames:["iOSCallout"],titleValue:"Callout title",detailValue:"Callout detail",escapeTitle:YES,escapeDetail:YES,target:"",action:"",preferType:SC.PICKER_POINTER,acceptsKeyPane:NO,isInfoButtonRequired:YES,acceptsFirstResponder:NO,isModal:NO,repositionOnWindowResize:NO,pointerOffset:[0,0,0,0],contentView:SC.View.extend({childViews:["title","detail","button"],title:SC.LabelView.extend({layout:{top:0,height:25,left:9,right:35},classNames:"title",escapeHTMLBinding:"*parentView.parentView.escapeTitle",valueBinding:"*parentView.parentView.titleValue"}),detail:SC.LabelView.extend({layout:{top:24,left:9,height:15},classNames:"detail",escapeHTMLBinding:"*parentView.parentView.escapeDetail",valueBinding:"*parentView.parentView.detailValue"}),button:SC.ImageButtonView.extend({layout:{top:7,height:30,right:5,width:30},image:"info_button",isVisibleBinding:"*parentView.parentView.isInfoButtonRequired",targetBinding:"*parentView.parentView.target",actionBinding:"*parentView.parentView.action"})}),didCreateLayer:function(){this.invokeLater(this.recomputeLayout,0)},recomputeLayout:function(){var l=this.$(".title")[0],g=this.$(".detail")[0],h=55;if(!this.get("isInfoButtonRequired")){h=20;this.getPath("contentView.title").adjust({right:9})}if(SC.none(l)||SC.none(g)){return}var j=SC.metricsForString(this.get("titleValue"),l,null,NO),m=SC.metricsForString(this.get("detailValue"),g,null,NO),k=(j.width>m.width?j.width:m.width)+h;k=(k%2?k-1:k);k=Math.max(k,150);this.adjust({width:k});this.positionPane()},showCalloutInContainer:function(b){this._hideOverflow();this.appendTo(b)},valuesObserver:function(){this.recomputeLayout()}.observes("detailValue","titleValue","layer"),modalPaneDidClick:function(){return NO}});CW.NOTIFICATION_AUTOMATICALLY_DISMISS_DELAY=8000;CW.iOSNotification=SC.PanelPane.extend(CW.SpritePreloadEnforcement).extend({acceptsKeyPane:NO,isIOSNotification:YES,hasBeenSeen:NO,isDismissable:YES,automaticallyDismiss:YES,icon:undefined,iconWidth:35,iconHeight:35,iconInset:9,message:undefined,description:undefined,shouldAdornEndingDescriptionLinkWithArrow:YES,dismiss:function(){this.remove();this.didDismiss(this)},didDismiss:function(){},action:function(){},hiddenState:function(){return{top:-this.get("frame").height-31}}.property(),showingState:{top:1},MAX_WIDTH:CW.isMobile()?300:1093,MIN_WIDTH:CW.isMobile()?300:500,MIN_HEIGHT:48,maxWidth:Infinity,minimumSideClearance:100,layout:{centerX:0},isModal:NO,classNames:"ios-notification animated slideInDown".w(),windowResized:function(){var h=this.get("currentWindowSize"),f,e;if(!h||!h.width){return}try{f=SteedOS.MIN_WIDTH}catch(g){f=950}e=Math.max(f,h.width);this.set("maxWidth",Math.max(this.MIN_WIDTH,Math.min(e-this.get("minimumSideClearance")*2,this.MAX_WIDTH)))}.observes("currentWindowSize","minimumSideClearance"),_hideMask:function(){CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._mask,to:0,duration:100}).start()},_showMask:function(){CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._mask,to:0.4,duration:100}).start()},mouseDown:function(b){if(!this._mask){return NO}this._isClicked=YES;this._showMask();return YES},mouseUp:function(e){if(!this._mask){return}this._isClicked=NO;this._hideMask();var f=this.get("frame"),d=this.convertFrameFromView({x:e.pageX,y:e.pageY});if(!f||d.x<0||d.y<0||d.x>f.width||d.y>f.height){return}if(this._icon){CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._icon,to:0,duration:200}).start();CW.Anim.Fader.create(CW.Anim.DisplayNoneAtZero,{element:this._spinner,to:1,duration:200}).start()}this.get("action")(this)},mouseEntered:function(b){if(!this._isClicked){return}this._showMask();return YES},mouseExited:function(b){if(!this._isClicked){return}this._hideMask();return YES},render:function(f){window.iosnotification=this;for(var g=0,h="";g<9;g++){h+='<div class="'+SC.NINE_SLICE[g]+'"></div>'}f.push('<div class="shadow" aria-hidden=true>'+h+"</div>");f.push('<div class="background" aria-hidden=true>'+h+"</div>");var j=this.get("message"),k=this._adornStringWithArrowIfNeeded(this._lastDesc=this.get("description"));this._lastMess=j;f.push('<img class="spinner">');f.push('<div class="message">'+j+"</div>");f.push('<div class="description">'+k+"</div>");if(this.get("action")){f.push('<div class="mask" aria-hidden=true>'+h+"</div>")}this.adjust("zIndex",this.get("isDismissable")?CW.iOSNotification.runningDismissableZIndex++:CW.iOSNotification.runningNonDismissableZIndex++)},displayProperties:"message description icon maxWidth".w(),update:function(){var f,d,e;if(this._lastMess!==(this._lastMess=f=this.get("message"))){this.$(".message")[0].innerHTML=f}if(this._lastDesc!==(this._lastDesc=d=this.get("description"))){this.$(".description")[0].innerHTML=this._adornStringWithArrowIfNeeded(d);e=YES}if(this.didChangeFor("update","maxWidth")){e=YES}if(e){this.invokeLast("finishLayerDependentRendering")}},didCreateLayer:function(){this._mask=this.$(".mask")[0];this._spinner=this.$(".spinner")[0];if(this._mask){CW.Anim.setOpacity(this._mask,0)}if(this._spinner){CW.Anim.setOpacity(this._spinner,0)}this.$(".description")[0].cacheableForMetrics=YES;this.windowResized();if(this.get("automaticallyDismiss")){this.invokeLater(function(){if(this.get("automaticallyDismiss")){this.dismiss()}},CW.NOTIFICATION_AUTOMATICALLY_DISMISS_DELAY)}},finishLayerDependentRendering:function(){var m=this.get("frame"),n=this.get("layer"),l,q=this.get("icon"),t,s,f,p;if(this._lastIconInput!==(this._lastIconInput=q)){if((l=this._icon)&&l.parentNode){l.parentNode.removeChild(l)}this._icon=null}if(!(l=this._icon)){if(typeof q==="string"&&q.indexOf("/")!==-1){l=new Image();this._icon=l;l.src=q;var o="z-index:3; position:absolute; left:"+this.get("iconInset")+"px; width:"+this.get("iconWidth")+"px; height:"+(f=this.get("iconHeight"))+"px; margin-top:-"+Math.floor(f/2)+"px; top:50%;";l.style.cssText=o;l.setAttribute("aria-hidden",true);n.appendChild(l)}else{if(q){if(typeof q==="string"){l=document.createElement("div");l.className=q;this._icon=l}t=(this._icon||(this._icon=l=q)).style;t.position="absolute";t.left=this.get("iconInset")+"px";t.top="50%";t.zIndex="3";l.setAttribute("aria-hidden",true);n.appendChild(l);this.invokeOnce(function(){var a,b;this.set("iconWidth",a=parseInt(jQuery(l).css("width"),0)||this.get("iconWidth"));this.set("iconHeight",b=parseInt(jQuery(l).css("height"),0)||this.get("iconHeight"));t.marginTop=-Math.ceil(b/2)+"px"})}else{if(this.get("iconWidth")){this.set("iconWidth",s=0)}if(this.get("iconHeight")){this.set("iconHeight",f=0)}if((p=this._separator)){if(p.parentNode){p.parentNode.removeChild(p)}this._separator=undefined}}}}this.invokeOnce(function(){if(this._icon&&!(p=this._separator)){p=document.createElement("div");p.style.cssText="position:absolute; left:"+(this.get("iconInset")*2+this.get("iconWidth"))+"px; top:0px; width:1px; bottom:0px; z-index:4; background:black;";this._separator=p;CW.Anim.setOpacity(p,0.12);p.setAttribute("aria-hidden",true);n.appendChild(p)}});this.invokeOnce("sizeToText")},sizeToText:function(){var y,w=29,n,p,v=19,u=0,z=0,s=0,x=0,q=0,t=6;y=2+((!!this.get("icon"))*2+1)*this.get("iconInset")+this.get("iconWidth");if((n=this._message||(this._message=this.$(".message")[0]))){n.style.left=y+"px";u=SC.bestStringMetricsForMaxWidth(n.innerHTML,this.get("maxWidth")-y-w,n,undefined,true);z=u.height;n.style.height=z+"px";u=u.width}if((p=this._description||(this._description=this.$(".description")[0]))){p.style.left=y+"px";s=SC.bestStringMetricsForMaxWidth(p.innerHTML,this.get("maxWidth")-y-w,p,undefined,true);x=s.height;s=s.width;q=(z||-1)+8+2*!!SC.browser.mozilla;p.style.top=q+"px";p.style.height=x+"px"}var o=Math.max(this.MIN_HEIGHT,t+q+x);if(this.get("iconHeight")){o=Math.round(o/2)*2+(this.get("iconHeight")%2!==0)}this.adjust({width:Math.max(this.MIN_WIDTH,y+w+s,y+w+u),height:o})},animateShow:function(){var d=CW.PaneAnimationSupport.animateShow,e=arguments;this.invokeLast(function(){d.apply(this,e)})},contentView:SC.ImageButtonView.design({classNames:"dismiss".w(),init:function(){this.set("toolTip","Button.Close".loc());arguments.callee.base.apply(this,arguments)},layout:{width:16,height:16,right:6,centerY:0},action:"dismiss"}),append:function(){this.set("hasBeenSeen",YES);this._isAppended=YES;return this.appendTo(this.get("parentElement")||CW.iOSNotification.defaultParentElement||document.body)},remove:function(){var b=arguments.callee.base.apply(this,arguments);this._isAppended=NO;CW.iOSNotification.notificationWasRemoved(this);return b},replaceWith:function(b){CW.iOSNotification.replaceNotificationWithNotification(this,b)},init:function(){if(!this.get("isDismissable")){this.contentView=null}arguments.callee.base.apply(this,arguments)},_adornStringWithArrowIfNeeded:function(b){if(!this.get("shouldAdornEndingDescriptionLinkWithArrow")){return b}if(!b){return""}if(b.substring(b.length-4)==="</a>"){b=b.substring(0,b.length-4)+'<div class="ios-notification-link-arrow"></div></a>'}if(b.substring(b.length-5)==="</a>."){b=b.substring(0,b.length-5)+'.<div class="ios-notification-link-arrow"></div></a>'}return b}});SC.mixin(CW.iOSNotification,{runningDismissableZIndex:2000,runningNonDismissableZIndex:1000,show:SC.RunLoop.wrapFunction(function(d){var e=d.isIOSNotification?d:this._simpleCreate.apply(this,arguments);e.append();return e}),queue:[],enqueue:function(d){var e=d.isIOSNotification?d:this._simpleCreate.apply(this,arguments);e._isInQueue=YES;this.queue.unshift(e);this.updateToQueue();return e},updateToQueue:SC.RunLoop.wrapFunction(function(){var e=this.queue;if(!e.length){return}var d=e[e.length-1];if(!d._isAppended){d.append()}}),notificationWasRemoved:function(f){if(this._ignoreRemovals){return}for(var d=0,e=this.queue;this.queue[d];d++){if(e[d]===f){e.splice(d,1)}}this.updateToQueue()},replaceNotificationWithNotification:function(f,k){for(var j=0,g=this.queue,h;h=g[j];j++){if(h===f){g[j]=k;if(j===g.length-1){this._ignoreRemovals=YES;f.remove();this._ignoreRemovals=NO;k.append()}break}}},_simpleCreate:function(j,k,l,m,h){var g;if(typeof j==="object"){(g=this.create.apply(this,arguments))}else{(g=this.create({message:j,description:k,icon:l,isDismissable:!(m===NO),parentElement:h}))}return g}});CW.TOP_SLICES=["middle","top-left","top one","top two","top-right"];CW.BOTTOM_SLICES=["bottom-left","bottom one","bottom two","bottom-right"];SC.BaseTheme.iOSPickerRenderDelegate=SC.RenderDelegate.create({className:"ios_picker",render:function(l,q){var m=l.get("pointerPos"),o=l.get("pointerPosY"),k=l.get("ariaLabel"),n=l._view.get("layout"),j,p;q=q.begin("div").addClass("panel-background");this.includeSlices(l,q,CW.TOP_SLICES);j=o+8;p=n.height-o-36;if(m==="perfectLeft"){q.push('<div class="left one"></div>');q.push('<div class="left two"></div>');q.push('<div class="right one" style="margin-top: '+j+'px"></div>');q.push('<div class="right two" style="display: block; margin-bottom: '+p+'px"></div>')}else{if(m==="perfectRight"){q.push('<div class="left one" style="margin-top: '+j+'px"></div>');q.push('<div class="left two" style="display: block; margin-bottom: '+p+'px"></div>');q.push('<div class="right one"></div>');q.push('<div class="right two"></div>')}else{q.push('<div class="left one"></div>');q.push('<div class="left two"></div>');q.push('<div class="right one"></div>');q.push('<div class="right two"></div>')}}this.includeSlices(l,q,CW.BOTTOM_SLICES);q.addClass(m);if(m==="perfectLeft"||m==="perfectRight"){q.push('<div class="sc-pointer" style="margin-top: '+o+'px"></div>')}else{q.push('<div class="sc-pointer"></div>')}q=q.end();if(m==="perfectLeft"||m==="perfectRight"){q.addStyle("-webkit-transform-origin-y",(o+"px"))}q.addClass(m);q.attr("aria-label",k||"")},update:function(z,w){var o=z.get("preferType"),v=z.get("pointerPos"),p=z.get("pointerPosY"),s=z._view.get("layout"),t,n,q,u,x,y=w.find(".panel-background").first();if(y){y.attr("class","panel-background "+v)}y=w.find(".sc-pointer").first();if(y){if(v==="perfectLeft"||v==="perfectRight"){y.attr("style","margin-top: "+p+"px");if(v==="perfectLeft"){q=".right"}else{q=".left"}t=w.find(".one"+q).first();n=w.find(".two"+q).first();u=p+8;x=s.height-p-36;if(u<0){u=0}if(x<0){x=0}t.attr("style","margin-top: "+u+"px");n.attr("style","display: block; margin-bottom: "+x+"px");if(v==="perfectLeft"){q=".left"}else{q=".right"}t=w.find(".one"+q).first();n=w.find(".two"+q).first();t.attr("style","");n.attr("style","")}else{y.attr("style","");t=w.find(".one");n=w.find(".two");t.attr("style","");n.attr("style","")}}}});sc_require("render_delegates/ios_picker");CW.iOSPickerPane=SC.PickerPane.extend({preferType:SC.PICKER_POINTER,});SC.BaseTheme.borderRenderDelegate=SC.RenderDelegate.create({className:"border",render:function(d,e){e=e.begin("div").addClass("panel-background");this.includeSlices(d,e,SC.NINE_SLICE);e=e.end()},update:function(){}});CW.FIVE_SLICE=["left","middle one","pointer","middle two","right"];SC.BaseTheme.iOSCalloutRenderDelegate=SC.RenderDelegate.create({className:"ios_callout",render:function(f,e){var d=f.get("pointerPos");e=e.begin("div").addClass("panel-background");this.includeSlices(f,e,CW.FIVE_SLICE);e.addClass(d);e=e.end()},update:function(g,h){var e=g.get("pointerPos");var f=h.find(".panel-background").first();if(f){f.attr("class","panel-background "+e)}}});SC.BaseTheme.sheetPaneRenderDelegate=SC.RenderDelegate.create({className:"panel",render:function(j,l){var k=j.get("hasTabBar");var m=j.get("hasNavigationBar");if(k){l.addClass("has-tab-bar")}if(m){l.addClass("has-navigation-bar")}if(j.get("isFullScreen")){l.addClass("fullscreen")}var h=l.begin("div").addClass("panel-mask");var l=l.begin("div").addClass("panel-background");this.includeSlices(j,l,SC.NINE_SLICE);l=l.end();h.end();if(m){l=l.begin("div").addClass("navigation-bar");this.includeSlices(j,l,SC.THREE_SLICE);l.end()}if(k){l=l.begin("div").addClass("tab-bar");this.includeSlices(j,l,SC.THREE_SLICE);l.end()}var g=j.get("ariaLabel");l.attr("aria-label",g||"")},update:function(h,j){var g=h.get("ariaLabel");j.attr("aria-label",g||"");var k=h.get("hasTabBar");var f=h.get("hasNavigationBar");if(k){j.addClass("has-tab-bar")}if(f){j.addClass("has-navigation-bar")}}});SC.BaseTheme.switchViewRenderDelegate=SC.RenderDelegate.create({className:"switchview",render:function(k,p){this.addSizeClassName(k,p);var g=k.get("theme"),b,h;h=SC.guidFor(k)+"-label";var q=k.get("isSelected")||NO,d=k.get("isActive"),m=!k.get("isEnabled"),l;q?l="true":l="false",p.attr("role","checkbox"),p.attr("aria-checked",l),p.attr("aria-labelledby",h),p.setClass({active:d,disabled:m}),p=p.begin("span").addClass("label").id(h),g.labelRenderDelegate.render(k,p),p=p.end();var j=p.begin("span").addClass("cw-switchview-container");p=p.begin("span").addClass("cw-switchview-tracks-container"),p=p.end(),p.push('<span class = "cw-switchview-handle"></span>'),j.end()},update:function(g,b){this.updateSizeClassName(g,b);var j=g.get("theme"),f=g.get("isSelected"),a=g.get("isActive"),d=!g.get("isEnabled"),h;f?h="true":h="false",b.attr("aria-checked",h),j.labelRenderDelegate.update(g,b.find("span.label")),b.setClass({active:a,disabled:d})}});CW.SectionedViewStyle=SC.Object.extend({contentLayout:{},sectionSpacing:0,classNames:[]});CW.SectionedViewStyle.NONE=CW.SectionedViewStyle.create();CW.SectionedViewStyle.PLAIN=CW.SectionedViewStyle.create({classNames:["cw-plain"]});CW.SectionedViewStyle.GROUPED=CW.SectionedViewStyle.create({_layout1:{top:15,left:0,right:0,bottom:15},_layout2:{top:20,left:0,right:0,bottom:30},contentLayout:function(){var b=SC.browser;return b.iPhone||b.iPod?this._layout1:this._layout2}.property(),sectionSpacing:23,classNames:["cw-grouped"]});CW.SectionedViewStyle.GROUPED_THIN=CW.SectionedViewStyle.create({_layout1:{top:15,left:0,right:0,bottom:15},_layout2:{top:20,left:0,right:0,bottom:30},contentLayout:function(){return this._layout1}.property(),sectionSpacing:23,classNames:["cw-grouped"]});CW.IMAGE_ANCHOR_CLASS_NAME="cw-image-anchor";CW.SectionedViewCellImageAnchor=SC.Object.extend({concatenatedProperties:["classNames"],classNames:[CW.IMAGE_ANCHOR_CLASS_NAME]});CW.SectionedViewCellImageAnchor.CONTENT_AREA=CW.SectionedViewCellImageAnchor.create();CW.SectionedViewCellImageAnchor.TEXT_LEFT=CW.SectionedViewCellImageAnchor.create({classNames:["cw-image-left"]});CW.SectionedViewCellImageAnchor.DETAIL_TEXT_LEFT=CW.SectionedViewCellImageAnchor.create({classNames:["cw-image-left"]});sc_require("sectioned_view/modifiers/cell_image_anchor");CW.SectionedViewCellStyle=SC.Object.extend({concatenatedProperties:"classNames".w(),classNames:[],imageAnchor:CW.SectionedViewCellImageAnchor.CONTENT_AREA});CW.SectionedViewCellStyle.DEFAULT1=CW.SectionedViewCellStyle.create({classNames:["cw-default"],imageAnchor:CW.SectionedViewCellImageAnchor.TEXT_LEFT});CW.SectionedViewCellStyle.DEFAULT2=CW.SectionedViewCellStyle.create({classNames:["cw-default"],imageAnchor:CW.SectionedViewCellImageAnchor.DETAIL_TEXT_LEFT});CW.SectionedViewCellStyle.BUTTON=CW.SectionedViewCellStyle.create({classNames:["cw-button"],});CW.SectionedViewCellStyle.DELETE_BUTTON=CW.SectionedViewCellStyle.create({classNames:["cw-delete-button"],});CW.SectionedViewCellStyle.TEXT_FIELD=CW.SectionedViewCellStyle.create({classNames:["cw-text-field"]});CW.SectionedViewCellStyle.DOUBLE_LINE_ROW=CW.SectionedViewCellStyle.create({classNames:["cw-double-line-row"]});CW.SectionedViewCellStyle.WARNING_ROW=CW.SectionedViewCellStyle.create({classNames:["cw-warning-row"]});CW.SectionedViewCellSelectionStyle=SC.Object.extend({classNames:[]});CW.SectionedViewCellSelectionStyle.NONE=CW.SectionedViewCellSelectionStyle.create();CW.SectionedViewCellSelectionStyle.BLUE=CW.SectionedViewCellSelectionStyle.create({classNames:["cw-selection-blue"]});sc_require("mixins/proxy_display");sc_require("sectioned_view/modifiers/cell_style");sc_require("sectioned_view/modifiers/cell_selection_style");CW.SectionedViewCoreCell=SC.View.extend(CW.ProxyDisplay,{renderDelegateName:"sectionedViewCoreCellRenderDelegate",proxyDisplayProperties:"isEnabled style selectionStyle".w(),indexPath:null,isHighlighted:NO,isSelected:NO,isEnabled:YES,isEnabledInSectionedView:YES,style:null,selectionStyle:CW.SectionedViewCellSelectionStyle.BLUE,highlightStyle:CW.SectionedViewCellSelectionStyle.BLUE,owner:null,selectedTarget:null,selectedAction:null,deselectedTarget:null,deselectedAction:null,displayProperties:"isSelected isHighlighted isEnabledInSectionedView highlightStyle".w(),computedDisplayProxyPropertyKey:function(b){return b+"Value"},sectionedViewTapStartForEvent:function(e,d){return NO},sectionedViewTapEndForEvent:function(e,d){return NO},selected:function(){var d=this.get("selectedTarget"),e=this.get("selectedAction");this.handleCellAction(d,e)},deselected:function(){var d=this.get("deselectedTarget"),e=this.get("deselectedAction");this.handleCellAction(d,e)},handleCellAction:function(h,e){if(!e){return}var g=this.getPath("owner.pane"),f=g.get("rootResponder");f.sendAction(e,h,this,g)},isEnabledValue:function(){if(!this.get("isEnabledInSectionedView")||!this.get("isEnabledInPane")){return NO}var b=this.contentPropertyValueForProxiedProperty("isEnabled");return b===undefined?this.get("isEnabledInPane"):b}.property("isEnabledInPane","isEnabledInSectionedView").cacheable()});sc_require("sectioned_view/views/sectioned_view_core_cell");CW.SECTIONED_VIEW_CELL_DEFAULT_ACCESSORY_WIDTH=0;CW.SectionedViewCell=CW.SectionedViewCoreCell.extend({proxyDisplayProperties:"text detailText image accessoryType accessoryIsEnabled accessoryView indentationLevel indentationWidth".w(),content:null,text:null,detailText:null,image:null,accessoryType:null,accessoryView:null,accessoryIsEnabled:YES,style:CW.SectionedViewCellStyle.DEFAULT1,accessoryTypeButtonActive:NO,indentationLevel:0,indentationWidth:22,renderDelegateName:"sectionedViewCellRenderDelegate",displayProperties:"accessoryTypeButtonActive accessoryLayout".w(),accessoryViewValue:function(){var b;b=this.get("accessoryView");if(b){return b}b=this.contentPropertyValueForProxiedProperty("accessoryView");return b}.property().cacheable(),accessoryValue:function(){var d=this.get("accessoryTypeValue"),e=this.get("accessoryViewValue");if(e){return e}if(d){return d}return null}.property("accessoryTypeValue","accessoryViewValue").cacheable(),accessoryShouldBeEnabled:function(){return !!this.get("isEnabledValue")&&!!this.get("accessoryIsEnabledValue")}.property("isEnabledValue","accessoryIsEnabledValue").cacheable(),accessoryLayout:function(){var b=this.get("accessoryValue");return this._computeAccessoryLayout(b)}.property("accessoryValue").cacheable(),destroy:function(){this.accessoryView=null;this.contentView=null;arguments.callee.base.apply(this,arguments)},createChildViews:function(){var d=[],e;e=this.createAccessoryView();if(e){d.pushObject(e);this.beginPropertyChanges();this.set("accessoryView",e);this.set("childViews",d);this.endPropertyChanges()}return this},_isEnabledValueDidChange:function(){}.observes("isEnabledValue"),createAccessoryView:function(){var e=this.get("accessoryViewValue"),d=this.get("content"),f=this;if(!e||!(SC.kindOf(e,SC.View)&&e.isClass)){return null}e=this.createChildView(e,{layerId:this.get("layerId")+"-accessory",layout:this._computeAccessoryLayout(e),classNames:["cw-accessory"],isEnabledBinding:SC.Binding.oneWay(".parentView.accessoryShouldBeEnabled")});if(d&&d.get("isBindingAgent")){f=d}e.bindingAgent=f;return e},_computeAccessoryLayout:function(g){if(!g){return null}var h={},e=null,f=SC.typeOf(g);switch(f){case SC.T_OBJECT:e=g.get("layout");break;case SC.T_CLASS:e=g.prototype.layout;break;case SC.T_HASH:e=g.layout;break}e=e||{};if(!e){h.width=CW.SECTIONED_VIEW_CELL_DEFAULT_ACCESSORY_WIDTH}else{if(e.width){h.width=e.width}else{if(e.left){h.left=e.left}else{h.width=CW.SECTIONED_VIEW_CELL_DEFAULT_ACCESSORY_WIDTH}}}if(!SC.none(e.centerY)){h.centerY=e.centerY;h.height=e.height||0}else{h.top=e.top||0;h.bottom=e.bottom||0}h.right=e.right||0;return h},sectionedViewTapStartForEvent:function(f,h){var g=this.get("accessoryTypeValue"),e=this.get("isEnabledValue");if(e&&g&&g.buttonHitTest(this,h)){this._handlingRowTap=YES;this.set("accessoryTypeButtonActive",YES);return YES}return NO},sectionedViewTapEndForEvent:function(e,d){var f=this.get("accessoryTypeValue");if(!this._handlingRowTap){return NO}if(f&&f.buttonHitTest(this,d)){e.rowAccessoryButtonTappedAtIndexPath(this.get("indexPath"))}this._handlingRowTap=NO;this.set("accessoryTypeButtonActive",NO);return YES}});sc_require("sectioned_view/modifiers/sectioned_view_style");sc_require("sectioned_view/mixins/sectioned_view_data_source");sc_require("sectioned_view/mixins/sectioned_view_delegate");sc_require("sectioned_view/views/sectioned_view_cell");CW.SectionedViewMonitor={isSectionedViewMonitor:YES,sectionedViewWillUpdateContentView:function(b){},sectionedViewDidUpdateContentView:function(b){},sectionedViewWillSetupContentView:function(b){},sectionedViewDidSetupContentView:function(b){},sectionedViewWillTearDownContentView:function(b){},sectionedViewDidTearDownContentView:function(b){}};CW.SectionedView=SC.ScrollView.extend(CW.SectionedViewDelegate,CW.SectionedViewDataSource,CW.SectionedViewMonitor,{classNames:"cw-sectioned-view".w(),datasource:null,delegate:null,selection:null,allowsSelection:YES,rowHeight:44,style:null,sectionHeaderHeight:25,sectionFooterHeight:25,sectionHeaderViewExample:SC.LabelView,sectionFooterViewExample:SC.LabelView,headerView:null,footerView:null,headerHeight:18,footerHeight:18,rowCellExample:CW.SectionedViewCell,anchorLastSectionToBottom:NO,monitor:null,contentView:SC.View,styleValue:function(){var b=this.get("style");return b?b:CW.SectionedViewStyle.NONE}.property("style").cacheable(),sectionedViewDelegate:function(){var b=this.get("delegate");return this.delegateFor("isSectionedViewDelegate",b)}.property("delegate").cacheable(),sectionedViewDataSource:function(){var b=this.get("dataSource");return this.delegateFor("isSectionedViewDataSource",b)}.property("dataSource").cacheable(),sectionedViewMonitor:function(){var b=this.get("monitor");return this.delegateFor("isSectionedViewMonitor",b)}.property("monitor").cacheable(),reloadData:function(){this.clearSelection();this._updateContentView();this.invokeLast(function(){this.refreshLayout()})},reloadSection:function(t){if(!this._sectionBlocks){return}var u=this._sectionBlocks[t];if(!u){return}var l=u.get("views")||[],o=l.length,m=this.get("contentView"),p=m.get("childViews")||[],v=p.length,s=null;var q=o>0?l[o-1]:null,n=p.indexOf(q);if(n>-1&&n<v-1){s=p[n+1]}m.beginPropertyChanges();l.forEach(function(a){m.removeChild(a)},this);u.reload();l=u.get("views")||[];l.forEach(function(a){m.insertBefore(a,s);s=a},this);this._readjustAllBlocks();m.endPropertyChanges();this.invokeLater(function(){this.refreshLayout()})},reloadRowAtIndexPath:function(b){},didAppendToDocument:function(){var b=this;this.invokeLater(function(){b.refreshLayout()})},refreshLayout:function(){var b=this._blocks||[];b.forEach(function(a){a.updateHeightIfNeeded()});this._readjustAllBlocks()},cellForRowAtIndexPath:function(h){var j=this._sectionBlocks,l,m,g=h?h.get("section"):null,k=h?h.get("row"):null;if(!h||!j||g>(j.length-1)){return null}l=j[g];m=l.rows;if(!m||k>(m.length-1)){return null}return m[k]},cellForEvent:function(l){var k=l.target,g=this.get("layer"),m=k,h,j;while(m&&m!==g&&m!==document){if((j=m.id)&&(h=SC.View.views[j])&&h.isSectionedViewCell){return h}m=m.parentNode}return null},deselectRowAtIndexPath:function(b){if(!this.get("allowsSelection")||!b){return}if(!this.validIndexPath(b)){return}this.clearSelection()},selectRowAtIndexPath:function(d){if(!this.get("allowsSelection")||!d){return}this.propertyWillChange("selection");var e=this.cellForRowAtIndexPath(d);if(!e){return}this.propertyWillChange("selection");this.clearSelection();e.set("isSelected",YES);this.set("selection",d);this.propertyDidChange("selection")},clearSelection:function(){var d=this.get("selection"),e;if(!d){return}e=this.cellForRowAtIndexPath(d);if(e){e.set("isSelected",NO)}this.set("selection",null)},validIndexPath:function(g){var h,j,l,m,k;if(!g){return NO}j=this._sectionBlocks;h=j?j.length:0;l=g.get("section");if(l<0||l>=h){return NO}m=j[l].rows;h=m?m.length:0;k=g.get("row");if(k<0||k>=h){return NO}return YES},rowTapStartAtIndexPath:function(m){if(!this.get("allowsSelection")||!this.validIndexPath(m)){return}var g=this.get("sectionedViewDelegate"),k=this.get("selection"),j,l,h;h=this.cellForRowAtIndexPath(m);if(!h||!h.get("isEnabledValue")){return}j=g.sectionedViewWillSelectRowAtIndexPath(this,m);if(k){l=g.sectionedViewWillDeselectRowAtIndexPath(this,k)}h=this.cellForRowAtIndexPath(j);if(!h){return}this._rowTapInfo={selectIndexPath:j,deselectIndexPath:l,cell:h};h.set("isHighlighted",YES)},rowTapEndAtIndexPath:function(m){var g=this.get("sectionedViewDelegate"),k=this._rowTapInfo||{},j=k.selectIndexPath,l=k.deselectIndexPath,h;if(m&&m.equals(j)){this._removeHighlightFromTappedRow();this.selectRowAtIndexPath(j);g.sectionedViewDidSelectRowAtIndexPath(this,j);if(l){g.sectionedViewDidDeselectRowAtIndexPath(this,l)}h=this.cellForRowAtIndexPath(l);if(h){h.deselected()}h=this.cellForRowAtIndexPath(j);if(h){h.selected()}}this._cleanupRowTap()},cancelRowTap:function(){this._cleanupRowTap()},_cleanupRowTap:function(){this._removeHighlightFromTappedRow();this._rowTapInfo=null},_removeHighlightFromTappedRow:function(){var d=this._rowTapInfo||{},e=d.cell;if(e){e.set("isHighlighted",NO)}},rowAccessoryButtonTappedAtIndexPath:function(d){var e=this.get("sectionedViewDelegate");e.sectionedViewAccessoryButtonTappedForRowAtIndexPath(this,d)},render:function(f,g){var e=this.get("styleValue"),h=e.get("classNames");if(g){f.addClass(h)}},createChildViews:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){this._setupContentView()},this);return this},destroy:function(){this._tearDownContentView();arguments.callee.base.apply(this,arguments)},_updateContentView:function(){var b=this.get("sectionedViewMonitor");b.sectionedViewWillUpdateContentView(this);this._tearDownContentView();this._setupContentView();b.sectionedViewDidUpdateContentView(this)},_setupContentView:function(){var m=this.get("contentView"),j=this.get("sectionedViewMonitor"),h=this.get("sectionedViewDelegate"),l=[];j.sectionedViewWillSetupContentView(this);h.sectionedViewWillSetupAllCells(this);this._headerBlock=this._createHeaderBlock();this._footerBlock=this._createFooterBlock();this._sectionBlocks=this._createSectionBlocks();var k=[];k.push(this._headerBlock);k.pushObjects(this._sectionBlocks);k.push(this._footerBlock);this._blocks=k;k.forEach(function(a){a.setup();l.pushObjects(a.get("views"))});m.beginPropertyChanges();var o=this.get("styleValue"),n=o.get("contentLayout");m.adjust({right:n.right||0,left:n.left||0});m.set("childViews",l);m.endPropertyChanges();this._readjustAllBlocks();m.replaceLayer();h.sectionedViewDidSetupAllCells(this);j.sectionedViewDidSetupContentView(this)},_frameDidChange:function(){var e=this._readjustAnchoredBottomBlocks();if(e){var d=this.get("contentView");d.adjust("height",e)}}.observes("frame"),_heightOfAllBlocksWithPadding:function(){var e=this.get("styleValue"),h=e.get("contentLayout"),g=h.top||0,f=h.bottom||0;return this._heightOfAllBlocks()+g+f},_heightOfAllBlocks:function(){var d=this._blocks,e=d?d.length:0;return this._heightOfBlocksToIndex(e-1)},_heightOfBlocksToIndex:function(k){var h=this._blocks,f=h?h.length:0,g=0;if(k>=f){throw"invalid index: "+k}for(var j=0;j<=k;j+=1){g+=h[j].get("height")}return g},_heightOfBlocksFromIndex:function(k){var h=this._blocks,f=h?h.length:0,g=0;if(k>=f){throw"invalid index: "+k}for(var j=k;j<f;j+=1){g+=h[j].get("height")}return g},_readjustAllBlocks:function(){var f=this.get("styleValue"),g=f.get("contentLayout");this._readjustBlockFromIndex(0,g.top||0);var h=this._readjustAnchoredBottomBlocks();if(!h){h=this._heightOfAllBlocksWithPadding()}var e=this.get("contentView");e.adjust("height",h)},_readjustBlockFromIndex:function(e,h){var g=this._blocks,f=g?g.length:0;if(e>=f){return}this._readjustBlockRegion(e,f-1,h)},_readjustAnchoredBottomBlocks:function(){if(!this.get("anchorLastSectionToBottom")){return}var u=this.get("sectionedViewDataSource"),l=u.numberOfSectionsInSectionedView(this),n=this.get("frame").height,t=this._blocks;if(!t){return}var m=t.length;if(l<2){return}var o=m-2;if(this._heightOfAllBlocksWithPadding()>=n){this._readjustBlockFromIndex(o);return}var s=this.get("styleValue"),p=s.get("contentLayout"),v=p.bottom||0,q=this._heightOfBlocksFromIndex(o);top=n-q-v;this._readjustBlockRegion(o,m-1,top);return n},_readjustBlockRegion:function(s,o,l){var u=this._blocks,m=u.length;if(s<0||o>=m){throw"invalid argument provided"}var q=l>=0;for(var n=s;n<=o;n+=1){var p=u[n],t=n-1>=0?u[n-1]:null,v=t?t.get("top")+t.get("height"):0;if(!q){l=t?v:0}p.readjustFromTop(l);q=false}},_createHeaderBlock:function(){return CW.SectionedViewHeaderBlock.create({sectionedView:this})},_createFooterBlock:function(){return CW.SectionedViewFooterBlock.create({sectionedView:this})},_createSectionBlocks:function(){var j=this.get("sectionedViewDataSource"),g=j.numberOfSectionsInSectionedView(this),h=[];for(var f=0;f<g;f+=1){if(j.sectionedViewSectionIsVisible(this,f)){var k=CW.SectionedViewSectionBlock.create({sectionedView:this,sectionIndex:f});h.push(k)}}return h},_tearDownContentView:function(){var e=this.get("sectionedViewMonitor"),d=this.get("sectionedViewDelegate");e.sectionedViewWillTearDownContentView(this);d.sectionedViewWillTearDownAllCells(this);this._tearDownAllBlocks();d.sectionedViewDidTearDownAllCells(this);e.sectionedViewDidTearDownContentView(this)},_tearDownAllBlocks:function(){var e=this.get("contentView");e.beginPropertyChanges();e.removeAllChildren();var d=this._blocks||[];d.forEach(function(a){a.tearDown()});e.endPropertyChanges()},mouseDown:function(b){return this._handleTapStartForEvent(b)},mouseUp:function(b){return this._handleTapEndForEvent(b)},touchStart:function(e){var g=e.averagedTouchesForView(this,YES),h={event:e,handled:NO,x:g.x,y:g.y};this._touchStartInfo=h;var f=this;setTimeout(function(){SC.RunLoop.begin();f._handleTouchStart();SC.RunLoop.end()},100);return arguments.callee.base.apply(this,arguments)},touchesDragged:function(f,g){arguments.callee.base.apply(this,arguments);var h=f.averagedTouchesForView(this),e=this._touchStartInfo;if(!e){return YES}e.touchDragged=YES;if(Math.abs(e.y-h.y)>3){this._touchStartInfo=null;this.cancelRowTap()}return YES},touchEnd:function(e){var f=e.averagedTouchesForView(this),d=this._touchStartInfo;if(d){if(d.handled){this._handleTapEndForEvent(e)}else{if(!d.touchDragged){this.invokeLater(function(){this._handleTapStartForEvent(d.event);this.invokeLater(function(){this._handleTapEndForEvent(e)},100)},10)}}}this._touchStartInfo=null;return arguments.callee.base.apply(this,arguments)},_handleTouchStart:function(){var b=this._touchStartInfo;if(!b){return}b.handled=YES;this._handleTapStartForEvent(b.event)},_handleTapStartForEvent:function(d){var f={};this._tapStartInfo=f;var e=this.cellForEvent(d);if(!e){this._tapStartInfo=null;return NO}f.cell=e;if(e.tryToPerform("sectionedViewTapStartForEvent",this,d)){f.cellHandlingRowTap=YES;return YES}this.rowTapStartAtIndexPath(e.get("indexPath"));return YES},_handleTapEndForEvent:function(h){if(!this._tapStartInfo){return NO}var g=this._tapStartInfo,f=g.cell,e;this._tapStartInfo=null;if(g.cellHandlingRowTap&&f.sectionedViewTapEndForEvent){return f.sectionedViewTapEndForEvent(this,h)}f=this.cellForEvent(h);if(f){e=f.get("indexPath")}this.rowTapEndAtIndexPath(e);return YES},_cw_sv_isEnabledChanged:function(){var d=this._sectionBlocks||[],e=this.get("isEnabled");d.forEach(function(a){var b=a.rows||[];b.forEach(function(f){f.set("isEnabledInSectionedView",e)})})}.observes("isEnabled")});CW.IndexPath=SC.Object.extend(SC.Copyable,{section:null,row:null,copy:function(b){return CW.IndexPath.create({section:this.get("section"),row:this.get("row")})},equals:function(b){if(!b||!SC.kindOf(b,CW.IndexPath)){return NO}return CW.IndexPath.compare(this,b)===0},toString:function(){var d=this.get("row"),e=this.get("section");return"IndexPath(row: %@, section: %@)".fmt(d,e)}});CW.IndexPath.mixin(SC.Comparable,{compare:function(g,h){var b=SC.kindOf(g,CW.IndexPath),a=SC.kindOf(h,CW.IndexPath);if(!b&&!a){throw"Can not compare. a and b must both be of type CW.IndexPath"}if(g.get("section")==h.get("section")){if(g.get("row")===h.get("row")){return 0}return g.get("row")<h.get("row")?-1:1}return g.get("section")<h.get("section")?-1:1}});CW.SectionedViewAutoResizingViewSupport={isSectionedViewAutoResizingView:YES,shouldAutoResize:YES,heightPadding:0,computeHeight:function(){var d=this.$()[0],f=this.getPath("frame.width"),e;if(SC.none(d)){return null}d.style.maxWidth=f+"px";e=SC.metricsForString(this.get("value"),d);return e.height+this.get("heightPadding")}};CW.SVCollectionSectionDelegate={isSVCollectionSectionDelegate:YES,collectionSectionCellForContentAtIndex:function(f,d,e){return null},collectionSectionRowHeightForContentAtIndex:function(f,d,e){return null}};sc_require("sectioned_view/mixins/sectioned_view_data_source");sc_require("sectioned_view/mixins/sectioned_view_delegate");CW.SectionedViewDesignSupport={};SC.mixin(CW.SectionedViewDesignSupport,CW.SectionedViewDataSource,CW.SectionedViewDelegate,{isSectionedViewDesigner:YES,sections:[],initMixin:function(){this.createSections()},createSections:function(){var h=(this.get("sections")||[]).slice(),g=h.length,f=0,j,k;for(;f<g;f+=1){j=h[f];k=this.createSection(this[j],f);h[f]=this[j]=k;if(!k){throw'sectioned view designer has invalid section "%@" for section[%@]'.fmt(j,f)}}this.set("sections",h)},createSection:function(d,e){if(SC.kindOf(d,CW.SectionedViewSection)&&d.isClass){return d.create({owner:this,index:e})}return null},sectionForIndex:function(e){var d=this.get("sections");return d?d.objectAt(e):undefined},rowForIndexPath:function(e){var d=e.get("section"),f=e.get("row");d=this.sectionForIndex(d);return d?d.rowForIndex(f):d},numberOfSectionsInSectionedView:function(b){return this.getPath("sections.length")},sectionedViewSectionIsVisible:function(e,d){d=this.sectionForIndex(d);return d?d.get("isVisible"):NO},sectionedViewNumberOfRowsInSection:function(e,d){d=this.sectionForIndex(d);return d?d.get("rows").length:d},sectionedViewCellForRowAtIndexPath:function(f,k){var j=this.sectionForIndex(k.get("section")),h=this.rowForIndexPath(k),g;if(h&&(g=h.get("cell"))){return g}if(j&&(g=j.get("cell"))){return g}return null},sectionedViewContentForRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);if(!f||f.get("isContent")){return f}return f.get("content")},sectionedViewTitleForHeaderInSection:function(e,d){d=this.sectionForIndex(d);return d?d.get("headerTitle"):d},sectionedViewTitleForFooterInSection:function(e,d){d=this.sectionForIndex(d);return d?d.get("footerTitle"):d},sectionedViewHeightForRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);return f?f.get("height"):f},sectionedViewViewForHeaderInSection:function(e,d){d=this.sectionForIndex(d);return d?d.get("headerView"):d},sectionedViewViewForFooterInSection:function(e,d){d=this.sectionForIndex(d);return d?d.get("footerView"):d},sectionedViewHeightForHeaderInSection:function(e,d){d=this.sectionForIndex(d);return d?d.get("headerHeight"):d},sectionedViewHeightForFooterInSection:function(e,d){d=this.sectionForIndex(d);return d?d.get("footerHeight"):d},sectionedViewShouldAutoResizeHeaderTitleInSection:function(e,d){d=this.sectionForIndex(d);return d?d.get("autoResizeHeaderTitle"):NO},sectionedViewShouldAutoResizeFooterTitleInSection:function(e,d){d=this.sectionForIndex(d);return d?d.get("autoResizeFooterTitle"):NO},sectionedViewAccessoryButtonTappedForRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);if(!f){return null}f.accessoryButtonTapped(e)},sectionedViewWillSelectRowAtIndexPath:function(h,m){var j=this.rowForIndexPath(m),k=this.sectionForIndex(m.get("section")),g=j&&j.get("allowsSelection"),l=j&&j.get("isEnabled");if(!k.get("allowsSelection")||!j.get("allowsSelection")||!j.get("isEnabled")){return null}return m},sectionedViewDidSelectRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);if(f&&f.get("allowsSelection")){f.selected(e)}},sectionedViewWillDeselectRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);return f&&f.get("allowsSelection")?d:null},sectionedViewDidDeselectRowAtIndexPath:function(e,d){var f=this.rowForIndexPath(d);if(f&&f.get("allowsSelection")){f.deselected(e)}},sectionedViewCellDisplayDelegateForRowAtIndexPath:function(g,k){var j=this.sectionForIndex(k.get("section")),h=k.get("row"),f=null;if(j){f=j.displayDelegateForRow(h)}return f?f:g},sectionedViewWillSetupAllCells:function(b){this._notifySectionsOfAllCellUpdates("sectionedViewWillSetupAllCells",b)},sectionedViewDidSetupAllCells:function(b){this._notifySectionsOfAllCellUpdates("sectionedViewDidSetupAllCells",b)},sectionedViewWillTearDownAllCells:function(b){this._notifySectionsOfAllCellUpdates("sectionedViewWillTearDownAllCells",b)},sectionedViewDidTearDownAllCells:function(b){this._notifySectionsOfAllCellUpdates("sectionedViewDidTearDownAllCells",b)},_notifySectionsOfAllCellUpdates:function(d,e){var f=this.get("sections")||[];f.forEach(function(a){a[d](e)})}});CW.SWITCH_VIEW_WIDTH=52,CW.HANDLE_WIDTH=30,CW.CAP_WIDTH=24,CW.HANDLE_MAX_LEFT=21,CW.HANDLE_BIG_OFFSET=18;CW.SwitchView=SC.CheckboxView.extend({classNames:["cw-switchview"],renderDelegateName:"switchViewRenderDelegate",animateOnPropertyChange:NO,animateOnPropertyChangeBindingDefault:SC.Binding.oneWay(),_isTracking:NO,_startingMouseOffset:0,_handleLocation:0,_container:null,_handle:null,didCreateLayer:function(){this._animateTo(this.get("isSelected"),NO,0)},didUpdateLayer:function(){this._animateTo(this.get("isSelected"),NO,0)},_isSelectedDidChange:function(){this._handle||this._initReferences();var b=this.get("animateOnPropertyChange"),a=b?null:0;this._animateTo(this.get("isSelected"),NO,a)}.observes("isSelected"),keyDown:function(a){return this.get("isEnabled")?(this._handle||this._initReferences(),a.keyCode===13?(this._animateTo(!this.get("isSelected")),YES):a.keyCode===39?(this._animateTo(YES),YES):a.keyCode===37?(this._animateTo(NO),YES):arguments.callee.base.apply(this,arguments)):NO},mouseDown:function(a){if(!this.get("isEnabled")){return NO}this._handle||this._initReferences(),!a.target.className.indexOf("cw-switchview-handle")>0&&(this._handle.removeClass("highlight"),this._handle.addClass("pressed"),this._tracksContainer.addClass("pressed")),this.get("isSelected")&&this._repositionTo(CW.HANDLE_MAX_LEFT-3),this._onCap.addClass("cw-switchview-on"),this._startingMouseOffset=this._makeValueRelativeToLeftEdgeOf(a.clientX,this._container),this._startingHandleLocation=parseInt(this._handle.css("left"),10)},touchesDragged:function(a){this.mouseDragged(a)},mouseDragged:function(d){if(!this.get("isEnabled")){return NO}this._isTracking||(this._handle.removeClass("highlight"),this._handle.addClass("pressed"),this._tracksContainer.addClass("pressed")),this._isTracking=YES;var a=parseInt(this._handle.css("left"),10)>=CW.HANDLE_MAX_LEFT/2,f=this._makeValueRelativeToLeftEdgeOf(d.clientX,this._container),b=f-this._startingMouseOffset;this.get("isSelected")&&this._repositionTo(CW.HANDLE_MAX_LEFT-3),this._repositionTo(this._startingHandleLocation+b)},mouseUp:function(b){if(!this.get("isEnabled")){return NO}var a=parseInt(this._handle.css("left"),10)>=CW.HANDLE_MAX_LEFT/2;this.set("isSelected",a),this._isTracking?(this._isTracking=NO,this._handleLocation==CW.HANDLE_BIG_OFFSET?this._animateTo(a,YES,0):this._animateTo(a)):this._animateTo(!this.get("isSelected"))},_makeValueRelativeToLeftEdgeOf:function(d,a){var f=0,b=0;if(a.offsetParent){do{if(a===document.body){break}b+=a.offsetLeft,f+=a.offsetTop}while(a=a.offsetParent)}return d-b},_initReferences:function(){this._container=this.$(".cw-switchview-container")[0],this._handle=this.$(".cw-switchview-handle"),this._offTrack=this.$(".cw-switchview-off-track"),this._offText=this.$(".cw-switchview-off-text"),this._onText=this.$(".cw-switchview-on-text"),this._onCap=this.$(".cw-switchview-on-cap"),this._offCap=this.$(".cw-switchview-off-cap"),this._tracksContainer=this.$(".cw-switchview-tracks-container")}.observes("layer"),_repositionTo:function(a){a=Math.max(Math.min(a,CW.HANDLE_MAX_LEFT),0),this._isTracking&&a>=CW.HANDLE_BIG_OFFSET&&(a=CW.HANDLE_BIG_OFFSET),a>=CW.HANDLE_MAX_LEFT/2?(this._tracksContainer.addClass("selectedState"),this._handle.addClass("selectedState")):(this._tracksContainer.removeClass("selectedState"),this._handle.removeClass("selectedState")),this._handle.css("left",this._handleLocation=a),this._offTrack.css("left",a)},_animateTo:function(b,a,d){a===undefined&&(a=YES),this._handle.removeClass("pressed"),this._tracksContainer.removeClass("pressed"),b?this._onCap.addClass("cw-switchview-on"):this._handle.removeClass("highlight"),this._anim&&this._anim.stop(),d===0?this._repositionTo(b?CW.HANDLE_MAX_LEFT:0):this._anim=CW.Animation.create({name:this.toString(),that:this,updateValue:a,isSelected:b,updateValue:a,from:this._handleLocation,to:b?CW.HANDLE_MAX_LEFT:0,duration:SC.none(d)?350:d,update:function(){this.that._repositionTo(this.current)},onFinish:function(){this.updateValue&&(this.that.get("isSelected")!==this.isSelected&&this.invokeLast(function(){this.that._action()}),this.that.set("isSelected",this.isSelected)),this.isSelected||this.that._onCap.removeClass("cw-switchview-on")}}).start()},});sc_require("views/switch_view");CW.SwitcherAccessoryViewSupport={target:null,action:null,animateOnPropertyChange:NO,animateOnPropertyChangeBindingDefault:SC.Binding.oneWay(),accessoryView:CW.SwitchView.extend({layout:{width:80,centerY:1,height:27,right:10},animateOnPropertyChangeBinding:SC.Binding.oneWay(".bindingAgent.animateOnPropertyChange"),valueBinding:".bindingAgent.value",targetBinding:SC.Binding.oneWay(".bindingAgent.target"),actionBinding:SC.Binding.oneWay(".bindingAgent.action")})};CW.SectionedViewCellAccessoryType=SC.Object.extend({concatenatedProperties:["classNames"],classNames:[],buttonHitTest:function(e,d){return NO}});CW.SectionedViewCellAccessoryType.mixin({CLASS_NAME:"cw-accessory-type",render:function(d,f,e){e=e.begin().addClass(this.CLASS_NAME);if(d){e.addClass(d.get("classNames"))}e.end()},update:function(k,h,g){var j=g.find("."+this.CLASS_NAME);if(j){var f=[this.CLASS_NAME];if(k){f=f.concat(k.get("classNames"))}j.attr("class",f.join(" "))}}});CW.SectionedViewCellAccessoryType.DETAIL_CHECKMARK=CW.SectionedViewCellAccessoryType.create({classNames:"cw-detail-checkmark".w()});CW.SectionedViewCellAccessoryType.DISCLOSURE_INDICATOR=CW.SectionedViewCellAccessoryType.create({classNames:"cw-disclosure-indicator".w()});CW.SectionedViewCellAccessoryType.DETAIL_DISCLOSURE_BUTTON=CW.SectionedViewCellAccessoryType.create({classNames:"cw-detail-disclosure-button".w(),buttonHitTest:function(f,h){var g=h.target,e=f.$("."+this.get("classNames")[0]);return e.size()>0&&e.within(g)}});CW.SectionedViewBlock=SC.Object.extend({sectionedView:null,views:[],height:0,top:0,hasViews:function(){var b=this.get("views");return b&&(b.length>0)}.property("view").cacheable(),setup:function(){},tearDown:function(){var b=this.get("views")||[];b.forEach(function(a){a.destroy()});this.set("views",[])},reload:function(){},readjustFromTop:function(b){this.set("top",b);this.doReadjustFromTop(b)},doReadjustFromTop:function(b){},readjustViewFromTop:function(e,d){e.adjust({top:d,bottom:null});return e.get("frame").height},updateHeightIfNeeded:function(){var d=this.get("views")||[],e=NO;d.forEach(function(a){if(a.isSectionedViewAutoResizingView&&a.shouldAutoResize){var b=a.computeHeight();if(b){a.adjust("height",b);e=YES}}});if(e){this.updateHeight()}},updateHeight:function(){}});sc_require("sectioned_view/private/block");CW.SectionedViewFooterBlock=CW.SectionedViewBlock.extend({setup:function(){var f=this.get("sectionedView"),k=f.get("styleValue"),j=k.get("contentLayout"),h=f.get("footerView"),g=f.get("footerHeight");if(!h){return}if(!h.isClass||!SC.kindOf(h,SC.View)){SC.Logger.error("%@: sectioned view footer is not a view class".fmt(f));return}h=f.get("contentView").createChildView(h,{layerId:"%@-footer".fmt(f.get("layerId")),classNames:"cw-sectioned-footer",layout:{left:0,right:0,top:0,height:g}});this.set("views",[h]);this.set("height",g)},doReadjustFromTop:function(d){var e=this.get("views");if(e&&e.length>0){this.readjustViewFromTop(e[0],d)}},updateHeight:function(){this.set("height",this.get("views")[0].get("frame").height)}});sc_require("sectioned_view/private/block");CW.SectionedViewHeaderBlock=CW.SectionedViewBlock.extend({setup:function(){var f=this.get("sectionedView"),k=f.get("styleValue"),j=k.get("contentLayout"),h=f.get("headerView"),g=f.get("headerHeight");if(!h){return}if(!h.isClass||!SC.kindOf(h,SC.View)){SC.Logger.error("%@: sectioned view header is not a view class".fmt(f));return}h=f.get("contentView").createChildView(h,{layerId:"%@-header".fmt(f.get("layerId")),classNames:"cw-sectioned-header",layout:{left:0,right:0,top:0,height:g}});this.set("views",[h]);this.set("height",g)},doReadjustFromTop:function(d){var e=this.get("views");if(e&&e.length>0){this.readjustViewFromTop(e[0],d)}},updateHeight:function(){this.set("height",this.get("views")[0].get("frame").height)}});sc_require("sectioned_view/private/block");CW.SectionedViewSectionBlock=CW.SectionedViewBlock.extend({sectionIndex:null,headerView:null,footerView:null,rows:null,height:function(){var o=this.get("sectionedView"),p=this.get("sectionIndex"),v=o.get("sectionedViewDataSource"),l=v.numberOfSectionsInSectionedView(o),n=this.get("views")||[],s=this.rowsContainerView;var m=0;n.forEach(function(a){if(a!=s){m+=a.get("frame").height}});var u=o.get("styleValue"),t=u.get("contentLayout"),q=u.get("sectionSpacing");if(p<l-1&&m>0){m+=q}return m}.property("views","sectionIndex").cacheable(),includeSectionRowsContainer:function(){return SC.browser.isIE8OrLower}.property().cacheable(),setup:function(){var d=this.get("sectionedView"),e=[];this.headerView=this._createHeaderView();this.rows=this._createRowCells();this.footerView=this._createFooterView();this.rowsContainerView=this._createRowsContainer();if(this.rowsContainerView){e.push(this.rowsContainerView)}if(this.headerView){e.push(this.headerView)}if(this.rows){e.pushObjects(this.rows)}if(this.footerView){e.push(this.footerView)}this.set("views",e)},reload:function(){this.tearDown();this.setup()},doReadjustFromTop:function(s){var v=this.headerView,p=this.footerView,m=this.rows,u=s,x=0,n=0;if(v){s+=this.readjustViewFromTop(v,s)}for(var w=0,q=m.length;w<q;w+=1){var o=m[w];if(w===0){x=s}n+=o.get("frame").height;s+=this.readjustViewFromTop(o,s)}if(p){s+=this.readjustViewFromTop(p,s)}var t=this.rowsContainerView;if(t){t.adjust({top:x,height:n})}},updateHeight:function(){this.notifyPropertyChange("height")},_createRowsContainer:function(){var h=this.get("sectionedView"),g=h.get("contentView");if(!this.get("includeSectionRowsContainer")){return null}var e=CW.SectionedViewSectionBlock,f=e.sectionRowsContainerViewExample;return g.createChildView(f)},_createRowCells:function(){var h=this.get("sectionedView"),m=this.get("sectionIndex"),k=h.get("sectionedViewDataSource"),n=k.sectionedViewNumberOfRowsInSection(h,m),o=[];for(var l=0,j;l<n;l+=1){j=this._createRowCell(m,l);if(j){o.push(j)}}return o},_createRowCell:function(x,p){var w=this.get("sectionedView"),C=w.get("sectionedViewDataSource"),s=w.get("sectionedViewDelegate"),y=CW.IndexPath.create({section:x,row:p}),v=C.sectionedViewCellForRowAtIndexPath(w,y),A=C.sectionedViewContentForRowAtIndexPath(w,y),t=s.sectionedViewHeightForRowAtIndexPath(w,y),D=["cw-section-row"],q=C.sectionedViewNumberOfRowsInSection(w,x),z=s.sectionedViewCellDisplayDelegateForRowAtIndexPath(w,y),B;t=t||w.get("rowHeight");if(p===0){D.push("cw-first-row")}if(p===q-1){D.push("cw-last-row")}if(!v){v=w.get("rowCellExample")}if(!v||!v.isClass||!SC.kindOf(v,CW.SectionedViewCoreCell)){SC.Logger.error("%@: cell for index path %@ is not a sectioned view core cell class".fmt(w,y));return null}B={classNames:D,layerId:"%@-section-%@-row-%@".fmt(w.get("layerId"),x,p),isSectionedViewCell:YES,indexPath:y,layout:{top:0,left:0,right:0,height:t},displayDelegate:z};if(A){B.content=A}var u=w.get("contentView");v=u.createChildView(v,B);v.owner=w;return v},_createHeaderView:function(){var n=this.get("sectionedView"),o=this.get("sectionIndex"),t=n.get("sectionedViewDataSource"),l=n.get("sectionedViewDelegate"),p=t.sectionedViewTitleForHeaderInSection(n,o),s=t.sectionedViewShouldAutoResizeHeaderTitleInSection(n,o),q=l.sectionedViewViewForHeaderInSection(n,o),k=l.sectionedViewHeightForHeaderInSection(n,o);k=k||n.get("sectionHeaderHeight");if(!SC.empty(p)&&!q){q=n.get("sectionHeaderViewExample").extend({value:p});if(s){q=q.extend(CW.SectionedViewAutoResizingViewSupport,{heightPadding:6})}}if(!q){return null}if(!q.isClass||!SC.kindOf(q,SC.View)){SC.Logger.error("%@: header view for section %@ is not a view class".fmt(n,o));return null}var m=n.get("contentView");q=m.createChildView(q,{layerId:"%@-section-header-%@".fmt(n.get("layerId"),o),classNames:"cw-section-header",escapeHTML:NO,layout:{left:0,right:0,top:0,height:k},displayDelegate:n,frameWidthDidChange:function(){if(this.computeHeight){var a=this.computeHeight();if(a){this.adjust("height",this.computeHeight())}}}.observes("*frame.width")});q.owner=n;return q},_createFooterView:function(){var n=this.get("sectionedView"),o=this.get("sectionIndex"),t=n.get("sectionedViewDataSource"),l=n.get("sectionedViewDelegate"),p=t.sectionedViewTitleForFooterInSection(n,o),s=t.sectionedViewShouldAutoResizeFooterTitleInSection(n,o),q=l.sectionedViewViewForFooterInSection(n,o),k=l.sectionedViewHeightForFooterInSection(n,o);k=k||n.get("sectionFooterHeight");if(!SC.empty(p)&&!q){q=n.get("sectionFooterViewExample").extend({value:p});if(s){q=q.extend(CW.SectionedViewAutoResizingViewSupport)}}if(!q){return null}if(!q.isClass||!SC.kindOf(q,SC.View)){SC.Logger.error("%@: footer view for section %@ is not a view class".fmt(n,o));return null}var m=n.get("contentView");q=m.createChildView(q,{layerId:"%@-section-footer-%@".fmt(n.get("layerId"),o),classNames:"cw-section-footer",escapeHTML:NO,layout:{left:0,right:0,top:0,height:k},displayDelegate:n,frameWidthDidChange:function(){if(this.computeHeight){var a=this.computeHeight();if(a){this.adjust("height",this.computeHeight())}}}.observes("*frame.width")});q.owner=n;return q}});CW.SectionedViewSectionBlock.mixin({sectionRowsContainerViewExample:SC.View.extend({classNames:"cw-section-rows-container",render:function(e,d){SC.RenderDelegate.includeSlices(this,e,SC.NINE_SLICE)}})});CW.SectionedViewCoreCellRenderDelegate=SC.RenderDelegate.extend({className:"cw-sectioned-view-cell",styleKey:"styleValue",selectionStyleKey:"selectionStyleValue",highlightStyleKey:"highlightStyle",isEnabledKey:"isEnabledValue",render:function(n,j){var m=n.get("isSelected"),h=n.get("isHighlighted"),k=n.get(this.get("isEnabledKey")),l=n.get(this.get("styleKey")),o=n.get(this.get("selectionStyleKey")),e=n.get(this.get("highlightStyleKey"));if(m){j.addClass("cw-selected")}if(h){j.addClass("cw-highlighted")}if(!k){j.addClass("cw-disabled")}if(h){j.addClass(e.get("classNames"))}if(m){if(o){j.addClass(o.get("classNames"))}}if(l){j.addClass(l.get("classNames"))}this.willRenderCellBody(n,j);this.renderCellBody(n,j);this.didRenderCellBody(n,j)},renderCellBody:function(b,a){},willRenderCellBody:function(b,a){},didRenderCellBody:function(b,a){},update:function(a,q){var p=a.get(this.get("styleKey")),l=a.get(this.get("selectionStyleKey")),n=a.get(this.get("highlightStyleKey")),m;var o=a.get("isSelected");q.setClass("cw-selected",o);var d=a.get("isHighlighted");q.setClass("cw-highlighted",d);var k=a.get(this.get("isEnabledKey"));q.setClass("cw-disabled",!k);if(p){q.addClass(p.get("classNames"))}if(n){m=n.get("classNames");if(d){q.addClass(m)}else{q.removeClass(m)}}if(l){m=l.get("classNames");if(o){q.addClass(m)}else{q.removeClass(m)}}this.willUpdateCellBody(a,q);this.updateCellBody(a,q);this.didUpdateCellBody(a,q)},updateCellBody:function(b,a){},willUpdateCellBody:function(b,a){},didUpdateCellBody:function(b,a){}});SC.BaseTheme.sectionedViewCoreCellRenderDelegate=CW.SectionedViewCoreCellRenderDelegate.create();sc_require("sectioned_view/render_delegates/core_cell_render_delegate");CW.SectionedViewCellRenderDelegate=CW.SectionedViewCoreCellRenderDelegate.extend({renderCellBody:function(b,a){this.renderContentArea(b,a);this.renderAccessoryType(b,a)},renderContentArea:function(a,k){var n=a.get("indentationLevelValue"),l=a.get("indentationWidthValue"),q=a.get("accessoryLayout");k=k.begin().addClass("cw-content");k.addStyle("margin-left",n*l);if(q){var s=q.width,p=q.left,m=q.right,o=5;if(s){k.addStyle("margin-right",s+m+o)}else{if(p){k.addStyle("margin-right",p+o)}}}this.willRenderContentAreaBody(a,k);this.renderContentAreaImage(a,k,CW.SectionedViewCellImageAnchor.CONTENT_AREA);this.renderContentAreaText(a,k);this.renderContentAreaDetailText(a,k);this.didRenderContentAreaBody(a,k);k.end()},willRenderContentAreaBody:function(b,a){},didRenderContentAreaBody:function(b,a){},renderContentAreaText:function(d,b){var a=d.get("textValue");if(!a){return}b=b.begin().addClass("cw-text ellipsis");this.renderContentAreaImage(d,b,CW.SectionedViewCellImageAnchor.TEXT_LEFT);this.willRenderContentAreaText(d,b);b.begin("span").attr("title",a).text(a).end();this.didRenderContentAreaText(d,b);b.end()},willRenderContentAreaText:function(b,a){},didRenderContentAreaText:function(b,a){},renderContentAreaDetailText:function(d,b){var a=d.get("detailTextValue");if(!a){return}b=b.begin().addClass("cw-detail-text");this.renderContentAreaImage(d,b,CW.SectionedViewCellImageAnchor.DETAIL_TEXT_LEFT);this.willRenderContentAreaDetailText(d,b);b.begin("span").text(a).end();this.didRenderContentAreaDetailText(d,b);b.end()},willRenderContentAreaDetailText:function(b,a){},didRenderContentAreaDetailText:function(b,a){},renderContentAreaImage:function(a,e,l){var m=a.get("imageValue"),p=a.get(this.get("styleKey")),q=p.get("imageAnchor"),k=q===l;if(!m||!k){return}var o=null,n=["cw-image"];if(k){e.addClass(q.get("classNames"))}if(m&&SC.ImageView.valueIsUrl(m)){o=m;this.willRenderContentAreaImage(a,e);e.begin("img").addClass(n).attr("src",o).end();this.didRenderContentAreaImage(a,e)}else{e.begin("i").addClass(n).addClass(m).end()}},willRenderContentAreaImage:function(b,a){},didRenderContentAreaImage:function(b,a){},renderAccessoryType:function(e,d){var a=e.get("accessoryTypeValue");if(a){d.addClass("cw-has-accessory-type")}CW.SectionedViewCellAccessoryType.render(a,e,d)},updateCellBody:function(b,a){this.updateContentArea(b,a);this.updateAccessoryType(b,a)},updateContentArea:function(b,a){this.willUpdateContentArea(b,a);this.updateContentAreaText(b,a);this.updateContentAreaDetailText(b,a);this.updateContentAreaImage(b,a);this.didUpdateContentArea(b,a)},willUpdateContentArea:function(b,a){},didUpdateContentArea:function(b,a){},updateContentAreaText:function(f,e){if(!f.didChangeFor("update","textValue")){return}var b=f.get("textValue"),d=e.find(".cw-content .cw-text span"),g=!SC.empty(b);if(!g&&d.size()>0){d.remove();this.didRemoveContentAreaText(f,e)}else{if(g&&d.size()>0){d.text(b);this.didUpdateContentAreaText(f,e)}else{if(g){e.find(".cw-content").append('<div class="%@"><span title=%@>%@</span></div>'.fmt("cw-text ellipsis",b,b));this.updateContentAreaImage(f,e.find(".cw-text"),CW.SectionedViewCellImageAnchor.TEXT_LEFT);this.didInsertContentAreaText(f,e)}}}},didRemoveContentAreaText:function(b,a){},didUpdateContentAreaText:function(b,a){},didInsertContentAreaText:function(b,a){},updateContentAreaDetailText:function(h,f){if(!h.didChangeFor("update","detailTextValue")){return}var e=h.get("detailTextValue"),b=f.find(".cw-content .cw-detail-text span"),g=!SC.empty(e);if(!g&&b.size()>0){b.remove();this.didRemoveContentAreaDetailText(h,f)}else{if(g&&b.size()>0){b.text(e);this.didUpdateContentAreaDetailText(h,f)}else{if(g){f.find(".cw-content").append('<div class="%@"><span>%@</span></div>'.fmt("cw-detail-text",e));this.updateContentAreaImage(h,f.find(".cw-detail-text"),CW.SectionedViewCellImageAnchor.DETAIL_TEXT_LEFT);this.didInsertContentAreaDetailText(h,f)}}}},didRemoveContentAreaDetailText:function(b,a){},didUpdateContentAreaDetailText:function(b,a){},didInsertContentAreaDetailText:function(b,a){},updateContentAreaImage:function(b,t,m){if(!b.didChangeFor("update","imageValue")){return}var p=b.get("imageValue"),o=t.find("."+CW.IMAGE_ANCHOR_CLASS_NAME),d=t.find(".cw-image"),l=SC.ImageView.valueIsUrl(p),n=!SC.empty(p);if(!n&&d.size()>0){d.remove();this.didRemoveContentAreaImage(b,t)}else{if(n&&d.size()>0){if(l){d.attr("src",p);d.attr("class","cw-image")}else{d.attr("class","cw-image %@".fmt(p))}this.didUpdateContentAreaImage(b,t)}else{if(n){var q=b.get("styleValue"),s=q.get("imageAnchor");if(o.size()===0&&m===s){o=t;o.addClass(s.get("classNames"))}if(l){o.prepend('<img class="cw-image" src="%@"/>'.fmt(p))}else{o.prepend('<i class="cw-image %@">'.fmt(p))}this.didInsertContentAreaImage(b,t)}}}},didRemoveContentAreaImage:function(b,a){},didUpdateContentAreaImage:function(b,a){},didInsertContentAreaImage:function(b,a){},updateAccessoryType:function(e,d){var f,a;a=e.get("accessoryTypeValue");d.setClass("cw-has-accessory-type",!!a);if(e.didChangeFor("update","accessoryTypeValue")){CW.SectionedViewCellAccessoryType.update(a,e,d)}if(e.didChangeFor("update","accessoryTypeButtonActive")){a=e.get("accessoryTypeValue");if(a){if(!f){f=d.find(".cw-accessory-type")}if(e.get("accessoryTypeButtonActive")){f.addClass("cw-active")}else{f.removeClass("cw-active")}}}}});SC.BaseTheme.sectionedViewCellRenderDelegate=CW.SectionedViewCellRenderDelegate.create();sc_require("sectioned_view/render_delegates/cell_render_delegate");CW.SectionedViewCollectionItemCellRenderDelegate=CW.SectionedViewCellRenderDelegate.extend({didRenderCellBody:function(f,e){var d=f.get("isSelectedItem");if(d){e.addClass("cw-selected-collection-item")}},didUpdateCellBody:function(f,e){var d=f.get("isSelectedItem");e.setClass("cw-selected-collection-item",!!d)}});SC.BaseTheme.sectionedViewCollectionItemCellRenderDelegate=CW.SectionedViewCollectionItemCellRenderDelegate.create();CW.SectionedViewRow=SC.Object.extend({owner:null,section:null,indexPath:null,cell:null,height:null,allowsSelection:YES,isEnabled:YES,isEnabledBindingDefault:SC.Binding.oneWay(),content:null,selectedTarget:null,selectedAction:null,deselectedTarget:null,deselectedAction:null,accessoryButtonTappedTarget:null,accessoryButtonTappedAction:null,isBindingAgent:YES,isContent:function(){return !this.get("content")}.property("content").cacheable(),selected:function(e){var f=this.get("selectedTarget"),d=this.get("selectedAction");this.willRespondToSelectedAction(e);this.sendAction(e,f,d);this.didRespondToSelectedAction(e)},willRespondToSelectedAction:function(b){},didRespondToSelectedAction:function(b){},deselected:function(e){var f=this.get("deselectedTarget"),d=this.get("deselectedAction");this.willRespondToDeselectedAction(e);this.sendAction(e,f,d);this.didRespondToDeselectedAction(e)},willRespondToDeselectedAction:function(b){},didRespondToDeselectedAction:function(b){},accessoryButtonTapped:function(e){var f=this.get("accessoryButtonTappedTarget"),d=this.get("accessoryButtonTappedAction");this.willRespondToAccessoryButtonTappedAction(e);this.sendAction(e,f,d);this.didRespondToAccessoryButtonTappedAction(e)},willRespondToAccessoryButtonTappedAction:function(b){},didRespondToAccessoryButtonTappedAction:function(b){},sendAction:function(g,j,k){if(!k){return}var h=g.get("pane"),f=h.get("rootResponder");f.sendAction(k,j,this,h)}});sc_require("sectioned_view/views/sectioned_view_cell");sc_require("sectioned_view/rows/row");CW.SectionedViewButtonRow=CW.SectionedViewRow.extend({title:null,titleBindingDefault:SC.Binding.oneWay(),image:null,imageBindingDefault:SC.Binding.oneWay(),isEnabled:YES,isDefault:NO,isDefaultBindingDefault:SC.Binding.oneWay().bool(),cellStyle:null,cell:CW.SectionedViewCell.extend({style:CW.SectionedViewCellStyle.BUTTON,styleBinding:SC.Binding.transform(function(b){if(SC.none(b)){return CW.SectionedViewCellStyle.BUTTON}return b}).from("*owner.cellStyle"),contentTextKey:"title",performKeyEquivalent:function(g,h){if(!this.get("isVisibleInWindow")){return NO}if(!this.get("isEnabled")){return NO}var m=this.get("content"),k=m.get("isDefault"),l=m.get("selectedAction"),j=m.get("selectedTarget");if(k&&(g==="return")){m.sendAction(this.owner,j,l)}return NO}}),willRespondToSelectedAction:function(b){b.deselectRowAtIndexPath(this.get("indexPath"))}});sc_require("sectioned_view/views/sectioned_view_cell");sc_require("sectioned_view/rows/row");CW.SectionedViewDoubleLineRow=CW.SectionedViewRow.extend({height:50,title:null,titleBindingDefault:SC.Binding.oneWay(),image:null,imageBindingDefault:SC.Binding.oneWay(),isEnabled:YES,cellStyle:null,cell:CW.SectionedViewCell.extend({style:CW.SectionedViewCellStyle.DOUBLE_LINE_ROW,contentTextKey:"title",})});sc_require("sectioned_view/rows/row");sc_require("sectioned_view/views/sectioned_view_cell");CW.SectionedViewSelectRow=CW.SectionedViewRow.extend({title:null,value:null,items:null,itemTitleKey:"title",itemImageKey:"image",itemValueKey:"value",style:CW.SectionedViewCellStyle.DEFAULT2,cell:CW.SectionedViewCell.extend({contentTextKey:"title",accessoryType:CW.SectionedViewCellAccessoryType.DISCLOSURE_INDICATOR}),_valueDidChange:function(){var o=this.get("value"),p=this.get("items"),s=p.length,m=this.get("itemTitleKey"),n=this.get("itemValueKey"),t=this.get("itemImageKey"),v=null,u;if(!n&&SC.typeOf(o)===SC.T_NUMBER&&o>=0&&o<s){v=p[o]}else{if(n){for(u=0;u<s;u+=1){if(p[u][n]===o){v=p[u];break}}}}var x=SC.typeOf(v),q=null,w=null;if(x===SC.T_HASH){q=v[m];w=v[t]}else{if(x===SC.T_OBJECT){q=v.get(m);w=v.get(t)}else{if(!SC.none(v)){q=v}}}this.beginPropertyChanges();this.set("detailText",q);this.set("image",w);this.endPropertyChanges()}.observes("value")});sc_require("sectioned_view/rows/row");sc_require("sectioned_view/mixins/switcher_accessory_view_support");CW.SectionedViewSwitcherRow=CW.SectionedViewRow.extend(CW.SwitcherAccessoryViewSupport,{title:null,value:null,allowsSelection:NO,cell:CW.SectionedViewCell.extend({contentTextKey:"title"})});sc_require("sectioned_view/rows/row");sc_require("sectioned_view/views/sectioned_view_cell");CW.SectionedViewTextFieldRow=CW.SectionedViewRow.extend({value:"",title:"",hint:"",hintBindingDefault:SC.Binding.oneWay(),isPassword:NO,isPasswordBindingDefault:SC.Binding.bool().oneWay(),spellCheckEnabled:NO,spellCheckEnabledBindingDefault:SC.Binding.bool().oneWay(),autoCorrect:YES,autoCorrectBindingDefault:SC.Binding.bool().oneWay(),autoCapitalize:YES,autoCapitalizeBindingDefault:SC.Binding.bool().oneWay(),type:"text",textBindingDefault:SC.Binding.oneWay(),layout:null,defaultLayout:{left:150,top:5,bottom:5,right:10},allowsSelection:NO,accessoryViewExample:SC.TextFieldView.extend({themeName:"iOS",hintBinding:SC.Binding.oneWay(".bindingAgent.hint"),isPasswordBinding:SC.Binding.oneWay(".bindingAgent.isPassword"),valueBinding:".bindingAgent.value",spellCheckEnabledBinding:SC.Binding.oneWay(".bindingAgent.spellCheckEnabled"),autoCorrectBinding:SC.Binding.oneWay(".bindingAgent.autoCorrect"),autoCapitalizeBinding:SC.Binding.oneWay(".bindingAgent.autoCapitalize")}),accessoryView:function(){var j=this.get("accessoryViewExample"),n=this.get("layout")||{},m=SC.clone(this.get("defaultLayout")),k=n.left,o=n.right,l=n.top,h=n.bottom;if(!SC.none(k)){m.left=k}if(!SC.none(o)){m.right=o}if(!SC.none(l)){m.top=l}if(!SC.none(h)){m.bottom=h}return j.extend({type:this.get("type"),layout:m})}.property("accessoryViewExample").cacheable()});sc_require("sectioned_view/views/sectioned_view_cell");sc_require("sectioned_view/rows/row");CW.SectionedViewWarningRow=CW.SectionedViewRow.extend({description:null,descriptionBindingDefault:SC.Binding.oneWay(),image:null,imageBindingDefault:SC.Binding.oneWay(),cellStyle:null,cell:CW.SectionedViewCell.extend({style:CW.SectionedViewCellStyle.WARNING_ROW,contentTextKey:"description",})});CW.SectionedViewSection=SC.Object.extend({owner:null,index:0,rows:[],footerTitle:null,autoResizeFooterTitle:YES,headerTitle:null,autoResizeHeaderTitle:YES,footerView:null,headerView:null,footerHeight:null,headerHeight:null,allowsSelection:YES,isVisible:YES,isCellDisplayDelegate:YES,cell:null,init:function(){arguments.callee.base.apply(this,arguments);this.createRows()},rowForIndex:function(b){return this.get("rows").objectAt(b)},createRows:function(){var k=(this.get("rows")||[]).slice();for(var f=0,g=k.length;f<g;f+=1){var h=k[f],j=this.createRow(this[h],f);if(!j){throw'section has an invalid row "%@" for rows[%@]'.fmt(h,f)}k[f]=this[h]=j}this.set("rows",k)},createRow:function(g,h,e){e=e||{};if(SC.kindOf(g,CW.SectionedViewCoreCell)&&g.isClass){var f=g;g=CW.SectionedViewRow.extend({isContent:NO,cell:f})}else{if(!(SC.kindOf(g,CW.SectionedViewRow)&&g.isClass)){return null}}g=g.create(e,{owner:this.get("owner"),section:this,indexPath:CW.IndexPath.create({section:this.get("index"),row:h})});return g},destoryRows:function(){var b=this.get("rows")||[];b.forEach(function(a){a.destroy()},this);this.set("rows",[])},reload:function(){this.destoryRows();this.createRows();this.get("owner").reloadSection(this.get("index"))},displayDelegateForRow:function(b){return this.get("isDisplayDelegate")?this:null},sectionedViewWillSetupAllCells:function(b){},sectionedViewDidSetupAllCells:function(b){},sectionedViewWillTearDownAllCells:function(b){},sectionedViewDidTearDownAllCells:function(b){}});sc_require("sectioned_view/sections/section");sc_require("sectioned_view/rows/button_row");CW.SectionedViewButtonSection=CW.SectionedViewSection.extend({title:null,titleBindingDefault:SC.Binding.oneWay(),image:null,imageBindingDefault:SC.Binding.oneWay(),isEnabled:YES,isEnabledBindingDefault:SC.Binding.oneWay(),isDefault:NO,isDefaultBindingDefault:SC.Binding.oneWay().bool(),selectedTarget:null,selectedAction:null,buttonRow:CW.SectionedViewButtonRow,cellStyle:null,createRows:function(){var b=this.get("buttonRow");b=this.createRow(b,0,{titleBinding:".section.title",imageBinding:".section.image",isEnabledBinding:".section.isEnabled",isDefaultBinding:".section.isDefault",selectedTarget:this.get("selectedTarget"),selectedAction:this.get("selectedAction"),style:this.get("cellStyle")});this.beginPropertyChanges();this.set("rows",[b]);this.set("buttonRow",b);this.endPropertyChanges()}});sc_require("sectioned_view/views/sectioned_view_cell");CW.SectionedViewCollectionItemCell=CW.SectionedViewCell.extend({renderDelegateName:"sectionedViewCollectionItemCellRenderDelegate",isSelectedItem:NO,accessoryType:function(){var b=this.get("isSelectedItem");return b?CW.SectionedViewCellAccessoryType.DETAIL_CHECKMARK:null}.property("isSelectedItem"),displayProperties:"isSelectedItem".w()});sc_require("sectioned_view/sections/section");sc_require("sectioned_view/rows/row");sc_require("sectioned_view/views/sectioned_view_collection_item_cell");sc_require("sectioned_view/mixins/collection_section_delegate");CW.SectionedViewCollectionSection=CW.SectionedViewSection.extend(SC.DelegateSupport,CW.SVCollectionSectionDelegate,{content:null,selection:null,delegate:null,target:null,action:null,retainItemSelection:NO,itemsHeaderRow:null,itemsHeaderHeight:null,itemsHeaderCell:null,itemsFooterRow:null,itemsFooterCell:null,itemsFooterHeight:null,itemRowHeight:null,itemCellExample:CW.SectionedViewCollectionItemCell,retainedItemSelectionStyle:CW.SectionedViewCellSelectionStyle.BLUE,normalizedBasicItemValueKey:"text",hasItemsHeader:function(){return this.get("itemsHeaderRow")||this.get("itemsHeaderCell")}.property("itemsHeaderRow","itemsHeaderCell").cacheable(),hasItemsFooter:function(){return this.get("itemsFooterRow")||this.get("itemsFooterCell")}.property("itemsFooterRow","itemsFooterCell").cacheable(),collectionSectionDelegate:function(){var b=this.get("delegate");return this.delegateFor("isSVCollectionSectionDelegate",b)}.property("delegate").cacheable(),createRows:function(){var e=[],f=this._createItemRows(),g=this._createHeaderRow(),h=this._createFooterRow();if(g){e.push(g)}if(f){e.pushObjects(f)}if(h){e.push(h)}this._itemsHeaderRow=g;this._itemsFooterRow=h;this._itemRows=f;this.set("rows",e)},_createItemRows:function(){var l=[],n=this.get("content")||[],h=this.get("collectionSectionDelegate"),o=CW.SectionedViewCellSelectionStyle.NONE,j=CW.SectionedViewCollectionSection,m=j._ItemRow,k;if(this.get("retainItemSelection")){o=this.get("retainedItemSelectionStyle")}n.forEach(function(a,d){var e=h.collectionSectionCellForContentAtIndex(this,a,d);if(!e){e=this.get("itemCellExample")}var f=h.collectionSectionRowHeightForContentAtIndex(this,a,d);if(!f){f=this.get("itemRowHeight")}d+=this.get("hasItemsHeader")?1:0;var b=this._normalizeItem(a);b.set("selectionStyle",o);k=this.createRow(m,d,{content:b,cell:e,height:f});k._svcs_originalItem=a;l.push(k)},this);return l},_normalizeItem:function(f){var d=SC.typeOf(f);if(d===SC.T_OBJECT){return f}if(d===SC.T_HASH){return SC.Object.create(f)}var e={};e[this.get("normalizedBasicItemValueKey")]=f;return SC.Object.create(e)},_createHeaderRow:function(){var f=this.get("itemsHeaderRow"),d=this.get("itemsHeaderCell"),e=this.get("itemsHeaderHeight");if(d){f=CW.SectionedViewRow.extend({isContent:NO,cell:d,height:e})}else{if(!f){return null}}return this.createRow(f,0)},_createFooterRow:function(){var h=this.get("itemsFooterRow"),k=this.get("itemsFooterCell"),f=this.get("itemsFooterHeight");if(k){h=CW.SectionedViewRow.extend({isContent:NO,cell:k,height:f})}else{if(!h){return null}}var g=0,j=this.get("content")||[];if(this.get("hasItemsHeader")){g+=1}g+=j.get("length");return this.createRow(h,g)},_itemsDidChange:function(){this.reload();this._selectionDidChange()}.observes("*content.[]"),_selectionDidChange:function(){var e=this.get("owner"),h=this.get("selection"),f,g;g=this._selectedRow;if(g){f=e.cellForRowAtIndexPath(g.get("indexPath"));if(f){f.set("isSelectedItem",NO)}}g=this.rowForItem(h);if(g){f=e.cellForRowAtIndexPath(g.get("indexPath"));if(f){f.set("isSelectedItem",YES)}}this._selectedRow=g}.observes("selection"),rowForItem:function(h){var e=this.get("content")||[],g=this._itemRows||[],f=h?e.indexOf(h):-1;return f>=0?g[f]:null},selectItemRow:function(g){var f=this.get("owner"),h=this.get("target"),e=this.get("action");this.set("selection",g._svcs_originalItem);this.invokeLast(function(){g.sendAction(f,h,e)})},sectionedViewDidSetupAllCells:function(b){this._selectionDidChange()},displayDelegateForRow:function(b){b=this.rows[b];return this._itemRows.indexOf(b)>=0?this:null}});CW.SectionedViewCollectionSection._ItemRow=CW.SectionedViewRow.extend({selected:function(b){this.get("section").selectItemRow(this)}});var CW_ACTION_SHEET_BUTTON_HEIGHT=67;var CW_ACTION_SHEET_BOTTOM_PADDING=20;var CW_ACTION_SHEET_SIDE_MARGINS=10;var CW_ACTION_SHEET_TEXT_WIDTH=290;CW.ActionSheet=SC.View.extend(CW.Animatability,{classNames:"cw-action-sheet",actionSheetButtons:null,actionSheetMessage:null,actionSheetMessageEscaped:YES,childViews:["sheet"],sheetHeight:0,wantsAcceleratedLayer:YES,descriptionAction:null,sheet:SC.View.design(CW.Animatability,{classNames:"cw-actions"}),init:function(){arguments.callee.base.apply(this,arguments);var l,m;for(var n=0,j=this.actionSheetButtons.length;n<j;n++){m=this.actionSheetButtons[n];l=SC.ButtonView.create({themeName:m.themeName,target:m.target,action:m.action,title:m.title,layout:{left:CW_ACTION_SHEET_SIDE_MARGINS,right:CW_ACTION_SHEET_SIDE_MARGINS,height:46,bottom:CW_ACTION_SHEET_BUTTON_HEIGHT*(j-n-1)+CW_ACTION_SHEET_BOTTOM_PADDING}});this.sheet.appendChild(l)}var k=SC.heightForString(this.actionSheetMessage,CW_ACTION_SHEET_TEXT_WIDTH,null,"atv3 iOS sc-label-view sc-small-size".w(),!this.actionSheetMessageEscaped);var h=SC.LabelView.create({layout:{top:15,height:k,left:CW_ACTION_SHEET_SIDE_MARGINS,right:CW_ACTION_SHEET_SIDE_MARGINS},controlSize:SC.SMALL_CONTROL_SIZE,textAlign:SC.ALIGN_CENTER,escapeHTMLBinding:"*parentView.parentView.actionSheetMessageEscaped",valueBinding:"*parentView.parentView.actionSheetMessage"});this.sheet.appendChild(h);var o=j*CW_ACTION_SHEET_BUTTON_HEIGHT+CW_ACTION_SHEET_BOTTOM_PADDING+(15+k);this.sheet.set("layout",{right:0,left:0,bottom:-o,height:o})}});sc_require("views/action_sheet");CW.ActionSheetSupport={actionSheetClass:CW.ActionSheet,_currentActionSheet:null,_previousLeftBarButtonState:null,_previousRightBarButtonState:null,animationDuration:350,actionSheetHeight:null,showActionSheet:function(){this._currentActionSheet=this.actionSheetClass.create();this.childViews[0].appendChild(this._currentActionSheet);var e=this._currentActionSheet,d=e.childViews[0];this.set("actionSheetHeight",e.sheet.layout.height);this._disableNavigationButtons();if(!SC.browser.msie){e.animate({opacity:{to:1,from:0,duration:this.animationDuration}})}d.animate({bottom:{to:0,duration:this.animationDuration}})},hideActionSheet:function(){var e=this._currentActionSheet;if(SC.none(e)){return}var f=e.childViews[0];this._enableNavigationButtons();if(!SC.browser.msie){e.animate({opacity:{to:0,from:1,duration:this.animationDuration}})}var d=this;f.animate({bottom:{to:-f.get("layout").height,duration:this.animationDuration}},{notifyThatIJustFinished:function(){d.childViews[0].removeChild(e);d._currentActionSheet=null;e.destroy()}.listens("finish")})},_disableNavigationButtons:function(){var e=this.getPath("navigationController.viewStack"),d=e[e.length-1];d.set("realLeftBarButtonIsEnabled",NO);d.set("realHasLeftBarButton",NO);d.set("realRightBarButtonIsEnabled",NO);d.set("realHasRightBarButton",NO)},_enableNavigationButtons:function(){var e=this.getPath("navigationController.viewStack"),d=e[e.length-1];d.set("realLeftBarButtonIsEnabled",YES);d.set("realHasLeftBarButton",YES);d.set("realRightBarButtonIsEnabled",YES);d.set("realHasRightBarButton",YES)}};CW.BorderView=SC.View.extend({classNames:"cw-border-view",renderDelegateName:"borderRenderDelegate"});CW.BUTTON1_STATUS="button1";CW.BUTTON2_STATUS="button2";CW.iOSAlert=SC.PanelPane.extend(CW.SpritePreloadEnforcement,{classNames:"ios-alert".w(),message:"",description:null,extraView:null,extraViewPaddingTop:-2,extraViewPaddingBottom:0,shouldOptimizeMessageLineWidth:YES,shouldOptimizeDescriptionLineWidth:YES,escapeHTML:NO,modalPane:SC.ModalPane.extend(CW.Animatability,CW.PaneFadingSupport,{classNames:"ios-modal".w(),paneFadeInDuration:!SC.browser.webkit?350:function(){return 350*(innerWidth<1983&&innerHeight<1983)}.property(),paneFadeOutDuration:function(){return this.get("paneFadeInDuration")}.property(),paneOpacity:0.5,init:function(){if((SC.browser.webkit)&&(innerWidth>=1983||innerHeight>=1983)){this.classNames.push("no-gpu")}arguments.callee.base.apply(this,arguments);var e=SC.RootResponder.responder.mainPane;if(e){var d=e.layout.minWidth,f=e.layout.minHeight;if(d){this.adjust("minWidth",d)}if(f){this.adjust("minHeight",f)}}}}),delegate:null,layout:{centerX:0,width:262},buttons:["OK"],buttonMixin:{themeName:"popupAlertSheet",localize:YES,action:"dismiss"},init:function(){if(!this.hasOwnProperty("buttons")){this.buttons=SC.clone(this.buttons)}arguments.callee.base.apply(this,arguments)},append:function(){var d=this,f=arguments.callee.base,e=arguments;SC.run(function(){f.apply(d,arguments)})},contentView:SC.View.extend({layout:{left:0,right:0,top:0,bottom:0},childViews:["buttons"],buttons:SC.View.extend({layout:{left:0,right:0,bottom:0}}),render:function(f){var g=this.get("pane"),h=g.get("message"),e=g.get("description");if(g.get("escapeHTML")){h=SC.RenderContext.escapeHTML(h);if(e){e=SC.RenderContext.escapeHTML(e)}}f.push('<div class="title-label" role="heading">'+h+"</div>"+(e?'<div class="description">'+e+"</div>":""))},update:function(){var l=this.get("pane");var p=this.generateButtonsIfNeeded(),m=this.performTextLayoutIfNeeded(),q=this.prepareExtraViewIfNeeded(),j=this._extraView,k=Math.max(this._minHeight,p+m+q),o,n;if(j){o=m;n=k-q-p;j.adjust("top",Math.round((o+n)/2)+l.get("extraViewPaddingTop"))}l.adjust("height",k)},didCreateLayer:function(){this._message=this.$(".title-label")[0];this._description=this.$(".description")[0];this.invokeLast("update")},_messagePadding:{top:10,bottom:7,left:8,right:8},_descriptionPadding:{top:3,bottom:7,left:8,right:8},_buttonsPaddingTop:7,_buttonSpacing:6,_buttonGapRoom:12,_minHeight:119,performTextLayoutIfNeeded:function(){if(this._textLayout){return this._textLayout.totalHeight}var t=this._textLayout||(this._textLayout={messageStyle:{},descriptionStyle:{}}),s=t.messageStyle,m=this._message,o=this._messagePadding,q=t.descriptionStyle,n=this._description,u=this._descriptionPadding,v=this.get("pane"),w=v.get("frame").width,p,x;if(v.get("shouldOptimizeMessageLineWidth")){p=SC.bestStringMetricsForMaxWidth(m.innerHTML,w-o.left-o.right,m,null,true)}else{m.style.maxWidth=w-o.left-o.right+"px";p=SC.metricsForString(m.innerHTML,m,null,true)}s.top=o.top;s.width=p.width;s.height=p.height;s.marginLeft=Math.round(p.width/-2);t.totalHeight=s.top+s.height+o.bottom;for(x in s){s[x]+="px"}if(n){if(v.get("shouldOptimizeDescriptionLineWidth")){p=SC.bestStringMetricsForMaxWidth(n.innerHTML,w-u.left-u.right,n,null,true)}else{n.style.maxWidth=w-u.left-u.right+"px";p=SC.metricsForString(n.innerHTML,n,null,true)}q.top=t.totalHeight+u.top;q.width=p.width;q.height=p.height;q.marginLeft=Math.round(p.width/-2);t.totalHeight=q.top+q.height+u.bottom;for(x in q){q[x]+="px"}}SC.mixin(m.style,s);if(n){SC.mixin(n.style,q)}return t.totalHeight},generateButtonsIfNeeded:function(){if(this._areButtonsGenerated){return this._buttonsHeight}var D=this.get("pane"),t=this.get("buttons"),v=D.get("buttons"),s=D.get("buttonMixin"),u=CW.IOSBIG_BUTTON_REGULAR_HEIGHT,w=this._buttonSpacing,F=D.get("frame").width,C=v.length,x=C===2,q=0,z,E,A,B,y;for(A=0;B=v[A];A++){if(typeof B==="string"){v[A]={title:B}}}if(C===1&&(z=v[0])&&z.isDefault===undefined&&z.isCancel===undefined){z.isDefault=YES;z.isCancel=YES}if(x&&(z=v[0])&&(E=v[1])&&z.isDefault===undefined&&z.isCancel===undefined&&E.isDefault===undefined&&E.isCancel===undefined){z.isCancel=E.isDefault=YES}for(A=0;B=v[A];A++){if(C>2&&A>0&&B.isGapped){q+=this._buttonGapRoom}if(x&&A===0){y={left:0,right:Math.round(F/2+2),top:0,height:u}}else{if(x&&A===1){y={left:Math.round(F/2+2),right:0,top:0,height:u}}else{y={left:0,right:0,top:q,height:u}}}t.appendChild(v[A]=SC.ButtonView.create(s,B,SC.AutoResize,{shouldResizeWidth:NO,shouldAutoFitText:YES,layout:y,actionKey:CW["BUTTON"+(A+1)+"_STATUS"]||(CW["BUTTON"+(A+1)+"_STATUS"]="button"+(A+1))}));if(!x||A===0){q+=u+w}}q-=w;t.adjust("height",q);this._areButtonsGenerated=true;this._buttonsHeight=q+this._buttonsPaddingTop;return this._buttonsHeight},prepareExtraViewIfNeeded:function(){var j=this.get("pane");if(this._extraViewIsPrepared){return(this._extraView&&this._extraView.get("layout").height+j.get("extraViewPaddingTop")+j.get("extraViewPaddingBottom"))||0}this._extraViewIsPrepared=YES;var g=j.get("extraView"),m=this.get("frame").width,h,l,k;if(!g){return 0}if(g.isClass){j.set("extraView",g=g.create())}l=g.get("layout");if(typeof l.height==="number"){h=l.height}else{h=(k=g.get("frame")).height}if(typeof l.height!=="number"){SC.warn("The extraView provided to this iOSAlert did not have a recognizable height (in its layout, or in its frame). Ignoring the extraView.");j.set("extraView",null);return 0}if(g.get("parentView")!==this){g.removeFromParent();this.appendChild(g)}g.set("layout",{left:0,width:m,height:h});this.set("extraView",this._extraView=g);this._lastExtraViewHeight=h+j.get("extraViewPaddingTop")+j.get("extraViewPaddingBottom");return this._lastExtraViewHeight},extraViewFrameDidChange:function(){var d=this.getPath("extraView.frame"),f=this.get("pane"),e=(d&&d.height+f.get("extraViewPaddingTop")+f.get("extraViewPaddingBottom"))||0;if(this._lastExtraViewHeight===e){return}this._lastExtraViewHeight=e;this.update()}.observes("extraView.frame")}),repositionInWindow:function(){var e=this.get("frame").height,d=this.get("currentWindowSize");if(!d){SC.warn("currentWindowSize is not accessible from pane "+this+"! Aborting...");return}d=d.height;if(this._lastFHeight===e&&this._lastWHeight===d){return}this.adjust("top",Math.max(0,Math.round((d-e)/2.5)));this._lastFHeight=e;this._lastWHeight=d}.observes("frame","currentWindowSize"),dismiss:function(d){var e=this.delegate||this;if(e&&e.alertPaneDidDismiss){e.alertPaneDidDismiss(this,d&&d.get("actionKey"))}this.remove()}});CW.iOSAlert.show=function(s,v,B,H,G,F,u,w,C,x){var D;if(SC.typeOf(s)===SC.T_HASH){D=CW.iOSAlert.create(s);D.append();SC.run(function(){D.awake()});return D}var A=SC.A(arguments);var E=A[A.length-1],y=SC.typeOf(E);if(y===SC.T_OBJECT||y===SC.T_HASH){x=E}else{x=null}if(F&&!G){G=F;w=C;F=C=undefined}var z;if(G){z=[{title:G}]}if(F){z.push({title:F})}if(w!==undefined&&z[0]){z[0].isDefault=w}if(C!==undefined&&z[1]){z[1].isDefault=C}var t={message:s||"",description:v||null,escapeHTML:u||NO,delegate:x};!z||(t.buttons=z);D=this.create(t);D.append();SC.run(function(){D.awake()});return D};CW.NavigatableView=SC.View.extend(CW.Animatability,{isNavigatable:YES,navigationController:null,title:"",icon:null,escapeHTML:YES,navigationBarTheme:"iOS",hasLeftBarButton:YES,leftBarButtonTitle:" ",leftBarButtonIsEnabled:YES,leftBarButtonTheme:"navigationBarBlackOpaqueBack",leftBarButtonTarget:this,leftBarButtonAction:function(){this.getPath("parentView.parentView.navigationController").pop()},rightBarButtonTheme:"navigationBarDone",hasRightBarButton:NO,rightBarButtonTitle:" ",rightBarButtonIsEnabled:YES,rightBarButtonTarget:null,rightBarButtonAction:"",toolbarView:null,_realLeftBarButtonIsEnabled:null,showPopupButton:NO,menu:null,leftBarButtonIcon:null,rightBarButtonIcon:null,leftBarButtonControlSize:null,rightBarButtonControlSize:null,realLeftBarButtonIsEnabled:function(e,d){if(d!==undefined){if(d===NO){this._realLeftBarButtonIsEnabled=d}else{this._realLeftBarButtonIsEnabled=null}}return SC.none(this._realLeftBarButtonIsEnabled)?this.get("leftBarButtonIsEnabled"):this._realLeftBarButtonIsEnabled}.property("leftBarButtonIsEnabled"),_realRightBarButtonIsEnabled:null,realRightBarButtonIsEnabled:function(e,d){if(d!==undefined){if(d===NO){this._realRightBarButtonIsEnabled=d}else{this._realRightBarButtonIsEnabled=null}}return SC.none(this._realRightBarButtonIsEnabled)?this.get("rightBarButtonIsEnabled"):this._realRightBarButtonIsEnabled}.property("rightBarButtonIsEnabled"),_realHasLeftBarButton:null,realHasLeftBarButton:function(e,d){if(d!==undefined){if(d===NO){this._realHasLeftBarButton=d}else{this._realHasLeftBarButton=null}}return SC.none(this._realHasLeftBarButton)?this.get("hasLeftBarButton"):this._realHasLeftBarButton}.property("hasLeftBarButton"),_realHasRightBarButton:null,realHasRightBarButton:function(e,d){if(d!==undefined){if(d===NO){this._realHasRightBarButton=d}else{this._realHasRightBarButton=null}}return SC.none(this._realHasRightBarButton)?this.get("hasRightBarButton"):this._realHasRightBarButton}.property("hasRightBarButton")});sc_require("navigation_controller");CW.NavigationBarView=SC.View.extend(CW.Animatability,{classNames:["cw-navigation-bar"],themeNameBinding:".parentView.associatedView.navigationBarTheme",childViews:"barContainer".w(),barContainer:SC.View.design({childViews:"title popupButton leftBarButton rightBarButton".w(),classNames:"cw-bar-container".w(),layout:function(){var b=this.get("parentView");while(b){if(b.kindOf(CW.iOSPickerPane)){return{top:6,left:0}}b=b.get("parentView")}return{top:6,left:5,right:5}}.property(),title:SC.LabelView.design({classNames:["cw-navigation-bar-item","cw-navigation-bar-title"],textAlign:SC.ALIGN_CENTER,escapeHTMLBinding:".parentView.parentView.associatedView.escapeHTML",iconBinding:".parentView.parentView.associatedView.icon",valueBinding:".parentView.parentView.associatedView.title",ariaRole:"heading",isVisibleBinding:SC.Binding.not(".parentView.parentView.associatedView.showPopupButton"),}),popupButton:SC.View.design({classNames:["cw-navigation-bar-item","cw-navigation-bar-popup-view"],layout:{left:65,right:65},isVisibleBinding:".parentView.parentView.associatedView.showPopupButton",childViews:["button","arrow"],button:SC.PopupButtonView.design(SC.AutoResize,{classNames:["cw-navigation-bar-item","cw-navigation-bar-popup-button"],controlSize:SC.HUGE_CONTROL_SIZE,layout:{top:1,height:30},titleBinding:".parentView.parentView.parentView.associatedView.title",menuBinding:".parentView.parentView.parentView.associatedView.menu",render:function(a,b){arguments.callee.base.apply(this,arguments);if(b){this.adjust("maxWidth",this.getPath("parentView.frame.width"))}}}),arrow:SC.LabelView.design({classNames:["cw-navigation-bar-item","cw-navigation-bar-title"],layout:{width:17,height:30},value:"",mouseDown:function(){this.parentView.button.mouseDown()},touchStart:function(){this.mouseDown()}}),childViewsFrameDidChange:function(){var a=(this.getPath("frame.width")-this.getPath("button.frame.width"))/2;if(a==0){a=0}else{a+=5}this.arrow.adjust("right",a)}.observes(".button.frame")}),leftBarButton:SC.ButtonView.design(SC.AutoResize,{layout:{top:1,left:0,height:30,width:60,minWidth:30,},autoResizePadding:8,classNames:["cw-navigation-bar-item"],themeNameBinding:".parentView.parentView.associatedView.leftBarButtonTheme",isVisibleBinding:".parentView.parentView.associatedView.realHasLeftBarButton",isEnabledBinding:".parentView.parentView.associatedView.realLeftBarButtonIsEnabled",titleBinding:".parentView.parentView.associatedView.leftBarButtonTitle",targetBinding:".parentView.parentView.associatedView.leftBarButtonTarget",actionBinding:".parentView.parentView.associatedView.leftBarButtonAction",maxWidthBinding:".parentView.parentView.associatedView.leftBarButtonMaxWidth",iconBinding:".parentView.parentView.associatedView.leftBarButtonIcon",controlSizeBinding:".parentView.parentView.associatedView.leftBarButtonControlSize",}),rightBarButton:SC.ButtonView.design(SC.AutoResize,{layout:{top:1,right:0,height:30,width:60,minWidth:30,},autoResizePadding:10,classNames:["cw-navigation-bar-item"],themeNameBinding:".parentView.parentView.associatedView.rightBarButtonTheme",isVisibleBinding:".parentView.parentView.associatedView.realHasRightBarButton",isEnabledBinding:".parentView.parentView.associatedView.realRightBarButtonIsEnabled",titleBinding:".parentView.parentView.associatedView.rightBarButtonTitle",targetBinding:".parentView.parentView.associatedView.rightBarButtonTarget",actionBinding:".parentView.parentView.associatedView.rightBarButtonAction",maxWidthBinding:".parentView.parentView.associatedView.rightBarButtonMaxWidth",iconBinding:".parentView.parentView.associatedView.rightBarButtonIcon",controlSizeBinding:".parentView.parentView.associatedView.rightBarButtonControlSize",}),didCreateLayer:function(d){if(d){d()}var e=this;this.invokeLater(function(){e.performLayout()})}.enhance(),performLayout:function(){var q=this.get("leftBarButton"),n=this.get("rightBarButton"),d=this.get("title"),v=this._computeRequiredButtonWidth(q),b=this._computeRequiredButtonWidth(n),u=this._computeRequiredTitleWidth(),m=this.getPath("parentView.frame.width"),s=CW.NavigationBarView.LEFT_BUTTON_PADDING,p=CW.NavigationBarView.RIGHT_BUTTON_PADDING,e=CW.NavigationBarView.TITLE_BUTTON_PADDING,o=u/2+s+e+v,t=u/2+p+e+b;d.set("layout",{left:s+e+Math.max(v,CW.NavigationBarView.MIN_TITLE_PADDING),right:p+e+Math.max(b,CW.NavigationBarView.MIN_TITLE_PADDING),centerX:0})},titleDidChange:function(){this.performLayout()}.observes("title.value"),_computeRequiredTitleWidth:function(){var d=this.get("title");if(SC.none(d)){return 0}var e=d.get("autoResizeLayer");if(SC.none(e)){return 0}return SC.metricsForString(d.get("value"),e,d.get("classNames"),d.get("escapeHTML")).width},_computeRequiredButtonWidth:function(b){if(SC.none(b)||(!b.get("isVisible"))){return 0}return b.getPath("frame.width")}})});CW.NavigationBarView.LEFT_BUTTON_PADDING=5;CW.NavigationBarView.RIGHT_BUTTON_PADDING=5;CW.NavigationBarView.TITLE_BUTTON_PADDING=5;CW.NavigationBarView.MIN_TITLE_PADDING=40;CW.NavigationView=SC.View.extend(CW.Animatability,{classNames:["cw-navigation-view"],navigationController:null,navigationBar:null,navigationBarHeight:44,actionSheetContent:null,contentView:null,wellViewClassType:CW.BorderView,init:function(){var e=this.get("navigationController"),d=this.get("contentView");e.set("navigationView",this);arguments.callee.base.apply(this,arguments)},createChildViews:function(){var f=this.get("wellViewClassType"),g=this.get("navigationBarHeight"),e={top:g,left:0,right:0,bottom:0};var h=this.createChildView(f,{layout:e,classNames:["cw-navigation-well"]});this.set("well",h);this.childViews=[h]},didCreateLayer:function(){this.invokeLast(function(){var b=this.get("contentView").create();this.get("navigationController").push(b,NO)})}});CW.PanelPane=SC.PanelPane.extend({classNames:"cw-panel-pane".w(),displayProperties:["hasTabBar","hasNavigationBar","isFullScreen"],hasTabBar:NO,hasNavigationBar:NO,renderDelegateName:"sheetPaneRenderDelegate",isFullScreen:NO,init:function(){if(CW.isMobile()){this.set("isFullScreen",YES)}if(this.get("isFullScreen")){this.layout={left:0,top:0,right:0,bottom:0};this.set("isModal",NO)}arguments.callee.base.apply(this,arguments)},});CW.TouchScrollerView=SC.TouchScrollerView.extend({touchScrollDidStart:function(){arguments.callee.base.apply(this,arguments);this.$(".thumb").css("opacity",0.5)},touchScrollDidEnd:function(){arguments.callee.base.apply(this,arguments);this.$(".thumb").css("opacity",0)}});SC.ScrollView.prototype.verticalTouchScrollerView=CW.TouchScrollerView;SC.ScrollView.prototype.horizontalTouchScrollerView=CW.TouchScrollerView;SC.BaseTheme.steedWindowRenderDelegate=SC.RenderDelegate.create({className:"window",render:function(g,d){var e=g.get("hasTabBar");var b=g.get("hasNavigationBar");if(e){d.addClass("has-tab-bar")}if(b){d.addClass("has-navigation-bar")}var f=d.begin("div").addClass("window-mask");d=d.begin("div").addClass("window-background");this.includeSlices(g,d,SC.NINE_SLICE);d=d.end();f.end();if(b){d=d.begin("div").addClass("navigation-bar");this.includeSlices(g,d,SC.THREE_SLICE);d.end()}if(e){d=d.begin("div").addClass("tab-bar");this.includeSlices(g,d,SC.THREE_SLICE);d.end()}var a=g.get("ariaLabel");d.attr("aria-label",a||"")},update:function(f,d){var a=f.get("ariaLabel");d.attr("aria-label",a||"");var e=f.get("hasTabBar");var b=f.get("hasNavigationBar");if(e){d.addClass("has-tab-bar")}if(b){d.addClass("has-navigation-bar")}}});CW.SteedChatView=SC.View.extend({isMe:true,render:function(a){if(this.get("isMe")){a.addClass("steed-chat-right")}else{a.addClass("steed-chat-left")}a.push('<div class="middle"/><div class="left"/><div class="right"/><div class="top-right"/><div class="bottom-left"/><div class="bottom-right"/><div class="top-left"/><div class="top"/><div class="bottom"/>');arguments.callee.base.apply(this,arguments)}});CW.SteedWindowView=SC.View.extend({classNames:"steed-window".w(),displayProperties:["hasTabBar","hasNavigationBar"],hasTabBar:NO,hasNavigationBar:YES,renderDelegateName:"steedWindowRenderDelegate"});CW.LAYOUT_KEYS=["left","top","width","height","bottom","right","centerX","centerY"],CW.LAYOUT_DOM_KEYS=["left","top","width","height","right","bottom","marginLeft","marginTop","WebkitTransform"],CW.LAYOUT_OPPOSITE_KEYS={left:"right",right:"left",top:"bottom",bottom:"top"},CW.LAYOUT_SIZE_KEYS={left:"width",top:"height",right:"width",bottom:"height",centerX:"width",centerY:"height",width:"width",height:"height"},CW.LAYOUT_DIMENSION_KEYS={width:["left","width","right"],height:["top","height","bottom"]},CW.ComputedLayout={hasComputedLayout:YES,layoutRules:[],layout:{},_cwcl_hasClonedLayout:NO,_sanitizedLayout:null,_cwcl_frame:{x:0,y:0,left:0,top:0,right:0,bottom:0,centerX:0,centerY:0,width:0,height:0},initMixin:function(){this._layout_key=SC.guidFor(this),this._cwcl_frame={x:0,y:0,left:0,top:0,right:0,bottom:0,centerX:0,centerY:0,width:0,height:0},this._cwcl_validateLayout(),this._cwcl_hasSetupRules=NO,this.scheduleLayoutCalculation()},destroyMixin:function(){this._cwcl_teardownRules()},scheduleLayoutCalculation:function(){CW.ComputedLayoutManager.layoutQueue.add(this)},scheduleFrameNotification:function(){CW.ComputedLayoutManager.notificationQueue.add(this)},scheduleLayoutRender:function(){CW.ComputedLayoutManager.renderQueue.add(this)},_cwcl_setupRules:function(){this._cwcl_hasSetupRules=YES;var b=this.layoutRules,a,d=b.length;for(a=0;a<d;a++){b[a].setup(this)}},_cwcl_teardownRules:function(){var b=this.layoutRules,a,d=b.length;for(a=0;a<d;a++){b[a].teardown()}},_cwcl_validateLayout:function(){this.adjust(this.get("layout"))},_cwcl_layoutDidChange:function(){this._cwcl_validateLayout(),this.scheduleLayoutCalculation()}.observes("layout"),adjust:function(g,b){var j=this.get("layout"),f=CW.LAYOUT_KEYS,a,d=f.length,h;this._cwcl_hasClonedLayout||(j=SC.clone(j),this._cwcl_hasClonedLayout=YES);if(typeof g=="string"){b!==undefined&&this._adjust(j,g,b)}else{for(a=0;a<d;a++){h=f[a],b=g[h],b!==undefined&&this._adjust(j,h,g[h])}}this.layout=j,j.right===undefined&&j.centerX===undefined||!!this._cwcl_rightRuleIsEnabled?j.right===undefined&&j.centerX===undefined&&this._cwcl_rightRuleIsEnabled&&(this._cwcl_rightRule.teardown(),this._cwcl_rightRuleIsEnabled=NO):(this._cwcl_rightRule||(this._cwcl_rightRule=CW.LayoutRule._ViewHelper.create("parent.width")),this._cwcl_rightRule.setup(this),this._cwcl_rightRuleIsEnabled=YES),j.bottom===undefined&&j.centerY===undefined||!!this._cwcl_bottomRuleIsEnabled?j.bottom===undefined&&j.centerY===undefined&&this._cwcl_bottomRuleIsEnabled&&(this._cwcl_bottomRule.teardown(),this._cwcl_bottomRuleIsEnabled=NO):(this._cwcl_bottomRule||(this._cwcl_bottomRule=CW.LayoutRule._ViewHelper.create("parent.height")),this._cwcl_bottomRule.setup(this),this._cwcl_bottomRuleIsEnabled=YES),this._cwcl_sanitizeLayout(),this.scheduleLayoutCalculation()},_adjust:function(m,v,g){var b=CW.LAYOUT_OPPOSITE_KEYS,j=CW.LAYOUT_SIZE_KEYS,w=CW.LAYOUT_DIMENSION_KEYS,d,q,p,k=j[v],h=b[v];m[v]=g;if(h&&m[h]!==undefined){delete m[k];return}if(v==="width"||v==="height"){d=w[v],q=d[0],p=d[2],m[q]!==undefined&&m[p]!==undefined&&delete m[p];return}if(v==="centerX"||v==="centerY"){d=w[k],q=d[0],p=d[2],delete m[q],delete m[p]}},_cwcl_sanitizeLayout:function(){var b=this.get("layout"),a=this._sanitizedLayout,d=this.computeParentDimensions();a||(a={}),a.rightFromParent=b.right,a.bottomFromParent=b.bottom,a.left=b.left,a.top=b.top,a.width=b.width,a.height=b.height,a.centerX=b.centerX,a.centerY=b.centerY,a.centerX!==undefined&&(a.left=a.centerX+d.width/2-a.width/2),a.centerY!==undefined&&(a.top=a.centerY+d.height/2-a.height/2),a.rightFromParent!==undefined?a.right=d.width-a.rightFromParent:(a.right=a.left+a.width,a.rightFromParent=d.width-a.right),a.bottomFromParent!==undefined?a.bottom=d.height-a.bottomFromParent:(a.bottom=a.top+a.height,a.bottomFromParent=d.height-a.bottom),a.left===undefined?a.left=a.right-a.width:a.width===undefined&&(a.width=a.right-a.left),a.top===undefined?a.top=a.bottom-a.height:a.height===undefined&&(a.height=a.bottom-a.top),a.centerX=a.left-(d.width/2-a.width/2),a.centerY=a.top-(d.height/2-a.height/2),this._sanitizedLayout=a},frame:function(){return CW.ComputedLayoutManager.flushLayout(),this._cwcl_frame}.property().cacheable(),notifyFrameChange:function(){this.notifyPropertyChange("frame")},computeParentDimensions:function(){var b=this.parentView,a;return b?(!b.hasComputedLayout&&!b._cwcl_frame&&this.parentViewDidResize(),b._cwcl_frame):SC.RootResponder.computeWindowSize()},parentViewDidResize:function(){var f=CW.ComputedLayoutManager,b=this.get("parentView"),g,d;if(!b||!b.hasComputedLayout){b?(d=b.get("frame"),g=b._cwcl_frame,g||(b._cwcl_frame=g={}),g.left=d.x,g.top=d.y,g.width=d.width,g.height=d.height):(g=this.computeParentDimensions(),g.left=0,g.top=0),g.right=g.left+g.width,g.bottom=g.top+g.height;var a=SC.guidFor(b);f.notify(a+":layout/right").notify(a+":layout/bottom").notify(a+":layout/width").notify(a+":layout/height").notify(a+":layout/centerX").notify(a+":layout/centerY")}},_TMP:{},processLayoutRules:function(){this._cwcl_hasSetupRules||this._cwcl_setupRules();var m,v,g=this.layoutRules,b=this._sanitizedLayout,j=this._TMP,w=this._cwcl_frame,d=CW.LAYOUT_KEYS,q,p=this._layout_key,k=CW.ComputedLayoutManager,h=this.computeParentDimensions();v=d.length;for(m=0;m<v;m++){q=d[m],j[q]=b[q]}v=g.length;for(m=0;m<v;m++){g[m].applyTo(j,h)}v=d.length;for(m=0;m<v;m++){q=d[m],w[q]!==j[q]&&(w[q]=j[q],k.notify(p+":layout/"+d[m]))}w.rightFromParent=h.width-w.right,w.bottomFromParent=h.height-w.bottom,w.x=w.left,w.y=w.top,this.scheduleFrameNotification(),this.scheduleLayoutRender()},layoutStyle:function(){var h=this._cwcl_frame,d=this._cl_lastLayout||{},k=this.get("hasAcceleratedLayer"),g="",b,f=CW.LAYOUT_DOM_KEYS,j,a=f.length;b=this._cwcl_layoutStyles,b||(b=this._cwcl_layoutStyles={});for(j=0;j<a;j++){b[f[j]]=undefined}k?(b.left="0px",g+="translateX("+h.left+"px) "):b.left=h.left+"px",b.width=h.width+"px",k?(b.top="0px",g+="translateY("+h.top+"px) "):b.top=h.top+"px",b.height=h.height+"px",b.WebkitTransform=g,d.left=h.left,d.rightFromParent=h.rightFromParent,d.top=h.top,d.bottomFromParent=h.bottomFromParent,d.centerX=h.centerX,d.centerY=h.centerY,this._cl_lastLayout=d;for(j=0;j<a;j++){b[f[j]]===undefined&&(b[f[j]]="")}return b}.property(),updateLayout:function(){var h=CW.LAYOUT_DOM_KEYS,d,k=h.length,g,b=this.get("layer"),f=this._lastLayoutStyle,j=this.layoutStyle(),a;f||(f={});if(b){a=b.style;for(d=0;d<k;d++){g=h[d],j[g]!==f[g]&&(a[g]=j[g])}}this._lastLayoutStyle=f}},CW.ComputedLayoutQueue={create:function(b){var a=SC.beget(this);return a.method=b,a.isAddedKey="_sclm_has_"+b,a.nextItemKey="_sclm_next_"+b,a},isProcessing:NO,processingIsScheduled:NO,method:"",_first:null,_last:null,add:function(b){var a=this.isAddedKey,d=this.nextItemKey;if(b[a]){return}this._last?this._last[d]=b:this._first=b,b[d]=null,b[a]=YES,this._last=b,this.isScheduled||(CW.ComputedLayoutManager.schedule(),this.isScheduled=YES)},process:function(){this.isScheduled=NO;var f=this._first,b=this.method,g,d=this.isAddedKey,a=this.nextItemKey;while(f){g=f[a],f[a]=null,f[d]=NO,f[b](),f=g||f[a]}return this._first=null,this._last=null,NO}},CW.ComputedLayoutManager={layoutQueue:CW.ComputedLayoutQueue.create("processLayoutRules"),notificationQueue:CW.ComputedLayoutQueue.create("notifyFrameChange"),renderQueue:CW.ComputedLayoutQueue.create("updateLayout"),schedule:function(){SC.RunLoop.currentRunLoop.invokeOnce(this,this.flush)},flush:function(d){d=d===YES;var a=this.layoutQueue,f=this.notificationQueue,b=this.renderQueue;while(YES){if(a.process()){continue}if(!d&&f.process()){continue}if(!d&&b.process()){continue}break}},flushLayout:function(){this.flush(YES)},_listeners:{},addListener:function(b,a){var d=this._listeners;d[b]||(d[b]=[]),d[b].push(a)},removeListener:function(b,a){var d=this._listeners;if(!d[b]){return}d[b].removeObject(a),d[b].length<1&&delete d[b]},notify:function(d){var a=this._listeners[d],f,b;if(!a){return this}b=a.length;for(f=0;f<b;f++){a[f].dependentKeyDidChange()}return this}},CW.LayoutRule={isLayoutRule:YES,isEnabled:YES,owner:null,operations:null,_dependentKeys:null,_observing:null,_listening:null,create:function(){var a=SC.beget(this);return a.init.apply(a,arguments),a},init:function(){this.executionCount=0,this._observing=[],this._listening=[],this._dependentKeys=[],this.operations=[]},extend:function(a){return SC.beget(this)._extend(a)},_extend:function(b){var a;for(var d in b){a=b[d],typeof a=="function"&&this[d]&&(a.base=this[d]),this[d]=a}return this},setup:function(d){this.owner=d,this.observeDependentKeys();var a=this.operations,f,b=a.length;for(f=0;f<b;f++){a[f].setup(d)}},teardown:function(){this.ignoreDependentKeys();var b=this.operations,a,d=b.length;for(a=0;a<d;a++){b[a].teardown()}},reset:function(){this.teardown(),this.setup(this.owner)},addOperation:function(a){a.root=this,this.operations.push(a)},perform:function(d){if(!this.isEnabled){return d}var a=this.operations,f,b=a.length;for(f=0;f<b;f++){d=a[f].perform(d)}return d},addOperator:function(b,a,d){d&&(a=a.extend(d)),this[b]=function(){var f=a.create.apply(a,arguments);return this.operations.push(f),f.root=this,this}}},CW.layout=function(b){var a=CW.LayoutRule.create();return a.property=b,a},SC.mixin(CW.LayoutRule,{normalizeKey:function(a){return a.length===0?[]:(a=a.split("."),CW.LAYOUT_KEYS.indexOf(a[0])<0&&a[0]!=="parent"?a[0]==="self"||a[0].length<1?(a.shift(),a):(a.unshift("parent"),a):a)},addDependentKey:function(a){this._dependentKeys.push(a)},observeDependentKeys:function(){var b=this._dependentKeys,a=b.length;for(var d=0;d<a;d++){this.observe(b[d])}},ignoreDependentKeys:function(){var g=this._observing,b=g.length,j=this._reset,f,a;for(var d=0;d<b;d++){g[d++].removeObserver(g[d],this,j)}var h=this._listening;b=h.length;for(d=0;d<b;d++){CW.ComputedLayoutManager.removeListener(h[d],this)}this._observing.length=0,this._listening.length=0},observe:function(f){var b=this.owner,g,d=f.length,a;for(g=0;g<d;g++){if(!b){return}a=f[g],CW.LAYOUT_KEYS.indexOf(a)>-1?this.listen(b,a):(a==="parent"&&(a="parentView"),b.addObserver(a,this,this._reset),this._observing.push(b),this._observing.push(a),b=b.get(a))}},listen:function(b,a){var d=SC.guidFor(b);CW.ComputedLayoutManager.addListener(d+":layout/"+a,this),this._listening.push(d+":layout/"+a)},findProperty:function(f){var b=this.owner,g,d=f.length,a;for(g=0;g<d;g++){if(!b){return}a=f[g];if(CW.LAYOUT_KEYS.indexOf(f[g])>-1){return b._cwcl_frame[a]}a==="parent"&&(a="parentView"),b=b[a]}return undefined}}),CW.AT_LEAST="at_least",CW.AT_MOST="at_most",CW.EXACTLY="exactly",SC.mixin(CW.LayoutRule,{property:null,relation:CW.EXACTLY,shouldResize:NO,movesSide:"top",atLeast:function(a){return this.relation=CW.AT_LEAST,a!==undefined&&this.to(a),this},atMost:function(a){return this.relation=CW.AT_MOST,a!==undefined&&this.to(a),this},resize:function(){return this.shouldResize=YES,this},move:function(){return this.shouldResize=NO,this},moveSide:function(a){return this.movesSide=a,this},applyTo:function(g,b){var h=this.property,f=g[h],a,d=this.relation;a=this.perform(f),d===CW.AT_LEAST?a>f&&(f=a):d===CW.AT_MOST?a<f&&(f=a):f=a,this._adjuster||this._findAdjuster(),this._adjuster(g,f,b)},_findAdjuster:function(){var b=this.property,a=this.shouldResize,d=this.movesSide;b==="width"?(d==="top"&&(d="left"),d==="bottom"&&(d="right")):b==="height"&&(d==="left"&&(d="top"),d==="right"&&(d="bottom")),this.movesSide=d,this._adjuster=this["_adjust_"+b]},_adjust_left:function(b,a,d){b.left=a,this.shouldResize?b.width=b.right-a:b.right=a+b.width,b.centerX=b.left-(d.width/2-b.width/2)},_adjust_right:function(b,a,d){b.right=a,this.shouldResize?b.width=a-b.left:b.left=a-b.width,b.centerX=b.left-(d.width/2-b.width/2)},_adjust_width:function(b,a,d){b.width=a,this.movesSide==="left"?(b.left=b.right-b.width,b.centerX=b.left-(d.width/2-b.width/2)):this.movesSide==="right"?(b.right=b.left+b.width,b.centerX=b.left-(d.width/2-b.width/2)):(b.left=d.width/2-b.width/2+b.centerX,b.right=d.width/2+b.width/2+b.centerX)},_adjust_centerX:function(b,a,d){b.centerX=a,b.left=d.width/2-b.width/2+a,b.right=d.width/2+b.width/2+a},_adjust_top:function(b,a,d){b.top=a,this.shouldResize?b.height=b.bottom-a:b.bottom=a+b.height,b.centerY=b.top-(d.height/2-b.height/2)},_adjust_bottom:function(b,a,d){b.bottom=a,this.shouldResize?b.height=a-b.top:b.top=a-b.height,b.centerY=b.top-(d.height/2-b.height/2)},_adjust_height:function(b,a,d){b.height=a,this.movesSide==="top"?(b.top=b.bottom-b.height,b.centerY=b.top-(d.height/2-b.height/2)):this.movesSide==="bottom"?(b.bottom=b.top+b.height,b.centerY=b.top-(d.height/2-b.height/2)):(b.top=d.height/2-b.height/2+b.centerY,b.bottom=d.height/2+b.height/2+b.centerY)},_adjust_centerY:function(b,a,d){b.centerY=a,b.top=d.height/2-b.height/2+a,b.bottom=d.height/2+b.height/2+a}}),SC.mixin(CW.LayoutRule,{dependentKeyDidChange:function(){this.owner.scheduleLayoutCalculation()}}),CW.LayoutRule._ViewHelper=CW.LayoutRule.extend({init:function(a){arguments.callee.base.apply(this,arguments),a=this.normalizeKey(a),this.addDependentKey(a)},dependentKeyDidChange:function(){this.owner._cwcl_sanitizeLayout(),this.owner.scheduleLayoutCalculation()}}),CW.LayoutRule.Add=CW.LayoutRule.extend({isNegative:NO,_useKey:NO,init:function(a){arguments.callee.base.apply(this,arguments),typeof a=="string"&&(a=this.normalizeKey(a),this.addDependentKey(a),this._usesKey=YES),this.number=a},perform:function(b){var a;return this._usesKey?a=this.findProperty(this.number):a=this.number,this.isNegative?b-a:b+a}}),CW.LayoutRule.addOperator("plus",CW.LayoutRule.Add),CW.LayoutRule.addOperator("minus",CW.LayoutRule.Add,{isNegative:YES}),CW.LayoutRule.To=CW.LayoutRule.extend({init:function(a){arguments.callee.base.apply(this,arguments),typeof a=="string"&&(a=this.normalizeKey(a),this.addDependentKey(a),this._usesKey=YES),this.number=a},perform:function(b){var a;return this._usesKey?a=this.findProperty(this.number):a=this.number,a}}),CW.LayoutRule.addOperator("to",CW.LayoutRule.To);CW.INVALID_LAYOUT_QUALITY=-2;CW.BAD_LAYOUT_QUALITY=-1;CW.OKAY_LAYOUT_QUALITY=0;CW.GOOD_LAYOUT_QUALITY=1;CW.PERFECT_LAYOUT_QUALITY=2;CW.PickerLayout=SC.Object.extend({owner:null,renderDelegateName:"panelRenderDelegate",theme:null,themeBinding:SC.Binding.oneWay("*owner.theme"),controlSize:null,controlSizeBinding:SC.Binding.oneWay("*owner.controlSize"),renderDelegate:function(){var b=this.get("theme");if(b){return b[this.get("renderDelegateName")]}return null}.property("theme","renderDelegateName"),renderDelegateProxy:function(){return this}.property().cacheable(),pointAtRectangle:{left:0,top:0,width:0,height:0},pointAtRectangleBinding:SC.Binding.oneWay("*owner.pointAtRectangle"),pointAtPoint:function(){var b=this.get("pointAtRectangle");return{left:b.left+b.width/2,top:b.top+b.height/2}}.property("pointAtRectangle").cacheable(),availableSpace:{width:0,height:0},availableSpaceBinding:SC.Binding.oneWay("*owner.availableSpace"),desiredSize:{width:320,height:400},desiredSizeBinding:SC.Binding.oneWay("*owner.desiredSize"),minimumSize:{width:320,height:200},minimumSizeBinding:SC.Binding.oneWay("*owner.minimumSize"),layout:{top:0,left:0,width:100,height:100},layoutQuality:CW.INVALID_LAYOUT_QUALITY,layoutNeedsUpdate:NO,reasonsForRelayout:SC.CoreSet.create(),init:function(){arguments.callee.base.apply(this,arguments);this._reasonsForRelayout=SC.CoreSet.create()},scheduleRedraw:function(){if(!this.get("owner")){return}this.get("owner").pickerLayoutNeedsRedraw(this)},layoutDidChange:function(){var d=this.get("layout"),e=this._previousLayout||{};if(d.left!==e.left||d.top!==e.top||d.width!==e.width||d.height!==e.height){this.scheduleRedraw()}this._previousLayout=d}.observes("layout"),scheduleLayout:function(b){this.set("layoutNeedsUpdate",YES);if(!b){return}if(typeof b==="string"){b=[b]}this._reasonsForRelayout.addEach(b)},computeLayout:function(){this.set("reasonsForRelayout",this._reasonsForRelayout);this._reasonsForRelayout=SC.CoreSet.create();this.set("layoutNeedsUpdate",NO)},computeLayoutIfNeeded:function(){if(!this.get("layoutNeedsUpdate")){return}this.computeLayout()},_scpl_layoutNeedsUpdateDidChange:function(){if(!this.get("layoutNeedsUpdate")){return}var b=this.get("owner");if(!b){return}b.pickerLayoutNeedsUpdate(this)}.observes("layoutNeedsUpdate"),render:function(d){var e=this.get("renderDelegate");if(e){d.addClass(e.className);d.addClass(this.get("theme").classNames);e.render(this.get("renderDelegateProxy"),d)}},update:function(d){var e=this.get("renderDelegate");if(e){d.addClass(e.className);d.addClass(this.get("theme").classNames);e.update(this.get("renderDelegateProxy"),d)}},isBetterThanLayout:function(b){return this.get("layoutQuality")>b.get("layoutQuality")}});sc_require("system/picker_layout");CW.LEFT_SIDE="left";CW.RIGHT_SIDE="right";CW.TOP_SIDE="top";CW.BOTTOM_SIDE="bottom";CW.RELAYOUT_FOR_WINDOW="window";CW.RELAYOUT_FOR_TARGET="target";CW.RELAYOUT_FOR_DESIRED_SIZE="desired-size";CW.RELAYOUT_FOR_MINIMUM_SIZE="minimum-size";CW.PickerLayout.OnSide=CW.PickerLayout.extend({renderDelegateName:"cwPickerBackgroundRenderDelegate",pointAtSide:CW.RIGHT_SIDE,pointAtPoint:function(){var h=this.get("pointAtRectangle"),e=this.get("pointAtSide"),f,g;if(e===CW.RIGHT_SIDE||e===CW.LEFT_SIDE){g=Math.round(h.top+h.height/2);f=h.left;if(e===CW.RIGHT_SIDE){f+=h.width}}else{f=Math.round(h.left+h.width/2);g=h.top;if(e===CW.BOTTOM_SIDE){g+=h.height}}return{left:f,top:g}}.property("pointAtSide","pointAtRectangle"),distanceFromRectangle:SC.propertyFromRenderDelegate("pickerDistanceFromRectangle",10),distanceFromEdge:SC.propertyFromRenderDelegate("pickerDistanceFromEdge",15),pointerCanMove:SC.propertyFromRenderDelegate("pointerCanMove",YES),validPointerLayouts:SC.propertyFromRenderDelegate("validPointerLayouts",[]),pointerDistanceFromTop:function(){return this.get("pointAtPoint").top-this.get("layout").top}.property("layout").cacheable(),pointerDistanceFromBottom:function(){return this.get("layout").top+this.get("layout").height-this.get("pointAtPoint").top}.property("layout").cacheable(),pointerDistanceFromLeft:function(){return this.get("pointAtPoint").left-this.get("layout").left}.property("layout").cacheable(),pointerDistanceFromRight:function(){return this.get("layout").left+this.get("layout").width-this.get("pointAtPoint").left}.property("layout").cacheable(),pointerLayout:null,layoutPropertyDidChange:function(e,d){if(d==="availableSpace"){this.scheduleLayout(CW.RELAYOUT_FOR_WINDOW)}else{if(d==="pointAtPoint"){this.scheduleLayout(CW.RELAYOUT_FOR_TARGET)}else{if(d==="desiredSize"){this.scheduleLayout(CW.RELAYOUT_FOR_DESIRED_SIZE)}else{if(d==="minimumSize"){this.scheduleLayout(CW.RELAYOUT_FOR_MINIMUM_SIZE)}else{if(d==="validPointerLayouts"||d==="pointerCanMove"){this.scheduleLayout(CW.RELAYOUT_FOR_TARGET)}}}}}}.observes("availableSpace","pointAtPoint","desiredSize","minimumSize","validPointerLayouts","pointerCanMove"),pointerLayoutPropertyDidChange:function(){this.scheduleRedraw()}.observes("pointerDistanceFromLeft","pointerDistanceFromRight","pointerDistanceFromBottom","pointerDistanceFromTop"),t_pointAtPoint:function(){var d=this.get("pointAtPoint"),e=this.get("pointAtSide");if(e===CW.LEFT_SIDE||e===CW.RIGHT_SIDE){return d}else{return{left:d.top,top:d.left}}}.property("pointAtPoint","pointAtSide"),t_validPointerLayouts:function(){var n=this.get("validPointerLayouts"),o,h=n.length,j,l;var k=this.get("pointAtSide");var m=[];for(o=0;o<h;o++){j=n[o];if(j.top!=null||j.bottom!=null||j.minimumDistanceFromTop!=null||j.minimumDistanceFromBottom!=null||j.maximumDistanceFromTop!=null||j.maximumDistanceFromBottom!=null){if(k!==CW.LEFT_SIDE&&k!==CW.RIGHT_SIDE){continue}if(j.side&&j.side===k){continue}l={name:j.name};if(j.top!=null){l.maximumDistanceFromTop=l.minimumDistanceFromTop=j.top}else{if(j.bottom!=null){l.maximumDistanceFromBottom=l.minimumDistanceFromBottom=j.bottom}else{l.maximumDistanceFromTop=j.maximumDistanceFromTop;l.minimumDistanceFromTop=j.minimumDistanceFromTop;l.maximumDistanceFromBottom=j.maximumDistanceFromBottom;l.minimumDistanceFromBottom=j.minimumDistanceFromBottom}}l.original=j;m.push(l)}else{if(j.left!=null||j.right!=null||j.minimumDistanceFromLeft!=null||j.minimumDistanceFromRight!=null||j.maximumDistanceFromLeft!=null||j.maximumDistanceFromRight!=null){if(k!==CW.TOP_SIDE&&k!==CW.BOTTOM_SIDE){continue}if(j.side&&j.side===k){continue}l={name:j.name};if(j.left!=null){l.maximumDistanceFromTop=l.minimumDistanceFromTop=j.left}else{if(j.right!=null){l.maximumDistanceFromBottom=l.minimumDistanceFromBottom=j.right}else{l.maximumDistanceFromTop=j.maximumDistanceFromLeft;l.minimumDistanceFromTop=j.minimumDistanceFromLeft;l.maximumDistanceFromBottom=j.maximumDistanceFromRight;l.minimumDistanceFromBottom=j.minimumDistanceFromRight}}l.original=j;m.push(l)}}}return m}.property("validPointerLayouts","pointAtSide").cacheable(),t_pointerMinimumDistanceFromTop:function(){var b=this.get("pointAtSide");if(b===CW.LEFT_SIDE||b===CW.RIGHT_SIDE){return this.get("pointerMinimumDistanceFromTop")}else{return this.get("pointerMinimumDistanceFromLeft")}}.property("pointerMinimumDistanceFromTop","pointerMinimumDistanceFromLeft","pointAtSide").cacheable(),t_pointerMinimumDistanceFromBottom:function(){var b=this.get("pointAtSide");if(b===CW.LEFT_SIDE||b===CW.RIGHT_SIDE){return this.get("pointerMinimumDistanceFromBottom")}else{return this.get("pointerMinimumDistanceFromRight")}}.property("pointerMinimumDistanceFromBottom","pointerMinimumDistanceFromRight","pointAtSide"),t_availableSpace:function(){var d=this.get("availableSpace"),e=this.get("pointAtSide");if(e===CW.LEFT_SIDE||e===CW.RIGHT_SIDE){return d}else{return{width:d.height,height:d.width}}}.property("availableSpace","pointAtSide").cacheable(),t_desiredSize:function(){var e=this.get("desiredSize"),d=this.get("pointAtSide");if(d===CW.LEFT_SIDE||d===CW.RIGHT_SIDE){return e}else{return{width:e.height,height:e.width}}}.property("desiredSize","pointAtSide").cacheable(),t_minimumSize:function(){var d=this.get("minimumSize"),e=this.get("pointAtSide");if(e===CW.LEFT_SIDE||e===CW.RIGHT_SIDE){return d}else{return{width:d.height,height:d.width}}}.property("minimumSize","pointAtSide").cacheable(),t_pointAtSide:function(){var b=this.get("pointAtSide");if(b===CW.TOP_SIDE){return CW.LEFT_SIDE}else{if(b===CW.BOTTOM_SIDE){return CW.RIGHT_SIDE}}return b}.property("pointAtSide").cacheable(),computeLayout:function(){this.centerPicker();this.repositionToFit();this.repositionForPointer();this.resizeToFit();this.resizeForPointer();this.resizeSecondaryDimension();this.applyMinimumSize();this.repositionToFit();this.repositionForPointer();this.gradeLayout();var e=this.get("pointAtSide"),d=this.get("t_layout"),f=d.pointerLayout;delete d.pointerLayout;if(e===CW.TOP_SIDE||e===CW.BOTTOM_SIDE){d={left:d.top,top:d.left,width:d.height,height:d.width}}this.set("layout",d);this.set("pointerLayout",f);arguments.callee.base.apply(this,arguments)},centerPicker:function(){var e=this.get("t_pointAtPoint"),f=this.get("t_desiredSize"),g=this.get("distanceFromRectangle"),h={left:e.left,top:Math.round(e.top-f.height/2),width:f.width,height:f.height};if(this.get("t_pointAtSide")===CW.RIGHT_SIDE){h.left+=g}else{h.left=h.left-g-f.width}this.set("t_layout",h)},repositionToFit:function(){if(!this.get("pointerCanMove")){return}var g=this.get("t_layout"),j=this.get("distanceFromEdge"),k=this.get("t_availableSpace"),h=j,f=k.height-j;if(g.top+g.height>f){g.top=f-g.height}if(g.top<h){g.top=h}},repositionForPointer:function(){var B=this.get("t_layout"),s=this.get("t_pointAtPoint").top,q=this.get("t_validPointerLayouts"),A=q.length,w,D,z,u,x=null,C,y;z=null;for(w=0;w<A;w++){D=q[w];C=B.top;var F=D.minimumDistanceFromTop,v=D.maximumDistanceFromTop,t=D.minimumDistanceFromBottom,E=D.maximumDistanceFromBottom;if(F!=null&&C>s-F){C=s-F}if(v!=null&&C<s-v){C=s-v}if(t!=null&&C+B.height<s+t){C=s+t-B.height}if(E!=null&&C+B.height>s+E){C=s+E-B.height}y=Math.abs(C-B.top);if(z==null||y<u){z=C;u=y;x=D.original}}B.pointerLayout=x;if(z!=null){B.top=z}},resizeToFit:function(){if(!this.get("pointerCanMove")){return}var e=this.get("t_layout"),f=this.get("t_availableSpace"),d=f.height-this.get("distanceFromEdge");if(e.top+e.height>d){e.height=d-e.top}},resizeForPointer:function(){var B=this.get("t_layout"),s=this.get("t_pointAtPoint").top,q=this.get("t_validPointerLayouts"),A=q.length,w,C,D,u,x=null,y,z;D=null;for(w=0;w<A;w++){C=q[w];y=B.height;var F=C.minimumDistanceFromTop,v=C.maximumDistanceFromTop,t=C.minimumDistanceFromBottom,E=C.maximumDistanceFromBottom;if(t!=null&&B.top+y<s+t){y=s+t-B.top}if(E!=null&&B.top+y>s+E){y=s+E-B.top}z=Math.abs(y-B.height);if(D==null||z<u){D=y;u=z;x=C.original}}B.pointerLayout=x;if(D!=null){B.height=D}},resizeSecondaryDimension:function(){var m=this.get("t_layout"),k=this.get("t_availableSpace"),l=this.get("distanceFromEdge"),h=l,n=k.width-l,j=this.get("t_pointAtSide");if(j===CW.RIGHT_SIDE){if(m.left+m.width>n){m.width=n-m.left}}else{if(m.left<h){var o=m.left+m.width;m.left=h;m.width=o-h}}},applyMinimumSize:function(){var d=this.get("t_layout"),e=this.get("t_minimumSize");if(d.width<e.width){d.width=e.width}if(d.height<e.height){d.height=e.height}},gradeLayout:function(){var t=CW.PERFECT_LAYOUT_QUALITY;var u=this.get("t_layout"),s=this.get("t_pointAtSide"),p=this.get("t_availableSpace"),v=this.get("distanceFromEdge"),w=this.get("distanceFromRectangle"),o=this.get("t_desiredSize"),x=this.get("t_pointAtPoint").left,m=this.get("t_pointAtPoint").top,q=this.get("t_pointerMinimumDistanceFromTop"),n=this.get("t_pointerMinimumDistanceFromBottom");if(u.top>m-q){t=CW.INVALID_LAYOUT_QUALITY}else{if(u.top+u.height<m-n){t=CW.INVALID_LAYOUT_QUALITY}else{if(s===CW.LEFT_SIDE&&u.left+u.width+w!==x){t=CW.INVALID_LAYOUT_QUALITY}else{if(s===CW.RIGHT_SIDE&&u.left-w!==x){t=CW.INVALID_LAYOUT_QUALITY}else{if(u.top<0||u.left<0){t=CW.BAD_LAYOUT_QUALITY}else{if(u.top+u.height>p.height||u.left+u.width>p.width){t=CW.BAD_LAYOUT_QUALITY}else{if(u.top<v||u.left<v){t=CW.OKAY_LAYOUT_QUALITY}else{if(u.top+u.height>p.height-v||u.left+u.width>p.width-v){t=CW.OKAY_LAYOUT_QUALITY}else{if(u.height<o.height||u.width<o.width){t=CW.GOOD_LAYOUT_QUALITY}}}}}}}}}this.set("layoutQuality",t)},isBetterThanLayout:function(l){var k=this.get("layoutQuality"),m=l.get("layoutQuality");if(k>m){return YES}else{if(k<m){return NO}else{var j=this.get("layout"),g=l.get("layout"),h=this.get("desiredSize");if(h.width-j.width<h.width-g.width){return YES}if(h.height-j.height<h.height-g.height){return YES}return NO}}}});sc_require("picker_layouts/layout_side");CW.PickerLayout.ON_LEFT=CW.PickerLayout.OnSide.extend({pointAtSide:CW.LEFT_SIDE});CW.PickerLayout.ON_RIGHT=CW.PickerLayout.OnSide.extend({pointAtSide:CW.RIGHT_SIDE});CW.PickerLayout.ON_BOTTOM=CW.PickerLayout.OnSide.extend({pointAtSide:CW.BOTTOM_SIDE});CW.PickerLayout.ON_TOP=CW.PickerLayout.OnSide.extend({pointAtSide:CW.TOP_SIDE});CW.PickerPane=SC.PickerPane.extend({preferType:SC.PICKER_POINTER,shouldDismissAutomatically:YES,shouldBeStable:NO,dismissAction:null,dismissTarget:null,dismiss:function(){var d=this.get("dismissAction"),f=this.get("dismissTarget")||null,e=this.get("rootResponder");if(d){e.sendAction(d,f,this,this,null,this)}if(this.get("shouldDismissAutomatically")){this.remove()}},});sc_require("system/picker_layout");sc_require("panes/picker");CW.MenuPane=CW.PickerPane.extend({desiredSize:{width:100,height:100},minimumSize:{width:100,height:0},classNames:["cw-menu"],modalPane:SC.ModalPane,ariaRole:"menu",items:[],controlSize:SC.REGULAR_CONTROL_SIZE,minimumCroppedMenuHeight:SC.propertyFromRenderDelegate("minimumCroppedHeight"),itemHeight:SC.propertyFromRenderDelegate("itemHeight",20),itemSeparatorHeight:SC.propertyFromRenderDelegate("itemSeparatorHeight",9),menuHeight:0,menuHeightPadding:SC.propertyFromRenderDelegate("menuHeightPadding",6),submenuOffsetX:SC.propertyFromRenderDelegate("submenuOffsetX",2),selectedItem:null,exampleView:SC.MenuItemView,anchor:null,isSubMenu:NO,localize:YES,acceptsMenuPane:YES,isContextMenuEnabled:NO,layouts:[CW.PickerLayout.ON_BOTTOM,CW.PickerLayout.ON_TOP],popup:function(f,d){this.beginPropertyChanges();this.adjustDesiredSize("height",this.get("menuHeight"));var e=Math.min(this.get("menuHeight"),this.get("minimumCroppedMenuHeight"));this.adjustMinimumSize("height",e);arguments.callee.base.apply(this,arguments);this.set("defaultResponder",this);this.endPropertyChanges()},remove:function(){var b=this.get("parentMenu");this.set("currentMenuItem",null);this.closeOpenMenus();this.resignMenuPane();if(b){b.becomeMenuPane()}return arguments.callee.base.apply(this,arguments)},itemTitleKey:"title",itemIsEnabledKey:"isEnabled",itemValueKey:"value",itemIconKey:"icon",itemHeightKey:"height",itemSubMenuKey:"subMenu",itemSeparatorKey:"separator",itemTargetKey:"target",itemActionKey:"action",itemCheckboxKey:"checkbox",itemShortCutKey:"shortcut",itemKeyEquivalentKey:"keyEquivalent",itemDisableMenuFlashKey:"disableMenuFlash",itemLayerIdKey:"layerId",itemExampleViewKey:"exampleView",menuItemKeys:["itemTitleKey","itemValueKey","itemIsEnabledKey","itemIconKey","itemSeparatorKey","itemActionKey","itemCheckboxKey","itemShortCutKey","itemHeightKey","itemSubMenuKey","itemKeyEquivalentKey","itemTargetKey","itemLayerIdKey"],isModal:YES,_menuView:null,init:function(){return arguments.callee.base.apply(this,arguments)},displayProperties:["controlSize"],renderStyle:"menu",renderDelegateName:"cwMenuRenderDelegate",createChildViews:function(){var d,e,f;d=this.createChildView(SC.MenuScrollView,{borderStyle:SC.BORDER_NONE,controlSize:this.get("controlSize")});e=this._menuView=SC.View.create({parentViewDidResize:function(){this.notifyPropertyChange("frame")},viewDidResize:function(){}});f=this.get("menuItemViews");e.set("layout",{top:0,left:0,height:this.get("menuHeight")});e.replaceAllChildren(f);d.set("contentView",e);this.childViews=[d];return this},paneDidAttach:function(){var b=(this.rootResponder=SC.RootResponder.responder);b.panes.add(this);this.set("currentWindowSize",b.computeWindowSize());this.set("isPaneAttached",YES);this.parentViewDidChange();this._notifyDidAppendToDocument();this.becomeMenuPane();return this},becomeMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(this)}return this},resignMenuPane:function(){if(this.rootResponder){this.rootResponder.makeMenuPane(null)}return this},menuItemViews:function(){return this.createMenuItemViews()}.property("displayItems","controlSize").cacheable(),createMenuItemViews:function(){var L=[],D=this.get("displayItems"),T=this.get("exampleView"),A,Q,I,E,G,N,S,K,C,R,O,H,J,P,M,F,y,z,B;if(!D){return L}G=this.get("itemHeightKey");N=this.get("itemSeparatorKey");J=this.get("itemExampleViewKey");S=this.get("itemHeight");O=this.get("itemKeyEquivalentKey");K=this.get("itemSeparatorHeight");y=this.get("itemLayerIdKey");R=Math.floor(this.get("menuHeightPadding")/2);C=R,largestItemHeight=0;M=this.menuItemKeys.map(CW._menu_fetchKeys,this);B=D.get("length");for(F=0;F<B;F++){A=D[F];E=A.get(G);if(!E){E=A.get(N)?K:S}z={layout:{height:E,top:C},contentDisplayProperties:M,content:A,parentMenu:this};if(A.get(y)){z.layerId=A.get(y)}P=A.get(J);if(P){Q=P}else{Q=T}I=this._menuView.createChildView(Q,z);L[F]=I;C+=E;largestItemHeight=Math.max(largestItemHeight,E);H=A.get(O);if(H){if(SC.typeOf(H)===SC.T_ARRAY){H.forEach(function(a){this._keyEquivalents[a]=I},this)}else{this._keyEquivalents[H]=I}}}this.set("menuHeight",C+R);this.set("largestItemHeight",largestItemHeight);return L},menuItemViewForContentIndex:function(e){var d=this.get("menuItemViews");if(!d){return undefined}return d.objectAt(e)},_keyEquivalents:{},rootMenu:function(){if(this.get("isSubMenu")){return this.getPath("parentMenu.rootMenu")}return this}.property("isSubMenu").cacheable(),windowSizeDidChange:function(d,e){this.remove();return arguments.callee.base.apply(this,arguments)},displayItems:function(){var p=this.get("items"),q=this.get("localize"),l=this.get("itemHeight"),j,o=[],k,n,m;if(!p){return null}j=p.get("length");for(k=0;k<j;k++){n=p.objectAt(k);if(!n){continue}m=SC.typeOf(n);if(m===SC.T_STRING){n=SC.Object.create({title:n,value:n,isEnabled:YES})}else{if(m===SC.T_HASH){n=SC.Object.create(n)}else{if(m===SC.T_ARRAY){n=this.convertArrayMenuItemToObject(n)}}}n.contentIndex=k;o.push(n)}return o}.property("items").cacheable(),_sc_menu_itemsDidChange:function(){var b=this.get("menuItemViews");this._menuView.replaceAllChildren(b);this._menuView.adjust("height",this.get("menuHeight"))}.observes("menuItemViews"),convertArrayMenuItemToObject:function(n){SC.Logger.warn("Support for Array-based menu items has been deprecated.  Please update your menus to use a hash.");var o,q=CW._menu_fetchKeys,j=CW._menu_fetchItem,l,p=SC.Object.create(),k,m;o=this.menuItemKeys.map(q,this);p[o[0]]=n[0];p[o[1]]=n[1];p[o[2]]=n[2];p[o[3]]=n[3];p[o[4]]=n[4];p[o[5]]=n[5];p[o[6]]=n[6];p[o[7]]=n[7];p[o[8]]=n[8];p[o[9]]=n[9];p[o[10]]=n[10];p[o[11]]=n[11];p[o[12]]=n[12];return p},currentMenuItem:function(e,d){if(d!==undefined){if(this._currentMenuItem!==null){this.set("previousMenuItem",this._currentMenuItem)}this._currentMenuItem=d;this.setPath("rootMenu.targetMenuItem",d);return d}return this._currentMenuItem}.property().cacheable(),_sc_menu_currentMenuItemDidChange:function(){var e=this.get("currentMenuItem"),d=this.get("previousMenuItem");if(d){if(d.get("hasSubMenu")&&e===null){}else{d.resignFirstResponder();this.closeOpenMenusFor(d)}}if(e&&e.get("isEnabled")){e.scrollToVisible()}}.observes("currentMenuItem"),closeOpenMenusFor:function(e){if(!e){return}var d=e.get("parentMenu");while(d&&e){d=e.get("subMenu");if(d){d.remove();e.resignFirstResponder();e=d.get("previousMenuItem")}}},closeOpenMenus:function(){this.closeOpenMenusFor(this.get("previousMenuItem"))},mouseDown:function(b){this.modalPaneDidClick(b);return YES},mouseEntered:function(b){this.set("mouseHasEntered",YES)},keyUp:function(e){var d=this.interpretKeyEvents(e);return !d?NO:d},moveUp:function(){var k=this.get("currentMenuItem"),j=this.get("menuItemViews"),f,h,g;if(!k){g=j.get("length")-1}else{f=k.getPath("content.contentIndex");if(f===0){return YES}g=f-1}while(g>=0){if(j[g].get("isEnabled")){this.set("currentMenuItem",j[g]);j[g].becomeFirstResponder();break}g--}return YES},moveDown:function(){var l=this.get("currentMenuItem"),k=this.get("menuItemViews"),g=k.get("length"),m,j,h;if(!l){h=0}else{m=l.getPath("content.contentIndex");if(m===g){return YES}h=m+1}while(h<g){if(k[h].get("isEnabled")){this.set("currentMenuItem",k[h]);k[h].becomeFirstResponder();break}h++}return YES},insertText:function(e,f){var g=this._timer,h=this._keyBuffer;if(g){g.invalidate()}g=this._timer=SC.Timer.schedule({target:this,action:"clearKeyBuffer",interval:500,isPooled:NO});h=h||"";h+=e.toUpperCase();this.selectMenuItemForString(h);this._keyBuffer=h;return YES},performKeyEquivalent:function(g,f,e){if(!e&&!this.get("isVisibleInWindow")){return NO}var h=this._keyEquivalents[g];if(h){h.performAction(YES);return YES}if(g==="escape"||g==="return"){this.remove();return YES}return NO},selectMenuItemForString:function(o){var n=this.get("menuItemViews"),l,k,h,j,m;if(!n){return}m=o.length;j=n.get("length");for(h=0;h<j;h++){l=n.objectAt(h);k=l.get("title");if(!k){continue}k=k.replace(/ /g,"").substr(0,m).toUpperCase();if(k===o){this.set("currentMenuItem",l);l.becomeFirstResponder();break}}},clearKeyBuffer:function(){this._keyBuffer=""},modalPaneDidClick:function(b){this.remove();return YES}});CW._menu_fetchKeys=function(b){return this.get(b)};CW._menu_fetchItem=function(b){if(!b){return null}return this.get?this.get(b):this[b]};CW.AutoResizingMenuItemView=SC.MenuItemView.extend(SC.AutoResize,{supportsAutoResize:YES,shouldAutoResize:NO,shouldMeasureSize:NO,autoResizePadding:0,autoResizeText:function(){return this.get("title")}.property("title"),autoResizeLayer:function(){return this.$(".value")[0]}.property("layer").cacheable(),batchResizeId:function(){return"menu-"+SC.guidFor(this.parentMenu)}.property().cacheable(),didUpdateLayer:function(){this.notifyPropertyChange("autoResizeLayer");this.scheduleMeasurement()}});sc_require("panes/menu");sc_require("views/auto_resizing_menu_item");CW.AutoResizingMenuPane=CW.MenuPane.extend({shouldAutoResize:YES,exampleView:CW.AutoResizingMenuItemView,minimumMenuWidth:SC.propertyFromRenderDelegate("minimumMenuWidth",0),menuWidthPadding:SC.propertyFromRenderDelegate("menuWidthPadding",0),init:function(){arguments.callee.base.apply(this,arguments);if(this.get("shouldAutoResize")){this.invokeOnce("_updateMenuWidth")}},createMenuItemViews:function(){var g=arguments.callee.base.apply(this,arguments);var e,f=g.length,h;if(this.get("shouldAutoResize")){for(e=0;e<f;e++){h=g[e];h.set("shouldMeasureSize",YES);h.addObserver("measuredSize",this,this._menuItemMeasuredSizeDidChange)}}return g},_menuItemViewsDidChange:function(){if(this.get("shouldAutoResize")){this.invokeOnce("_updateMenuWidth")}}.observes("menuItemViews"),_menuItemMeasuredSizeDidChange:function(b){this.invokeOnce("_updateMenuWidth")},_menuMinimumMenuWidthDidChange:function(){this.invokeOnce("_updateMenuWidth")}.observes("minimumMenuWidth"),_updateMenuWidth:function(){var h=this.get("menuItemViews");if(!h){return}var f=h.length,g,k,j=this.get("minimumMenuWidth");for(g=0;g<f;g++){k=h[g];j=Math.max(j,k.get("measuredSize").width+this.get("menuWidthPadding"))}this.adjustDesiredSize("width",j)}});sc_require("panes/picker");CW.CalloutPicker=CW.PickerPane.extend(CW.Animatability,CW.PaneFadingSupport,{desiredSize:{width:215,height:43},minimumSize:{width:150,height:43},renderStyle:"iOS.callout",layouts:[CW.PickerLayout.ON_TOP],titleValue:"Callout title",detailValue:"Callout detail",escapeTitle:YES,escapeDetail:YES,target:"",action:"",preferType:SC.PICKER_POINTER,acceptsKeyPane:NO,acceptsFirstResponder:NO,isModal:NO,repositionOnWindowResize:NO,contentView:SC.View.extend({childViews:["title","detail","button"],title:SC.LabelView.extend({layout:{top:0,height:25,left:9,right:35},classNames:"title",escapeHTMLBinding:"*parentView.parentView.escapeTitle",valueBinding:"*parentView.parentView.titleValue"}),detail:SC.LabelView.extend({layout:{top:24,left:9,height:15},classNames:"detail",escapeHTMLBinding:"*parentView.parentView.escapeDetail",valueBinding:"*parentView.parentView.detailValue"}),button:SC.ImageButtonView.extend({layout:{top:7,height:30,right:5,width:30},image:"info_button",targetBinding:"*parentView.parentView.target",actionBinding:"*parentView.parentView.action"})}),didCreateLayer:function(){this.invokeLater(this.recomputeDesiredSize,0)},recomputeDesiredSize:function(){var k=this.$(".title")[0],g=this.$(".detail")[0];if(SC.none(k)||SC.none(g)){return}var h=SC.metricsForString(this.get("titleValue"),k,null,NO),f=SC.metricsForString(this.get("detailValue"),g,null,NO),j=(h.width>f.width?h.width:f.width)+55;j=(j%2?j-1:j);this.adjustDesiredSize({width:Math.max(this.get("minimumSize").width,j)})},showCalloutInContainer:function(b){this._hideOverflow();this.appendTo(b)},valuesObserver:function(){this.recomputeDesiredSize()}.observes("detailValue","titleValue","layer"),modalPaneDidClick:function(){return NO}});CW.ErrorCalloutPicker=CW.PickerPane.extend({themeName:"errorCallout",renderStyle:"errorCallout",desiredSize:function(){return{width:this.get("errorWidth"),height:27}}.property("errorWidth").cacheable(),minimumSize:{width:120,height:27},errorText:"Please fill in required info",errorWidth:120,layouts:["onTop","onBottom"],acceptsFirstResponder:NO,acceptsKeyPane:NO,isModal:NO,contentView:SC.LabelView.extend({classNames:["error-picker-label"],valueBinding:".parentView.errorText"})});SC.BaseTheme.cwPickerRenderDelegate=SC.RenderDelegate.create({className:"cw-picker",render:function(d,e){e=e.begin("div").addClass("cw-picker-highlight");this.includeSlices(d,e,SC.THREE_SLICE);e.end()},update:function(){}});sc_require("render_delegates/picker");SC.BaseTheme.cwMenuRenderDelegate=SC.BaseTheme.cwPickerRenderDelegate.create({className:"cw-menu",render:function(d,e){this.addSizeClassName(d,e)},update:function(d,e){this.updateSizeClassName(d,e)},minimumCroppedHeight:200,itemHeight:22,itemSeparatorHeight:9,menuHeightPadding:0,menuWidthPadding:50,minimumMenuWidth:50,submenuOffsetX:2,verticalOffset:23,"sc-tiny-size":{itemHeight:10,itemSeparatorHeight:2,menuHeightPadding:0,submenuOffsetX:0},"sc-small-size":{itemHeight:16,itemSeparatorHeight:7,menuHeightPadding:0,submenuOffsetX:2},"sc-large-size":{itemHeight:31,itemSeparatorHeight:20,menuHeightPadding:0,submenuOffsetX:4},"sc-huge-size":{itemHeight:20,itemSeparatorHeight:9,menuHeightPadding:0,submenuOffsetX:0}});sc_require("render_delegates/menu");SC.BaseTheme.cwSelectMenuRenderDelegate=SC.BaseTheme.cwMenuRenderDelegate.create({menuLeftOffset:-15,menuTopOffset:0,menuMinimumWidthOffset:16,"sc-small-size":{itemHeight:16,itemSeparatorHeight:7,menuHeightPadding:0,submenuOffsetX:2,menuLeftOffset:-16},"sc-large-size":{itemHeight:31,itemSeparatorHeight:20,menuHeightPadding:0,submenuOffsetX:4,menuTopOffset:-2}});sc_require("system/picker_layout");CW.SelectMenuLayout={Aligned:CW.PickerLayout.extend({renderDelegateName:"cwPickerBackgroundRenderDelegate",distanceFromEdge:SC.propertyFromRenderDelegate("distanceFromEdge",15),desiredPosition:{left:0,top:0},desiredPositionBinding:SC.Binding.oneWay("*owner.desiredPosition"),layoutPropertyDidChange:function(e,d){if(d==="availableSpace"){this.scheduleLayout(CW.RELAYOUT_FOR_WINDOW)}else{if(d==="pointAtPoint"){this.scheduleLayout(CW.RELAYOUT_FOR_TARGET)}else{if(d==="desiredSize"){this.scheduleLayout(CW.RELAYOUT_FOR_DESIRED_SIZE)}else{if(d==="minimumSize"){this.scheduleLayout(CW.RELAYOUT_FOR_MINIMUM_SIZE)}}}}}.observes("availableSpace","desiredSize","minimumSize","desiredPosition"),computeLayout:function(){var m=this.get("desiredPosition"),h=this.get("desiredSize"),g=this.get("minimumSize"),j=this.get("availableSpace"),k=this.get("distanceFromEdge"),l={top:m.top,left:m.left,width:h.width,height:h.height};if(l.top<k){l.height=l.height-(k-l.top);l.top=k}if(l.top+l.height>j.height-k){l.height=j.height-k-l.top}if(l.height<g.height){l.height=g.height}if(l.top+l.height>j.height-k){l.top=j.height-k-l.height}if(l.left<k){l.left=k}if(l.left+l.width>j.width-k){l.left=j.width-k-l.width}if(l.left<k){l.left=k;l.width=j.width-l.left-k}this.set("layout",l);arguments.callee.base.apply(this,arguments)}})};sc_require("render_delegates/select_menu");sc_require("picker_layouts/layout_select_menu");sc_require("panes/auto_resizing_menu");sc_require("views/auto_resizing_menu_item");CW.SelectViewMenuPane=CW.AutoResizingMenuPane.extend({desiredPosition:{top:20,left:20},layouts:[CW.SelectMenuLayout.Aligned],selectView:null,value:null,valueBinding:".selectView.value",renderDelegateName:"cwSelectMenuRenderDelegate",renderStyle:"menu.cw-no-pointers",theme:"menu.cw-no-pointers",shouldDropDown:SC.propertyFromRenderDelegate("shouldDropDown",NO),valueDidChange:function(){var h=this.get("menuItemViews"),e,f=h.length,g;for(e=0;e<f;e++){g=h[e];if(g._lastIsChecked){g.notifyPropertyChange("isChecked")}if(g.get("isChecked")){g.notifyPropertyChange("isChecked")}}}.observes("value"),_svm_selectedMenuItemView:function(){var h=this.get("menuItemViews"),g=this.get("value"),e,f;if(!h){return undefined}f=h.length;for(e=0;e<f;e++){if(g===h[e].get("content").get(this.get("itemValueKey"))){return h[e]}}return undefined}.property("value","menuItemViews").cacheable(),exampleView:CW.AutoResizingMenuItemView.extend({isChecked:function(){this._lastIsChecked=this.getContentProperty("itemValueKey")===this.getPath("parentMenu.rootMenu.value");return this._lastIsChecked}.property(),displayProperties:["isChecked"]}),desiredPosition:function(){var b=this.get("pointAtRectangle");if(this.get("shouldDropDown")){return{left:b.left+this.get("menuLeftOffset"),top:b.top+b.height+this.get("menuTopOffset")}}else{return{left:b.left+this.get("menuLeftOffset"),top:b.top-this._svm_positionForValue(this.get("value"))+this.get("menuTopOffset")}}}.property("pointAtRectangle","value","menuItemViews","isDropDown"),_svm_positionForValue:function(d){var e=this.get("_svm_selectedMenuItemView");if(!e){return 0}return e.get("layout").top},menuLeftOffset:SC.propertyFromRenderDelegate("menuLeftOffset",0),menuTopOffset:SC.propertyFromRenderDelegate("menuTopOffset",0),menuMinimumWidthOffset:SC.propertyFromRenderDelegate("menuMinimumWidthOffset",0),minimumMenuWidth:function(){var b=this.get("pointAtRectangle");return b.width+this.get("menuMinimumWidthOffset")}.property("pointAtRectangle","menuMinimumWidthOffset").cacheable(),applyLayout:function(){arguments.callee.base.apply(this,arguments);var b=this.get("_svm_selectedMenuItemView");if(b){b.scrollToVisible()}},_svm_theme:null,_svm_themeBinding:"*selectView.theme",baseTheme:function(){return this.get("_svm_theme")||arguments.callee.base.apply(this,arguments)}.property("_svm_theme").cacheable(),_svm_bindToProperties:["items","itemTitleKey","itemIsEnabledKey","itemValueKey","itemIconKey","itemHeightKey","itemSubMenuKey","itemSeparatorKey","itemTargetKey","itemActionKey","itemCheckboxKey","itemShortCutKey","itemKeyEquivalentKey","itemDisableMenuFlashKey","controlSize"],_svm_setupBindings:function(){var k=this.get("selectView");if(!k){return}var h=this._svm_bindToProperties,f,g=h.length,j;for(f=0;f<g;f++){j=h[f];this[j+"Binding"]=this.bind(j,k,j)}this._svm_isBoundTo=k},_svm_clearBindings:function(){var h=this._svm_isBoundTo;if(!h){return}var j=this._svm_bindToProperties,f,g=j.length,k;for(f=0;f<g;f++){k=j[f];this[k+"Binding"].disconnect()}},_svm_selectViewDidChange:function(){this._svm_clearBindings();this._svm_setupBindings()}.observes("selectView"),initMixin:function(){this._svm_setupBindings()},destroyMixin:function(){this._svm_clearBindings()}});SC.BaseTheme.cwPickerBackgroundRenderDelegate=SC.RenderDelegate.create({className:"cw-picker-background",pickerDistanceFromRectangle:16,validPointerLayouts:[{name:"left-or-right-position",classNames:"calculated-pointer",minimumDistanceFromTop:60,minimumDistanceFromBottom:60,needsGap:YES},{name:"top-or-bottom-position",classNames:"calculated-pointer",minimumDistanceFromLeft:60,minimumDistanceFromRight:60,needsGap:YES},{classNames:"bottom-left-corner-pointer corner-pointer".w(),name:"point-left-on-bottom",bottom:20,needsGap:NO,side:CW.LEFT_SIDE},{classNames:"top-left-corner-pointer corner-pointer".w(),name:"point-left-on-top",top:20,needsGap:NO,side:CW.LEFT_SIDE},{classNames:"top-left-corner-pointer corner-pointer".w(),name:"point-up-on-left",left:20,needsGap:NO,side:CW.TOP_SIDE},{classNames:"top-right-corner-pointer corner-pointer".w(),name:"point-up-on-right",right:20,needsGap:NO,side:CW.TOP_SIDE},{classNames:"bottom-left-corner-pointer corner-pointer".w(),name:"point-down-on-left",left:20,needsGap:NO,side:CW.BOTTOM_SIDE},{classNames:"bottom-right-corner-pointer corner-pointer".w(),name:"point-down-on-right",right:20,needsGap:NO,side:CW.BOTTOM_SIDE},{classNames:"bottom-right-corner-pointer corner-pointer".w(),name:"point-right-on-bottom",bottom:20,needsGap:NO,side:CW.BOTTOM_SIDE},{classNames:"top-right-corner-pointer corner-pointer".w(),name:"point-right-on-top",top:20,needsGap:NO,side:CW.BOTTOM_SIDE}],render:function(G,E){var v=["top-left","bottom-left","top-right","bottom-right","middle"];this.addSizeClassName(G,E);var y=G.get("pointAtSide")||"right",s=G.get("pointerLayout"),D=s?s.needsGap:NO,x,A,F=G.get("pointerDistanceFromTop")||0,C=G.get("pointerDistanceFromBottom")||0,z=G.get("pointerDistanceFromLeft")||0,t=G.get("pointerDistanceFromRight")||0,B,H,u,w;if(y==="right"){B="top";H="bottom";u=F;w=C;A="left";v.push("right");v.push("top");v.push("bottom");x="sc-point-left"}else{if(y==="left"){B="top";H="bottom";u=F;w=C;A="right";v.push("left");v.push("top");v.push("bottom");x="sc-point-right"}else{if(y==="top"){B="left";H="right";u=z;w=t;A="bottom";v.push("top");v.push("left");v.push("right");x="sc-point-down"}else{B="left";H="right";u=z;w=t;A="top";v.push("bottom");v.push("left");v.push("right");x="sc-point-up"}}}if(s&&s.classNames){E.addClass(s.classNames)}if(s&&s.name){E.addClass(s.name)}E.setClass("needs-gap",D);this.includeSlices(G,E,v);E.begin("div").addClass("sc-pointer").addClass(x).css(B,u).end();E.begin("div").addClass(A).addClass("sc-before-pointer").css(H,D?w:null).end();E.begin("div").addClass(A).addClass("sc-after-pointer").css(B,D?u:null).end()},update:function(A,v){this.updateSizeClassName(A,v);var t=A.get("pointAtSide"),z=A.get("pointerDistanceFromTop"),x=A.get("pointerDistanceFromBottom"),u=A.get("pointerDistanceFromLeft"),p=A.get("pointerDistanceFromRight"),w,B,q,s,o=A.get("pointerLayout"),y=o?o.needsGap:NO;if(t==="right"||t==="left"){w="top";B="bottom";q=z;s=x}else{w="left";B="right";q=u;s=p}v.find(".sc-pointer").css(w,q);v.find(".sc-before-pointer").css(B,y?s:null);v.find(".sc-after-pointer").css(w,y?q:null);if(o&&o.classNames){v.addClass(o.classNames)}if(o&&o.name){v.addClass(o.name)}v.setClass("needs-gap",y)}});sc_require("render_delegates/picker_background");SC.BaseTheme.Callout=SC.BaseTheme.create({name:"callout"});SC.BaseTheme.addTheme(SC.BaseTheme.Callout);SC.BaseTheme.Callout.cwPickerBackgroundRenderDelegate=SC.BaseTheme.cwPickerBackgroundRenderDelegate.create({validPointerLayouts:[{name:"top-position",classNames:"calculated-pointer",minimumDistanceFromLeft:30,minimumDistanceFromRight:30,needsGap:YES}]});sc_require("render_delegates/picker_background");SC.BaseTheme.Menu=SC.BaseTheme.create({name:"menu"});SC.BaseTheme.addTheme(SC.BaseTheme.Menu);SC.BaseTheme.Menu.cwPickerBackgroundRenderDelegate=SC.BaseTheme.cwPickerBackgroundRenderDelegate.create({"sc-small-size":{pickerDistanceFromRectangle:8},"sc-regular-size":{pickerDistanceFromRectangle:12},"sc-large-size":{pickerDistanceFromRectangle:16},validPointerLayouts:[{name:"top-or-bottom-position",classNames:"calculated-pointer",minimumDistanceFromLeft:20,minimumDistanceFromRight:20,needsGap:NO},{classNames:"top-left-corner-pointer corner-pointer".w(),name:"point-up-on-left",left:15,needsGap:NO,side:CW.TOP_SIDE},{classNames:"top-right-corner-pointer corner-pointer".w(),name:"point-up-on-right",right:15,needsGap:NO,side:CW.TOP_SIDE},{classNames:"bottom-left-corner-pointer corner-pointer".w(),name:"point-down-on-left",left:15,needsGap:NO,side:CW.BOTTOM_SIDE},{classNames:"bottom-right-corner-pointer corner-pointer".w(),name:"point-down-on-right",right:15,needsGap:NO,side:CW.BOTTOM_SIDE}]});SC.BaseTheme.cwMenuPickerBackgroundRenderDelegate=SC.BaseTheme.Menu.cwPickerBackgroundRenderDelegate;sc_require("render_delegates/menu_background");SC.BaseTheme.NoPointers=SC.BaseTheme.Menu.create({name:"cw-no-pointers"});SC.BaseTheme.addTheme(SC.BaseTheme.NoPointers);SC.BaseTheme.NoPointers.cwPickerBackgroundRenderDelegate=SC.RenderDelegate.create({className:"cw-picker-background",distanceFromEdge:20,render:function(d,e){this.addSizeClassName(d,e);this.includeSlices(d,e,SC.NINE_SLICE)},update:function(d,e){this.updateSizeClassName(d,e)},});sc_require("render_delegates/menu");sc_require("render_delegates/picker_nopointer_background");SC.BaseTheme.DropDown=SC.BaseTheme.create({name:"dropdown"});SC.BaseTheme.addTheme(SC.BaseTheme.DropDown);SC.BaseTheme.DropDown.cwMenuRenderDelegate=SC.BaseTheme.cwMenuRenderDelegate.create({menuLeftOffset:-3,menuTopOffset:7,menuMinimumWidthOffset:-18,shouldDropDown:YES});SC.BaseTheme.DropDown.cwPickerBackgroundRenderDelegate=SC.BaseTheme.NoPointers.cwPickerBackgroundRenderDelegate;SC.BaseTheme.ErrorCallout=SC.BaseTheme.create({name:"errorCallout"});SC.BaseTheme.ErrorCallout.cwPickerBackgroundRenderDelegate=SC.BaseTheme.cwPickerBackgroundRenderDelegate.create({pickerDistanceFromRectangle:10,validPointerLayouts:[{name:"top-position",classNames:"calculated-pointer",minimumDistanceFromLeft:30,minimumDistanceFromRight:30,needsGap:NO}]});sc_require("render_delegates/menu");sc_require("render_delegates/picker_nopointer_background");SC.BaseTheme.PopUp=SC.BaseTheme.create({name:"popup"});SC.BaseTheme.addTheme(SC.BaseTheme.PopUp);SC.BaseTheme.PopUp.cwMenuRenderDelegate=SC.BaseTheme.cwMenuRenderDelegate.create({shouldDropDown:NO});SC.BaseTheme.PopUp.cwPickerBackgroundRenderDelegate=SC.BaseTheme.NoPointers.cwPickerBackgroundRenderDelegate;SC.BaseTheme.cwPopupButtonRenderDelegate=SC.BaseTheme.buttonRenderDelegate.create({render:function(d,e){e.attr("aria-haspopup","true");arguments.callee.base.apply(this,arguments)},update:function(d,e){arguments.callee.base.apply(this,arguments)}});SC.BaseTheme.cwSelectRenderDelegate=SC.BaseTheme.buttonRenderDelegate.create({});CW.PopupButtonView=SC.ButtonView.extend({renderDelegateName:"cwPopupButtonRenderDelegate",menu:CW.MenuPane,shouldLoadInBackground:NO,_menuIsLoaded:NO,isActive:NO,acceptsFirstResponder:YES,init:function(){arguments.callee.base.apply(this,arguments);this._currentMenu=null;this.invokeOnce("scheduleMenuSetupIfNeeded")},scheduleMenuSetupIfNeeded:function(){var b=this.get("menu");if(b&&b.isClass&&this.get("shouldLoadInBackground")){SC.backgroundTaskQueue.push(CW.PopupButtonView.InstantiateMenuTask.create({popupButton:this}))}},menuDidChange:function(){var b=this.get("menu");if(b===this._currentMenu){return}this.invokeOnce("scheduleMenuSetupIfNeeded")}.observes("menu"),setupMenu:function(){var b=this.get("menu");if(b===this._currentMenu){return}if(this._currentMenu){this.isActiveBinding.disconnect();this._currentMenu.destroy();this._currentMenu=null}if(b&&b.isClass){b=this.createMenu(b)}this._currentMenu=b;this.set("menu",b);b.set("owner",this);this.isActiveBinding=this.bind("isActive",b,"isVisibleInWindow")},createMenu:function(b){return b.create()},showMenu:function(){this.setupMenu();this.invokeLast("_showMenu")},hideMenu:function(){var b=this.get("menu");if(b&&!b.isClass){b.remove()}},_showMenu:function(){var b=this.get("menu");b.popup(this)},mouseDown:function(e){if(!this.get("isEnabled")){return YES}this.set("_mouseDown",YES);this.showMenu();this._mouseDownTimestamp=null;var d=this;d._mouseDownTimestamp=0;setTimeout(function(){d._mouseDownTimestamp=Date.now()},1);this.becomeFirstResponder();return YES},mouseUp:function(e){var g=this.get("menu"),f,h;if(g&&this.get("_mouseDown")){f=g.getPath("rootMenu.targetMenuItem");if(this._mouseDownTimestamp===0){this._mouseDownTimestamp=Date.now()}if(e.timeStamp-this._mouseDownTimestamp>400){if(f&&g.get("mouseHasEntered")&&this._mouseDownTimestamp){if(!f.performAction()){g.remove()}}else{g.remove()}}}this._mouseDownTimestamp=undefined;return YES},keyDown:function(b){if(b.which==13){this.showMenu();return YES}return arguments.callee.base.apply(this,arguments)}});CW.PopupButtonView.InstantiateMenuTask=SC.Task.extend({popupButton:null,run:function(b){this.popupButton.setupMenu()}});sc_require("views/popup_button");sc_require("panes/select_view_menu");sc_require("panes/menu");sc_require("render_delegates/select");CW.SelectView=CW.PopupButtonView.extend({themeName:"popup",renderDelegateName:"cwSelectRenderDelegate",items:null,itemsBindingDefault:SC.Binding.multiple(),itemTitleKey:"title",itemSortKey:null,itemValueKey:"value",itemIconKey:"icon",itemSeparatorKey:"separator",itemIsEnabledKey:"isEnabled",menu:CW.SelectViewMenuPane,selectedItem:null,selectedItemBinding:"*menu.rootMenu.selectedItem",supportsFocusRing:YES,init:function(){arguments.callee.base.apply(this,arguments);this._scsv_updateTitle();this._scsv_valueDidChange()},_scsv_getValueForMenuItem:function(d){var e=this.get("itemValueKey")||"value";if(SC.typeOf(d)===SC.T_STRING){return d}else{if(d.get){return d.get(e)}else{return d[e]}}},_scsv_selectedItemDidChange:function(){var g=this.get("selectedItem"),h=this._scsv_lastSelection,f=this.get("itemTitleKey")||"title",e=this.get("itemValueKey")||"value";if(g){this.setIfChanged("value",this._scsv_getValueForMenuItem(g))}if(h&&h.addObserver&&g!==h){h.removeObserver(f,this,this._scsv_selectedItemPropertyDidChange);h.removeObserver(e,this,this._scsv_selectedItemPropertyDidChange)}if(g&&g.addObserver&&g!==h){g.addObserver(f,this,this._scsv_selectedItemPropertyDidChange);g.addObserver(e,this,this._scsv_selectedItemPropertyDidChange)}this._scsv_lastSelection=g}.observes("selectedItem"),_scsv_selectedItemPropertyDidChange:function(b){this._scsv_updateTitle();this.set("value",b.get(this.get("itemValueKey")||"value"))},defaultTitle:"",_scsv_updateTitle:function(){var d=this.get("selectedItem"),f,e;if(!d){f=this.get("defaultTitle")}else{if(d.get){f=d.get(this.get("itemTitleKey")||"title");e=d.get(this.get("itemIconKey")||"icon")}else{if(SC.typeOf(d)==SC.T_HASH){f=d[this.get("itemTitleKey")||"title"];e=d[this.get("itemIconKey")||"icon"]}else{f=d}}}if(f){this.set("title",f)}this.set("icon",e)}.observes("selectedItem"),_scsv_valueDidChange:function(){var h=this.get("value");if(!this.get("items")){return}var k=this.get("items"),f=k.get?k.get("length"):k.length,g,j;for(g=0;g<f;g++){j=k.objectAt?k.objectAt(g):k[g];if(this._scsv_getValueForMenuItem(j)===h){this.setIfChanged("selectedItem",j);return}}this.setIfChanged("selectedItem",null)}.observes("value"),_scsv_itemsDidChange:function(){this._scsv_valueDidChange()}.observes("items","items.[]"),createMenu:function(e){var d={selectView:this,selectedItem:this.get("selectedItem")};return e.create(d)},keyDown:function(b){if(this.interpretKeyEvents(b)){return YES}else{arguments.callee.base.apply(this,arguments)}},interpretKeyEvents:function(b){if(b){if((b.keyCode===38||b.keyCode===40)){this.showMenu();return YES}else{if(b.keyCode===27){this.resignFirstResponder();return YES}}}return arguments.callee.base.apply(this,arguments)},acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled").cacheable()});if(CW.isApp()&&window.parent){try{window.open=window.parent.open;device=window.parent.device;navigator.geolocationPhonegap=window.parent.navigator.geolocation;navigator.connection=window.parent.navigator.connection;navigator.compass=window.parent.navigator.compass;navigator.accelerometer=window.parent.navigator.accelerometer;navigator.contacts=window.parent.navigator.contacts;Contact=window.parent.Contact;ContactFindOptions=window.parent.ContactFindOptions;ContactAddress=window.parent.ContactAddress;ContactError=window.parent.ContactError;ContactName=window.parent.ContactName;ContactOrganization=window.parent.ContactOrganization;LocalFileSystem=window.parent.LocalFileSystem;requestFileSystem=window.parent.requestFileSystem}catch(ex){SC.error(ex)}}else{navigator.geolocationPhonegap=navigator.geolocation}try{if(CW.isApp()&&window.parent&&window.parent.datePicker){datePicker=window.parent.datePicker}}catch(ex){SC.error(ex)}try{if(CW.isApp()&&window.parent&&window.parent.navigator&&window.parent.navigator.fileSystem){navigator.fileSystem=window.parent.navigator.fileSystem}}catch(ex){SC.error(ex)}if(!navigator.fileSystem){navigator.fileSystem=SC.Object.create({allkeys:["workflow.store","chat.store"],getPlatform:function(){var a="browser";return a},writeFile:function(n){var a=n.filename,h=n.data,b=n.callBackForSuc,l=n.callBackForFail;var g=new Date().getTime();SC.debug("writeFile,filename:%@".fmt(a));var d=this.getPlatform();SC.debug("platform:%@".fmt(d));switch(d){case"shell":var e=function(p){var o=new Date().getTime();SC.debug("writeFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(a,p?p:"",o-g));if(l){l()}appshell.fs.writeFile(a,"","utf8");SC.debug("%@".fmt(a))};if(!appshell.fs){e("");return}try{var m=appshell.app.getApplicationSupportDirectory();a="%@/%@.json".fmt(m,a);appshell.fs.writeFile(a,h,"utf8",function(q){SC.debug("writeFile complete,state:%@".fmt(q));var p={11:"ERR_BROWSER_NOT_INSTALLED",4:"ERR_CANT_READ",6:"ERR_CANT_WRITE",10:"ERR_FILE_EXISTS",2:"ERR_INVALID_PARAMS",9:"ERR_NOT_DIRECTORY",8:"ERR_NOT_FILE",3:"ERR_NOT_FOUND",7:"ERR_OUT_OF_SPACE",1:"ERR_UNKNOWN",5:"ERR_UNSUPPORTED_ENCODING",0:"NO_ERROR"};if(q==0){var o=new Date().getTime();SC.debug("writeFile suc,filename:%@,speedTime:%@ms".fmt(a,o-g));if(b){b()}}else{e(p[q])}})}catch(k){e(k)}break;case"phonegap":var e=function(p,q){var o=new Date().getTime();SC.debug("writeFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(a,p?p:"",o-g));SC.debug(p);if(l){l(p)}if(q){q.write("");SC.debug("%@".fmt(a))}};if(!window.requestFileSystem){e("");return}try{window.requestFileSystem(LocalFileSystem.PERSISTENT,0,f,e);function f(o){o.root.getFile("%@.json".fmt(a),{create:true,exclusive:false},function(p){p.createWriter(function(q){q.onerror=function(s){e(q.error,q)};q.onwrite=function(s){var t=new Date().getTime();SC.debug("writeFile suc,filename:%@,speedTime:%@ms".fmt(a,t-g));if(b){b(s)}};q.write(h)},e)},e)}}catch(k){e(k)}break;default:try{localStorage.setItem(a,h);var j=new Date().getTime();SC.debug("writeFile suc,filename:%@,speedTime:%@ms".fmt(a,j-g));if(b){b()}}catch(k){var j=new Date().getTime();SC.debug("writeFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(a,k,j-g));if(l){l(k)}localStorage.setItem(a,"");SC.debug("%@".fmt(a))}break}},readFile:function(n){var b=n.filename,d=n.callBackForSuc,l=n.callBackForFail;var h=new Date().getTime();SC.debug("readFile,filename:%@".fmt(b));var e=this.getPlatform();SC.debug("platform:%@".fmt(e));switch(e){case"shell":var f=function(p){var o=new Date().getTime();SC.debug("readFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(b,p?p:"",o-h));if(l){l(p)}};if(!appshell.fs){f("");return}try{var m=appshell.app.getApplicationSupportDirectory();b="%@/%@.json".fmt(m,b);appshell.fs.readFile(b,"utf8",function(s,o){SC.debug("readFile complete,state:%@".fmt(s));var q={11:"ERR_BROWSER_NOT_INSTALLED",4:"ERR_CANT_READ",6:"ERR_CANT_WRITE",10:"ERR_FILE_EXISTS",2:"ERR_INVALID_PARAMS",9:"ERR_NOT_DIRECTORY",8:"ERR_NOT_FILE",3:"ERR_NOT_FOUND",7:"ERR_OUT_OF_SPACE",1:"ERR_UNKNOWN",5:"ERR_UNSUPPORTED_ENCODING",0:"NO_ERROR"};if(s==0){var p=new Date().getTime();SC.debug("readFile suc,filename:%@,speedTime:%@ms".fmt(b,p-h));if(d){d(o)}}else{f(q[s])}})}catch(k){f(k)}break;case"phonegap":var f=function(p){var o=new Date().getTime();SC.debug("readFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(b,p?p:"",o-h));SC.debug(p);if(l){l(p)}};if(!window.requestFileSystem){f("");return}try{window.requestFileSystem(LocalFileSystem.PERSISTENT,0,g,f);function g(o){o.root.getFile("%@.json".fmt(b),null,function(p){p.file(function(s){var q=new FileReader();q.onerror=function(t){f(q.error)};q.onload=function(t){var u=new Date().getTime();SC.debug("readFile suc,filename:%@,speedTime:%@ms".fmt(b,u-h));if(d){d(t.target.result)}};q.onloadend=function(t){};q.readAsText(s)},f)},f)}}catch(k){f(k)}break;default:try{var a=localStorage.getItem(b);var j=new Date().getTime();SC.debug("readFile suc,filename:%@,speedTime:%@ms".fmt(b,j-h));if(d){d(a)}}catch(k){var j=new Date().getTime();SC.debug("readFile fail,filename:%@,error:%@,speedTime:%@ms".fmt(b,k,j-h));if(l){l(k)}}break}},clear:function(){SC.debug("navigator.fileSystem.clear");var a=this.allkeys;a.forEach(function(b){this.writeFile({filename:b,data:""})},this)}})}CW.IndexedDB=SC.Object.create({localDatabase:{},dbName:"default",recordTypes:{},initDatabase:function(b,a){this.localDatabase.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;this.localDatabase.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange;this.localDatabase.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction;this.localDatabase.indexedDB.onerror=function(d){SC.error("IndexedDB: error: "+d.target.errorCode)};this.set("dbName",b);this.set("recordTypes",a)},openDatabase:function(e,b){var d=this.localDatabase;var a=d.indexedDB.open(this.dbName);a.onsuccess=function(f){SC.debug("IndexedDB: Opened Database");d.db=a.result;if(e){e.apply(b)}};a.onerror=this.localDatabase.indexedDB.onerror},createDatabase:function(b){var d=this.localDatabase;if(d.db&&d.db.close){SC.debug("IndexedDB: Close Database");d.db.close(this.dbName)}SC.debug("IndexedDB: Deleting local database");var a=d.indexedDB.deleteDatabase(this.dbName);if(!b){b=function(){}}a.callbackForSuc=b;a.onsuccess=function(f){SC.debug("IndexedDB: Database deleted");var e=d.indexedDB.open(CW.IndexedDB.dbName,1);e.callbackForSuc=this.callbackForSuc;e.onerror=function(g){SC.error("IndexedDB: Database error: "+g.target.errorCode)};e.onsuccess=function(g){SC.debug("IndexedDB: Database created");d.db=e.result;if(this.callbackForSuc){this.callbackForSuc()}};e.onupgradeneeded=function(g){SC.debug("IndexedDB: Creating object stores");var h=CW.IndexedDB.recordTypes;for(key in h){g.currentTarget.result.createObjectStore(key,{keyPath:"id"})}g.currentTarget.result.createObjectStore("Properties",{keyPath:"id"})}};a.onerror=this.localDatabase.indexedDB.onerror},getRecord:function(l,a,b,d){try{var h=this.localDatabase;if(h!=null&&h.db!=null){var g=IDBKeyRange.only(a);var m=h.db.transaction(l).objectStore(l);var j=m.index("id");var f=j.openCursor(g);f.callbackForSuc=b;f.callbackForFail=d;f.onsuccess=function(o){var p=o.target.result;if(!!p==true){var n;try{n=JSON.parse(p.value.value)}catch(o){n=p.value.value}if(this.callbackForSuc){this.callbackForSuc(n)}}};f.onerror=function(n){SC.error("IndexedDB: getItem "+l+" "+a+" error: "+n.value);if(this.callbackForFail){this.callbackForFail()}}}else{if(d){d()}}}catch(k){SC.error("IndexedDB: getItem "+l+" "+a+" error: "+k);if(d){d()}}},setItem:function(j,f,a){var e=new Date()*1;var h=this.localDatabase;var b=h.db.transaction(j,"readwrite");var k=b.objectStore(j);if(h!=null&&h.db!=null&&a){if(f){var g={id:a,value:f};var d=k.put(g);d.onsuccess=function(l){SC.debug("IndexedDB: Write "+j+" "+a+". Spent "+(new Date()*1-e)+" ms.")};d.onerror=function(l){SC.error("IndexedDB: "+j+" record was not written: "+l.value)}}else{d.onsuccess=function(l){SC.debug("IndexedDB: Deleted "+j+" "+a+". Spent "+(new Date()*1-e)+" ms.")};d.onerror=function(l){SC.error("IndexedDB: "+j+" record was not deleted: "+l.value)}}}},clear:function(){var b=this.localDatabase;if(b.db&&b.db.close){SC.debug("IndexedDB: Close Database");b.db.close(this.dbName)}SC.debug("IndexedDB: Deleting local database");var a=b.indexedDB.deleteDatabase(this.dbName);a.onsuccess=function(d){SC.debug("IndexedDB: Database deleted")};a.onerror=this.localDatabase.indexedDB.onerror},getAllRecords:function(f,a){SC.debug("IndexedDB: getAllItems");var b=this.recordTypes;var d={};var e=[];for(key in b){d[key]=[];e.pushObject(key)}d.Properties={};e.pushObject("Properties");this.queryDatabase(e,0,f,a,d)},queryDatabase:function(a,j,b,d,g){try{var h=this.localDatabase;if(h!=null&&h.db!=null){if(a[j]){var l=h.db.transaction(a[j]).objectStore(a[j]);var f=l.openCursor();f.tableArray=a;f.count=j+1;f.callbackForSuc=b;f.callbackForFail=d;f.results=g;f.onsuccess=function(n){var o=n.target.result;if(!!o==true){var p=o.value.id;var m;try{m=JSON.parse(o.value.value)}catch(n){m=o.value.value}if(a[j]==="Properties"){g.Properties=m}else{g[a[j]].pushObjects(m)}}else{CW.IndexedDB.queryDatabase(this.tableArray,this.count,this.callbackForSuc,this.callbackForFail,this.results)}};f.onerror=function(m){SC.error("IndexedDB: Query "+a[j]+" error: "+m.value);if(this.callbackForFail){this.callbackForFail()}return false}}else{if(b){b(g)}}}else{if(d){d()}}}catch(k){SC.error("IndexedDB: Query "+a[j]+" error: "+k);if(d){d()}}},getRecordsByTable:function(d,j,a){try{var f={};var k=this.localDatabase;if(k!=null&&k.db!=null){var b=k.db.transaction(d).objectStore(d);var g=b.openCursor();g.results=f;g.callbackForSuc=j;g.callbackForFail=a;g.onsuccess=function(m){var n=m.target.result;if(!!n==true){var o=n.value.id,l;try{l=JSON.parse(n.value.value)}catch(m){l=n.value.value}this.results[o]=l}else{if(this.callbackForSuc){this.callbackForSuc(this.results)}}};g.onerror=function(l){SC.error("IndexedDB: getItems "+d+" error: "+l.value);if(this.callbackForFail){this.callbackForFail()}}}else{if(a){a()}}}catch(h){SC.error("IndexedDB: getItems "+d+" error: "+h);if(a){a()}}},});try{if(CW.isApp()&&window.parent&&window.parent.navigator&&window.parent.navigator.notification){navigator.notification=window.parent.navigator.notification}}catch(ex){SC.error(ex)}if(!navigator.notification){navigator.notification=SC.Object.create({alert:function(b,d,f,a){var e={};if(!f){f="Alert"}if(!a){a="OK"}e.message=f;e.description=b;e.rightButton={title:a,action:function(){this.get("pane").remove();this.get("pane").destroy();d()}};var g=CW.Alert.create(e);g.append();return g},confirm:function(a,g,e,b){var d={};if(!e){e="Confirm"}if(!b){b=["OK","Cancel"]}d.message=e;d.description=a;if(!(b instanceof Array)){b=[b]}if(b.length==1){d.rightButton={title:b[0],action:function(){this.get("pane").remove();this.get("pane").destroy();g()}}}else{if(b.length==2){d.leftButton={title:b[1],action:function(){this.get("pane").remove();this.get("pane").destroy();g(2)}};d.rightButton={title:b[0],action:function(){this.get("pane").remove();this.get("pane").destroy();g(1)}}}else{if(b.length==3){d.leftButton={title:b[2],action:function(){this.get("pane").remove();this.get("pane").destroy();g(3)}};d.middleButton={title:b[1],action:function(){this.get("pane").remove();this.get("pane").destroy();g(2)}};d.rightButton={title:b[0],action:function(){this.get("pane").remove();this.get("pane").destroy();g(1)}}}else{alert("Can not show more than 3 buttons.")}}}var f=CW.Alert.create(d);f.append();return f},prompt:function(b,d,g,e,a){var f={};if(!g){g="Prompt"}if(!e){e=["OK","Cancel"]}if(!a){a=""}f.message=g;f.description=b;f.defaultText=a;if(!(e instanceof Array)){e=[e]}if(e.length==1){f.rightButton={title:e[0],action:function(){var k={};var j=this.getPath("pane.childViews.firstObject.promptView.value");k.input1=j?j:"";this.get("pane").remove();this.get("pane").destroy();d(k)}}}else{if(e.length==2){f.leftButton={title:e[1],action:function(){var k={};var j=this.getPath("pane.childViews.firstObject.promptView.value");k.buttonIndex=2;k.input1=j?j:"";this.get("pane").remove();this.get("pane").destroy();d(k)}};f.rightButton={title:e[0],action:function(){var k={};var j=this.getPath("pane.childViews.firstObject.promptView.value");k.buttonIndex=1;k.input1=j?j:"";this.get("pane").remove();this.get("pane").destroy();d(k)}}}else{if(e.length==3){f.leftButton={title:e[2],action:function(){var k={};var j=this.getPath("pane.childViews.firstObject.promptView.value");k.buttonIndex=3;k.input1=j?j:"";this.get("pane").remove();this.get("pane").destroy();d(k)}};f.middleButton={title:e[1],action:function(){var k={};var j=this.getPath("pane.childViews.firstObject.promptView.value");k.buttonIndex=2;k.input1=j?j:"";this.get("pane").remove();this.get("pane").destroy();d(k)}};f.rightButton={title:e[0],action:function(){var k={};var j=this.getPath("pane.childViews.firstObject.promptView.value");k.buttonIndex=1;k.input1=j?j:"";this.get("pane").remove();this.get("pane").destroy();d(k)}}}else{alert("Can not show more than 3 buttons.")}}}var h=CW.Prompt.create(f);h.append();return h}})}CW.Storage=SC.Object.extend({dbName:"default",recordTypes:{},isReady:false,getStorageType:function(){return"localStorage"}.property().cacheable(),init:function(){if(this.get("getStorageType")==="indexedDB"){SC.debug("CW.Storage: indexedDB");CW.IndexedDB.initDatabase(this.get("dbName"),this.get("recordTypes"));CW.IndexedDB.openDatabase(function(){this.set("isReady",true)},this)}else{this.invokeLast(function(){SC.debug("CW.Storage: localStorage");this.set("isReady",true)})}},getItem:function(m,a,k,h){SC.debug("CW.Storage: getItem "+m+" "+a);switch(this.get("getStorageType")){case"indexedDB":if(m&&a){CW.IndexedDB.getRecordsByTable(m,k,h)}else{if(m){CW.IndexedDB.getRecordsByTable(m,k,h)}else{CW.IndexedDB.getAllRecords(k,h)}}break;default:try{var b=new Date().getTime();if(m){m=this.get("dbName")+"."+m;var n=m;var l=localStorage.getItem(n),g;try{l=JSON.parse(l)}catch(j){}if(a&&l){g={};g[a]=l}else{g=l}SC.debug("localStorage: getItem "+m+" "+a+". Spent "+(new Date().getTime()-b)+"ms.");if(k){k(g)}}else{var f={};for(var d=0;d<localStorage.length;d++){var n=localStorage.key(d);var l=localStorage.getItem(n),g;try{g=JSON.parse(l)}catch(j){g=l}if(n&&n.split(".")){n=n.split(".").lastObject()}f[n]=g}SC.debug("localStorage: getItem "+m+" "+a+". Spent "+(new Date().getTime()-b)+"ms.");if(k){k(f)}}}catch(j){SC.error(j);if(h){h()}}break}},setItem:function(b,d,e){SC.debug("CW.Storage: setItem "+b+" "+e);switch(this.get("getStorageType")){case"indexedDB":CW.IndexedDB.setItem(b,d,e);break;default:var a=new Date().getTime();b=this.get("dbName")+"."+b;if(d){localStorage.setItem(b,d)}else{localStorage.removeItem(b)}SC.debug("localStorage: setItem "+b+" "+e+". Spent "+(new Date().getTime()-a)+"ms.");break}},clear:function(f){SC.debug("CW.Storage: clear");switch(this.get("getStorageType")){case"indexedDB":CW.IndexedDB.createDatabase(f);break;default:var a=new Date().getTime();var e=this.get("dbName");for(var d=0;d<localStorage.length;d++){var b=localStorage.key(d);if(b&&b.split(".")&&(b.split(".").firstObject()===e)){d--;localStorage.removeItem(b)}}SC.debug("localStorage: clear. Spent "+(new Date().getTime()-a)+"ms.");if(f){f()}break}},});jQuery.notification=(function(f,e){var b=(function(){if(e.Notification&&(e.Notification.permissionLevel||e.Notification.permission)){return e.Notification}var h=e.webkitNotifications;if(!h){return(function(){var k={};k.permission="unsupported";k.permissionLevel=function(){return"unsupported"};k.requestPermission=f.noop;return k}())}var g=["granted","default","denied"];var j=function(m,l){l=l||{};if(!m){return}var k=h.createNotification(l.iconUrl||"",m,l.body||"");k.titleDir=l.titleDir||"auto";k.body=l.body||"";k.bodyDir=l.bodyDir||"auto";k.tag=l.tag||"";k.replaceId=l.tag||"";k.iconUrl=l.iconUrl||"";k.onclick=l.onclick||f.noop;k.onshow=l.onshow||f.noop;k.onerror=l.onerror||f.noop;k.onclose=l.onclose||f.noop;k.close=function(){k.cancel()};if(j.permissionLevel()==="granted"){k.show()}return k};j.permissionLevel=function(){return j.permission=g[h.checkPermission()]};j.permissionLevel();j.requestPermission=function(l){if(j.permissionLevel()!=="default"){l();return}if(h.requestPermission.length){h.requestPermission(function(){j.permissionLevel();l()});return}h.requestPermission();var k=e.setInterval(function(){var m=j.permissionLevel();if(m!=="default"){e.clearInterval(k);l()}},200)};return j}());var a=function(g){if((b.permission||b.permissionLevel())!=="default"){g();return}b.requestPermission(g)};var d=function(h){var g=f.Deferred();if(!b.prototype){g.reject("unsupported");return g.promise()}if(typeof h==="string"){h={title:h}}h=h||{};h.autoclose=typeof h.autoclose==="undefined"?true:h.autoclose;h.timeout=h.timeout||Infinity;var j=h.iconUrl||h.icon;if(j){h.icon=j}a(function(){var l=b.permission||b.permissionLevel();if(l!=="granted"){g.reject(l);return}var k=new b(h.title,h);if(isFinite(h.timeout)){k.addEventListener("show",function(){setTimeout(function(){k.close()},h.timeout)},false)}if(h.autoclose){k.addEventListener("click",function(){k.close()},false)}g.resolve(k)});return g.promise()};d.permission=b.permission;d.permissionLevel=b.permissionLevel||function(){return b.permission};d.requestPermission=a;return d}(jQuery,window));CK=SC.Object.create({NAMESPACE:"CK",VERSION:"1.0.0",LOAD_REASON_USER_CLICK:1,LOAD_REASON_LOCATION_HASH:2,LOAD_REASON_APP_SWITCH:3,LOAD_REASON_NOTIFICATION:4,LOAD_REASON_RELOAD:5,EXIT_NON_FATAL:0,EXIT_FATAL_ERROR:1,EXIT_STARTUP_ERROR:2,currentApplication:null,isLoadedBySteedOS:!!CW.getUrlParameters().isLoadedBySteedOS,isBeta:window.location.hostname==="beta.steedos.com"?YES:NO,isDeveloper:window.location.hostname==="developer.steedos.com"?YES:NO,init:function(){SC.ready(this.redirectToSteedOSIfNeeded)},redirectToSteedOSIfNeeded:function(){},queryParamsToOmitForStartupCaching:["clientId","clientBuildNumber"],startupUrlsAreEqual:function(d,e){return this.removeQueryParamsToOmitForStartupCaching(d)===this.removeQueryParamsToOmitForStartupCaching(e)},removeQueryParamsToOmitForStartupCaching:function(k){if(!k){return k}var h=URI(k),j=CK.queryParamsToOmitForStartupCaching,f,g;for(f=0,g=j.length;f<g;f++){h.removeSearch(j[f])}return h.toString()}});CK.CJK_UNICODE_RANGES=[[4352,4607],[11904,12031],[12032,12255],[12288,12351],[12352,12447],[12544,12591],[12592,12687],[12688,12703],[12704,12735],[12800,13055],[13056,13311],[13312,19893],[19968,40959],[40960,42127],[42128,42191],[44032,55203],[63744,64255],[65072,65103]];CK.mixin({getCurrentLocaleInISOFormat:function(){var d=String.preferredLanguage,e=null;if(d){e=d.substr(0,2).toLowerCase()+"_"+d.substr(3,5).toUpperCase()}return e},characterCodeIsCJK:function(h){var k=CK.CJK_UNICODE_RANGES,j;if(SC.none(h)){return NO}for(var f=0,g=k.length;f<g;++f){j=k[f];if(h>=j[0]&&h<=j[1]){return YES}}return NO},stringIsCJK:function(f){f=f.trim();if(SC.empty(f)){return NO}var d=0,e=f.length-1;while(d<=e){if(!this.characterCodeIsCJK(f.charCodeAt(d++))||!this.characterCodeIsCJK(f.charCodeAt(e--))){return NO}}return YES},displayNameFor:function(l,g,j,k,h){var m;if(l&&g){if(this.stringIsCJK(l)&&this.stringIsCJK(g)){m=g+l}else{m="Name.Display.FirstAndFamilyNames".loc({firstName:l,familyName:g})}}else{if(l){m=l}else{if(g){m=g}else{if(k){m=k}else{if(h){m=h}}}}}if(!m){m=j||""}return m},readCookie:function(j,h){var m=document.cookie,g,k,l;if(m.length>0){if(h){l=m.match(new RegExp("("+j+")="));if(l){j=l[1]}}g=m.indexOf(j+"=");if(g!==-1){g=g+j.length+1;k=m.indexOf(";",g);if(k===-1){k=m.length}return window.unescape(m.substring(g,k))}}return null},writeCookie:function(t,q,k,o,n,l){var m,p,s;if(!t){return undefined}if(q===undefined||q===null){q="";p="expires=Thu, 01-Jan-1970 00:00:01 GMT;"}if(n){s=n*1000*60*60;p="expires="+new Date(new Date().getTime()+(s))}if(l){p+=";Secure"}if(!k){k="/"}if(!o){o="."+window.location.hostname}m=document.cookie=t+"="+q+";path="+k+";domain="+o+";"+p;if(!m){SC.info('Not able to set cookie "%@" with "%@"',t,q)}return m},formatNumberWithLocale:function(b){return CW.formatNumber(b,"Numbers.ThousandsSeparator".loc(),"Numbers.DecimalSeparator".loc())},getLegacyLprojNameForLocale:function(e){var d={"en-us":"us","zh-cn":"cn"};var f=d[e];if(!f){f="us"}return f},openHelp:function(g,j,k){var h=this.getLegacyLprojNameForLocale(String.preferredLanguage);var l="http://www.steedos.com/%@/help/".fmt(h);if(CW.isOEM()){l="http://www.steedos.com/%@/helpoem/".fmt(h)}window.open(l,"guide","EnableViewPortScale=yes,location=0,status=0,scrollbars=0, width=980,height=600")},hasLocalizedStringForKey:function(b){if(b&&b.loc()!==b){return YES}return NO}});SC.mixin(CK,{OFFLINE_TYPE_SESSION_STORAGE:"SessionStorage",OFFLINE_TYPE_LOCAL_STORAGE:"LocalStorage",OFFLINE_TYPE_SQL_DATABASE:"SQLDatabase",OFFLINE_REASON_NETWORKING_ERROR:"NetworkingError",OFFLINE_REASON_TIMEOUT:"Timeout",OFFLINE_REASON_SERVER_ERROR:"ServerError",OFFLINE_REASON_STARTUP_WAIT:"StartupWait"});CK.offlineController=SC.Object.create({isOfflineEnabled:NO,offlineType:null,isOffline:function(){var e=NO,d;if(this.get("isOfflineEnabled")&&this.get("offlineType")){d=this.get("offlineReasons");if(d&&d.get("length")>0){e=YES}}return e}.property("isOfflineEnabled","offlineType","offlineReasons").cacheable(),offlineReason:function(){var d="",e;if(this.get("isOfflineEnabled")&&this.get("offlineType")){e=this.get("offlineReasons");if(e&&e.get("length")>0){if(e.contains(CK.OFFLINE_REASON_NETWORKING_ERROR)){d="NetworkingError"}else{if(e.contains(CK.OFFLINE_REASON_TIMEOUT)){d="Timeout"}else{if(e.contains(CK.OFFLINE_REASON_SERVER_ERROR)){d="ServerError"}else{d=e.get("firstObject")}}}d=(("Dock."+d).loc()!==("Dock."+d))?d:""}}return d}.property("offlineReasons").cacheable(),offlineReasons:null,addOfflineReason:function(e){var d=this.get("offlineReasons");if(!d){d=SC.Set.create([e]);this.set("offlineReasons",d);d.addObserver("[]",this,this.offlineReasonsContentDidChange)}else{d.add(e)}},removeOfflineReason:function(e){var d=this.get("offlineReasons");if(d&&d.contains(e)){d.remove(e)}},hasOfflineReasonOtherThan:function(e){if(!this.get("isOffline")){return NO}var d=this.get("offlineReasons");if(d.contains(e)){return !(d.get("length")===1)}else{return(d.get("length")>=1)}},offlineReasonsContentDidChange:function(){this.notifyPropertyChange("isOffline");this.notifyPropertyChange("offlineReason")},deviceStateDidChange:function(){var e=SC.device.get("isOffline"),d=CK.OFFLINE_REASON_NETWORKING_ERROR;if(e){this.addOfflineReason(d)}else{this.removeOfflineReason(d)}}.observes("SC.device.isOffline"),init:function(){this.deviceStateDidChange()},toString:function(){var b=arguments.callee.base.apply(this,arguments);if(b){b="Offline controller ("+b+")"}return b}});CK.RequestDelegate={isCKRequestDelegate:YES,getUrlForServiceName:function(b){return null},didReceiveSpecialResponse:function(d,f,e){}};sc_require("mixins/request_delegate");CK.servicesController=SC.Object.create({getServiceInfoFor:function(e){if(!e){SC.warn("getServiceInfoFor():  A service name must be specified")}var d=this._servicesInfo;return d?d[e]:null},getServiceUrlFor:function(k,j){var h=this.getServiceInfoFor(k),f=null,g;if(h){f=h.get("url")||null;if(!f){g="getServiceUrlFor():  Could not find the URL for %@".fmt(k)}}else{g="getServiceUrlFor():  Could not find service information for %@".fmt(k)}if(g){if(j){CW.fatalError(g)}else{SC.error(g)}}return f},getServiceStatusFor:function(k,j){var h=this.getServiceInfoFor(k),f=null,g;if(h){f=h.get("status")||null;if(!f){g="getServiceStatusFor():  Could not find the status for %@".fmt(k)}}else{g="getServiceStatusFor():  Could not find service information for %@".fmt(k)}if(g){if(j){CW.fatalError(g)}else{SC.error(g)}}return f},servicesInfoHasBeenReceived:function(){return(this._servicesInfo!==null)}.property("_servicesInfo"),_setupFromBag:function(k){if(!k){CW.fatalError("_parseInformationFromBag():  The bag must be supplied")}var g=k.webservices,j,f,h;if(g){j={};for(f in g){h=SC.clone(g[f],YES);h.name=f;j[f]=CK.ServiceInfo.create(h)}this.set("_servicesInfo",j)}else{SC.error("CK.servicesController:  The bag does not contain any services information")}},_servicesInfo:null});CK.mixin({persistAfterLogoutSuffix:".persist",getValueFromSessionStorage:function(b){return this._getValueFromStorage(window.sessionStorage,b)},setValueInSessionStorage:function(e,d){return this._setValueInStorage(window.sessionStorage,e,d)},getKeysInSessionStorage:function(){return this._getKeysInStorage(window.sessionStorage)},clearSessionStorage:function(){return this._clearStorage(window.sessionStorage)},getValueFromLocalStorage:function(d,e){return this._getValueFromStorage(window.localStorage,d,e)},setValueInLocalStorage:function(d,f,e){return this._setValueInStorage(window.localStorage,d,f,e)},getKeysInLocalStorage:function(){return this._getKeysInStorage(window.localStorage)},clearLocalStorage:function(){return this._clearStorage(window.localStorage,YES)},_getValueFromStorage:function(j,m,h){var g=null,l,k;if(j&&j.getItem){k=CK.currentApplication;l=k?k.get("name"):"SteedOS";if(l){m=l+"."+m}if(h){m+=this.get("persistAfterLogoutSuffix")}g=j.getItem(m)}return g},_setValueInStorage:function(l,q,o,k){var e=NO,p,m;if(l&&l.setItem){m=CK.currentApplication;p=m?m.get("name"):"SteedOS";if(p){q=p+"."+q}if(k){q+=this.get("persistAfterLogoutSuffix")}try{l.setItem(q,o);e=YES}catch(n){}}return e},_getKeysInStorage:function(j){var h=[],k,m,l,g;if(j){k=CK.currentApplication;m=k?k.get("name"):"SteedOS";if(m){m+="."}l=m?m.length:0;for(g in j){if(g.indexOf(m)===0){h.push(g.substring(l))}}}return h},_clearStorage:function(z,t){var w=YES,C,e,B,D,y,q,A;if(t){try{C={};e=this.get("persistAfterLogoutSuffix");B=e.length;for(D=0,y=z.length;D<y;++D){try{q=z.key(D);A=q.indexOf(e);if(A!==-1){if(A===(q.length-B)){C[q]=z.getItem(q)}}}catch(x){}if(z.length!==y){C={};D=-1;y=z.length}}}catch(s){}}if(z){if(!z.clear){w=NO}else{try{z.clear()}catch(u){w=NO}}}if(t){try{for(q in C){z.setItem(q,C[q])}}catch(v){}}return w}});CK.AccountPreferences=SC.Object.extend({hasInitialized:NO,timeZone:"Asia/Shanghai",timezoneName:"City.Beijing - China",locale:String.preferredLanguage,viewPushNotifications:{}});CK.ServiceInfo=SC.Object.extend({name:undefined,url:undefined,isEnabled:undefined});CK.User=SC.Object.extend({statusCode:null,firstName:null,lastName:null,primaryEmail:null,primaryEmailIsVerified:function(){return this.get("primaryEmailVerified")}.property(),displayName:function(){var d=this.get("firstName"),e=this.get("lastName"),f=this.get("steedosId");return CK.displayNameFor(d,e,f)}.property("firstName","lastName","steedosId"),userIsBetaQualified:function(){return YES},userIsDeveloperQualified:function(){return this._auth_bag.dsInfo.isDeveloper},steedosId:null,steedosIdAlias:null,SteedOSIdAlias2:null,displaySteedOSId:function(){var k=this.get("steedosId"),j=this.get("steedosIdAlias"),h=this.get("steedosIdAlias2");if(!j&&!h){return k}var o=[k,j,h],n=["@steedos.com"],l,m;for(m=0;m<n.length;m++){for(l=0;l<o.length;l++){if(o[l].search(n[m])!==-1){return o[l]}}}return k}.property("steedosId","steedosIdAlias","SteedOSIdAlias2"),dsid:null,preferences:function(){SC.warn("This is a deprecated method. Make sure to use SteedOS.getAccountPreferences() instead if you are inside an app, or authController if within SteedOS.");if(CK.currentApplication){return SteedOS.getAccountPreferences(CK.currentApplication)}else{return SteedOS.authController.get("accountPreferences")}}.property(),_auth_bag:null,destroy:function(){var b=this._preferences_cache;if(b){b.destroy()}this._preferences_cache=null;return arguments.callee.base.apply(this,arguments)}});CK.User.mixin({PAID_LAPSED:-3,PAID_NOT_CREATED_YET:-2,FREE_NOT_CREATED_YET:-1,INACTIVE:0,PAID_ACTIVE:1,FREE_QUALIFIED:2,FREE_NOT_QUALIFIED:3});CK.errorCatcher=SC.Object.create({enabledInDevMode:NO,bubbleErrorsToSteedOS:YES,exceptionCallback:null,namespacesToSymbolicate:null,isReporting:NO,init:function(){arguments.callee.base.apply(this,arguments);if(this.get("enabledInDevMode")||(SC.buildMode==="production")){this.set("enabled",YES);SC.ExceptionHandler=this}else{SC.ExceptionHandler=null}},reportBadRequest:function(b){if(!b){b={}}b.origin="client";b.type="bad request";return this._handleError(b)},reportServerError:function(b){if(!b){b={}}b.origin="server";b.type="error";return this._handleError(b)},handleException:function(d){try{d.recordedStack=d.recordedStack||CW.recordStack(YES,YES)}catch(e){}return this._handleError({exception:d,isFatal:YES,origin:"client",type:"exception"})},_handleError:function(s){if(!s){SC.error("Warning: No parameters were specified in _handleError");return YES}if(this.get("isReporting")){return YES}SC.debug("CloudKit: ErrorCatcher dialog invoked.");var v=CK.currentApplication,e=v?v.get("name"):"steedos",m,o;if(!s.applicationName){s.applicationName=e}if(!s.appStatechart){var q=v?v.get("statechartPath"):SteedOS.get("statechartPath"),n;if(q&&(n=SC.getPath(q))&&n.toStringWithDetails){s.appStatechart=n.toStringWithDetails()}}m=s.exception;if(m){o=this._hashForException(m);s=SC.mixin(o,s)}if(s.isFatal&&v&&this.get("bubbleErrorsToSteedOS")===YES&&SteedOS&&!SteedOS.isSimulator&&!SteedOS.isSteedOSLite){var p=SC.Logger.stringifyRecordedLogMessages(),u=this.get("exceptionCallback");s.applicationBuildNumber=SC.buildNumber;if(u){try{u.call(this,s)}catch(t){}}SteedOS.handleApplicationCrash(s,p);return NO}else{if(s.exception){SC.RunLoop.kill()}else{SC.RunLoop.end()}s.exception=null;SC.Module.loadModule("cloudkit/error_catcher","CK.errorCatcher","moduleDidLoad",s);this.set("isReporting",YES)}return YES},_hashForException:function(w){var j={},G=null,I,D,x,v,H,K,F,y,J,z,e,C,E;if(w){G=w.message?w.message:w.toString()}j.error=G;j.file=w.fileName||w.sourceURL||"Unknown";j.line=w.lineNumber||w.line||"Unknown";var A=CW.invertArray(["message","fileName","sourceURL","lineNumber","line","stack","recordedStack"]);var B=function(){if(typeof w==="string"){return w}var a="";for(e in w){if(A[e]){continue}C=w[e];if(C===undefined){E="(undefined)"}else{if(C===null){E="(null)"}else{E=e+":  "+C.toString()}}a+="   "+E+"\n"}return a}();if(B.trim().length>0){j.exceptionInfo=B}I=w.stack;if(I){j.stack=I.toString()}I=w.recordedStack;if(I){D="";for(x=0,v=I.length;x<v;++x){H=I[x];if(typeof(H)==="string"){D+=H+"\n";break}else{D+=H.func+"\n";K=H.args;if(K){D+="  >  args:  ";for(y=0,F=K.length;y<F;++y){J=K[y];z=this._prettyValue(J);if(y>0){D+=",  "}D+=z}D+="\n"}}}j.mostRecentStack=D}return j},_prettyValue:function(e){var d;if(e===undefined){d="undefined"}else{if(e===null){d="null"}else{if(e instanceof Function){d=e.displayName;if(!d){d=e.name}}if(!d){d=e.toString()}}}return d}});CK.keyResponder=SC.Object.create({performKeyEquivalent:function(b){if(!window.SteedOS||SteedOS.isSteedOSClient){return NO}return SteedOS.relayKeyboardShortcut(b)}});SC.ready(function(){CW.installKeyResponder();CW.keyResponders.unshift(CK.keyResponder)});SC.RootResponder.reopen({mousemove:function(d,e){if(window.SteedOS){SteedOS.relayMouseMove(e.clientX,e.clientY)}return d(e)}.enhance()});CK.Request=CW.Request.extend(SC.DelegateSupport,{serviceName:null,useCrossDomain:YES,withCredentials:YES,attachIdentifyingHeaders:NO,contentType:undefined,delegate:null,requestDelegate:function(){var b=this.get("delegate")||window.SteedOS;if(!b){CW.fatalError("A CK.Request must have a delegate",{target:this})}return b}.property("delegate").cacheable(),addressPrefix:function(){var h=null,f,e,g;if(this.get("useCrossDomain")){f=this.get("requestDelegate");e=this.get("address")||"";g=this._getServiceName();if(e.toLowerCase().indexOf("http")<0){h=f.getUrlForServiceName(g,NO);if(h){if(h[h.length-1]==="/"){if(e[0]==="/"){h=h.slice(0,-1)}}else{if(e[0]!=="/"){h+="/"}}}}}return h}.property("useCrossDomain"),COPY_KEYS:CW.Request.prototype.COPY_KEYS.concat(["serviceName","delegate"]),init:function(){var l,q,n,m,o,k;arguments.callee.base.apply(this,arguments);if(!this.get("source")){if(this.get("useCrossDomain")){l=this.get("contentType");if(l===undefined){l="text/plain";this.set("contentType",l)}}if(!l){l=this.get("contentType")}if(l){this.header("Content-Type",l)}q=this._specialResponseStatuses;if(q){k=this._specialResponseWasReceived;for(n=0,m=q.length;n<m;++n){o=q[n];this.notify(o,this,k)}}var s=window.SteedOS&&!SteedOS.isSteedOSClient;var p=s?SteedOS.getUser():COS.authController.get("user"),t=p?p.get("dsid"):null;if(t){this.queryParameter("dsid",t)}this._attachId();this.queryParameter("clientId",s&&SteedOS.getClientId?SteedOS.getClientId():COS.CLIENT_ID);this.queryParameter("clientBuildNumber",SC.buildNumber)}},_attachId:function(){var e=window.SteedOS&&!SteedOS.isSteedOSClient?SteedOS.getUser():COS.authController.get("user");if(!e){return}var d=window.SteedOS&&!SteedOS.isSteedOSClient?SteedOS.getId():COS.authController.generateId(e.get("steedosId"));if(d){this.queryParameter("id",d)}},_specialResponseStatuses:[330,401,403,406,503],_specialResponseWasReceived:function(J){SC.debug("Received special response:  %@",J);var D=this.get("requestDelegate"),x=J.get("status"),G=J.get("request"),C=G._getServiceName(),v=G.get("overallTimeout"),z=J.get("addedToOutgoingQueueTimestamp"),E=YES,H=NO,u=NO,B=J.get("body"),e,A,K,I,F;if(SC.typeOf(B)===SC.T_STRING){try{var y=SC.json.decode(B);B=y}catch(w){}}if(x===330){if(C&&C!=="keyvalue"){SC.Request.manager.suspendService(C)}else{SC.error("We received a response with status 330 but the request (%@) was not annotated with a service name",G)}H=YES}else{if(x===403){F=NO;for(e in B){if(e.match(/^auth[ _\-]?mismatch$/i)){F=YES;break}}if(!F){E=NO}}else{if(x===406){E=YES;H=YES}else{if(x===503){if(B){for(e in B){if(e.match(/^retry[ _\-]?after$/i)){A=B[e];break}}}if(A){A=parseInt(A,10)}if(A){A*=1000;if(v&&z){K=new Date()-z;SC.debug("The server is telling us to retry after %@ms, it has been %@ms, and our overall timeout is %@ms",A,K,v);if((K+A+5000)<v){SC.debug("  -  it looks like we can make it so automatically retrying request %@",G);H=YES;E=NO}else{SC.debug("  -  it doesnt look like we can make it so not automatically retrying request %@",G);H=NO;E=YES;I={retryAfter:(A/1000)}}}}}}}}if(H){if(v&&z){K=new Date()-z;if(K<v){G=G.copy()._prep();G.set("overallTimeout",v-K)}}G.resend(J);u=YES}if(E){D.didReceiveSpecialResponse(x,J.get("encodedBody"),I)}return u},resend:function(){this._attachId();return arguments.callee.base.apply(this,arguments)},_getServiceName:function(){var e=this.get("serviceName"),d;if(!e){d=CK.currentApplication;e=d?d.get("primaryServiceName")||d.get("name"):null}return e}});SC.Request.manager.mixin({serviceIsSuspended:function(e){if(!e){CW.fatalError("serviceIsSuspended():  A service name must be specified",{target:this})}var d=this._suspendedServices;return(d&&d[e])},suspendService:function(e){if(!e){CW.fatalError("suspendService():  A service name must be specified",{target:this})}var d=this._suspendedServices;if(!d){d=this._suspendedServices={}}if(!d[e]){SC.debug("Suspending requests to %@ service",e)}d[e]=YES},resumeService:function(e){if(!e){CW.fatalError("resumeService():  A service name must be specified",{target:this})}var d=this._suspendedServices;if(d){if(d[e]){SC.debug("Resuming requests to %@ service",e)}delete d[e]}SC.Request.manager.fireRequestIfNeeded()},resumeAllServices:function(){var d=this._suspendedServices,e;if(d){for(e in d){if(d[e]){this.resumeService(e)}}}SC.Request.manager.fireRequestIfNeeded()},_suspendedServices:null});SC.Request.manager.mixin({shouldFireRequest:function(e){if(!e){CW.fatalError("shouldFireRequest():  A response must be specified",{target:this})}var f=e.get("request"),d=f._getServiceName?f._getServiceName():null;if(!d){return YES}else{return !SC.Request.manager.serviceIsSuspended(d)}}});CK.SteedOSGetterSupport={getUser:function(){var g=this.get("appInstance");var h=g._cloudOSState.authBag;if(!g._cos_user_cache&&h){SC.debug("Creating local CK.User object");var e=g._cloudOSState.authBag.dsInfo,f;g._cos_user_cache=f=CK.User.create(e);f._auth_bag=h}else{if(!h){SC.warn("Cannot getUser() before auth bag has been fetched.")}}return g._cos_user_cache},getAccountPreferences:function(g){var d=this.get("appInstance");if(!d._cos_account_preferences_cache){SC.debug("Creating local CK.AccountPreferences object");var f=d._cloudOSState.accountPreferences;d._cos_account_preferences_cache=CK.AccountPreferences.create(f)}return d._cos_account_preferences_cache},getUrlForServiceName:function(e,d){var f=this.get("appInstance");e=SC.typeOf(e)===SC.T_STRING?e:f.get("name");return CK.servicesController.getServiceUrlFor(e,!!d)},getStatusForServiceName:function(e,d){var f=this.get("appInstance");e=SC.typeOf(e)===SC.T_STRING?e:f.get("name");return CK.servicesController.getServiceStatusFor(e,!!d)},getAppLoadReason:function(){return this.get("loadReason")},getCurrentlyActiveApplication:function(){var b=this.get("appInstance");return b._cloudOSState.currentlyActiveApplication},getRoute:function(){var b=this.get("appInstance");return b._cloudOSState.route},getAppPreferences:function(f){if(SteedOS.isSteedOSLite){if(window.COS&&COS.prefsController){var b=SC.clone(COS.prefsController.allAppPreferencesHash());return f?b[f]:b}}if(CK.currentApplication){var g=this.get("appInstance"),d=g.get("name"),a;f=f?f:d,a=SC.clone(g._cloudOSState.appPreferences[f],YES);if(!a){SC.warn("Cannot getAppPreferences() before authenticating.");return}return a}},getRequestedStartupUrl:function(){var b=this.get("appInstance");return b._cloudOSState.requestedStartupUrl},getEnvironment:function(){var b=this.get("appInstance");return b._cloudOSState.environment},getActiveXFileVersion:function(){var b=this.get("appInstance");return b._cloudOSState.activeXFileVersion},getId:function(){var b=this.get("appInstance");return b._cloudOSState.id},getClientId:function(){var b=this.get("appInstance");return b._cloudOSState.clientId},sessionIsExtendedLogin:function(){var b=this.get("appInstance");return b._cloudOSState.authBag.isExtendedLogin},getHostname:function(){var b=this.get("appInstance");return b._cloudOSState.hostname},getValidateToken:function(){return CK.readCookie("X-STEEDOS-WEBAUTH-VALIDATE")},mailTo:function(n,s,v,y,u){var t=this.get("appInstance"),z="",o,p;var w={to:n?n:"",subject:s?s:"",body:v?v:"",cc:y?y:"",bcc:u?u:""};for(o in w){p=w[o];if(!p){continue}if(z){z+="&"}z+=o+"="+encodeURIComponent(w[o])}var x=!(CK.isBeta||CK.isDeveloper);if(x&&CK.servicesController.getServiceInfoFor("mail")){var q=CW.UUID();window.open("https://%@/mail/message/%@/?windowInstanceId=%@#compose?%@".fmt(window.location.hostname,String.preferredLanguage,q,z),"","width=810,height=677,status=no,toolbar=no");t.registerWindowApplicationMessage("populateFields",w,q)}else{SteedOS.redirectTo("mailto:%@?%@".fmt(n,z))}},showHelp:function(f,e){var d=this.get("appInstance");CK.openHelp((d&&d.get("name")),f,e)},windowApplicationHasInitialized:function(l,g,m){var k=this.get("appInstance"),h=k.get("name"),j=CK.currentApplication;CK.currentApplication.windowApplication[m]=g;j.set("windowApplicationHost",l);j.passWindowApplicationMessage("_applicationShouldInvokeMain",m,SteedOS._cloudOSAPIMethodNames,k._cloudOSState);j.passPendingWindowApplicationMessages(m)},windowApplicationWillClose:function(b){CK.currentApplication.windowApplication[b]=null}};CK.StyleSheet={styles:null,styleSheet:null,setStyleString:function(h){if(h){var e=h.join("");this.styles=h;if(this.styleSheet.styleSheet){this.styleSheet.styleSheet.cssText=e}else{var f=this.styleSheet.childNodes[0];var g=document.createTextNode(e);if(!f){this.styleSheet.appendChild(g)}else{this.styleSheet.replaceChild(g,f)}}}return this.styles}};SC.mixin(CK.StyleSheet,{create:function(h){var g=SC.beget(CK.StyleSheet);var f=document.getElementsByTagName("head")[0];var e=document.createElement("style");e.type="text/css";f.appendChild(e);g.styleSheet=e;g.setStyleString((h)?h:[]);return g}});CK.ActiveXView=SC.View.extend({classNames:["activex"],fileTypes:"",maxImageSize:1000,maxFileSizeBytes:500000,classId:"82E5DF24-51E8-47CD-864A-F4BD5005AA73",imageTypes:"jpg;bmp;png;gif",fileVersion:function(){return CK.currentApplication?SteedOS.getActiveXFileVersion():SteedOS.ACTIVE_X_FILE_VERSION}.property(),delegate:null,isInitialized:NO,isVisible:NO,init:function(){arguments.callee.base.apply(this,arguments);if(!CK.ActiveXView.needsActiveX()){return}this.set("isVisible",YES),SC.RootResponder.responder.listenFor("mouseenter mouseleave".w(),SC.$("body")[0],this),CK.ActiveXView.currentView=this,this.onStart(),CK.ActiveXView.removeEventsOnDropTargets()},destroy:function(){this._timer&&this._timer.invalidate(),this._timer=null,arguments.callee.base.apply(this,arguments)},render:function(b,a){if(a&&CK.ActiveXView.needsActiveX()){var d;SC.buildMode==="debug"?d="/applications/designer/5410/cloudkit/runtime/5410/en-us/resources/iCloud.cab":d="/system/iCloud.cab",b.push('<object id="YachtV2" classid="CLSID:%@" codebase="%@#version=%@" width="100%" height="100%" style="position:absolute;top:0px;left:0px;"></object>'.fmt(this.get("classId"),d,this.get("fileVersion")))}},isVisibleDidChange:function(){if(!CK.ActiveXView.needsActiveX()||!this.get("isInitialized")){return}this.get("isVisible")?CK.ActiveXView.removeEventsOnDropTargets():CK.ActiveXView.reinstateEventsOnDropTargets()}.observes("isVisible"),mouseMoved:function(a){return this.set("isVisible",NO),NO},mouseleave:function(b){if(!this.get("isInitialized")){return}var a=this;SC.run(function(){a.set("isVisible",YES)})},mouseenter:function(b){var a=this;SC.run(function(){a._isDragging||a.set("isVisible",NO)})},onStart:function(){if(this._didStart){return}var b;try{b=window.YachtV2.getVersion}catch(a){SC.warn("ActiveX: onStart called but YachtV2 is undefined")}if(!b){this._timer||(this._timer=SC.Timer.schedule({target:this,action:"onStart",interval:1000,repeats:YES,until:Date.now()+1200000}));return}YachtV2.fileTypes=this.get("fileTypes"),YachtV2.imageTypes=this.get("imageTypes"),YachtV2.maxImageSize=this.get("maxImageSize"),YachtV2.maxFileSizeBytes=this.get("maxFileSizeBytes"),YachtV2.attachEvent("onDragEnter",function(j,g,k,h,f){SC.run(function(){CK.ActiveXView.currentView.onDragEnter(j,g,k,h,f)})}),YachtV2.attachEvent("onDragOver",function(j,g,k,h,f){SC.run(function(){CK.ActiveXView.currentView.onDragOver(j,g,k,h,f)})}),YachtV2.attachEvent("onDragLeave",function(){SC.run(function(){CK.ActiveXView.currentView.onDragLeave()})}),YachtV2.attachEvent("onInvalidFileDropped",function(h,f,j,g){SC.run(function(){CK.ActiveXView.currentView.onInvalidFileDropped(h,f,j,g)})}),YachtV2.attachEvent("onFileDropped",function(k,g,l,j,f,h){SC.run(function(){CK.ActiveXView.currentView.onFileDropped(k,g,l,j,f,h)})}),YachtV2.attachEvent("onEnd",function(){SC.run(function(){CK.ActiveXView.currentView.onEnd()})}),this.set("isInitialized",YES);var d=this.get("delegate");d&&d.tryToPerform("onStart",this),SC.debug("ActiveX: Component properly initialized, version %@.",b),this.set("isVisible",YES),this._timer&&(this._timer.invalidate(),this._timer=null),this._didStart=YES},onEnd:function(){this.set("isInitialized",NO);var a=this.get("delegate");a&&a.tryToPerform("onEnd",this)},onFileDropped:function(h,d,k,g,b,f){var j=this.get("delegate"),a;j&&(a={fileName:h,fileType:d,fileData:k,x:g,y:b,fileSize:f},j.tryToPerform("onFileDropped",this,a)),this.set("isVisible",NO),CK.ActiveXView._dragEndedOnDropTargets()},onInvalidFileDropped:function(g,b,h,f){var a=this.get("delegate"),d;a&&(d={fileName:g,errorCode:f,x:b,y:h},a.tryToPerform("onInvalidFileDropped",this,d)),this.set("isVisible",NO),CK.ActiveXView._dragEndedOnDropTargets()},onDragEnter:function(h,d,k,g,b){var f=this.get("delegate"),j;f&&(j={fileName:h,fileType:d,x:k,y:g,fileSize:b},f.tryToPerform("onDragEnter",this,j)),this._isDragging=YES;var a={pageX:k,pageY:g};CK.ActiveXView._getDragOperation(a,this)},onDragOver:function(g,b,j,f,a){var d=this.get("delegate"),h;d&&(h={fileName:g,fileType:b,x:j,y:f,fileSize:a},d.tryToPerform("onDragOver",this,h)),this.set("currentDragX",j),this.set("currentDragY",f)},onDragLeave:function(){var a=this.get("delegate");a&&a.tryToPerform("onDragLeave",this),this._isDragging=NO,CK.ActiveXView._dragEndedOnDropTargets()}}),CK.ActiveXView.mixin({currentView:null,needsActiveX:function(){return SC.browser.isIE9OrLower},_dragOperation:null,_getDragOperation:function(d,a){var f=CK.ActiveXView._dragOperation;if(f){return f}var b=SC.Drag.start({event:d,source:a,ghost:NO,slideBack:NO,sourceIsDraggable:NO});return CK.ActiveXView._dragOperation=b,b},_dragEndedOnDropTargets:function(){var f=CK.ActiveXView._dragOperation;if(!f){return}var b=f._dropTargets(),g,d,a;for(g=0,d=b.length;g<d;g++){a=b[g],a.tryToPerform("dragEnded",this,f.event),a&&a.get("acceptsFileDrags")&&(a._isCurrentlyHovered=NO)}CK.ActiveXView._dragOperation=null},_dropTargetEvents:"dragenter dragover dragleave drop".w(),removeEventsOnDropTargets:function(){CK.ActiveXView._eventOnDropTarget(SC.Event.remove)},reinstateEventsOnDropTargets:function(){CK.ActiveXView._eventOnDropTarget(SC.Event.add)},_eventOnDropTarget:function(h){var l=SC.Drag._dropTargets,f=CK.ActiveXView._dropTargetEvents,b,g,m,d,k,j;for(m in l){d=l[m];for(b=0,g=f.length;b<g;b++){k=f[b],j=d[k],j&&h(document,k,d,d[k])}}}});CK.AddDeleteButton=SC.ButtonView.extend({layout:{left:0,height:30,centerY:0,width:28},acceptsFirstResponder:NO,displayProperties:["buttonType"],buttonType:"delete",themeName:"addDelete",render:function(b){arguments.callee.base.apply(this,arguments);b.setClass("delete-icon",this.get("buttonType")==="delete");b.setClass("add-row",this.get("buttonType")==="add")},action:"buttonClicked",titleMinWidth:20,isEmpty:YES});CK.AddDeleteButton.Theme=SC.BaseTheme.create({name:"addDelete"});SC.Theme.addTheme(CK.AddDeleteButton.Theme);CK.Application=SC.Application.extend(SC.DelegateSupport,{isCloudKitApplication:YES,name:null,primaryServiceName:null,statechartPath:null,postMessageTargetOrigin:function(){var a="*";return a}.property(),steedOSWindow:function(){return window.parent}.property(),capitalizedName:function(){var a=this.get("name");return a&&(a.charAt(0)!=="i"?a=a.capitalize():a="i"+a.substring(1).capitalize()),a}.property("name").cacheable(),isReadyToTerminate:YES,isReadyToTerminateDidChange:function(){SteedOS.isReadyToTerminateDidChange(this.get("isReadyToTerminate"))}.observes("isReadyToTerminate"),delegate:null,init:function(){arguments.callee.base.apply(this,arguments),SC.Logger.set("outputMessagePrefix",this.get("capitalizedName")+":  "),CK.currentApplication=this;SC.suppressMain=YES;SC.Event.add(window,"message",this,"_messageWasReceived",null,!0)},setupBeforeUnloadHandler:function(){SC.Event.add(window,"beforeunload",this,function(){SteedOS.appWillUnload()})},_messageWasReceived:function(h){var l=h.originalEvent.data,f;try{f=SC.typeOf(l)!==SC.T_STRING?l:SC.json.decode(l)}catch(b){SC.warn(b);return}if(h.isProxyMessage){this.passMessage(f);return}if(!f.isSteedOSMessage){return}var g=URI(h.origin);if(g.protocol()!=="https"||g.domain()!=="steedos.com"){}var m=f.args||[],d=[this.get("delegate"),f.methodName],k,j;for(k=0,j=m.length;k<j;k++){d.push(m[k])}this.invokeDelegateMethod.apply(this,d)},applicationWillBecomeActive:function(){SC.debug("APPLICATION: Received applicationWillBecomeActive")},applicationDidBecomeActive:function(a){SC.debug("APPLICATION: Received applicationDidBecomeActive")},applicationWillSuspend:function(){SC.debug("APPLICATION: Received applicationWillSuspend")},applicationDidSuspend:function(){SC.debug("APPLICATION: Received applicationDidSuspend")},secondaryAuthDidSucceed:function(){SC.debug("APPLICATION: Received secondaryAuthDidSucceed")},secondaryAuthDidFail:function(){SC.debug("APPLICATION: Received secondaryAuthDidFail")},didFetchStartup:function(b,a,d){SC.debug("APPLICATION: Received didFetchStartup")},didReceiveNotification:function(a){SC.debug("APPLICATION: Received didReceiveNotification")},didLaunchWithNotification:function(a){SC.debug("APPLICATION: Received didLaunchWithNotification")},applicationShouldRefresh:function(a){SC.debug("APPLICATION: Received applicationShouldRefresh")},accountPreferencesDidChange:function(){SC.debug("APPLICATION: Received accountPreferencesDidChange")},userDidRevalidate:function(){SC.Request.manager.resumeAllServices()},routeDidChange:function(a){SC.debug("APPLICATION: Received routeDidChange")},_applicationShouldInvokeMain:function(h,l,f,b){!h&&!CK.currentApplication?CW.fatalError("No methodNames, we cannot continue."):h||(h=[]);var g=this,m,d,k;this._cloudOSState=l,CK.servicesController._setupFromBag(l.authBag);var j=window.SteedOS||SC.Object.create({isSteedOSProxy:YES});j.mixin(CK.SteedOSGetterSupport),j.set("appInstance",this),j.set("loadReason",f),j.isBeta=l.isBeta,j.isDeveloper=l.isDeveloper,j._SteedOSAPIMethodNames=h,window.SteedOS||(window.SteedOS=j);for(m=0,d=h.length;m<d;m++){k=h[m];if(window.SteedOS[k]!==undefined){continue}window.SteedOS[k]=function(){var a=k;return function(){var e=SC.$A(arguments);return g.invokeMethodOnSteedOS(a,e)}}()}this.setupBeforeUnloadHandler(),window.main(f,b)},invokeMethodOnSteedOS:function(f,b){var g={isSteedOSMessage:!0,methodName:f,appName:this.get("name"),args:b},d;try{d=JSON.stringify(g)}catch(a){SC.warn("There was a problem stringifying the message when sending message %@, %@",f,a);if(f!=="handleApplicationCrash"){return undefined}g.args=null,d=JSON.stringify(g)}return this.passMessage(d)},passMessage:function(a){window.parent.postMessage(a,"*")},_cloudOSStateChange:function(h){var d=h.authBag,k=h.accountPreferences,g=h.appPreferences,b=h.route;d&&(CK.servicesController._setupFromBag(d),this._cos_user_cache&&this._cos_user_cache.mixin(d.dsInfo)),k&&this._cos_account_preferences_cache&&this._cos_account_preferences_cache.mixin(k);if(g){var f=this._cloudOSState.appPreferences,j=f?f:{},a;for(a in g){j[a]=g[a]}this._cloudOSState.appPreferences=j}b!==undefined&&(this._cloudOSState.route=b)},_sleepCount:0,_sleep:function(){var a=this._sleepCount++;a===0&&(CW.Request.suspendResponses(),SC.backgroundTaskQueue.suspend(),SC.Module.suspend())},_wake:function(){var a=--this._sleepCount;a<0?(SC.warn("CK.Application._wake() was called without a paired _sleep() invocation; ignoring"),this._sleepCount=0):a===0&&(SC.Module.resume(),SC.backgroundTaskQueue.resume(),CW.Request.resumeResponses())},_hasReceivedFocus:function(){var b=window.$('[role="button"]');try{var a=b[0];a&&(a.setAttribute("tabindex","0"),a.blur(),a.focus())}catch(d){SC.info("_hasReceivedFocus(): Could not find a button on the page to focus: %@",d)}},_mouseMove:function(a){a.allowDefault=function(){},a.stopPropagation=function(){},SC.RootResponder.responder.mousemove(SC.Event.create(a))},_mouseUp:function(a){a.allowDefault=function(){},a.stopPropagation=function(){},SC.RootResponder.responder.mouseup(SC.Event.create(a))},windowApplication:{},windowApplicationMessages:{},passWindowApplicationMessage:function(h,d){var k=this.get("windowApplicationHost");if(!k){SC.warn("Cannot post a message to a CK.WindowApplication without a reference");return}var g=this.windowApplication[d],b=SC.$A(arguments);b=b.slice(2,b.length);var f=this.get("name"),j={isSteedOSMessage:!0,methodName:h,args:b,isWindowApplicationMessage:!0};try{g.CK.currentApplication._windowMessageWasReceived(SC.clone(j))}catch(a){SC.warn('postMessage: Window not properly loaded from "%@" for "%@"?',g?g.href:null,f),SC.warn(a)}},passPendingWindowApplicationMessages:function(f){var b=this.get("windowApplicationMessages")[f],g,d,a;if(!b){return}while(a=b.shift()){this.passWindowApplicationMessage(a.method,f,a.args)}},registerWindowApplicationMessage:function(f,b,g){var d=this.get("windowApplicationMessages"),a=d[g];a||(a=[],d[g]=a),a.push({method:f,args:b})}});CK.WindowApplication=CK.Application.extend({isWindowApplication:YES,windowInstanceId:CW.getUrlParameters().windowInstanceId||CW.UUID(),init:function(){arguments.callee.base.apply(this,arguments);var b=this;SC.ready(function(){var a=window.location.protocol+"//"+window.location.host;b.get("steedOSWindow").SteedOS.windowApplicationHasInitialized(a,window,b.get("windowInstanceId"))})},setupBeforeUnloadHandler:function(){var b=this;SC.Event.add(window,"beforeunload",this,function(){try{var d=b.get("windowInstanceId");b.get("steedOSWindow").SteedOS.windowApplicationWillClose(d);SteedOS.appWillUnload(YES,d)}catch(a){SC.warn("beforeunload handler could not call parent, maybe it is gone?");SC.warn(a)}})},steedOSWindow:function(){return window.opener}.property(),passMessage:function(h){var f=this.get("steedOSWindow"),g=SC.json.decode(h),e=g.methodName;this.invokeLast(function(){try{f.CK.currentApplication.passMessage(h)}catch(a){SC.warn("DOMWindow for SteedOS is gone? Cant deliver %@",e);SC.warn(a)}})},_windowMessageWasReceived:function(d){SC.RunLoop.end();var e={originalEvent:{data:d},origin:function(){var a=window.location.protocol+"//"+window.location.host;return a}};SC.run(function(){this._messageWasReceived(e)},this)},populateFields:function(b){},applicationWillBecomeActive:function(){},applicationDidBecomeActive:function(b){},applicationWillSuspend:function(){},applicationDidSuspend:function(){}});CK.Statechart={EVT_ENTER_SIG:"enter",EVT_EXIT_SIG:"exit",EVT_INIT_SIG:"defaultTransition"};SC.mixin(CK.Statechart,{EVT_ENTER:{sig:CK.Statechart.EVT_ENTER_SIG},EVT_EXIT:{sig:CK.Statechart.EVT_EXIT_SIG},EVT_INIT:{sig:CK.Statechart.EVT_INIT_SIG},EVT_IGNORED_RES:"cloudkit-statechart-evt-ignored-res",EVT_HANDLED_RES:"cloudkit-statechart-evt-handled-res",EVT_TRANSITION_RES:"cloudkit-statechart-evt-transition-res",EVT_TERMINATE_RES:"cloudkit-statechart-evt-terminate-res",STATE_CHART_TRACE_ENABLED:NO});SC.mixin(CK.Statechart,{handled:function(){return CK.Statechart.EVT_HANDLED_RES},terminate:function(){return CK.Statechart.EVT_TERMINATE_RES}});SC.mixin(Function.prototype,{state:function(b){this.superstateKey=b;this.isState=YES;return this}});CK.Statechart._DISPATCH_PATH=[];SC.mixin(SC.Object.prototype,{stateKey:"state",dispatch:function(o){if(this._isDispatching){if(this.shouldTrace()){SC.debug('%@ ignored event "%@": already dispatching an event',this,o.sig)}return NO}this._isDispatching=YES;var w=this.get("stateKey");var n=CK.Statechart._DISPATCH_PATH;var u,t,v,s,z,q,p,x;n.length=0;u=this[w];if(!u){this._isDispatching=NO;return NO}this._ck_statechart_dispatch(o);var y=this._ck_state_depth;q=this._ck_statechart_event(this[w],o,y);if(!q){s=this[u].superstateKey;while(s){q=this._ck_statechart_event(s,o,--y);if(q){v=s;break}else{s=this[s].superstateKey}}}if(!q){this._isDispatching=NO;return NO}else{if(q===CK.Statechart.EVT_TRANSITION_RES){t=this[w];n[0]=this[t].superstateKey;if(v&&u!=this[v]){this._ck_statechart_exit(u);s=this[u].superstateKey;while(s&&s!==v){this._ck_statechart_exit(s);s=this[s].superstateKey}}if(v){u=v}figureOutWhatToDo:do{if(u===t){this._ck_statechart_exit(u);p=0;break figureOutWhatToDo}if(this[t].superstateKey===u){p=0;break figureOutWhatToDo}if(this[u].superstateKey===this[t].superstateKey){this._ck_statechart_exit(u);p=0;break figureOutWhatToDo}if(this[u].superstateKey===t){this._ck_statechart_exit(u);p=-1;break figureOutWhatToDo}p=1;s=n[1]=this[t].superstateKey;if(s){s=this[s].superstateKey}while(s!==undefined){n[++p]=s;if(s===u){--p;break figureOutWhatToDo}else{s=this[s].superstateKey}}this._ck_statechart_exit(u);v=this[u].superstateKey;if(!v){break figureOutWhatToDo}else{u=v;x=p;do{z=n[x];if(z&&u===z){p=x-1;break figureOutWhatToDo}else{--x}}while(x>0)}for(;;){this._ck_statechart_exit(v);v=this[u].superstateKey;if(!v){p=0;break figureOutWhatToDo}else{u=v;var x=p;do{z=n[x];if(z&&u===z){p=x-1;break figureOutWhatToDo}else{s=this[u].superstateKey;u=s||null;--x;if(!u){p=-1;break}}}while(x>=0)}if(!u){p=-1;break}}}while(NO);if(p>0){do{this._ck_statechart_enter(n[p])}while((--p)>0)}if(p===0){this._ck_statechart_enter(this[w])}u=this[w];while(this._ck_statechart_init(this[w])===CK.Statechart.EVT_TRANSITION_RES){t=this[w];p=0;if(t!==u){t=n[++p]=this[t].superstateKey;if(t!==u){while(t!==u){t=n[++p]=this[t].superstateKey}}--p}if(p>0){do{this._ck_statechart_enter(n[p])}while((--p)>0)}if(p===0){this._ck_statechart_enter(this[w]);u=this[w]}}this.notifyPropertyChange(w);this._isDispatching=NO;return YES}else{this._isDispatching=NO;return YES}}},_ck_statechart_dispatch:function(b){},_ck_statechart_enter:function(b){return this[b](CK.Statechart.EVT_ENTER)},_ck_statechart_exit:function(b){return this[b](CK.Statechart.EVT_EXIT)},_ck_statechart_init:function(b){return this[b](CK.Statechart.EVT_INIT)},_ck_statechart_event:function(d,e,f){return this[d](e)}});SC.mixin(SC.Object.prototype,{_object_init:function(k){var f,g=(k)?k.length:0;for(f=0;f<g;f++){SC._object_extend(this,k[f])}SC.generateGuid(this);this.init();var h=this.initMixin;g=(h)?h.length:0;for(f=0;f<g;f++){h[f].call(this)}if(this.initial&&this.initStatechart){var j=this;if(!SC.isReady){SC.ready(function(){j.initStatechart()})}else{this.initStatechart()}}return this},initialStateKey:"initial",initStatechart:function(){var u=this.get("initialStateKey");var t=this.get("stateKey");var l=CK.Statechart._DISPATCH_PATH;var p,v,s,q,o,m,n;p=this[u];if(!p||!this[p]||!this[p].isState){return this}this[t]=p;this.hasStatechart=YES;this._ck_state_depth=0;this._ck_statechart_initStatechart();q=this[p].superstateKey;if(q!==undefined){m=0;while(q){l[++m]=q;q=this[q].superstateKey}do{this._ck_statechart_enter(l[m])}while((--m)>0)}this._ck_statechart_enter(this[t]);while(this._ck_statechart_init(this[t])===CK.Statechart.EVT_TRANSITION_RES){v=this[t];m=0;while(p!==v){q=this[v].superstateKey;if(q===undefined){break}else{v=l[++m]=q}}--m;if(m!==0){do{this._ck_statechart_enter(l[m])}while((--m)>0)}if(m===0){this._ck_statechart_enter(this[t])}p=this[t]}return this},shouldTrace:function(){var b=this.get("trace");return SC.none(b)?CK.Statechart.STATE_CHART_TRACE_ENABLED:b},destroyStatechart:function(){},_ck_statechart_initStatechart:function(){}});SC.mixin(SC.Object.prototype,{addStatechartObserver:function(d,f){var e=function(a,h,b,j){this.dispatch({sig:"propertyChanged",target:a,key:h,revision:j})};this.addObserver(d,f,e);return e},removeStatechartObserver:function(d,f,e){if(this.hasObserverFor(d)){this.removeObserver(d,f,e)}return this}});sc_require("system/init");sc_require("system/dispatch");CK.LOG_MOUSE_EVENTS=NO;var _ck_log=function(b){SC.debug(b)};var _ck_alert=function(b){SC.warn(b);alert(b)};SC.mixin(SC.Object.prototype,{_ck_statechart_initStatechart:function(){if(this.shouldTrace()){var b=this.get("ck_singleStep")?_ck_alert:_ck_log;b.call(this,"%@:initStatechart()".fmt(this))}},_ck_statechart_dispatch:function(d){if(this.shouldTrace()){var f=d.sig;if(!CK.LOG_MOUSE_EVENTS&&f.match(/^mouse+/)){return}var e=this.get("ck_singleStep")?_ck_alert:_ck_log;e.call(this,"%@:dispatch('%@')".fmt(this,f))}},_ck_statechart_enter:function(n){var k=this._ck_state_depth++;var l="";while(--k>=0){l=l+"  "}if(this.shouldTrace()){var j=this.get("ck_singleStep")?_ck_alert:_ck_log;j.call(this,l+'-> entering "'+n+'"')}var m=this[this.stateKey];var o=this[n](CK.Statechart.EVT_ENTER),h;if(this[this.stateKey]!==m){h='\nENTER STATE INVARIANT FAILURE\nYou MUST NOT CALL ck_transition() during the \'enter\' event. Your "%@" state\'s \'enter\' handler (or code somewhere else) called ck_transition("%@") while transitioning to "%@".';throw h.fmt(n,this[this.stateKey],m)}else{if(o!==CK.Statechart.EVT_HANDLED_RES&&o!==undefined){h="\nENTER STATE INVARIANT FAILURE\nThe only valid response from the 'enter' event is: \"return ck_handled() ;\" (or nothing at all). Your \"%@\" state's 'enter' handler returned: %@";throw h.fmt(n,o)}else{return o}}},_ck_statechart_exit:function(n){var k=this._ck_state_depth--;var l="";while(--k>0){l=l+"  "}if(this.shouldTrace()){var j=this.get("ck_singleStep")?_ck_alert:_ck_log;j.call(this,l+'<- leaving  "'+n+'"')}var m=this[this.stateKey];var o=this[n](CK.Statechart.EVT_EXIT),h;if(this[this.stateKey]!==m){h='\nEXIT STATE INVARIANT FAILURE\nYou MUST NOT CALL ck_transition() during the \'exit\' event. Your "%@" state\'s \'exit\' handler (or code somewhere else) called ck_transition("%@") while transitioning to "%@".';throw h.fmt(n,this[this.stateKey],m)}else{if(o!==CK.Statechart.EVT_HANDLED_RES&&o!==undefined){h="\nEXIT STATE INVARIANT FAILURE\nThe only valid response from the 'exit' event is: \"return ck_handled() ;\" (or nothing at all). Your \"%@\" state's 'exit' handler returned: %@";throw h.fmt(n,o)}else{return o}}},_ck_statechart_init:function(m){var k=this._ck_state_depth;var l="";while(--k>0){l=l+"  "}var g=this[m](CK.Statechart.EVT_INIT),j=this.get("stateKey");if(this.shouldTrace()&&g===CK.Statechart.EVT_TRANSITION_RES){var h=this.get("ck_singleStep")?_ck_alert:_ck_log;h.call(this,l+'  (taking default transition to "'+this[j]+'")')}return g},_ck_statechart_event:function(t,l,p){if(l.sig.match(/^mouse(Down|Dragged|Up|Over|Out|Moved)/)&&!CK.LOG_MOUSE_EVENTS){return}var s="";while(--p>0){s=s+"  "}var n=this[t](l),o=this.get("stateKey");if(this.shouldTrace()){var m=this.get("ck_singleStep")?_ck_alert:_ck_log;var q;var k=(l.sig==="keyDown"&&(q=l.getCharString()))?"%@(%@)".fmt(l.sig,q):l.sig;if(n){if(n===CK.Statechart.EVT_HANDLED_RES){m.call(this,s+'"'+t+"\" handled event '"+k+"' (no transition)")}else{if(n===CK.Statechart.EVT_TRANSITION_RES){m.call(this,s+'"'+t+"\" handled event '"+k+"' with a transition to \""+this[o]+'"')}}}else{m.call(this,s+'"'+t+"\" ignored event '"+k+"'")}}return n}});SC.mixin(SC.Object.prototype,{tryToPerform:function(e,g,f){var h;if(this.hasStatechart){if(g&&g instanceof SC.Event){g.sig=e;h=this.dispatch(g)}else{h=this.dispatch({sig:e,arg1:g,arg2:f})}}if(!h&&this.respondsTo(e)){h=this[e](g,f)!==NO}return h}});SC.stringsFor("en-us",{"CK.Token.Drag.MultipleTokens":"%@1","CK.Token.ContextMenu.Copy":"Copy","CK.Token.ContextMenu.Delete":"Delete"});CK.Tokens=SC.Object.create({});CK.Token=SC.Object.extend({id:"",rawValue:"",name:"",emailId:"",isValid:YES,isLeftAccessoryVisible:NO,toHash:function(){return{id:this.get("id"),rawValue:this.get("rawValue"),name:this.get("name"),emailId:this.get("emailId"),isValid:this.get("isValid")}}});sc_require("models/token");CK.tokenClipboardController=SC.ObjectController.create({clipboard:null,copyTokens:function(b){if(b){this.set("clipboard",b.copy())}},copiedTokens:function(){var b=this.get("clipboard");if(b){return b.toArray()}return null}.property("clipboard").cacheable(),copiedTokenToString:function(){var g=this.get("copiedTokens"),f=0,h="";if(g){f=g.get("length")}for(var e=0;e<f;e++){h+=g[e].get("rawValue")+", "}h=h.substring(0,h.length-2);return h}.property("copiedTokens").cacheable(),clearClipboard:function(){this.set("clipboard",null)}});sc_require("models/token");CK.TokensController=SC.ArrayController.extend({nextIndex:0,shouldMoveLeft:NO,content:null,init:function(){arguments.callee.base.apply(this,arguments);this.set("content",[])},commitTokens:function(h){var j=CK.tokensParser.parseEmailAddressList(h);var k=j.get("length"),g=this.get("nextIndex"),l=g;SC.Benchmark.start("CK.TokensController.commitTokens");this.beginPropertyChanges();if(g===null||g===this.get("length")){this.pushObjects(j);g=this.get("length")}else{for(var m=0;m<k;m++){this.insertAt(g,j[m]);g++}}if(this.get("shouldMoveLeft")===YES){g=l;this.set("shouldMoveLeft",NO)}this.set("nextIndex",g);this.endPropertyChanges();SC.Benchmark.end("CK.TokensController.commitTokens")}});sc_require("models/token");CK.tokensParser=SC.Object.create({_validator:null,parseEmailAddressList:function(j){var w=j.length;var u=[];for(var t=0;t<=w;){var p=NO,x=NO,s=YES;for(var v=t;v<w;v++){var o=j.charAt(v);if((o===","||o===";")&&p===NO&&x===NO){s=NO;break}else{if(o==='"'){p=!p}else{if(o==="("){x=YES}else{if(o===")"){x=NO}}}}}var q=j.substr(t,v-t);if(q.length!==0){var n=this._parse(q);if(n&&(n.name.length>0||n.emailId.length>0)){u.push(n)}}t=v+1}return u},_parse:function(l){if(SC.none(l)){return null}var a=l.trim();var m=a.length;if(m<=0){return null}var n="";var p="";var h;if(a.charAt(0)==='"'){if(a.lastIndexOf('"')<a.search("<")){h=1.1}else{h=1}}else{if(a.charAt(0)==="("){if(a.lastIndexOf(")")<a.search("<")){h=2.1}else{h=2}}else{if(a.match("@")&&!(a.match("<")||a.match('"'))){if(a.indexOf("@")<a.indexOf("(")<a.indexOf(")")){h=3.1}else{h=3}}else{if(a.match("<")){h=4}else{if(a.indexOf("@")>1&&a.indexOf('"')>-1&&a.indexOf("@")<a.indexOf('"')){h=5}else{if(a.indexOf("@")===-1&&a.indexOf('"')>-1){h=6}}}}}}switch(h){case 1:n=a.substring(1,a.lastIndexOf('"')).trim();p=a.substring(a.lastIndexOf('"')+1,m).trim();break;case 1.1:n=a.substring(1,a.lastIndexOf('"')).trim();p=a.substring(a.lastIndexOf("<")+1,a.lastIndexOf(">")).trim();break;case 2:n=a.substring(1,a.lastIndexOf(")")).trim();p=a.substring(a.lastIndexOf(")")+1,m).trim();break;case 2.1:n=a.substring(1,a.lastIndexOf(")")).trim();p=a.substring(a.lastIndexOf("<")+1,a.lastIndexOf(">")).trim();break;case 3:p=a;break;case 3.1:n=a.substring(a.indexOf("(")+1,a.lastIndexOf(")")).trim();p=a.substring(0,a.indexOf("(")).trim();break;case 4:n=a.substring(0,a.lastIndexOf("<")).trim();p=a.substring(a.lastIndexOf("<")+1,a.lastIndexOf(">")).trim();break;case 5:n=a.substring(a.indexOf('"')+1,a.lastIndexOf('"')).trim();p=a.substring(0,a.indexOf('"')).trim();break;case 6:n=a.substring(a.indexOf('"')+1,a.lastIndexOf('"')).trim();p=a.substring(0,a.indexOf('"'));break;default:p=a}var k=CK._UsersAutocompleteControllerSharedController.validInputValue(p).length>0;var o=l.split(" ").lastObject();return CK.Token.create({emailId:p,name:n,rawValue:l,id:o.substring(o.indexOf("(")+1,o.lastIndexOf(")")),isValid:k})}});CK.TokenMenuView=SC.MenuPane.create({layout:{width:150},isEnabled:YES});sc_require("views/token_menu");CK.TokenItemView=SC.View.design(SC.AutoResize,{layout:{height:27,width:150},_previousContent:null,supportsAutoResize:YES,autoResizeLayer:function(){return this.get("layer")}.property("layer").cacheable(),autoResizeText:null,autoResizeTextBinding:".value",isSelected:function(){return this.getPath("parentView.selection").contains(this.get("content"))}.property(),autoResizePaddingBinding:SC.Binding.transform(function(d,f){var e=2;if(d.length>0){e=15}return e}).from(".value"),classNames:["cw-token-item"],displayProperties:["isEditing"],tagName:"span",acceptsFirstResponder:YES,escapeHTML:YES,isEditing:NO,content:null,value:function(f,j){var k=this.get("content"),g=this.get("isEditing"),h;if(!SC.none(j)){h=j}else{if(g===YES){h=k.get("rawValue")}else{if(k.getPath("name.length")>0){h=k.get("name")}else{h=k.get("emailId")}}}return h}.property("isEditing").cacheable(),_input:null,_label:null,_menuView:null,recommendedMaxWidth:null,init:function(){arguments.callee.base.apply(this,arguments)},render:function(t,u){var m=this.get("value"),d=this.get("parentView"),p="disclosure sc-view";if(this.get("isEditing")===YES){t.push('<input type="text" value="'+m.replace(/"/g,"&quot;")+'">')}else{var n=this.get("content");if(n.get("isLeftAccessoryVisible")){var o="vip";var s="accessory sc-view ";if(n.get("isValid")===NO){o=o+" token-invalid"}t.push("<div class='left' /><div class='middle' /><div class='right' />");t.push('<label class="'+o+'">',SC.RenderContext.escapeHTML(m),"</label>");t.push('<div class="'+p+'"></div>');t.push('<div class="'+s+'"></div>')}else{var v="";if(n.get("isValid")===NO){t.addClass("token-invalid")}var q='<span class ="token-span"><label class= "token-value">%@</label></span>';t.push("<span class='left'></span>");t.push("<span class='middle'></span>");t.push("<span class='right'></span>");t.push(q.fmt(SC.RenderContext.escapeHTML(m)))}}},didCreateLayer:function(){if(!this._input){this._input=this.$("input")[0]}if(!this._label){this._label=this.$("label")[0]}},didUpdateLayer:function(){if(!this._input){this._input=this.$("input")[0];if(SC.browser.isIE8OrLower&&this._input){this._input.focus()}}if(!this._label){this._label=this.$("label")[0]}},isEditingDidChange:function(){if(SC.browser.isIE===YES){if(!this._mouseDragged){this._mouseDragged=this.get("mouseDragged")}if(this.get("isEditing")===YES){this.set("mouseDragged",undefined)}else{if(this.get("mouseDragged")===undefined){this.set("mouseDragged",this._mouseDragged)}}}}.observes("isEditing"),mouseDown:function(b){if(this.get("isEditing")===YES){b.allowDefault()}else{if(this.get("isEditing")===NO&&b.clickCount===2){}}},touchStart:function(b){this.mouseDown(b)},doubleClick:function(b){if(SC.browser.isIE8OrLower){return this.mouseDown(b)}},mouseUp:function(j){var p=this.get("parentView"),o=p.get("tokensController"),q=o.indexOf(this.get("content")),t=(q>=0)?q:-1,w=p.get("selection"),s=w.get("length"),z=w.toArray(),u=p.get("childViews");if(this.get("isEditing")===NO){if($(j.target).hasClass("disclosure")){this._menuView=p.get("menuView");var x=this.getPath("frame.width");if(x<75){x=75}this._menuView.adjust("width",x);var y=[{title:"CK.Token.ContextMenu.Copy".loc(),isEnabled:YES,target:this,action:"copyToken"},{title:"CK.Token.ContextMenu.Delete".loc(),isEnabled:YES,target:this,action:"deleteToken"}];this._menuView.set("items",y);this._menuView.popup(this);return YES}if((SC.browser.isMac&&j.metaKey===YES)||(SC.browser.isWindows&&j.ctrlKey===YES)){if(this.get("isSelected")===YES){p.deselect(t)}else{p.select(t)}}else{this.beginPropertyChanges();for(var v=0;v<s;v++){p.deselect(o.indexOf(z[v]))}this.endPropertyChanges();p.select(t)}}return NO},touchEnd:function(a){this.mouseUp(a)},keyDown:function(e){var d=this.interpretKeyEvents(e)||NO;if(SC.browser.mozilla){if(e.shiftKey&&(e.keyCode===39||e.keyCode===37)){return YES}}this.invokeLater(this.updateValue,10);return d},selectAll:function(e){if(this.get("isEditing")){var d=this._input;if(d&&d.value!==""){d.select();return YES}}return NO},moveRightAndModifySelection:function(f,g){var k=this.get("parentView"),h,j;if(k){h=k.get("tokensController");j=h.indexOf(this.get("content"))+1}else{return YES}if(this.get("isEditing")===YES){if(this.get("value")!==""){if(!g){if(f){g=f}else{return NO}}g.allowDefault();return YES}else{k.deselect(j-1);k.select(j)}}return NO},moveLeftAndModifySelection:function(f,g){var k=this.get("parentView"),h,j;if(k){h=k.get("tokensController");j=h.indexOf(this.get("content"))-1}else{return YES}if(this.get("isEditing")===YES){if(this.get("value")!==""){if(!g){if(f){g=f}else{return NO}}g.allowDefault();return YES}else{k.deselect(j+1);k.select(j)}}return NO},insertNewline:function(h){var m=this.get("parentView");if(!m){return NO}if(this.get("isEditing")){var j=m.get("tokensController"),k=j.indexOf(this.get("content"));j.set("nextIndex",k+1);m.createEditingToken()}else{var g=m.get("selection"),l=g.get("length");if(l===1){this.beginEditing();h.preventDefault()}}return YES},insertTab:function(e){var d=this.get("parentView");this.commitEditing();if(d){return d.insertTabInChildView(e)}else{return NO}},insertBacktab:function(e){var d=this.get("parentView");this.commitEditing();if(d){return d.insertBacktabInChildView(e)}else{return NO}},deleteBackward:function(t){if(!this.get("parentView")){return NO}var v=this.get("parentView"),u=v.get("tokensController"),A=this.get("content"),F=u.indexOf(A),C,H=v.get("selection"),z=H.toArray(),E=H.get("length");if(this.get("isEditing")===YES){var x=this._input,w=x.value,s=this.getTextSelection(),B=s.start,I=s.end,y=v.get("childViews"),D=u.indexOf(A);if(w.length===0){if(D>0){v.deselect(D);v.select(D-1);t.preventDefault();return YES}}else{if(B===0&&I===0&&D!==0){u.set("nextIndex",D);this.commitEditing();var G=D-1;y.objectAt(G).becomeFirstResponder();v.select(G);t.preventDefault();return YES}}if(SC.browser.mozilla){t.allowDefault()}return NO}else{v.deleteTokens();return YES}},cancel:function(b){if(this.get("isEditing")){this.discardEditing();return YES}},moveRight:function(m){var o=this.get("parentView"),n=o.get("tokensController"),v=n.indexOf(this.get("content")),t,w=o.get("selection"),q=w.toArray(),u=w.get("length");if(this.get("isEditing")===YES){var p=this._input,x=p.value.length,s=this.getTextSelection().start;if(s===x){if(x===0){if(v===n.get("length")-1){return YES}t=v+1;o.deselect(t-1);o.select(t)}else{n.set("nextIndex",v+1);o.createEditingToken()}return YES}else{return NO}}else{n.set("nextIndex",n.indexOf(q[u-1])+1);o.createEditingToken()}},moveLeft:function(o){var q=this.get("parentView"),p=q.get("tokensController"),x=p.indexOf(this.get("content")),v,y=q.get("selection"),t=y.toArray(),w=y.get("length");if(this.get("isEditing")){var s=this._input,n=this.getTextSelection(),u=n.start,z=n.end;if(!s.value){if(x===0){return YES}v=x-1;q.deselect(x);q.select(v)}else{if((u===z)&&u===0){p.set("nextIndex",x);q.createEditingToken();return YES}else{return NO}}}else{p.set("nextIndex",p.indexOf(t[w-1]));q.createEditingToken();return NO}},updateValue:function(){if(this._input!==undefined){var b=this._input.value;this.set("value",b)}},beginEditing:function(){var o=this.get("parentView"),k=o.get("tokensController"),n=this.get("content"),m=o.get("selection"),l=m.toArray(),h=m.get("length");this.beginPropertyChanges();for(var j=0;j<h;j++){o.deselect(k.indexOf(l[j]))}this.endPropertyChanges();this.becomeFirstResponder();this._previousContent=n;this.set("isEditing",YES);this.invokeLast(function(){if(this._input){this._input.focus()}})},commitEditing:function(){var f=this.get("parentView");if(!f){SC.error(this+".commitEditing: Token item view has no parent. NOOP");return}var h=f.get("tokensController"),j=this.get("value").trim(),k=this.get("content"),g=h.indexOf(k);if(this.get("isEditing")===NO){return}this.set("isEditing",NO);h.removeObject(k);if(SC.empty(j)===NO){h.set("nextIndex",g);if(SC.browser.isIE){this.invokeLast(function(){h.commitTokens(j)})}else{h.commitTokens(j)}}},discardEditing:function(){var e=this.get("parentView"),d=e.get("tokensController");if(this._previousContent.get("rawValue")!==""){this.set("content",this._previousContent)}else{d.removeObject(this.get("content"))}this.set("isEditing",NO)},copyToken:function(){CK.tokenClipboardController.copyTokens([this.get("content")])},deleteToken:function(){var e=this.get("parentView");if(e){var g=e.get("tokensController"),h=this.get("content"),f=g.indexOf(h);g.removeObject(h)}g.set("nextIndex",f);e.createEditingToken()},valueDidChange:function(){if(this._input&&this.get("isEditing")===YES){this.adjustEditorWidth()}var e=this.get("parentView");if(e){var d=this.get("value");e.childTokenItemValueDidChange(this._previousValue,d);this._previousValue=this.get("value")}}.observes("value"),adjustEditorWidth:function(){var h=this._input,g=h.value,e,f;if(g.length>0){e=SC.metricsForString(g,h);f=e.width+14+"px"}else{f="1px"}this.$()[0].style.width=f},didBecomeFirstResponder:function(){if(!this._parentView){this._parentView=this.get("parentView")}this._parentView.setIfChanged("isActive",YES)},willLoseFirstResponder:function(b){if(this.get("isEditing")===YES){this.commitEditing()}this._parentView.setIfChanged("isActive",NO)},mouseDragged:function(q){var s=this.get("parentView"),E=this.getPath("parentView.canDrag");if(this.get("isEditing")===YES||!E){return}var A=s.get("selection"),p=A.get("length"),w,D=NO;if(this.get("isSelected")===NO){w=this}else{if(p===1){w=this}else{w=CK.TokenDragView.create({});var x=s.get("content"),y,t,u=[],B,C,v,z=SC.SelectionSet.create();A=A.toArray();for(y=0;y<p;y++){C=A.objectAt(y);v=x.indexOf(C);u.push(v)}u=u.sort();for(t=0,B=u.length;t<B;t++){z.addObject(x.objectAt(u[t]))}w.set("content",z);w.createLayer();D=YES}}SC.Drag.start({event:q,source:s,dragView:w,ghost:YES,ghostActsLikeCursor:D,slideBack:YES,dataSource:s,sourceIsDraggable:YES});return YES},getTextSelection:function(){var l=this._input,k=0,j=0;if(l){k=null;j=null;if(!l.value){k=j=0}else{if("selectionStart" in l){k=l.selectionStart}if("selectionEnd" in l){j=l.selectionEnd}if(k===null||j===null){var n=document.selection;if(n){var o=n.type;if(o&&(o==="None"||o==="Text")){var h=n.createRange();var m=h.text.length;k=Math.abs(h.moveStart("character",0-(l.value.length+1)));j=k+m}}}}}return{start:k,end:j}},selectStart:function(b){return YES}});sc_require("views/token_item");sc_require("views/token_menu");CK.TokenView=SC.View.extend(SC.FlowedLayout,{useStaticLayout:NO,defaultFlowSpacing:{left:3,top:5,right:6},classNames:["cw-token-view"],tokensController:CK.TokensController,contentBinding:".tokensController.arrangedObjects",selectionBinding:".tokensController.selection",acceptsFirstResponder:YES,_shouldShowScroller:NO,exampleView:CK.TokenItemView,_TMP_ATTRS:{},menuView:CK.TokenMenuView,isActive:NO,_map:null,canDelete:true,canDrag:true,init:function(){var b=this.get("tokensController");if(b&&b.isClass){b=b.create()}this.set("tokensController",b);arguments.callee.base.apply(this,arguments)},_scfl_calculatedSizeDidChange:function(){if(this.get("autoResize")){if(this.get("layoutDirection")==SC.LAYOUT_VERTICAL){if(this.get("shouldResizeHeight")){this.adjust("minHeight",this.get("_scfl_maximumCollapsedRowLength"))}if(this.get("shouldResizeWidth")){this.adjust("minWidth",this.get("_scfl_totalCollapsedRowSize"))}}else{if(this.get("shouldResizeWidth")){this.adjust("minWidth",this.get("_scfl_maximumCollapsedRowLength"))}if(this.get("shouldResizeHeight")){var b=this.get("_scfl_totalCollapsedRowSize");if(b===0){b=30}if(b>30){b+=4}this.adjust("minHeight",b)}}}},mouseDown:function(p){var t=this.get("childViews"),s=t.get("length"),v=this.get("tokensController"),x=p.pageX,A=p.pageY,u,q,y,C,B,D,z;for(var w=0;w<s;w++){u=t.objectAt(w);y=u.$().offset();C=y.left;B=y.top+u.get("layout").height;if((x<=C&&A<=B)||(D>y.left&&A<=z)){v.set("nextIndex",w);break}D=C;z=B}if(w===s){v.set("nextIndex",s)}this.createEditingToken();return YES},touchStart:function(a){this.mouseDown(a)},createEditingToken:function(){var h=this.get("tokensController"),g=CK.Token.create();var e=h.get("nextIndex"),f=h.get("length");if(e>f){e=f}h.insertAt(e,g);this.invokeLast(function(){var a=this._map[SC.guidFor(g)];if(a){a.beginEditing()}})},createItemView:function(e,d){return e.create(d)},contentDidChange:function(){var C={},B=this._map||{},z=[],v=this.get("content"),x=this.get("tokensController"),A=v.get("length"),s,p,t,u,D;this.beginPropertyChanges();for(var y=0;y<A;y++){p=v.objectAt(y);t=SC.guidFor(p);u=B[t];if(!u){var w=this.get("exampleView");var q=this._TMP_ATTRS;q.content=p;u=this.createItemView(w,q);this.appendChild(u)}if(p===this._spacingToken){D=u}z.push(u);C[t]=u}this.endPropertyChanges();this.beginPropertyChanges();for(t in B){if(!C[t]){this.removeChild(B[t])}}this.endPropertyChanges();this._map=C;this.reorder(z);if(D){this.invokeLast(function(){D.$().addClass("token-hidden")})}this.notifyPropertyChange("frame");if(SC.instanceOf(this.contentChanged,Function)){this.contentChanged()}}.observes("content","content.length"),selectAll:function(b){this.selectAllTokens();b.preventDefault()},copyTokens:function(n){var l=this.get("selection"),m;if(l){m=l.copy();CK.tokenClipboardController.copyTokens(m);if(n){var k=this.get("tokensController"),o=l.toArray(),j=o.get("length");this.beginPropertyChanges();for(var h=0;h<j;h++){k.removeObject(o[h])}this.endPropertyChanges();k.set("nextIndex",k.get("length"));this.createEditingToken()}}},pasteTokens:function(){var j=CK.tokenClipboardController.copiedTokens(),h,g=this.get("tokensController"),m=g.get("nextIndex");if(j){h=j.get("length");this.beginPropertyChanges();for(var k=0;k<h;k++){var l=CK.Token.create(j[k].toHash());g.insertAt(m+k,l)}this.endPropertyChanges()}},deleteTokens:function(){var l=this.get("tokensController"),p=this.get("selection"),q=p.get("length"),m=p.toArray(),k,o,n=-1;if(!this.get("canDelete")){return false}if(q>0){n=l.indexOf(m[q-1])}this.beginPropertyChanges();for(var j=0;j<q;j++){o=m[j];k=l.indexOf(o);if(n===-1||n>k){n=k}l.removeObject(o)}this.endPropertyChanges();if(n===-1){n=0}l.set("nextIndex",n);this.createEditingToken()},moveLeftAndModifySelection:function(o,k){var l=this.get("parentView"),m=this.get("tokensController"),q=this.get("selection"),n=q.get("length"),t=q.toArray();if(n>0){var s=m.indexOf(t[n-1]);var p=s-1;if(q.containsObject(m.objectAt(p))){this.deselect(s)}else{this.select(p)}}},moveRightAndModifySelection:function(s,l){var m=this.get("parentView"),o=this.get("tokensController"),n=o.get("length"),t=this.get("selection"),p=t.get("length"),v=t.toArray();if(p>0){var u=o.indexOf(v[p-1]);var q=u+1;if(t.containsObject(o.objectAt(q))){this.deselect(u)}else{if(q!==n){this.select(q)}}}},select:function(p){var m=this.get("selection"),n=this.get("content"),l=this.get("childViews"),j=this.get("tokensController"),k;if(SC.typeOf(p)===SC.T_NUMBER){p=SC.IndexSet.create(p,1)}if(m){m=m.copy()}else{m=SC.SelectionSet.create()}k=p.get("length");if(k===1){var q=p.get("firstObject"),o=l.objectAt(q);m.addObject(n.objectAt(q));if(o&&o.$){o.$().addClass("focus");if(m.get("length")===1){o.becomeFirstResponder()}}}this.set("selection",m.freeze());return this},deselect:function(p){var m=this.get("selection"),n=this.get("content"),l=this.get("childViews"),j=this.get("tokensController"),k;if(SC.typeOf(p)===SC.T_NUMBER){p=SC.IndexSet.create(p,1)}k=p.get("length");if(k===1){var q=p.get("firstObject"),o=l.objectAt(q);m=m.copy().removeObject(n.objectAt(q));o.$().removeClass("focus")}this.set("selection",m.freeze());return this},selectAllTokens:function(){var l=this.get("selection"),m=this.get("content"),k=this.get("childViews").filterProperty("isEditing",NO),j=k.get("length"),h=this.get("tokensController");if(l){l=l.copy()}else{l=SC.SelectionSet.create()}var n;this.beginPropertyChanges();for(var o=0;o<j;o++){n=k.objectAt(o);if(n.get("isSelected")===NO){l.addObject(m.objectAt(o));n.$().addClass("focus");if(l.get("length")===1){n.becomeFirstResponder()}}}this.endPropertyChanges();this.set("selection",l.freeze())},deselectAllTokens:function(){var v=this.get("selection"),p=this.get("content"),t=this.get("tokensController"),q=t.get("length"),l=this.get("childViews"),o=v.toArray(),n,m,s;this.beginPropertyChanges();for(var u=0;u<q;u++){n=o[u];s=t.indexOf(n);if(s>=0){v=v.copy().removeObject(n);m=l.objectAt(s);m.$().removeClass("focus")}}this.endPropertyChanges();this.set("selection",v.freeze());return this},didBecomeFirstResponder:function(b){this.createEditingToken();this.setIfChanged("isActive",YES)},willLoseFirstResponder:function(g){var h=this.get("tokensController"),l=this.get("selection");this.beginPropertyChanges();if(l){var j=l.get("length"),k=l.toArray();for(var m=0;m<j;m++){this.deselect(h.indexOf(k[m]))}}this.setIfChanged("isActive",NO);this.endPropertyChanges()},isDropTarget:YES,dragDataTypes:[CK.TokenItemView],_prevIndex:null,_prevHeight:null,_MAX_HEIGHT:112,_maxFrameHeight:113,_spacingToken:CK.Token.create({emailId:"spacingtoken"}),computeDragOperations:function(d,e){return SC.DRAG_MOVE},acceptDragOperation:function(e,d){return YES},dragStarted:function(j,g){var f=j.dragView;if(f&&f.kindOf(CK.TokenItemView)){var k=j.getPath("ghostView");if(k){var h=k.$();if(h&&h.hasClass("cw-token-ghost")===NO){h.addClass("cw-token-ghost")}}}},dragEntered:function(t,m){var n=t.dragView,w=n.get("content"),v,s=this.get("tokensController"),q,u;this.beginPropertyChanges();if(n&&n.kindOf(CK.TokenItemView)){q=s.indexOf(w);if(q>=0){s.removeAt(q)}}else{var o=w.get("length"),p=w.toArray(),x;for(u=0;u<o;u++){x=s.indexOf(p[u]);if(x>=0){s.removeAt(x)}}}this.endPropertyChanges()},dragUpdated:function(B,G){var F=this.get("tokensController"),D=B.dragView,z=this.get("childViews"),u=z.get("length"),L=G.pageX,M=G.pageY,K,J,y,I,x,v,w,H,A=this._prevIndex,E=D.get("content"),C;for(C=0;C<u;C++){J=z.objectAt(C);y=J.get("layout");I=J.$().offset();x=I.left+y.width;v=I.top+y.height;if((L<=x&&M<=v)||(w>x&&M<=H)){K=C;break}w=x;H=v}if(C===u){K=u}if(A===K){return}F.set("nextIndex",K);F.removeObject(this._spacingToken);if(K<=F.get("length")){if(D&&D.kindOf(CK.TokenItemView)){this._spacingToken.set("displayName",E.get("displayName"));this._spacingToken.set("name",E.get("name"));this._spacingToken.set("emailId",E.get("emailId"))}F.insertAt(K,this._spacingToken)}this._prevIndex=K},dragExited:function(d,e){this.get("tokensController").removeObject(this._spacingToken)},performDragOperation:function(G,Q){var M=this.get("tokensController"),K=G.dragView,A=this.get("childViews"),D=A.get("length"),U,T,y,E,x,j,w,R,H,L=K.get("content"),O=G.get("location"),S=SC.offset(this.$()),N=O.x,P=O.y;for(H=0;H<D;H++){T=A.objectAt(H);y=T.get("layout");E=T.$().offset();x=E.left+y.width;j=E.top+y.height;if((N<=x&&P<=j)||(N>x&&j>R&&P<=R)){U=H;break}w=x;R=j}if(H===D){U=D}this.beginPropertyChanges();if(K&&K.kindOf(CK.TokenItemView)){M.insertAt(U,L)}else{var F=L.get("length"),I,J=L.toArray();for(I=0;I<F;I++){M.insertAt(U,J[I]);U++}}this.endPropertyChanges();return SC.DRAG_MOVE},clippingFrame:function(){var b=this.get("frame");return{x:0,y:0,width:b.width,height:b.height}}.property("frame"),viewDidResize:function(){arguments.callee.base.apply(this,arguments);var k=this.get("layout"),h=k.minHeight,m=this.get("layer"),j=this.get("tokensController"),g=NO;if(!m){return}if(h!==this._prevHeight){if(h>this._MAX_HEIGHT){this._shouldShowScroller=YES;h=this._maxFrameHeight;var l=this.getChildViewInEditMode();if(l){tokenBeingEdited=l.get("content");if(j.indexOf(tokenBeingEdited)===j.get("length")-1){g=YES}}}else{this._shouldShowScroller=NO}k.minHeight=h}if(this._shouldShowScroller===YES){m.style.overflowY="auto";m.style.overflowX="hidden"}else{m.style.overflowY="hidden";m.style.overflowX="hidden"}if(g===YES){this.invokeLast(function(){m.scrollTop=m.scrollHeight})}this._prevHeight=h},_scfl_frameDidChange:function(){var d=this.get("frame"),e=this._scfl_lastFrameSize||{};if(!d){return}this._scfl_lastFrameSize=SC.clone(d);if(e.width==d.width&&e.height==d.height){return}this._scfl_tileOnce()}.observes("frame"),flowSpacingForChild:function(e,d){var f;if(d.get("value")===""){this.set("shouldResizeWidth",NO);f=0;f={left:-2,right:0,bottom:f,top:5}}if(SC.none(f)){f=this.get("defaultFlowSpacing")}if(SC.none(f)){f=0}if(SC.typeOf(f)===SC.T_NUMBER){f={left:f,right:f,bottom:f,top:f}}else{f.left=f.left||0;f.right=f.right||0;f.top=f.top||0;f.bottom=f.bottom||0}return f},getChildViewInEditMode:function(){var d=this.get("childViews");if(!d||d.get("length")===0){return null}for(var e=d.get("length")-1;e>=0;e--){if(d[e].get("isEditing")===YES){return d[e]}}return null},childTokenItemValueDidChange:function(e,d){},insertTabInChildView:function(e){this.resignFirstResponder();var d=this.get("nextValidKeyView");if(d&&d.becomeFirstResponder){d.becomeFirstResponder()}return YES},insertBacktabInChildView:function(e){this.resignFirstResponder();var d=this.get("previousValidKeyView");if(d&&d.becomeFirstResponder){d.becomeFirstResponder()}return YES}});sc_require("views/token_item");CK.TokenDragView=SC.View.extend(SC.AutoResize,{classNames:"cw-token-drag".w(),layout:{height:25,width:30},displayProperties:["content"],supportsAutoResize:YES,autoResizeLayer:function(){return this.get("layer")}.property("layer").cacheable(),autoResizeText:function(){return this.get("dragLabelText")}.property("dragLabelText").cacheable(),render:function(e,f){var d='<label class= "sc-view drag-count">%@</label>';e.addClass(this.get("badgeClass"));e.push("<span class='left'></span>");e.push("<span class='middle'></span>");e.push("<span class='right'></span>");e.push(d.fmt(SC.RenderContext.escapeHTML(this.get("dragLabelText"))));return arguments.callee.base.apply(this,arguments)},dragLabelText:function(){var h=this.get("content"),f=0,g,e="";if(h){return"CK.Token.Drag.MultipleTokens".loc(h.get("length"))}}.property("content"),badgeClass:function(){var d=this.get("dragLabelText");var e;if(d<10){e="drag-badge-one-digit"}else{e="drag-badge-two-digit"}return e}.property()});SC.metricsFor("en-us",{"CK.Autocomplete.Menu.SingleLine.WithCategories.minWidth":400,"CK.Autocomplete.Menu.SingleLine.NoCategories.minWidth":300,"CK.Autocomplete.Menu.DoubleLine.minWidth":250});SC.stringsFor("en-us",{"CK.Autocomplete.Category.CUSTOM":"","CK.Autocomplete.Category.HOME":"","CK.Autocomplete.Category.HOMEFAX":"","CK.Autocomplete.Category.MAIN":"","CK.Autocomplete.Category.MOBILE":"","CK.Autocomplete.Category.OTHER":"","CK.Autocomplete.Category.PAGER":"","CK.Autocomplete.Category.RECENTS":"","CK.Autocomplete.Category.WORK":"","CK.Autocomplete.Category.WORKFAX":"","CK.Autocomplete.Error.Generic":"","CK.Autocomplete.Error.Internal":"","CK.Autocomplete.Error.NotFound":"","CK.Autocomplete.GroupSecondaryLabel.Multiple":"%@ ","CK.Autocomplete.GroupSecondaryLabel.Single":"1 ","CK.Autocomplete.SearchingProgress":"%@"});CK.Autocomplete=SC.Object.create({localizedCategory:function(b){if(!b){return null}return("CK.Autocomplete.Category."+b).locWithDefault(b)}});CK.AutocompleteResult=SC.Object.extend({id:"",value:null,primaryLabel:null,category:null,localizedCategory:function(){return CK.Autocomplete.localizedCategory(this.get("category"))}.property("category").cacheable(),secondaryLabel:null,previewValue:null,matchChunks:null,isGroup:NO,isGroupMembershipResolved:NO,resolveGroupMembership:function(){},isEnabled:YES,disableMenuFlash:YES});CK.ContactsAutocompleteRequest=CK.Request.extend({contact:null,COPY_KEYS:CK.Request.prototype.COPY_KEYS.concat(["contact"]),});sc_require("models/autocomplete_result");sc_require("system/contacts_autocomplete_request");CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_CONTACTS=5;CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_LOOKUP=6;CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_ADD_CONTACT=7;CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_RECENT_RECIPIENTS=8;CK.CONTACTS_AUTOCOMPLETE_SORT_ORDER_FIRST_LAST="first,last";CK.CONTACTS_AUTOCOMPLETE_SORT_ORDER_LAST_FIRST="last,first";CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_FIRST_LAST="first,last";CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_LAST_FIRST="last,first";CK.CONTACTS_AUTOCOMPLETE_CONTACT_MATCH_FIELDS=["firstName","phoneticFirstName","middleName","lastName","phoneticLastName","nickName","companyName","emailAddresses"];CK.CONTACTS_AUTOCOMPLETE_GROUP_MATCH_FIELDS=["name"];CK.CONTACTS_AUTOCOMPLETE_RECENT_RECIPIENTS_MATCH_FIELDS=["name","address"];CK.CONTACTS_AUTOCOMPLETE_DEBUG_REPLY_LATENCY=0;CK.ContactsAutocompleteDataSource=SC.DataSource.extend({delegate:null,recentsRequestIsOutstanding:NO,recentsRequestHasCompleted:NO,recentsDataIsLoaded:NO,contactsRequestIsOutstanding:NO,contactsRequestHasCompleted:NO,contactsDataIsLoaded:NO,addContactRequestHasCompleted:NO,addContactDidError:NO,uploadVCardRequestHasCompleted:NO,uploadVCardDidError:NO,uploadVCardFailureErrorCode:null,allDataIsLoaded:function(){var b=this.getPath("delegate.includeRecentRecipients");if(b){return this.get("recentsDataIsLoaded")&&this.get("contactsDataIsLoaded")}else{return this.get("contactsDataIsLoaded")}}.property("recentsDataIsLoaded","contactsDataIsLoaded"),allDataIsLoadedForQuery:null,keepDataInSync:YES,syncInterval:0,syncTokenInUse:NO,dataRefreshNeeded:NO,__dummy_prefix__:"__dummy_prefix__",clearLoadedData:function(){this.set("recentsRequestIsOutstanding",NO);this.set("recentsRequestHasCompleted",NO);this.set("contactsRequestIsOutstanding",NO);this.set("contactsRequestHasCompleted",NO);this.set("addContactRequestHasCompleted",NO);this.set("addContactRequestHasFailed",NO);this.set("recentsDataIsLoaded",NO);this.set("contactsDataIsLoaded",NO);this.set("uploadVCardDidError",NO);this.set("uploadVCardRequestHasCompleted",NO);this.set("uploadVCardFailureErrorCode",null);this.set("outstandingAutocompletionRequestQuery",NO);this.set("allDataIsLoadedForQuery",NO);this._dataCache=null;this._groupsToResolve=[];this._storedRecords=[];this._lastSearchedPrefix=null;this._lastSearchedDataCache=null;this._mostRecentAutocompletionQuery=null;this._pendingAddContacts=[];this._lastSyncToken=null;this._lastPrefToken=null;this.set("dataRefreshNeeded",YES)},findCompletionsInLoadedData:function(ak){var aG=this._dataCache;if(!aG){return[]}var aE=NO;var aF=this._lastSearchedPrefix;if(aF){if(ak.indexOf(aF)===0){aG=this._lastSearchedDataCache}}var an=ak.split(" "),ad=[],ay=an.length,m,ar;for(m=0;m<ay;++m){ar=an[m];if(ar){ad.push(ar)}}var au={},A,aa,ab,k=ad.length,av,aH,aD,j,af,aj;for(m=0;m<k;++m){var ai={};var ac=ad[m];var aB=ac.removeDiacritics().toLowerCase();for(A=0;A<3;++A){var az,aN,aL;switch(A){case 0:az="recents";aN=CK.CONTACTS_AUTOCOMPLETE_RECENT_RECIPIENTS_MATCH_FIELDS;aL="guid";break;case 1:az="contacts";aN=CK.CONTACTS_AUTOCOMPLETE_CONTACT_MATCH_FIELDS;aL="contactId";break;case 2:az="groups";aN=CK.CONTACTS_AUTOCOMPLETE_GROUP_MATCH_FIELDS;aL="groupId";break}av=aG[az];ay=aN.length;for(aa=0;aa<ay;++aa){aH=aN[aa];aD=av[aH];j=aD.values;var ap=this._indexForString(j,aB);var ao=aB.length-1;var ah=aB.substr(0,ao);var al=aB.charCodeAt(ao);ah+=String.fromCharCode(al+1);var aq=this._indexForString(j,ah);var aI=j.length;if(ap<aI&&ap<aq){var aK=(aH==="emailAddresses");var aM=aD.records.slice(ap,aq);var aJ=aM.length;for(ab=0;ab<aJ;++ab){af=aM[ab];if(!af){continue}var aO=af.length;for(var ae=0;ae<aO;++ae){var aA,l;aj=aA=l=null;if(aK){aA=af[ae];l=aA.idx;aj=aA.rec}else{aj=af[ae]}var aw=aj[aL];if(aw){var aC=au[aw];if(!aC){au[aw]={fields:{},rec:aj}}ai[aw]=YES;if(!aK){au[aw].fields[aH]=ac}else{var ag=au[aw].fields;var am=ag[aH];if(!am){ag[aH]={};am=ag[aH]}am[l]=ac}}}}}else{}}}for(aw in au){if(!ai[aw]){delete au[aw]}}af=[];var at={};at.contacts=[];at.groups=[];at.result=[];for(aw in au){aj=au[aw].rec;if(aj.address){at.result.push(aj)}else{if(aj.contactId){at.contacts.push(aj)}else{if(aj.groupId){at.groups.push(aj)}}}}aG=this.generateDataCache(at,true);this._resultsCache=aG}var ax=this._autocompleteResultsForMatches(aG,au);this._lastSearchedPrefix=ak;this._lastSearchedDataCache=aG;return ax},sendRecentRecipientsRequest:function(){this.set("recentsRequestIsOutstanding",YES);this.set("recentsRequestHasCompleted",NO);this.set("recentsDataIsLoaded",null);var h={onComplete:"recentRecipientsRequestCompleted",onSuccess:"recentRecipientsRequestSucceeded",type:CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_RECENT_RECIPIENTS};var j="/co/recents";var g=new Date();if(!this._recentsReqCount){this._recentsReqCount=1}var f={jsonrpc:"2.0",id:g.getTime()+"/"+this._recentsReqCount++,method:"list"};var k=CK.Request.postUrl(j,f);k.set("serviceName","reminders");k.set("useCrossDomain",YES);k.set("isJSON",YES);k.notify(0,this,this.requestDidComplete,h).send()},sendContactsRequest:function(){this.set("contactsRequestIsOutstanding",YES);this.set("contactsRequestHasCompleted",NO);this.set("contactsDataIsLoaded",null);var p={onComplete:"contactsRequestCompleted",onSuccess:"contactsRequestSucceeded",type:CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_CONTACTS};var q="/co/addressbook?";var k=this.get("dataRefreshNeeded");if(!k&&(this._lastSyncToken!==null&&this._lastPrefToken!==null)){var s=this.get("keepDataInSync");if(this.get("keepDataInSync")===YES){var t=this.get("syncInterval");if(this._skipSyncCount<t){this.invokeLater(function(){this.set("contactsRequestIsOutstanding",NO);this.set("contactsRequestHasCompleted",YES);this.set("contactsDataIsLoaded",YES);this._haveDelegatePerform("requestDidSucceed",CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_CONTACTS)},1);this._skipSyncCount++;return}else{q+="syncToken="+this._lastSyncToken+"&prefToken="+this._lastPrefToken+"&";this.set("syncTokenInUse",YES);SC.debug("ContactsAutocompleteDataSource sending data sync request.")}}}else{this.set("dataRefreshNeeded",NO);this.set("syncTokenInUse",NO)}this._nameDisplayOrder=this.getPath("delegate.nameDisplayOrder");this._sortOrder=this.getPath("delegate.contactsSortOrder");var l=this.getPath("delegate.locale");q+="order="+this._sortOrder+"&locale="+l;var m=CK.CONTACTS_AUTOCOMPLETE_DEBUG_CONTACTS_FAKE_REPLY;if(m){var o=SC.Response.create(m);this.invokeLater(this.requestDidComplete,1,o,p)}else{var n=CK.ContactsAutocompleteRequest.getUrl(q);n.set("serviceName","reminders");n.set("isJSON",NO);n.notify(0,this,this.requestDidComplete,p).send()}this._skipSyncCount=0},addContactRequest:function(e,f){this.set("contactsRequestIsOutstanding",YES);this.set("addContactRequestHasCompleted",NO);if(this._dataCache===null){this._enqueuePendingContact(e);this._lastSyncToken=null;this.set("dataRefreshNeeded",YES);this.sendContactsRequest()}else{var d=this._buildAddContactRequest(e,f);d.send()}},_generateGUID:function(){var e=CW.UUID();var d=this._dataCache.guidToRecordMapping;while(d[e]){e=CW.UUID()}return e},_buildAddContactRequestURL:function(d){var e="/co/contacts/";if(d){e+=d+"/?"}else{e+="?"}if(this._lastSyncToken!==null&&this._prefSyncToken!==null){this.set("syncTokenInUse",YES);e+="syncToken="+this._lastSyncToken+"&prefToken="+this._lastPrefToken}else{this.set("syncTokenInUse",NO)}return e},_buildAddContactRequest:function(j,l){var h=this._generateGUID();j.contactId=h;var o={contacts:[j]},m=this._buildAddContactRequestURL(l),n=CK.ContactsAutocompleteRequest.postUrl(m,SC.json.encode(o));n.set("serviceName","contacts");n.set("contact",j);n.set("isJSON",NO);var k={onError:"addContactRequestFailed",onComplete:"contactsRequestCompleted",onSuccess:"addContactRequestSucceeded",type:CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_ADD_CONTACT};n.notify(0,this,this.requestDidComplete,k);return n},_sendPendingContactRequests:function(){if(this._pendingAddContacts.get("length")>0){var b=this._pendingAddContacts.popObject();this.addContactRequest(b)}},_enqueuePendingContact:function(b){this._pendingAddContacts.pushObject(b)},uploadVCard:function(h){this.set("uploadVCardDidError",NO);this.set("uploadVCardRequestHasCompleted",NO);this.set("uploadVCardFailureErrorCode",null);var g={onError:"uploadVCardRequestFailed",onComplete:"contactsRequestCompleted",onSuccess:"uploadVCardRequestSucceeded",type:CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_ADD_CONTACT};var e="/co/import/card/?";if(this._lastSyncToken!==null&&this._prefSyncToken!==null){this.set("syncTokenInUse",YES);e+="syncToken="+this._lastSyncToken+"&prefToken="+this._lastPrefToken}else{this.set("syncTokenInUse",NO)}var f=CK.Request.postUrl(e);f.set("serviceName","contacts");f.set("isJSON",NO);f.set("body",h);f.notify(0,this,this.requestDidComplete,g).send()},uploadVCardRequestSucceeded:function(e,d){this.set("uploadVCardRequestHasCompleted",YES);this._lastSyncToken=null;this.set("dataRefreshNeeded",YES);this.sendContactsRequest();this._haveDelegatePerform("requestDidSucceed",d)},uploadVCardRequestFailed:function(b){this.set("uploadVCardDidError",YES);this.set("uploadVCardRequestHasCompleted",YES);this.set("uploadVCardFailureErrorCode",b.get("status"))},_dataCache:null,_groupsToResolve:[],_storedRecords:[],_lastSearchedPrefix:null,_lastSearchedDataCache:null,_mostRecentAutocompletionQuery:null,_sortOrder:CK.CONTACTS_AUTOCOMPLETE_SORT_ORDER_LAST_FIRST,_nameDisplayOrder:CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_FIRST_LAST,_lastSyncToken:null,_lastPrefToken:null,_pendingAddContacts:[],_skipSyncCount:0,_redirectCount:0,MAX_REDIRECT:5,REDIRECT_RESPONSE_TEXT:"<h1>Redirect</h1>",INTERVAL_XHR_REDUCED_TIMEOUT:10000,INTERVAL_XHR_TIMEOUT_THRESHOLD:15000,contactsRequestCompleted:function(){this.set("contactsRequestIsOutstanding",NO)},recentRecipientsRequestCompleted:function(){this.set("recentsRequestIsOutstanding",NO)},recentRecipientsRequestSucceeded:function(e,f){this.set("recentsRequestHasCompleted",YES);if(e&&e.result){var d=this.generateDataCache(e);this._dataCache=d}this.set("recentsDataIsLoaded",YES);this.set("allDataIsLoadedForQuery",YES);this._haveDelegatePerform("requestDidSucceed",f)},contactsRequestSucceeded:function(e,f){this.set("contactsRequestHasCompleted",YES);if(e&&e.contacts){var d=this.generateDataCache(e);this._dataCache=d;this.resolveGroupsMembershipAsPossibleWithLoadedData(d)}this.set("contactsDataIsLoaded",YES);this.set("allDataIsLoadedForQuery",YES);this._sendPendingContactRequests();this._haveDelegatePerform("requestDidSucceed",f)},addContactRequestSucceeded:function(e,d){this.set("addContactDidError",NO);this.set("addContactRequestHasCompleted",YES);this._lastSyncToken=null;this.set("dataRefreshNeeded",YES);this.sendContactsRequest();this._haveDelegatePerform("requestDidSucceed",d)},addContactRequestFailed:function(g,l,m){var j=g.get("status");if(j==420||j==421){var k=g.get("request"),h=k.get("contact");if(h){this._enqueuePendingContact(h)}}else{this.set("addContactDidError",YES);this.set("addContactRequestHasCompleted",YES);if(!m){m=g.encodedBody()}SC.error("Autocomplete request failed with error %@",m)}},requestDidComplete:function(d,f){var e=CK.CONTACTS_AUTOCOMPLETE_DEBUG_REPLY_LATENCY;if(e){this.invokeLater(this._requestDidComplete,e,d,f)}else{this._requestDidComplete(d,f)}},_requestDidComplete:function(S,e){var O=e.type;var T=e.onComplete;if(T){this.tryToPerform(T,S,O)}this._haveDelegatePerform("requestDidComplete",O);var R=NO,B=S.get("status"),I=NO,A,L,H;if(O===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_RECENT_RECIPIENTS){L=S.get("body");var D=S.rawRequest;if(D&&D.responseText){var G=D?D.status:0,E=SC.typeOf(L);var K=Math.floor(G/100);var N=S.get("request");if(((200===G&&(this.REDIRECT_RESPONSE_TEXT===D.responseText||E===SC.T_ERROR))||(K===5)||G===0)&&this._redirectCount<this.MAX_REDIRECT){this._redirectCount++;SC.warn("willReceive: Status:%@, Request:%@, wmsid: %@".fmt(G,N.get("address"),CK.readCookie("wmsid")));SC.warn("Got HTTP "+G+" : Redirecting request: "+N.get("address")+" : Redirect count:"+this._redirectCount);S.cancel();if(K===5||G===0){var C=new Date().getTime(),J=C-this._sentTime;if(J>this.INTERVAL_XHR_TIMEOUT_THRESHOLD){N.timeoutAfter(this.INTERVAL_XHR_REDUCED_TIMEOUT)}}N.send()}else{this._redirectCount=0}}else{SC.debug("Autocomplete received invalid server response for recents.")}}var P=Math.floor(B/100)*100;if(P!==200){R=YES;if(O===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_CONTACTS){switch(B){case 420:I=YES;SC.debug("Contacts request syncToken out of date, data refresh needed.");break;case 421:I=YES;SC.debug("Contacts request prefToken out of date, data refresh needed.");break}}else{if(O===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_RECENT_RECIPIENTS){}}}S.setPath("request.isJSON",YES);A=S.get("encodedBody");if(A){if(A.indexOf("<")===0){R=YES;H="CK.Autocomplete.Error.Generic"}else{if(I){H=A}else{if(A==="not found"){R=YES;H="CK.Autocomplete.Error.NotFound"}else{try{L=S.get("body")}catch(z){R=YES}if(!L){R=YES}else{if(L.errorValue){H=L.message;R=YES}}}}}}else{R=YES}if(O===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_CONTACTS){if(!R){var F=this.get("syncTokenInUse");if(L.syncToken){this._lastSyncToken=L.syncToken}else{if(F&&A==="{}"){SC.debug("ContactsAutocompleteDataSource sync response: dataCache in sync")}else{if(O!=CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_RECENT_RECIPIENTS){R=YES;SC.warn("Autocomplete  contacts response error:  no sync token found.")}}}if(L.prefToken){this._lastPrefToken=L.prefToken}else{if(F&&A!=="{}"){SC.warn("Autocomplete contacts response error: no prefToken found.")}}}}if(R){if(I){this.set("dataRefreshNeeded",YES);this.sendContactsRequest()}else{if(!H){H="CK.Autocomplete.Error.Generic"}if(L){SC.warn("Autocomplete server error:  %@",L.statusString)}var M=e.onError;if(M){this.tryToPerform(M,S,O,H)}else{this.requestDidError(S,O,H)}}}else{var Q=e.onSuccess;if(Q){this.tryToPerform(Q,L,O)}else{this.requestDidSucceed(O)}}},requestDidSucceed:function(b){this._haveDelegatePerform("requestDidSucceed",b)},requestDidError:function(j,n,o){var k="Contacts";this.set("currentAutocompletionQuery",null);if(n===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_RECENT_RECIPIENTS){this.set("recentsDataIsLoaded",NO);k="Recents"}else{this.set("contactsDataIsLoaded",NO)}var e=o;if(!e){try{e=j.get("body")}catch(l){e="CK.Autocomplete.Error.Generic"}}var m=this._haveDelegatePerform("requestDidError",n,e);if(!m){SC.error(k+" Autocomplete request failed with error %@",e)}},generateDataCache:function(O,T){var M,j=this.__dummy_prefix__;M=this.initializeDataCache();if(this._dataCache&&!T){if(O.contacts){M.recents=this._dataCache.recents}else{if(O.result){M.contacts=this._dataCache.contacts;M.groups=this._dataCache.groups}}}var N=YES,K=this.getPath("delegate.autocompleteTextField");if(K){N=K.get("shouldMatchGroups")}N=YES;if(O.result){M=this._processRecords(O.result,"Recents",M)}if(O.contacts){M=this._processRecords(O.contacts,"Contact",M)}if(O.groups){M=this._processRecords(O.groups,"Group",M)}M.guidToRecordMapping=SC.merge(M.recents.guidToRecordMapping,M.contacts.guidToRecordMapping,M.groups.guidToRecordMapping);var E,F,G,S,A,Q,J,V,P;var I,D,U,H,C,L,R,k;for(E=0;E<3;++E){switch(E){case 0:I="recents";J=CK.CONTACTS_AUTOCOMPLETE_RECENT_RECIPIENTS_MATCH_FIELDS;break;case 1:I="contacts";J=CK.CONTACTS_AUTOCOMPLETE_CONTACT_MATCH_FIELDS;break;case 2:I="groups";J=CK.CONTACTS_AUTOCOMPLETE_GROUP_MATCH_FIELDS;break}A=M[I];D=J.length;for(F=0;F<D;++F){V=J[F];Q=A[V];U=Q.values;C=Q.temp;if(!C){continue}U.sort();L=[];R=U.length;for(G=0;G<R;++G){H=U[G];k=C[j+H];L.push(k)}Q.records=L;delete Q.temp}}return M},_processRecords:function(R,ad,ab){if(!SC.isArray(R)){SC.debug("Invalid %@ records found, cannot process.",ad);return ab}var X=ab.guidToRecordMapping,ac=R.length,Z,U,V,W,j,ag,N,af,O,aj,S,l,K,Q,P,k,Y=this.__dummy_prefix__;for(U=0;U<ac;++U){ag=R.objectAt(U);Q=null;if(SC.typeOf(ag)===SC.T_HASH){if(ad==="Contact"){var M=ag.emailAddresses;if(!M||!SC.isArray(M)){continue}for(var T=0;T<M.length;++T){if(SC.empty(M[T].field)){M.splice(T--,1)}}if(M.length<=0){continue}Q=ag.normalized;N=ab.contacts;O=CK.CONTACTS_AUTOCOMPLETE_CONTACT_MATCH_FIELDS;K=ag.contactId}else{if(ad==="Group"){if(!ag.contactIds){continue}N=ab.groups;O=CK.CONTACTS_AUTOCOMPLETE_GROUP_MATCH_FIELDS;K=ag.groupId;l=ag.name;if(l){Q=l.removeDiacritics().toLowerCase()+":"}}else{if(ad==="Recents"){N=ab.recents;O=CK.CONTACTS_AUTOCOMPLETE_RECENT_RECIPIENTS_MATCH_FIELDS;K="recent_"+ag.address;ag.guid=K;l=ag.name;k=O.length;Q="";var aa,A;for(j=0;j<k;++j){aj=O[j];aa=ag[aj];if(aa){Q+=aa.removeDiacritics().toLowerCase()}Q+=":"}}else{continue}}}}else{SC.debug("Invalid %@ record found, skipping.",ad);continue}if(!Q){continue}if(K){N.guidToRecordMapping[K]=ag}P=Q.split(":");k=O.length;var ae,ai;for(V=0;V<k;++V){aj=O[V];var L=ag[aj];if(L){if(aj==="emailAddresses"){var ah=L.length;for(W=0;W<ah;++W){Q=P[V+W];if(!Q||Q==="NULL"){continue}af=N[aj];ae=af.temp;if(!ae){ae={};af.temp=ae}ai=ae[Y+Q];if(ai){ai.push({idx:W,rec:ag})}else{ae[Y+Q]=[{idx:W,rec:ag}];af.values.push(Q)}}}else{Q=P[V];if(!Q||Q==="NULL"){continue}af=N[aj];ae=af.temp;if(!ae){ae={};af.temp=ae}ai=ae[Y+Q];if(ai){ai.push(ag)}else{ae[Y+Q]=[ag];af.values.push(Q)}}}}}return ab},initializeDataCache:function(){var q={recents:{},contacts:{},groups:{},guidToRecordMapping:{},lastMatch:null};for(var n=0;n<3;++n){var o,j;switch(n){case 0:o="recents";j=CK.CONTACTS_AUTOCOMPLETE_RECENT_RECIPIENTS_MATCH_FIELDS;break;case 1:o="contacts";j=CK.CONTACTS_AUTOCOMPLETE_CONTACT_MATCH_FIELDS;break;case 2:o="groups";j=CK.CONTACTS_AUTOCOMPLETE_GROUP_MATCH_FIELDS;break}var m=q[o];var k=j.length;for(var p=0;p<k;++p){var l=j[p];m[l]={values:[],records:[]}}m.guidToRecordMapping={}}return q},resolveGroupsMembershipAsPossibleWithLoadedData:function(x){var v=x.guidToRecordMapping;if(!v){v={}}var w=x.groups;if(w){var o,p,n,s,j,q,t;for(o in w){p=w[o].records;if(p){n=p.length;for(q=(n-1);q>=0;--q){s=p[q];j=s.length;for(t=(j-1);t>=0;--t){var u=s[t];this.resolveGroupMembershipAsPossibleWithLoadedData(u,v);if(u.resolvedContacts.length<=0){delete v[u.groupId];s.splice(t,1)}}}}}}},resolveGroupMembershipAsPossibleWithLoadedData:function(z,A,B){var D=z.resolvedContacts;if(D&&D!==-1){return}if(!B){B=0}D=[];var s={},x=z.contactIds,q,C,u,w,y;if(x){var j=x.length;for(w=(j-1);w>=0;--w){var t=x[w],v=A[t];if(!v){x.splice(w,1)}else{if(!s[t]){D.push(v);s[t]=YES}}}}else{}z.resolvedContacts=D},resolveRecentRecipientWithLoadedContacts:function(k,n){if(!k){return[]}var o,h,m,l,j;m=k.length;l=n.length;if(m<1||l<1){return[]}for(o=0;o<m;o++){for(h=0;h<l;h++){if(k[o].secondaryLabel==n[h].secondaryLabel){k[o].previewValue=n[h].previewValue;k[o].primaryLabel=n[h].primaryLabel;k[o].secondaryLabel=n[h].secondaryLabel;k[o].value=n[h].value;n.splice(h,1);l=n.length;break}}}},_haveDelegatePerform:function(e,h,f){var g=this.get("delegate");if(g){return g.tryToPerform(e,h,f)}else{return NO}},_indexForString:function(p,s){var m;var l=false;var k;var t=0;var n=p.length-1;while(!l&&(t<=n)){m=false;k=Math.floor((t+n)/2);var o=p[k];if(o===s){l=true}else{if(o<s){t=k+1;m=true}else{n=k-1}}}var q=k;if(m){++q}return q},_sortRecentsResultsByTimeStamp:function(b){if(b.length>1){b.sort(function(a,h){var j=a.timestamps.length;var l=h.timestamps.length;if(j>l){return -1}else{if(j<l){return 1}}a.timestamps.sort(function(e,d){return d-e});h.timestamps.sort(function(e,d){return d-e});var k=a.timestamps[j-1];var m=h.timestamps[l-1];return k==m?0:(k>m?-1:1)})}return b},_autocompleteResultsForMatches:function(N,E){var L=[];var J=[];var P=YES,M=this.getPath("delegate.autocompleteTextField");if(M){P=M.get("shouldMatchGroups")}var O=N.guidToRecordMapping,K=this._sortOrder,I,Q,R,U,G,T;for(I in E){G=E[I].rec;R=E[I].fields;if(G.address){T="Recents";O=N.recents.guidToRecordMapping}else{if(G.contactId){T="Contact";O=N.contacts.guidToRecordMapping}else{if(G.groupId){T="Group";O=N.groups.guidToRecordMapping}}}U=O[I];if(U){Q=null;if(T==="Recents"){Q=this._autocompleteResultsForMatchedRecent(U,R);J.push(Q)}else{if(T==="Contact"){var B=0,A=U.emailAddresses,S,H,C,z;for(z in R){++B}var D=R.emailAddresses;if(B===1&&D){for(H in D){C=D[H];S=A[H];Q=this._autocompleteResultsForMatchedContact(U,R,S,C);L.push(Q)}}else{var V=A.length;for(var F=(V-1);F>=0;--F){S=A[F];C=null;if(D){C=D[F]}Q=this._autocompleteResultsForMatchedContact(U,R,S,C);L.push(Q)}}}else{if(P&&T==="Group"){Q=this._autocompleteResultsForMatchedGroup(U,R);L.push(Q)}else{continue}}}}}this.resolveRecentRecipientWithLoadedContacts(J,L);if(J.length>0){J=this._sortRecentsResultsByTimeStamp(J);L=J.concat(L)}return L},_autocompleteResultsForMatchedContact:function(W,S,X,ae){var aq,au;aq=X.label;au=X.field;var an,R,at,ag,ac,aa,U,T,ar,al;var V=W.firstName;var ah=W.lastName;var Y=W.middleName;var N=W.nickname;var af=W.companyName;if(!V){V=""}if(!ah){ah=""}if(!N){N=""}if(!af){af=""}var am=S.firstName;var ao=S.lastName;var ai=S.nickname;var av=S.middleName;var aw=S.companyName;var Q=am?am.length:0;var ab=ao?ao.length:0;var Z=ai?ai.length:0;var ap=av?av.length:0;var ad=aw?aw.length:0;var A=ae?ae.length:0;if(this._nameDisplayOrder===CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_LAST_FIRST){ar=V;V=ah;ah=ar;ar=am;am=ao;ao=ar;ar=Q;Q=ab;ab=ar}var aj=NO;if(CK.stringIsCJK(V)&&CK.stringIsCJK(ah)){aj=YES}var O;if(W.isCompany){O=YES}else{O=NO}if(O){an=af;R=au;at="%@ <%@>";ac=[af,au];if(ad){ag="%@ (%@ %@) <%@>";aa=[aw+af.substr(ad),V,ah,au]}else{if(Q){ag="%@ %@ (%@) <%@>";aa=[am+V.substr(Q),ah,af,au]}else{if(ab){ag="%@ %@ (%@) <%@>";aa=[ao+ah.substr(ab),V,af,au]}else{if(Z){ag="%@ (%@ %@) (%@) <%@>";aa=[ai+N.substr(Z),V,ah,af,au]}else{if(A){ag="%@ %@ (%@ %@)";aa=[ae+au.substr(A),af,V,ah]}else{if(ap){ag="%@ (%@ %@) (%@) <%@>";aa=[av+Y.substr(ap),V,ah,af,au]}else{SC.warn("Don't know what was matched in autocomplete. This case should be handled better.");ag="";aa=[];for(al in S){ag+="%@ ";aa.push(S[al])}ag+="(%@)";aa.push(af)}}}}}}}else{if(V){if(ah){if(aj){an=V+ah}else{an=V+" "+ah}}else{an=V}}else{if(ah){an=ah}}R=au;if(aj){at="%@%@ <%@>"}else{at="%@ %@ <%@>"}ac=[V,ah,au];if(Q&&(Q===V.length)&&ab){ag="%@ %@ <%@>";aa=[am,ao+ah.substr(ab),au]}else{if(ab&&(ab===ah.length)&&Q){ag="%@ %@ <%@>";aa=[ao,am+V.substr(Q),au]}else{if(Z&&(Z===N.length)&&ab){ag="%@ %@ <%@>";aa=[ai+N.substr(Z),ao+ah.substr(ab),au]}else{if(Q){ag="%@ %@ <%@>";aa=[am+V.substr(Q),ah,au]}else{if(ab){ag="%@ %@ <%@>";aa=[ao+ah.substr(ab),V,au]}else{if(Z){ag="%@ (%@ %@) <%@>";aa=[ai+N.substr(Z),V,ah,au]}else{if(ad){ag="%@ (%@ %@) <%@>";aa=[aw+af.substr(ad),V,ah,au]}else{if(A){ag="%@ (%@ %@)";aa=[ae+au.substr(A),V,ah]}else{if(ap){ag="%@ (%@ %@) <%@>";aa=[av+Y.substr(ap),V,ah,au]}else{SC.warn("Don't know what was matched in autocomplete. This case should be handled better.");ag="";aa=[];for(al in S){ag+="%@ ";aa.push(S[al])}ag=ag.trim()}}}}}}}}}}U=String.prototype.fmt.apply(at,ac);T=String.prototype.fmt.apply(ag,aa);U=U.replace("","");T=T.replace("","");U=U.replace(/\(\s*\)/g,"");T=T.replace(/\(\s*\)/g,"");U=U.replace(/\s+/g," ");T=T.replace(/\s+/g," ");var P=/([^,<>]*[,<>].*)( <[^<]*)$/;U=U.replace(P,'"$1"$2');var ak=CK.AutocompleteResult.create({primaryLabel:an,secondaryLabel:R,value:U,previewValue:T,category:aq});return ak},_autocompleteResultsForMatchedRecent:function(J,E){var G=J.address;if(!SC.isArray(J.timestamps)){J.timestamps=[]}var C,I,F,H,y,K,z,B,x,v;var u=J.name;if(!u){u=G}var L=E.name;var A=L?L.length:0;C=u;I=G;F="%@ <%@>";y=[u,G];H="%@ <%@>";K=[L+u.substr(A),G];z=String.prototype.fmt.apply(F,y);B=String.prototype.fmt.apply(H,K);z=z.replace("","");B=B.replace("","");z=z.replace(/\(\s*\)/g,"");B=B.replace(/\(\s*\)/g,"");z=z.replace(/\s+/g," ");B=B.replace(/\s+/g," ");var w=/([^,<>]*[,<>].*)( <[^<]*)$/;z=z.replace(w,'"$1"$2');var D=CK.AutocompleteResult.create({primaryLabel:C,secondaryLabel:I,value:z,previewValue:B,timestamps:J.timestamps,category:"CK.Autocomplete.Category.RECENTS".loc()});return D},_autocompleteResultsForMatchedGroup:function(X,T){var O=T.name;var G=O.length;var J=X.name;var U=X.contactIds.length;var H=null;var R=X.resolvedContacts;if(R){var Y=[];var V=R.length;for(var A=0;A<V;++A){var D=R[A];var Z=D.firstName;if(!Z){Z=""}var L=D.lastName;if(!L){L=""}var W="";var j=D.emailAddresses;if(j){var E=null;var I=-1;var P=j.length;for(var F=0;F<P;++F){var M=j[F];var Q=M.label;W=M.field;var K=0;if(Q){switch(Q.toLowerCase()){case"main":K=3;break;case"home":K=2;break;case"work":K=1;break;default:K=0}}if(K>I){E=W;I=K}}W=E}var S="%@ %@ <%@>".fmt(Z,L,W);if(this._nameDisplayOrder===CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_LAST_FIRST){S="%@ %@ <%@>".fmt(L,Z,W)}S=S.replace("","");S=S.replace(/\(\s*\)/g,"");S=S.replace(/\s+/g," ");Y.push(S)}H=Y.join(", ")}var N=CK.AutocompleteResult.create({primaryLabel:J,secondaryLabel:(U===1)?"CK.Autocomplete.GroupSecondaryLabel.Single".loc():"CK.Autocomplete.GroupSecondaryLabel.Multiple".loc(U),category:null,value:H,previewValue:O+J.substr(G)+" ("+U+")",isGroup:YES});return N}});sc_require("data_sources/contacts_autocomplete");CK.ContactsAutocompleteController=SC.Object.extend({dataSource:CK.ContactsAutocompleteDataSource,includeRecentRecipients:NO,autocompleteField:null,autocompleteItemsBinding:"*autocompleteField.autocompleteItems",autocompleteCandidateValueBinding:"*autocompleteField.autocompleteCandidateValue",minimumCharacters:2,autocompletionDelay:100,progressDisplayDelay:1000,nameDisplayOrder:null,contactsSortOrder:CK.CONTACTS_AUTOCOMPLETE_SORT_ORDER_LAST_FIRST,trace:YES,initial:"CA Initial","CA Initial":function(e){var f,d;switch(e.sig){case"autocompleteFieldBecameVisible":this[this.stateKey]="CA At Least One Field Visible";return CK.Statechart.EVT_TRANSITION_RES;case"autocompleteFieldWasFocused":d=e.arg1;this.set("autocompleteField",d);return CK.Statechart.handled()}return undefined}.state(),"CA At Least One Field Visible":function(e){var f;switch(e.sig){case"enter":f=this.get("dataSource");if(f){if(this.get("includeRecentRecipients")){if(!f.get("recentsRequestHasCompleted")&&!f.get("recentsRequestIsOutstanding")){f.sendRecentRecipientsRequest()}}if(!f.get("contactsRequestHasCompleted")&&!f.get("contactsRequestIsOutstanding")){f.sendContactsRequest()}}return CK.Statechart.handled();case"defaultTransition":f=this.get("dataSource");if(f){if(this.get("includeRecentRecipients")&&f.get("recentsRequestHasCompleted")&&f.get("contactsRequestHasCompleted")&&f.get("allDataIsLoaded")){this[this.stateKey]="CA Necessary Data Loaded";return CK.Statechart.EVT_TRANSITION_RES}else{if(f.get("contactsRequestHasCompleted")&&f.get("allDataIsLoaded")){this[this.stateKey]="CA Necessary Data Loaded";return CK.Statechart.EVT_TRANSITION_RES}else{this[this.stateKey]="CA Necessary Data Not Loaded";return CK.Statechart.EVT_TRANSITION_RES}}}else{SC.error("Cannot process autocomplete requests because there is no data source");this.displayError("CK.Autocomplete.Error.Internal");this[this.stateKey]="CA Unrecoverable Error";return CK.Statechart.EVT_TRANSITION_RES}return CK.Statechart.handled();case"autocompleteFieldWasFocused":var d=e.arg1;this.set("autocompleteField",d);return CK.Statechart.handled()}return undefined}.state(),"CA Unrecoverable Error":function(e){this.clearProgressIfDisplayed();switch(e.sig){case"autocompleteFieldWasBlurred":this.clearErrorIfDisplayed();return CK.Statechart.handled();case"autocompleteFieldWasFocused":var d=e.arg1;this.set("autocompleteField",d);this[this.stateKey]="CA At Least One Field Visible";return CK.Statechart.EVT_TRANSITION_RES}return undefined}.state(),"CA Necessary Data Loaded":function(f){var e,h;switch(f.sig){case"enter":this.clearProgressIfDisplayed();e=this.get("autocompleteCandidate");if(e){if(!this.get("_autocompletionTimer")){this.scheduleLookupTimer()}}return CK.Statechart.handled();case"autocompleteFieldWasFocused":var g=this.get("dataSource");if(g){if(g.get("keepDataInSync")&&!g.get("contactsRequestIsOutstanding")){g.sendContactsRequest()}}h=f.arg1;this.set("autocompleteField",h);this[this.stateKey]="CA At Least One Field Visible";return CK.Statechart.EVT_TRANSITION_RES;case"searchNarrowed":e=this.get("autocompleteCandidate");if(e){this.invalidateScheduledLookupTimer();this.scheduleLookupTimer()}return CK.Statechart.handled();case"searchWidened":this.invalidateScheduledLookupTimer();e=this.get("autocompleteCandidate");if(e){this.scheduleLookupTimer()}return CK.Statechart.handled();case"lookupTimerFired":this[this.stateKey]="CA Searching Loaded Data";return CK.Statechart.EVT_TRANSITION_RES}return undefined}.state("CA At Least One Field Visible"),"CA Searching Loaded Data":function(g){var j;switch(g.sig){case"enter":this.invalidateScheduledLookupTimer();this.performSearchOfLoadedData();return CK.Statechart.handled();case"searchNarrowed":this.performSearchOfLoadedData();return CK.Statechart.handled();case"searchWidened":this.invalidateScheduledLookupTimer();j=this.get("autocompleteField");if(j){j.hideAutocompleteMenuPane()}this.set("autocompleteItems",null);var h=this.get("dataSource");if(h){if(h.get("allDataIsLoaded")){this[this.stateKey]="CA Necessary Data Loaded";return CK.Statechart.EVT_TRANSITION_RES}else{var k=h.get("allDataIsLoadedForQuery");var f=this.get("autocompleteCandidate");if(f){f=f.removeDiacritics().toLowerCase().split(" ")[0];if(f.indexOf(k)===0){this[this.stateKey]="CA Searching Loaded Data";return CK.Statechart.EVT_TRANSITION_RES}}}}this[this.stateKey]="CA Necessary Data Not Loaded";return CK.Statechart.EVT_TRANSITION_RES;case"autocompleteFieldWasFocused":j=g.arg1;this.set("autocompleteField",j);return CK.Statechart.handled()}return undefined}.state("CA Necessary Data Loaded"),"CA Necessary Data Not Loaded":function(h){var j,m,g;switch(h.sig){case"enter":j=this.get("dataSource");if(j){if(this.get("includeRecentRecipients")){if(!j.get("recentsRequestHasCompleted")&&!j.get("recentsRequestIsOutstanding")){j.sendRecentRecipientsRequest()}}if(!j.get("contactsRequestHasCompleted")&&!j.get("contactsRequestIsOutstanding")){j.sendContactsRequest()}return CK.Statechart.handled()}m=this.get("autocompleteCandidate");if(m){if(!this.get("_autocompletionTimer")){this.scheduleLookupTimer()}}return CK.Statechart.handled();case"searchNarrowed":m=this.get("autocompleteCandidate");if(m){this.invalidateScheduledLookupTimer();this.scheduleLookupTimer()}return CK.Statechart.handled();case"searchWidened":this.invalidateScheduledLookupTimer();m=this.get("autocompleteCandidate");if(m){this.scheduleLookupTimer()}return CK.Statechart.handled();case"lookupTimerFired":m=this.get("autocompleteCandidate");if(m){var l=this.getPath("dataSource.allDataIsLoadedForQuery");m=m.removeDiacritics().toLowerCase().split(" ")[0];if(l&&m.indexOf(l)===0){this[this.stateKey]="CA Necessary Data Loaded";return CK.Statechart.EVT_TRANSITION_RES}}return CK.Statechart.handled();case"autocompleteFieldWasFocused":var k=h.arg1;this.set("autocompleteField",k);this[this.stateKey]="CA Necessary Data Not Loaded";return CK.Statechart.EVT_TRANSITION_RES;case"requestDidSucceed":g=h.arg1;if(g===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_CONTACTS){j=this.get("dataSource");if(j){if(j.get("allDataIsLoaded")){this[this.stateKey]="CA Necessary Data Loaded";return CK.Statechart.EVT_TRANSITION_RES}else{return CK.Statechart.handled()}}else{SC.error("Cannot process autocomplete requests because there is no data source");this.displayError("CK.Autocomplete.Error.Internal");this[this.stateKey]="CA Unrecoverable Error";return CK.Statechart.EVT_TRANSITION_RES}}else{if(g===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_RECENT_RECIPIENTS){j=this.get("dataSource");if(j){if(j.get("allDataIsLoaded")){this[this.stateKey]="CA Necessary Data Loaded";return CK.Statechart.EVT_TRANSITION_RES}else{return CK.Statechart.handled()}}}else{if(g===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_LOOKUP){SC.error("We should never receive a reply to a lookup request while in the 'CA Necessary Data Not Loaded' state");this[this.stateKey]="CA Unrecoverable Error";return CK.Statechart.EVT_TRANSITION_RES}else{SC.error("Unknown autocomplete request type:  %@",g);this[this.stateKey]="CA Unrecoverable Error";return CK.Statechart.EVT_TRANSITION_RES}}}return CK.Statechart.handled();case"requestDidError":g=h.arg1;if(g===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_CONTACTS){this.displayError(h.arg2);this[this.stateKey]="CA Unrecoverable Error";return CK.Statechart.EVT_TRANSITION_RES}else{if(g===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_LOOKUP){SC.error("We should never receive an error report for a lookup request while in the 'CA Necessary Data Not Loaded' state");this[this.stateKey]="CA Unrecoverable Error";return CK.Statechart.EVT_TRANSITION_RES}else{if(g===CK.CONTACTS_AUTOCOMPLETE_REQUEST_TYPE_RECENT_RECIPIENTS){SC.error("Recents recipients request error.");this[this.stateKey]="CA Unrecoverable Error";return CK.Statechart.EVT_TRANSITION_RES}else{SC.error("Unknown autocomplete request type:  %@",g);this[this.stateKey]="CA Unrecoverable Error";return CK.Statechart.EVT_TRANSITION_RES}}}return CK.Statechart.handled()}return undefined}.state("CA At Least One Field Visible"),_previousAutocompleteCandidateValue:null,_lastSentAutocompletionCandidate:null,_autocompletionTimer:null,init:function(){arguments.callee.base.apply(this,arguments);var j=this.get("dataSource");if(j&&j.isClass){j=j.create();this.set("dataSource",j);j.set("delegate",this)}var h;if(window.SteedOS){h=SteedOS.getAppPreferences("contacts")}var k=CK.getCurrentLocaleInISOFormat(),f,g;if(!k){k="en_US"}if(h){if(h.displayOrderBy){g=h.displayOrderBy}if(h.displayFields){f=h.displayFields;if(f!==CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_LAST_FIRST&&f!==CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_FIRST_LAST){f=CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_FIRST_LAST}}else{if(k==="ja_JP"||k==="ko_KR"||k==="zh_CN"||k==="zh_TW"||k==="hu_HU"){g=CK.CONTACTS_AUTOCOMPLETE_SORT_ORDER_FIRST_LAST;f=CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_LAST_FIRST}else{g=CK.CONTACTS_AUTOCOMPLETE_SORT_ORDER_LAST_FIRST;f=CK.CONTACTS_AUTOCOMPLETE_NAME_DISPLAY_ORDER_FIRST_LAST}}}this.set("contactsSortOrder",g);this.set("nameDisplayOrder",f);this.set("locale",k);SC.debug("ContactsAutocomplete name order preference set: '%@'",f)},autocompleteFieldDidChange:function(){this.set("_previousAutocompleteCandidateValue",null);this.set("_autocompletionTimer",null);this.set("_lastSentAutocompletionCandidate",null);this.notifyPropertyChange("autocompleteCandidateValue")}.observes("autocompleteField"),autocompleteCandidate:function(){var d=this.get("autocompleteCandidateValue"),e=this.get("minimumCharacters");if(d&&(d.length>=e)){return d}else{return null}}.property("autocompleteCandidateValue","minimumCharacters").cacheable(),autocompleteCandidateValueDidChange:function(){var d=this.get("autocompleteCandidateValue");var e=this.get("_previousAutocompleteCandidateValue");if(e){if(d&&e.length<d.length&&d.indexOf(e)===0){this.tryToPerform("searchNarrowed")}else{this.tryToPerform("searchWidened")}}else{if(d&&d.length>0){this.tryToPerform("searchNarrowed")}}this.set("_previousAutocompleteCandidateValue",d)}.observes("autocompleteCandidateValue"),scheduleLookupTimer:function(){if(this.get("_autocompletionTimer")){SC.warn("Scheduling a new autocompletion timer even though a previous timer was scheduled")}var b=SC.Timer.schedule({target:this,action:"lookupTimerFired",interval:this.get("autocompletionDelay"),repeats:NO});this.set("_autocompletionTimer",b)},invalidateScheduledLookupTimer:function(){var b=this.get("_autocompletionTimer");if(b){b.invalidate()}this.set("_autocompletionTimer",null)},scheduleProgressDisplayTimer:function(){var b=SC.Timer.schedule({target:this,action:"progressDisplayTimerFired",interval:this.get("progressDisplayDelay"),repeats:NO})},displayError:function(e){var d;if(e){if(SC.typeOf(e)===SC.T_STRING){d=e.loc()}else{if(e.kindOf&&e.kindOf(SC.Error)){d=e.get("description");if(!d){d="CK.Autocomplete.Error.Generic"}d=d.loc()}else{if(e.toString){d=e.toString().loc()}}}}if(!d){d="CK.Autocomplete.Error.Generic".loc()}var f=this.get("autocompleteField");if(f){f.set("errorMessage",d)}},clearErrorIfDisplayed:function(e){var d=this.get("autocompleteField");if(d){d.set("errorMessage",null)}},displayProgress:function(){var d=null,e=this.get("autocompleteCandidateValue"),f;if(e){d="CK.Autocomplete.SearchingProgress".loc(e)}f=this.get("autocompleteField");if(f){f.setIfChanged("progressMessage",d);f.setIfChanged("progressIndicatorIsVisible",!!d)}},progressIsDisplayed:function(){return(!!this.getPath("autocompleteField.progressMessage"))},updateProgressIfDisplayed:function(){if(this.progressIsDisplayed()){this.displayProgress()}},clearProgressIfDisplayed:function(){var b=this.get("autocompleteField");if(b){b.set("progressMessage",null);b.set("progressIndicatorIsVisible",NO)}},lookupTimerDidFire:function(d){if(this.get("_autocompletionTimer")!==d){SC.warn("Ignoring lookup timer that is not current:  %@",d);return}this.set("_autocompletionTimer",null);var e=this.get("autocompleteField");if(e){if(e.get("isProcessingKeyEvent")){this.invalidateScheduledLookupTimer();this.scheduleLookupTimer()}else{this.tryToPerform("lookupTimerFired")}}},performSearchOfLoadedData:function(){var d=this.get("autocompleteCandidateValue");if(d){var f=this.get("dataSource");if(f){var e=f.findCompletionsInLoadedData(d);this.set("autocompleteItems",e)}}},lookupTimerFired:function(){},progressDisplayTimerFired:function(){}});CK.ContactsAutocompleteController.sharedController=function(){var b=CK._ContactsAutocompleteControllerSharedController;if(!b){b=CK.ContactsAutocompleteController.create();CK._ContactsAutocompleteControllerSharedController=b}return b};CK.UsersAutocompleteController=SC.Object.extend({spaceId:"",autocompleteField:null,autocompleteItemsBinding:"*autocompleteField.autocompleteItems",autocompleteCandidateValueBinding:"*autocompleteField.autocompleteCandidateValue",minimumCharacters:2,autocompletionDelay:100,progressDisplayDelay:1000,nameDisplayOrder:null,contactsSortOrder:CK.CONTACTS_AUTOCOMPLETE_SORT_ORDER_LAST_FIRST,trace:YES,initial:"CA Initial","CA Initial":function(e){var f,d;switch(e.sig){case"autocompleteFieldBecameVisible":this[this.stateKey]="CA At Least One Field Visible";return CK.Statechart.EVT_TRANSITION_RES;case"autocompleteFieldWasFocused":d=e.arg1;this.set("autocompleteField",d);return CK.Statechart.handled()}return undefined}.state(),"CA At Least One Field Visible":function(e){var f;switch(e.sig){case"enter":return CK.Statechart.handled();case"defaultTransition":this[this.stateKey]="CA Necessary Data Loaded";return CK.Statechart.EVT_TRANSITION_RES;case"autocompleteFieldWasFocused":var d=e.arg1;this.set("autocompleteField",d);return CK.Statechart.handled()}return undefined}.state(),"CA Unrecoverable Error":function(e){this.clearProgressIfDisplayed();switch(e.sig){case"autocompleteFieldWasBlurred":this.clearErrorIfDisplayed();return CK.Statechart.handled();case"autocompleteFieldWasFocused":var d=e.arg1;this.set("autocompleteField",d);this[this.stateKey]="CA At Least One Field Visible";return CK.Statechart.EVT_TRANSITION_RES}return undefined}.state(),"CA Necessary Data Loaded":function(e){var d,f;switch(e.sig){case"enter":this.clearProgressIfDisplayed();d=this.get("autocompleteCandidate");if(d){if(!this.get("_autocompletionTimer")){this.scheduleLookupTimer()}}return CK.Statechart.handled();case"autocompleteFieldWasFocused":f=e.arg1;this.set("autocompleteField",f);this[this.stateKey]="CA At Least One Field Visible";return CK.Statechart.EVT_TRANSITION_RES;case"searchNarrowed":d=this.get("autocompleteCandidate");if(d){this.invalidateScheduledLookupTimer();this.scheduleLookupTimer()}return CK.Statechart.handled();case"searchWidened":this.invalidateScheduledLookupTimer();d=this.get("autocompleteCandidate");if(d){this.scheduleLookupTimer()}return CK.Statechart.handled();case"lookupTimerFired":this[this.stateKey]="CA Searching Loaded Data";return CK.Statechart.EVT_TRANSITION_RES}return undefined}.state("CA At Least One Field Visible"),"CA Searching Loaded Data":function(b){var e;switch(b.sig){case"enter":this.invalidateScheduledLookupTimer();this.performSearchOfLoadedData();return CK.Statechart.handled();case"searchNarrowed":this.performSearchOfLoadedData();return CK.Statechart.handled();case"searchWidened":this.invalidateScheduledLookupTimer();e=this.get("autocompleteField");if(e){e.hideAutocompleteMenuPane()}this.set("autocompleteItems",null);this[this.stateKey]="CA Necessary Data Loaded";return CK.Statechart.EVT_TRANSITION_RES;case"autocompleteFieldWasFocused":e=b.arg1;this.set("autocompleteField",e);return CK.Statechart.handled()}return undefined}.state("CA Necessary Data Loaded"),_previousAutocompleteCandidateValue:null,_lastSentAutocompletionCandidate:null,_autocompletionTimer:null,init:function(){},autocompleteFieldDidChange:function(){this.set("_previousAutocompleteCandidateValue",null);this.set("_autocompletionTimer",null);this.set("_lastSentAutocompletionCandidate",null);this.notifyPropertyChange("autocompleteCandidateValue")}.observes("autocompleteField"),autocompleteCandidate:function(){var d=this.get("autocompleteCandidateValue"),e=this.get("minimumCharacters");if(d&&(d.length>=e)){return d}else{return null}}.property("autocompleteCandidateValue","minimumCharacters").cacheable(),autocompleteCandidateValueDidChange:function(){var d=this.get("autocompleteCandidateValue");var e=this.get("_previousAutocompleteCandidateValue");if(e){if(d){this.tryToPerform("searchNarrowed")}else{this.tryToPerform("searchWidened")}}else{if(d&&d.length>0){this.tryToPerform("searchNarrowed")}}this.set("_previousAutocompleteCandidateValue",d)}.observes("autocompleteCandidateValue"),scheduleLookupTimer:function(){if(this.get("_autocompletionTimer")){SC.warn("Scheduling a new autocompletion timer even though a previous timer was scheduled")}var b=SC.Timer.schedule({target:this,action:"lookupTimerFired",interval:this.get("autocompletionDelay"),repeats:NO});this.set("_autocompletionTimer",b)},invalidateScheduledLookupTimer:function(){var b=this.get("_autocompletionTimer");if(b){b.invalidate()}this.set("_autocompletionTimer",null)},scheduleProgressDisplayTimer:function(){var b=SC.Timer.schedule({target:this,action:"progressDisplayTimerFired",interval:this.get("progressDisplayDelay"),repeats:NO})},displayError:function(e){var d;if(e){if(SC.typeOf(e)===SC.T_STRING){d=e.loc()}else{if(e.kindOf&&e.kindOf(SC.Error)){d=e.get("description");if(!d){d="CK.Autocomplete.Error.Generic"}d=d.loc()}else{if(e.toString){d=e.toString().loc()}}}}if(!d){d="CK.Autocomplete.Error.Generic".loc()}var f=this.get("autocompleteField");if(f){f.set("errorMessage",d)}},clearErrorIfDisplayed:function(e){var d=this.get("autocompleteField");if(d){d.set("errorMessage",null)}},displayProgress:function(){var d=null,e=this.get("autocompleteCandidateValue"),f;if(e){d="CK.Autocomplete.SearchingProgress".loc(e)}f=this.get("autocompleteField");if(f){f.setIfChanged("progressMessage",d);f.setIfChanged("progressIndicatorIsVisible",!!d)}},progressIsDisplayed:function(){return(!!this.getPath("autocompleteField.progressMessage"))},updateProgressIfDisplayed:function(){if(this.progressIsDisplayed()){this.displayProgress()}},clearProgressIfDisplayed:function(){var b=this.get("autocompleteField");if(b){b.set("progressMessage",null);b.set("progressIndicatorIsVisible",NO)}},lookupTimerDidFire:function(d){if(this.get("_autocompletionTimer")!==d){SC.warn("Ignoring lookup timer that is not current:  %@",d);return}this.set("_autocompletionTimer",null);var e=this.get("autocompleteField");if(e){if(e.get("isProcessingKeyEvent")){this.invalidateScheduledLookupTimer();this.scheduleLookupTimer()}else{this.tryToPerform("lookupTimerFired")}}},performSearchOfLoadedData:function(){var b=this.get("autocompleteCandidateValue");if(b){var a=this.findCompletionsInLoadedData(b);this.set("autocompleteItems",a)}},lookupTimerFired:function(){},progressDisplayTimerFired:function(){},autoFilter:function(b){var a=CK.UsersAutocompleteController.sharedController().get("content");var e=[];if(a){a=a.toArray();for(var d=0;d<a.length;d++){if(a[d].get("userById").get("keywords")&&(a[d].get("userById").get("keywords").indexOf(b)>=0)&&a[d].get("user_accepted")){e.push(a[d].get("userById"))}}}return e},findCompletionsInLoadedData:function(a){var b=[];var d=this.autoFilter(a);d.forEach(function(e){b.push(CK.AutocompleteResult.create({id:e.get("id"),previewValue:e.get("id"),primaryLabel:e.get("name"),secondaryLabel:e.get("email"),value:e.get("name")+(SC.none(e.get("email"))||e.get("email")===""?"":" <"+e.get("email")+"> ("+e.get("id")+")")}))},this);return b},validInputValue:function(b){var a=CK.UsersAutocompleteController.sharedController().get("content");var e=[];if(a){a=a.toArray();for(var d=0;d<a.length;d++){if(a[d].get("userById").get("name")==b||a[d].get("userById").get("steedos_id")==b||a[d].get("userById").get("email")==b){e.push(a[d].get("userById"))}}}return e}});CK.UsersAutocompleteController.sharedController=function(){var b=CK._UsersAutocompleteControllerSharedController;if(!b){b=CK.UsersAutocompleteController.create();CK._UsersAutocompleteControllerSharedController=b}return b};CK.AutocompleteActionDelegate={autocompleteMenuItemWasChosen:function(b){}};CK.AutocompleteMenuItemView=SC.MenuItemView.extend({classNames:["ck-ac-menu-item"],isAutocompleteMenuItem:YES,menuType:function(){return this.getPath("parentMenu.currentMenuType")}.property(".parentMenu.currentMenuType").cacheable(),showCategory:function(){return this.getPath("parentMenu.showCategories")}.property(".parentMenu.Categories").cacheable(),acceptsFirstResponder:NO,isSelected:NO,displayProperties:["isSelected","showCategory"],render:function(e,d){arguments.callee.base.apply(this,arguments);if(this.get("isSelected")){e.addClass("focus")}if(!this.get("showCategory")||!this.getPath("content.category")){e.addClass("no-category")}},renderLabel:function(A){var v=this.get("content"),B=v.get("localizedCategory"),o=SC.RenderContext.escapeHTML,u,p,q,x,s,t,z,y,w;s=v.get("matchChunks");if(s){x="<span class='value'>";z=YES;for(y=0,w=s.length;y<w;++y){t=s.objectAt(y);if(t){t=o(t);if(z){x+="<strong>"+t+"</strong>"}else{x+=t}}z=!z}x+="</span>";A.push(x)}else{if((u=v.get("primaryLabel"))){u=o(u);A.push("<span class='value primary-label'>"+u+"</span>")}else{q=v.get("title");if(q){q=o(q);A.push("<span class='value'>"+q+"</span>")}}}if(B){B=o(B);A.push("<span class='category'>"+B+"</span>")}p=v.get("secondaryLabel");if(p){p=o(p);A.push("<span class='secondary-label'>"+p+"</span>")}},mouseEntered:function(e){var d=this.get("parentMenu");if(d){if(d.get("mouseIsDown")===YES){if(this.get("isEnabled")&&!this.isSeparator()){d.set("currentMenuItem",this)}}}return YES},mouseExited:function(b){return YES},mouseDown:function(e){if(!this.get("isEnabled")){return NO}var d=this.get("parentMenu");if(d){d.set("mouseIsDown",YES);d.set("currentMenuItem",this)}return YES},touchStart:function(b){this.mouseDown(b)},mouseUp:function(d){var f=this.get("parentMenu"),e;if(f){f.set("mouseIsDown",NO)}e=this.getPath("parentMenu.rootMenu.targetMenuItem");if(e){e.performAction(YES)}return YES},touchEnd:function(a){this.mouseUp(a)}});sc_require("views/autocomplete_menu_item");CK.AUTOCOMPLETE_MODE_SINGLE=1;CK.AUTOCOMPLETE_MODE_MULTIPLE=2;CK.AUTOCOMPLETE_MENU_TYPE_AUTO=11;CK.AUTOCOMPLETE_MENU_TYPE_SINGLE_LINE=12;CK.AUTOCOMPLETE_MENU_TYPE_DOUBLE_LINE=13;CK.AutocompleteMenuPane=CW.SquareMenuPane.extend({classNames:["ck-ac-menu"],delegate:null,menuType:CK.AUTOCOMPLETE_MENU_TYPE_AUTO,showCategories:YES,exampleView:CK.AutocompleteMenuItemView,width:null,singleLineItemHeight:27,doubleLineItemHeight:43,localize:NO,action:"menuItemChosen",acceptsMenuPane:NO,acceptsKeyPane:NO,mouseIsDown:NO,layout:{top:30,left:30,bottom:30,right:30},currentMenuType:null,currentMenuTypeDidChange:function(){var n=this._previousMenuType,j=this.get("currentMenuType");this._previousMenuType=j;if(n===j){return}var o=this.get("items");if(!o||o.length===0){return}var l=this.get("menuItemViews"),m=this.get("currentMenuItem"),p=this.getPath("childViews.0");if(p){if(m){var k=l.indexOf(m);if(k!==-1){this._beforeTypeChangeSelectedItemIndex=k}}this._beforeTypeChangeVerticalScrollOffset=p.get("verticalScrollOffset");var q=(j===CK.AUTOCOMPLETE_MENU_TYPE_DOUBLE_LINE)?CW.InsetMiniScrollerView:CW.FadingCaplessScrollerView;p.changeVerticalScrollerViewClass(q)}this.notifyPropertyChange("menuItemViews");this._sc_menu_itemsDidChange()}.observes("currentMenuType"),itemHeight:function(){var b=this.get("currentMenuType");if(b===CK.AUTOCOMPLETE_MENU_TYPE_DOUBLE_LINE){return this.get("doubleLineItemHeight")}else{return this.get("singleLineItemHeight")}}.property("currentMenuType").cacheable(),showCategoriesDidChange:function(){var h=this.get("menuItemViews"),e,f,g;for(e=0,f=h.length;e<f;++e){g=h[e];g.notifyPropertyChange("showCategory")}}.observes("showCategories"),displayProperties:["currentMenuType"],init:function(){arguments.callee.base.apply(this,arguments);this.set("target",this);this.menuTypeDidChange()},render:function(d,f){arguments.callee.base.apply(this,arguments);var e=this.get("currentMenuType");if(e===CK.AUTOCOMPLETE_MENU_TYPE_SINGLE_LINE){d.addClass("single-line")}else{if(e===CK.AUTOCOMPLETE_MENU_TYPE_DOUBLE_LINE){d.addClass("double-line")}else{SC.error("Unexpected autocomplete menu type:  %@",e);d.addClass("single-line")}}},menuTypeDidChange:function(){var b=this.get("menuType");if(b!==CK.AUTOCOMPLETE_MENU_TYPE_AUTO){this.set("currentMenuType",b)}if(this.get("isVisibleInWindow")){this.positionPane()}}.observes("menuType"),createChildViews:function(){var d,e,f;d=this.createChildView(SC.ScrollView.extend({hasHorizontalScroller:NO,autohidesVerticalScroller:YES,hasVerticalScroller:YES,borderStyle:SC.BORDER_NONE,verticalScrollerView:CW.FadingCaplessScrollerView,changeVerticalScrollerViewClass:function(j){var k=this.childViews,l,b,a;l=this.verticalScrollerView;if(l){if(j===CW.InsetMiniScrollerView){b=!l.kindOf(j)}else{if(j===CW.FadingCaplessScrollerView){b=!l.kindOf(j)||l.kindOf(CW.InsetMiniScrollerView)}}if(b){a=k.indexOf(l);l.get("valueBinding").disconnect();l.destroy();if(this.get("hasVerticalScroller")){l=this.verticalScrollerView=this.createChildView(j,{layoutDirection:SC.LAYOUT_VERTICAL,valueBinding:"*owner.verticalScrollOffset"});if(a!==-1){k.splice(a,1,l)}else{k.push(l)}l.replaceLayer();this.childViews=k}else{this.verticalScrollerView=null}}}this.tile()}}));e=this._menuView=SC.View.create();f=this.get("menuItemViews");e.set("layout",{top:0,left:0,height:this.get("menuHeight")});e.replaceAllChildren(f);d.set("contentView",e);this.childViews=[d];return this},menuItemViews:function(){if(!this.get("currentMenuType")&&(this.get("menuType")===CK.AUTOCOMPLETE_MENU_TYPE_AUTO)){return[]}else{return arguments.callee.base.apply(this,arguments)}}.property("displayItems").cacheable(),menuItemViewsDidChange:function(){var f=this.get("menuItemViews");if(f&&f.length>0){var d=this._beforeTypeChangeVerticalScrollOffset;if(d){this.setPath("childViews.0.verticalScrollOffset",d)}this._beforeTypeChangeVerticalScrollOffset=null;var e=this._beforeTypeChangeSelectedItemIndex;if(e){this.selectMenuItemAtIndexIfAppropriate(e)}else{this.selectMenuItemAtIndexIfAppropriate(0)}}this._beforeTypeChangeVerticalScrollOffset=undefined;this._beforeTypeChangeSelectedItemIndex=undefined}.observes("menuItemViews"),menuHeightDidChange:function(){var d=this.get("menuHeight");var e=this._previousMenuHeight;if(d!==e){if(this.get("isVisibleInWindow")){this.positionPane()}this._previousMenuHeight=d}}.observes("menuHeight"),selectMenuItemAtIndexIfAppropriate:function(d){var f=this.get("menuItemViews");if(f&&f.length>0){var e=f.objectAt(d);if(e.get("isEnabled")){this.set("currentMenuItem",e)}}},currentMenuItemObserver:function(){if(!this.get("currentMenuType")){return}var g=this.get("currentMenuItem");if(!g){return}var e=this.get("previousMenuItem");if(e){if(g!==e){e.set("isSelected",NO)}}g.set("isSelected",YES);var h=this.get("childViews");if(h){var f=h[0];if(f&&f.scrollToVisible){f.scrollToVisible(g)}}this.invokeLast(this._notifyDelegateThatSelectedMenuItemChanged)}.observes("currentMenuItem"),_notifyDelegateThatSelectedMenuItemChanged:function(){var e=this.get("delegate"),d=this.getPath("currentMenuItem.content");if(e){e.tryToPerform("selectedMenuItemDidChange",d)}},menuItemChosen:function(f){var d=this.get("delegate");if(d){var e=f.get("selectedItem");d.tryToPerform("menuItemWasChosen",e)}},remove:function(){arguments.callee.base.apply(this,arguments);var b=this.get("delegate");if(b){b.tryToPerform("autocompleteMenuWasHidden")}},modalPaneDidClick:function(){var b=this.get("delegate");if(b){b.tryToPerform("chooseSelectedAutocompleteItemIfAppropriate")}return arguments.callee.base.apply(this,arguments)},popup:function(e,d){this.set("anchor",e);arguments.callee.base.apply(this,arguments)},positionPane:function(){if(this._currentlyPositioning){return this}this._currentlyPositioning=YES;var ae,ab,N,af,Z,ap,ag,an,ar,au,T,P,R,aq,X,am,ak,at,M,S,ac,ah=this.get("anchor");if(ah){if(ah.isView){if(ah.get("useStaticLayout")||ah.getPath("parentView.useStaticLayout")){ap=this.computeAnchorRect(ah.get("layer"))}else{ac=ah.get("parentView");ap=ac?ac.convertFrameToView(ah.get("frame"),null):ah.get("frame")}}else{ap=this.computeAnchorRect(ah)}ag=SC.cloneRect(ap);ab=this.get("currentWindowSize")||SC.RootResponder.responder.computeWindowSize();N=ab.width;af=ab.height;au=this.get("width");if(!au){au=ap.width||0}T=1;P=4;au-=2;an=ag.x;an+=T;R=N-(an+au+P);if(R<0){au+=R}ae=this.get("menuType");if(ae===CK.AUTOCOMPLETE_MENU_TYPE_AUTO){if(au<=440){this.set("currentMenuType",CK.AUTOCOMPLETE_MENU_TYPE_DOUBLE_LINE)}else{this.set("currentMenuType",CK.AUTOCOMPLETE_MENU_TYPE_SINGLE_LINE)}this.currentMenuTypeDidChange()}ae=this.get("currentMenuType");if(ae===CK.AUTOCOMPLETE_MENU_TYPE_SINGLE_LINE){aq=this.get("showCategories")?"CK.Autocomplete.Menu.SingleLine.WithCategories.minWidth".locMetric():"CK.Autocomplete.Menu.SingleLine.NoCategories.minWidth".locMetric()}else{aq="CK.Autocomplete.Menu.DoubleLine.minWidth".locMetric()}R=N-(aq+T+P);if(R<0){aq+=R}ar=au>aq?au:aq;R=N-(an+ar+P);if(R<0){an+=R}var ad=this.get("itemHeight"),aj=this.get("menuHeightPadding"),ai=(3*ad)+aj,Q=(10*ad)+aj,V=this.get("menuItemViews"),Y=0,aa=0;if(V){aa=V.get("length");if(aa){Y=aa}}at=this.get("menuHeight");at=at<=Q?at:Q;var ao=ap.y,O=SC.maxY(ap),A=2,al,W;if((O+ai)<af){al=YES}else{if(ao>(af-O)){al=NO}else{al=YES}}if(al){ag.y=O;if((af-O)>=at){W=at}else{am=af-O-aj-A;Z=Math.floor(am/ad);W=(Z*ad)}}else{if(at<ao){W=at}else{am=ao-A-aj;Z=Math.floor(am/ad);W=(Z*ad)}ak=W+aj+A;ag.y=(ao-ak)+aj+A}ag.height=W;var U={width:ar,height:ag.height,left:an,top:ag.y};this.adjust(U)}else{SC.warn("Cannot position autocomplete menu without an anchor element.")}this._currentlyPositioning=NO;return this},windowSizeDidChange:function(){SC.Pane.prototype.windowSizeDidChange.call(this);this.positionPane()},mouseExited:function(){return YES}});sc_require("panes/autocomplete_menu");sc_require("views/autocomplete_menu_item");CK.AutocompleteField={autocompleteDelegate:CK.ContactsAutocompleteController,autocompleteItems:null,autocompleteMenuClass:CK.AutocompleteMenuPane,autocompleteActionDelegate:null,autocompleteMode:CK.AUTOCOMPLETE_MODE_MULTIPLE,shouldMatchGroups:YES,progressIndicatorIsVisible:NO,progressMessage:null,errorMessage:null,isProcessingKeyEvent:NO,spellCheckEnabled:NO,autocompleteMenuIsVisible:function(){var b=this.get("autocompleteMenuPane");if(b){return b.get("isVisibleInWindow")}else{return NO}}.property(),init:function(){arguments.callee.base.apply(this,arguments);var d=this.get("autocompleteDelegate");if(d&&d.isClass){var e=d.sharedController;if(e){d=e()}else{d=d.create()}this.set("autocompleteDelegate",d)}this.autocompleteItemsDidChange()},destroy:function(){this.destroyAutocompleteMenuPane();arguments.callee.base.apply(this,arguments)},messageObserver:function(){this.updateAutocompleteMenuPane();this.updateIndicatorViews()}.observes("progressIndicatorIsVisible","progressMessage","errorMessage"),updateAutocompleteMenuPane:function(){if(!this.get("isVisibleInWindow")){return}var h,k,f;var g=this.get("progressMessage");if(g){k={item:g,title:g,isEnabled:NO};f=[k]}else{f=this.get("autocompleteItems")}if(f&&f.length>0){h=this.get("autocompleteMenuPane");if(!h){var j=this.get("autocompleteMenuClass");h=j.create({delegate:this});this.set("autocompleteMenuPane",h)}h.set("items",f);this.showAutocompleteMenuPane()}else{h=this.get("autocompleteMenuPane");if(h){this.destroyAutocompleteMenuPane()}}},hideAutocompleteMenuPane:function(){if(this.get("autocompleteMenuIsVisible")){this.propertyWillChange("autocompleteMenuIsVisible");var b=this.get("autocompleteMenuPane");if(b){b.remove()}this.propertyDidChange("autocompleteMenuIsVisible")}},autocompleteMenuWasHidden:function(){var b=this.get("autocompleteDelegate");if(b){b.tryToPerform("autocompleteMenuWasHidden")}},destroyAutocompleteMenuPane:function(){var b=this.get("autocompleteMenuPane");if(b){if(b.get("isVisibleInWindow")){this.hideAutocompleteMenuPane()}b.removeObserver("isVisibleInWindow",this,this.autocompleteMenuPaneObserver);b.set("textField",null);b.destroy();this.set("autocompleteMenuPane",null)}},previewFullString:NO,updateIndicatorViews:function(){this._updateIndicatorView("progress","progressIndicatorIsVisible");this._updateIndicatorView("error","errorMessage")},_updateIndicatorView:function(q,l){var m="_"+q+"IndicatorView";var t,s=this.get(l);if(s){if(!this[m]){var k,n,o;if(q==="error"){k=s;n=this;o=function(){n.set("errorMessage",null);return YES}}var p={centerY:0,right:3,width:19,height:16};t=SC.ImageView.create({value:"ck-ac-"+q+"-indicator",layout:p,acceptsFirstResponder:NO,toolTip:k,mouseDown:o});this.set("rightAccessoryView",t);this[m]=t}}else{t=this[m];if(t){if(this.get("rightAccessoryView")===t){this.set("rightAccessoryView",null)}this[m]=null}}},isVisibleInWindowDidChange:function(){var d=this._previousIsVisibleInWindow,f=this.get("isVisibleInWindow"),e;if(d!==f){this._previousIsVisibleInWindow=f;if(f){e=this.get("autocompleteDelegate");if(e){e.tryToPerform("autocompleteFieldBecameVisible",this)}this.updateAutocompleteMenuPane();this.updateIndicatorViews()}else{this.destroyAutocompleteMenuPane()}}}.observes("isVisibleInWindow"),autocompleteItemsDidChange:function(){var b=this._autocompleteItems;if(b){b.removeObserver("[]",this,this.autocompleteItemContentDidChange)}b=this._autocompleteItems=this.get("autocompleteItems");if(b){b.addObserver("[]",this,this.autocompleteItemContentDidChange)}this.autocompleteItemContentDidChange()}.observes("autocompleteItems"),autocompleteItemContentDidChange:function(){this.updateAutocompleteMenuPane()},autocompleteMenuPane:null,interpretKeyEvents:function(d){var e=d.which?d.which:d.keyCode;if(d&&e===44||(e===9&&this.get("nextValidKeyView")===this)){if(this.chooseSelectedAutocompleteItemIfAppropriate()){d.preventDefault();return YES}}return arguments.callee.base.apply(this,arguments)},moveUp:function(e){var f=this.get("autocompleteMenuPane"),d;if(f){d=f.moveUp();if(d){this.set("isProcessingKeyEvent",NO);e.preventDefault()}return d}return NO},moveDown:function(e){var f=this.get("autocompleteMenuPane"),d;if(f){d=f.moveDown();if(d){this.set("isProcessingKeyEvent",NO);e.preventDefault()}return d}return NO},didBecomeFirstResponder:function(e){e();var d=this.get("autocompleteDelegate");if(d){d.tryToPerform("autocompleteFieldWasFocused",this)}}.enhance(),chooseSelectedAutocompleteItemIfAppropriate:function(){var f=this.get("autocompleteMenuPane"),e;if(f&&f.get("isVisible")&&f.get("isPaneAttached")){var d=f.get("currentMenuItem");if(d){d.performAction(YES);e=YES}this.reset()}if(!e){e=NO}return e},dismissAutocompleteMenuIfAppropriate:function(){var b=this.get("autocompleteMenuPane");if(b&&b.get("isVisible")){this.destroyAutocompleteMenuPane();return YES}return NO},reset:function(){this.set("progressIndicatorIsVisible",NO);this.set("progressMessage",null);this.set("errorMessage",null);this.dismissAutocompleteMenuIfAppropriate()}};sc_require("panes/autocomplete_menu");sc_require("views/autocomplete_menu_item");CK.AutocompleteTextFieldView=SC.TextFieldView.extend(CK.AutocompleteField,{classNames:["ck-ac-text-field-view"],autocompleteCandidateValue:function(){var p=this._candidateValueBeforeUpdating;if(p){return p}var n=this.get("value");if(!n){return""}var m=this.get("selection");if(!m){return""}var o=m.get("start");if(o<0){return""}var v=m.get("end");if(o===v){var q=n.charAt(m.get("end"));if(q&&q!==","){return""}}var l=null;var t=n.lastIndexOf(",",o);var s=n.lastIndexOf(">",o);var u=t>s?t:s;if(u===-1){l=n.substr(0,o)}else{if(u===(o-1)){l=""}else{l=n.substr(u+1,(o-u-1))}}l=l.trimLeft();return l}.property("value","selection").cacheable(),showAutocompleteMenuPane:function(){if(!this.get("autocompleteMenuIsVisible")){this.propertyWillChange("autocompleteMenuIsVisible");var b=this.get("autocompleteMenuPane");if(b){b.popup(this)}this.propertyDidChange("autocompleteMenuIsVisible")}},selectedMenuItemDidChange:function(m){if(!m||this.isProcessingKeyEvent){return}SC.Binding.flushPendingChanges();var p=m.get("previewValue"),n=this.get("autocompleteCandidateValue"),s=p.toLowerCase().indexOf(n.toLowerCase()),q=this.get("previewFullString");if(n&&s!==0){return}if(!q&&n){p=p.substring(n.length)}var v=this.get("value"),o=this.get("selection"),u=o?o.get("start"):0,t=o?o.get("end"):0,w=u+p.length,x=v?v.substring(0,q&&s>=0?s:u):"";if(!v){return}x+=p;this._candidateValueBeforeUpdating=this.get("autocompleteCandidateValue");this.set("value",x);this.set("selection",SC.TextSelection.create({start:u,end:w}));this._candidateValueBeforeUpdating=null},menuItemWasChosen:function(s){if(!s){return}var D=s.get("value");if(!D){return}var w=s.get("primaryLabel");var u=s.get("secondaryLabel");if(w===u){D=u}var C=this.get("value");var t=this.get("selection");var x=t.get("start");if(x<0){return}var E="";var A=C?C.lastIndexOf(",",x):0;var z=C?C.lastIndexOf(">",x):0;var B=A>z?A:z;if(B>=0&&B<(x-1)){if(A>z){E=C?C.substr(0,B):""}else{E=C?C.substr(0,B+1):""}}if(E){E+=", "}var v=C?C.substr(t.get("end")):"";var q=E+D;if(this.get("autocompleteMode")===CK.AUTOCOMPLETE_MODE_MULTIPLE||v!==""){q+=", "}var F=q+v;this._candidateValueBeforeUpdating=this.get("autocompleteCandidateValue");this.set("value",F);x=q.length;if(parseInt(SC.browser.msie,10)===7){this.invokeLater(function(){this._setCaretPosition(x,F)},100)}else{this._setCaretPosition(x,F)}this._candidateValueBeforeUpdating=null;var y=this.get("autocompleteActionDelegate");if(y){y.tryToPerform("autocompleteMenuItemWasChosen",this)}},_scrollTextFieldToEnd:function(){var b=this.$input()[0];if(b){b.scrollLeft=(b.scrollWidth-b.clientWidth)}},_setCaretPosition:function(e,d){this.set("selection",SC.TextSelection.create({start:e,end:e}));if(e>=d.length){this._scrollTextFieldToEnd()}},keyDown:function(b){this.set("isProcessingKeyEvent",YES);if(this.interpretKeyEvents(b)){if(!b.cancelled){b.allowDefault()}return YES}else{return arguments.callee.base.apply(this,arguments)}},keyUp:function(e){var d=this._isKeyDown;if(SC.browser.mozilla&&e.keyCode===13&&!d){this.fieldValueDidChange()}this.notifyPropertyChange("selection");if(d){this._updateFieldValueAfterKeyUp()}this._isKeyDown=NO;e.allowDefault();return YES},_updateFieldValueAfterKeyUp:function(){this.fieldValueDidChange(YES);this.set("isProcessingKeyEvent",NO)},moveLeft:function(e){var d=this.dismissAutocompleteMenuIfAppropriate();if(d){e.preventDefault();return YES}else{return NO}},moveRight:function(e){var d=this.chooseSelectedAutocompleteItemIfAppropriate();if(d){e.preventDefault();return YES}else{return NO}},insertNewline:function(e){if(e.isIMEInput){return YES}var d=this.chooseSelectedAutocompleteItemIfAppropriate();if(d){e.preventDefault();return YES}else{return NO}},cancel:function(e){var d=this.dismissAutocompleteMenuIfAppropriate();if(d){e.preventDefault();return YES}else{return NO}},deleteBackward:function(b){this.dismissAutocompleteMenuIfAppropriate();return NO},willLoseFirstResponder:function(){arguments.callee.base.apply(this,arguments);if(SC.browser.msie){this.invokeLast(this.dismissAutocompleteMenuIfAppropriate)}else{this.chooseSelectedAutocompleteItemIfAppropriate()}var d=this.get("fieldValue");if(d){d=d.replace(/[, ]*$/g,"");this.set("value",d)}this.set("autocompleteItems",null);var e=this.get("autocompleteDelegate");if(e){e.tryToPerform("autocompleteFieldWasBlurred",this)}this.reset()},insertText:function(e,d){return null},insertTab:function(d){var e=this.get("nextValidKeyView");if(e){e.becomeFirstResponder();d.preventDefault()}else{d.allowDefault()}return YES},insertBacktab:function(d){var e=this.get("previousValidKeyView");if(e){e.becomeFirstResponder();d.preventDefault()}else{d.allowDefault()}return YES}});sc_require("views/autocomplete_text_field");CK.AutocompleteInlineTextFieldView=CK.AutocompleteTextFieldView.extend(SC.DelegateSupport,{isInvalid:NO,displayProperties:["isInvalid"],render:function(e,d){arguments.callee.base.apply(this,arguments);if(this.get("isInvalid")){e.addClass("cloudkit-errorfill")}},commitEditing:function(){var b=this.get("value");if(b){b=b.replace(/[, ]*$/g,"");this.set("value",b)}return SC.InlineTextFieldView.prototype.commitEditing.call(this)},isEditing:NO,mouseDown:function(b){arguments.callee.base.call(this,b);return this.get("isEditing")},touchStart:function(b){this.mouseDown(b)},keyDown:function(e){this.set("isProcessingKeyEvent",YES);var d=this.interpretKeyEvents(e);if(d){this.fieldValueDidChange(YES)}this._isKeyDown=YES;return !d?NO:d},insertText:null,fieldValueDidChange:function(b){SC.InlineTextFieldView.prototype.fieldValueDidChange.call(this,b);arguments.callee.base.apply(this,arguments)},cancel:function(){var b=this.dismissAutocompleteMenuIfAppropriate();if(b){return YES}else{return SC.InlineTextFieldView.prototype.cancel.call(this)}},insertNewline:function(e){if(!e.isIMEInput){return YES}var d=this.chooseSelectedAutocompleteItemIfAppropriate();if(d){return YES}else{return SC.InlineTextFieldView.prototype.insertNewline.call(this,e)}},deleteForward:function(b){this.dismissAutocompleteMenuIfAppropriate();return SC.InlineTextFieldView.prototype.deleteForward.call(this,b)},deleteBackward:function(b){this.dismissAutocompleteMenuIfAppropriate();return SC.InlineTextFieldView.prototype.deleteBackward.call(this,b)},beginEditing:SC.InlineTextFieldView.prototype.beginEditing,discardEditing:SC.InlineTextFieldView.prototype.discardEditing});SC.supplement(CK.AutocompleteInlineTextFieldView.prototype,SC.InlineTextFieldView.prototype);sc_require("panes/autocomplete_menu");sc_require("views/autocomplete_menu_item");if(CK.TokenItemView){CK.AutocompleteTokenItemView=CK.TokenItemView.extend(CK.AutocompleteField,{autocompleteCandidateValue:function(){var o=this._input;if(this.get("isEditing")===NO||!o){return}var s=this._candidateValueBeforeUpdating;if(s){return s}var p=this.get("value");if(!p){return""}var n=this.getTextSelection(),q=n.start,x=n.end;if(q<0){return""}if(q===x){var t=p.charAt(x);if(t&&t!==","){return""}}var m=null;var v=p.lastIndexOf(",",q);var u=p.lastIndexOf(">",q);var w=v>u?v:u;if(w===-1){m=p.substr(0,q)}else{if(w===(q-1)){m=""}else{m=p.substr(w+1,(q-w-1))}}m=m.trimLeft();return m}.property("value").cacheable(),showAutocompleteMenuPane:function(){if(!this.get("autocompleteMenuIsVisible")){this.propertyWillChange("autocompleteMenuIsVisible");var b=this.get("autocompleteMenuPane");if(b){b.popup(this.get("parentView"))}this.propertyDidChange("autocompleteMenuIsVisible")}},selectedMenuItemDidChange:function(o){if(!o){return}var p=this.get("autocompleteCandidateValue");if(this.isProcessingKeyEvent&&p===this._lastCandidateValue){return}this._lastCandidateValue=p;var s=o.get("previewValue"),w=s.toLowerCase().indexOf(p.toLowerCase()),u=this.get("previewFullString"),v;if(p&&w!==0){return}if(!u&&p){s=s.substring(p.length)}var z=this.get("value"),q=this.getTextSelection(),y=q.start,x=q.end,A=y+s.length,B=z?z.substring(0,u&&w>=0?w:y):"";if(!z){return}B+=s;this._candidateValueBeforeUpdating=this.get("autocompleteCandidateValue");this._input.value=B;this.updateValue();var t=this._input;if(t){if(t.setSelectionRange){t.setSelectionRange(y,A)}else{v=t.createTextRange();v.move("character",y);v.moveEnd("character",A-y);v.select()}}this._candidateValueBeforeUpdating=null},menuItemWasChosen:function(u){if(!u){return}var G=u.get("value");if(!G){return}this.get("parentView").tryToPerform("menuItemWasChosenInTokenItemView",u);var C=u.get("primaryLabel");var J=u.get("secondaryLabel");if(C===J){G=J}var A=this.get("value");var E=this.getTextSelection();var z=E.start;if(z<0){return}var y="";var H=A?A.lastIndexOf(",",z):0;var v=A?A.lastIndexOf(">",z):0;var B=H>v?H:v;if(B>=0&&B<(z-1)){if(H>v){y=A?A.substr(0,B):""}else{y=A?A.substr(0,B+1):""}}if(y){y+=", "}var t=A?A.substr(E.end):"";var x=y+G;if(this.get("autocompleteMode")===CK.AUTOCOMPLETE_MODE_MULTIPLE||t!==""){x+=", "}var D=x+t;this._candidateValueBeforeUpdating=this.get("autocompleteCandidateValue");this.set("value",D);this._candidateValueBeforeUpdating=null;var w=this.get("autocompleteActionDelegate");if(w){w.tryToPerform("autocompleteMenuItemWasChosen",this)}var F=this.get("parentView"),K=F.get("tokensController"),I=K.indexOf(this.get("content"));K.set("nextIndex",I+1);F.createEditingToken()},keyDown:function(b){this.set("isProcessingKeyEvent",YES);this._isKeyDown=YES;return arguments.callee.base.apply(this,arguments)},keyUp:function(e){var d=this._isKeyDown;if(d){this._updateFieldValueAfterKeyUp()}this._isKeyDown=NO;e.allowDefault();return YES},_updateFieldValueAfterKeyUp:function(){this.set("isProcessingKeyEvent",NO)},moveLeft:function(e){var d=this.dismissAutocompleteMenuIfAppropriate();if(d){e.preventDefault();return YES}else{return arguments.callee.base.apply(this,arguments)}},moveRight:function(e){var d=this.chooseSelectedAutocompleteItemIfAppropriate();if(d){e.preventDefault();return YES}else{return arguments.callee.base.apply(this,arguments)}},insertNewline:function(e){if(e.isIMEInput){return YES}var d=this.chooseSelectedAutocompleteItemIfAppropriate();if(d){e.preventDefault();return YES}else{return arguments.callee.base.apply(this,arguments)}},cancel:function(e){var d=this.dismissAutocompleteMenuIfAppropriate();if(d){e.preventDefault();return YES}else{return arguments.callee.base.apply(this,arguments)}},deleteBackward:function(b){this.dismissAutocompleteMenuIfAppropriate();return arguments.callee.base.apply(this,arguments)},willLoseFirstResponder:function(){arguments.callee.base.apply(this,arguments);if(SC.browser.msie){this.invokeLast(this.dismissAutocompleteMenuIfAppropriate)}else{this.chooseSelectedAutocompleteItemIfAppropriate()}var d=this.get("value");if(d){d=d.replace(/[, ]*$/g,"");this.set("value",d)}this.set("autocompleteItems",null);var e=this.get("autocompleteDelegate");if(e){e.tryToPerform("autocompleteFieldWasBlurred",this)}this.reset()},commitEditing:function(){var d=this.get("autocompleteMenuPane");if(d){var e=d.get("currentMenuItem");if(e){this.set("value",e.getPath("content.value"))}}arguments.callee.base.apply(this,arguments)}})}sc_require("views/autocomplete_token_item.js");if(CK.TokenView){CK.AutocompleteTokenView=CK.TokenView.extend({exampleView:CK.AutocompleteTokenItemView,menuItemWasChosenInTokenItemView:function(b){}})}CK.UsersAutocompleteTokenView=CK.AutocompleteTokenView.extend({value:null,canDelete:true,spaceId:null,exampleView:CK.AutocompleteTokenItemView.extend({classNames:["autocomplete-token-view"],autocompleteDelegate:CK.UsersAutocompleteController,}),menuItemWasChosenInTokenItemView:function(b){},render:function(){arguments.callee.base.apply(this,arguments);var b=[];var d=this.get("value");if(d&&d.length){d.forEach(function(l){var g=CS.store.find(CS.User,l);if(g&&g.get("id")){var f=SC.Query.local(CS.SpaceUser,{conditions:"user = %@ AND space = %@",parameters:[l,this.get("spaceId")]});CS.store.dataSourceDidFetchQuery(f);var e=CS.store.find(f);var m=e.firstObject()?e.firstObject().get("user_accepted"):false;var j=g.get("name"),h=g.get("email");var k=CK.Token.create({id:l,rawValue:j+" <"+h+">",name:j,emailId:h,isValid:m?m:false});b.pushObject(k)}},this)}if(this.tokensController){var a=this.tokensController.get("content").filter(function(e){return e.get("id")});if(a.getEach("id").toString()!==b.getEach("id").toString()){this.tokensController.set("content",b)}}},contentChanged:function(){var a=[];this.get("tokensController").get("content").forEach(function(b){if(b.get("id")){a.push(b.get("id"))}});a=a.uniq();if(this.get("value")&&(this.get("value").toString()!=a.toString())){this.set("value",a)}}.observes(".tokensController.content.length")});(function(){var a="cloudkit/error_catcher";if(!SC.MODULE_INFO){throw"SC.MODULE_INFO is not defined!"}if(SC.MODULE_INFO[a]){return}SC.MODULE_INFO[a]=SC.Object.create({dependencies:[],styles:[],styles2x:[],scriptURL:"/applications/designer/5410/cloudkit/error_catcher/5410/en-us/javascript.js",stringURL:"/applications/designer/5410/cloudkit/error_catcher/5410/en-us/javascript-strings.js",isPrefetched:YES})})();SC.stringsFor("en-us",{"Name.Display.FirstAndFamilyNames":"%{firstName} %{familyName}","Help.Beta.URL":"https://developer.steedos.com/steedos/","Help.Developer.URL":"https://developer.steedos.com/steedos/"});SC.stringsFor("en-us",{"Button.Cancel":"Cancel","Button.OK":"OK","Button.Clear":"Clear","Button.AllCheck":"All","Button.Back":"Back","Button.Invite":"Invite","Button.Invite.Contacts":"Invite users from contacts","User.NotAccepted.Message":"User can't be assigned.","User.NotAccepted.Description":"%@hasn't joined this space, please reassign to another user.","User.CannotEmpty.Message":"Please select at least one user.","User.Invite.FooterTitle":"Use commas, semicolons, or separate lines to separate multiple email addresses.","User.Invite.HeaderTitle":"Invite users by entering e-mail addresses:","User.Invite.Title":"Invite to join %@","User.Invite.Select.Contact":"Contacts","User.Invite.NoContacts":"No Contact","InviteUser.Success.Description":"Please ask your invitees to check the invitation mail (including junk mail folder).","InviteUser.Success.Text":"Invite success","Invite.DomainEmail.Error.Text":"Email address must be @%@, fix your input and invite again.","Invite.Error.Title":"Failed to invite","Invite.Email.Error.Text":"Error in mail address, Please fix it and try again.","MonthCalendar.MonthYear.Long.Format":"%{date:LLLL} %{date:yyyy}","MonthCalendar.MonthYear.Short.Format":"%{date:LLL} %{date:yyyy}","CS.DateView.SelectedDate.DayOfMonth":"%{date:d}","CS.DateView.SelectedDate.DayOfWeek":"%{date:EEEE}","CS.DateView.SelectedDate.MonthAndYear":"%{date:MMMM} %{date:yyyy}","CS.DueDate.DateTime.Format":"%@1 %@2","CS.DueDate.Yesterday":"Yesterday %@","CS.DueDate.Today":"Today %@","CS.DueDate.Tomorrow":"Tomorrow %@","CS.DueDate.Time.AM":"AM","CS.DueDate.Time.PM":"PM","CS.Priority.None":"None","CS.Priority.Low":"Low","CS.Priority.Medium":"Medium","CS.Priority.High":"High","CS.Hour":"Hour","CS.Minute":"Minute","CS.User.Select":"Select User","CS.Group.Select":"Select Dept.","CS.Attachment.Uploading":"Uploading...","User.Invite":"Invite User...",});CS=SC.Object.create({NAMESPACE:"CS",VERSION:"1.0.0",store:SC.Store.create().from(SC.Record.fixtures),currentUser:function(){return CS.store.find(CS.User,SteedOS.getUser().get("dsid"))}.property().cacheable(),leftPad:function(a,b,d){a=a+"";while(a.length<d){a=b+a}return a}});CS.Attachment=SC.Object.create({signature:[],_inProgress:false,operation:"",percentComplete:0,xhr:null,imgHeight:0,imgWidth:0,upload:function(m,a,j,l,k,f,o,d){this.set("operation","upload");this.set("_inProgress",true);var n=window.URL||window.webkitURL;var b,g;if((b=l)){if(o){CS.Attachment.set("imgHeight",d.height);CS.Attachment.set("imgWidth",d.width)}else{try{g=new Image();g.onload=function(){CS.Attachment.set("imgHeight",this.height);CS.Attachment.set("imgWidth",this.width)};g.onerror=function(){CS.Attachment.set("imgHeight",0);CS.Attachment.set("imgWidth",0)};g.src=n.createObjectURL(b)}catch(h){SC.debug("can not convert to Image");CS.Attachment.set("imgHeight",0);CS.Attachment.set("imgWidth",0)}}}this._doUpload(m,a,j,l,k,f,CS.Attachment.SPACE_PRIVATE)},user_profilePhoto_upload:function(e,f,a,d,g,b){this.set("operation","upload");this.set("_inProgress",true);this._doUpload(e,f,a,d,g,b,CS.Attachment.USER_PUBLIC)},space_logo_upload:function(g,e,a,d,f,b){this.set("operation","upload");this.set("_inProgress",true);this._doUpload(g,e,a,d,f,b,CS.Attachment.SPACE_PUBLIC)},_doUpload:function(a,e,h,m,j,g,k,d){var b=new FormData,l,n;if(k==CS.Attachment.SPACE_PRIVATE||k==CS.Attachment.SPACE_PUBLIC){l="spaces"}else{if(k==CS.Attachment.USER_PRIVATE||k==CS.Attachment.USER_PUBLIC){l="users"}else{return false}}n="%@/%@/%@/%@".fmt(l,a,CK.currentApplication.name,e);b.append("key",n);b.append("Content-Type",h);if(k==CS.Attachment.SPACE_PUBLIC||k==CS.Attachment.USER_PUBLIC){b.append("acl","public-read")}else{if(k==CS.Attachment.SPACE_PRIVATE||k==CS.Attachment.USER_PRIVATE){b.append("acl","private")}else{return false}}if(d){b.append("Cache-Control","max-age=%@".fmt(60*60*24*30));var f=new Date;f.setTime(d);b.append("Expires",f)}b.append("file",m);this.set("xhr",new XMLHttpRequest);this.xhr.onload=function(){CS.Attachment.set("_inProgress",false);CS.Attachment.set("percentComplete",0);if(this.getResponseHeader("x-amz-version-id")!=null&&this.getResponseHeader("x-amz-version-id")!=""){j(this.getResponseHeader("x-amz-version-id"),CS.Attachment.imgHeight,CS.Attachment.imgWidth)}};this.xhr.onerror=function(){CS.Attachment.set("_inProgress",false);g()};this.xhr.open("POST",SteedOS.getUrlForServiceName("s3")+"/s3/",!0);this.xhr.upload.onprogress=function(o){if(o.lengthComputable){CS.Attachment.set("percentComplete",Math.round(o.loaded*100/o.total))}};this.xhr.onabort=function(){CS.Attachment.set("_inProgress",false);CS.Attachment.set("percentComplete",0)};this.xhr.send(b)},getDownloadUrl:function(d,a,b){return SteedOS.getUrlForServiceName("s3")+"/s3/?key=spaces/"+d+"/"+CK.currentApplication.name+"/"+encodeURI(b,"UTF-8")+"&version_id="+a},deleteUserPhoto:function(b,f,d){var a=this._getKeyAndVersionIdFromUrl(b);if(a&&a.key&&a.versionId){var e=new XMLHttpRequest;var b=SteedOS.getUrlForServiceName("s3")+"/s3/?key="+a.key+"&version_id="+a.versionId;e.onload=function(){f(this.response)};e.onerror=function(g){d(g)};e.open("DELETE",b,true);e.send()}},deleteSpaceLogo:function(b,f,d){var a=this._getKeyAndVersionIdFromUrl(b);if(a&&a.key&&a.versionId){var e=new XMLHttpRequest;var b=SteedOS.getUrlForServiceName("s3")+"/s3/?key="+a.key+"&version_id="+a.versionId;e.onload=function(){f(this.response)};e.onerror=function(g){d(g)};e.open("DELETE",b,true);e.send()}},deleteAttachment:function(j,d,f,e,h,b){var g=new XMLHttpRequest;var a=SteedOS.getUrlForServiceName("s3")+"/s3/?key=spaces/"+j+"/"+CK.currentApplication.name+"/"+encodeURI(f,"UTF-8")+"&version_id="+d;g.onload=function(){h(this.response,e)};g.onerror=function(k){b(k,e)};g.open("DELETE",a,true);g.send()},deleteAttachmentVersion:function(j,d,e,f,b,h,g){var k=new XMLHttpRequest;var a=SteedOS.getUrlForServiceName("s3")+"/s3/?key=spaces/"+j+"/"+CK.currentApplication.name+"/"+encodeURI(e,"UTF-8")+"&version_id="+d;k.onload=function(){h(this.response,f,b)};k.onerror=function(l){g(l,f,b)};k.open("DELETE",a,true);k.send()},getContentType:function(a){var b=a.split(".").pop().toLowerCase();if("."+b===".au"){return"audio/basic"}else{if("."+b===".avi"){return"video/x-msvideo"}else{if("."+b===".bmp"){return"image/bmp"}else{if("."+b===".bz2"){return"application/x-bzip2"}else{if("."+b===".css"){return"text/css"}else{if("."+b===".dtd"){return"application/octet-stream"}else{if("."+b===".doc"){return"application/msword"}else{if("."+b===".docx"){return"application/msword"}else{if("."+b===".dotx"){return"application/octet-stream"}else{if("."+b===".es"){return"application/octet-stream"}else{if("."+b===".exe"){return"application/octet-stream"}else{if("."+b===".gif"){return"image/gif"}else{if("."+b===".gz"){return"application/x-gzip"}else{if("."+b===".hqx"){return"application/mac-binhex40"}else{if("."+b===".html"){return"text/html"}else{if("."+b===".jar"){return"application/x-java-archive"}else{if(("."+b===".jpg")||("."+b===".jpeg")){return"image/jpeg"}else{if("."+b===".js"){return"application/x-javascript"}else{if("."+b===".jsp"){return"application/octet-stream"}else{if("."+b===".midi"){return"audio/midi"}else{if("."+b===".mp3"){return"audio/mpeg"}else{if("."+b===".mpeg"){return"video/mpeg"}else{if("."+b===".ogg"){return"application/ogg"}else{if("."+b===".pdf"){return"application/pdf"}else{if("."+b===".pl"){return"application/octet-stream"}else{if("."+b===".png"){return"image/png"}else{if("."+b===".potx"){return"application/octet-stream"}else{if("."+b===".ppsx"){return"application/octet-stream"}else{if("."+b===".ppt"){return"application/vnd.ms-powerpoint"}else{if("."+b===".pptx"){return"application/vnd.ms-powerpoint"}else{if("."+b===".ps"){return"application/postscript"}else{if("."+b===".qt"){return"video/quicktime"}else{if("."+b===".ra"){return"audio/x-pn-realaudio"}else{if("."+b===".ram"){return"audio/x-pn-realaudio"}else{if("."+b===".rdf"){return"application/octet-stream"}else{if("."+b===".rtf"){return"text/rtf"}else{if("."+b===".sgml"){return"text/sgml"}else{if("."+b===".sit"){return"application/x-stuffit"}else{if("."+b===".sldx"){return"application/octet-stream"}else{if("."+b===".svg"){return"image/svg+xml"}else{if("."+b===".swf"){return"application/x-shockwave-flash"}else{if("."+b===".tar.gz"){return"application/x-gzip"}else{if("."+b===".tgz"){return"application/x-compressed"}else{if("."+b===".tiff"){return"image/tiff"}else{if("."+b===".tsv"){return"text/tab-separated-values"}else{if("."+b===".txt"){return"text/plain"}else{if("."+b===".wav"){return"audio/x-wav"}else{if("."+b===".xlam"){return"application/octet-stream"}else{if("."+b===".xls"){return"application/vnd.ms-excel"}else{if("."+b===".xlsb"){return"application/octet-stream"}else{if("."+b===".xlsx"){return"application/vnd.ms-excel"}else{if("."+b===".xltx"){return"application/octet-stream"}else{if("."+b===".xml"){return"text/xml"}else{if("."+b===".zip"){return"application/zip"}else{return"application/octet-stream"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},_inProgressDidChange:function(){if(this.get("_inProgress")){if(this.get("operation")=="upload"){CS.progressPane.append("CS.Attachment.Uploading".loc())}}else{CS.progressPane.remove()}}.observes("_inProgress"),_getKeyAndVersionIdFromUrl:function(b){var a={};if(b){r=this._getQueryString(b);a.key=r.key;a.versionId=r.version_id}return a},_getQueryString:function(d){var f={};var b,g,e;var j=d;var a=j.indexOf("?");j=j.substr(a+1);var h=j.split("&");for(e=0;e<h.length;e++){a=h[e].indexOf("=");if(a>0){b=h[e].substring(0,a);g=h[e].substr(a+1);f[b]=g}}return f}});CS.Attachment.SPACE_PRIVATE="space_private";CS.Attachment.SPACE_PUBLIC="space_public";CS.Attachment.USER_PRIVATE="user_private";CS.Attachment.USER_PUBLIC="user_public";CS.categoriesSelectedController=SC.ArrayController.create({getCategoriesController:function(b){var a=SC.ArrayController.create({allowsMultipleSelection:NO,load:function(){arguments.callee.base.apply(this,arguments);var d,e=CS.store;if(e){query=SC.Query.local(CS.Category,{conditions:"space = %@",parameters:[b],orderBy:"name ASC"});CS.store.dataSourceDidFetchQuery(query);d=CS.store.find(query)}this.set("content",d)},reLoad:function(f){var d,e=CS.store;if(e){var h;h=SC.Query.local(CS.Category,{conditions:"space = %@ AND name CONTAINS %@ ",parameters:[b,f],orderBy:"name ASC"});CS.store.dataSourceDidFetchQuery(h);d=CS.store.find(h)}this.set("content",d);var g=SC.SelectionSet.create();g.addObjects(CS.CategoryAttributes.get("results"));this.set("selection",g)}});a.load();return a},getSingleSelectCategories:function(b){var a=null;if(b){a=CS.store.find(CS.Category,b.get("id"))}return a},getSelectionByValue:function(e){var d=SC.SelectionSet.create(),f=CS.CategoryAttributes.get("spaceId"),b=CS.CategoryAttributes.getPath("categoriesDelegate.content");if(e&&f&&b){var a=null;if(e.get("id")){a=b.filterProperty("id",e.get("id"));if(a.length>0){d.addObject(a.firstObject())}}}return d}});CS.CategoryAttributes=SC.ObjectController.create({canEditUser:true,categoriesDelegate:null,spaceId:"",pickerWidth:260,pickerHeight:275,pickerTitle:"",hint:"",categorySelectView:null,isTextArea:true,showBorder:true,showNameTextFontSize:14,showNameNeedBolder:false,results:[],initAttributes:function(a){this.set("canEditUser",a.get("canEditUser"));this.set("categoriesDelegate",a.get("categoriesDelegate"));this.set("spaceId",a.get("spaceId"));this.set("pickerWidth",a.get("pickerWidth"));this.set("pickerHeight",a.get("pickerHeight"));this.set("pickerTitle",a.get("pickerTitle"));this.set("hint",a.get("hint"));this.set("categorySelectView",a);this.set("isTextArea",a.get("isTextArea"));this.set("showBorder",a.get("showBorder"));this.set("showNameTextFontSize",a.get("showNameTextFontSize"));this.set("showNameNeedBolder",a.get("showNameNeedBolder"))}});CS.ImageResizer=SC.Object.create({IMG_FILE:/image.*/,isSupportFilereader:!!(window.File&&window.FileReader&&window.FileList&&window.Blob),dataURItoBlob:function(a,b){var f=atob(a.split(",")[1]);var e=[];for(var d=0;d<f.length;d++){e.push(f.charCodeAt(d))}return new Blob([new Uint8Array(e)],{type:b})},setting:{file:null,width:0,height:0,fill:false,background:"#fff",type:"image/jpeg",size:"contain",mark:{},stretch:false,success:null,error:null},drawImage:function(h,b,f,g,j,e){var a=e.Orientation;b.width=f.width;b.height=f.height;var d=b.getContext("2d");if(f.background){d.fillStyle=f.background;d.fillRect(0,0,f.width,f.height)}h.render(b,{maxWidth:f.width,maxHeight:f.height,orientation:a});return this.callback(b,f,g,j)},callback:function(a,b,e,g){var d=null;var f=a.toDataURL(b.type);if($.browser.webkit){d=this.dataURItoBlob(f)}else{if($.browser.mozilla){d=a.mozGetAsFile(b.type)}else{d=this.dataURItoBlob(f)}}fromSize={width:e.width,height:e.height},toSize={width:a.width,height:a.height};if($.isFunction(b.success)){b.success.apply(this,[f,d,fromSize,toSize])}$(a).remove()},resize:function(n){var a={};$.extend(a,this.setting,n);if(!this.isSupportFilereader){return}var m=a.size;var e=a.file;var l=this;if(!e){return}var h=new FileReader();var j=$("<canvas></canvas>"),b=j[0];var f;var g,d;var k=new MegaPixImage(e);if(this.IMG_FILE.test(e.type)){h.onerror=function(o){if($.isFunction(a.error)){a.error.apply(l,[e,o])}};h.onload=function(v){var t=v.target;var o=t.result;f=new Image();var s;f.onload=function(){l.drawImage.apply(l,[k,b,a,f,v,s])};var q=o.replace(/^.*?,/,"");var u=atob(q);var p=new BinaryFile(u);s=EXIF.readFromBinaryFile(p);f.src=o};h.readAsDataURL(e)}}});CS.inviteUserNavigatableController=CW.NavigationController.create({});CS.invitUsers=SC.Object.create({contacts:[],originContent:null,content:null,app:"",users:null,space:null,dataSource:null,_isLoadContacts:NO,keyword:"",keywordChanged:function(){if(this.get("keyword").length==0){this.set("content",this.get("originContent"))}else{this.set("content",this.filterContacts())}}.observes("keyword"),load:function(){if(this.contacts){var b=[],a=[];this.contacts.forEach(function(d){if(d.emails&&d.emails.length>0){var e=d.name.formatted;d.emails.forEach(function(f){var g=SC.Object.create({name:e,email:f.value,selected:false});a.pushObject(g);b.pushObject(g)})}});b=b.sortProperty("name");a=a.sortProperty("name");this.set("content",b);this.set("originContent",a)}},invitContactUsers:function(){var b=this.get("content"),f=[],a=this,d=this.get("space"),e=this.get("dataSource");if(b){b.forEach(function(g){if(g.selected){var j=a.get("users").filterProperty("email",g.email),h;if(SC.none(j.get("firstObject"))){h={email:g.email,locale:String.preferredLanguage,name:g.name}}else{h=j.get("firstObject").get("attributes")}f.push(h)}});this.invitUser(f,d,e)}},filterContacts:function(){var a=this.get("keyword").toLowerCase(),d=this.get("originContent"),b=[];if(d){d.forEach(function(e){if(e&&(e.get("name")||e.get("email"))){if(e.get("name").toLowerCase().indexOf(a)!=-1){b.push(e)}else{if(e.get("email").toLowerCase().indexOf(a)!=-1){b.push(e)}}}})}return b},emailValue:"",_validateEmail:function(a){return/^([A-Z0-9\.\-\_\+])*([A-Z0-9\+\-\_])+\@[A-Z0-9]+([\-][A-Z0-9]+)*([\.][A-Z0-9\-]+){1,8}$/i.test(a||"")},_validateGoogleDomainEmail:function(a,d){var b=a.split("@")[1];return b==d.get("google_domain_name")},getEmails:function(e){var g=this.get("emailValue").split(/|;||,|\n/),d=true,b=this,f=true,a=[];g.forEach(function(h){h=h.replace(/\s/g,"");if(h){if(!b._validateEmail(h)){d=false;return}if(e.get("isGoogleAppsSpace")){if(!b._validateGoogleDomainEmail(h,e)){d=false;f=false;return}}a.push(h)}});return{isCorrect:d,isDomainCorrect:f,emails:a}},clearInput:function(){this.set("emailValue","")},invitInputUsers:function(){var h=[],b,d=this,e=this.get("space"),f=this.get("dataSource");var a=this.getEmails(e);if(a.isCorrect&&a.isDomainCorrect){var g=a.emails;SC.debug(g.join(","));g.forEach(function(l){var k=d.get("users").filterProperty("email",l),j;if(SC.none(k.get("firstObject"))){j={email:l,locale:String.preferredLanguage,name:l.split("@")[0]}}else{j=k.get("firstObject").get("attributes")}h.push(j)})}else{if(!a.isDomainCorrect){navigator.notification.alert("Invite.DomainEmail.Error.Text".loc(e.get("google_domain_name")),function(){},"Invite.Error.Title".loc(),"Button.OK".loc())}else{navigator.notification.alert("Invite.Email.Error.Text".loc(),function(){},"Invite.Error.Title".loc(),"Button.OK".loc())}}if(h.length>0){this.invitUser(h,e,f)}},invitUserUrl:"/am/users/invite",_invitUserMoveInProgress:NO,invitUser:function(e,b,a){var g=this.get("app");var k="";var f=new RegExp("(^|&)from=([^&]*)(&|$)","i");var l=window.location.search.substr(1).match(f);if(l!=null){k=l[2]?l[2]:"web"}else{k="web"}var d=SteedOS.getUrlForServiceName("admin")+this.get("invitUserUrl"),h,j=[];if(this._invitUserMoveInProgress===YES){SC.debug("There is already  invitUser request in progress skipping");return NO}else{h=CS.Request.postUrl(d);e.forEach(function(m){m.space=b.get("id");m.lang=navigator.language;m.app=g;m.from=k;j.push(m)});h.set("body",{Users:j});h.notify(200,this,this.invitUserDidSucceed,b,a);h.notify(0,this,this.invitUserDidFail,b);h.send();this.set("_invitUserMoveInProgress",YES);return YES}},invitUserDidSucceed:function(a,d,e){var b=a.get("body");this.set("_invitUserMoveInProgress",NO);if(b){if(b.errors){return this.invitUserDidFail(a,d)}else{e.applyChangesetHash(a);navigator.notification.alert("InviteUser.Success.Description".loc(),function(){},"InviteUser.Success.Text".loc(),"Button.OK".loc());this.clearInput()}}return YES},invitUserDidFail:function(b,e){this.set("_invitUserMoveInProgress",NO);var d,a=b.get("body");if(a.errors&&a.errors.length>0){d=a.errors[0].errorMessage}navigator.notification.alert(d,function(){},"Invite.Error.Title".loc(),"Button.OK".loc());return YES}});CS.rootMonthCalendarController=SC.Controller.create({startingWeekday:0,todaysDate:CW.Date.create().now().done(),updateTodaysDate:function(){var a=CW.Date.create().now().done();a[0]!==this.get("todaysDate")[0]&&this.set("todaysDate",a)}.observes("CS.shouldRefreshState")});CS.MonthCalendarView=SC.View.extend({invalidateCaches:function(){this._elemOutOfMonthCache={basic:{},selected:{},today:{},selToday:{}},this._elemInMonthCache={basic:{},selected:{},today:{},selToday:{},highlighted:{}},this._monthYearCache={},this._headingCache={}}.observes("visibleDays","startingWeekday","useCustomDateFormatting","highlightWeekend","useLongDay","useLongDay"),todaysDate:null,selectedDate:null,viewingMonth:null,startingWeekday:null,visibleDays:null,delegate:null,showNextPrevButtons:NO,highlightSelectedPeriod:NO,useLongMonth:YES,useLongDay:YES,acceptsDoubleClick:NO,acceptsSingleClick:NO,canClickOnSelectedDate:NO,useCustomDateFormatting:NO,highlightWeekend:NO,selectOnMouseUp:NO,_locDaysLong:["Sunday".loc(),"Monday".loc(),"Tuesday".loc(),"Wednesday".loc(),"Thursday".loc(),"Friday".loc(),"Saturday".loc(),"Sunday".loc()],_locDaysShort:["Sun".loc(),"Mon".loc(),"Tue".loc(),"Wed".loc(),"Thu".loc(),"Fri".loc(),"Sat".loc(),"Sun".loc()],_divEndStr:"</div>",_labelDivStr:'<div class="labels">',_headingDivStr:'<div class="headings">',_bodyDivStr:'<div class="month-body">',_yearStr:'<div class="month-year">%@</div>',_leftButtonStr:'<div class="previous-button"></div>',_rightButtonStr:'<div class="next-button"></div>',_rowElemStr:'<div class="row row%@1">',_headingStr:'<div class="col%@1">%@2</div>',_elemOutOfMonthCache:null,_elemInMonthCache:null,_monthYearCache:null,_headingCache:null,_getMonthDiv:function(x,C,k,b,q,D,j,B,A){var w=b?this._elemInMonthCache:this._elemOutOfMonthCache,m;q&&D?m=w.selToday:D?m=w.selected:q?m=w.today:j&&b?m=w.highlighted:m=w.basic,m[x]===undefined&&(m[x]={}),m[x][C]===undefined&&(m[x][C]={});if(m[x][C][A]===undefined){var z=["col","col"+C],v=q||D;B&&z.push("weekend"),b?j&&!v?z.push("highlighted"):v||z.push("in-month"):v||z.push("off-month"),v&&(q&&z.push("today"),D&&z.push("sel"),b||z.push("off-month-sel-today")),k>9&&k<20&&z.push("t");var g=b?"":' o="y"',y='<div class="'+z.join(" ")+'" d="'+k+'"'+g+">";return y+='<div class="left"></div><div class="middle"></div><div class="right"></div>',y+='<div class="dt" d="'+k+'"'+g+">"+A+"</div></div>",m[x][C][A]=y,m[x][C][A]}return m[x][C][A]},_elemOutOfMonth:{basic:'<div class="col col%@ off-month" d="%@" o="y"><div o="y" d="%@">%@</div></div>',selected:'<div class="col col%@ sel off-month" d="%@" o="y"><div o="y" d="%@">%@</div></div>',today:'<div class="col col%@ today off-month" d="%@" o="y"><div o="y" d="%@">%@</div></div>',selToday:'<div class="col col%@ today sel off-month" o="y" d="%@"><div o="y" d="%@">%@</div></div>'},_elemInMonth:{basic:'<div class="col col%@ in-month" d="%@"><div d="%@">%@</div></div>',selected:'<div class="col col%@ sel" d="%@"><div d="%@">%@</div></div>',today:'<div class="col col%@ today" d="%@"><div d="%@">%@</div></div>',selToday:'<div class="col col%@ today sel" d="%@"><div d="%@">%@</div></div>',highlighted:'<div class="col col%@ highlighted" d="%@"><div d="%@">%@</div></div>'},_getRowDiv:function(a){return this._rowElemStr.fmt(a)},_getHeadingDiv:function(b,a){this._headingCache[b]===undefined&&(this._headingCache[b]={});if(this._headingCache[b][a]===undefined){var d=this.useLongDay?this._locDaysLong[a]:this._locDaysShort[a];d&&(this._headingCache[b][a]=this._headingStr.fmt(b,d))}return this._headingCache[b][a]},_dateFormatter:CW.DateFormatter,_getMonthYear:function(b){var a=this.get("useLongMonth")?"MonthCalendar.MonthYear.Long.Format":"MonthCalendar.MonthYear.Short.Format";return this._yearStr.fmt(a.loc({date:b,dateFormatter:this.get("_dateFormatter")}))},displayProperties:["startingWeekday","visibleDays","viewingMonth","selectedDate","todaysDate"],render:function(ah,Q){ah.addClass("month"),ah.addClass("month-calendar");var Z=0,V,ad,R=this.get("highlightSelectedPeriod"),Y=this.get("startingWeekday"),K=this.get("delegate"),al=K?K.get("shouldCollapseRows"):NO,ag=this.get("showNextPrevButtons"),ab=this.get("useCustomDateFormatting"),aj=this.get("highlightWeekend"),ae=this.get("viewingMonth"),X=CW.Date.create(ae),ai=this.getSelectedDate(),J=ai.components()[0],aa=CW.Date.create(),af=CW.Date.create(this.get("todaysDate")).done()[0],G=X.month(),ak=Y-X.day();ak>0&&(ak=Y-X.day()-7);var I=X.clone().incrementDate(ak),P={},q=R&&ai.month()==G,H=q;if(H){var j=this.get("visibleDays"),B=this.get("visibleDays")===7?Y:1,U=I.clone();for(V=1;V<43;V++){if(U.value[0]===J){while(U.day()!==B){U.incrementDate(-1)}for(ad=0;ad<j;ad++){P[U.value[0]]=YES,U.incrementDate(1)}break}U.incrementDate(1)}}else{q&&ah.addClass("highlight-month")}ah.push(this._labelDivStr),ag?ah.push(this._leftButtonStr,this._getMonthYear(X),this._rightButtonStr):ah.push(this._getMonthYear(X)),ah.push(this._divEndStr),ah.push(this._headingDivStr);for(V=1;V<8;V++){ah.push(this._getHeadingDiv(V,Y%7)),Y++}ah.push(this._divEndStr),ah.push(this._bodyDivStr);var ac,F,W,z,D;for(V=1;V<7;V++){if(al&&V>4&&(I.month()>G||G===11&&I.month()===0)){break}Z++,ah.push(this._getRowDiv(V));for(ad=1;ad<8;ad++){ac=I.date(),F=H?P[I.value[0]]:NO,W=af===I.value[0],z=aj&&I.day()===0||I.day()===6,D=ab&&K?K.formatCustomDate(V,I,W):ac,ah.push(this._getMonthDiv(V,ad,ac,G==I.month(),W,J===I.value[0],F,z,D)),I.incrementDate(1)}ah.push(this._divEndStr)}ah.push(this._divEndStr);switch(Z){case 4:ah.addClass("num-rows4");break;case 5:ah.addClass("num-rows5");break;case 6:ah.addClass("num-rows6")}al&&K&&K.set("numRows",Z),I.done(),X.done(),ai.done(),aa.done()},getSelectedDate:function(){return CW.Date.create(this.get("selectedDate"))},mouseDown:function(a){return this.get("selectOnMouseUp")||this.selectOnMouseEvent(a),YES},selectOnMouseEvent:function(h){var l=h.target||h.srcElement;l.nodeType===3&&(l=l.parentNode);while(l&&l.className.indexOf("col")<0){l=l.parentNode;if(!l){return}if(!l.className){return}if(l.className.indexOf("month-calendar")>-1){return}}var f=SC.$(l),b=parseInt(f.attr("d"),10),g=f.attr("o")=="y";if(!isNaN(b)){var m=Date.now(),d=CW.Date.create(this.get("viewingMonth"));g&&d.incrementMonth(b<15?1:-1),d.date(b);if(this.canClickOnSelectedDate||SC.platform.touch){this.set("selectedDate",d.done()),h.clickCount=1}else{var k=this.getSelectedDate();k[0]!==d.value[0]&&(this.set("selectedDate",d.done()),h.clickCount=1)}var j=this.get("delegate");j&&(this.acceptsSingleClick&&(SC.platform.touch||h.clickCount===1)&&j.monthSingleClicked(),this.acceptsDoubleClick&&(SC.platform.touch||h.clickCount===2)&&j.monthDoubleClicked())}},touchStart:function(a){return this.mouseDown(a)},doubleClick:function(a){return SC.browser.isIE?this.mouseDown(a):NO},mouseUp:function(g){this.get("selectOnMouseUp")&&this.selectOnMouseEvent(g);var b=g.target;b.nodeType===3&&(b=b.parentNode);var h=b?b.className:"",f=h.indexOf("next-button")!==-1,a=h.indexOf("previous-button")!==-1;if(f||a){var d=this.get("delegate");d&&d.changeMonthPeriod(f)}return YES},touchEnd:function(a){return this.mouseUp(a)},init:function(){this.invalidateCaches(),arguments.callee.base.apply(this,arguments),this.awake()},updateViewingMonthForSelectedDate:function(){this.set("viewingMonth",CW.Date.create(this.get("selectedDate")).date(1).done())}.observes("selectedDate"),});sc_require("controllers/root_month_calendar_controller");sc_require("views/calendar/month_calendar");CS.MonthCalendarViewController=SC.Controller.extend({view:null,viewClass:CS.MonthCalendarView,viewMixin:{selectedDateBinding:".owner.selectedDate",viewingMonthBinding:SC.Binding.oneWay(".owner.viewingMonth"),renderStyleBinding:".owner.renderStyle",showNextPrevButtonsBinding:".owner.showNextPrevButtons",useLongDayBinding:".owner.useLongDay",highlightSelectedPeriod:YES,useCustomDateFormatting:YES,todaysDateBinding:".owner.todaysDate",startingWeekdayBinding:".owner.startingWeekday",hasBeenShownToUser:NO,acceptsSingleClick:YES,didAppendToDocument:function(){this.invokeLater(function(){this.set("hasBeenShownToUser",YES)},1000)}},init:function(){arguments.callee.base.apply(this,arguments);this.set("view",this.get("viewClass").extend(this.get("viewMixin")).create({owner:this,delegate:this}));this.updateViewingMonthForSelectedDate()},renderStyle:"htv3",hasBeenShownToUser:NO,hasBeenShownToUserBinding:"*view.hasBeenShownToUser",monthCalendarController:CS.rootMonthCalendarController,selectedDate:CW.Date.create().now().done(),shouldCollapseRows:YES,numRows:4,showNextPrevButtons:YES,useLongDay:NO,todaysDate:null,todaysDateBinding:"*monthCalendarController.todaysDate",startingWeekday:null,startingWeekdayBinding:"*monthCalendarController.startingWeekday",viewingMonth:CW.Date.create().done(),updateViewingMonthForSelectedDate:function(){this.set("viewingMonth",CW.Date.create(this.get("selectedDate")).date(1).done())}.observes("selectedDate"),changeMonthPeriod:function(a){this.set("viewingMonth",CW.Date.create(this.get("viewingMonth")).date(1).incrementMonth(a?1:-1).done())},formatCustomDate:function(d,a,f){var b=a.date();return this.dateShouldHaveIndicator(a)&&(b+=this.indicatorForDate(a)),b},indicatorForDate:function(a){return"<div class='indicator'></div>"},dateShouldHaveIndicator:function(a){return NO}});CS.DateRange=SC.Object.extend({startDate:null,endDate:null}),CS.DateRange.mixin({defaultStartDate:[19000101,1900,1,1,0,0,0],rangeForDate:function(b){var a=b.clone();return CS.DateRange.create({startDate:CS.createKeyFromDateArray(a.value),endDate:CS.createKeyFromDateArray(CS.DateRange.getEndDate(a))})},rangeThruToday:function(){return CS.DateRange.create({startDate:CS.createKeyFromDateArray(CS.DateRange.defaultStartDate),endDate:CS.createKeyFromDateArray(CS.DateRange.getEndDate(CW.Date.now()))})},getEndDate:function(b){var a=b.incrementDate(1).done();return a[4]=0,a[5]=0,a}});CS.MiniCalendarView=CS.MonthCalendarView.extend({defaultSelectedDate:[19000101,1900,1,1,0,0,0],acceptsFirstResponder:YES,getSelectedDate:function(){var a=this.get("selectedDate");return SC.none(a)?CW.Date.create(this.get("defaultSelectedDate")):CW.Date.create(a)},becomeFirstResponderIfNeeded:function(){this.get("selectedDate")&&this.becomeFirstResponder()}.observes("selectedDate"),keyDown:function(b){var a=this.interpretKeyEvents(b);return a?a:NO},moveLeft:function(){var a=CW.Date.create(this.get("selectedDate"));return a.incrementDate(-1),this.set("selectedDate",a.done()),YES},moveRight:function(){var a=CW.Date.create(this.get("selectedDate"));return a.incrementDate(1),this.set("selectedDate",a.done()),YES},moveUp:function(){var a=CW.Date.create(this.get("selectedDate"));return a.incrementDate(-7),this.set("selectedDate",a.done()),YES},moveDown:function(){var a=CW.Date.create(this.get("selectedDate"));return a.incrementDate(7),this.set("selectedDate",a.done()),YES}});sc_require("controllers/month_calendar_view_controller");sc_require("system/date_range");sc_require("views/calendar/mini_calendar");CS.miniCalendarViewController=CS.MonthCalendarViewController.extend({renderStyle:"mini-calendar",MINI_CALENDAR_HEADER_HEIGHT:52,MINI_CALENDAR_ROW_HEIGHT:38,MINI_CALENDAR_PADDING:4,shouldCollapseRows:NO,isShowing:NO,selectedDate:null,todaysDateBinding:"CS.rootMonthCalendarController.todaysDate",selectedDateIsToday:function(){var b=this.get("selectedDate"),a=this.get("todaysDate");return SC.none(b)?NO:b[0]===a[0]}.property("selectedDate","todaysDate").cacheable(),viewClass:CS.MiniCalendarView,desiredHeight:function(){return this.MINI_CALENDAR_PADDING+this.MINI_CALENDAR_HEADER_HEIGHT+this.MINI_CALENDAR_ROW_HEIGHT*6}.property().cacheable(),updateMiniCalendarView:function(){this.view.displayDidChange()},dateShouldHaveIndicator:function(a){return this._dataIsReady?this._dueDateCache[a.value[0]]===YES:NO},isShowingDidChange:function(){this.get("isShowing")===YES?(CS.addObserver("serverDidChangeData",this,this.updateMiniCalendar),this._dataIsReady=YES,this.updateMiniCalendar()):(this._dataIsReady=NO,CS.removeObserver("serverDidChangeData",this,this.updateMiniCalendar))}.observes("isShowing"),updateMiniCalendar:function(){if(!this.get("isShowing")){return}this.updateCache(),this.invokeLast("updateMiniCalendarView")},updateCache:function(){},setEmptySelection:function(){this._previousSelection=this.get("selectedDate"),this.set("selectedDate",null)},restoreSelectionIfNeeded:function(){if(this.get("selectedDate")){return}return SC.none(this._previousSelection)?NO:(this.set("selectedDate",this._previousSelection),YES)},selectedDateDidChange:function(){}.observes("selectedDate")});CS.notificationCenterController=SC.ArrayController.create({allowsMultipleSelection:NO,load:function(){this.set("content",CS.store.find(SC.Query.local(CS.PushMessage)))},topList:function(){var a=[];var b=this.get("content");if(b){b.forEach(function(e){var d=e.get("appName");if(a.filterProperty("appName",d).length==0){a.pushObject(e)}},this)}return a}.property("*content.length").cacheable(),getSubList:function(a){var b=[];var d=this.get("content");if(d&&SC.typeOf(a)==SC.T_STRING&&a.length>0){b=d.filterProperty("appName",a)}return b},deleteAppNamesByAppName:function(a){var b=this.getSubList(a);if(b.get&&b.get("length")>0){b.forEach(function(d){this.deleteAppName(d)},this)}},deleteAppName:function(d){if(d.get("status")===SC.Record.DESTROYED){return}var a=d.get("store"),b=d.get("storeKey"),d=a.materializeRecord(b);d.destroy()}});CS.organizationController=SC.ObjectController.create({contentBinding:"CS.organizationsController.selection",});CS.OrganizationAttributes=SC.ObjectController.create({isMulti:YES,canEditOrg:true,showFullName:false,organizationDelegate:null,spaceId:"",useModel:false,modelToOne:false,canClear:true,autoWriteInput:true,pickerWidth:260,pickerHeight:275,pickerTitle:"",hint:"",isTextArea:true,organizationSelectView:null,showBorder:true,showNameTextFontSize:14,showNameNeedBolder:false,initAttributes:function(a){this.set("isMulti",a.get("isMulti"));this.set("canEditOrg",a.get("canEditOrg"));this.set("showFullName",a.get("showFullName"));this.set("organizationDelegate",a.get("organizationDelegate"));this.set("spaceId",a.get("spaceId"));this.set("useModel",a.get("useModel"));this.set("modelToOne",a.get("modelToOne"));this.set("canClear",a.get("canClear"));this.set("autoWriteInput",a.get("autoWriteInput"));this.set("pickerWidth",a.get("pickerWidth"));this.set("pickerHeight",a.get("pickerHeight"));this.set("pickerTitle",a.get("pickerTitle"));this.set("hint",a.get("hint"));this.set("isTextArea",a.get("isTextArea"));this.set("organizationSelectView",a);this.set("showBorder",a.get("showBorder"));this.set("showNameTextFontSize",a.get("showNameTextFontSize"));this.set("showNameNeedBolder",a.get("showNameNeedBolder"))}});CS.organizationsController=SC.TreeController.create({allowsMultipleSelection:NO,load:function(g,d){var b,e=CS.store;if(e){var f=SC.Query.local(CS.Organization,{conditions:'parent = "" AND space = %@',parameters:[g],orderBy:"name ASC"});if(d){f=SC.Query.local(CS.Organization,{conditions:"company_id = %@ AND is_company = YES AND space = %@",parameters:[d,g],orderBy:"name ASC"})}b=CS.store.find(f);var a=SC.Object.create({treeItemIsExpanded:YES,name:"root",treeItemChildren:b})}this.set("content",a)},selectRoot:function(){var a=SC.SelectionSet.create();a.addObject(this.content.treeItemChildren.firstObject());this.set("selection",a)}});CS.organizationsSelectedController=SC.ArrayController.create({getOrganizationsController:function(e,d,a){var b=SC.TreeController.create({allowsMultipleSelection:d,load:function(k){arguments.callee.base.apply(this,arguments);var g,h=CS.store;if(h){var j=SC.Query.local(CS.Organization,{conditions:"parent = %@ AND space = %@",parameters:["",k],orderBy:"name ASC"});if(a){j=SC.Query.local(CS.Organization,{conditions:"company_id = %@ AND is_company = YES AND space = %@",parameters:[a,k],orderBy:"name ASC"})}g=CS.store.find(j);var f=SC.Object.create({treeItemIsExpanded:YES,name:"root",treeItemChildren:g})}this.set("content",f)}});b.load(e,a);return b},getMultiSelectOrganizations:function(f,d){var b=[];if(f){for(var e=0;e<f.length;e++){if(d){b.pushObject(CS.store.find(CS.Organization,f[e].get("id")))}else{var a={id:f[e].get("id"),name:f[e].get("name"),fullname:f[e].get("fullname")};b.pushObject(a)}}}return b},getSingleSelectOrganizations:function(d,e){var b=null;if(d){if(e){b=CS.store.find(CS.Organization,d.get("id"))}else{var a={id:d.get("id"),name:d.get("name"),fullname:d.get("fullname")};b=a}}return b},reSetGroupViewsStyle:function(a){if(a&&a.length>0){for(var b=0;b<a.length;b++){a[b].$().removeClass("user_group_select");a[b].label.$().removeClass("user_select_value_white");a[b].label.$().addClass("user_select_value")}}},addSelectStyle:function(a){if(a&&a.parentView){a.parentView.$().addClass("user_group_select");a.$().addClass("user_select_value_white")}},getSelectionByValue:function(d){var b=SC.SelectionSet.create(),a=CS.OrganizationAttributes.getPath("organizationDelegate.arrangedObjects"),e=null;if(d&&a){if(d instanceof CS.Organization){if(d.get("id")){e=a.filterProperty("id",d.get("id"));if(e.length>0){b.addObject(e.firstObject())}}}else{if(d.length&&(d.length>0||d.length()>0)){d.forEach(function(f){if(f instanceof CS.Organization){if(f.get("id")){e=a.filterProperty("id",f.get("id"));if(e.length>0){b.addObject(e.firstObject())}}}else{if(f.id){e=a.filterProperty("id",f.id);if(e.length>0){b.addObject(e.firstObject())}}}},this)}else{if(d.id){e=a.filterProperty("id",d.id);if(e.length>0){b.addObject(e.firstObject())}}}}}return b},getOrganizationSelectionSet:function(b,e,a){var d=SC.SelectionSet.create();b.forEach(function(f){d.addObject(f)});if(a=="add"){d.addObject(e)}else{if(a=="delete"){d.removeObject(e)}}return d}});CS.UserAttributes=SC.ObjectController.create({isMulti:YES,canEditUser:true,spaceUsersDelegate:null,spaceId:"",useModel:false,modelToOne:false,needAccepted:false,onlyActivated:true,canClear:true,afterClearRemovePanelPane:false,pickerWidth:260,pickerHeight:275,pickerTitle:"",userIds:null,hint:"",userSelectView:null,isTextArea:true,showSearchBox:false,showBorder:true,showNameTextFontSize:14,showNameNeedBolder:false,results:[],canInviteUser:false,initAttributes:function(a){this.set("isMulti",a.get("isMulti"));this.set("canEditUser",a.get("canEditUser"));this.set("spaceUsersDelegate",a.get("spaceUsersDelegate"));this.set("spaceId",a.get("spaceId"));this.set("useModel",a.get("useModel"));this.set("modelToOne",a.get("modelToOne"));this.set("needAccepted",a.get("needAccepted"));this.set("onlyActivated",a.get("onlyActivated"));this.set("canClear",a.get("canClear"));this.set("afterClearRemovePanelPane",a.get("afterClearRemovePanelPane"));this.set("pickerWidth",a.get("pickerWidth"));this.set("pickerHeight",a.get("pickerHeight"));this.set("pickerTitle",a.get("pickerTitle"));this.set("userIds",a.get("userIds"));this.set("hint",a.get("hint"));this.set("userSelectView",a);this.set("isTextArea",a.get("isTextArea"));this.set("showSearchBox",a.get("showSearchBox"));this.set("showBorder",a.get("showBorder"));this.set("showNameTextFontSize",a.get("showNameTextFontSize"));this.set("showNameNeedBolder",a.get("showNameNeedBolder"));this.set("canInviteUser",a.get("canInviteUser"))}});CS.usersSelectedController=SC.ArrayController.create({getSpaceUsersController:function(f,e,a,b){var d=SC.ArrayController.create({allowsMultipleSelection:e,onlyActivated:a,userIds:b,load:function(){arguments.callee.base.apply(this,arguments);var g,h=CS.store;if(h){var j;if(this.get("onlyActivated")){if(this.get("userIds")){j=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user ANY %@ AND user_accepted = true",parameters:[f,this.get("userIds")],orderBy:"name ASC"})}}else{if(this.get("userIds")){j=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user ANY %@",parameters:[f,this.get("userIds")],orderBy:"name ASC"})}}if(j){CS.store.dataSourceDidFetchQuery(j);g=CS.store.find(j)}}this.set("content",g)},reLoad:function(j){var g,h=CS.store;if(h){var l;if(this.get("onlyActivated")){if(this.get("userIds")){l=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user ANY %@ AND user_accepted = true AND (userById.name CONTAINS %@ OR userById.email CONTAINS %@ )",parameters:[f,this.get("userIds"),j,j],orderBy:"name ASC"})}else{l=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user_accepted = true AND (userById.name CONTAINS %@ OR userById.email CONTAINS %@ )",parameters:[f,j,j],orderBy:"name ASC"})}}else{if(this.get("userIds")){l=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user ANY %@ AND (userById.name CONTAINS %@ OR userById.email CONTAINS %@ )",parameters:[f,this.get("userIds"),j,j],orderBy:"name ASC"})}else{l=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND (userById.name CONTAINS %@ OR userById.email CONTAINS %@ )",parameters:[f,j,j],orderBy:"name ASC"})}}CS.store.dataSourceDidFetchQuery(l);g=CS.store.find(l)}this.set("content",g);var k=SC.SelectionSet.create();k.addObjects(CS.UserAttributes.get("results"));this.set("selection",k)},loadByOrg:function(g){arguments.callee.base.apply(this,arguments);var h,j=CS.store;if(j){var h=[];if(this.get("onlyActivated")){if(this.get("userIds")){var l=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user ANY %@ AND user_accepted = true AND organizations CONTAINS %@",parameters:[f,this.get("userIds"),g],orderBy:"name ASC"})}else{var l=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user_accepted = true AND organizations CONTAINS %@",parameters:[f,g],orderBy:"name ASC"})}}else{if(this.get("userIds")){var l=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user ANY %@ AND organizations CONTAINS %@",parameters:[f,this.get("userIds"),g],orderBy:"name ASC"})}else{var l=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND organizations CONTAINS %@",parameters:[f,g],orderBy:"name ASC"})}}CS.store.dataSourceDidFetchQuery(l);h=CS.store.find(l)}this.set("content",h);var k=SC.SelectionSet.create();k.addObjects(CS.UserAttributes.get("results"));this.set("selection",k)},});d.load();return d},getMultiSelectUsers:function(e,b){var f=[];if(e){for(var d=0;d<e.length;d++){if(b){f.pushObject(CS.store.find(CS.User,e[d].get("user")))}else{var a={id:e[d].get("user"),name:e[d].get("userById").get("name"),roles:CS.usersSelectedController.getRolesBySpaceUser(e[d]),organization:CS.usersSelectedController.getOrganizationBySpaceUser(e[d])};f.pushObject(a)}}}return f},getSingleSelectUsers:function(a,d){var e=null;if(a){if(d){e=CS.store.find(CS.User,a.get("user"))}else{var b={id:a.get("user"),name:a.get("userById").get("name"),roles:CS.usersSelectedController.getRolesBySpaceUser(a),organization:CS.usersSelectedController.getOrganizationBySpaceUser(a)};e=b}}return e},getRolesBySpaceUser:function(a){var b="";if(a){b=CS.Utils.getRolesByUser(a.get("space"),a.get("user"))}return b?b.split(",").uniq():[]},getOrganizationBySpaceUser:function(a){if(a){if(a.get("organizationById")){var b={name:a.get("organizationById").get("name"),fullname:a.get("organizationById").get("fullname")};return b}}return null},getSelectionByValue:function(f){var d=SC.SelectionSet.create(),g=CS.UserAttributes.get("spaceId"),b=CS.UserAttributes.getPath("spaceUsersDelegate.content");if(f&&g){var a=null;if(f instanceof CS.User){if(f.get("id")){var e=SC.Query.local(CS.SpaceUser,{conditions:"user = %@",parameters:[f.get("id")]});CS.store.dataSourceDidFetchQuery(e);a=CS.store.find(e);d.addObject(a.firstObject())}}else{if(f.length&&(f.length>0||f.length()>0)){f.forEach(function(h){if(h instanceof CS.User){if(h.get("id")){var j=SC.Query.local(CS.SpaceUser,{conditions:"user = %@",parameters:[h.get("id")]});CS.store.dataSourceDidFetchQuery(j);a=CS.store.find(j);d.addObject(a.firstObject())}}else{if(h&&h.id){var j=SC.Query.local(CS.SpaceUser,{conditions:"user = %@",parameters:[h.id]});CS.store.dataSourceDidFetchQuery(j);a=CS.store.find(j);d.addObject(a.firstObject())}}},this)}else{if(f.id){var e=SC.Query.local(CS.SpaceUser,{conditions:"user = %@",parameters:[f.id]});CS.store.dataSourceDidFetchQuery(e);a=CS.store.find(e);d.addObject(a.firstObject())}}}}return d}});CS.Utils=SC.Object.create({rolesQueryResult:{},organizationsQueryResult:{},clearRolesQueryResult:function(){this.set("rolesQueryResult",{})},clearOrganizationsQueryResult:function(){this.set("organizationsQueryResult",{})},getHeightByDom:function(g,d,f,e){var a=f;if(g&&e!=null&&e!=undefined){var b;g.style.maxWidth=d+"px";if(e.indexOf&&e.length){if(e.indexOf("\n",e.length-1)!==-1){e=e+"x"}}if($(g).attr("class")){b=SC.metricsForString(e,g,$(g).attr("class").split(" "))}else{b=SC.metricsForString(e,g)}a=b.height<f?f:b.height}return a},getUserById:function(a){return CS.store.find(CS.User,a)},getRolesByUser:function(k,j){var d="";if(k&&j){var h=this.get("rolesQueryResult");if(h&&h[j]&&(h[j][k]||h[j][k]==="")){return h[j][k]}SC.debug("CS.Utils: ");var g=[];var b=SC.Query.local(CS.Position,{conditions:"space = %@ AND users CONTAINS %@",parameters:[k,CS.store.find(CS.User,j)]});CS.store.dataSourceDidFetchQuery(b);var f=CS.store.find(b).toArray();for(var e=0;e<f.length;e++){g.push(f[e].get("role").get("name"))}if(g.length>0){d=g.uniq().toString()}if(h[j]){h[j][k]=d}else{var a={};a[k]=d;h[j]=a}}return d},getOrganizationByUser:function(h,e){var d=null;if(h&&e){var f=this.get("organizationsQueryResult");if(f&&f[e]&&(f[e][h]||f[e][h]===null)){return f[e][h]}SC.debug("CS.Utils: ");var a=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user = %@",parameters:[h,e]});CS.store.dataSourceDidFetchQuery(a);var b=CS.store.find(a).firstObject();if(b){d=b.get("organizationById")}if(f[e]){f[e][h]=d}else{var g={};g[h]=d;f[e]=g}}return d},prependPrefixForFormula:function(e,b){SC.debug("prependPrefixForFormula");var d=new Date*1;var a=/(\{[^{}]*\})/g;rev=b.replace(a,function(g,f){return e+f.replace(/\{\s*/,'["').replace(/\s*\}/,'"]').replace(/\s*\.\s*/g,'"]["')});SC.debug("return value : "+rev);SC.debug(" prependPrefixForFormula");SC.debug(""+(new Date()*1-d)+"ms");return rev},getFormulaFieldVariable:function(g,h){SC.debug(" getFormulaFieldVariable");var f=new Date*1;if(!h){return}var m=new Array();for(var d=0;d<h.length;d++){var l=new Object();var n=h[d];if(n.type!="table"&&n.type!="section"){if(n.formula&&n.formula!=""){l.code=n.code;l.formula="{"+n.code+"}="+n.formula+";";m.push(l)}}else{if(n.type=="section"){var o=n.fields;if(o){for(var a=0;a<o.length;a++){if(o[a].formula&&o[a].formula!=""){var l=new Object();l.code=o[a].code;l.formula="{"+o[a].code+"}="+o[a].formula+";";m.push(l)}}}}}}var d=m.length,b;var e;while(d>0){for(b=0;b<d-1;b++){e=m[b];field_code=e.code;if(!this.codeIsUseInFormula(field_code,m[b+1]["formula"])){m[b]=m[b+1];m[b+1]=e}}d--}for(var b=0;b<m.length;b++){m[b]["formula"]=this.prependPrefixForFormula(g,m[b]["formula"])}SC.debug(" getFormulaFieldVariable "+(new Date()*1-f)+"ms");return m},codeIsUseInFormula:function(a,f){if(a&&f){var j="{"+a+"}";if(j==f){return true}if(f.length>j.length){var g=f.split(j);for(var b=g.length-2;b>=0;b--){var k=f.search(j);var e=f.charAt(k-1);var d=f.charAt(k+j.length);if(e.match(/\w/)==null&&d.match(/\w/)==null){return true}}}var h="{"+a+".";if(f.length>h.length){var g=f.split(h);for(var b=g.length-2;b>=0;b--){var k=f.search(h);var e=f.charAt(k-1);if(e.match(/\w/)==null){return true}}}}return false},getUserHeadHtml:function(d,g,q,e){var f="";if(d&&d.url){var h=d.url,p=d.height,o=d.width,m=d.crop;if(m&&m.width&&m.height&&p&&o){var n=g/m.width,b=q/m.height,a=o*n,j=p*b,l=-m.x*n,k=-(p-m.y-m.height)*b;f='<span class=%@ style="background-image: url(%@);background-repeat: no-repeat;background-position:%@px %@px;background-size:%@px %@px"></span>'.fmt(e,h,l,k,a,j)}else{f='<img class=%@ src="'+h+'"/>';f=f.fmt(e)}}else{f='<img class=%@ src="/applications/designer/5410/coresteed/5410/en-us/source/resources/select_user/images/PersonalUserSelect.png"/>';f=f.fmt(e)}return f}});CS.Category=CW.Record.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),name:SC.Record.attr(String,{isRequired:YES}),space:SC.Record.attr(String,{isRequired:YES}),created:SC.Record.attr(Date),created_by:SC.Record.toOne("CS.User"),modified:SC.Record.attr(Date),modified_by:SC.Record.toOne("CS.User"),});CS.Organization=CW.Record.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),space:SC.Record.attr(String,{isRequired:YES}),name:SC.Record.attr(String,{isRequired:YES}),parent:SC.Record.attr(String,{defaultValue:""}),parents:SC.Record.toMany("CS.Organization"),children:SC.Record.toMany("CS.Organization"),fullname:SC.Record.attr(String),is_company:SC.Record.attr(Boolean,{isRequired:YES}),users:SC.Record.toMany("CS.User"),created:SC.Record.attr(Date),created_by:SC.Record.toOne("CS.User",{isRequired:YES}),modified:SC.Record.attr(Date),modified_by:SC.Record.toOne("CS.User",{isRequired:YES}),sort_no:SC.Record.attr(Number,{defaultValue:100}),company_id:SC.Record.attr(String),treeItemIsExpanded:YES,treeItemChildren:function(){return this.get("children").sortProperty("sort_no").reverse()}.property("children").cacheable(),itemChildrenCount:function(){return this.get("children").get("length")}.property("children").cacheable(),userCount:function(){return this.get("users").get("length")}.property("users").cacheable(),parentName:function(){if(this.get("parent")===""){return""}else{return CS.store.find(CS.Organization,this.get("parent")).get("name")}}.property("parent").cacheable(),});CS.Position=CW.Record.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),role:SC.Record.toOne("CS.Role",{isRequired:YES}),users:SC.Record.toMany("CS.User"),org:SC.Record.toOne("CS.Organization"),space:SC.Record.attr(String,{isRequired:YES}),created:SC.Record.attr(Date),created_by:SC.Record.toOne("CS.User",{isRequired:YES}),modified:SC.Record.attr(Date),modified_by:SC.Record.toOne("CS.User",{isRequired:YES}),});CS.PushMessage=SC.Record.extend({primaryKey:"id",appName:SC.Record.attr(String,{isRequired:YES}),alertTitle:SC.Record.attr(String,{isRequired:YES}),alert:SC.Record.attr(String,{isRequired:YES}),created:SC.Record.attr(SC.DateTime,{isRequired:YES,format:"%Y-%m-%dT%H:%M:%SZ"}),});CS.Role=CW.Record.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),name:SC.Record.attr(String),space:SC.Record.attr(String,{isRequired:YES}),created:SC.Record.attr(Date),created_by:SC.Record.toOne("CS.User",{isRequired:YES}),modified:SC.Record.attr(Date),modified_by:SC.Record.toOne("CS.User",{isRequired:YES})});CS.Space=CW.Record.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),name:SC.Record.attr(String,{isRequired:YES}),google_domai_name:SC.Record.attr(String),owner:SC.Record.toOne("CS.User",{isRequired:YES}),admins:SC.Record.toMany("CS.User",{isRequired:YES}),prefs:SC.Record.attr(Array),max_user_count:SC.Record.attr(Number,{defaultValue:30}),is_paid:SC.Record.attr(Boolean,{defaultValue:false}),expire_date:SC.Record.attr(Date),is_deleted:SC.Record.attr(Boolean,{isRequired:YES,defaultValue:NO}),created:SC.Record.attr(Date),created_by:SC.Record.toOne("CS.User",{isRequired:YES}),modified:SC.Record.attr(Date),modified_by:SC.Record.toOne("CS.User",{isRequired:YES}),balance:SC.Record.attr(Number),photo:SC.Record.attr(Object),admin_ids:function(){var b=new Array();if(this.get("admins")){for(var a=this.get("admins").length()-1;a>=0;a--){b.push(this.get("admins").objectAt(a).get("id"))}}return b}.property("admins").cacheable(),isAdmin:function(){return this.get("admins").contains(CS.get("currentUser"))}.property("admins").cacheable(),});CS.SpaceUser=CW.Record.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),user:SC.Record.attr(String,{isRequired:YES}),space:SC.Record.attr(String,{isRequired:YES}),organization:SC.Record.attr(String,{isRequired:YES}),organizations:SC.Record.attr(Array,{isRequired:YES}),user_accepted:SC.Record.attr(Boolean,{isRequired:YES}),created:SC.Record.attr(Date),created_by:SC.Record.toOne("CS.User",{isRequired:YES}),modified:SC.Record.attr(Date),modified_by:SC.Record.toOne("CS.User",{isRequired:YES}),name:function(){return(this.get("userById")&&this.get("userById").get("name")?this.get("userById").get("name"):"")}.property("user").cacheable(),email:SC.Record.attr(String),mobile:SC.Record.attr(String),manager:SC.Record.attr(String),userById:function(){if(this.get("user")){return CS.store.find(CS.User,this.get("user"))}}.property("user").cacheable(),spaceById:function(){if(this.get("space")){return CS.store.find(CS.Space,this.get("space"))}}.property("space").cacheable(),organizationById:function(){if(this.get("organization")){return CS.store.find(CS.Organization,this.get("organization"))}}.property("organization").cacheable(),});CS.User=CW.Record.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),steedos_id:SC.Record.attr(String,{isRequired:YES}),locale:SC.Record.attr(String,{defaultValue:"en-us"}),name:SC.Record.attr(String),photo:SC.Record.attr(Object),company:SC.Record.attr(String),mobile:SC.Record.attr(String),email:SC.Record.attr(String,{isRequired:YES}),primary_email_verified:SC.Record.attr(Boolean,{isRequired:YES}),is_paid_user:SC.Record.attr(Boolean,{isRequired:YES}),status_code:SC.Record.attr(Number,{isRequired:YES}),locked:SC.Record.attr(Boolean,{isRequired:YES}),created:SC.Record.attr(Date),created_by:SC.Record.toOne("CS.User",{isRequired:YES}),modified:SC.Record.attr(Date),modified_by:SC.Record.toOne("CS.User",{isRequired:YES}),imo_uid:SC.Record.attr(String),email_notification:SC.Record.attr(Boolean),keywords:function(){return"%@ %@ %@".fmt(this.get("name")&&this.get("name").toLowerCase(),this.get("steedos_id")&&this.get("steedos_id").toLowerCase(),this.get("email")&&this.get("email").toLowerCase())}.property("name","steedos_id","email")});SC.BaseTheme.csWindowRenderDelegate=SC.RenderDelegate.create({className:"window",render:function(g,d){var e=g.get("hasTabBar");var b=g.get("hasNavigationBar");if(e){d.addClass("has-tab-bar")}if(b){d.addClass("has-navigation-bar")}var f=d.begin("div").addClass("panel-mask");d=d.begin("div").addClass("panel-background");this.includeSlices(g,d,SC.NINE_SLICE);d=d.end();f.end();if(b){d=d.begin("div").addClass("navigation-bar");this.includeSlices(g,d,SC.THREE_SLICE);d.end()}if(e){d=d.begin("div").addClass("tab-bar");this.includeSlices(g,d,SC.THREE_SLICE);d.end()}var a=g.get("ariaLabel");d.attr("aria-label",a||"")},update:function(f,d){var a=f.get("ariaLabel");d.attr("aria-label",a||"");var e=f.get("hasTabBar");var b=f.get("hasNavigationBar");if(e){d.addClass("has-tab-bar")}if(b){d.addClass("has-navigation-bar")}}});var BinaryFile=function(g,d,b){var e=g;var a=d||0;var f=0;this.getRawData=function(){return e};if(typeof g=="string"){f=b||e.length;this.getByteAt=function(h){return e.charCodeAt(h+a)&255};this.getBytesAt=function(l,k){var h=[];for(var j=0;j<k;j++){h[j]=e.charCodeAt((l+j)+a)&255}return h}}else{if(typeof g=="unknown"){f=b||IEBinary_getLength(e);this.getByteAt=function(h){return IEBinary_getByteAt(e,h+a)};this.getBytesAt=function(j,h){return new VBArray(IEBinary_getBytesAt(e,j+a,h)).toArray()}}}this.getLength=function(){return f};this.getSByteAt=function(j){var h=this.getByteAt(j);if(h>127){return h-256}else{return h}};this.getShortAt=function(k,h){var j=h?(this.getByteAt(k)<<8)+this.getByteAt(k+1):(this.getByteAt(k+1)<<8)+this.getByteAt(k);if(j<0){j+=65536}return j};this.getSShortAt=function(k,j){var h=this.getShortAt(k,j);if(h>32767){return h-65536}else{return h}};this.getLongAt=function(n,j){var m=this.getByteAt(n),l=this.getByteAt(n+1),k=this.getByteAt(n+2),h=this.getByteAt(n+3);var o=j?(((((m<<8)+l)<<8)+k)<<8)+h:(((((h<<8)+k)<<8)+l)<<8)+m;if(o<0){o+=4294967296}return o};this.getSLongAt=function(k,h){var j=this.getLongAt(k,h);if(j>2147483647){return j-4294967296}else{return j}};this.getStringAt=function(n,m){var k=[];var h=this.getBytesAt(n,m);for(var l=0;l<m;l++){k[l]=String.fromCharCode(h[l])}return k.join("")};this.getCharAt=function(h){return String.fromCharCode(this.getByteAt(h))};this.toBase64=function(){return window.btoa(e)};this.fromBase64=function(h){e=window.atob(h)}};var BinaryAjax=(function(){function b(){var e=null;if(window.ActiveXObject){e=new ActiveXObject("Microsoft.XMLHTTP")}else{if(window.XMLHttpRequest){e=new XMLHttpRequest()}}return e}function d(h,e,g){var f=b();if(f){if(e){if(typeof(f.onload)!="undefined"){f.onload=function(){if(f.status=="200"){e(this)}else{if(g){g()}}f=null}}else{f.onreadystatechange=function(){if(f.readyState==4){if(f.status=="200"){e(this)}else{if(g){g()}}f=null}}}}f.open("HEAD",h,true);f.send(null)}else{if(g){g()}}}function a(f,j,h,e,k,l){var g=b();if(g){var m=0;if(e&&!k){m=e[0]}var n=0;if(e){n=e[1]-e[0]+1}if(j){if(typeof(g.onload)!="undefined"){g.onload=function(){if(g.status=="200"||g.status=="206"||g.status=="0"){g.binaryResponse=new BinaryFile(g.responseText,m,n);g.fileSize=l||g.getResponseHeader("Content-Length");j(g)}else{if(h){h()}}g=null}}else{g.onreadystatechange=function(){if(g.readyState==4){if(g.status=="200"||g.status=="206"||g.status=="0"){var o={status:g.status,binaryResponse:new BinaryFile(typeof g.responseBody=="unknown"?g.responseBody:g.responseText,m,n),fileSize:l||g.getResponseHeader("Content-Length")};j(o)}else{if(h){h()}}g=null}}}}g.open("GET",f,true);if(g.overrideMimeType){g.overrideMimeType("text/plain; charset=x-user-defined")}if(e&&k){g.setRequestHeader("Range","bytes="+e[0]+"-"+e[1])}g.setRequestHeader("If-Modified-Since","Sat, 1 Jan 1970 00:00:00 GMT");g.send(null)}else{if(h){h()}}}return function(h,e,g,f){if(f){d(h,function(l){var n=parseInt(l.getResponseHeader("Content-Length"),10);var m=l.getResponseHeader("Accept-Ranges");var k,j;k=f[0];if(f[0]<0){k+=n}j=k+f[1]-1;a(h,e,g,[k,j],(m=="bytes"),n)})}else{a(h,e,g)}}}());document.write("<script type='text/vbscript'>\r\nFunction IEBinary_getByteAt(strBinary, iOffset)\r\n	IEBinary_getByteAt = AscB(MidB(strBinary, iOffset + 1, 1))\r\nEnd Function\r\nFunction IEBinary_getBytesAt(strBinary, iOffset, iLength)\r\n  Dim aBytes()\r\n  ReDim aBytes(iLength - 1)\r\n  For i = 0 To iLength - 1\r\n   aBytes(i) = IEBinary_getByteAt(strBinary, iOffset + i)\r\n  Next\r\n  IEBinary_getBytesAt = aBytes\r\nEnd Function\r\nFunction IEBinary_getLength(strBinary)\r\n	IEBinary_getLength = LenB(strBinary)\r\nEnd Function\r\n<\/script>\r\n");var EXIF={};(function(){var j=false;EXIF.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"};EXIF.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};EXIF.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"};EXIF.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function e(l,n,m){if(l.addEventListener){l.addEventListener(n,m,false)}else{if(l.attachEvent){l.attachEvent("on"+n,m)}}}function d(l){return !!(l.exifdata)}function f(m,l){BinaryAjax(m.src,function(n){var o=a(n.binaryResponse);m.exifdata=o||{};if(l){l()}})}function a(o){var l=[];if(o.getByteAt(0)!=255||o.getByteAt(1)!=216){return false}var n=2;var m=o.getLength();while(n<m){if(o.getByteAt(n)!=255){if(j){console.log("Not a valid marker at offset "+n+", found: "+o.getByteAt(n))}return false}var p=o.getByteAt(n+1);if(p==22400){if(j){console.log("Found 0xFFE1 marker")}return h(o,n+4,o.getShortAt(n+2,true)-2);n+=2+o.getShortAt(n+2,true)}else{if(p==225){if(j){console.log("Found 0xFFE1 marker")}return h(o,n+4,o.getShortAt(n+2,true)-2)}else{n+=2+o.getShortAt(n+2,true)}}}}function g(t,p,v,m,s){var l=t.getShortAt(v,s);var q={};for(var n=0;n<l;n++){var u=v+n*12+2;var o=m[t.getShortAt(u,s)];if(!o&&j){console.log("Unknown tag: "+t.getShortAt(u,s))}q[o]=b(t,u,p,v,s)}return q}function b(w,y,q,x,t){var u=w.getShortAt(y+2,t);var v=w.getLongAt(y+4,t);var o=w.getLongAt(y+8,t)+q;switch(u){case 1:case 7:if(v==1){return w.getByteAt(y+8,t)}else{var l=v>4?o:(y+8);var s=[];for(var m=0;m<v;m++){s[m]=w.getByteAt(l+m)}return s}break;case 2:var p=v>4?o:(y+8);return w.getStringAt(p,v-1);break;case 3:if(v==1){return w.getShortAt(y+8,t)}else{var l=v>2?o:(y+8);var s=[];for(var m=0;m<v;m++){s[m]=w.getShortAt(l+2*m,t)}return s}break;case 4:if(v==1){return w.getLongAt(y+8,t)}else{var s=[];for(var m=0;m<v;m++){s[m]=w.getLongAt(o+4*m,t)}return s}break;case 5:if(v==1){return w.getLongAt(o,t)/w.getLongAt(o+4,t)}else{var s=[];for(var m=0;m<v;m++){s[m]=w.getLongAt(o+8*m,t)/w.getLongAt(o+4+8*m,t)}return s}break;case 9:if(v==1){return w.getSLongAt(y+8,t)}else{var s=[];for(var m=0;m<v;m++){s[m]=w.getSLongAt(o+4*m,t)}return s}break;case 10:if(v==1){return w.getSLongAt(o,t)/w.getSLongAt(o+4,t)}else{var s=[];for(var m=0;m<v;m++){s[m]=w.getSLongAt(o+8*m,t)/w.getSLongAt(o+4+8*m,t)}return s}break}}function h(u,l,n){if(u.getStringAt(l,4)!="Exif"){if(j){console.log("Not valid EXIF data! "+u.getStringAt(l,4))}return false}var s;var o=l+6;if(u.getShortAt(o)==18761){s=false}else{if(u.getShortAt(o)==19789){s=true}else{if(j){console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)")}return false}}if(u.getShortAt(o+2,s)!=42){if(j){console.log("Not valid TIFF data! (no 0x002A)")}return false}if(u.getLongAt(o+4,s)!=8){if(j){console.log("Not valid TIFF data! (First offset not 8)",u.getShortAt(o+4,s))}return false}var q=g(u,o,o+8,EXIF.TiffTags,s);if(q.ExifIFDPointer){var t=g(u,o,o+q.ExifIFDPointer,EXIF.Tags,s);for(var p in t){switch(p){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":t[p]=EXIF.StringValues[p][t[p]];break;case"ExifVersion":case"FlashpixVersion":t[p]=String.fromCharCode(t[p][0],t[p][1],t[p][2],t[p][3]);break;case"ComponentsConfiguration":t[p]=EXIF.StringValues.Components[t[p][0]]+EXIF.StringValues.Components[t[p][1]]+EXIF.StringValues.Components[t[p][2]]+EXIF.StringValues.Components[t[p][3]];break}q[p]=t[p]}}if(q.GPSInfoIFDPointer){var m=g(u,o,o+q.GPSInfoIFDPointer,EXIF.GPSTags,s);for(var p in m){switch(p){case"GPSVersionID":m[p]=m[p][0]+"."+m[p][1]+"."+m[p][2]+"."+m[p][3];break}q[p]=m[p]}}return q}EXIF.getData=function(m,l){if(!m.complete){return false}if(!d(m)){f(m,l)}else{if(l){l()}}return true};EXIF.getTag=function(m,l){if(!d(m)){return}return m.exifdata[l]};EXIF.getAllTags=function(n){if(!d(n)){return{}}var o=n.exifdata;var m={};for(var l in o){if(o.hasOwnProperty(l)){m[l]=o[l]}}return m};EXIF.pretty=function(n){if(!d(n)){return""}var o=n.exifdata;var m="";for(var l in o){if(o.hasOwnProperty(l)){if(typeof o[l]=="object"){m+=l+" : ["+o[l].length+" values]\r\n"}else{m+=l+" : "+o[l]+"\r\n"}}}return m};EXIF.readFromBinaryFile=function(l){return a(l)};function k(){var m=document.getElementsByTagName("img");for(var l=0;l<m.length;l++){if(m[l].getAttribute("exif")=="true"){if(!m[l].complete){e(m[l],"load",function(){EXIF.getData(this)})}else{EXIF.getData(m[l])}}}}e(window,"load",k)})();(function(d,g,h){g.support.filereader=!!(d.File&&d.FileReader&&d.FileList&&d.Blob);var b={width:0,height:0,fill:false,background:"#fff",type:"image/jpeg",size:"contain",mark:{},stretch:false,success:null,error:null};var f=g("body");var e=/image.*/;function a(j,k){var n=atob(j.split(",")[1]);var m=[];for(var l=0;l<n.length;l++){m.push(n.charCodeAt(l))}return new Blob([new Uint8Array(m)],{type:k})}g.fn.makeThumb=function(A){var j={};g.extend(j,b,A);if(!g.support.filereader){return}var z=j.size;var y=this[0];var k=y.files;var o="";if(!k.length){return}var q=k[0];var u=new FileReader();var v=g("<canvas></canvas>"),n=v[0],m=n.getContext("2d");var s;var t,p;var x=function(C){var B=null;o=n.toDataURL(j.type);if(g.browser.msie){B=a(o)}else{if(g.browser.webkit){B=a(o)}else{if(g.browser.mozilla){B=n.mozGetAsFile(j.type)}else{B=a(o)}}}t={width:s.width,height:s.height},p={width:n.width,height:n.height};if(g.isFunction(j.success)){j.success.apply(y,[o,B,t,p])}v.remove()};var w=new MegaPixImage(q);var l=function(D,C){var B=C.Orientation;n.width=j.width;n.height=j.height;if(j.background){m.fillStyle=j.background;m.fillRect(0,0,j.width,j.height)}w.render(n,{maxWidth:j.width,maxHeight:j.height,orientation:B});return x(D,C)};if(e.test(q.type)){u.onerror=function(B){if(g.isFunction(j.error)){j.error.apply(y,[q,B])}};u.onload=function(H){var F=H.target;var B=F.result;s=new Image();var E;s.onload=function(){l.apply(null,[H,E])};var D=B.replace(/^.*?,/,"");var G=atob(D);var C=new BinaryFile(G);E=EXIF.readFromBinaryFile(C);s.src=B};u.readAsDataURL(q)}}})(window,jQuery);(function(){function d(k){var j=k.naturalWidth,m=k.naturalHeight;if(j*m>1024*1024){var l=document.createElement("canvas");l.width=l.height=1;var h=l.getContext("2d");h.drawImage(k,-j+1,0);return h.getImageData(0,0,1,1).data[3]===0}else{return false}}function e(m,j,s){var h=document.createElement("canvas");h.width=1;h.height=s;var t=h.getContext("2d");t.drawImage(m,0,0);var l=t.getImageData(0,0,1,s).data;var p=0;var n=s;var q=s;while(q>p){var k=l[(q-1)*4+3];if(k===0){n=q}else{p=q}q=(n+p)>>1}var o=(q/s);return(o===0)?1:o}function g(h,k,l){var j=document.createElement("canvas");a(h,j,k,l);return j.toDataURL("image/jpeg",k.quality||0.8)}function a(C,l,m,h){var o=C.naturalWidth,t=C.naturalHeight;var x=m.width,w=m.height;var y=l.getContext("2d");y.save();b(l,x,w,m.orientation);var k=d(C);if(k){o/=2;t/=2}var B=1024;var j=document.createElement("canvas");j.width=j.height=B;var n=j.getContext("2d");var z=h?e(C,o,t):1;var s=Math.ceil(B*x/o);var A=Math.ceil(B*w/t/z);var u=0;var p=0;while(u<t){var v=0;var q=0;while(v<o){n.clearRect(0,0,B,B);n.drawImage(C,-v,-u);y.drawImage(j,0,0,B,B,q,p,s,A);v+=B;q+=s}u+=B;p+=A}y.restore();j=n=null}function b(l,m,h,k){switch(k){case 5:case 6:case 7:case 8:l.width=h;l.height=m;break;default:l.width=m;l.height=h}var j=l.getContext("2d");switch(k){case 2:j.translate(m,0);j.scale(-1,1);break;case 3:j.translate(m,h);j.rotate(Math.PI);break;case 4:j.translate(0,h);j.scale(1,-1);break;case 5:j.rotate(0.5*Math.PI);j.scale(1,-1);break;case 6:j.rotate(0.5*Math.PI);j.translate(0,-h);break;case 7:j.rotate(0.5*Math.PI);j.translate(m,-h);j.scale(-1,1);break;case 8:j.rotate(-0.5*Math.PI);j.translate(-m,0);break;default:break}}function f(k){if(k instanceof Blob){var j=new Image();var h=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;if(!h){throw Error("No createObjectURL function found to create blob url")}j.src=h.createObjectURL(k);this.blob=k;k=j}if(!k.naturalWidth&&!k.naturalHeight){var l=this;k.onload=function(){var o=l.imageLoadListeners;if(o){l.imageLoadListeners=null;for(var n=0,m=o.length;n<m;n++){o[n]()}}};this.imageLoadListeners=[]}this.srcImage=k}f.prototype.render=function(o,w){if(this.imageLoadListeners){var n=this;this.imageLoadListeners.push(function(){n.render(o,w)});return}w=w||{};var p=this.srcImage.naturalWidth,q=this.srcImage.naturalHeight,j=w.width,u=w.height,t=w.maxWidth,s=w.maxHeight,v=!this.blob||this.blob.type==="image/jpeg";if(j&&!u){u=(q*j/p)<<0}else{if(u&&!j){j=(p*u/q)<<0}else{j=p;u=q}}if(t&&j>t){j=t;u=(q*j/p)<<0}if(s&&u>s){u=s;j=(p*u/q)<<0}var h={width:j,height:u};for(var m in w){h[m]=w[m]}var l=o.tagName.toLowerCase();if(l==="img"){o.src=g(this.srcImage,h,v)}else{if(l==="canvas"){a(this.srcImage,o,h,v)}}if(typeof this.onrender==="function"){this.onrender(o)}};if(typeof define==="function"&&define.amd){define([],function(){return f})}else{this.MegaPixImage=f}})();CS.progressPane=SC.Page.design({modalPane:SC.Pane.design({layout:{top:0,left:0,right:0,bottom:0,zIndex:100000},childViews:"contentView".w(),contentView:SC.View.extend({childViews:["more","cancel","loadingView"],text:"",layout:{centerY:0,width:150,height:50,centerX:0},more:SC.View.extend({classNames:"loading".w(),childViews:["label"],layout:{centerY:-10,centerX:0,width:100,height:16},label:SC.LabelView.extend({layout:{height:16,width:100},valueBinding:SC.Binding.oneWay(".parentView.parentView.text"),render:function(a){arguments.callee.base.apply(this,arguments);a.addStyle({color:"white","text-align":"center !important","line-height":"16px !important","font-size":"12px !important"})}})}),cancel:SC.ImageButtonView.extend({layout:{centerY:-10,centerX:60,width:16,height:16},action:function(){if(CS.Attachment.xhr){CS.Attachment.xhr.abort()}},image:"my-image-button-icon",}),loadingView:SC.ProgressView.extend({layout:{width:150,height:16,centerX:0,centerY:10},minimum:0,maximum:100,valueBinding:"CS.Attachment.percentComplete",init:function(){arguments.callee.base.apply(this,arguments);this.incrementProperty("value",1)},})})}),append:function(a){this.get("modalPane").get("childViews").get("firstObject").set("text",a);this.get("modalPane").append()},remove:function(){this.get("modalPane").get("childViews").get("firstObject").set("text","");this.get("modalPane").remove()}});CS.Number=SC.Object.extend();CS.Number.mixin({valiReg:/^(-?\d+)(\.\d*)?$/,scientificValiReg:/^-?\d*(.\d+)?e\+\d+$/i,computeIsValid:function(d,f,e,g){var b=this.valiReg,h=d!=undefined?d:"",a=false;h=h?encodeURIComponent(h):"";if(f){a=b.test(h)}else{if(h.length>0){a=b.test(h)}else{a=true}}if(h.length>0){if(a&&SC.typeOf(e)=="number"){a=h<e?false:true}if(a&&SC.typeOf(g)=="number"){a=h>g?false:true}}return a},clearUnValidChar:function(b){SC.debug("%@".fmt(b));var a=b.replace(/[^\d]/g,function(d,e,f){if(d=="-"){if(e>0){return""}else{return d}}else{if(d=="."){if(e>0){if(/\./.test(f.substring(0,e))){return""}else{return d}}else{return""}}else{return""}}});SC.debug("%@%@".fmt(b,a));return a},getShowNumber:function(d,a,e,h,g){SC.debug("%@".fmt(d));var b,j,d=d!=undefined?d.toString():"";if(this.scientificValiReg.test(d)){return d}if(d&&!this.computeIsValid(d,e,h,g)){d=this.clearUnValidChar(d)}if(d&&this.computeIsValid(d,e,h,g)){j=d;if(a==0){if(/\./.test(d)){j=Math.round(d);if(this.scientificValiReg.test(j)){SC.debug("%@".fmt(j));return""}}}else{if(a>0){if(/\./.test(d)){var f=d.match(/\.(\d*)/)[1].length;if(f<a){j=d+"0".mult(a-f)}else{if(f>a){var m=Math.pow(10,a);j=Math.round(d*m)/m;if(this.scientificValiReg.test(j)){SC.debug("%@".fmt(j));return""}else{SC.debug("%@%@".fmt(j,d));return arguments.callee.call(this,j,a,e,h,g)}}else{}}}else{j=d+("."+"0".mult(a))}}}j=j.toString();b=/(-?)0+(\d)/;j=j.replace(/(-?)0+(\d)/,function(n,s,q,o,p){if(o>0){return n}else{return s+q}});var l;if(/\./.test(j)){l=j.match(/(-?\d*)\./)[1]}else{l=j}l=l.toString();b=/(\d{1,3})(?=(\d{3})+(?:$))/g;l=l.replace(b,"$1,");b=/\.\d*/;var k=j.match(b);k=k?k.toString():"";j=l+k}else{j=""}SC.debug("%@%@".fmt(d,j));return j}});CS.Request=CK.Request.extend({isJSON:YES,init:function(){arguments.callee.base.apply(this,arguments),this.header("Content-Type","text/plain")},send:function(){var b=this.get("address"),a;b.indexOf("https://")==-1&&b.indexOf("http://")==-1&&(b=CS.Request.getUrlForServiceName()+b);b=CS.Request.addDefaultQueryParams(b);var d=this.get("type");["GET","POST"].contains(d)||(this.set("type","POST"),b=CS.Request.addQueryParam(b,"methodOverride=%@".fmt(d))),this.addCycleToRequest(),this.setIfChanged("address",b),this.set("timeout",CS.REQUEST_TIMEOUT*1000);a=arguments.callee.base.apply(this,arguments);return a},didReceive:function(b,a){CS.Request.lastResponseTimestamp=(new Date).getTime()},addCycleToRequest:function(){this.get("cycle")||this.set("cycle",CS.getPath("store.storageManager.currentCycle"))}}),CS.Request.mixin({lastResponseTimestamp:0,getUrlForServiceName:function(){return SteedOS.getUrlForServiceName(CK.currentApplication.name)},addDefaultQueryParams:function(d){var a=SteedOS.getAccountPreferences(),f=a.locale,b=a.timeZone;return d.indexOf("?")<0?d+="?":d+="&",d+="lang=%@&usertz=%@".fmt(f,b),d},addQueryParam:function(b,a){return b.indexOf("?")<0?b+="?":b+="&",b+=a,b}});SC.Validator.NumberMinMaxLimit=SC.Validator.Number.extend({places:0,maxValue:null,minValue:null,fieldValueForObject:function(a,b,d){switch(SC.typeOf(a)){case SC.T_NUMBER:a=(a==0)?"":a.toFixed(this.get("places"));break;case SC.T_NULL:case SC.T_UNDEFINED:a="";break}return a},objectForFieldValue:function(d,b,e){var a;d=d.replace(/,/g,"");switch(SC.typeOf(d)){case SC.T_STRING:if(d.length===0){d=""}else{if(this.get("places")>0){d=parseFloat(d)}else{if(d.length===1&&d.match(/-/)){d=null}else{a=parseInt(d,0);if(isNaN(a)){d=SC.uniJapaneseConvert(d);d=parseInt(d,0);if(isNaN(d)){d=""}}else{d=a}}}}break;case SC.T_NULL:case SC.T_UNDEFINED:d=null;break}return d},validate:function(a,d){var b=d.get("fieldValue");return(b==="")||!(isNaN(b)||isNaN(parseFloat(b)))},validateError:function(b,d){var a=d.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Number(%@)",a),a)},validateKeyDown:function(b,d,a){if(!a){a=""}var e=d.$input().val();if(!e){e=""}e+=a;if(this.get("minValue")!=null&&this.get("maxValue")==null){if(e.length==parseFloat(e).toString().length){if(parseFloat(e)>=this.get("minValue")){return true}}}if(this.get("maxValue")!=null&&this.get("minValue")==null){if(e.length==parseFloat(e).toString().length){if(parseFloat(e)<=this.get("maxValue")){return true}}}if(this.get("maxValue")!=null&&this.get("minValue")!=null){if(e.length==parseFloat(e).toString().length){if(parseFloat(e)<=this.get("maxValue")&&parseFloat(e)>=this.get("minValue")){return true}}}return false}});SC.Validator.NumberOfNumber=SC.Validator.extend({places:0,last_value:"",fieldValueForObject:function(a,b,d){switch(SC.typeOf(a)){case SC.T_NUMBER:a=(a==0)?"":a.toFixed(this.get("places"));break;case SC.T_NULL:case SC.T_UNDEFINED:a="";break}return a},objectForFieldValue:function(d,b,e){var a;d=d.replace(/,/g,"");switch(SC.typeOf(d)){case SC.T_STRING:this.set("last_value",d);if(d.length===0){d=null}else{if(this.get("places")>0){}else{if(d.length===1&&d.match(/-/)){d=null}else{a=parseInt(d,0);if(isNaN(a)){d=SC.uniJapaneseConvert(d);d=parseInt(d,0);if(isNaN(d)){d=""}}else{d=a}}}}break;case SC.T_NULL:case SC.T_UNDEFINED:d=null;break}return d},validate:function(a,d){var b=d.get("fieldValue");return(b==="")||!(isNaN(b)||isNaN(parseFloat(b)))},validateError:function(b,d){var a=d.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Number(%@)",a),a)},validateKeyDown:function(d,f,b){if(!b){b=""}if(b==="."){var a=this.get("last_value").split(".");if(a.length>1){return false}return true}if(b==="0"){var h=this.get("last_value").split(".");if(h.length===2){var e=h[1];if(e.length>=this.get("places")){return false}}}var g=f.$input().val();if(!g){g=""}g+=b;if(this.get("places")===0){if(b.length===0){return true}else{return g.match(/^[\-{0,1}]?[0-9,\0]*/)[0]===g}}else{if(b.length===0){return true}else{return g.match(/^[\-{0,1}]?[0-9,\0]*\.?[0-9\0]+/)?g.match(/^[\-{0,1}]?[0-9,\0]*\.?[0-9\0]+/)[0]===g:false}}}});SC.Validator.NumberOfString=SC.Validator.extend({places:0,last_value:"",fieldValueForObject:function(a,d,e){switch(SC.typeOf(a)){case SC.T_STRING:if(a!=""){var b=a.split(".");if(b.length>1){if(b[1].length>this.get("places")){a=parseFloat(a).toFixed(this.get("places"))}}}break;case SC.T_NULL:case SC.T_UNDEFINED:a="";break}return a},objectForFieldValue:function(d,b,e){var a;d=d.replace(/,/g,"");switch(SC.typeOf(d)){case SC.T_STRING:this.set("last_value",d);if(d.length===0){d=null}else{if(this.get("places")>0){}else{if(d.length===1&&d.match(/-/)){d=null}else{a=parseInt(d,0);if(isNaN(a)){d=SC.uniJapaneseConvert(d);d=parseInt(d,0);if(isNaN(d)){d=""}}else{d=a}}}}break;case SC.T_NULL:case SC.T_UNDEFINED:d=null;break}if((d&&d.toString)||d===0){d=d.toString()}return d},validate:function(a,d){var b=d.get("fieldValue");return(b==="")||!(isNaN(b)||isNaN(parseFloat(b)))},validateError:function(b,d){var a=d.get("errorLabel")||"Field";return SC.$error(SC.String.loc("Invalid.Number(%@)",a),a)},validateKeyDown:function(d,f,b){if(!b){b=""}if(b===","){return false}if(b==="."){if(this.get("places")==0){return false}var a=this.get("last_value").split(".");if(a.length>1){return false}return true}if(b==="0"){var h=this.get("last_value").split(".");if(h.length===2){var e=h[1];if(e.length>=this.get("places")){return false}}}var g=f.$input().val();if(!g){g=""}g+=b;if(this.get("places")===0){if(b.length===0){return true}else{return g.match(/^[\-{0,1}]?[0-9,\0]*/)[0]===g}}else{if(b.length===0){return true}else{return g.match(/^[\-{0,1}]?[0-9,\0]*\.?[0-9\0]+/)?g.match(/^[\-{0,1}]?[0-9,\0]*\.?[0-9\0]+/)[0]===g:false}}}});CS.Alert=SC.Object.extend();SC.mixin(CS.Alert,{alertIconHash:{value:"me-icon-alert-68",width:68,height:65},infoIconHash:{value:"me-icon-info-68",width:68,height:65},callback:function(b){var a=CS.Alert.options.btnActions[b];if(typeof a=="function"){a()}CS.Alert.options=null},showWindow:function(g,b){var a;try{a=window.navigator;if(window.parent){a=window.parent.navigator}}catch(f){}if(a&&a.notification){var h=[],j=[],d=[g.leftButton,g.middleButton,g.rightButton];d.forEach(function(e){if(e){if(typeof e=="object"){h.push(e.action);j.push(e.title)}else{h.push(undefined);j.push(e.toString())}}});if(j.length=0){j.push("OK")}CS.Alert.options={btnActions:h};a.notification.confirm(g.description,this.callback,g.message,j.join(","))}else{return g.image=b,CW.Alert.show(g)}},alert:function(a){return this.showWindow(a,this.alertIconHash)},info:function(a){return this.showWindow(a,this.infoIconHash)}});CS.CategoryPane=CW.iOSPickerPane.extend({themeName:"iOS",classNames:"iOS-blue".w(),contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),layout:{top:0,bottom:0,left:0,right:0},childViews:["toolbarView","treeView"],toolbarView:SC.View.extend({layout:{left:1,right:1,top:0,height:40},childViews:["confirm","title","cancel"],classNames:"user_group_toolbar",confirm:SC.ButtonView.design({layout:{right:5,width:60,centerY:1,height:30},title:"Button.OK".loc(),themeName:"navigationBarSilverDone",action:function(){var e=CS.CategoryAttributes.get("categorySelectView"),a=this.getPath("parentView.parentView.parentView");if(e&&a){var b=CS.CategoryAttributes.getPath("results.firstObject"),d=null;if(b){d=CS.categoriesSelectedController.getSingleSelectCategories(b);if(d){e.categoryView.set("value",d.get("name"))}else{e.categoryView.set("value","")}e.set("value",d);a.remove();a.destroy();e.extendOK()}else{e.set("value",null);e.categoryView.set("value","");a.remove();a.destroy();e.extendOK()}}}}),title:SC.LabelView.extend({render:function(){arguments.callee.base.apply(this,arguments);if(CS.CategoryAttributes.get("pickerTitle")){this.set("value",CS.CategoryAttributes.get("pickerTitle"))}else{this.set("value","CS.User.Select".loc())}},layout:{centerX:0,centerY:1,width:111,height:30},textAlign:"center",classNames:"user_select_title"}),cancel:SC.ButtonView.design({layout:{left:5,width:60,centerY:1,height:30},title:"Button.Cancel".loc(),themeName:"navigationBarSilver",action:function(){var a=this.getPath("parentView.parentView.parentView");if(a){a.remove();a.destroy()}}})}),treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,classNames:["user-list-view"],layout:{top:46,bottom:0,left:1,right:1},contentView:function(){return CS.SingleSelectionCategoryView.design()}.property().cacheable()}),})});CS.CategoryPaneMobile=CW.PanelPane.extend({hasNavigationBar:YES,contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),childViews:["toolbarView","treeView"],toolbarView:SC.View.extend({layout:{left:1,right:1,top:0,height:40},childViews:["confirm","title","cancel"],classNames:"user_group_toolbar",confirm:SC.ButtonView.design({layout:{right:5,width:60,centerY:1,height:30},title:"Button.OK".loc(),themeName:"navigationBarSilverDone",action:function(){var e=CS.CategoryAttributes.get("categorySelectView"),a=this.getPath("parentView.parentView.parentView");if(e&&a){var b=CS.CategoryAttributes.getPath("results.firstObject"),d=null;if(b){d=CS.usersSelectedController.getSingleSelectCategories(b);if(d){e.categoryView.set("value",d.get("name"))}else{e.categoryView.set("value","")}e.set("value",d);a.remove();a.destroy();e.extendOK()}else{e.set("value",null);e.categoryView.set("value","");a.remove();a.destroy();e.extendOK()}}}}),title:SC.LabelView.extend({render:function(){arguments.callee.base.apply(this,arguments);if(CS.CategoryAttributes.get("pickerTitle")){this.set("value",CS.CategoryAttributes.get("pickerTitle"))}else{this.set("value","CS.User.Select".loc())}},layout:{centerX:0,centerY:1,width:111,height:30},textAlign:"center",classNames:"user_select_title"}),cancel:SC.ButtonView.design({layout:{left:5,width:60,centerY:1,height:30},title:"Button.Cancel".loc(),themeName:"navigationBarSilver",action:function(){var a=this.getPath("parentView.parentView.parentView");if(a){a.remove();a.destroy()}}})}),treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,layout:{top:84,bottom:0,left:0,right:0},classNames:["user-list-view"],contentView:function(){return CS.SingleSelectionCategoryView.design()}.property().cacheable()})})});CS.SingleSelectionCategoryView=SC.ListView.extend({contentValueKey:"name",contentBinding:"CS.CategoryAttributes.categoriesDelegate.arrangedObjects",selectionBinding:"CS.CategoryAttributes.categoriesDelegate.selection",useToggleSelection:YES,rowHeight:40,select:function(){arguments.callee.base.apply(this,arguments);CS.CategoryAttributes.set("results",this.get("selection").toArray())},deselect:function(){arguments.callee.base.apply(this,arguments);CS.CategoryAttributes.set("results",[])},exampleView:SC.View.extend({classNames:"category-single-select-view".w(),childViews:["label"],render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(this.get("isSelected")){this.$().addClass("sel-category")}})},isSelectedDidChange:function(){if(this.get("isSelected")){this.$().addClass("sel-category")}else{this.$().removeClass("sel-category")}}.observes("isSelected"),label:SC.LabelView.extend({layout:{top:14,left:40,height:17},valueBinding:".parentView.content.name",classNames:["category-name-view"],}),})});sc_require("views/category/category_pane");sc_require("views/category/category_pane_mobile");sc_require("views/category/single_selection_category");CS.CategorySelectView=SC.View.extend({layout:{left:0,right:0,top:0,minHeight:26},childViews:["categoryView"],canEditUser:true,categoriesDelegate:null,spaceId:"",pickerWidth:260,pickerHeight:275,pickerTitle:"",hint:"",isTextArea:true,showBorder:true,showNameTextFontSize:14,showNameNeedBolder:false,extendAction:function(){},extendOK:function(){},heightDidChange:function(){if(this.get("frame").height===0){this.adjust("height",26)}}.observes("frame"),queryCategories:function(){var b=this.get("spaceId");if(b){var a=CS.categoriesSelectedController.getCategoriesController(b);this.set("categoriesDelegate",a)}},render:function(){arguments.callee.base.apply(this,arguments);this.queryCategories();this.invokeLast(function(){if(this.get("canEditUser")==false){this.$().addClass("user-select-disabled")}else{this.$().removeClass("user-select-disabled")}})},valueDidChange:function(){var a=this.get("value");this.categoryView.set("value",this.formatValueToName(a))}.observes("value"),formatValueToName:function(b){var a="";if(b){a=b.get("name")}return a},categoryView:SC.TextFieldView.extend({layout:{left:0,right:0,top:0,minHeight:26},escapeHTML:false,hintBinding:".parentView.hint",isEditable:false,isTextAreaBinding:".parentView.isTextArea",classNames:["category-select-showName-view"],toolTipBinding:".value",render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(this.getPath("parentView.showBorder")==false&&this.$(".border")){this.$(".border").removeClass("border")}if(this.getPath("parentView.showNameTextFontSize")&&this.$(".fields")){var d=this.getPath("parentView.showNameTextFontSize")+"px";this.$(".field").css("font-size",d)}if(this.getPath("parentView.showNameNeedBolder")&&this.$(".fields")){this.$(".field").css("font-weight","bold")}if(this.getPath("parentView.isTextArea")==false&&this.$(".fields")){this.$(".field").css("white-space","nowrap");this.$(".field").css("overflow","hidden");this.$(".field").css("text-overflow","ellipsis")}this.$(".hint").css("line-height","21px");this.$(".hint").css("top","6px")})},initCategorySelectAttributes:function(){var b=this.parentView;if(b){CS.CategoryAttributes.initAttributes(b);var a=b.get("categoriesDelegate");if(a){a.load()}}},mouseDown:function(){if(this.parentView.get("canEditUser")){this.showCategoriesView()}},touchStart:function(){this.mouseDown()},showCategoriesView:function(){this.initCategorySelectAttributes();var e=this.getPath("parentView.value"),a=CS.CategoryAttributes.get("categoriesDelegate");if(a){if(e){var d=CS.categoriesSelectedController.getSelectionByValue(e);a.set("selection",d);CS.CategoryAttributes.set("results",d.toArray())}else{var d=SC.SelectionSet.create();a.set("selection",d);CS.CategoryAttributes.set("results",[])}}if(CW.isMobile()){CS.CategoryPaneMobile.create().append()}else{var b=[2,3,1,0,2];if(this.getPath("parentView.preferMatrix")){b=this.getPath("parentView.preferMatrix")}CS.CategoryPane.create({layout:{centerX:0,centerY:0,width:CS.CategoryAttributes.get("pickerWidth"),height:CS.CategoryAttributes.get("pickerHeight")}}).popup(this.parentView,SC.PICKER_POINTER,b)}},}),});CS.ChatView=SC.View.extend({isMe:true,render:function(a){if(this.get("isMe")){a.addClass("steed-chat-right")}else{a.addClass("steed-chat-left")}a.push('<div class="middle"/><div class="left"/><div class="right"/><div class="top-right"/><div class="bottom-left"/><div class="bottom-right"/><div class="top-left"/><div class="top"/><div class="bottom"/>');arguments.callee.base.apply(this,arguments)}});CS.SectionedViewCollectionSection=CW.SectionedViewCollectionSection.extend({createRows:function(){var e=[],f=this._createItemRows(),g=this._createHeaderRow(),h=this._createFooterRow();if(g){e.push(g)}if(f){e.pushObjects(f)}if(h){e.push(h)}this._itemsHeaderRow=g;this._itemsFooterRow=h;this._itemRows=f;this.set("rows",e)},_createItemRows:function(){var l=[],n=this.get("content")||[],h=this.get("collectionSectionDelegate"),o=CW.SectionedViewCellSelectionStyle.NONE,j=CW.SectionedViewCollectionSection,m=j._ItemRow,k;if(this.get("retainItemSelection")){o=this.get("retainedItemSelectionStyle")}n.forEach(function(a,d){var e=h.collectionSectionCellForContentAtIndex(this,a,d);if(!e){e=this.get("itemCellExample")}var f=h.collectionSectionRowHeightForContentAtIndex(this,a,d);if(!f){f=this.get("itemRowHeight")}d+=this.get("hasItemsHeader")?1:0;var b=this._normalizeItem(a);k=this.createRow(m,d,{content:b,cell:e,height:f});k._svcs_originalItem=a;l.push(k)},this);return l},});CS.SearchBoxView=SC.TextFieldView.extend({classNames:["steed-searchbox"],render:function(b,a){return a&&b.push('<div class="middle"/><div class="left"/><div class="right"/>'),arguments.callee.base.apply(this,arguments)},leftAccessoryView:SC.View.extend({layout:{left:10,top:11,width:27,height:23},value:"magnifying-button"}),rightAccessoryView:SC.ImageButtonView.extend({layout:{right:17,top:15,width:14,height:14},parentValueBinding:".parentView.value",target:"parentView",action:"clearSearch",image:"clear-search",isVisible:function(){return !!this.getPath("parentView.value")}.property("parentValue").cacheable()}),clearSearch:function(){this.set("value","");this.becomeFirstResponder()},shouldRenderBorder:NO,controlSize:SC.AUTO_CONTROL_SIZE});sc_require("views/sectioned_collection_section_view");sc_require("views/search_box");CS.ContactsNavigatableView=CW.NavigatableView.design({title:"User.Invite.Select.Contact".loc(),hasLeftBarButton:YES,leftBarButtonTitle:"Button.Back".loc(),leftBarButtonTheme:"navigationBarSilverBack",leftBarButtonAction:function(){CS.inviteUserNavigatableController.pop()},hasRightBarButton:YES,rightBarButtonTitle:"Button.Invite".loc(),rightBarButtonTheme:"navigationBarSilverDone",rightBarButtonAction:function(){CS.invitUsers.invitContactUsers();if(this.get&&this.get("pane")){this.get("pane").remove()}},childViews:["searchView","contactsView"],searchView:SC.View.extend({layout:{height:44,top:0,left:0,right:0},childViews:["searchBox","searchBtn"],searchBox:CS.SearchBoxView.extend({layout:{top:0,left:0,right:0,height:44},applyImmediately:YES,valueBinding:"CS.invitUsers.keyword",}),searchBtn:SC.ButtonView.extend({layout:{right:10,width:1,height:1,bottom:10},keyEquivalent:"return",action:function(){CS.invitUsers.set("content",CS.invitUsers.filterContacts())}}),}),contactsView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{layout:{top:44,left:0,right:0,bottom:0},horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,classNames:"cw-sectioned-view cw-grouped".w(),contentView:SC.ListView.extend({contentBinding:"CS.invitUsers.content",rowHeight:45,select:function(a){arguments.callee.base.apply(this,arguments);var b=this.getPath("selection.firstObject.selected");this.setPath("selection.firstObject.selected",!b)},canReorderContent:NO,exampleView:SC.View.extend({classNames:"cw-section-row cw-sectioned-view-cell cw-double-line-row".w(),displayProperties:"content.selected".w(),render:function(a,d){var b='<div class="cw-content cw-image-anchor" style="margin-left: 0px; ">';b+='<div class="cw-text ellipsis"><span title="he junzhi" style="display: inline-block; width: 346px">%@</span></div>'.fmt(this.content.name);b+='<div class="cw-detail-text" style="line-height: 23px;"><span>%@</span></div></div>'.fmt(this.content.email);a.push(b);b='<div class="cw-accessory-type"></div>';a.push(b);arguments.callee.base.apply(this,arguments)},update:function(a){if(this.content.selected){a.find(".cw-accessory-type").addClass("cw-detail-checkmark")}else{a.find(".cw-accessory-type").removeClass("cw-detail-checkmark")}}})})})});CS.Geolocation=SC.View.extend({childViews:"showView getCurrentPositionButtonView watchPositionButtonView clearWatchButtonView".w(),showView:SC.TextFieldView.extend({layout:{width:250,height:32,centerX:200,centerY:30},valueBinding:SC.Binding.oneWay(".parentView.watchPositionButtonView.watchID")}),getCurrentPositionButtonView:SC.ButtonView.extend({layout:{width:130,height:24,centerX:0,centerY:0},title:"getCurrentPosition",onSuccess:function(a){alert("Latitude: "+a.coords.latitude+"\nLongitude: "+a.coords.longitude+"\nAltitude: "+a.coords.altitude+"\nAccuracy: "+a.coords.accuracy+"\nAltitude Accuracy: "+a.coords.altitudeAccuracy+"\nHeading: "+a.coords.heading+"\nSpeed: "+a.coords.speed+"\nTimestamp: "+a.timestamp+"\n")},onError:function(a){alert("code: "+a.code+"\nmessage: "+a.message+"\n")},action:function(){navigator.geolocation.getCurrentPosition(this.onSuccess,this.onError)}}),watchPositionButtonView:SC.ButtonView.extend({layout:{width:130,height:24,centerX:0,centerY:30},title:"watchPosition",watchID:null,onSuccess:function(a){alert("Latitude: "+a.coords.latitude+"\nLongitude: "+a.coords.longitude+"\n")},onError:function(a){alert("code: "+a.code+"\nmessage: "+a.message+"\n")},action:function(){var a={timeout:30000};this.set("watchID",navigator.geolocation.watchPosition(this.onSuccess,this.onError,a))}}),clearWatchButtonView:SC.ButtonView.extend({layout:{width:130,height:24,centerX:0,centerY:60},title:"clearWatch",watchIDBinding:".parentView.watchPositionButtonView.watchID",clearWatch:function(){if(this.get("watchID")!=null){navigator.geolocation.clearWatch(this.watchID);this.set("watchID",null)}},action:function(){this.clearWatch()}})});CS.MultipleSelectionGroupView=SC.ListView.extend({contentValueKey:"name",contentBinding:"CS.OrganizationAttributes.organizationDelegate.arrangedObjects",selectionBinding:"CS.OrganizationAttributes.organizationDelegate.selection",canEditContent:YES,rowHeight:30,exampleView:SC.View.extend({classNames:"org-select-item-view".w(),childViews:["checkBoxViews"],checkBoxViews:SC.CheckboxView.extend({classNames:"org-select-item-checkbox".w(),render:function(){arguments.callee.base.apply(this,arguments);var a=this.parentView.content.get("parents").toArray().length;this.adjust("left",(a)*18+5)},value:function(b,a){var g=CS.OrganizationAttributes.getPath("organizationSelectView.value"),f=this.getPath("parentView.parentView.content"),e=this.getPath("parentView.content"),d=CS.OrganizationAttributes.get("useModel");var h=f.filter(function(k){if(d==true){if(g&&g.contains(k)){return true}}else{if(g){for(var j=0;j<g.length;j++){if(g[j].id==k.get("id")){return true}}}}},this);if(a!=undefined){this.addOrRemoveFromSelection(a);a?h.pushObject(e):h.removeObject(e)}return h.contains(e)}.property().cacheable(),addOrRemoveFromSelection:function(e){var d=this.getPath("parentView.parentView"),b=d.get("selection"),f=this.getPath("parentView.content"),a=null;if(e){a=CS.organizationsSelectedController.getOrganizationSelectionSet(b,f,"add")}else{a=CS.organizationsSelectedController.getOrganizationSelectionSet(b,f,"delete")}d.set("selection",a)},titleBinding:SC.Binding.oneWay(".parentView.content.name")})})});sc_require("views/search_box");CS.OrganizationPane=CW.iOSPickerPane.extend({themeName:"iOS",classNames:"iOS-blue".w(),contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),layout:{top:0,bottom:0,left:1,right:1},childViews:["toolbarView","treeView"],toolbarView:SC.View.extend({layout:{left:1,right:1,top:0,height:40},childViews:["confirm","title","cancel"],classNames:"user_group_toolbar",confirm:SC.ButtonView.design({layout:{right:5,width:60,centerY:1,height:30},title:"Button.OK".loc(),themeName:"navigationBarSilverDone",action:function(){var f=CS.OrganizationAttributes.get("organizationSelectView"),h=this.getPath("parentView.parentView.parentView");if(f&&h){var d=CS.OrganizationAttributes.get("isMulti"),e=CS.OrganizationAttributes.get("useModel"),l=CS.OrganizationAttributes.get("modelToOne"),k=CS.OrganizationAttributes.get("showFullName"),m=CS.OrganizationAttributes.get("autoWriteInput");if(d==true){var j=CS.OrganizationAttributes.getPath("organizationDelegate.selection"),b=[];if(j&&j.toArray().length>0){j=j.toArray();b=CS.organizationsSelectedController.getMultiSelectOrganizations(j,e);if(b.length>0){k?b.sortProperty("fullname"):b.sortProperty("name")}var g=k?b.getEach("fullname").join(", "):b.getEach("name").join(", ");if(m){f.organizationView.set("value",g)}f.set("value",b)}else{f.set("value",e?null:b);if(m){f.organizationView.set("value","")}}}else{var j=CS.OrganizationAttributes.getPath("organizationDelegate.selection.firstObject"),a=null;if(j){a=CS.organizationsSelectedController.getSingleSelectOrganizations(j,e);if(a){var g="";if(e){g=k?a.get("fullname"):a.get("name")}else{g=k?a.fullname:a.name}if(m){f.organizationView.set("value",g)}}else{if(m){f.organizationView.set("value","")}}f.set("value",a)}else{f.set("value",null);if(m){f.organizationView.set("value","")}}}h.remove();h.destroy()}}}),title:SC.LabelView.extend({render:function(){arguments.callee.base.apply(this,arguments);if(CS.OrganizationAttributes.get("pickerTitle")){this.set("value",CS.OrganizationAttributes.get("pickerTitle"))}else{this.set("value","CS.Group.Select".loc())}},layout:{centerX:0,centerY:1,width:111,height:30},textAlign:"center",classNames:"user_select_title"}),cancel:SC.ButtonView.design({layout:{left:5,width:60,centerY:1,height:30},title:"Button.Cancel".loc(),themeName:"navigationBarSilver",action:function(){var a=this.getPath("parentView.parentView.parentView");if(a){a.remove();a.destroy()}}})}),treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,classNames:["organization-list-view"],layout:{top:40,bottom:0,left:1,right:1},contentView:function(){return CS.OrganizationAttributes.get("isMulti")?CS.MultipleSelectionGroupView.design():CS.SingleSelectionGroupView.design()}.property().cacheable()}),footToolbarView:SC.View.extend({layout:{left:1,right:1,bottom:0,height:40},childViews:["clear"],clear:SC.ButtonView.design({layout:{right:5,width:58,centerY:0,height:30},title:"Button.Clear".loc(),themeName:"navigationBarSilver",isVisibleBinding:"CS.OrganizationAttributes.canClear",action:function(){CS.OrganizationAttributes.get("organizationDelegate").set("selection",SC.SelectionSet.create())}})})})});sc_require("views/search_box");CS.OrganizationMobile=CW.PanelPane.extend({hasNavigationBar:YES,contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),childViews:["toolbarView","treeView"],toolbarView:SC.View.extend({layout:{left:0,right:0,top:0,height:40},childViews:["confirm","title","cancel"],classNames:"user_group_toolbar_mobile",confirm:SC.ButtonView.design({layout:{right:5,width:60,centerY:1,height:30},title:"Button.OK".loc(),themeName:"navigationBarSilverDone",action:function(){var f=CS.OrganizationAttributes.get("organizationSelectView"),h=this.getPath("parentView.parentView.parentView");if(f&&h){var d=CS.OrganizationAttributes.get("isMulti"),e=CS.OrganizationAttributes.get("useModel"),l=CS.OrganizationAttributes.get("modelToOne"),k=CS.OrganizationAttributes.get("showFullName"),m=CS.OrganizationAttributes.get("autoWriteInput");if(d==true){var j=CS.OrganizationAttributes.getPath("organizationDelegate.selection"),b=[];if(j&&j.toArray().length>0){j=j.toArray();b=CS.organizationsSelectedController.getMultiSelectOrganizations(j,e);if(b.length>0){k?b.sortProperty("fullname"):b.sortProperty("name")}var g=k?b.getEach("fullname").join(", "):b.getEach("name").join(", ");if(m){f.organizationView.set("value",g)}f.set("value",b)}else{f.set("value",e?null:b);if(m){f.organizationView.set("value","")}}}else{var j=CS.OrganizationAttributes.getPath("organizationDelegate.selection.firstObject"),a=null;if(j){a=CS.organizationsSelectedController.getSingleSelectOrganizations(j,e);if(a){var g="";if(e){g=k?a.get("fullname"):a.get("name")}else{g=k?a.fullname:a.name}if(m){f.organizationView.set("value",g)}}else{if(m){f.organizationView.set("value","")}}f.set("value",a)}else{f.set("value",null);if(m){f.organizationView.set("value","")}}}h.remove();h.destroy()}}}),title:SC.LabelView.extend({render:function(){arguments.callee.base.apply(this,arguments);if(CS.OrganizationAttributes.get("pickerTitle")){this.set("value",CS.OrganizationAttributes.get("pickerTitle"))}else{this.set("value","CS.Group.Select".loc())}},layout:{centerX:0,top:15,width:111,height:30},textAlign:"center",classNames:"cw-navigation-bar-title"}),cancel:SC.ButtonView.design({layout:{left:5,width:60,centerY:1,height:30},title:"Button.Cancel".loc(),themeName:"navigationBarSilver",action:function(){var a=this.getPath("parentView.parentView.parentView");if(a){a.remove();a.destroy()}}})}),treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,layout:{top:40,bottom:0,left:0,right:0},classNames:["organization-list-view"],contentView:function(){return CS.OrganizationAttributes.get("isMulti")?CS.MultipleSelectionGroupView.design():CS.SingleSelectionGroupView.design()}.property().cacheable()}),footToolbarView:SC.View.extend({layout:{left:0,right:0,bottom:0,height:40},childViews:["clear"],clear:SC.ButtonView.design({layout:{right:5,width:58,centerY:0,height:30},title:"Button.Clear".loc(),themeName:"navigationBarSilver",isVisibleBinding:"CS.OrganizationAttributes.canClear",action:function(){CS.OrganizationAttributes.get("organizationDelegate").set("selection",SC.SelectionSet.create())}})})})});CS.SingleSelectionGroupView=SC.ListView.extend({contentValueKey:"name",contentBinding:"CS.OrganizationAttributes.organizationDelegate.arrangedObjects",selectionBinding:"CS.OrganizationAttributes.organizationDelegate.selection",actOnSelect:YES,rowHeight:30,exampleView:SC.View.extend({classNames:"org-select-item-view".w(),childViews:["label"],render:function(d,f){arguments.callee.base.apply(this,arguments);if(this.content){var e=this.content.get("id"),b=CS.OrganizationAttributes.get("useModel"),a=CS.OrganizationAttributes.getPath("organizationSelectView.value");if(a){if(b==false&&e==a.id){d.addClass("user_group_select")}else{if(b==true&&e==a.get("id")){d.addClass("user_group_select")}}}}},label:SC.LabelView.extend({valueBinding:".parentView.content.name",classNames:"user_select_value",render:function(e,g){arguments.callee.base.apply(this,arguments);var f=this.parentView.content.get("id"),d=CS.OrganizationAttributes.get("useModel"),b=CS.OrganizationAttributes.getPath("organizationSelectView.value");if(b){if(d==false&&f==b.id){e.removeClass("user_select_value");e.addClass("user_select_value_white")}else{if(d==true&&f==b.get("id")){e.removeClass("user_select_value");e.addClass("user_select_value_white")}}}var a=this.parentView.content.get("parents").toArray().length;this.adjust("left",(a)*18+5)},touchStart:function(){return this.mouseDown()},mouseDown:function(){var b=this.getPath("parentView.parentView.childViews");if(b){CS.organizationsSelectedController.reSetGroupViewsStyle(b)}var a=this.getPath("parentView.content"),e=this.getPath("parentView.parentView"),d=CS.OrganizationAttributes.get("canClear");if(a&&e){var g=e.getPath("selection.firstObject");if(d&&g&&g.get("id")==a.get("id")){var f=SC.SelectionSet.create();e.set("selection",f)}else{CS.organizationsSelectedController.addSelectStyle(this);var f=SC.SelectionSet.create();f.addObject(a);e.set("selection",f)}}},doubleClick:function(){var b=this.getPath("parentView.parentView.parentView.parentView.parentView.parentView");var e=CS.OrganizationAttributes.get("organizationSelectView");if(b&&e){var h=CS.OrganizationAttributes.get("modelToOne"),d=CS.OrganizationAttributes.get("useModel"),f=CS.OrganizationAttributes.get("showFullName"),j=CS.OrganizationAttributes.get("autoWriteInput");var a=this.parentView.parentView.childViews;if(a){CS.organizationsSelectedController.reSetGroupViewsStyle(a)}CS.organizationsSelectedController.addSelectStyle(this);var g=this;this.invokeLast(function(){var l=g.parentView.get("content");selectOrg=null;if(l){selectOrg=CS.organizationsSelectedController.getSingleSelectOrganizations(l,d);if(selectOrg){var k="";if(d){k=f?selectOrg.get("fullname"):selectOrg.get("name")}else{k=f?selectOrg.fullname:selectOrg.name}if(j){e.organizationView.set("value",k)}}else{if(j){e.organizationView.set("value","")}}e.set("value",selectOrg)}else{e.set("value",null);if(j){e.organizationView.set("value","")}}b.remove();b.destroy()})}}})})});CS.inviteUserNavigationView=CW.NavigationView.extend({navigationController:CS.inviteUserNavigatableController,themeName:"navigationViewSilverPanel",layout:{top:0,left:0,right:0,bottom:0},hasNavigationBar:YES,wellViewClassType:SC.View,contentView:CW.NavigatableView.design({titleBinding:SC.Binding.transform(function(a){if(a){return"User.Invite.Title".loc(a.get("name"))}return""}).from("CS.invitUsers.space"),hasLeftBarButton:YES,leftBarButtonTitle:"Button.Cancel".loc(),leftBarButtonTheme:"navigationBarSilver",leftBarButtonAction:function(){CS.invitUsers.clearInput();this.get("pane").remove()},hasRightBarButton:NO,childViews:["sectionedView"],sectionedView:CW.SectionedView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{layout:{top:0,left:0,right:0,bottom:0},horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,style:CW.SectionedViewStyle.GROUPED,init:function(){if(CW.isApp()){this.set("sections",["contactView","inputView","invitButton"])}else{this.set("sections",["inputView","invitButton"])}arguments.callee.base.apply(this,arguments)},contactView:CW.SectionedViewSection.extend({rows:"rowView".w(),rowView:CW.SectionedViewRow.extend({text:"Button.Invite.Contacts".loc(),selectionStyle:CW.SectionedViewCellSelectionStyle.NONE,isLoadContactsBinding:SC.Binding.oneWay("CS.invitUsers._isLoadContacts"),accessoryType:function(){if(this.get("isLoadContacts")){return null}else{return CW.SectionedViewCellAccessoryType.DISCLOSURE_INDICATOR}}.property("isLoadContacts").cacheable(),selected:function(){arguments.callee.base.apply(this,arguments);var e=CS.invitUsers.getPath("originContent.length");if(!e||e==0){SC.debug("");CS.invitUsers.set("_isLoadContacts",YES);var f=function(g){CS.invitUsers.set("_isLoadContacts",NO);CS.invitUsers.set("contacts",g);CS.invitUsers.load();CS.inviteUserNavigatableController.push(CS.ContactsNavigatableView.create())};var d=function(g){CS.invitUsers.set("_isLoadContacts",NO);CS.invitUsers.set("contacts",null);CS.invitUsers.set("content",null)};var b=new ContactFindOptions();b.filter="";b.multiple=true;var a=["name","phoneNumbers","emails"];navigator.contacts.find(a,f,d,b)}else{SC.debug("");CS.inviteUserNavigatableController.push(CS.ContactsNavigatableView.create())}},accessoryView:SC.View.extend({layout:{centerY:0,right:5,width:40,height:40},childViews:["loadingView"],loadingView:CW.SpinnerView.extend({layout:{centerY:0,centerX:0,height:30,width:30},size:30,isVisibleBinding:SC.Binding.bool("CS.invitUsers._isLoadContacts"),})})})}),inputView:CW.SectionedViewSection.extend({headerTitle:"User.Invite.HeaderTitle".loc(),autoResizeHeaderTitle:YES,autoResizeFooterTitle:YES,rows:"rowView".w(),rowView:CW.SectionedViewRow.extend({height:100,allowsSelection:NO,isEnabledBinding:SC.Binding.not("CS.invitUsers._inviteUserMoveInProgress"),accessoryView:SC.TextFieldView.extend({layout:{left:7,top:5,bottom:5,right:10},themeName:"iOS",isTextArea:true,valueBinding:"CS.invitUsers.emailValue",})}),footerTitle:"User.Invite.FooterTitle".loc()}),invitButton:CW.SectionedViewSection.extend({rows:"rowView".w(),rowView:CW.SectionedViewButtonRow.extend({selectionStyle:CW.SectionedViewCellSelectionStyle.NONE,title:"Button.Invite".loc(),selected:function(){arguments.callee.base.apply(this,arguments);if(CS.invitUsers.get("emailValue").trim().length>0){CS.invitUsers.invitInputUsers()}var a=this.getPath("owner.pane");if(a){a.remove()}}})})})})});CS.LeatherContainerView=SC.View.extend(CW.Animatability,{classNames:["leather-container"],render:function(b,a,d){d&&(a.push('<div class="left"/><div class="right"/>'),a.push('<div class="top"/><div class="bottom"/>'),a.push('<div class="top-left"/><div class="bottom-left"/>'),a.push('<div class="top-right"/><div class="bottom-right"/>')),b(a,d)}.enhance()});CS.NotificationCenterView=SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,layout:{left:50,right:50,top:20,height:600},hasHorizontalScroller:NO,classNames:["notification-center"],contentView:SC.ListView.extend(SC.FlowedLayout,{contentBinding:"CS.notificationCenterController.topList",exampleView:SC.View.extend(SC.FlowedLayout,{childViews:"topView listView".w(),topView:SC.View.extend({layout:{left:0,right:0,height:23},classNames:"top-view",render:function(a,b){a.push('<div class="middle"/><div class="left"/><div class="right"/>');arguments.callee.base.apply(this,arguments)},childViews:"iconView titleView buttonView".w(),iconView:SC.ImageView.extend({layout:{left:7,width:18,height:19,centerY:0},value:"email",}),titleView:SC.LabelView.extend(SC.Control,{classNames:"text-weight",layout:{left:28,top:4,width:100,height:19},valueBinding:".parentView.parentView.content.appName",mouseDown:function(){}}),buttonView:SC.ImageButtonView.extend(SC.Control,{layout:{top:1,right:12,width:20,height:20},image:"exit",action:function(){var a=this.parentView.parentView.content.get("appName");CS.notificationCenterController.deleteAppNamesByAppName(a)}}),}),listView:SC.ListView.extend({layout:{top:23},rowSpacing:0,appNameBinding:SC.Binding.oneWay(".parentView.content.appName"),content:function(){return CS.notificationCenterController.getSubList(this.get("appName"))}.property("appName").cacheable(),mouseDown:function(){arguments.callee.base.apply(this,arguments)},exampleView:SC.View.extend(SC.Control,SC.AutoResize,{classNames:["list-view"],shouldResizeHeight:YES,childViews:"datetimeView alertTitleView alertView isreadView buttomLineView".w(),datetimeView:SC.LabelView.extend({layout:{right:0,width:82,top:3,height:14},classNames:"text-weight",valueBinding:".parentView.content.created",formatter:function(a){return a?a.format("yyyy-MM-dd HH:mm:ss"):""},}),alertTitleView:SC.LabelView.extend({layout:{left:28,top:3,height:14},classNames:"text-weight",valueBinding:".parentView.content.alertTitle"}),alertView:SC.LabelView.extend({layout:{left:28,top:17},valueBinding:".parentView.content.alert",}),isreadView:SC.ImageView.extend({layout:{left:8,width:15,height:15,centerY:0},value:"isread",}),buttomLineView:SC.View.extend({layout:{left:0,right:0,bottom:0,height:2},classNames:"button-line-view",render:function(a){a.push('<div class="middle"/><div class="left"/><div class="right"/>');arguments.callee.base.apply(this,arguments)},}),}),}),}),})});CS.NumberView=SC.TextFieldView.extend({fieldVal:"",digits:0,minValue:null,maxValue:null,isRequired:false,isValid:function(){return CS.Number.computeIsValid(this.get("fieldVal"),this.get("isRequired"),this.get("minValue"),this.get("maxValue"))}.property(".fieldVal",".value",".minValue",".maxValue",".digits",".isRequired").cacheable(),value:function(b,a){var d=this.get("fieldVal");if(a!=undefined){this.set("fieldVal",a.toString())}else{var e=this.get("isFirstResponder");if(e){return d}else{return this.getShowNumber(d)}}}.property(".fieldVal",".digits").cacheable(),fieldDidFocus:function(){arguments.callee.base.apply(this,arguments);var a=this.get("fieldVal");this.$input().val(a)},fieldDidBlur:function(){arguments.callee.base.apply(this,arguments);var a=this.get("fieldVal");this.$input().val(this.getShowNumber(a))},getShowNumber:function(b){if(b==undefined||b==null){return""}var a=CS.Number.getShowNumber(b,this.get("digits"),this.get("isRequired"),this.get("minValue"),this.get("maxValue"));var d=a.replace(/,/g,"");if(b.toString()!==d){this.set("fieldVal",d)}return a}});sc_require("views/group/organization_pane");sc_require("views/group/organization_pane_mobile");sc_require("views/group/single_selection_group");sc_require("views/group/multiple_selection_group");CS.OrganizationSelectView=SC.View.extend({layout:{left:0,right:0,top:0,bottom:0,minHeight:26},classNames:["orgs-select"],childViews:["organizationView"],isMulti:YES,canEditOrg:true,showFullName:false,organizationDelegate:null,spaceId:"",useModel:false,modelToOne:false,canClear:true,autoWriteInput:true,pickerWidth:360,pickerHeight:400,pickerTitle:"",hint:"",isTextArea:true,showBorder:true,showNameTextFontSize:14,showNameNeedBolder:false,companyId:"",extendAction:function(){},heightDidChange:function(){if(this.get("frame").height===0){this.adjust("height",26)}}.observes("frame"),queryOrganizations:function(){var d=this.get("isMulti");var e=this.get("spaceId");var a=this.get("companyId");if(e){var b=CS.organizationsSelectedController.getOrganizationsController(e,d,a);this.set("organizationDelegate",b)}},render:function(){arguments.callee.base.apply(this,arguments);this.queryOrganizations();this.invokeLast(function(){if(this.get("canEditOrg")==false){this.$().addClass("organization-select-disabled")}else{this.$().removeClass("organization-select-disabled")}})},valueDidChange:function(){var a=this.get("value");this.setvalueToOrganizationView(a)}.observes("value"),setvalueToOrganizationView:function(d){var a=[];if(d){var b=this.get("showFullName");if(d.length>0){d.sortProperty("name")}if(d instanceof CS.Organization){a.push(d.get("fullname")?d.get("fullname"):d.get("name"))}else{if(d.length&&(d.length>0||d.length()>0)){d.forEach(function(e){if(e instanceof CS.Organization){a.push(e.get("fullname")?e.get("fullname"):e.get("name"))}else{if(e){a.push(e.fullname?e.fullname:e.name)}}},this)}else{a.push(d.fullname?d.fullname:d.name)}}}this.organizationView.set("value",a.join(", "))},organizationView:SC.TextFieldView.extend({layout:{minHeight:26*1,},toolTipBinding:".value",escapeHTML:false,hintBinding:".parentView.hint",isEditable:false,isTextAreaBinding:".parentView.isTextArea",render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){height=26;if(this.get("parentView")&&this.get("parentView").get("isMulti")&&this.get("parentView").get("isTextArea")==true){height=height*3}this.adjust("height",height);if(this.get("parentView")){this.get("parentView").adjust("height",height)}if(this.getPath("parentView.showBorder")==false&&this.$(".border")){this.$(".border").removeClass("border")}if(this.getPath("parentView.showNameTextFontSize")&&this.$(".fields")){var d=this.getPath("parentView.showNameTextFontSize")+"px";this.$(".field").css("font-size",d)}if(this.getPath("parentView.showNameNeedBolder")&&this.$(".fields")){this.$(".field").css("font-weight","bold")}if(this.getPath("parentView.isTextArea")==false&&this.$(".fields")){this.$(".field").css("white-space","nowrap");this.$(".field").css("overflow","hidden");this.$(".field").css("text-overflow","ellipsis")}})},initOrganizationSelectAttributes:function(){var a=this.parentView;if(a){CS.OrganizationAttributes.initAttributes(a)}},mouseDown:function(){this.parentView.extendAction();if(this.parentView.get("canEditOrg")){this.showGroupsView()}},touchStart:function(){this.mouseDown()},showGroupsView:function(){this.initOrganizationSelectAttributes();var d=this.getPath("parentView.value"),a=CS.OrganizationAttributes.get("organizationDelegate");if(d&&a){var b=CS.organizationsSelectedController.getSelectionByValue(d);a.set("selection",b)}if(CW.isMobile()){CS.OrganizationMobile.create({}).append()}else{CS.OrganizationPane.create({layout:{centerX:0,centerY:0,width:CS.OrganizationAttributes.get("pickerWidth"),height:CS.OrganizationAttributes.get("pickerHeight")}}).popup(this.parentView,SC.PICKER_POINTER,[2,3,1,0,2])}},valueDidChange:function(){var a=this.$input();if(a&&a[0]){a[0].title=this.get("value")}}.observes("value")})});CS.SectionedViewTextFieldRow=CW.SectionedViewTextFieldRow.extend({value:"",title:"",hint:"",defaultLayout:{left:7,top:5,bottom:5,right:10}});sc_require("views/notification_center");CS.ShowNotificationCenterView=SC.View.extend({layout:{left:50,right:50,top:20,height:800},childViews:"buttonView notificationCenterView".w(),buttonView:SC.ImageButtonView.extend({layout:{centerX:0,top:20,width:28,height:28},classNames:["show-notification-center"],action:function(){CS.notificationCenterController.load();this.get("parentView").get("notificationCenterView").set("layout",{left:50,right:50,top:50,height:500});this.get("parentView").get("notificationCenterView").set("isVisible",true)},}),notificationCenterView:CS.NotificationCenterView.extend({isVisible:false,})});sc_require("controllers/month_calendar_view_controller");sc_require("views/calendar/month_calendar");CS.DatePickerCalendarView=CS.MonthCalendarView.extend({classNames:"date-picker",_separatorDivStr:'<div class="date-picker generic-separator">',_divEndStr:"</div>",blocksIEDeactivate:YES,render:function(b,a){var d=arguments.callee.base.apply(this,arguments);return a&&b.push(this._separatorDivStr,this._divEndStr),d},selectOnMouseUp:YES,touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},mouseDown:function(b){var a=b.target||b.srcElement,d=SC.$(a);return this._selectedDate=d.attr("d"),this._selectedTarget=a,d.addClass("active"),YES},mouseDragged:function(b){var a=b.target||b.srcElement,d=SC.$(a).attr("d");return this._selectedDate!==d?SC.$(this._selectedTarget).removeClass("active"):SC.$(this._selectedTarget).addClass("active"),NO},touchesDragged:function(b,a){var d=a[0];return d&&d.target?this.mouseDragged(d):NO},selectDateChanged:function(a){if(a){return this.parentView&&this.parentView.dismiss()}}.observes("this.parentView.owner.parentView.value")}),CS.DatePicker=CW.PickerPane.extend({HEADER_HEIGHT:64,ROW_HEIGHT:23,FOOTER_HEIGHT:10,classNames:"date-picker",layout:{width:205,height:200,},acceptsFirstResponder:NO,acceptsKeyPane:NO,isModal:YES,shouldDismissAutomatically:YES,modalPane:SC.ModalPane.extend({sendEvent:function(d,a,f){var b=arguments.callee.base.apply(this,arguments);return a.redirectMouseToView?a.redirectMouseToView:b}}),contentView:CS.MonthCalendarView.extend({layout:{width:205,height:200,centerX:0,centerY:0,},classNames:"date-picker",selectedDateBinding:".parentView.selectedDate",useLongDay:NO,highlightSelectedPeriod:YES,useCustomDateFormatting:NO,showNextPrevButtons:YES,acceptsSingleClick:YES,init:function(){arguments.callee.base.apply(this,arguments);this.delegate=this.parentView}}),dismiss:function(){var a=this.get("owner");return a&&a.resignFirstResponder(),arguments.callee.base.apply(this,arguments)},mouseDown:function(a){return this.modalPaneDidClick(a)},modalPaneDidClick:function(b){var a=this.get("frame");return this.get("parentView")&&(a=this.get("parentView").convertFrameToView(a,null)),b.pageX>=a.x&&b.pageY>=a.y&&b.pageX<=a.x+a.width&&b.pageY<=a.y+a.height?NO:this.gotClickOutsideFrame(b)},gotClickOutsideFrame:function(f){var b=$(f.target).css("display");var g=document.elementFromPoint(f.clientX,f.clientY);var d=$(g).view()[0],a=this.get("owner");(!d||d!==this.get("owner"))&&this.dismiss();if(d&&d.get("pane")!==this.getPath("owner.pane")){return}return f.target=g,d&&d.get("pane")&&a&&a.passThroughClickForView&&a.passThroughClickForView(d)&&(f.redirectMouseToView=d.get("pane").sendEvent("mouseDown",f,d)),NO},sendEvent:function(d,a,f){var b=arguments.callee.base.apply(this,arguments);return a.redirectMouseToView?a.redirectMouseToView:b},changeMonthPeriod:function(a){this.contentView.set("viewingMonth",CW.Date.create(this.contentView.get("viewingMonth")).date(1).incrementMonth(a?1:-1).done())},formatCustomDate:function(d,a,f){var b=a.date();return this.dateShouldHaveIndicator(a)&&(b+=this.indicatorForDate(a)),b},indicatorForDate:function(a){return"<div class='indicator'></div>"},dateShouldHaveIndicator:function(a){return NO},monthSingleClicked:function(){this.owner.set("_cwDate",this.contentView.selectedDate);this.dismiss()},});CS.TokenedEntryView=SC.View.extend(SC.FlowedLayout,{classNames:"tokened-entry",acceptsFirstResponder:function(){return this.get("isEnabled")}.property("isEnabled"),pattern:"%{MM}/%{DD}/%{YYYY}",selectedToken:undefined,isEnabled:YES,handlers:{},tokenedEntryHandlerForToken:function(b,a){var d=this.get("handlers");return d?d[a]:undefined},tokenedEntryTextForToken:function(b,a){var d=this.callHandlerMethod(a,"text");if(d===undefined||d===null){d=a}if(d!=null&&d!==undefined){return d.toString()}},tokenedEntryWillSelectToken:function(b,a){return this.callHandlerMethod(a,"willSelect")},tokenedEntryDidSelectToken:function(b,a){return this.callHandlerMethod(a,"didSelect")},tokenedEntryWillDeselectToken:function(b,a){return this.callHandlerMethod(a,"willDeselect")},tokenedEntryDidDeselectToken:function(b,a){return this.callHandlerMethod(a,"didDeselect")},tokenedEntryUpArrowForToken:function(b,a){return this.callHandlerMethod(a,"upArrow")},tokenedEntryDownArrowForToken:function(b,a){return this.callHandlerMethod(a,"downArrow")},tokenedEntryCanAcceptCharacterForToken:function(d,a,f,b){return this.callHandlerMethod(a,"canAcceptCharacter",f,b)},tokenedEntryTextIsCompleteForToken:function(b,a,d){return this.callHandlerMethod(a,"textIsComplete",d)},tokenedEntryPreviewForText:function(b,a,d){return this.callHandlerMethod(a,"previewForText",d)},tokenedEntryDidEnterTextForToken:function(b,a,d){return this.callHandlerMethod(a,"didEnterText",d)},didBecomeKeyResponderFrom:function(b){if(!this.get("selectedToken")){var a=b===this.get("nextValidKeyView");this.selectToken(this.get("tokens")[a?this.get("tokens").length-1:0])}},willLoseKeyResponderTo:function(){this.selectToken(null)},selectNextToken:function(){var b=this.get("tokens"),a=this.get("selectedToken");this.selectToken(b[(b.indexOf(a)+1)%b.length])},selectPreviousToken:function(){var b=this.get("tokens"),a=this.get("selectedToken"),d=b.indexOf(a)-1;d<0&&(d=b.length-1),this.selectToken(b[d])},hasNextToken:function(){var b=this.get("tokens"),a=this.get("selectedToken"),d=b.indexOf(a)+1;return d>=b.length?NO:YES},hasPreviousToken:function(){var b=this.get("tokens"),a=this.get("selectedToken"),d=b.indexOf(a)-1;return d<0?NO:YES},selectToken:function(b){var a=this.get("selectedToken");if(a===b){return}this._tk_bufferedText&&this.completeText(),this.tokenedEntryWillDeselectToken(this,a),this.tokenedEntryWillSelectToken(this,b),this.set("selectedToken",b),this.tokenedEntryDidDeselectToken(this,a),this.tokenedEntryDidSelectToken(this,b)},callHandlerMethod:function(d,a){var f=this.tokenedEntryHandlerForToken(this,d);if(!f||!f[a]){return undefined}var b=SC.$A(arguments).slice(2);return b.unshift(this),f[a].apply(f,b)},tokens:function(){var a=[];return this.get("pattern").replace(/%\{(.*?)\}/g,function(b,d){a.push(d)}),a}.property("pattern").cacheable(),displayProperties:"isEnabled tokens selectedToken pattern".w(),render:function(b){this.get("isEnabled")||b.addClass("disabled"),b.push("<div class='left'></div><div class='middle'></div><div class='right'></div>");var a=this;b.push(this.get("pattern").replace(/%\{(.*?)\}/g,function(g,h){var f="<span aria-role='textbox' tabindex='0' tk_token='"+h+"' class='token token-"+h,d=a.get("selectedToken")===h;return d&&(f+=" sel",a._tk_bufferedText&&(f+=" preview-mode")),f+="'>",d&&a._tk_bufferedText?f+=a.tokenedEntryPreviewForText(this,h,a._tk_bufferedText):f+=SC.RenderContext.escapeHTML(a.tokenedEntryTextForToken(this,h)),f+="</span>",f})),this._tk_lastRenderedTokens=this.get("tokens")},update:function(g){if(this._tk_lastRenderedTokens!==this.get("tokens")){var b=g[0],h=this.renderContext(b);this.render(h),h.update();return}var f=this.get("tokens");for(var a=0,d=f.length;a<d;a++){this.updateToken(f[a])}this._tk_lastRenderedTokens=this.get("tokens")},updateToken:function(d){var a=this.$(".token-"+d),f=this.get("selectedToken")===d,b=f&&this._tk_bufferedText;b?a.html(this.tokenedEntryPreviewForText(this,d,this._tk_bufferedText)):a.text(this.tokenedEntryTextForToken(this,d)),a.setClass("sel",f),a.setClass("preview-mode",b)},selectTokenForEvent:function(b){if(!this.get("isEnabled")){return}var a=b.target;a.nodeType===3&&(a=a.parentNode),a=$(a);if(a.hasClass("token")){var d=a.attr("tk_token");if(!d){return}this.becomeFirstResponder(),this.selectToken(d)}return YES},touchStart:function(a){return this.selectTokenForEvent(a)},mouseDown:function(a){return this.selectTokenForEvent(a)},mouseDragged:function(a){return this.selectTokenForEvent(a)},mouseUp:function(a){return this.selectTokenForEvent(a)},keyDown:function(b){if(b.which===9||b.keyCode===9){b.preventDefault();var a;return b.shiftKey?this.hasPreviousToken()?this.selectPreviousToken():a=this.get("previousValidKeyView"):this.hasNextToken()?this.selectNextToken():a=this.get("nextValidKeyView"),a?a.becomeFirstResponder():b.allowDefault(),YES}var d=this.interpretKeyEvents(b);return d?d:NO},moveLeft:function(b,a){return this.selectPreviousToken(),YES},moveRight:function(b,a){return this.selectNextToken(),YES},moveUp:function(b,a){return this.tokenedEntryUpArrowForToken(this,this.get("selectedToken"),a),YES},moveDown:function(b,a){return this.tokenedEntryDownArrowForToken(this,this.get("selectedToken"),a),YES},insertText:function(b,a){var d=this._tk_bufferedText||"";if(!this.tokenedEntryCanAcceptCharacterForToken(this,this.get("selectedToken"),b,d+b)){return}return d=this._tk_bufferedText=d+b,this.tokenedEntryTextIsCompleteForToken(this,this.get("selectedToken"),d)?(this.completeText(),YES):(this.scheduleTextCompletion(),YES)},scheduleTextCompletion:function(){this.updateToken(this.get("selectedToken")),this._tk_timer&&this._tk_timer.invalidate(),this._tk_timer=SC.Timer.schedule({target:this,action:"completeText",interval:2000})},completeText:function(){this._tk_timer&&this._tk_timer.invalidate(),this._tk_timer=null,this._tk_bufferedText&&this._tk_bufferedText!==""&&this.tokenedEntryDidEnterTextForToken(this,this.get("selectedToken"),this._tk_bufferedText),this._tk_bufferedText=null,this.updateToken(this.get("selectedToken"))}});CS.DigitsToken={digits:2,text:function(b){var a=this.getValue(b).toString();while(a.length<this.get("digits")){a="0"+a}return a}};sc_require("views/tokened_entry/tokened_entry_view");sc_require("views/tokened_entry/digits_token");CS.DateTokenedEntryView=CS.TokenedEntryView.extend({date:new Date,datePattern:"yyyy-MM-dd",pattern:function(){var b="%{MM}/%{DD}/%{YYYY}",a=this.get("datePattern");return a&&(b=a.replace(/M+/gi,"%{MM}").replace(/d+/gi,"%{DD}").replace(/y+/gi,"%{YYYY}")),b}.property("datePattern").cacheable(),displayProperties:"date".w(),handlers:{MM:SC.Object.create(CS.DigitsToken,{digits:2,upArrow:function(b){var a=b.get("date");a.setMonth(a.getMonth()+1),b.set("date",a),b.notifyPropertyChange("date")},downArrow:function(b){var a=b.get("date");a.setMonth(a.getMonth()-1),b.set("date",a),b.notifyPropertyChange("date")},canAcceptCharacter:function(f,b,g){if(b==="/"||b==="-"||b==="."){return CS.TokenedEntryView.SKIP}if(parseInt(b,10).toString()!==b){return NO}var d=new Date,a=f.get("date");return d.setTime(a.getTime()),d.setMonth(parseInt(g,10)-1),d.getFullYear()===a.getFullYear()?YES:NO},previewForText:function(b,a){var d="<span class='preview'>"+a+"</span>";return a.length<2&&(d="0"+d),d},textIsComplete:function(b,a){return a.length>1||a[0]>1?YES:NO},didEnterText:function(b,a){var d=b.get("date");d.setMonth(parseInt(a,10)-1),b.set("date",d),b.notifyPropertyChange("date")},getValue:function(b){var a=b.get("date");return a.getMonth()+1}}),DD:SC.Object.create(CS.DigitsToken,{digits:2,upArrow:function(b){var a=b.get("date");a.setDate(a.getDate()+1),b.set("date",a),b.notifyPropertyChange("date")},downArrow:function(b){var a=b.get("date");a.setDate(a.getDate()-1),b.set("date",a),b.notifyPropertyChange("date")},canAcceptCharacter:function(f,b,g){if(b==="/"){return CS.TokenedEntryView.SKIP}if(parseInt(b,10).toString()!==b){return NO}var d=new Date,a=f.get("date");return d.setTime(a.getTime()),d.setDate(parseInt(g,10)),d.getMonth()===a.getMonth()&&d.getFullYear()===a.getFullYear()?YES:NO},previewForText:function(b,a){var d="<span class='preview'>"+a+"</span>";return a.length<2&&(d="0"+d),d},textIsComplete:function(b,a){return a.length>1||a[0]>3?YES:NO},didEnterText:function(b,a){var d=b.get("date");d.setDate(parseInt(a,10)),b.set("date",d),b.notifyPropertyChange("date")},getValue:function(b){var a=b.get("date");return a.getDate()}}),YYYY:SC.Object.create(CS.DigitsToken,{digits:4,upArrow:function(b){var a=b.get("date");a.setFullYear(a.getFullYear()+1),b.set("date",a),b.notifyPropertyChange("date")},downArrow:function(b){var a=b.get("date");a.setFullYear(a.getFullYear()-1),b.set("date",a),b.notifyPropertyChange("date")},canAcceptCharacter:function(b,a,d){return parseInt(a,10).toString()===a},previewForText:function(g,b){var h=new Date,f=h.getFullYear().toString(),a="<span class='preview'>"+b+"</span>";for(var d=f.length-b.length-1;d>=0;d--){a=f[d]+a}return a},textIsComplete:function(b,a){return a.length===4?YES:NO},didEnterText:function(g,b){var j=new Date,f=j.getFullYear().toString(),a=b;for(var d=f.length-b.length-1;d>=0;d--){a=f[d]+a}var h=g.get("date");h.setFullYear(parseInt(a,10)),g.set("date",h),g.notifyPropertyChange("date")},getValue:function(b){var a=b.get("date");return a.getFullYear()}})}});sc_require("views/tokened_entry/date_tokened_entry_view");sc_require("views/tokened_entry/cs_date_picker");CS.DateEntryView=CS.DateTokenedEntryView.extend({classNames:["date-entry-view"],cwDate:CW.Date.create().now().done(),_cwDate:function(b,a){var d=this.get("cwDate");return a&&(d&&(a=CW.Date.create(a,CW.DATE_TIME),d=CW.Date.create(d,CW.DATE_TIME),a.hours(d.hours()),a.minutes(d.minutes()),a=a.done()),d=a,this.setCWDate(d)),d}.property("cwDate").cacheable(),date:function(f,b){b&&this.setCWDate(CW.Date.create(b,CW.DATE_TIME).done());var g=CW.Date.create(this.get("cwDate"),CW.DATE_TIME),d=g.dateObject(),a=new Date;return a.setTime(d.getTime()),d._isUsingUTC&&a.setMinutes(a.getMinutes()+a.getTimezoneOffset()),a}.property("cwDate").cacheable(),mouseDown:function(a){this.showDatePicker();return this.selectTokenForEvent(a)},touchStart:function(a){this.showDatePicker();return this.selectTokenForEvent(a)},showDatePicker:function(){var b=this.get("frame"),a=this.convertFrameToView(b,null);this.picker=CS.DatePicker.create({owner:this,selectedDateBinding:".owner._cwDate",}),this.picker.popup(this)},didBecomeFirstResponder:function(){arguments.callee.base.apply(this,arguments)},willLoseFirstResponder:function(){if(this.picker){this.picker.remove(),this.picker.destroy(),arguments.callee.base.apply(this,arguments)}},keyDown:function(a){return a.commandCodes().contains("escape")?(this.resignFirstResponder(),a.stopPropagation(),a.preventDefault(),YES):arguments.callee.base.apply(this,arguments)},setCWDate:function(a){this.set("cwDate",a)},passThroughClickForView:function(a){return a.kindOf(CS.TokenedEntryView)?YES:NO},});sc_require("views/tokened_entry/digits_token");CS.HoursToken=SC.clone(CS.DigitsToken),SC.mixin(CS.HoursToken,{digits:2,is24Hour:NO,startAt0:NO,upArrow:function(b){var a=b.get("date");a.setHours(a.getHours()+1),b.set("date",a),b.notifyPropertyChange("date")},downArrow:function(b){var a=b.get("date");a.setHours(a.getHours()-1),b.set("date",a),b.notifyPropertyChange("date")},canAcceptCharacter:function(f,b,g){if(b===":"){return CS.TokenedEntryView.SKIP}if(parseInt(b,10).toString()!==b){return NO}var d=this.get("is24Hour"),a=d?24:12;return parseInt(g,10)>a?NO:YES},previewForText:function(b,a){var d="<span class='preview'>"+a+"</span>";return a.length<2&&(d="0"+d),d},textIsComplete:function(b,a){var d=this.get("is24Hour")?2:1;return a.length>1||a[0]>d?YES:NO},didEnterText:function(f,b){var g=f.get("date"),d=parseInt(b,10),a=this.get("is24Hour");a?d===24&&(d=0):(d===12&&(d=0),g.getHours()>=12&&(d+=12)),g.setHours(d),f.set("date",g),f.notifyPropertyChange("date")},getValue:function(b){var a=b.get("date"),d=a.getHours();return this.get("is24Hour")||(d%=12),this.get("startAt0")||d===0&&(d=this.get("is24Hour")?24:12),d}});sc_require("views/tokened_entry/digits_token");CS.MinutesToken=SC.clone(CS.DigitsToken),SC.mixin(CS.MinutesToken,{digits:2,upArrow:function(b){var a=b.get("date");a.setMinutes(a.getMinutes()+1),b.set("date",a),b.notifyPropertyChange("date")},downArrow:function(b){var a=b.get("date");a.setMinutes(a.getMinutes()-1),b.set("date",a),b.notifyPropertyChange("date")},canAcceptCharacter:function(b,a,d){return parseInt(a,10).toString()!==a?NO:parseInt(d,10)<60},previewForText:function(b,a){var d="<span class='preview'>"+a+"</span>";return a.length<2&&(d="0"+d),d},textIsComplete:function(b,a){return a.length>1||a[0]>5?YES:NO},didEnterText:function(b,a){var d=b.get("date");d.setMinutes(parseInt(a,10)),b.set("date",d),b.notifyPropertyChange("date")},getValue:function(b){var a=b.get("date");return a.getMinutes()}});sc_require("views/tokened_entry/tokened_entry_view");sc_require("views/tokened_entry/tokens/hours_token");sc_require("views/tokened_entry/tokens/minutes_token");CS.TimeTokenedEntryView=CS.TokenedEntryView.extend({date:new Date,timePattern:"HH:mm",pattern:function(){var b="%{hh}:%{mm}",a=this.get("timePattern");return a&&(b=a.replace(/h+/g,"%{hh}").replace(/H+/g,"%{HH}").replace(/k+/g,"%{kk}").replace(/K+/g,"%{KK}").replace(/M+/gi,"%{MM}")),b}.property("timePattern").cacheable(),displayProperties:"date".w(),handlers:{hh:SC.Object.create(CS.HoursToken,{is24Hour:NO,startAt0:NO}),HH:SC.Object.create(CS.HoursToken,{is24Hour:YES,startAt0:YES}),KK:SC.Object.create(CS.HoursToken,{is24Hour:NO,startAt0:YES}),kk:SC.Object.create(CS.HoursToken,{is24Hour:YES,startAt0:NO}),MM:SC.Object.create(CS.MinutesToken,{})}});sc_require("views/tokened_entry/time_tokened_entry_view");CS.TimeEntryView=CS.TimeTokenedEntryView.extend({classNames:["time-text-field"],cwDate:CW.Date.create().now(),date:function(f,b){b&&this.setCWDate(CW.Date.create(b,CW.DATE_TIME).done());var g=CW.Date.create(this.get("cwDate"),CW.DATE_TIME),d=g.dateObject(),a=new Date;return a.setTime(d.getTime()),d._isUsingUTC&&a.setMinutes(a.getMinutes()+a.getTimezoneOffset()),a}.property("cwDate").cacheable(),setCWDate:function(a){this.set("cwDate",a)},mouseDown:function(a){this.showTimeView(a);return this.selectTokenForEvent(a)},touchStart:function(a){this.showTimeView(a);return this.selectTokenForEvent(a)},showTimeView:function(b){var a=$(b.target).attr("tk_token");if(a=="HH"){this.picker=CS.TimePicker.create({owner:this});this.picker.popup(this)}else{if(a=="MM"){this.picker=CS.minutePicker.create({owner:this});this.picker.popup(this)}}},setCWDate:function(a){this.set("cwDate",a)},passThroughClickForView:function(a){return a.kindOf(CS.TokenedEntryView)?YES:NO}});sc_require("views/tokened_entry/date_entry_view");sc_require("views/tokened_entry/time_entry_view");CS.DateTimeView=SC.View.extend({childViews:["dateView","timeView"],layout:{top:0,left:10,height:22},minHeight:null,parentNodeCss:null,value:null,cwDate:function(){var d=this.get("value");if(d&&d.indexOf("T")>0){d=d.replace(/T/," ")}if(d&&d.length>0){var b=d.split(" ");if(b.length===2){var a=b[0].split("-"),e=b[1].split(":");if(a.length===3&&e.length>=2){return[a.join(""),a[0],a[1],a[2],e[0],e[1],0]}}}return CW.Date.create().done()}.property("value").cacheable(),render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(!this.get("value")&&this.get("isVisible")==true){this.set("value",new Date().format("yyyy-MM-ddTHH:mm:ss"))}if(this.get("minHeight")){this.reSetMinHeight()}})},reSetMinHeight:function(){var a=this.get("minHeight");if(a&&this.dateView&&this.timeView){this.adjust("minHeight",a);this.$().css("line-height",(a-6)+"px");this.dateView.adjust("minHeight",a);this.timeView.adjust("minHeight",a)}},dateView:CS.DateEntryView.design({classNames:"cs-date-view".w(),layout:{top:0,left:0,width:90,height:22},cwDateBinding:".parentView.cwDate",init:function(){arguments.callee.base.apply(this,arguments)},setCWDate:function(a){if(a!=null&&a!=""&&a.length>0){var b=a[1]+"-"+CS.leftPad(a[2],"0",2)+"-"+CS.leftPad(a[3],"0",2)+"T"+CS.leftPad(a[4],"0",2)+":"+CS.leftPad(a[5],"0",2);this.parentView.set("value",b)}},didBecomeFirstResponder:function(){arguments.callee.base.apply(this,arguments);if(this.parentView&&this.parentView.parentNodeCss){$("."+this.parentView.parentNodeCss+" div.cs-date-view").addClass("sel")}},willLoseFirstResponder:function(){arguments.callee.base.apply(this,arguments);if(this.parentView&&this.parentView.parentNodeCss){$("."+this.parentView.parentNodeCss+" div.cs-date-view").removeClass("sel")}}}),timeView:CS.TimeEntryView.design({classNames:"cs-time-view".w(),layout:{top:0,left:100,width:50,height:22},cwDateBinding:".parentView.cwDate",setCWDate:function(a){if(a!=null&&a!=""&&a.length>0){var b=a[1]+"-"+CS.leftPad(a[2],"0",2)+"-"+CS.leftPad(a[3],"0",2)+"T"+CS.leftPad(a[4],"0",2)+":"+CS.leftPad(a[5],"0",2);this.parentView.set("value",b)}},didBecomeFirstResponder:function(){if(this.parentView&&this.parentView.parentNodeCss){$("."+this.parentView.parentNodeCss+" div.cs-time-view").addClass("sel")}arguments.callee.base.apply(this,arguments)},willLoseFirstResponder:function(){if(this.parentView&&this.parentView.parentNodeCss){$("."+this.parentView.parentNodeCss+" div.cs-time-view").removeClass("sel")}arguments.callee.base.apply(this,arguments)}})});sc_require("views/tokened_entry/date_entry_view");CS.DateView=SC.View.extend({childViews:"dateView".w(),minHeight:null,layout:{top:0,left:10,height:22},value:null,cwDate:function(){var b=this.get("value");if(b&&b.length>0){var a=b.split("-");if(a.length===3){return[a.join(""),a[0],a[1],a[2],0,0,0]}}return CW.Date.create().done()}.property("value").cacheable(),render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(!this.get("value")&&this.get("isVisible")==true){this.set("value",new Date().format("yyyy-MM-dd"))}if(this.get("minHeight")){this.reSetMinHeight()}})},reSetMinHeight:function(){var a=this.get("minHeight");if(a&&this.dateView){this.adjust("minHeight",a);this.$().css("line-height",(a-6)+"px");this.dateView.adjust("minHeight",a)}},dateView:CS.DateEntryView.extend({classNames:"cs-date-view".w(),layout:{top:0,left:0,width:150,height:22},cwDateBinding:".parentView.cwDate",init:function(){arguments.callee.base.apply(this,arguments)},setCWDate:function(a){if(a!=null&&a!=""&&a.length>0){this.parentView.set("value",a[1]+"-"+CS.leftPad(a[2],"0",2)+"-"+CS.leftPad(a[3],"0",2))}}})});CS.minutePicker=CW.PickerPane.extend(CW.Animatability,CW.PaneFadingSupport,{HEADER_HEIGHT:64,ROW_HEIGHT:23,FOOTER_HEIGHT:10,layout:{width:134,height:200},keyDown:function(a){return this.owner.keyDown(a)},parentViewDidChange:function(){var e=this.owner.parentView.get("value");if(e&&e.indexOf("T")>0){e=e.replace(/T/," ")}if(e){var f=e.substring(14,16);this.contentView.minute.value.set("value",f);var a=this.contentView.minute.value.childViews;for(var b=0;b<a.length;b++){var d="";if(a[b].get("value").length==1){d="0"+a[b].get("value")}else{d=a[b].get("value")}if(d==f){$(a[b].get("layer")).addClass("time-picker-sel")}else{$(a[b].get("layer")).removeClass("time-picker-sel")}}}}.observes(".owner.parentView.value"),modalPane:SC.ModalPane.extend({}),contentView:SC.View.extend({classNames:["minutes-picker"],layout:{left:0,top:0,right:0,bottom:0},childViews:["minute"],minute:SC.View.extend({layout:{top:0,bottom:0,left:0,right:0},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:0,top:15,height:25,right:0},value:"CS.Minute".loc(),textAlign:"center"}),value:SC.View.extend({layout:{top:40,bottom:0,left:0,right:0},init:function(){arguments.callee.base.apply(this,arguments);for(var d=0;d<12;d++){var h=(d-d%2)/2*25;var g=d%2*50+30;var a=25;var e=25;var f=(d*5).toString();if(f.length==1){f="0"+f}var b=SC.LabelView.create({layout:{left:g,top:h,height:a,width:e},textAlign:"center",value:f,classNames:["mouse-on-date"],mouseDown:function(j){this.selectValue(j);this.parentView.parentView.parentView.parentView.remove()},touchStart:function(j){this.selectValue(event);this.parentView.parentView.parentView.parentView.remove()},selectValue:function(j){this.invokeLast(function(){var l=this.parentView.childViews;if(l){for(var m=0;m<l.length;m++){$(l[m].get("layer")).removeClass("time-picker-sel")}$(this.get("layer")).addClass("time-picker-sel");this.parentView.set("value",this.get("value"))}var n=this.parentView.parentView.parentView.parentView.get("owner").parentView.get("value");if(n&&n.indexOf("T")>0){n=n.replace(/T/," ")}var k=n.substr(0,14)+this.parentView.get("value");k=k.replace(/\s/,"T");this.parentView.parentView.parentView.parentView.get("owner").parentView.set("value",k)})},render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(this.parentView&&this.parentView.parentView&&this.parentView.parentView.parentView&&this.parentView.parentView.parentView.parentView&&this.parentView.parentView.parentView.parentView.get("owner")&&this.parentView.parentView.parentView.parentView.get("owner").parentView){var j=this.parentView.parentView.parentView.parentView.get("owner").parentView.get("value");if(j&&j.indexOf("T")>0){j=j.replace(/T/," ")}var l=j.substring(14,16);var k="";k=this.get("value");if(k==l){$(this.get("layer")).addClass("time-picker-sel");this.parentView.set("value",k)}}})}});this.appendChild(b)}}})})})});CS.TimePicker=CW.PickerPane.extend({HEADER_HEIGHT:64,ROW_HEIGHT:23,FOOTER_HEIGHT:10,layout:{width:134,height:200},keyDown:function(a){return this.owner.keyDown(a)},parentViewDidChange:function(){var f=this.owner.parentView.get("value");if(f&&f.indexOf("T")>0){f=f.replace(/T/," ")}if(f){var a=f.substring(11,13);var g=f.substring(14,16);this.contentView.hours.value.set("value",a);var b=this.contentView.hours.value.childViews;for(var d=0;d<b.length;d++){var e="";if(b[d].get("value").length==1){e="0"+b[d].get("value")}else{e=b[d].get("value")}if(e==a){$(b[d].get("layer")).addClass("time-picker-sel")}else{$(b[d].get("layer")).removeClass("time-picker-sel")}}}}.observes(".owner.parentView.value"),modalPane:SC.ModalPane.extend({}),contentView:SC.View.extend({classNames:["hours-picker"],childViews:["hours"],hours:SC.View.extend({layout:{top:0,bottom:0,left:0,right:0},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:0,top:15,height:25,right:0},value:"CS.Hour".loc(),textAlign:"center"}),value:SC.View.extend({layout:{top:40,bottom:0,left:0,right:0},init:function(){arguments.callee.base.apply(this,arguments);for(var b=0;b<24;b++){var h=(b-b%4)/4*25;var g=b%4*25+17;var a=25;var e=25;var f=b.toString();if(f.length==1){f="0"+f}var d=SC.LabelView.create({layout:{left:g,top:h,height:a,width:e},textAlign:"center",value:f,classNames:["mouse-on-date"],mouseDown:function(j){this.selectValue(j);this.parentView.parentView.parentView.parentView.remove()},touchStart:function(j){this.selectValue(event);this.parentView.parentView.parentView.parentView.remove()},selectValue:function(j){this.invokeLast(function(){var l=this.parentView.childViews;if(l){for(var m=0;m<l.length;m++){$(l[m].get("layer")).removeClass("time-picker-sel")}$(this.get("layer")).addClass("time-picker-sel");this.parentView.set("value",this.get("value"))}var n=this.parentView.parentView.parentView.parentView.get("owner").parentView.get("value");if(n&&n.indexOf("T")>0){n=n.replace(/T/," ")}var o=n.substr(14,16);var k=n.substr(0,11)+this.parentView.get("value")+":"+(o?o:"00");k=k.replace(/\s/,"T");this.parentView.parentView.parentView.parentView.get("owner").completeText();this.parentView.parentView.parentView.parentView.get("owner").parentView.set("value",k)})},render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(this.parentView&&this.parentView.parentView&&this.parentView.parentView.parentView&&this.parentView.parentView.parentView.parentView&&this.parentView.parentView.parentView.parentView.get("owner")&&this.parentView.parentView.parentView.parentView.get("owner").parentView){var k=this.parentView.parentView.parentView.parentView.get("owner").parentView.get("value");if(k&&k.indexOf("T")>0){k=k.replace(/T/," ")}var j=k.substring(11,13);var l=this.get("value");if(l==j){$(this.get("layer")).addClass("time-picker-sel");this.parentView.set("value",l)}}})}});this.appendChild(d)}}})})})});CS.MultipleSelectionUserView=SC.ListView.extend({contentValueKey:"name",contentBinding:"CS.UserAttributes.spaceUsersDelegate.arrangedObjects",selectionBinding:"CS.UserAttributes.spaceUsersDelegate.selection",useToggleSelection:YES,rowHeight:40,select:function(a){arguments.callee.base.apply(this,arguments);var d=CS.UserAttributes.spaceUsersDelegate.toArray()[a],b=CS.UserAttributes.get("results");b.pushObject(d);CS.UserAttributes.set("results",b.uniq())},deselect:function(a){arguments.callee.base.apply(this,arguments);var d=CS.UserAttributes.spaceUsersDelegate.toArray()[a],b=CS.UserAttributes.get("results");b.removeObject(d);CS.UserAttributes.set("results",b)},exampleView:SC.View.extend({classNames:"user-multi-select-view".w(),childViews:["checkBoxViews","userHeadImageView","userNameView","userEmailView","emptyView"],checkBoxViews:SC.CheckboxView.extend({layout:{left:3,centerY:0,width:16,height:16},valueBinding:".parentView.isSelected"}),userHeadImageView:SC.View.extend({layout:{top:3,left:30,width:32,height:32},render:function(a,f){arguments.callee.base.apply(this,arguments);if(f){var e="";var b=this.getPath("parentView.content.userById.photo");var d=CS.Utils.getUserHeadHtml(b,30,30,"user-head-photo");a.push(d)}}}),userNameView:SC.LabelView.extend({layout:{top:3,left:70,height:17},valueBinding:".parentView.content.name",classNames:["user-name-view"],}),userEmailView:SC.LabelView.extend({layout:{bottom:3,left:70,height:17},classNames:["user-email-view"],valueBinding:".parentView.content.email"}),emptyView:SC.View.extend()})});CS.SingleSelectionUserView=SC.ListView.extend({contentValueKey:"name",contentBinding:"CS.UserAttributes.spaceUsersDelegate.arrangedObjects",selectionBinding:"CS.UserAttributes.spaceUsersDelegate.selection",useToggleSelection:YES,rowHeight:40,select:function(){arguments.callee.base.apply(this,arguments);CS.UserAttributes.set("results",this.get("selection").toArray())},deselect:function(){arguments.callee.base.apply(this,arguments);CS.UserAttributes.set("results",[])},exampleView:SC.View.extend({classNames:"user-single-select-view".w(),childViews:["headImage","label","email"],render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(this.get("isSelected")){this.$().addClass("sel-user")}})},isSelectedDidChange:function(){if(this.get("isSelected")){this.$().addClass("sel-user")}else{this.$().removeClass("sel-user")}}.observes("isSelected"),headImage:SC.View.extend({layout:{top:3,left:3,width:32,height:32},render:function(a,f){arguments.callee.base.apply(this,arguments);if(f){var e="";var b=this.getPath("parentView.content.userById.photo");var d=CS.Utils.getUserHeadHtml(b,30,30,"user-head-photo");a.push(d)}}}),label:SC.LabelView.extend({layout:{top:3,left:40,height:17},valueBinding:".parentView.content.userById.name",classNames:["user-name-view"],}),email:SC.LabelView.extend({layout:{bottom:3,left:40,height:17},classNames:["user-email-view"],valueBinding:".parentView.content.userById.email"}),})});sc_require("views/user/single_selection_user");sc_require("views/user/multiple_selection_user");sc_require("views/group/single_selection_group");CS.UserFilteredByOrgPane=CW.iOSPickerPane.extend({themeName:"iOS",classNames:"iOS-blue".w(),contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),layout:{top:0,bottom:0,left:0,right:0},childViews:["toolbarView","splitView"],toolbarView:SC.View.extend({layout:{left:1,right:1,top:0,height:39},childViews:["confirm","title","cancel"],classNames:"select-toolbar",confirm:SC.ButtonView.design({layout:{right:5,width:60,centerY:1,height:30},title:"Button.OK".loc(),themeName:"navigationBarSilverDone",action:function(){var d=CS.UserAttributes.get("userSelectView"),k=this.getPath("parentView.parentView.parentView");if(d&&k){var f=CS.UserAttributes.get("isMulti"),g=CS.UserAttributes.get("useModel"),j=CS.UserAttributes.get("modelToOne");if(f==true){var h=CS.UserAttributes.get("results"),a=[];if(h&&h.toArray().length>0){h=h.toArray();a=CS.usersSelectedController.getMultiSelectUsers(h,g);if(a.length>0){a.sortProperty("name")}var b=a.getEach("name").join(", ");d.userView.set("value",b);d.set("value",a);k.remove();k.destroy();d.extendOK()}else{if(CS.UserAttributes.get("canClear")){d.set("value",g?null:a);d.userView.set("value","");k.remove();k.destroy();d.extendOK()}else{navigator.notification.alert("",function(){},"User.CannotEmpty.Message".loc(),"Button.OK".loc())}}}else{var h=CS.UserAttributes.getPath("results.firstObject"),e=null;if(h){e=CS.usersSelectedController.getSingleSelectUsers(h,g);if(e){d.userView.set("value",g?e.get("name"):e.name)}else{d.userView.set("value","")}d.set("value",e);k.remove();k.destroy();d.extendOK()}else{if(CS.UserAttributes.get("canClear")){d.set("value",null);d.userView.set("value","");k.remove();k.destroy();d.extendOK()}else{navigator.notification.alert("",function(){},"User.CannotEmpty.Message".loc(),"Button.OK".loc())}}}}}}),title:SC.LabelView.extend({render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("pickerTitle")){this.set("value",CS.UserAttributes.get("pickerTitle"))}else{this.set("value","CS.User.Select".loc())}},layout:{centerX:0,centerY:1,width:111,height:30},textAlign:"center",classNames:"user_select_title"}),cancel:SC.ButtonView.design({layout:{left:5,width:60,centerY:1,height:30},title:"Button.Cancel".loc(),themeName:"navigationBarSilver",action:function(){var a=this.getPath("parentView.parentView.parentView");if(a){a.remove();a.destroy()}}})}),splitView:SC.View.extend({layout:{top:40,bottom:0,left:1,right:1},childViews:"topLeftView bottomRightView".w(),topLeftView:SC.View.extend({layout:{width:300,left:0},childViews:["treeView"],treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,contentView:SC.StackedView.extend({contentValueKey:"name",contentBinding:"CS.organizationsController.arrangedObjects",selectionBinding:"CS.organizationsController.selection",select:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var a=CS.organizationsController.getPath("selection.firstObject.id");if(a){CS.UserAttributes.get("spaceUsersDelegate").loadByOrg(a)}})},exampleView:SC.View.extend({layout:{height:30},useStaticLayout:true,classNames:"org-filter-item-view".w(),childViews:["label"],render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(this.get("isSelected")){this.$().addClass("sel")}})},isSelectedDidChange:function(){if(this.get("isSelected")){this.$().addClass("sel")}else{this.$().removeClass("sel")}}.observes("isSelected"),label:SC.LabelView.extend({valueBinding:".parentView.content.name",classNames:"org-name",render:function(b,d){arguments.callee.base.apply(this,arguments);var a=this.parentView.content.get("parents").toArray().length;this.adjust("left",(a)*18+5)}})})})})}),bottomRightView:SC.View.extend({layout:{left:301,right:0},childViews:["searchView","treeView","isSelectAll"],isSelectAll:SC.CheckboxView.extend({layout:{left:3,width:16,height:16,top:7},render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("isMulti")==false){this.set("isVisible",false);this.adjust("height",0)}else{this.set("isVisible",true);this.adjust("height",16);this.invokeLast(function(){var a=CS.UserAttributes.get("spaceUsersDelegate");if(a.length()>0&&a.length()==CS.UserAttributes.get("results").length){this.set("value",true)}})}},valueDidChange:function(){var b=CS.UserAttributes.get("spaceUsersDelegate");if(b){if(this.get("value")==true){if(b.length()>0){var a=SC.SelectionSet.create();a.addObjects(b.get("content"));b.set("selection",a);CS.UserAttributes.set("results",a.toArray())}}else{var a=SC.SelectionSet.create();b.set("selection",a);CS.UserAttributes.set("results",[])}}}.observes("value"),}),searchView:SC.TextFieldView.extend({layout:{height:26,top:2},applyImmediately:YES,leftAccessoryView:SC.ImageView.extend({layout:{left:0,top:2,width:24,height:24},value:"search"}),render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("isMulti")==false){this.adjust("left",2)}else{this.adjust("left",30)}},valueDidChange:function(){var a=CS.UserAttributes.get("spaceUsersDelegate");if(a){var b=this.get("value");a.reLoad(b)}}.observes("value")}),treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,layout:{top:30,bottom:0},render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("canInviteUser")){this.adjust("bottom",32)}},contentView:function(){return CS.UserAttributes.get("isMulti")?CS.MultipleSelectionUserView.design():CS.SingleSelectionUserView.design()}.property().cacheable()}),inviteUser:SC.ButtonView.extend({classNames:["invite-user"],layout:{bottom:0,height:30,left:1,right:1},controlSize:SC.HUGE_CONTROL_SIZE,title:"User.Invite".loc(),isVisibleBinding:"CS.UserAttributes.canInviteUser",action:function(){var a=CW.PanelPane.create(CW.Animatability,CW.PaneAnimationSupport,{layout:{centerX:0,centerY:0,width:600,height:(CW.isApp()?385:320)},hasNavigationBar:YES,hasTabBar:NO,contentView:CS.inviteUserNavigationView.create()});a.append()}})})})})});sc_require("views/user/single_selection_user");sc_require("views/user/multiple_selection_user");sc_require("views/group/single_selection_group");CS.UserFilteredByOrgPaneMobile=CW.PanelPane.extend({hasNavigationBar:YES,contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),childViews:["toolbarView","splitView"],toolbarView:SC.View.extend({classNames:"user_group_toolbar_mobile",layout:{left:2,right:2,top:0,height:40},childViews:["confirm","title","cancel"],confirm:SC.ButtonView.design({layout:{right:5,width:60,centerY:1,height:30},title:"Button.OK".loc(),themeName:"navigationBarSilverDone",action:function(){var d=CS.UserAttributes.get("userSelectView"),k=this.getPath("parentView.parentView.parentView");if(d&&k){var f=CS.UserAttributes.get("isMulti"),g=CS.UserAttributes.get("useModel"),j=CS.UserAttributes.get("modelToOne");if(f==true){var h=CS.UserAttributes.getPath("spaceUsersDelegate.selection"),a=[];if(h&&h.toArray().length>0){h=h.toArray();a=CS.usersSelectedController.getMultiSelectUsers(h,g);if(a.length>0){a.sortProperty("name")}var b=a.getEach("name").join(", ");d.userView.set("value",b);d.set("value",a);k.remove();k.destroy();d.extendOK()}else{if(CS.UserAttributes.get("canClear")){d.set("value",g?null:a);d.userView.set("value","");k.remove();k.destroy();d.extendOK()}else{navigator.notification.alert("",function(){},"User.CannotEmpty.Message".loc(),"Button.OK".loc())}}}else{var h=CS.UserAttributes.getPath("spaceUsersDelegate.selection.firstObject"),e=null;if(h){e=CS.usersSelectedController.getSingleSelectUsers(h,g);if(e){d.userView.set("value",g?e.get("name"):e.name)}else{d.userView.set("value","")}d.set("value",e);k.remove();k.destroy();d.extendOK()}else{if(CS.UserAttributes.get("canClear")){d.set("value",null);d.userView.set("value","");k.remove();k.destroy();d.extendOK()}else{navigator.notification.alert("",function(){},"User.CannotEmpty.Message".loc(),"Button.OK".loc())}}}}}}),title:SC.LabelView.extend({render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("pickerTitle")){this.set("value",CS.UserAttributes.get("pickerTitle"))}else{this.set("value","CS.User.Select".loc())}},layout:{centerX:0,top:15,width:111,height:30},textAlign:"center",classNames:"cw-navigation-bar-title"}),cancel:SC.ButtonView.design({layout:{left:5,width:60,centerY:1,height:30},title:"Button.Cancel".loc(),themeName:"navigationBarSilver",action:function(){var a=this.getPath("parentView.parentView.parentView");if(a){a.remove();a.destroy()}}})}),splitView:SC.View.extend({layout:{top:40,bottom:0,left:2,right:2},childViews:"topLeftView bottomRightView".w(),topLeftView:SC.View.extend({layout:{width:159,left:0},childViews:["treeView"],treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,contentView:SC.StackedView.extend({rowHeight:30,contentValueKey:"name",contentBinding:"CS.organizationsController.arrangedObjects",selectionBinding:"CS.organizationsController.selection",useToggleSelection:YES,select:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var a=CS.organizationsController.getPath("selection.firstObject.id");if(a){CS.UserAttributes.get("spaceUsersDelegate").loadByOrg(a)}})},deselect:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){CS.UserAttributes.get("spaceUsersDelegate").load()})},exampleView:SC.View.extend({layout:{height:25},useStaticLayout:true,classNames:"org-filter-item-view".w(),childViews:["label"],isSelectedDidChange:function(){if(this.get("isSelected")){this.$().addClass("sel")}else{this.$().removeClass("sel")}}.observes("isSelected"),label:SC.LabelView.extend({valueBinding:".parentView.content.name",classNames:"org-name",render:function(b,d){arguments.callee.base.apply(this,arguments);var a=this.parentView.content.get("parents").toArray().length;this.adjust("left",(a)*18+5)}})})})})}),bottomRightView:SC.View.extend({layout:{left:160,right:0},childViews:["treeView","inviteUser"],treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("canInviteUser")){this.adjust("bottom",32)}},contentView:function(){return CS.UserAttributes.get("isMulti")?CS.MultipleSelectionUserView.design():CS.SingleSelectionUserView.design()}.property().cacheable()}),inviteUser:SC.ButtonView.extend({classNames:["invite-user"],layout:{bottom:0,height:30,left:0,right:0},controlSize:SC.HUGE_CONTROL_SIZE,title:"User.Invite".loc(),isVisibleBinding:"CS.UserAttributes.canInviteUser",action:function(){var a=CW.PanelPane.create(CW.Animatability,CW.PaneAnimationSupport,{layout:{centerX:0,centerY:0,width:600,height:(CW.isApp()?385:320)},hasNavigationBar:YES,hasTabBar:NO,contentView:CS.inviteUserNavigationView.create()});a.append()}})})})})});CS.UserPane=CW.iOSPickerPane.extend({themeName:"iOS",classNames:"iOS-blue".w(),contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),layout:{top:0,bottom:0,left:0,right:0},childViews:["toolbarView","searchView","treeView","inviteUser"],toolbarView:SC.View.extend({layout:{left:1,right:1,top:0,height:40},childViews:["confirm","title","cancel"],classNames:"user_group_toolbar",confirm:SC.ButtonView.design({layout:{right:5,width:60,centerY:1,height:30},title:"Button.OK".loc(),themeName:"navigationBarSilverDone",action:function(){var d=CS.UserAttributes.get("userSelectView"),k=this.getPath("parentView.parentView.parentView");if(d&&k){var f=CS.UserAttributes.get("isMulti"),g=CS.UserAttributes.get("useModel"),j=CS.UserAttributes.get("modelToOne");if(f==true){var h=CS.UserAttributes.get("results"),a=[];if(h&&h.toArray().length>0){h=h.toArray();a=CS.usersSelectedController.getMultiSelectUsers(h,g);if(a.length>0){a.sortProperty("name")}var b=a.getEach("name").join(", ");d.userView.set("value",b);d.set("value",a);k.remove();k.destroy();d.extendOK()}else{if(CS.UserAttributes.get("canClear")){d.set("value",g?null:a);d.userView.set("value","");k.remove();k.destroy();d.extendOK()}else{navigator.notification.alert("",function(){},"User.CannotEmpty.Message".loc(),"Button.OK".loc())}}}else{var h=CS.UserAttributes.getPath("results.firstObject"),e=null;if(h){e=CS.usersSelectedController.getSingleSelectUsers(h,g);if(e){d.userView.set("value",g?e.get("name"):e.name)}else{d.userView.set("value","")}d.set("value",e);k.remove();k.destroy();d.extendOK()}else{if(CS.UserAttributes.get("canClear")){d.set("value",null);d.userView.set("value","");k.remove();k.destroy();d.extendOK()}else{navigator.notification.alert("",function(){},"User.CannotEmpty.Message".loc(),"Button.OK".loc())}}}}}}),title:SC.LabelView.extend({render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("pickerTitle")){this.set("value",CS.UserAttributes.get("pickerTitle"))}else{this.set("value","CS.User.Select".loc())}},layout:{centerX:0,centerY:1,width:111,height:30},textAlign:"center",classNames:"user_select_title"}),cancel:SC.ButtonView.design({layout:{left:5,width:60,centerY:1,height:30},title:"Button.Cancel".loc(),themeName:"navigationBarSilver",action:function(){var a=this.getPath("parentView.parentView.parentView");if(a){a.remove();a.destroy()}}})}),searchView:CS.SearchBoxView.extend({layout:{left:1,right:1,top:40,height:44},applyImmediately:YES,render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("showSearchBox")==false){this.set("isVisible",false);this.adjust("height",0);this.parentView.treeView.adjust("top",40)}else{this.set("isVisible",true);this.adjust("height",44);this.parentView.treeView.adjust("top",84)}},valueDidChange:function(){var a=CS.UserAttributes.get("spaceUsersDelegate");if(a){var b=this.get("value");a.reLoad(b)}}.observes("value")}),treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,classNames:["user-list-view"],layout:{top:84,bottom:0,left:1,right:1},render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("canInviteUser")){this.adjust("bottom",32)}},contentView:function(){return CS.UserAttributes.get("isMulti")?CS.MultipleSelectionUserView.design():CS.SingleSelectionUserView.design()}.property().cacheable()}),footToolbarView:SC.View.extend({layout:{left:1,right:1,bottom:0,height:40},childViews:["clear"],clear:SC.ButtonView.design({layout:{right:5,width:58,centerY:0,height:30},title:"Button.Clear".loc(),themeName:"navigationBarSilver",isVisibleBinding:"CS.UserAttributes.canClear",action:function(){CS.UserAttributes.get("spaceUsersDelegate").set("selection",SC.SelectionSet.create())}})}),inviteUser:SC.ButtonView.extend({classNames:["invite-user"],layout:{bottom:0,height:30,left:1,right:1},controlSize:SC.HUGE_CONTROL_SIZE,title:"User.Invite".loc(),isVisibleBinding:"CS.UserAttributes.canInviteUser",action:function(){var a=CW.PanelPane.create(CW.Animatability,CW.PaneAnimationSupport,{layout:{centerX:0,centerY:0,width:600,height:(CW.isApp()?385:320)},hasNavigationBar:YES,hasTabBar:NO,contentView:CS.inviteUserNavigationView.create()});a.append()}})})});CS.UserPaneMobile=CW.PanelPane.extend({hasNavigationBar:YES,contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),childViews:["toolbarView","searchView","treeView","inviteUser"],toolbarView:SC.View.extend({classNames:"user_group_toolbar_mobile",layout:{left:0,right:0,top:0,height:40},childViews:["confirm","title","cancel"],confirm:SC.ButtonView.design({layout:{right:5,width:60,centerY:1,height:30},title:"Button.OK".loc(),themeName:"navigationBarSilverDone",action:function(){var d=CS.UserAttributes.get("userSelectView"),k=this.getPath("parentView.parentView.parentView");if(d&&k){var f=CS.UserAttributes.get("isMulti"),g=CS.UserAttributes.get("useModel"),j=CS.UserAttributes.get("modelToOne");if(f==true){var h=CS.UserAttributes.get("results"),a=[];if(h&&h.toArray().length>0){h=h.toArray();a=CS.usersSelectedController.getMultiSelectUsers(h,g);if(a.length>0){a.sortProperty("name")}var b=a.getEach("name").join(", ");d.userView.set("value",b);d.set("value",a);k.remove();k.destroy();d.extendOK()}else{if(CS.UserAttributes.get("canClear")){d.set("value",g?null:a);d.userView.set("value","");k.remove();k.destroy();d.extendOK()}else{navigator.notification.alert("",function(){},"User.CannotEmpty.Message".loc(),"Button.OK".loc())}}}else{var h=CS.UserAttributes.getPath("results.firstObject"),e=null;if(h){e=CS.usersSelectedController.getSingleSelectUsers(h,g);if(e){d.userView.set("value",g?e.get("name"):e.name)}else{d.userView.set("value","")}d.set("value",e);k.remove();k.destroy();d.extendOK()}else{if(CS.UserAttributes.get("canClear")){d.set("value",null);d.userView.set("value","");k.remove();k.destroy();d.extendOK()}else{navigator.notification.alert("",function(){},"User.CannotEmpty.Message".loc(),"Button.OK".loc())}}}}}}),title:SC.LabelView.extend({render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("pickerTitle")){this.set("value",CS.UserAttributes.get("pickerTitle"))}else{this.set("value","CS.User.Select".loc())}},layout:{centerX:0,top:15,width:111,height:30},textAlign:"center",classNames:"cw-navigation-bar-title"}),cancel:SC.ButtonView.design({layout:{left:5,width:60,centerY:1,height:30},title:"Button.Cancel".loc(),themeName:"navigationBarSilver",action:function(){var a=this.getPath("parentView.parentView.parentView");if(a){a.remove();a.destroy()}}})}),searchView:CS.SearchBoxView.extend({layout:{left:0,right:0,top:40,height:44},applyImmediately:YES,render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("showSearchBox")==false){this.set("isVisible",false);this.adjust("height",0);this.parentView.treeView.adjust("top",40)}else{this.set("isVisible",true);this.adjust("height",44);this.parentView.treeView.adjust("top",84)}},valueDidChange:function(){var a=CS.UserAttributes.get("spaceUsersDelegate");if(a){var b=this.get("value");a.reLoad(b)}}.observes("value")}),treeView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,layout:{top:84,bottom:0,left:0,right:0},classNames:["user-list-view"],render:function(){arguments.callee.base.apply(this,arguments);if(CS.UserAttributes.get("canInviteUser")){this.adjust("bottom",32)}},contentView:function(){return CS.UserAttributes.get("isMulti")?CS.MultipleSelectionUserView.design():CS.SingleSelectionUserView.design()}.property().cacheable()}),footToolbarView:SC.View.extend({layout:{left:0,right:0,bottom:0,height:40},childViews:["clear"],clear:SC.ButtonView.design({layout:{right:5,width:58,centerY:0,height:30},title:"Button.Clear".loc(),themeName:"navigationBarSilver",isVisibleBinding:"CS.UserAttributes.canClear",action:function(){CS.UserAttributes.get("spaceUsersDelegate").set("selection",SC.SelectionSet.create())}})}),inviteUser:SC.ButtonView.extend({classNames:["invite-user"],layout:{bottom:0,height:30,left:0,right:0},controlSize:SC.HUGE_CONTROL_SIZE,title:"User.Invite".loc(),isVisibleBinding:"CS.UserAttributes.canInviteUser",action:function(){var a=CW.PanelPane.create(CW.Animatability,CW.PaneAnimationSupport,{layout:{centerX:0,centerY:0,width:600,height:(CW.isApp()?385:320)},hasNavigationBar:YES,hasTabBar:NO,contentView:CS.inviteUserNavigationView.create()});a.append()}})})});sc_require("views/user/user_pane");sc_require("views/user/user_filtered_by_org_pane");sc_require("views/user/user_filtered_by_org_pane_mobile");sc_require("views/user/user_pane_mobile");sc_require("views/user/single_selection_user");sc_require("views/user/multiple_selection_user");CS.UserSelectView=SC.View.extend({layout:{left:0,right:0,top:0,minHeight:26},classNames:["user-select"],childViews:["userView"],isMulti:YES,canEditUser:true,spaceUsersDelegate:null,spaceId:"",useModel:false,modelToOne:false,needAccepted:false,onlyActivated:true,canClear:true,afterClearRemovePanelPane:false,pickerWidth:610,pickerHeight:400,pickerTitle:"",userIds:null,hint:"",isTextArea:true,showSearchBox:false,showBorder:true,showNameTextFontSize:14,showNameNeedBolder:false,canFilter:false,tokenCSS:false,canInviteUser:false,companyId:"",extendAction:function(){},extendOK:function(){},heightDidChange:function(){if(this.get("frame").height===0){this.adjust("height",26)}}.observes("frame"),querySpaceUsers:function(){var a=this.get("isMulti");var b=this.get("onlyActivated");var d=this.get("userIds");var f=this.get("spaceId");if(f){var e=CS.usersSelectedController.getSpaceUsersController(f,a,b,d);this.set("spaceUsersDelegate",e)}},render:function(){arguments.callee.base.apply(this,arguments);this.querySpaceUsers();if(this.get("canFilter")){CS.organizationsController.load(this.get("spaceId"),this.get("companyId"))}this.invokeLast(function(){if(this.get("canEditUser")==false){this.$().addClass("user-select-disabled")}else{this.$().removeClass("user-select-disabled")}})},userIdsChanged:function(){if(this.get("userIds")){this.querySpaceUsers()}}.observes("userIds"),valueDidChange:function(){var a=this.get("value");if(this.get("tokenCSS")){}else{this.userView.set("value",this.formatValueToName(a,true).getEach("name").join(", "))}}.observes("value"),formatValueToName:function(a,b){var d=[];if(a){if(a instanceof CS.User){d.push({id:a.get("id"),name:a.get("name")})}else{if(a.length||a.length==0){if(a.length>0||(a.length&&a.length()>0)){a.forEach(function(e){(e instanceof CS.User)?d.push({id:e.get("id"),name:e.get("name")}):d.push({id:e.id,name:e.name})},this)}}else{d.push({id:a.id,name:a.name})}}if(d.length&&b){d.sortProperty("name")}}return d},userView:SC.TextFieldView.extend({layout:{left:0,right:0,top:0,minHeight:26},escapeHTML:false,hintBinding:".parentView.hint",isEditable:false,isTextAreaBinding:".parentView.isTextArea",classNames:["user-select-showName-view"],toolTipBinding:".value",isVisibleBinding:SC.Binding.oneWay(".parentView.tokenCSS").not(),isMultiBinding:".parentView.isMulti",isMultiDidChange:function(){height=26;if(this.get("parentView")&&this.get("parentView").get("isMulti")&&this.get("parentView").get("isTextArea")==true){height=height*3}this.adjust("height",height);if(this.get("parentView")){this.get("parentView").adjust("height",height)}}.observes("isMulti"),render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){this.isMultiDidChange();if(this.getPath("parentView.showBorder")==false&&this.$(".border")){this.$(".border").removeClass("border")}if(this.getPath("parentView.showNameTextFontSize")&&this.$(".fields")){var d=this.getPath("parentView.showNameTextFontSize")+"px";this.$(".field").css("font-size",d)}if(this.getPath("parentView.showNameNeedBolder")&&this.$(".fields")){this.$(".field").css("font-weight","bold")}if(this.getPath("parentView.isTextArea")==false&&this.$(".fields")){this.$(".field").css("white-space","nowrap");this.$(".field").css("overflow","hidden");this.$(".field").css("text-overflow","ellipsis")}this.$(".hint").css("line-height","21px")})},initUserSelectAttributes:function(){var a=this.parentView;if(a){CS.UserAttributes.initAttributes(a);var b=a.get("spaceUsersDelegate"),d=a.get("showSearchBox");if(b){b.load()}}},mouseDown:function(){this.parentView.extendAction();if(this.parentView.get("canEditUser")){this.showUsersView()}},touchStart:function(){this.mouseDown()},showUsersView:function(){this.initUserSelectAttributes();CS.organizationsController.set("selection",null);var d=this.getPath("parentView.value"),e=CS.UserAttributes.get("spaceUsersDelegate");if(e){if(d){var b=CS.usersSelectedController.getSelectionByValue(d);e.set("selection",b);CS.UserAttributes.set("results",b.toArray())}else{var b=SC.SelectionSet.create();e.set("selection",b);CS.UserAttributes.set("results",[])}}if(CW.isMobile()){CS.UserPaneMobile.create().append()}else{var a=[2,3,1,0,2];if(this.getPath("parentView.preferMatrix")){a=this.getPath("parentView.preferMatrix")}if(this.getPath("parentView.canFilter")){CS.UserFilteredByOrgPane.create({layout:{centerX:0,centerY:0,width:CS.UserAttributes.get("pickerWidth"),height:CS.UserAttributes.get("pickerHeight")}}).popup(this.parentView,SC.PICKER_POINTER,a)}else{CS.UserPane.create({layout:{centerX:0,centerY:0,width:CS.UserAttributes.get("pickerWidth"),height:CS.UserAttributes.get("pickerHeight")}}).popup(this.parentView,SC.PICKER_POINTER,a)}}},valueDidChange:function(){var a=this.$input();if(a&&a[0]){a[0].title=this.get("value")}}.observes("value")}),});SC.metricsFor("en-us",{"FlowDesigner.Button.Draw.maxWidth":220,"FlowDesigner.ConditionStepProp.Form.width":320,}),SC.stringsFor("en-us",{"Button.Cancel":"Cancel","Button.OK":"OK","Button.FlowInfo":"Flow Info","Button.Draw":"Draw","Button.Property":"Properties","Button.Permissions":"Permissions","Button.Permissions.Editable":"Editable","Button.Permissions.Readonly":"Read-only","Button.AllCheck":"All","Flow.Name":"Flow Name:","Flow.Description":"Flow Discription:","Flow.HelpText":"Help text:","Flow.Name.Input":"Please input a name for the Flow.","Flow.Name.Not.Input":"Flow Name is required.","Flow.Created.Label":"Created on:","Flow.Created_by.Name":"Created by:","Flow.Modified.Label":"Modified on:","Flow.Modified.Name":"Modified by:","Step.Name":"Step Name:","Step.Departments":"Departments","Step.Users":"Users","Step.Start.WhoCanCreate":"Who can initiate this request:","Step.TypeName":"Step Type: %@","Step.DealType":"Assign to:","Step.DealType.NotNull":"Assign to is required.","Step.RelatedRole":"Role Name:","Step.RelatedRole.NotNull":"No role is assigned.","Step.Hours":"Deadline for this step (hours):","Step.Hours.Instruction":"In hours, Time-out reminding is just for reference.","Step.Description":"Step description:","Step.FieldControl":"Fields can be modified in this step:","Step.DecisionType":"Decision type:","Step.OverCounterSignType":"Countersign over:","Step.RelatedUsers":"Particular users","Step.RelatedUsers.Title":"User Name:","Step.RelatedUsers.Select.Title":"Users","Step.RelatedUsers.NotNull":"No user is assigned.","Step.RelatedRole.NotExist":"involved role doesnt exist.","Step.RelatedGroups":"Users in particular departments","Step.RelatedGroups.Title":"Department Name:","Step.RelatedGroups.Select.Title":"Departments","Step.RelatedGroups.NotNull":"No Dept. is assigned.","Step.RelatedUserField":"User in Field","Step.RelatedUserField.Title":"Field Name:","Step.RelatedGroupField":"Dept. in Field","Step.RelatedGroupField.Title":"Field Name:","Step.RelatedStep":"Historic step:","Step.RelatedStep.NotNull":"The historic step has not been specified.","Step.Message.SelectStepOrLine":"Please select a step or a line.","Step.Message.SelectUserField":"--Select a Field--","Step.Message.SelectOrgField":"--Select a Field--","Step.Message.SelectStep":"--Please select a step--","Step.Message.SelectRole":"--Please select role--","Step.Message.SelectFieldsCanEdit":"Choose the fields","Step.Name.Input":"Step name is required.","Step.Name.NotEmpty":"step name is required.","Step.DecisionType.Input":"Please input decision type.","Step.OverCounterSignType.Input":"Please input the complete method of countersign.","Step.InValid.NotJSON.Parameter":"Parameter must be an object of json","Step.InValid.NotJSON.Data":"Data must be an object of json","Step.InValid.NotJquery.Container":"Container must be an effective object of jquery","Step.InValid.NotNull.Msg":"msg must be non-empty strings ","Step.InValid.IllegalParameter.CssClass":"Illegal parameter cssClass is not allowed","Step.InValid.IllegalParameter.ShowTime":"Illegal parameter showTime is not allowed","Step.Message.SelectDealType":"--Please select the handler--","Step.Submitter":"Submitter","Step.Submitter.Instruction":"A user who filled in a new Request. Maybe he is not the applicant himself.","Step.SubmitterRole":"Roles related to submitter","Step.SubmitterRole.Instruction":"A user who is assigned to a specified role, with signature authority over the applicant.","Step.SpecifyStepUser":"Handler of specified step","Step.SpecifyStepUser.Instruction":"A user who has handled the same Request in a specified historic step.","Step.SpecifyStepRole":"Roles related to the handler of specified step","Step.SpecifyStepRole.Instruction":"A user who is assigned to a specified role, with signature authority over the handler of a specified historic step will be the approver.","Step.PickupAtRuntime":"Pick users at runtime","Step.UserFieldRole":"Role of  user in Field","Step.UserFieldRole.Instruction":"Someone will be filled in a Select Users field in the Request at runtime. \nA user who is assigned to a specified role, with signature authority over above-mentioned users will be the approver.","Step.OrgFieldRole":"Role of  Dept. in Field","Step.OrgFieldRole.Instruction":"Some departments will be filled in a Select Departments field in the Request at runtime. \nA user who is assigned to a specified role, with signature authority over above-mentioned departments will be the approver.","Step.Applicant":"Initiator","Step.Applicant.Instruction":"A user who applied for the Request.","Step.ApplicantRole":"Role of initiator","Step.ApplicantRole.Instruction":"Please select a role. Persons can sign the Requests on this step, if he is assigned to this role and his management scope contains the applicants organization.","Step.ApplicantSuperior":"Initiators Manager","Step.SpecifyUser.Instruction":"An activated user in this space.","Step.SpecifyOrg.Instruction":"A department in this space, everyone belongs to which will be the approver.","Step.UserField.Instruction":"Users who are filled in a Select Users field in the Request at runtime.","Step.OrgField.Instruction":"Departments which are filled in a Select Departments field in the Request at runtime. \nEveryone belongs to these departments will be the approver.","Step.Message.SelectDecisionType":"--Please select the decision type--","Step.DecisionType.All":"The decision could be approved by all member","Step.DecisionType.AnyApprove":"The decision could be approved by any member","Step.DecisionType.AnyReject":"The decision could be objected by all member","Step.DecisionType.FirstApprove":"The decision could be approved by the first member","Step.Message.SelectOverCounterSignType":"--Please select the over method of counter sign--","Step.OverCounterSignType.WaitForAll":"After all the concurrent node be solved, then transfer to the next step","Step.OverCounterSignType.AnyFit":"Fit the resolution requirements, and immediately transfer to the next step","Step.Message.SelectCounterSignType":"--Countersign type--","Step.CounterSignType.OrdrCounter":"Repeated countersign","Step.CounterSignType.SameCounter":"Concurrent countersign","Step.InValid.NotBoolean.Parameter.IsFromLoad":"Parameter isFromLoad must be the boolean type","Step.InValid.TheSameStepName":"the step with the same name exists.","Step.InValid.Step":"Step","Step.InValid.Please":"Please","Step.InValid.AtLeastOneOutLine":"There must be at least one output line from the Initiate Request.","Step.InValid.AtLeastOneInLine":"no line extends from a previous step.","Step.InValid.NotOutLine":"Step couldn't have an output line","Step.InValid.OnlyOneOrTwoOutLine":"Could have only one or two output lines ","Step.InValid.AtLeastTwoOutLine":"Need at least two output lines","Step.InValid.AtLeastTwoInLine":"Need at least two input lines","Step.InValid.InputLegalHours":"Input legal processing time(greater than 0) ","Step.InValid.SelectRole":"Select role","Step.InValid.AtLeastOneDealUser":"Select at least one deal user","Step.InValid.AtLeastOneOrg":"Select at least one specific organization","Step.InValid.SelectUserField":"Select user field","Step.InValid.SelectGroupField":"Select group field","Step.Message.SelectField":"--Please select the field--","Step.InValid.NotFitType.CreateStepByStepData":"The type of createStepByStepData is not fit","Step.InValid.NotRepeatLink":"Cannot create a duplicate connection between these two steps.","Step.InValid.ConditionNotLinkToCondition":"Cannot create a connection between two condition steps","Step.Message.Save.Succeed":"Save sucecess","Step.Message.Error.AbnormalType":"Unkonown step error with an abnormal type","Step.Message.Delete.Fail.StartAndEnd":"Cannot delete Initiate Request Step or Completed Step","Step.InValid.Delete.Fail.NoObject":"Please click to select the object ought to be deleted","Step.InValid.NeedAddOneStep":"Please add a step then link","Step.InValid.NotLinkToEndStep":"Couldn't be the line of ended step","Step.InValid.For":"For","Step.InValid.LessThanTwoLineForStartStep":"The line for starting step couldn't more than two ","Step.Message.SelectAdmin":"Select the administrator","Step.UserField.NotEmpty":"No field is assigned.","Step.UserField.NotInForm":"field in condition doesnt exist.","Step.OrgField.NotEmpty":"No field is assigned.","Step.OrgField.NotInForm":"field in condition doesnt exist.","Step.ConditionStep.HelpInfo":"Please set the condition in the property of the connection line.","Step.Need.InputLine":"no line extends from a previous step.","Step.Need.OutputLine":"click the plus icon to add a line to the next step.","Step.AnyUser":"","Step.Enter.StepName":"Enter Step Name here","Step.RelatedRole.Hint":"Add a role who will act on this step","Step.RelatedUsers.HasUser.NotExist":"involved assignee has been deleted or disabled.","Line.Name":"Line Label:","Line.FromStep":"From Step: %@","Line.ToStep":"To Step: %@","Line.State":"State of the line: %@","Line.Condition":"Execute only when:","Line.Condition.NotNull":"condition has not been defined in the branch.","Line.Description":"Line description:","Line.State.Submitted":"Submitted","Line.State.Approved":"Approved","Line.State.Rejected":"Rejected","Line.InValid.ErrorType":"Wrong fromstep parameter or tostep type.","Line.InValid.NeedFromStep":"At least need parameter fromStep","Line.Formula.Hint":"Example: {Amount}>10","Line.TimeoutLine":"Timeout auto-submit","Draw.CounterSign":"CounterSign","Draw.Sign":"Approve Request","Draw.Submit":"Provide Input","Draw.Notify":"Notify","Draw.ConcurrentStart":"Fork","Draw.ConcurrentEnd":"Join","Draw.Condition":"Condition","Draw.Link":"Link","Draw.Delete":"Delete","Step.Archive":"Archive","Step.ConcurrentStart":"Fork","Step.ConcurrentStart.Info":"Continue a process in branches that are independent of each other.(coming soon)","Step.ConcurrentStart.InValid.NeedStartOrEnd":"The line of concurrent start step should be connected to at least one concurrent start step or end step.","Step.ConcurrentStart.InValid.NeedCounterSignOrSign":"Before the output line of concurrent step connected to the next concurren start or concurrent end, it only could be connected to counter step type or sigle step type","Step.ConcurrentStart.InValid.OnlyHaveOneLine":"Before the output line of concurrent starting step be connected to the next concurrent start or concurrent end, it could only have one input or output line with the counter sign step and sigle sign step","Step.ConcurrentEnd":"Join","Step.ConcurrentEnd.Info":"The branches of the fork join in a union operator.(coming soon)","Step.ConcurrentEnd.InValid.NeedStartOrEnd":"The line of concurrent end step should be connected to at least one concurrent start step or end step.","Step.ConcurrentEnd.InValid.NeedCounterSignOrSign":"Before the iutput line of concurrent step connected to the next concurren start or concurrent end, it only could be connected to counter step type or sigle step type","Step.ConcurrentEnd.InValid.OnlyHaveOneLine":"Before the output line of concurrent ended step be connected to the next concurrent start or concurrent end, it could only have one input or output line with the counter sign step and sigle sign step","Step.Condition":"Condition","Step.Condition.Info":"Condition pattern can be used for any of the automatic  selection use cases. System will pick up processes which should be executed.","Step.Condition.TypeName.Instruction":"You can draw at least one line from the Condition step.\nYou must set the conditions property of each line.\nThe approver select a next step from those automatically filtered by system according to conditions.","Step.CounterSign":"CounterSign","Step.CounterSign.Info":"Send request to multiple people concurrently.","Step.End":"Completed","Step.End.TypeName.Instruction":"You cant draw any line from the Completed step. \nThe approval is complete as soon as it reaches the Completed step.","Step.Notify":"Notify","Step.Notify.Info":"Users will be notified the Request automatically, but he cant decide approve or reject.(coming soon)","Step.Sign":"Approve Request","Step.Sign.Info":"Approve Request pattern can be used for any of the approval use cases. It has the following tasks of its own: Approve and Reject.","Step.Sign.TypeName.Instruction":"You can draw at least one line from the Sign step.\nEach line is connected to a next step means approved.\n If approver needs to reject a request, he can select a next step from Initiate Request, Completed, and historic steps.","Step.Start":"Initiate Request","Step.Start.TypeName.Instruction":"You can draw at least one line from the Initiate Request step.\nEach line is connected to a next step.\nThe submitter create a new Request and choose one of these next steps.","Step.Start.FieldControl.Instruction":"When people fill an application, label fields and the fields with formula are read-only. System will show the values automatically. So label fields and the fields with formula dont appear in the fields list.","Step.Submit":"Provide Input","Step.Submit.Info":"Provide Input pattern can be used for any of the provide input or review use cases. It has only one task of its own: Send.","Step.Submit.TypeName.Instruction":"You can draw at least one line from the Submit step.\nEach line is connected to a next step. The approver just selects a next step without choosing approved or rejected.","Step.Delete":"Delete","Step.Delete.Info":"Click to delete a step or a line.","Step.LinkIcon.Tooltip":"Click and drag the mouse to add a new line.","Step.DeleteIcon.Tooltip":"Delete this step.","Step.ValiFailedIcon.Tooltip":"Show the error message.","Flow.Permission.Setting":"Setting Flow Permissions","Field.Permission.Form":"Form: ","Field.Permission.Table":"Table: ","Field.Permission.Section":"Section: ","Field.Permission.Title":"Please tick the editable fields in the step","Step.disableCC":"Disable CC","Step.allowDistribute":"Can distribute instance","Step.can_edit_main_attach":"Can edit main attach","Step.can_edit_normal_attach":"Can edit normal attach","Step.cc_must_finished":"CC must finished","Step.cc_alert":"CC alert","Step.allowBatch":"Batch approval","Step.one-click.approval":"One-click approval","Step.one-click.rejection":"One-click rejection","Step.allow_pick_approve_users":"Allow pick approve users","Step.cc_has_edit_permission":"CC has edit permission"});FlowDesigner=SC.Application.create({NAMESPACE:"FlowDesigner",VERSION:"0.1.0"});FlowDesigner.ApproverOrgFieldController=SC.ArrayController.create({contentBinding:"FlowDesigner.FlowController.orgFields",});FlowDesigner.ApproverUserFieldController=SC.ArrayController.create({contentBinding:"FlowDesigner.FlowController.userFields",});FlowDesigner.FieldListController=SC.ArrayController.create({contentBinding:"FlowDesigner.FlowController.fields"});FlowDesigner.FlowController=SC.ObjectController.create({showFlowPermission:function(){},nameChanged:function(){if((typeof(this.get("name"))=="string")||(FlowDesigner.settings==null)){return}FlowDesigner.Designer.prototype.valiFlow()}.observes("name"),codeFormulaChanged:function(){if((typeof(this.get("code_formula"))=="string")||(FlowDesigner.settings==null)){return}FlowDesigner.Designer.prototype.valiFlow()}.observes("code_formula")});FlowDesigner.FlowRolesController=SC.ArrayController.create({allowsMultipleSelection:NO,spaceId:"",reLoad:function(d){var a,b=CS.store;if(b){var e;var f=this.spaceId;e=SC.Query.local(CS.Role,{conditions:"space = %@ AND (name CONTAINS %@)",parameters:[f,d],orderBy:"name ASC"});CS.store.dataSourceDidFetchQuery(e);a=CS.store.find(e)}this.set("content",a.uniq())}});FlowDesigner.flowDesignNavigationController=CW.NavigationController.create({});FlowDesigner.FlowStepAndLineController=SC.ObjectController.create({lines:function(){var d=[],b=this.get("stepId");if(b){var a=Admin.flowController.getPath("current.steps").filterProperty("id",b).get("firstObject");if(a){d=a.get("lines")}}return d}.property("stepId").cacheable(),ValidRelateRole:function(a){if(FlowDesigner.FlowRolesController.content){return FlowDesigner.FlowRolesController.content.getEach("id").contains(a[0])}else{return false}},validRelateUsers:function(h){return true;var g=Admin.spaceController.get("id"),b=CS.store,f,a;if(h&&g){var e=true;for(var d=0;d<h.length;d++){f=SC.Query.local(CS.SpaceUser,{conditions:"space = %@ AND user = %@ AND user_accepted = true",parameters:[g,h[d]],orderBy:"name ASC"});CS.store.dataSourceDidFetchQuery(f);a=CS.store.find(f);if(!a||a.toArray().length<1){e=false;break}}return e}},validApproverOrgFieldAndApproverUserField:function(b,a){var f=false;if(b){var e=FlowDesigner.FieldListController.toArray();for(var d=0;d<e.length;d++){if(e[d].get("id")==b){f=true}}}if(a){var e=FlowDesigner.FieldListController.toArray();for(var d=0;d<e.length;d++){if(e[d].get("id")==a){f=true}}}return f},showDealType:function(a){CW.iOSPickerPane.create({themeName:"iOS",classNames:"iOS-blue".w(),layout:{width:255,height:360},contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),layout:{top:0,bottom:0,left:0,right:0},childViews:["listView"],listView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,layout:{top:0,bottom:0,left:1,right:1},contentView:SC.ListView.extend({rowHeight:30,content:function(){var b=FlowDesigner.FlowStepAndLineController.getDealTypeContent();this.setSelect(b);return b}.property().cacheable(),setSelect:function(f){if(f&&f.length>0){for(var d=0;d<f.length;d++){var b=FlowDesigner.FlowStepAndLineController.get("dealType");if(b&&f[d]["value"]==b){var e=SC.SelectionSet.create();e.addObject(f[d]);this.set("selection",e)}}}},render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var b=FlowDesigner.FlowStepAndLineController.get("dealType");if(b){var e=this.childViews;for(var d=0;d<e.length;d++){e[d].$().removeClass("sel");if(e[d].getPath("content.value")==b){e[d].$().addClass("sel")}}}})},exampleView:SC.View.extend(SC.Control,{classNames:"dealType-list-view",childViews:"eachView".w(),eachView:SC.View.extend(SC.FlowedLayout,{childViews:"titleView".w(),titleView:SC.LabelView.extend({classNames:"dealType-list-view-title".w(),layout:{height:30},valueBinding:".parentView.parentView.content.title"})}),mouseDown:function(b){var e=this.get("content");if(e){var d=SC.SelectionSet.create();d.addObject(e);this.parentView.set("selection",d);FlowDesigner.FlowStepAndLineController.beginPropertyChanges();FlowDesigner.FlowStepAndLineController.set("dealType",e.get("value"));FlowDesigner.FlowStepAndLineController.set("relatedRole",[]);FlowDesigner.FlowStepAndLineController.set("relatedUsers",[]);FlowDesigner.FlowStepAndLineController.set("relatedGroups",[]);FlowDesigner.FlowStepAndLineController.set("approverUserField","");FlowDesigner.FlowStepAndLineController.set("approverOrgField","");FlowDesigner.FlowStepAndLineController.set("relatedStepId","");FlowDesigner.FlowStepAndLineController.endPropertyChanges();this.parentView.parentView.parentView.parentView.parentView.destroy()}},touchStart:function(){this.mouseDown()}})})})})}).popup(a,SC.PICKER_POINTER)},getDealTypeContent:function(){var f=FlowDesigner.options.dealTypes;var g=[];var a=FlowDesigner.FlowStepAndLineController.getPath("content.stepType");var b=FlowDesigner.FlowController.get("userFields");var e=FlowDesigner.FlowController.get("orgFields");for(var d=1;d<f.length;d++){var h=f[d].value;if(a=="counterSign"&&(h=="applicant"||h=="applicantSuperior")){}else{if(h=="userField"||h=="userFieldRole"){if(b&&b.length>0){g.push(SC.Object.create(f[d]))}}else{if(h=="orgField"||h=="orgFieldRole"){if(e&&e.length>0){g.push(SC.Object.create(f[d]))}}else{g.push(SC.Object.create(f[d]))}}}}return g},showRolesView:function(a){var e=this.get("relatedRole");if(e&&e.length>0){var d=FlowDesigner.FlowRolesController.content.toArray();for(var b=0;b<d.length;b++){if(d[b].get("id")==e[0]){FlowDesigner.FlowRolesController.selectObject(d[b])}}}else{FlowDesigner.FlowRolesController.set("selection",null)}CW.iOSPickerPane.create({themeName:"iOS",classNames:"iOS-blue".w(),layout:{width:255,height:360},contentView:CW.BorderView.extend({classNames:"cw-navigation-well".w(),layout:{top:0,bottom:0,left:0,right:0},childViews:["listView","searchView"],searchView:CS.SearchBoxView.extend({layout:{left:1,right:1,top:0,height:44},applyImmediately:YES,valueDidChange:function(){var f=this.get("value");FlowDesigner.FlowRolesController.reLoad(f)}.observes("value")}),listView:SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,hasVerticalScroller:YES,hasHorizontalScroller:YES,layout:{top:44,bottom:0,left:1,right:1},contentView:SC.ListView.extend({rowHeight:30,contentBinding:"FlowDesigner.FlowRolesController.content",selectionBinding:"FlowDesigner.FlowRolesController.selection",exampleView:SC.View.extend(SC.Control,{classNames:"dealType-list-view",childViews:"eachView".w(),eachView:SC.View.extend(SC.FlowedLayout,{childViews:"titleView".w(),titleView:SC.LabelView.extend({classNames:"dealType-list-view-title".w(),layout:{height:30},valueBinding:".parentView.parentView.content.name"})}),mouseDown:function(f){var j=this.get("content");if(j){var g=SC.SelectionSet.create();g.addObject(j);this.parentView.set("selection",g);var h=[];h.push(j.get("id"));FlowDesigner.FlowStepAndLineController.set("relatedRole",h);this.parentView.parentView.parentView.parentView.parentView.destroy()}},touchStart:function(){this.mouseDown()}})})})})}).popup(a,SC.PICKER_POINTER)},historySteps:function(){var b=[];var a=FlowDesigner.settings.steps;b.push({title:"Step.Message.SelectStep".loc(),value:""});$(a).each(function(d,e){if(!(e instanceof FlowDesigner.EndStep)&&(e!=FlowDesigner.settings.curSel)){b.push({title:e.getStepName(),value:e.getStepId()})}});return b}.property("content").cacheable(),rolesNames:function(){var b=[];var a=this.get("relatedRole");if(!SC.none(a)&&a.length>0){a.forEach(function(e){var d=FlowDesigner.FlowRolesController.toArray();d.forEach(function(f){if(f.get("id")==e){b.push(f.get("name"))}},this)},this);return b.join(",")}return b}.property("relatedRole").cacheable(),isRelatedRoleRowVisible:function(){var a=this.get("dealType");return a=="submitterRole"||a=="preStepRole"||a=="specifyStepRole"||a=="userFieldRole"||a=="orgFieldRole"||a=="applicantRole"}.property("dealType").cacheable(),isRelatedUsersRowVisible:function(){var a=this.get("dealType");return a=="specifyUser"}.property("dealType").cacheable(),isRelatedGroupsRowVisible:function(){var a=this.get("dealType");return a=="specifyOrg"}.property("dealType").cacheable(),isRelatedUserFieldRowVisible:function(){var a=false;var d=this.get("dealType");if(d=="userField"||d=="userFieldRole"||d=="userFieldSuperior"){a=true}if(a&&FlowDesigner.ApproverUserFieldController.get("length")==1){var b=FlowDesigner.ApproverUserFieldController.firstObject().get("id");FlowDesigner.FlowStepAndLineController.set("approverUserField",b)}return a}.property("dealType").cacheable(),isRelatedGroupFieldRowVisible:function(){var a=false;var d=this.get("dealType");if(d=="orgField"||d=="orgFieldRole"){a=true}if(a&&FlowDesigner.ApproverOrgFieldController.get("length")==1){var b=FlowDesigner.ApproverOrgFieldController.firstObject().get("id");FlowDesigner.FlowStepAndLineController.set("approverOrgField",b)}return a}.property("dealType").cacheable(),isRelatedStepRowVisible:function(){var a=this.get("dealType");return a=="specifyStepUser"||a=="specifyStepRole"||a=="specifyStepSuperior"}.property("dealType").cacheable(),isLineConditionRowVisible:function(){if(FlowDesigner.settings.curSel){if(FlowDesigner.settings.curSel.fromStep){if(FlowDesigner.settings.curSel.fromStep.typeName){return"Step.Condition".loc()==FlowDesigner.settings.curSel.fromStep.typeName}}}return false}.property("condition").cacheable(),changedContent:function(){return this.get("content")}.property("stepName","stepDesc","dealType","relatedRole","approverUserField","approverOrgField","hours","relatedUsers","relatedGroups","relatedStepId","decisionType","overCounterSignType","lineName","lineFromStep","lineToStep","lineState","lineDescription","lineTimeoutLine","condition","disableCC","allowDistribute","can_edit_main_attach","can_edit_normal_attach","cc_must_finished","cc_alert","allowBatch","oneClickApproval","oneClickRejection","allow_pick_approve_users","cc_has_edit_permission"),contentDidChange:function(){if(FlowDesigner.settings&&!FlowDesigner.settings.bindingDataInPropForm){if(FlowDesigner.settings.curSel instanceof FlowDesigner.Step){FlowDesigner.settings.curFlowDesigner.valiCurStep()}FlowDesigner.settings.curFlowDesigner.propChangeHandler()}}.observes("changedContent"),dealTypeDidChange:function(){_dealType=this.get("dealType");if(_dealType&&_dealType!=""){var d=[];var b=FlowDesigner.options.dealTypes;for(var a=1;a<b.length;a++){d.push(b[a].value)}if(!d.contains(_dealType)){this.set("dealType","pickupAtRuntime")}}}.observes("dealType")});FlowDesigner.flowValidController=SC.ObjectController.create({errorMessage:""});Function.prototype.binding=function(){if(arguments.length<2&&typeof arguments[0]=="undefined"){return this}var a=this,d=jQuery.makeArray(arguments),b=d.shift();return function(){return a.apply(b,d.concat(jQuery.makeArray(arguments)))}};var BasicClass=function(e){e.setOptions=function(f){for(var h in f){this[h]=f[h]}};if(!(e._valiOptions instanceof Function)){e._valiOptions=function(f){return true}}var d=function(h){if(e.extend instanceof Function){var k=new e.extend(null);for(var l in k){if(k.hasOwnProperty(l)&&!(k[l] instanceof Object)){this[l]=k[l]}}}if(e._options instanceof Object){var f=e._options;for(var j in f){if(f[j] instanceof Object){f[j]=null}}this.setOptions(f)}if(h!==null){if(this._valiOptions(h)){if(this._init instanceof Function){this._init(h)}}}};if(e.extend instanceof Function){var g=function(){};g.prototype=e.extend.prototype;var a=d.prototype.constructor;d.prototype=new g();d.prototype.constructor=a}for(var b in e){if(b!="extend"&&b!="constructor"&&b!="_options"){d.prototype[b]=e[b]}}return d};FlowDesigner.DragAppendButtonDelegate={eventTag:"",mouseDown:function(a){FlowDesigner.btnsAction(this.eventTag)},touchStart:function(a){FlowDesigner.btnsAction(this.eventTag)},didCreateLayer:function(){if(SC.browser.isMobileSafari||SC.browser.isAndroid){var a=this.$();a.bind("touchmove",function(b){FlowDesigner.settings.curFlowDesigner.canvasMousemoveHandler({pageX:b.pageX,pageY:b.pageY})});a.bind("touchend",function(b){FlowDesigner.settings.curFlowDesigner.canvasMouseupHandler({pageX:b.pageX,pageY:b.pageY})})}},willDestroyLayer:function(){if(SC.browser.isMobileSafari||SC.browser.isAndroid){var a=this.$();a.unbind()}},};sc_require("mixins/BasicClass");FlowDesigner.ToolTip=new BasicClass({_options:{msg:"",cssClass:"toolTip",showTime:3000,color:"red"},_valiOptions:function(a){if(typeof a!="object"){this.consoleLog("Step.InValid.NotJSON.Parameter".loc());return false}else{if(!(typeof a.msg=="string"&&a.msg!="")){this.consoleLog("Step.InValid.NotNull.Msg".loc());return false}else{if(typeof a.cssClass!="undefined"){this.consoleLog("Step.InValid.IllegalParameter.CssClass".loc());return false}else{return true}}}},_init:function(a){this.setOptions(a);var b=$("<div></div>");if(typeof a.color=="string"){b.css("color",a.color)}this.target=b;if(FlowDesigner.settings.toolTip){FlowDesigner.settings.toolTip.remove();FlowDesigner.settings.toolTip=null}this.show();if(this.showTime>0){this.delay()}else{FlowDesigner.settings.toolTip=this}},show:function(){this.target.addClass(this.cssClass).css({opacity:0.8}).offset({top:12}).html(this.msg).appendTo(FlowDesigner.settings.canvasWrap).fadeIn(2000)},delay:function(){this.target.delay(this.showTime).fadeOut(2000,function(){$(this).remove()})},remove:function(){this.target.fadeOut(2000,function(){$(this).remove()})},consoleLog:function(a){if(typeof console=="object"){console.log("ToolTip:"+a)}}});sc_require("mixins/BasicClass");FlowDesigner.Spirit=new BasicClass({_options:{},_valiOptions:function(a){return true},_init:function(a){}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");FlowDesigner.Step=new BasicClass({extend:FlowDesigner.Spirit,_options:{target:null,propData:null,fromSteps:null,toSteps:null,isFromLoad:false},_valiOptions:function(a){if(typeof a!="undefined"){if(a instanceof Object&&typeof a.isFromLoad=="boolean"){return true}else{this.consoleLog("Step.InValid.NotBoolean.Parameter.IsFromLoad".loc());return false}}else{return true}},_init:function(a){this.propData={stepId:"-1",stepName:"unTitled",stepType:"",dealType:"",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",hours:168,logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,approverUserField:"",approverOrgField:"",flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0};this.fromSteps=[];this.toSteps=[];var b=$('<div class = "step">				<div class = "stepTip"></div>				<div class = "stepText"></div>				<a class = "stepLinkIcon heightLightTag"></a>				<a class = "stepDelIcon heightLightTag"></a>			</div>');FlowDesigner.settings.canvas.append(b);this.target=b;this.propData.stepName=this.typeName;this.setAutoText()},typeName:"",consoleLog:function(a){if(typeof console=="object"){console.log("Step:"+a)}},getTypeName:function(){return this.typeName},getTarget:function(){return this.target},sel:function(){if(FlowDesigner.settings.curSel){FlowDesigner.settings.curSel.highLight(false)}FlowDesigner.settings.curSel=this;this.highLight(true)},setPropData:function(a){$.extend(this.propData,a)},getPropData:function(){return this.propData},getFlowStepScript:function(){return this.propData.flowStepScript},setText:function(a){this.target.children(".stepText").html(a)},setAutoText:function(){var a=this.propData.stepName.replace("\n","<br/>");this.setText(a)},getText:function(){return this.target.html()},getStepId:function(){return this.propData.stepId},setStepId:function(a){this.propData.stepId=a},getModified:function(){return this.propData.modified},setModified:function(a){this.propData.modified=a},getStepType:function(){return this.propData.stepType},getDealType:function(){return this.propData.dealType},setDealType:function(a){this.propData.dealType=a},getStepName:function(){return this.propData.stepName},pushFromStep:function(a){this.fromSteps.push(a)},pushToStep:function(a){this.toSteps.push(a)},removeFromStep:function(a){var b=$.inArray(a,this.fromSteps);if(b>-1){this.fromSteps.splice(b,1)}},removeToStep:function(a){var b=$.inArray(a,this.toSteps);if(b>-1){this.toSteps.splice(b,1)}},getFromSteps:function(){return this.fromSteps},getToSteps:function(){return this.toSteps},remove:function(){this.target.remove();this.target=null;this.propData=null;var a=$.inArray(this,FlowDesigner.settings.steps);if(a>-1){FlowDesigner.settings.steps.splice(a,1)}FlowDesigner.settings.curSel=null},show:function(){this.target.show()},hide:function(){this.target.hide()},highLightOver:function(a){if(typeof a=="boolean"){if(a){this.target.addClass("stepHighLightOver");if([FlowDesigner.settings.eventStates.linkingLine,FlowDesigner.settings.eventStates.moveLinkingLine,FlowDesigner.settings.eventStates.movingLine].contains(FlowDesigner.settings.eventState)){this.addForceHideTagClass()}}else{this.target.removeClass("stepHighLightOver");this.removeForceHideTagClass()}}},addForceHideTagClass:function(){this.target.addClass("forceHideTag")},removeForceHideTagClass:function(){this.target.removeClass("forceHideTag")},highLight:function(a){if(typeof a=="boolean"){if(a){this.target.addClass("stepHighLight")}else{this.target.removeClass("stepHighLight")}}},getSize:function(){return{width:this.target.width(),height:this.target.height()}},valiNewOffset:function(e,m){var l={isValid:true,newLeft:e,newTop:m};var b=FlowDesigner.settings.curFlowDesigner.getCanvasWrapOffset(),f=FlowDesigner.settings.curFlowDesigner.getCanvasWrapScrollLeft(),d=FlowDesigner.settings.curFlowDesigner.getCanvasWrapScrollTop(),o=FlowDesigner.settings.canvasSize,n=this.getSize(),j=8,h=b.left+j,g=b.top+j,a=b.left+o.width-n.width-j,k=b.top+o.height-n.height-j;if(e+f<h){l.isValid=false;l.newLeft=h-f}else{if(e+f>a){l.isValid=false;l.newLeft=a-f}}if(m+d<g){l.isValid=false;l.newTop=g-d}else{if(m+d>k){l.isValid=false;l.newTop=k-d}}return l},valiNewCenter:function(e,d){var a=this.getSize(),b=this.valiNewOffset(e-a.width/2,d-a.height/2);b.newLeft+=a.width/2;b.newTop+=a.height/2;return b},getPosition:function(){return this.target.position()},setPosition:function(b,a){this.propData.posx=b;this.propData.posy=a;this.setOffsetByPosition(b,a)},getOffset:function(){return this.target.offset()},setOffset:function(b,a){this.target.offset({left:b,top:a});this.setPositionByOffset(b,a)},setOffsetByPosition:function(e,d){var f=FlowDesigner.settings.curFlowDesigner.getCanvasWrapOffset();var b=e+f.left-FlowDesigner.settings.curFlowDesigner.getCanvasWrapScrollLeft();var a=d+f.top-FlowDesigner.settings.curFlowDesigner.getCanvasWrapScrollTop();this.target.offset({left:b,top:a})},setPositionByOffset:function(e,d){var f=FlowDesigner.settings.curFlowDesigner.getCanvasWrapOffset();var b=e-f.left+FlowDesigner.settings.curFlowDesigner.getCanvasWrapScrollLeft();var a=d-f.top+FlowDesigner.settings.curFlowDesigner.getCanvasWrapScrollTop();this.propData.posx=b;this.propData.posy=a},getTopCenter:function(){var a=this.getPosition();return{left:a.left+this.target.width()/2,top:a.top}},getBottomCenter:function(){var a=this.getPosition();return{left:a.left+this.target.width()/2,top:a.top+this.target.height()}},getCenter:function(){var a=this.getSize(),b=this.getPosition();return{left:b.left+a.width/2,top:b.top+a.height/2}},setCenter:function(d,b){var a=this.getSize();this.setOffset(d-a.width/2,b-a.height/2)},addLinkIcon:function(){this.target.append('<a class = "stepLinkIcon heightLightTag" title = "'+"Step.LinkIcon.Tooltip".loc()+'"></a>')},addDelIcon:function(){this.target.append('<a class = "stepDelIcon heightLightTag" title = "'+"Step.DeleteIcon.Tooltip".loc()+'"></a>')},addWarningIcon:function(){this.removeWarningIcon();this.target.append('<a class = "stepValiFailedIcon" title = "'+"Step.ValiFailedIcon.Tooltip".loc()+'"></a>')},removeWarningIcon:function(){this.target.find("a.stepValiFailedIcon").remove()},getNextLines:function(a){var d=[];$(FlowDesigner.settings.lines).each(function(e,f){if(f.getFromStep()==this){d.push(f)}}.binding(this));if(a&&FlowDesigner.settings.activeLine instanceof FlowDesigner.Line){var b=FlowDesigner.settings.activeLine;if(b.getFromStep()==this){d.push(b)}}return d},getPrevLines:function(a){var d=[];$(FlowDesigner.settings.lines).each(function(e,f){if(f.getToStep()==this){d.push(f)}}.binding(this));if(a&&FlowDesigner.settings.activeLine instanceof FlowDesigner.Line){var b=FlowDesigner.settings.activeLine;if(b.getToStep()==this){d.push(b)}}return d},valiStepLineCountAndGetErrMsg:function(){var n="";var b=this;var m=b.getFromSteps(),e=b.getToSteps(),h=m.length,d=e.length,k=this.getStepName(),j=this.getTypeName(),l=0,a=0;if(h>0){l=m.filter(function(o){return o==b}).length;h-=l}if(d>0){a=e.filter(function(o){return o==b}).length;d-=a}var g=FlowDesigner.settings.steps;var f=0;$(g).each(function(o,p){if(k==p.getStepName()){f++;if(f>1){n=k+": "+"Step.InValid.TheSameStepName".loc();return false}}});if(""==n&&b instanceof FlowDesigner.StartStep){if(d==0){n=k+": "+"Step.Need.OutputLine".loc()}}else{if(""==n&&b instanceof FlowDesigner.EndStep){if(d>0){n=k+": "+j+"Step.InValid.NotOutLine".loc()}else{if(h==0){n=k+": "+"Step.InValid.AtLeastOneInLine".loc()}}}else{if((""==n)&&(b instanceof FlowDesigner.ConditionStep||b instanceof FlowDesigner.SubmitStep||b instanceof FlowDesigner.NotifyStep)){if(d==0){n=k+": "+"Step.Need.OutputLine".loc()}else{if(h==0){n=k+": "+"Step.Need.InputLine".loc()}}}else{if(""==n&&(b instanceof FlowDesigner.CounterSignStep||b instanceof FlowDesigner.SignStep)){if(d==0){n=k+": "+"Step.Need.OutputLine".loc()}else{if(h==0){n=k+": "+"Step.Need.InputLine".loc()}}}else{if(""==n&&b instanceof FlowDesigner.ConcurrentStartStep){if(d<2){n=j+"Step.InValid.Step".loc()+k+"Step.InValid.AtLeastTwoOutLine".loc()}else{if(h==0){n="Step.Need.InputLine".loc()}}}else{if(""==n&&b instanceof FlowDesigner.ConcurrentEndStep){if(d==0){n="Step.Need.OutputLine".loc()}else{if(h<2){n=j+"Step.InValid.Step".loc()+k+"Step.InValid.AtLeastTwoInLine".loc()}}}}}}}}return n},valiStepDealTypeAndGetErrMsg:function(){var k="";var h=this.getStepName(),f=this.getTypeName();var a=FlowDesigner.settings.dealTypes;if(!a){return k}var g=this.getHours();if(!(typeof g=="number"&&g>0)){k="Step.InValid.Please".loc()+f+"Step.InValid.Step".loc()+h+"Step.InValid.InputLegalHours".loc()}if(k==""&&$.inArray(this.getDealType(),[a.submitterRole,a.preStepRole,a.specifyStepRole,a.userFieldRole,a.groupFieldRole,a.applicantRole])>=0){var b=this.getRelatedRoleId();if(!(typeof b=="number"&&b>0)){k="Step.InValid.Please".loc()+f+"Step.InValid.Step".loc()+h+"Step.InValid.SelectRole".loc()}}if(k==""&&$.inArray(this.getDealType(),[a.specifyUser])>=0){var d=this.getRelatedUsers();if(!(d instanceof Array&&d.length>0)){k="Step.InValid.Please".loc()+f+"Step.InValid.Step".loc()+h+"Step.InValid.AtLeastOneDealUser".loc()}}if(k==""&&$.inArray(this.getDealType(),[a.specifyGroup])>=0){var j=this.getRelatedGroups();if(!(j instanceof Array&&j.length>0)){k="Step.InValid.Please".loc()+f+"Step.InValid.Step".loc()+h+"Step.InValid.AtLeastOneOrg".loc()}}if(k==""&&$.inArray(this.getDealType(),[a.userField,a.userFieldRole,a.userFieldSuperior])>=0){var e=this.getApproverUserField();if(!(typeof e=="number"&&e>0)){k="Step.InValid.Please".loc()+f+"Step.InValid.Step".loc()+h+"Step.InValid.SelectUserField".loc()}}if(k==""&&$.inArray(this.getDealType(),[a.groupField,a.groupFieldRole])>=0){var e=this.getApproverOrgField();if(!(typeof e=="number"&&e>0)){k="Step.InValid.Please".loc()+f+"Step.InValid.Step".loc()+h+"Step.InValid.SelectGroupField".loc()}}return k},setNextLinesSolidOrDashed:function(){if(this instanceof FlowDesigner.CounterSignStep||this instanceof FlowDesigner.SignStep||this instanceof FlowDesigner.ConcurrentEndStep){var e=this.getNextLines(true);if(e.length==2){var d,a;if(FlowDesigner.settings.curFlowDesigner.compareForLineSort(e[0],e[1])<0){d=e[0];a=e[1]}else{d=e[1];a=e[0]}d.setAsDashedLine(false);a.setAsDashedLine(true);d.setState("approved");a.setState("rejected")}else{if(e.length==1){var b=e[0];b.setAsDashedLine(false);b.setState("approved")}}}},getNewStepName:function(f){var b=FlowDesigner.settings.steps;var a=[];var d=1;if(b){for(var e=0;e<b.length;e++){a.push(b[e].getStepName())}if(a.contains(f)){f=this.getStepNameAutomatic(1,f,a)}}return f},getStepNameAutomatic:function(b,e,a){var d=e+b;if(a.contains(d)){return this.getStepNameAutomatic(++b,e,a)}else{return d}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");FlowDesigner.ConcurrentEndStep=new BasicClass({extend:FlowDesigner.Step,_init:function(a){this.propData={stepId:"-1",stepName:"unTitled",stepType:FlowDesigner.settings.stepTypes.concurrentEnd,dealType:"",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",hours:168,logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,approverUserField:"",approverOrgField:"",flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0};this.fromSteps=[];this.toSteps=[];var b=$('<div class = "step concurrentEndStep">				<div class = "stepTip"></div>				<div class = "stepText"></div>			</div>');FlowDesigner.settings.canvas.append(b);this.target=b;this.propData.stepName=this.typeName;this.addLinkIcon();this.addDelIcon();this.setAutoText();this.valiAndGetErrMsg()},typeName:"Step.ConcurrentEnd".loc(),getDecisionType:function(){return this.propData.decisionType},getOverCounterSignTypes:function(){return this.propData.overCounterSignType},getDecisionType:function(){return this.propData.decisionType},valiAndGetErrMsg:function(){var a="";a=this.valiStepLineCountAndGetErrMsg();if(a==""){var b=this.getStepName();if(FlowDesigner.settings.curFlowDesigner.trim(b).length==0){a="Step.Name.Input".loc()}else{if(this.getDecisionType()==0){a="Step.DecisionType.Input".loc()}else{if(this.getOverCounterSignTypes()==0){a="Step.OverCounterSignType.Input".loc()}}}}if(a==""){a=this.valiConcurrentAndGetErrMsg()}if(a==""){this.removeWarningIcon()}else{this.addWarningIcon()}return a},valiConcurrentAndGetErrMsg:function(){var b="";var d=this.getFromSteps();$(d).each(function(e,f){if(a(f)){return true}else{return false}});function a(g){if(g instanceof FlowDesigner.ConcurrentStartStep||g instanceof FlowDesigner.ConcurrentEndStep){return true}else{if(g instanceof FlowDesigner.StartStep){b="Step.ConcurrentEnd.InValid.NeedStartOrEnd".loc();return false}else{if(!(g instanceof FlowDesigner.CounterSignStep)&&!(g instanceof FlowDesigner.SignStep)){b="Step.ConcurrentEnd.InValid.NeedCounterSignOrSign".loc();return false}else{var e=g.getFromSteps(),f=g.getToSteps();if(e.length!=1||f.length!=1){b="Step.ConcurrentEnd.InValid.OnlyHaveOneLine".loc();return false}else{return arguments.callee(e[0])}}}}}return b},consoleLog:function(a){if(typeof console=="object"){console.log("ConcurrentEndStep:"+a)}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");FlowDesigner.ConcurrentStartStep=new BasicClass({extend:FlowDesigner.Step,_init:function(a){this.propData={stepId:"-1",stepName:"unTitled",stepType:FlowDesigner.settings.stepTypes.concurrentStart,dealType:"",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",hours:168,logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,approverUserField:"",approverOrgField:"",flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0};this.fromSteps=[];this.toSteps=[];var b=$('<div class = "step concurrentStartStep">				<div class = "stepTip"></div>				<div class = "stepText"></div>			</div>');FlowDesigner.settings.canvas.append(b);this.target=b;this.propData.stepName=this.typeName;this.addLinkIcon();this.addDelIcon();this.setAutoText();this.valiAndGetErrMsg()},typeName:"Step.ConcurrentStart".loc(),valiAndGetErrMsg:function(){var a="";a=this.valiStepLineCountAndGetErrMsg();if(a==""){var b=this.getStepName();if(FlowDesigner.settings.curFlowDesigner.trim(b).length==0){a="Step.Name.Input".loc()}}if(a==""){a=this.valiConcurrentAndGetErrMsg()}if(a==""){this.removeWarningIcon()}else{this.addWarningIcon()}return a},valiConcurrentAndGetErrMsg:function(){var a="";var d=this.getToSteps();$(d).each(function(e,f){if(b(f)){return true}else{return false}});function b(g){if(g instanceof FlowDesigner.ConcurrentStartStep||g instanceof FlowDesigner.ConcurrentEndStep){return true}else{if(g instanceof FlowDesigner.EndStep){a="Step.ConcurrentStart.InValid.NeedStartOrEnd".loc();return false}else{if(!(g instanceof FlowDesigner.CounterSignStep)&&!(g instanceof FlowDesigner.SignStep)){a="Step.ConcurrentStart.InValid.NeedCounterSignOrSign".loc();return false}else{var e=g.getFromSteps(),f=g.getToSteps();if(e.length!=1||f.length!=1){a="Step.ConcurrentStart.InValid.OnlyHaveOneLine".loc();return false}else{return arguments.callee(f[0])}}}}}return a},consoleLog:function(a){if(typeof console=="object"){console.log("ConcurrentStartStep:"+a)}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");FlowDesigner.ConditionStep=new BasicClass({extend:FlowDesigner.Step,_init:function(b){this.propData={stepId:"-1",stepName:"unTitled",stepType:FlowDesigner.settings.stepTypes.condition,dealType:"",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",hours:168,logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,approverUserField:"",approverOrgField:"",flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0};this.fromSteps=[];this.toSteps=[];var d=$('<div class = "step conditionStep">				<div class = "stepTip"></div>				<div class = "stepText"></div>			</div>');FlowDesigner.settings.canvas.append(d);this.target=d;var a=this.getNewStepName(this.typeName);this.propData.stepName=a;this.addLinkIcon();this.addDelIcon();this.setAutoText();this.valiAndGetErrMsg()},typeName:"Step.Condition".loc(),valiAndGetErrMsg:function(){var b="";b=this.valiStepLineCountAndGetErrMsg();if(b==""){var e=this.getStepName();if(FlowDesigner.settings.curFlowDesigner.trim(e).length==0){b="Step.Name.NotEmpty".loc()}}if(b==""){var a=FlowDesigner.settings.lines;for(var d=0;d<a.length;d++){if(a[d].propData.fromStepId==this.propData.stepId){if(!FlowDesigner.settings.lines[d].propData.condition||FlowDesigner.settings.lines[d].propData.condition==""){b=e+": "+"Line.Condition.NotNull".loc()}}}}if(b==""){this.removeWarningIcon()}else{this.addWarningIcon()}return b},consoleLog:function(a){if(typeof console=="object"){console.log("ConditionStep:"+a)}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");FlowDesigner.CounterSignStep=new BasicClass({extend:FlowDesigner.Step,_init:function(b){this.propData={stepId:"-1",stepName:"unTitled",stepType:FlowDesigner.settings.stepTypes.counterSign,dealType:"pickupAtRuntime",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",hours:168,logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,approverUserField:"",approverOrgField:"",relatedRole:[],approverUserField:"",approverOrgField:"",flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0,disableCC:false,allowDistribute:false,can_edit_main_attach:false,can_edit_normal_attach:true,cc_must_finished:false,cc_alert:false,allowBatch:false,oneClickApproval:false,oneClickRejection:false,allow_pick_approve_users:false,};this.fromSteps=[];this.toSteps=[];var d=$('<div class = "step counterSignStep">				<div class = "stepTip"></div>				<div class = "stepText"></div>			</div>');FlowDesigner.settings.canvas.append(d);this.target=d;var a=this.getNewStepName(this.typeName);this.propData.stepName=a;this.addLinkIcon();this.addDelIcon();this.setAutoText();this.valiAndGetErrMsg()},typeName:"Step.CounterSign".loc(),getDealType:function(){return this.propData.dealType},getRelatedRole:function(){return this.propData.relatedRole},getHours:function(){return this.propData.hours},getRelatedRoleId:function(){return this.propData.relatedRoleId},getRelatedStepId:function(){return this.propData.relatedStepId},getLogicType:function(){return this.propData.logicType},setLogicType:function(a){this.propData.logicType=a},getRelatedUsers:function(){return this.propData.relatedUsers},setRelatedUsers:function(a){this.propData.relatedUsers=a},getRelatedGroups:function(){return this.propData.relatedGroups},setRelatedGroups:function(a){this.propData.relatedGroups=a},getApproverUserField:function(){return this.propData.approverUserField},getApproverOrgField:function(){return this.propData.approverOrgField},getOverCounterSignTypes:function(){return this.propData.overCounterSignType},valiAndGetErrMsg:function(){var a="";a=this.valiStepLineCountAndGetErrMsg();if(a==""){var f=this.getStepName();if(FlowDesigner.settings.curFlowDesigner.trim(f).length==0){a="Step.Name.NotEmpty".loc()}else{a=this.valiStepDealTypeAndGetErrMsg()}}if(a==""&&this.getDealType()==""){a=f+": "+"Step.DealType.NotNull".loc()}if(a==""&&this.getDealType()=="submitterRole"&&this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}if(a==""&&this.getDealType()=="specifyUser"){if(this.getRelatedUsers().length<1){a=f+": "+"Step.RelatedUsers.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.validRelateUsers(this.getRelatedUsers())==false){a=f+": "+"Step.RelatedUsers.HasUser.NotExist".loc()}}}if(a==""&&this.getDealType()=="specifyOrg"&&this.getRelatedGroups().length<1){a=f+": "+"Step.RelatedGroups.NotNull".loc()}if(a==""&&this.getDealType()=="specifyStepUser"){if(this.getRelatedStepId()==""){a=f+": "+"Step.RelatedStep.NotNull".loc()}if(a==""){var e=false;var b=FlowDesigner.settings.steps;for(var d=0;d<b.length;d++){if(this.getRelatedStepId()==b[d].getStepId()){e=true}}if(e==false){a=f+": "+"Step.RelatedStep.NotNull".loc()}}}if(a==""&&this.getDealType()=="specifyStepRole"){if(this.getRelatedStepId()==""){a=f+": "+"Step.RelatedStep.NotNull".loc()}if(a==""){var e=false;var b=FlowDesigner.settings.steps;for(var d=0;d<b.length;d++){if(this.getRelatedStepId()==b[d].getStepId()){e=true}}if(e==false){a=f+": "+"Step.RelatedStep.NotNull".loc()}}if(a==""&&this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}}if(a==""){if(this.getDealType()=="userField"){if(this.getApproverUserField()==""){a=f+": "+"Step.UserField.NotEmpty".loc()}else{if(FlowDesigner.FlowStepAndLineController.validApproverOrgFieldAndApproverUserField(this.getApproverUserField(),"")==false){a=f+": "+"Step.UserField.NotInForm".loc()}}}else{if(this.getDealType()=="orgField"){if(this.getApproverOrgField()==""){a=f+": "+"Step.OrgField.NotEmpty".loc()}else{if(FlowDesigner.FlowStepAndLineController.validApproverOrgFieldAndApproverUserField("",this.getApproverOrgField())==false){a=f+": "+"Step.OrgField.NotInForm".loc()}}}}}if(a==""&&this.getDealType()=="userFieldRole"){if(this.getApproverUserField()==""){a=f+": "+"Step.UserField.NotEmpty".loc()}else{if(this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.ValidRelateRole(this.getRelatedRole())==false){a=f+": "+"Step.RelatedRole.NotExist".loc()}}}}if(a==""&&this.getDealType()=="orgFieldRole"){if(this.getApproverOrgField()==""){a=f+": "+"Step.OrgField.NotEmpty".loc()}else{if(this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.ValidRelateRole(this.getRelatedRole())==false){a=f+": "+"Step.RelatedRole.NotExist".loc()}}}}if(a==""&&this.getDealType()=="applicantRole"){if(this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.ValidRelateRole(this.getRelatedRole())==false){a=f+": "+"Step.RelatedRole.NotExist".loc()}}}if(a==""){this.removeWarningIcon()}else{this.addWarningIcon()}return a},consoleLog:function(a){if(typeof console=="object"){console.log("CounterSignStep:"+a)}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");FlowDesigner.NotifyStep=new BasicClass({extend:FlowDesigner.Step,_init:function(a){this.propData={stepId:"-1",stepName:"unTitled",stepType:FlowDesigner.settings.stepTypes.notify,dealType:"specifyUser",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",hours:168,logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,approverUserField:"",approverOrgField:"",flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0};this.fromSteps=[];this.toSteps=[];var b=$('<div class = "step notifyStep">				<div class = "stepTip"></div>				<div class = "stepText"></div>			</div>');FlowDesigner.settings.canvas.append(b);this.target=b;this.propData.stepName=this.typeName;this.addLinkIcon();this.addDelIcon();this.setAutoText();this.valiAndGetErrMsg()},typeName:"Step.Notify".loc(),getHours:function(){return this.propData.hours},getRelatedRoleId:function(){return this.propData.relatedRoleId},getRelatedStepId:function(){return this.propData.relatedStepId},getLogicType:function(){return this.propData.logicType},setLogicType:function(a){this.propData.logicType=a},getRelatedUsers:function(){return this.propData.relatedUsers},setRelatedUsers:function(a){this.propData.relatedUsers=a},getRelatedGroups:function(){return this.propData.relatedGroups},setRelatedGroups:function(a){this.propData.relatedGroups=a},getApproverUserField:function(){return this.propData.approverUserField},getApproverOrgField:function(){return this.propData.approverOrgField},valiAndGetErrMsg:function(){var a="";a=this.valiStepLineCountAndGetErrMsg();if(a==""){var b=this.getStepName();if(FlowDesigner.settings.curFlowDesigner.trim(b).length==0){a="Step.Name.Input".loc()}else{a=this.valiStepDealTypeAndGetErrMsg()}}if(a==""){this.removeWarningIcon()}else{this.addWarningIcon()}return a},consoleLog:function(a){if(typeof console=="object"){console.log("NotifyStep:"+a)}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");FlowDesigner.SignStep=new BasicClass({extend:FlowDesigner.Step,_init:function(b){this.propData={stepId:"-1",stepName:"unTitled",stepType:FlowDesigner.settings.stepTypes.sign,dealType:"pickupAtRuntime",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",hours:168,logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,approverUserField:"",approverOrgField:"",relatedRole:[],flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0,disableCC:false,allowDistribute:false,can_edit_main_attach:false,can_edit_normal_attach:true,cc_must_finished:false,cc_alert:false,allow_pick_approve_users:false,cc_has_edit_permission:false,};this.fromSteps=[];this.toSteps=[];var d=$('<div class = "step signStep">				<div class = "stepTip"></div>				<div class = "stepText"></div>			</div>');FlowDesigner.settings.canvas.append(d);this.target=d;var a=this.getNewStepName(this.typeName);this.propData.stepName=a;this.addLinkIcon();this.addDelIcon();this.setAutoText();this.valiAndGetErrMsg()},typeName:"Step.Sign".loc(),getDealType:function(){return this.propData.dealType},getRelatedRole:function(){return this.propData.relatedRole},getApproverUserField:function(){return this.propData.approverUserField},getApproverOrgField:function(){return this.propData.approverOrgField},getRelatedStepId:function(){return this.propData.relatedStepId},getHours:function(){return this.propData.hours},getRelatedRoleId:function(){return this.propData.relatedRoleId},getLogicType:function(){return this.propData.logicType},setLogicType:function(a){this.propData.logicType=a},getRelatedUsers:function(){return this.propData.relatedUsers},setRelatedUsers:function(a){this.propData.relatedUsers=a},getRelatedGroups:function(){return this.propData.relatedGroups},setRelatedGroups:function(a){this.propData.relatedGroups=a},getApproverUserField:function(){return this.propData.approverUserField},getApproverOrgField:function(){return this.propData.approverOrgField},valiAndGetErrMsg:function(){var a="";a=this.valiStepLineCountAndGetErrMsg();if(a==""){var f=this.getStepName();if(FlowDesigner.settings.curFlowDesigner.trim(f).length==0){a="Step.Name.NotEmpty".loc()}else{a=this.valiStepDealTypeAndGetErrMsg()}}if(a==""&&this.getDealType()==""){a=f+": "+"Step.DealType.NotNull".loc()}if(a==""&&this.getDealType()=="submitterRole"&&this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}if(a==""&&this.getDealType()=="specifyUser"){if(this.getRelatedUsers().length<1){a=f+": "+"Step.RelatedUsers.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.validRelateUsers(this.getRelatedUsers())==false){a=f+": "+"Step.RelatedUsers.HasUser.NotExist".loc()}}}if(a==""&&this.getDealType()=="specifyOrg"&&this.getRelatedGroups().length<1){a=f+": "+"Step.RelatedGroups.NotNull".loc()}if(a==""&&this.getDealType()=="specifyStepUser"){if(this.getRelatedStepId()==""){a=f+": "+"Step.RelatedStep.NotNull".loc()}if(a==""){var e=false;var b=FlowDesigner.settings.steps;for(var d=0;d<b.length;d++){if(this.getRelatedStepId()==b[d].getStepId()){e=true}}if(e==false){a=f+": "+"Step.RelatedStep.NotNull".loc()}}}if(a==""&&this.getDealType()=="specifyStepRole"){if(this.getRelatedStepId()==""){a=f+": "+"Step.RelatedStep.NotNull".loc()}if(a==""){var e=false;var b=FlowDesigner.settings.steps;for(var d=0;d<b.length;d++){if(this.getRelatedStepId()==b[d].getStepId()){e=true}}if(e==false){a=f+": "+"Step.RelatedStep.NotNull".loc()}}if(a==""&&this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}}if(a==""){if(this.getDealType()=="userField"){if(this.getApproverUserField()==""){a=f+": "+"Step.UserField.NotEmpty".loc()}else{if(FlowDesigner.FlowStepAndLineController.validApproverOrgFieldAndApproverUserField(this.getApproverUserField(),"")==false){a=f+": "+"Step.UserField.NotInForm".loc()}}}else{if(this.getDealType()=="orgField"){if(this.getApproverOrgField()==""){a=f+": "+"Step.OrgField.NotEmpty".loc()}else{if(FlowDesigner.FlowStepAndLineController.validApproverOrgFieldAndApproverUserField("",this.getApproverOrgField())==false){a=f+": "+"Step.OrgField.NotInForm".loc()}}}}}if(a==""&&this.getDealType()=="userFieldRole"){if(this.getApproverUserField()==""){a=f+": "+"Step.UserField.NotEmpty".loc()}else{if(this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.ValidRelateRole(this.getRelatedRole())==false){a=f+": "+"Step.RelatedRole.NotExist".loc()}}}}if(a==""&&this.getDealType()=="orgFieldRole"){if(this.getApproverOrgField()==""){a=f+": "+"Step.OrgField.NotEmpty".loc()}else{if(this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.ValidRelateRole(this.getRelatedRole())==false){a=f+": "+"Step.RelatedRole.NotExist".loc()}}}}if(a==""&&this.getDealType()=="applicantRole"){if(this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.ValidRelateRole(this.getRelatedRole())==false){a=f+": "+"Step.RelatedRole.NotExist".loc()}}}if(a==""){this.removeWarningIcon()}else{this.addWarningIcon()}return a},consoleLog:function(a){if(typeof console=="object"){console.log("SignStep:"+a)}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");FlowDesigner.StartStep=new BasicClass({extend:FlowDesigner.Step,_init:function(a){this.propData={stepId:"-1",stepName:"unTitled",stepType:FlowDesigner.settings.stepTypes.start,dealType:"",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",hours:168,logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,approverUserField:"",approverOrgField:"",flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0,can_edit_main_attach:false,can_edit_normal_attach:true};this.fromSteps=[];this.toSteps=[];var b=$('<div class = "step startStep">				<div class = "stepTip"></div>				<div class = "stepText"></div>			</div>');FlowDesigner.settings.canvas.append(b);this.target=b;this.propData.stepName=this.typeName;this.addLinkIcon();this.setAutoText();this.valiAndGetErrMsg()},typeName:"Step.Start".loc(),valiAndGetErrMsg:function(){var a="";var b=this.getStepName();a=this.valiStepLineCountAndGetErrMsg();if(a==""){if(FlowDesigner.settings.curFlowDesigner.trim(b).length==0){a="Step.Name.NotEmpty".loc()}}if(a==""){this.removeWarningIcon()}else{this.addWarningIcon()}return a},consoleLog:function(a){if(typeof console=="object"){console.log("StartStep:"+a)}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");FlowDesigner.SubmitStep=new BasicClass({extend:FlowDesigner.Step,_init:function(b){this.propData={stepId:-1,stepName:"unTitled",stepType:FlowDesigner.settings.stepTypes.submit,dealType:"pickupAtRuntime",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",hours:168,logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,relatedRole:[],approverUserField:"",approverOrgField:"",flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0,disableCC:false,allowDistribute:false,can_edit_main_attach:false,can_edit_normal_attach:true,cc_must_finished:false,cc_alert:false,allow_pick_approve_users:false,cc_has_edit_permission:false,};this.fromSteps=[];this.toSteps=[];var d=$('<div class = "step submitStep">				<div class = "stepTip"></div>				<div class = "stepText"></div>			</div>');FlowDesigner.settings.canvas.append(d);this.target=d;var a=this.getNewStepName(this.typeName);this.propData.stepName=a;this.addLinkIcon();this.addDelIcon();this.setAutoText();this.valiAndGetErrMsg()},typeName:"Step.Submit".loc(),getDealType:function(){return this.propData.dealType},getRelatedRole:function(){return this.propData.relatedRole},getApproverUserField:function(){return this.propData.approverUserField},getApproverOrgField:function(){return this.propData.approverOrgField},getRelatedStepId:function(){return this.propData.relatedStepId},getHours:function(){return this.propData.hours},getRelatedRoleId:function(){return this.propData.relatedRoleId},getLogicType:function(){return this.propData.logicType},setLogicType:function(a){this.propData.logicType=a},getRelatedUsers:function(){return this.propData.relatedUsers},setRelatedUsers:function(a){this.propData.relatedUsers=a},getRelatedGroups:function(){return this.propData.relatedGroups},setRelatedGroups:function(a){this.propData.relatedGroups=a},getApproverUserField:function(){return this.propData.approverUserField},getApproverOrgField:function(){return this.propData.approverOrgField},valiAndGetErrMsg:function(){var a="";a=this.valiStepLineCountAndGetErrMsg();if(a==""){var f=this.getStepName();if(FlowDesigner.settings.curFlowDesigner.trim(f).length==0){a="Step.Name.NotEmpty".loc()}else{a=this.valiStepDealTypeAndGetErrMsg()}}if(a==""&&this.getDealType()==""){a=f+": "+"Step.DealType.NotNull".loc()}if(a==""&&this.getDealType()=="submitterRole"&&this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}if(a==""&&this.getDealType()=="specifyUser"){if(this.getRelatedUsers().length<1){a=f+": "+"Step.RelatedUsers.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.validRelateUsers(this.getRelatedUsers())==false){a=f+": "+"Step.RelatedUsers.HasUser.NotExist".loc()}}}if(a==""&&this.getDealType()=="specifyOrg"&&this.getRelatedGroups().length<1){a=f+": "+"Step.RelatedGroups.NotNull".loc()}if(a==""&&this.getDealType()=="specifyStepUser"){if(this.getRelatedStepId()==""){a=f+": "+"Step.RelatedStep.NotNull".loc()}if(a==""){var e=false;var b=FlowDesigner.settings.steps;for(var d=0;d<b.length;d++){if(this.getRelatedStepId()==b[d].getStepId()){e=true}}if(e==false){a=f+": "+"Step.RelatedStep.NotNull".loc()}}}if(a==""&&this.getDealType()=="specifyStepRole"){if(this.getRelatedStepId()==""){a=f+": "+"Step.RelatedStep.NotNull".loc()}if(a==""){var e=false;var b=FlowDesigner.settings.steps;for(var d=0;d<b.length;d++){if(this.getRelatedStepId()==b[d].getStepId()){e=true}}if(e==false){a=f+": "+"Step.RelatedStep.NotNull".loc()}}if(a==""&&this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}}if(a==""){if(this.getDealType()=="userField"){if(this.getApproverUserField()==""){a=f+": "+"Step.UserField.NotEmpty".loc()}else{if(FlowDesigner.FlowStepAndLineController.validApproverOrgFieldAndApproverUserField(this.getApproverUserField(),"")==false){a=f+": "+"Step.UserField.NotInForm".loc()}}}else{if(this.getDealType()=="orgField"){if(this.getApproverOrgField()==""){a="Step.OrgField.NotEmpty".loc()}else{if(FlowDesigner.FlowStepAndLineController.validApproverOrgFieldAndApproverUserField("",this.getApproverOrgField())==false){a=f+": "+"Step.OrgField.NotInForm".loc()}}}}}if(a==""&&this.getDealType()=="userFieldRole"){if(this.getApproverUserField()==""){a=f+": "+"Step.UserField.NotEmpty".loc()}else{if(this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.ValidRelateRole(this.getRelatedRole())==false){a=f+": "+"Step.RelatedRole.NotExist".loc()}}}}if(a==""&&this.getDealType()=="orgFieldRole"){if(this.getApproverOrgField()==""){a=f+": "+"Step.OrgField.NotEmpty".loc()}else{if(this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.ValidRelateRole(this.getRelatedRole())==false){a=f+": "+"Step.RelatedRole.NotExist".loc()}}}}if(a==""&&this.getDealType()=="applicantRole"){if(this.getRelatedRole().length<1){a=f+": "+"Step.RelatedRole.NotNull".loc()}else{if(FlowDesigner.FlowStepAndLineController.ValidRelateRole(this.getRelatedRole())==false){a=f+": "+"Step.RelatedRole.NotExist".loc()}}}if(a==""){this.removeWarningIcon()}else{this.addWarningIcon()}return a},consoleLog:function(a){if(typeof console=="object"){console.log("SubmitStep:"+a)}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");sc_require("mixins/FlowDesigner_Line");sc_require("mixins/FlowDesigner_ConcurrentEndStep");sc_require("mixins/FlowDesigner_ConcurrentStartStep");sc_require("mixins/FlowDesigner_ConditionStep");sc_require("mixins/FlowDesigner_CounterSignStep");sc_require("mixins/FlowDesigner_NotifyStep");sc_require("mixins/FlowDesigner_SignStep");sc_require("mixins/FlowDesigner_StartStep");sc_require("mixins/FlowDesigner_SubmitStep");FlowDesigner.PropForm=new BasicClass({_options:{bindSpirit:null},_valiOptions:function(a){if(typeof a!="object"){this.consoleLog("Step.InValid.NotJSON.Parameter".loc());return false}else{return true}},_init:function(b){this.setOptions(b);this.tabNowShowing="";this.stepAndLineNowShowing="";var a=null;if(this.bindSpirit instanceof FlowDesigner.Step){a=this.bindSpirit.getPropData();this.extendStepTypeNameData(a);this.tabNowShowing="FlowDesigner.FlowPropStepAndLineView";switch(this.bindSpirit.constructor){case FlowDesigner.StartStep:this.stepAndLineNowShowing="startStepPropView";break;case FlowDesigner.EndStep:this.stepAndLineNowShowing="endStepPropView";break;case FlowDesigner.ConditionStep:this.stepAndLineNowShowing="conditionStepPropView";break;case FlowDesigner.CounterSignStep:this.stepAndLineNowShowing="counterSignStepPropView";break;case FlowDesigner.SignStep:this.stepAndLineNowShowing="signStepPropView";break;case FlowDesigner.SubmitStep:this.stepAndLineNowShowing="submitStepPropView";break;case FlowDesigner.NotifyStep:this.stepAndLineNowShowing="notifyStepPropView";break;case FlowDesigner.ConcurrentStartStep:this.stepAndLineNowShowing="concurrentStartStepPropView";break;case FlowDesigner.ConcurrentEndStep:this.stepAndLineNowShowing="concurrentEndStepPropView";break}}else{if(this.bindSpirit instanceof FlowDesigner.Line){a=this.bindSpirit.getPropData();this.extendLineData(a);this.tabNowShowing="FlowDesigner.FlowPropStepAndLineView";this.stepAndLineNowShowing="linePropView"}else{this.tabNowShowing="";this.stepAndLineNowShowing=""}}if(a){this.bindData(a)}else{this.bindData(null)}FlowDesigner.settings.curPropForm=this},setBindSpirit:function(a){this.bindSpirit=a},getBindSpirit:function(a){return this.bindSpirit},bindData:function(a){FlowDesigner.settings.bindingDataInPropForm=YES;FlowDesigner.FlowStepAndLineController.set("content",a);FlowDesigner.settings.bindingDataInPropForm=NO},getData:function(){FlowDesigner.FlowStepAndLineController.get("content")},extendStepTypeNameData:function(a){var b=this.bindSpirit;a.stepTypeName=b.getTypeName()},extendLineData:function(a){var b=this.bindSpirit;a.lineFromStep=b.getFromStep().getStepName();a.lineToStep=b.getToStep().getStepName();a.lineState=b.getStateText()},show:function(){var b=FlowDesigner.settings.flowPropView.flowTabView;if(this.tabNowShowing){b.set("nowShowing",this.tabNowShowing);if(this.stepAndLineNowShowing&&this.stepAndLineNowShowing!=""){var a=b.containerView.contentView;a.set("nowShowing",this.stepAndLineNowShowing)}else{var a=b.containerView.contentView;a.set("nowShowing","emptyView")}}else{if(this.getIsShowingFlowPropStepAndLineView()){var a=b.containerView.contentView;a.set("nowShowing","emptyView")}}},showBtnsView:function(){var a=FlowDesigner.settings.flowPropView.flowTabView;a.set("nowShowing","FlowDesigner.FlowPropBtnsView")},showPropFlowView:function(){var a=FlowDesigner.settings.flowPropView.flowTabView;a.set("nowShowing","FlowDesigner.FlowPropFlowView")},getIsShowingFlowPropStepAndLineView:function(){return FlowDesigner.settings.flowPropView.flowTabView.get("nowShowing")=="FlowDesigner.FlowPropStepAndLineView"},remove:function(){this.bindSpirit=null;FlowDesigner.settings.curPropForm=null},consoleLog:function(a){if(typeof console=="object"){console.log("PropForm:"+a)}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");sc_require("mixins/FlowDesigner_Line");sc_require("mixins/FlowDesigner_ConcurrentEndStep");sc_require("mixins/FlowDesigner_ConcurrentStartStep");sc_require("mixins/FlowDesigner_ConditionStep");sc_require("mixins/FlowDesigner_CounterSignStep");sc_require("mixins/FlowDesigner_NotifyStep");sc_require("mixins/FlowDesigner_SignStep");sc_require("mixins/FlowDesigner_StartStep");sc_require("mixins/FlowDesigner_SubmitStep");sc_require("mixins/FlowDesigner_PropForm");FlowDesigner.Line=new BasicClass({extend:FlowDesigner.Spirit,_options:{propData:null,paths:null,textTarget:null,delIconTarget:null,limits:0,fromStep:null,toStep:null,isDraging:false,startPoint:null,endPoint:null,rotate:0,fromEqualTo:false},_valiOptions:function(a){if(typeof a!="undefined"){if(a instanceof Object&&a.fromStep instanceof FlowDesigner.Step&&a.toStep instanceof FlowDesigner.Step){return true}else{if(a instanceof Object&&a.fromStep instanceof FlowDesigner.Step&&typeof a.toStep=="undefined"){return true}else{this.consoleLog("Line.InValid.ErrorType".loc());return false}}}else{this.consoleLog("Line.InValid.NeedFromStep".loc());return false}},_init:function(b){this.paths=[];this.startPoint={x:0,y:0};this.endPoint={x:0,y:0};this.propData={lineName:"",lineDescription:"",fromStepId:"",toStepId:"",state:"submitted",lineTimeoutLine:false};var f=b.fromStep;var e=b.toStep;if(f instanceof FlowDesigner.Step&&e instanceof FlowDesigner.Step){this.setFromStep(f);var d=this.fromStep.getCenter();this.setStartPoint(d.left,d.top);this.setToStep(e);var a=this.toStep.getCenter();this.setEndPoint(a.left,a.top);this.setFromEqualTo(f==e);this.pushBoundFromAndToStep()}else{this.setFromStep(f);var d=this.fromStep.getCenter();this.setStartPoint(d.left,d.top)}if(f instanceof FlowDesigner.SignStep){this.setState("approved")}},consoleLog:function(a){if(typeof console=="object"){console.log("Line:"+a)}},getIsDraging:function(){return this.isDraging},setIsDraging:function(a){this.isDraging=a},getFromEqualTo:function(){return this.fromEqualTo},setFromEqualTo:function(a){this.fromEqualTo=a},getLimits:function(){return this.limits},setLimits:function(a){this.limits=a},getRotate:function(){return this.rotate},setRotate:function(a){this.rotate=a},getFromStep:function(){return this.fromStep},setFromStep:function(a){this.setFromStepId(a.getStepId());this.fromStep=a},getToStep:function(){return this.toStep},setToStep:function(a){this.setFromEqualTo(this.getFromStep()==a);this.setToStepId(a.getStepId());this.toStep=a},getFromStepId:function(){return this.propData.fromStepId},setFromStepId:function(a){this.propData.fromStepId=a},getToStepId:function(){return this.propData.toStepId},setToStepId:function(a){this.propData.toStepId=a},getPropData:function(){return this.propData},setPropData:function(a){$.extend(this.propData,a)},getLineName:function(){return this.propData.lineName},setLineName:function(a){this.propData.lineName=a},getCondition:function(){return this.propData.condition},setCondition:function(a){this.propData.condition=a},getState:function(){return this.propData.state},setState:function(a){this.propData.state=a},getStateText:function(){var b=this.getState();var a="";switch(b){case"submitted":a="Line.State.Submitted".loc();break;case"approved":a="Line.State.Approved".loc();break;case"rejected":a="Line.State.Rejected".loc();break}return a},getPaths:function(){return this.paths},getTextTarget:function(){return this.textTarget},setTextTarget:function(a){this.textTarget=a},getDelIconTarget:function(){return this.delIconTarget},setDelIconTarget:function(a){this.delIconTarget=a},setStartPoint:function(a,b){this.startPoint.x=a;this.startPoint.y=b},setEndPoint:function(a,b){this.endPoint.x=a;this.endPoint.y=b},setZIndex:function(a){var b=this.paths;$(b).each(function(d,e){e.css("z-index",a)})},getZIndex:function(a){var b=this.paths;return b[0].css("z-index")},highLightOver:function(a){if(typeof a=="boolean"){if(a){$(this.paths).each(function(e,f){f.addClass("lineHighLightOver")});var b=this.getTextTarget();if(b){b.addClass("lineHighLightOver")}var d=this.getDelIconTarget();if(d){d.addClass("lineHighLightOver")}if([FlowDesigner.settings.eventStates.movingStep].contains(FlowDesigner.settings.eventState)){this.addForceHideTagClassForDelIcon()}else{this.removeForceHideTagClassForDelIcon()}}else{$(this.paths).each(function(e,f){f.removeClass("lineHighLightOver")});var b=this.getTextTarget();if(b){b.removeClass("lineHighLightOver")}var d=this.getDelIconTarget();if(d){d.removeClass("lineHighLightOver")}this.removeForceHideTagClassForDelIcon()}}},addForceHideTagClassForDelIcon:function(){var a=this.getDelIconTarget();if(a){a.addClass("forceHideTag")}},removeForceHideTagClassForDelIcon:function(){var a=this.getDelIconTarget();if(a){a.removeClass("forceHideTag")}},highLight:function(a){if(typeof a=="boolean"){if(a){$(this.paths).each(function(e,f){f.addClass("lineHighLight")});var b=this.getTextTarget();if(b){b.addClass("lineHighLight")}var d=this.getDelIconTarget();if(d){d.addClass("lineHighLight")}if([FlowDesigner.settings.eventStates.movingLine,FlowDesigner.settings.eventStates.moveLinkingLine,FlowDesigner.settings.eventStates.linkingLine].contains(FlowDesigner.settings.eventState)){this.addForceHideTagClassForDelIcon()}else{this.removeForceHideTagClassForDelIcon()}}else{$(this.paths).each(function(e,f){f.removeClass("lineHighLight")});var b=this.getTextTarget();if(b){b.removeClass("lineHighLight")}var d=this.getDelIconTarget();if(d){d.removeClass("lineHighLight")}this.removeForceHideTagClassForDelIcon()}}},hasRepeatLine:function(){var b=false;if(FlowDesigner.settings.lines.length>0){var a=this.fromStep;var d=this.toStep;var e=this;$(FlowDesigner.settings.lines).each(function(f,g){if(g===e){return true}if(g.fromStep==a&&g.toStep==d){b=true;return false}})}return b},hasPath:function(b){var a=false;$(this.getPaths()).each(function(d,e){if(e.get(0)==b.get(0)){a=true;return false}});return a},remove:function(){if(this!=FlowDesigner.settings.activeLine){this.removeBoundFromAndToStep();var b=this.getFromStep();b.valiAndGetErrMsg();FlowDesigner.settings.curFlowDesigner.valiAllConcurrent()}this.clearPaths();this.clearTextTarget();this.propData=null;this.paths=null;this.fromStep=null;this.toStep=null;this.startPoint=null;this.endPoint=null;var a=$.inArray(this,FlowDesigner.settings.lines);if(a>-1){FlowDesigner.settings.lines.splice(a,1)}},draw:function(){this._setNewPaths();this._drawNewPaths();this.setAutoText()},pushBoundFromAndToStep:function(){this.fromStep.pushToStep(this.toStep);this.toStep.pushFromStep(this.fromStep)},removeBoundFromAndToStep:function(){this.fromStep.removeToStep(this.toStep);if(this.toStep instanceof FlowDesigner.Step){this.toStep.removeFromStep(this.fromStep)}},setAsDashedLine:function(a){var b=this.paths;if(b.length>0){var d=b[0];if(a){if(!d.hasClass("dashed")){d.addClass("dashed")}}else{d.removeClass("dashed")}}},sel:function(){if(FlowDesigner.settings.curSel){FlowDesigner.settings.curSel.highLight(false)}FlowDesigner.settings.curSel=this;this.highLight(true)},_drawNewPaths:function(){$(this.paths).each(function(a,b){FlowDesigner.settings.canvas.append(b)})},clearPaths:function(){$(this.paths).each(function(a,b){b.remove()});this.paths.length=0},_hideOldPathsBeforeClear:function(){$(this.paths).each(function(a,b){b.addClass("hidePathForClear");b.hide()}.binding(this));this.paths.length=0},_getDegByTan:function(a){return(Math.atan(a)/(Math.PI*2))*360},_getDegByTanAndLimits:function(d,a){var b=0;switch(a){case 1:b=0;break;case 2:b=180;break;case 3:b=180;break;case 4:b=360;break;default:b=0}return this._getDegByTan(d)+b},_setNewPaths:function(){if(SC.browser.isMobileSafari||SC.browser.isAndroid){this._hideOldPathsBeforeClear()}else{this.clearPaths()}var h=this.startPoint.x,g=this.startPoint.y,q=this.endPoint.x,n=this.endPoint.y;var k=this.getFromStep();if(!(k instanceof FlowDesigner.Step)){return}var j='<span class = "path" style = "position:absolute"><span></span></span>';if(this.getFromEqualTo()||FlowDesigner.settings.activeLineFromEqualTo){var p=k.target.width();var v=k.target.height();var o=$(".path").height()/2;var y=20;var e=$(j);e.offset({left:h+o,top:g+v/2});e.width(y);e.setTransform({rotate:90,translate:o});this.paths.push(e);var d=$(j);d.offset({left:h-6,top:g+v/2+y-7});d.width(p/2+y+12);d.setTransform({rotate:0,translate:0});this.paths.push(d);var b=$(j);b.offset({left:h+p/2+y-o,top:g+v/2+y+o});b.width(v+y*2+o*2+1);b.setTransform({rotate:270,translate:0});this.paths.push(b);var a=$(j);a.offset({left:h+p/2+y+6,top:g-v/2-y+6});a.width(p/2+y+12);a.setTransform({rotate:180,translate:0});this.paths.push(a);var z=$(j);z.offset({left:h+o,top:g-v/2-y});z.width(y);z.setTransform({rotate:90,translate:-o});this.paths.push(z);var s=$('<a class = "lineDelIcon heightLightTag" style = "left:13px;"></a>');d.prepend(s);this.setDelIconTarget(s);var m=$('<b class = "arrow"></b>');z.append(m)}else{var f=22;var u=0;var t=0;var l=0;var x=(n-g)/(q-h);if(q>h&&n>g){f+=10;l=1;u=this._getDegByTanAndLimits(x,l);t=Math.abs((n-g)/Math.sin(Math.PI*2*u/360))-f*2}else{if(q<h&&n>g){f+=10;l=2;u=this._getDegByTanAndLimits(x,l);t=Math.abs((n-g)/Math.sin(Math.PI*2*u/360))-f*2}else{if(q<h&&n<g){f+=10;l=3;u=this._getDegByTanAndLimits(x,l);t=Math.abs((n-g)/Math.sin(Math.PI*2*u/360))-f*2}else{if(q>h&&n<g){f+=10;l=4;u=this._getDegByTanAndLimits(x,l);t=Math.abs((n-g)/Math.sin(Math.PI*2*u/360))-f*2}else{if(q>h&&n==g){f+=10;l=5;u=0;t=q-h-f*2}else{if(q==h&&n>g){f+=10;l=6;u=90;t=n-g-f*2}else{if(q<h&&n==g){f+=10;l=7;u=180;t=h-q-f*2}else{if(q==h&&n<g){f+=10;l=8;u=270;t=g-n-f*2}else{}}}}}}}}if(this.getIsDraging()){t+=20}this.setRotate(u);this.setLimits(l);if(t>0){var e=$(j);var o=$(".path").height()/2;e.offset({left:h,top:g});e.width(t-o*2);var w=f+o;if(l==4){w-=2}e.setTransform({rotate:u,translate:w});this.paths.push(e);var s=$('<a class = "lineDelIcon heightLightTag"></a>');s.setTransform({rotate:180-u,translate:0});e.prepend(s);this.setDelIconTarget(s);var m=$('<b class = "arrow"></b>');e.append(m)}}},setAutoText:function(){var o=this.getLineName();if(typeof o!="string"){o=""}var j=this.getTextTarget();if(!j){j=$('<span class = "lineText" style = "position:absolute;"></span>');FlowDesigner.settings.canvas.append(j);this.setTextTarget(j)}j.html(o);var l=j.width(),m=j.height();if(this.getFromEqualTo()||FlowDesigner.settings.activeLineFromEqualTo){var g=this.getFromStep(),n=g.getCenter();j.css({left:n.left,top:n.top,marginTop:(-m/2),marginLeft:50})}else{var f=this.startPoint.x,e=this.startPoint.y,b=this.endPoint.x,p=this.endPoint.y;var k={left:0,top:0};k.left=(f+b)/2;k.top=(e+p)/2;var a=this.getLimits(),d=(-m/2),h=(-l/2);switch(a){case 1:d+=10;break;case 2:d-=10;break;case 3:d-=10;break;case 4:d+=10;break;case 5:d+=10;break;case 6:d+=10;break;case 7:d-=10;break;case 8:d-=10;break}j.css({left:k.left,top:k.top,marginTop:d,marginLeft:h})}},clearTextTarget:function(){this.getTextTarget().remove()}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");sc_require("mixins/FlowDesigner_Line");sc_require("mixins/FlowDesigner_ConcurrentEndStep");sc_require("mixins/FlowDesigner_ConcurrentStartStep");sc_require("mixins/FlowDesigner_ConditionStep");sc_require("mixins/FlowDesigner_CounterSignStep");sc_require("mixins/FlowDesigner_NotifyStep");sc_require("mixins/FlowDesigner_SignStep");sc_require("mixins/FlowDesigner_StartStep");sc_require("mixins/FlowDesigner_SubmitStep");sc_require("mixins/FlowDesigner_PropForm");FlowDesigner.Designer=new BasicClass({_options:{data:null,container:null,propData:null,designerView:null,isEditable:NO},_valiOptions:function(a){if(typeof a!="object"){this.consoleLog("Step.InValid.NotJSON.Parameter".loc());return false}else{if(!(a.data instanceof Object)){this.consoleLog("Step.InValid.NotJSON.Data".loc());return false}else{if(!(a.container instanceof $&&a.container.length>0)){this.consoleLog("Step.InValid.NotJquery.Container".loc());return false}else{return true}}}},_init:function(a){this.setOptions(a);this.start()},consoleLog:function(a){if(typeof console=="object"){console.log("curFlowDesigner:"+a)}},getFlowName:function(){return FlowDesigner.FlowController.get("name")},getPropData:function(){return this.data},setPropData:function(a){$.extend(this.data,a)},getIsEditable:function(){return this.isEditable},getEffectStartDate:function(){},start:function(){FlowDesigner.settings=FlowDesigner.getDefaultSettings();FlowDesigner.settings.curFlowDesigner=this;FlowDesigner.settings.canvasWrap=this.container;FlowDesigner.settings.canvas=$(".flowCanvas",this.container);FlowDesigner.settings.canvasSize={width:FlowDesigner.settings.canvas.width(),height:FlowDesigner.settings.canvas.height()};FlowDesigner.settings.designerView=this.designerView;FlowDesigner.settings.flowPropView=this.designerView.flowPropertyView;FlowDesigner.settings.flowCanvasView=this.designerView.flowCanvasView;FlowDesigner.settings.canvas.append('<span class = "arrow outHidden"></span>');FlowDesigner.settings.canvas.append('<span class = "path outHidden"></span>');FlowDesigner.settings.lineZIndex=$(".path").css("z-index");this.bindEvents();this.loadData(this.data);this.valiAllStep();this.setCanvasFocus()},loadData:function(b){if(b instanceof Object){var a=b.current?b.current.steps:null;if(a&&a.length>0){$(a).each(function(e,f){var d=this.getStepData(f);this.createStepByStepData(d)}.binding(this));$(a).each(function(d,e){this.createStepLinesByStepData(e)}.binding(this))}this.setPropData(b)}},reloadData:function(a){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){if(a instanceof Object){this.clearStepsAndLines();this.loadData(a);this.reloadCurSel();this.valiAllStep()}}},reloadCurSel:function(){var a=FlowDesigner.settings.curSel,b;if(a instanceof FlowDesigner.Step){b=FlowDesigner.settings.steps.find(function(d){if(d.propData.stepId==a.propData.stepId){return YES}})}else{if(a instanceof FlowDesigner.Line){b=FlowDesigner.settings.lines.find(function(d){if(d.propData.lineId==a.propData.lineId){return YES}})}}if(b){b.sel();FlowDesigner.settings.curSel=b;this.openPropForm(true,false)}},clearStepsAndLines:function(){$(FlowDesigner.settings.lines).each(function(a,b){b.clearPaths();b.clearTextTarget()});FlowDesigner.settings.lines=[];$(FlowDesigner.settings.steps).each(function(a,b){b.target.remove()});FlowDesigner.settings.steps=[]},valiAllConcurrent:function(){$(FlowDesigner.settings.steps).each(function(a,b){if(b instanceof FlowDesigner.ConcurrentStartStep||b instanceof FlowDesigner.ConcurrentEndStep){b.valiAndGetErrMsg()}})},getCanvasWrapOffset:function(){return FlowDesigner.settings.canvasWrap.offset()},getCanvasWrapScrollLeft:function(){var a=FlowDesigner.settings.flowCanvasView.horizontalScrollOffset();return a},getCanvasWrapScrollTop:function(){var a=FlowDesigner.settings.flowCanvasView.verticalScrollOffset();return a},bindRoleList:function(a){if(a instanceof Array){var d=this.container.find("select[name='roles']");var b=[];b.push('<option value = "'+0+'">'+"Step.Message.SelectRole".loc()+"</option>");$(a).each(function(e,f){b.push('<option value = "'+f.roleId+'">'+f.roleName+"</option>")});d.html(b.join(""))}},bindFiledList:function(d){if(d instanceof Array){var f=this.container.find("select[name='userField']");var e=[];e.push('<option value = "'+0+'">'+"Step.Message.SelectField".loc()+"</option>");$(d).each(function(g,h){if(h.fieldType=="user"){e.push('<option value = "'+h.fieldId+'">'+h.name+"</option>")}});f.html(e.join(""));var b=this.container.find("select[name='orgField']");var a=[];a.push('<option value = "'+0+'">'+"Step.Message.SelectField".loc()+"</option>");$(d).each(function(g,h){if(h.fieldType=="group"){a.push('<option value = "'+h.fieldId+'">'+h.name+"</option>")}});b.html(a.join(""))}},bindDecisionTypeList:function(){var e=FlowDesigner.settings.decisionTypes;var d=[{value:e.all,name:"Step.DecisionType.All".loc()},{value:e.anyApprove,name:"Step.DecisionType.AnyApprove".loc()},{value:e.anyReject,name:"Step.DecisionType.AnyReject".loc()},{value:e.firstApprove,name:"Step.DecisionType.FirstApprove".loc()}];var b=this.container.find("select[name='decisionType']");var a=[];a.push('<option value = "'+0+'">'+"Step.Message.SelectDecisionType".loc()+"</option>");$(d).each(function(f,g){a.push('<option value = "'+g.value+'">'+g.name+"</option>")});b.html(a.join(""))},bindOverCounterSignTypeList:function(){var d=FlowDesigner.settings.overCounterSignTypes;var a=[{value:d.wait,name:"Step.OverCounterSignType.WaitForAll".loc()},{value:d.noWait,name:"Step.OverCounterSignType.AnyFit".loc()}];var e=this.container.find("select[name='overCounterSignType']");var b=[];b.push('<option value = "'+0+'">'+"Step.Message.SelectOverCounterSignType".loc()+"</option>");$(a).each(function(f,g){b.push('<option value = "'+g.value+'">'+g.name+"</option>")});e.html(b.join(""))},createStepByStepData:function(d){var f=null;var b=d.stepType;var g=FlowDesigner.settings.stepTypes;if(b==g.start){f=new FlowDesigner.StartStep({isFromLoad:true});if(d.posx<0||d.posy<0){var h=this.getCanvasWrapOffset();var a=FlowDesigner.settings.canvasWrap;f.setCenter(a.width()/4+h.left,a.height()/2+h.top);var e=f.getPosition();d.posx=e.left;d.posy=e.top}else{f.setOffsetByPosition(d.posx,d.posy)}}else{if(b==g.end){f=new FlowDesigner.EndStep({isFromLoad:true});if(d.posx<0||d.posy<0){var h=this.getCanvasWrapOffset();var a=FlowDesigner.settings.canvasWrap;f.setCenter(a.width()*3/4+h.left,a.height()/2+h.top);var e=f.getPosition();d.posx=e.left;d.posy=e.top}else{f.setOffsetByPosition(d.posx,d.posy)}}else{if(b==g.condition){f=new FlowDesigner.ConditionStep({isFromLoad:true});f.setOffsetByPosition(d.posx,d.posy)}else{if(b==g.counterSign){f=new FlowDesigner.CounterSignStep({isFromLoad:true});f.setOffsetByPosition(d.posx,d.posy)}else{if(b==g.sign){f=new FlowDesigner.SignStep({isFromLoad:true});f.setOffsetByPosition(d.posx,d.posy)}else{if(b==g.submit){f=new FlowDesigner.SubmitStep({isFromLoad:true});f.setOffsetByPosition(d.posx,d.posy)}else{if(b==g.notify){f=new FlowDesigner.NotifyStep({isFromLoad:true});f.setOffsetByPosition(d.posx,d.posy)}else{if(b==g.concurrentStart){f=new FlowDesigner.ConcurrentStartStep({isFromLoad:true});f.setOffsetByPosition(d.posx,d.posy)}else{if(b==g.concurrentEnd){f=new FlowDesigner.ConcurrentEndStep({isFromLoad:true});f.setOffsetByPosition(d.posx,d.posy)}else{f=new FlowDesigner.Step({isFromLoad:true});f.setOffsetByPosition(d.posx,d.posy);this.consoleLog("Step.InValid.NotFitType.CreateStepByStepData".loc())}}}}}}}}}d.lines=[];f.setPropData(d);f.setAutoText();FlowDesigner.settings.steps.push(f)},valiAllStep:function(){$(FlowDesigner.settings.steps).each(function(a,b){b.valiAndGetErrMsg()})},createStepLinesByStepData:function(a){$(a.lines).each(function(b,e){var d=this.getLineData(a.id,e);this.createLinesByStepData(a.id,d)}.binding(this))},createLinesByStepData:function(d,f){var e=this.getStepByStepId(d);var b=this.getStepByStepId(f.toStepId);var a=new FlowDesigner.Line({fromStep:e,toStep:b});a.setPropData(f);a.draw();FlowDesigner.settings.lines.push(a)},getStepByStepId:function(b){var a=null;$(FlowDesigner.settings.steps).each(function(d,e){if(e.getStepId()==b){a=e;return false}});return a},addLineToStep:function(f){var a=FlowDesigner.settings.activeLine;var d=a.getFromStep();var b=f.getStep();if(d instanceof FlowDesigner.ConditionStep){if(d==b){new FlowDesigner.ToolTip({msg:"Step.InValid.ConditionNotLinkToCondition".loc()});return}if(b instanceof FlowDesigner.ConditionStep){new FlowDesigner.ToolTip({msg:"Step.InValid.ConditionNotLinkToCondition".loc()});return}}a.setToStep(b);if(a.hasRepeatLine()){new FlowDesigner.ToolTip({msg:"Step.InValid.NotRepeatLink".loc()});return}this.resetCurSel();a.setIsDraging(false);var e=b.getCenter();a.setEndPoint(e.left,e.top);a.draw();a.pushBoundFromAndToStep();d.valiAndGetErrMsg();FlowDesigner.settings.lines.push(a);FlowDesigner.settings.curSel=a;a.highLight(true);a.removeForceHideTagClassForDelIcon();b.removeForceHideTagClass();this.openPropForm(false,false);FlowDesigner.settings.activeLine=null;a=null;FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;FlowDesigner.settings.canvas.removeClass("cursorForLink");FlowDesigner.settings.curFlowDesigner.valiAllConcurrent();FlowDesigner.settings.curFlowDesigner.propChangeHandler()},moveLineToStep:function(g){var a=FlowDesigner.settings.movingLine;var e=a.getFromStep();var d=g.getStep();if(e instanceof FlowDesigner.ConditionStep){if(e==d){new FlowDesigner.ToolTip({msg:"Step.InValid.ConditionNotLinkToCondition".loc()});return}if(d instanceof FlowDesigner.ConditionStep){new FlowDesigner.ToolTip({msg:"Step.InValid.ConditionNotLinkToCondition".loc()});return}}var b=a.getToStep();if(b!=d){a.setToStep(d);if(a.hasRepeatLine()){new FlowDesigner.ToolTip({msg:"Step.InValid.NotRepeatLink".loc()});a.setToStep(b);return}else{a.setToStep(b);a.removeBoundFromAndToStep();a.setToStep(d);a.pushBoundFromAndToStep()}}a.setIsDraging(false);var f=d.getCenter();a.setEndPoint(f.left,f.top);a.draw();e.valiAndGetErrMsg();FlowDesigner.settings.curSel=a;a.highLightOver(false);a.highLight(true);a.removeForceHideTagClassForDelIcon();d.removeForceHideTagClass();this.openPropForm(true,false);FlowDesigner.settings.movingLine=null;a=null;FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;FlowDesigner.settings.canvas.removeClass("cursorForLink");FlowDesigner.settings.curFlowDesigner.valiAllConcurrent();FlowDesigner.settings.curFlowDesigner.propChangeHandler()},removeCurPropForm:function(){if(FlowDesigner.settings.curPropForm instanceof FlowDesigner.PropForm){FlowDesigner.settings.curPropForm.remove()}},resetCurSel:function(){if(FlowDesigner.settings.curSel instanceof FlowDesigner.Spirit){FlowDesigner.settings.curSel.highLight(false);FlowDesigner.settings.curSel=null}},openPropForm:function(e,d){var b=FlowDesigner.settings.curSel;if(FlowDesigner.settings.curPropForm instanceof FlowDesigner.PropForm){if(e||FlowDesigner.settings.curPropForm.getBindSpirit()!=b){}else{if(d){FlowDesigner.settings.curPropForm.show()}return}}var a=new FlowDesigner.PropForm({bindSpirit:b});if(d||a.getIsShowingFlowPropStepAndLineView()){a.show()}},valiFlow:function(){var f=this;var e="";var g=[];var b=f.getFlowName();if(!(typeof b=="string"&&this.trim(b).length>0)){new FlowDesigner.ToolTip({msg:"Flow.Name.Input".loc()});e="Flow.Name.Not.Input".loc()}if(FlowDesigner.settings&&FlowDesigner.settings.steps){var a=FlowDesigner.settings.steps;for(var d=0;d<a.length;d++){e=a[d].valiAndGetErrMsg();if(e!=""){g.push(e)}}}if(g.length>0){if(FlowDesigner.FlowController.get("is_valid")==true){FlowDesigner.FlowController.set("is_valid",false)}FlowDesigner.flowValidController.set("errorMessage",g.join("\n"))}else{if(FlowDesigner.FlowController.get("is_valid")==false){FlowDesigner.FlowController.set("is_valid",true)}if(FlowDesigner.flowValidController.get("errorMessage")){FlowDesigner.flowValidController.set("errorMessage","")}}return(g.length>0?false:true)},compareForStepSort:function(e,d){if(SC.none(e)&&(!SC.none(d))){return 1}else{if(!SC.none(e)&&(SC.none(d))){return -1}else{if(SC.none(e)&&SC.none(d)){return 0}}}var h=0;var g=e.getPosition();var f=d.getPosition();if(g.left<f.left){return -1}else{if(g.left>f.left){return 1}else{if(g.top<g.top){return -1}else{if(g.top>g.top){return 1}}}}return h},compareForLineSort:function(f,d){var h=0;var k=f.getFromStep();var j=d.getFromStep();if(k==j){var g=f.getToStep();var e=d.getToStep();if(!(g instanceof FlowDesigner.Step)){h=1}else{if(!(e instanceof FlowDesigner.Step)){h=-1}else{h=this.compareForStepSort(g,e)}}}else{h=this.compareForStepSort(k,j)}return h},sortSteps:function(){return FlowDesigner.settings.steps.sort(this.compareForStepSort.binding(this))},sortLines:function(a){if(a){return a.sort(this.compareForLineSort.binding(this))}else{return FlowDesigner.settings.lines.sort(this.compareForLineSort.binding(this))}},getRoleNameByRoleId:function(a){var b="Step.Message.SelectRole".loc();$(this.data.roles).each(function(d,e){if(e.roleId==a){b=e.roleName;return false}});return b},saveSteps:function(a){var b=this.getStepsDataBySteps(a);new FlowDesigner.ToolTip({msg:"Step.Message.Save.Succeed".loc()})},getStepDatasBySteps:function(a){if(a){var b=[];$(a).each(function(d,g){var f=g.getPropData();var e=null;if(!SC.none(f)){if(f.step_type=="start"||(f.step_type=="end")){e={id:f.stepId,name:f.stepName,step_type:f.stepType,deal_type:f.dealType,description:f.stepDesc,posx:f.posx,posy:f.posy,approver_users:f.relatedUsers,approver_orgs:f.relatedGroups,approver_user_field:f.approverUserField,approver_org_field:f.approverOrgField,approver_roles:f.relatedRole,approver_step:f.relatedStepId,lines:f.lines,help_text:f.helpText,permissions:f.permissions};if(f.step_type=="start"){e.can_edit_main_attach=f.can_edit_main_attach;e.can_edit_normal_attach=f.can_edit_normal_attach}}else{e={id:f.stepId,name:f.stepName,step_type:f.stepType,deal_type:f.dealType,description:f.stepDesc,posx:f.posx,posy:f.posy,timeout_hours:f.hours,approver_users:f.relatedUsers,approver_orgs:f.relatedGroups,approver_user_field:f.approverUserField,approver_org_field:f.approverOrgField,approver_roles:f.relatedRole,approver_step:f.relatedStepId,lines:f.lines,help_text:f.helpText,permissions:f.permissions,disableCC:f.disableCC,allowDistribute:f.allowDistribute,can_edit_main_attach:f.can_edit_main_attach,can_edit_normal_attach:f.can_edit_normal_attach,distribute_optional_flows:f.distribute_optional_flows,cc_must_finished:f.cc_must_finished,cc_alert:f.cc_alert,allowBatch:f.allowBatch,oneClickApproval:f.oneClickApproval,oneClickRejection:f.oneClickRejection,allow_pick_approve_users:f.allow_pick_approve_users,cc_has_edit_permission:f.cc_has_edit_permission}}}b.push(e)});return b}},getLineDatasByLines:function(a){var b=[];$(a).each(function(d,g){var f=g.getPropData();var e={id:f.lineId,name:f.lineName,state:f.state,condition:f.condition,from_step:f.fromStepId,to_step:f.toStepId,description:f.lineDescription,timeout_line:f.lineTimeoutLine};b.push(e)});return b},getStartStep:function(){var a=null;$(FlowDesigner.settings.steps).each(function(b,d){if(d instanceof FlowDesigner.StartStep){a=d;return false}});return a},getEndStep:function(){var a=null;$(FlowDesigner.settings.steps).each(function(b,d){if(d instanceof FlowDesigner.EndStep){a=d;return false}});return a},reSetWillLinkToStepByPosition:function(a,b){if(FlowDesigner.settings.willLinkToStep){FlowDesigner.settings.willLinkToStep.highLightOver(false);FlowDesigner.settings.willLinkToStep=null}$(FlowDesigner.settings.steps).each(function(e,l){var j=l.target,h=j.offset(),d=h.left,g=h.left+j.width(),k=h.top,f=h.top+j.height();if((a>d&&a<g)&&(b>k&&b<f)){FlowDesigner.settings.willLinkToStep=l;FlowDesigner.settings.willLinkToStep.highLightOver(true);return false}})},bindEvents:function(){this.stepMousedownHandler=this.stepMousedownHandler.binding(this);this.stepMouseupHandler=this.stepMouseupHandler.binding(this);this.stepMousemoveHandler=this.stepMousemoveHandler.binding(this);this.stepMouseoverHandler=this.stepMouseoverHandler.binding(this);this.stepMouseoutHandler=this.stepMouseoutHandler.binding(this);this.stepDblclickHandler=this.stepDblclickHandler.binding(this);this.btnDelClickHandler=this.btnDelClickHandler.binding(this);this.btnLinkClickHandler=this.btnLinkClickHandler.binding(this);this.btnStepClickHandler=this.btnStepClickHandler.binding(this);this.btnsMouseupHandler=this.btnsMouseupHandler.binding(this);this.stepDelIconMousedownHandler=this.stepDelIconMousedownHandler.binding(this);this.stepDelIconMouseupHandler=this.stepDelIconMouseupHandler.binding(this);this.lineDelIconMousedownHandler=this.lineDelIconMousedownHandler.binding(this);this.lineDelIconMouseupHandler=this.lineDelIconMouseupHandler.binding(this);this.lineMouseoverHandler=this.lineMouseoverHandler.binding(this);this.lineMouseoutHandler=this.lineMouseoutHandler.binding(this);this.lineMousedownHandler=this.lineMousedownHandler.binding(this);this.lineMouseupHandler=this.lineMouseupHandler.binding(this);this.lineMousemoveHandler=this.lineMousemoveHandler.binding(this);this.lineDblclickHandler=this.lineDblclickHandler.binding(this);this.lineTextMouseoverHandler=this.lineTextMouseoverHandler.binding(this);this.lineTextMouseoutHandler=this.lineTextMouseoutHandler.binding(this);this.lineTextMouseupHandler=this.lineTextMouseupHandler.binding(this);this.canvasMousemoveHandler=this.canvasMousemoveHandler.binding(this);this.canvasClickHandler=this.canvasClickHandler.binding(this);this.canvasDblclickHandler=this.canvasDblclickHandler.binding(this);this.canvasMouseupHandler=this.canvasMouseupHandler.binding(this);this.bodyKeydownHandler=this.bodyKeydownHandler.binding(this);this.canvasKeydownHandler=this.canvasKeydownHandler.binding(this);if(SC.browser.isMobileSafari||SC.browser.isAndroid){this.container.delegate(".step","touchstart",function(a){a.preventDefault();a.stopPropagation();this.stepMousedownHandler(a)}.binding(this));this.container.delegate(".path","touchstart",function(a){a.preventDefault();a.stopPropagation();this.lineMousedownHandler(a)}.binding(this));this.container.delegate(".step","touchmove",function(a){this.stepMousemoveHandler(a);if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.moveLinkingLine){this.reSetWillLinkToStepByPosition(a.pageX,a.pageY)}}.binding(this));this.container.delegate(".step","touchend",function(a){if(FlowDesigner.settings.willLinkToStep&&FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.moveLinkingLine){this.stepMouseupHandler({target:FlowDesigner.settings.willLinkToStep.target[0]});FlowDesigner.settings.willLinkToStep.highLightOver(false);FlowDesigner.settings.willLinkToStep=null;FlowDesigner.settings.needResetCurSel=false}else{this.stepMouseupHandler(a)}}.binding(this));this.container.delegate(FlowDesigner.settings.canvas.selector,"touchmove",function(a){this.canvasMousemoveHandler(a)}.binding(this));this.container.delegate(FlowDesigner.settings.canvas.selector,"touchend",function(a){this.canvasMouseupHandler(a)}.binding(this));this.container.delegate("span.lineText","touchend",function(a){this.lineTextMouseupHandler(a)}.binding(this));if(this.getIsEditable()){this.container.delegate(".step a.stepLinkIcon","touchstart",function(a){this.btnLinkClickHandler(a)}.binding(this));this.container.delegate(".step a.stepDelIcon","touchstart",function(a){this.stepDelIconMousedownHandler(a)}.binding(this));this.container.delegate(".step a.stepDelIcon","touchend",function(a){this.stepDelIconMouseupHandler(a)}.binding(this));this.container.delegate("a.lineDelIcon","touchstart",function(a){this.lineDelIconMousedownHandler(a)}.binding(this));this.container.delegate("a.lineDelIcon","touchend",function(a){this.lineDelIconMouseupHandler(a)}.binding(this));this.container.delegate(".path","touchmove",function(a){this.lineMousemoveHandler(a);this.reSetWillLinkToStepByPosition(a.pageX,a.pageY)}.binding(this));this.container.delegate(".path","touchend",function(a){if(FlowDesigner.settings.willLinkToStep){this.stepMouseupHandler({target:FlowDesigner.settings.willLinkToStep.target[0]});FlowDesigner.settings.willLinkToStep.highLightOver(false);FlowDesigner.settings.willLinkToStep=null;FlowDesigner.settings.needResetCurSel=false}this.lineMouseupHandler(a);$(this.container.selector+" .path.hidePathForClear").remove()}.binding(this))}}else{this.container.delegate(".step","mouseup",this.stepMouseupHandler);this.container.delegate(".step","mousemove",this.stepMousemoveHandler);this.container.delegate(".step","mouseover",this.stepMouseoverHandler);this.container.delegate(".step","mouseout",this.stepMouseoutHandler);this.container.delegate(".step","mousedown",this.stepMousedownHandler);this.container.delegate(".step","dblclick",this.stepDblclickHandler);this.container.delegate(".path","mouseover",this.lineMouseoverHandler);this.container.delegate(".path","mouseout",this.lineMouseoutHandler);this.container.delegate(".path","mousedown",this.lineMousedownHandler);this.container.delegate(".path","dblclick",this.lineDblclickHandler);this.container.delegate("span.lineText","mouseover",this.lineTextMouseoverHandler);this.container.delegate("span.lineText","mouseout",this.lineTextMouseoutHandler);this.container.delegate("span.lineText","mouseup",this.lineTextMouseupHandler);this.container.delegate("span.lineText","dblclick",this.lineDblclickHandler);this.container.delegate(FlowDesigner.settings.canvas.selector,"click",this.canvasClickHandler);FlowDesigner.settings.body.bind("keydown",this.bodyKeydownHandler);FlowDesigner.settings.canvas.bind("keydown",this.canvasKeydownHandler);this.container.delegate(FlowDesigner.settings.canvas.selector,"mousemove",this.canvasMousemoveHandler);FlowDesigner.settings.body.bind("mouseup",this.canvasMouseupHandler);this.container.delegate(FlowDesigner.settings.canvas.selector,"selectstart",function(){return false});this.container.delegate(FlowDesigner.settings.canvas.selector,"drag",function(){return false});this.container.delegate("a","selectstart",function(){return false});this.container.delegate("a","dragstart",function(){return false});this.container.delegate("a","drag",function(){return false});if(this.getIsEditable()){this.container.delegate(".step a.stepLinkIcon","mousedown",this.btnLinkClickHandler);this.container.delegate(".step a.stepDelIcon","mousedown",this.stepDelIconMousedownHandler);this.container.delegate(".step a.stepDelIcon","mousemove",this.stepDelIconMousemoveHandler);this.container.delegate(".step a.stepDelIcon","mouseup",this.stepDelIconMouseupHandler);this.container.delegate(".path","mouseup",this.lineMouseupHandler);this.container.delegate(".path","mousemove",this.lineMousemoveHandler);this.container.delegate("a.lineDelIcon","mousedown",this.lineDelIconMousedownHandler);this.container.delegate("a.lineDelIcon","mousemove",this.lineDelIconMousemoveHandler);this.container.delegate("a.lineDelIcon","mouseup",this.lineDelIconMouseupHandler);this.container.delegate("a.lineDelIcon","mouseover",this.lineDelIconMouseoverHandler);this.container.delegate("a.lineDelIcon","mouseout",this.lineDelIconMouseoutHandler);this.container.delegate(FlowDesigner.settings.canvas.selector,"dblclick",this.canvasDblclickHandler)}}},stepDelIconMousedownHandler:function(){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.preparingDeleteStep},stepDelIconMousemoveHandler:function(){return false},stepDelIconMouseupHandler:function(){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingDeleteStep){this.btnDelClickHandler()}},lineDelIconMouseoverHandler:function(b){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){var a=$(b.target).getLine("delIcon");a.highLightOver(true)}},lineDelIconMouseoutHandler:function(b){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){var a=$(b.target).getLine("delIcon");a.highLightOver(false)}},lineDelIconMousedownHandler:function(a){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.preparingDeleteLine;$(a.target).setAsCurLine("delIcon")},lineTextMouseoverHandler:function(b){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){var a=$(b.target).getLine("text");a.highLightOver(true)}},lineTextMouseoutHandler:function(b){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){var a=$(b.target).getLine("text");a.highLightOver(false)}},lineTextMouseupHandler:function(a){$(a.target).setAsCurLine("text")},lineDelIconMousemoveHandler:function(){return false},lineDelIconMouseupHandler:function(a){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingDeleteLine){this.btnDelClickHandler()}},btnStepClickHandler:function(e){if(typeof e=="string"){if(FlowDesigner.settings.activeStep instanceof FlowDesigner.Step){FlowDesigner.settings.activeStep.remove();FlowDesigner.settings.activeStep=null}}FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.preparingAddStep;FlowDesigner.settings.canvas.addClass("cursorForAdd");var a=null;switch(e){case"start":a=new FlowDesigner.StartStep();break;case"end":a=new FlowDesigner.EndStep();break;case"condition":a=new FlowDesigner.ConditionStep();break;case"counterSign":a=new FlowDesigner.CounterSignStep();break;case"sign":a=new FlowDesigner.SignStep();break;case"submit":a=new FlowDesigner.SubmitStep();break;case"notify":a=new FlowDesigner.NotifyStep();break;case"concurrentStart":a=new FlowDesigner.ConcurrentStartStep();break;case"concurrentEnd":a=new FlowDesigner.ConcurrentEndStep();break;default:a=new FlowDesigner.Step();this.consoleLog("Step.Message.Error.AbnormalType".loc())}var d=this.getCanvasWrapOffset();a.setCenter(-100,-100);a.getTarget().addClass("activeStep");var b=FlowDesigner.getRandomId();a.setStepId(b);FlowDesigner.settings.activeStep=a;this.resetCurSel()},btnDelClickHandler:function(){this.clearToolTip();var b=FlowDesigner.settings.curSel;if(b instanceof FlowDesigner.Step){if(b instanceof FlowDesigner.StartStep||b instanceof FlowDesigner.EndStep){var e=new FlowDesigner.ToolTip({msg:"Step.Message.Delete.Fail.StartAndEnd".loc()});return}var f=[];$(FlowDesigner.settings.lines).each(function(h,j){var g=false;if(j.getFromStep()==b){g=true}else{if(j.getToStep()==b){g=true}}if(g){f.push(j)}});$(f).each(function(g,h){h.remove()});var a=FlowDesigner.settings.steps;for(var d=0;d<a.length;d++){if(a[d].getDealType()=="specifyStepUser"||a[d].getDealType()=="specifyStepRole"){if(a[d].getRelatedStepId()==b.getStepId()){a[d].propData.relatedStepId=""}}}b.remove();b=null;FlowDesigner.settings.curSel=null;FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;this.openPropForm(true,false);this.updateStepAndLineDataToContent()}else{if(b instanceof FlowDesigner.Line){b.remove();b=null;FlowDesigner.settings.curSel=null;this.openPropForm(true,false);this.updateStepAndLineDataToContent()}else{new FlowDesigner.ToolTip({msg:"Step.InValid.Delete.Fail.NoObject".loc()});return}}FlowDesigner.settings.curFlowDesigner.propChangeHandler()},btnLinkClickHandler:function(){if(FlowDesigner.settings.steps.length<1){new FlowDesigner.ToolTip({msg:"Step.InValid.NeedAddOneStep".loc()});return}FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.preparingLink;FlowDesigner.settings.canvas.addClass("cursorForPrepareLink")},updateStepAndLineDataToContent:function(){var f=FlowDesigner.settings.steps;var g=this.getStepDatasBySteps(f);var k=FlowDesigner.settings.lines;var l=this.getLineDatasByLines(k);var a=[];for(var e=0;e<g.length;e++){var b=[];for(var d=0;d<l.length;d++){if(g[e].id==l[d].from_step){delete l[d].from_step;b.push(l[d])}}g[e].lines=b;a.push(g[e])}var h=FlowDesigner.FlowController.get("current");h.set("steps",a);h.normalize();this.valiFlow()},btnsMouseupHandler:function(a){if(FlowDesigner.settings.eventState!=FlowDesigner.settings.eventStates.none&&FlowDesigner.settings.eventState!=FlowDesigner.settings.eventStates.addingStep){this.canvasMouseupHandler(a)}},stepMousedownHandler:function(h){this.clearToolTip();if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){$(h.target).setAsCurStep();this.valiCurStep();var f=FlowDesigner.settings.curSel;var g=f.getOffset();FlowDesigner.settings.offsetPartForMove.x=h.pageX-g.left;FlowDesigner.settings.offsetPartForMove.y=h.pageY-g.top;FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.preparingMoveStep;var d=FlowDesigner.settings.linesFromStepForMove;var b=FlowDesigner.settings.linesToStepForMove;d.length=0;b.length=0;$(FlowDesigner.settings.lines).each(function(e,j){if(j.getFromStep()==f){d.push(j)}else{if(j.getToStep()==f){b.push(j)}}})}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingDeleteStep){$(h.target).setAsCurStep()}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingLink){$(h.target).setAsCurStep();this.openPropForm(false,false);var f=FlowDesigner.settings.curSel;FlowDesigner.settings.canvas.removeClass("cursorForPrepareLink");if(f instanceof FlowDesigner.EndStep){new FlowDesigner.ToolTip({msg:"Step.InValid.NotLinkToEndStep".loc()});FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;return}FlowDesigner.settings.canvas.addClass("cursorForLink");var a=new FlowDesigner.Line({fromStep:f});a.setIsDraging(true);FlowDesigner.settings.activeLine=a;FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.preparingMoveLink}}}},stepMouseupHandler:function(a){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingLink||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveLink){if(SC.browser.isAndroid||SC.browser.isiOS){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;return false}FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.linkingLine;return false}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.linkingLine){this.addLineToStep($(a.target));return false}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.moveLinkingLine){this.addLineToStep($(a.target));return false}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.movingLine){this.moveLineToStep($(a.target));return false}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveStep){this.openPropForm(false,false)}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.movingStep){this.openPropForm(false,false);$(FlowDesigner.settings.lines).each(function(b,d){d.highLightOver(false)})}}}}}}},stepMousemoveHandler:function(a){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveStep){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.movingStep}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveLink){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.moveLinkingLine}}},stepMouseoverHandler:function(d){var a=$(d.target).getStep();if(a instanceof FlowDesigner.Step){a.highLightOver(true)}if(!this.getIsEditable()){return}if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){$(d.target).addClass("cursorForMove")}if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.linkingLine||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.moveLinkingLine){var b=FlowDesigner.settings.activeLine.getFromStep();FlowDesigner.settings.activeLineFromEqualTo=(b==a)}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.movingLine){var b=FlowDesigner.settings.movingLine.getFromStep();FlowDesigner.settings.activeLineFromEqualTo=(b==a)}}},stepMouseoutHandler:function(b){var a=$(b.target).getStep();if(a instanceof FlowDesigner.Step){a.highLightOver(false)}if(!this.getIsEditable()){return}if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){$(b.target).removeClass("cursorForMove")}FlowDesigner.settings.activeLineFromEqualTo=false},stepDblclickHandler:function(b){var a=FlowDesigner.settings.curPropForm;if(a instanceof FlowDesigner.PropForm){a.show()}return false},valiCurStep:function(d){var b=d?d:FlowDesigner.settings.curSel;var a=b.valiAndGetErrMsg();if(a==""){if(FlowDesigner.settings.toolTip){FlowDesigner.settings.toolTip.remove();FlowDesigner.settings.toolTip=null}}else{new FlowDesigner.ToolTip({msg:a,showTime:0})}},clearToolTip:function(){if(FlowDesigner.settings.toolTip){FlowDesigner.settings.toolTip.remove();FlowDesigner.settings.toolTip=null}},propChangeHandler:function(f){var d=FlowDesigner.settings.curPropForm;if(!(d instanceof FlowDesigner.PropForm)){return}var a=FlowDesigner.settings.curSel;if(a==null){return}var b=FlowDesigner.settings.curPropForm.getData();a.setPropData(b);if(a instanceof FlowDesigner.Step){a.setAutoText();a.valiAndGetErrMsg();this.updateStepAndLineDataToContent()}else{if(a instanceof FlowDesigner.Line){a.setAutoText();this.updateStepAndLineDataToContent()}}},scriptChangeHandler:function(f){var b=FlowDesigner.settings.curSel;var a=b.getFlowStepScript();var d=$(f.target);a[d.attr("name")]=d.val();b.valiAndGetErrMsg()},logicTypeChangeHandler:function(d){var b=$(d.target);var a=FlowDesigner.settings.curSel;a.setLogicType(b.val());a.valiAndGetErrMsg()},managerChangeHandler:function(d){var b=FlowDesigner.settings.curFlowDesigner;var a=b.getManager().managerId;if(typeof a!="number"){a=0}new pickObject({type:"user",title:"Step.Message.SelectAdmin".loc(),value:a,callBack:function(e){if(e.length>0){var g=e[0].id;var f=e[0].name;b.setManager({managerId:parseInt(g),name:f});$(d.target).prev("span").html(f)}else{b.setManager({});$(d.target).prev("span").html("")}}}).show()},lineMouseoverHandler:function(b){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){var a=$(b.target).getLine();a.highLightOver(true);a.setZIndex(FlowDesigner.settings.lineZIndex+3);if(!this.getIsEditable()){return}if($(b.target).hasClass("path")){$(b.target).addClass("cursorForMove")}}},lineMouseoutHandler:function(b){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveLine){var a=$(b.target).getLine();a.highLightOver(false);if(a==FlowDesigner.settings.curSel){}else{a.setZIndex(FlowDesigner.settings.lineZIndex)}if(!this.getIsEditable()){return}$(b.target).removeClass("cursorForMove")}},lineMousedownHandler:function(a){this.clearToolTip();if(!this.getIsEditable()){$(a.target).setAsCurLine();this.openPropForm(false,false);return}if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){$(a.target).setAsCurLine();FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.preparingMoveLine}},lineMouseupHandler:function(a){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveLine){this.openPropForm(false,false)}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.movingLine){this.openPropForm(false,false)}}},lineMousemoveHandler:function(a){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveLine){FlowDesigner.settings.movingLine=FlowDesigner.settings.curSel;FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.movingLine;FlowDesigner.settings.canvas.addClass("cursorForLink");FlowDesigner.settings.movingLine.setIsDraging(true)}},lineDblclickHandler:function(b){var a=FlowDesigner.settings.curPropForm;if(a instanceof FlowDesigner.PropForm){a.show()}return false},canvasMousemoveHandler:function(j){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.movingStep){var h=FlowDesigner.settings.curSel;if(h instanceof FlowDesigner.Step){var d=h.getOffset();var b=j.pageX-FlowDesigner.settings.offsetPartForMove.x,o=j.pageY-FlowDesigner.settings.offsetPartForMove.y;var g=h.valiNewOffset(b,o);if(!g.isValid){b=g.newLeft;o=g.newTop}h.setOffset(b,o);var m=FlowDesigner.settings.linesFromStepForMove;var p=FlowDesigner.settings.linesToStepForMove;var l=h.getCenter();$(m).each(function(e,q){q.setStartPoint(l.left,l.top);q.draw();q.highLightOver(true)});$(p).each(function(e,q){q.setEndPoint(l.left,l.top);q.draw();q.highLightOver(true)});setTimeout(function(){FlowDesigner.settings.curFlowDesigner.propChangeHandler()},500)}}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.linkingLine||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.moveLinkingLine){var a=FlowDesigner.settings.activeLine;var f=this.getCanvasWrapOffset();a.setEndPoint(j.pageX+this.getCanvasWrapScrollLeft()-f.left,j.pageY+this.getCanvasWrapScrollTop()-f.top);a.draw();a.highLight(true)}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingDeleteStep||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingDeleteLine){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.movingLine){var a=FlowDesigner.settings.movingLine;a.setFromEqualTo(false);var f=this.getCanvasWrapOffset();a.setEndPoint(j.pageX+this.getCanvasWrapScrollLeft()-f.left,j.pageY+this.getCanvasWrapScrollTop()-f.top);a.draw();a.highLight(true)}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingAddStep||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.addingStep){this.clearToolTip();FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.addingStep;var k=FlowDesigner.settings.activeStep,b=j.pageX,o=j.pageY;var n=k.valiNewCenter(b,o);if(!n.isValid){b=n.newLeft;o=n.newTop}FlowDesigner.settings.activeStep.setCenter(b,o)}}}}}},canvasClickHandler:function(a){this.setCanvasFocus()},canvasDblclickHandler:function(b){var a=FlowDesigner.settings.curPropForm;if(a instanceof FlowDesigner.PropForm){a.showBtnsView()}},canvasMouseupHandler:function(e){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingLink){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;FlowDesigner.settings.canvas.removeClass("cursorForPrepareLink")}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.movingStep||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveStep){FlowDesigner.settings.offsetPartForMove.x=0;FlowDesigner.settings.offsetPartForMove.y=0;FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;return false}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.moveLinkingLine||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.linkingLine){if(FlowDesigner.settings.activeLine instanceof FlowDesigner.Line){FlowDesigner.settings.activeLine.setIsDraging(false);FlowDesigner.settings.activeLine.remove();FlowDesigner.settings.activeLine=null;FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;FlowDesigner.settings.canvas.removeClass("cursorForLink")}}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.movingLine){this.recoverMovingLine()}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveLine){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.addingStep){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;FlowDesigner.settings.canvas.removeClass("cursorForAdd");var d=FlowDesigner.settings.activeStep;var a=d.getTarget();a.removeClass("activeStep");d.highLight(true);FlowDesigner.settings.steps.push(d);FlowDesigner.settings.curSel=d;this.valiCurStep();this.openPropForm(true,false);FlowDesigner.settings.activeStep=null;this.updateStepAndLineDataToContent()}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingDeleteStep||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingDeleteLine){FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){var b=$(e.target).closest(".canvasWrap").length;if(!b){return}if(e!="delete"&&FlowDesigner.settings.needResetCurSel){this.openPropForm(false,false)}FlowDesigner.settings.needResetCurSel=true}}}}}}}}},canvasKeydownHandler:function(g){if(g.keyCode==8){if(!this.getIsEditable()){return}this.btnDelClickHandler()}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){switch(g.keyCode){case 37:var b=this.getPrevStepForSel();if(b){b.sel();this.openPropForm()}break;case 38:var f=this.getPrevLineForSel();if(f){f.sel();this.openPropForm()}break;case 39:var a=this.getNextStepForSel();if(a){a.sel();this.openPropForm()}break;case 40:var d=this.getNextLineForSel();if(d){d.sel();this.openPropForm()}break}}}},setCanvasFocus:function(){FlowDesigner.settings.canvas.attr("tabindex",0);FlowDesigner.settings.canvas.focus()},getPrevStepForSel:function(f){var b=f?f:FlowDesigner.settings.curSel,a=FlowDesigner.settings.steps;if(a<2){return null}if(b instanceof FlowDesigner.Line){return b.fromStep}var e=a.indexOf(b),d=e-1,d=d<0?a.length-1:d;return a[d]},getNextStepForSel:function(f){var d=f?f:FlowDesigner.settings.curSel,b=FlowDesigner.settings.steps;if(b<2){return null}if(d instanceof FlowDesigner.Line){return d.toStep}var e=b.indexOf(d),a=e+1,a=a>b.length-1?0:a;return b[a]},getPrevLineForSel:function(h){var e=h?h:FlowDesigner.settings.curSel,b=FlowDesigner.settings.lines;if(b<2){return null}if(e instanceof FlowDesigner.Step){var d=e.getPrevLines();if(d.length>0){return d[d.length-1]}else{var a=this.getPrevStepForSel(e);if(a){return this.getPrevLineForSel(a)}else{return b[b.length-1]}}}var g=b.indexOf(e),f=g-1,f=f<0?b.length-1:f;return b[f]},getNextLineForSel:function(g){var e=g?g:FlowDesigner.settings.curSel,d=FlowDesigner.settings.lines;if(d<2){return null}if(e instanceof FlowDesigner.Step){var h=e.getNextLines();if(h.length>0){return h[0]}else{var b=this.getNextStepForSel(e);if(b){return this.getNextLineForSel(b)}else{return d[0]}}}var f=d.indexOf(e),a=f+1,a=a>d.length-1?0:a;return d[a]},bodyKeydownHandler:function(b){if(b.keyCode==8){var a=b.target.tagName.toLowerCase();if(a!="textarea"){if(a=="input"){if(b.target.type!="text"){return false}}else{return false}}}else{if(b.keyCode==27){if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingAddStep||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.addingStep){if(FlowDesigner.settings.activeStep instanceof FlowDesigner.Step){FlowDesigner.settings.activeStep.remove();FlowDesigner.settings.activeStep=null;FlowDesigner.settings.canvas.removeClass("cursorForAdd");FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none}}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveLine||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.movingLine){this.recoverMovingLine()}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingLink||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.linkingLine||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.preparingMoveLink||FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.moveLinkingLine){if(FlowDesigner.settings.activeLine instanceof FlowDesigner.Line){FlowDesigner.settings.activeLine.remove();FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;FlowDesigner.settings.canvas.removeClass("cursorForLink");FlowDesigner.settings.needResetCurSel=false;FlowDesigner.settings.activeLine=null}}else{if(FlowDesigner.settings.eventState==FlowDesigner.settings.eventStates.none){if(FlowDesigner.settings.curSel instanceof FlowDesigner.Spirit){this.clearToolTip();this.resetCurSel();this.openPropForm(false,false)}}}}}}}},recoverMovingLine:function(){var a=FlowDesigner.settings.movingLine;var d=a.getFromStep();var b=a.getToStep();a.setFromEqualTo(d==b);a.setIsDraging(false);var e=b.getCenter();a.setEndPoint(e.left,e.top);a.draw();FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;FlowDesigner.settings.canvas.removeClass("cursorForLink");FlowDesigner.settings.needResetCurSel=false;a.highLight(true);a.highLightOver(false);FlowDesigner.settings.movingLine=null;a=null;this.openPropForm()},deleteMovingLine:function(){FlowDesigner.settings.movingLine.remove();FlowDesigner.settings.movingLine=null;FlowDesigner.settings.eventState=FlowDesigner.settings.eventStates.none;FlowDesigner.settings.canvas.removeClass("cursorForLink");this.resetCurSel();this.openPropForm(false,false);this.updateStepAndLineDataToContent()},trim:function(a){return a.replace(/(^\s*)|(\s*$)/g,"")},lTrim:function(a){return a.replace(/(^\s*)/g,"")},rTrim:function(a){return a.replace(/(\s*$)/g,"")},unload:function(){this.container.unbind();FlowDesigner.settings.body.unbind("mouseup",this.canvasMouseupHandler);FlowDesigner.settings.body.unbind("keydown",this.bodyKeydownHandler);FlowDesigner.settings.canvas.unbind("keydown",this.canvasKeydownHandler);this.container.find(".flowCanvas").empty();FlowDesigner.settings=null},getStepData:function(a){if(!SC.none(a)){if(a.step_type=="start"||(a.step_type=="end")){var b={stepId:a.id,stepName:a.name,stepType:a.step_type,dealType:a.deal_type,stepDesc:a.description,posx:a.posx,posy:a.posy,lines:a.lines,relatedUsers:a.approver_users,relatedGroups:a.approver_orgs,approverUserField:a.approver_user_field,approverOrgField:a.approver_org_field,relatedStepId:a.approver_step,relatedRole:a.approver_roles,helpText:a.help_text,permissions:a.permissions};if(a.step_type=="start"){b.can_edit_main_attach=a.can_edit_main_attach;b.can_edit_normal_attach=a.can_edit_normal_attach}}else{var b={stepId:a.id,stepName:a.name,stepType:a.step_type,dealType:a.deal_type,stepDesc:a.description,posx:a.posx,posy:a.posy,lines:a.lines,relatedUsers:a.approver_users,relatedGroups:a.approver_orgs,approverUserField:a.approver_user_field,approverOrgField:a.approver_org_field,hours:a.timeout_hours,relatedStepId:a.approver_step,relatedRole:a.approver_roles,helpText:a.help_text,permissions:a.permissions,disableCC:a.disableCC,allowDistribute:a.allowDistribute,can_edit_main_attach:a.can_edit_main_attach,can_edit_normal_attach:a.can_edit_normal_attach,distribute_optional_flows:a.distribute_optional_flows,cc_must_finished:a.cc_must_finished,cc_alert:a.cc_alert,allowBatch:a.allowBatch,oneClickApproval:a.oneClickApproval,oneClickRejection:a.oneClickRejection,allow_pick_approve_users:a.allow_pick_approve_users,cc_has_edit_permission:a.cc_has_edit_permission}}return b}},getLineData:function(a,d){if(!SC.none(d)){var b={lineId:d.id,lineName:d.name,state:d.state,condition:d.condition,fromStepId:a,toStepId:d.to_step,lineDescription:d.description,lineTimeoutLine:d.timeout_line};return b}}});sc_require("mixins/BasicClass");sc_require("mixins/FlowDesigner_ToolTip");sc_require("mixins/FlowDesigner_Spirit");sc_require("mixins/FlowDesigner_Step");FlowDesigner.EndStep=new BasicClass({extend:FlowDesigner.Step,_init:function(a){this.propData={stepId:"-1",stepName:"unTitled",stepType:FlowDesigner.settings.stepTypes.end,dealType:"",stepDesc:"",posx:-1,posy:-1,decisionType:"",overCounterSignType:"",relatedRoleId:"",relatedUsers:[],relatedGroups:[],relatedStepId:"",logicType:"and",isOpenUserSelect:false,isAttachmentEditable:true,isFileRetrievable:false,isAutoSendMobileMsg:false,approverUserField:"",approverOrgField:"",flowStepScript:{beforeStepScript:"",insideScript:"",afterStepScript:""},permissions:{},modified:0};this.fromSteps=[];this.toSteps=[];var b=$('<div class = "step endStep">				<div class = "stepTip"></div>				<div class = "stepText"></div>			</div>');FlowDesigner.settings.canvas.append(b);this.target=b;this.propData.stepName=this.typeName;this.setAutoText();this.valiAndGetErrMsg()},typeName:"Step.End".loc(),valiAndGetErrMsg:function(){var a="";a=this.valiStepLineCountAndGetErrMsg();if(a==""){var b=this.getStepName();if(FlowDesigner.settings.curFlowDesigner.trim(b).length==0){a="Step.Name.NotEmpty".loc()}}if(a==""){this.removeWarningIcon()}else{this.addWarningIcon()}return a},consoleLog:function(a){if(typeof console=="object"){console.log("EndStep:"+a)}}});SC.mixin(FlowDesigner,{options:{dealTypes:[{title:"Step.Message.SelectDealType".loc(),value:"",instruction:""},{title:"Step.PickupAtRuntime".loc(),value:"pickupAtRuntime",instruction:""},{title:"Step.RelatedUsers".loc(),value:"specifyUser",instruction:"Step.SpecifyUser.Instruction".loc()},{title:"Step.ApplicantRole".loc(),value:"applicantRole",instruction:"Step.ApplicantRole.Instruction".loc()},{title:"Step.ApplicantSuperior".loc(),value:"applicantSuperior",instruction:""},{title:"Step.Applicant".loc(),value:"applicant",instruction:"Step.Applicant.Instruction".loc()},{title:"Step.RelatedUserField".loc(),value:"userField",instruction:"Step.UserField.Instruction".loc()},{title:"Step.RelatedGroupField".loc(),value:"orgField",instruction:"Step.OrgField.Instruction".loc()},{title:"Step.RelatedGroups".loc(),value:"specifyOrg",instruction:"Step.SpecifyOrg.Instruction".loc()},{title:"Step.UserFieldRole".loc(),value:"userFieldRole",instruction:"Step.UserFieldRole.Instruction".loc()},{title:"Step.OrgFieldRole".loc(),value:"orgFieldRole",instruction:"Step.OrgFieldRole.Instruction".loc()},],decisionTypes:[{title:"Step.Message.SelectDecisionType".loc(),value:""},{title:"Step.DecisionType.All".loc(),value:"all"},{title:"Step.DecisionType.AnyApprove".loc(),value:"anyApprove"},{title:"Step.DecisionType.AnyReject".loc(),value:"anyReject"},{title:"Step.DecisionType.FirstApprove".loc(),value:"firstApprove"}],overCounterSignTypes:[{title:"Step.Message.SelectOverCounterSignType".loc(),value:""},{title:"Step.OverCounterSignType.WaitForAll".loc(),value:"waitForAll"},{title:"Step.OverCounterSignType.AnyFit".loc(),value:"anyFit"}],countersignMethods:[{title:"Step.Message.SelectCounterSignType".loc(),value:""},{title:"Step.CounterSignType.OrdrCounter".loc(),value:"ordrcounter"},{title:"Step.CounterSignType.SameCounter".loc(),value:"samecounter"}]},settings:null,getDefaultSettings:function(){return{curFlowDesigner:null,body:$("body"),canvasWrap:null,canvas:null,canvasSize:{width:0,height:0},flowPropView:null,designerView:null,flowCanvasView:null,eventState:0,offsetPartForMove:{x:0,y:0},linesFromStepForMove:[],linesToStepForMove:[],steps:[],lines:[],activeStep:null,activeLine:null,activeLineFromEqualTo:false,curSel:null,willLinkToStep:null,curPropForm:null,lineZIndex:20,movingLine:null,lastLineId:0,stepTypes:{start:"start",end:"end",condition:"condition",archive:"archive",counterSign:"counterSign",sign:"sign",submit:"submit",notify:"notify",concurrentStart:"concurrentStart",concurrentEnd:"concurrentEnd"},eventStates:{none:0,preparingAddStep:1,addingStep:2,preparingMoveStep:3,movingStep:4,preparingLink:5,linkingLine:6,preparingMoveLink:7,moveLinkingLine:8,preparingMoveLine:9,movingLine:10,preparingDeleteStep:11,preparingDeleteLine:12},bindingDataInPropForm:NO,needResetCurSel:true,toolTip:null,needUpdateWhenStart:NO}},btnsAction:function(b){var a=FlowDesigner.settings.curFlowDesigner;if(a instanceof FlowDesigner.Designer){a.btnsMouseupHandler(b);if(b=="cancel"){}else{if(b=="link"){a.btnLinkClickHandler(b)}else{if(b=="delete"){a.btnDelClickHandler(b)}else{a.btnStepClickHandler(b)}}}}},getRandomId:function(){var e,g="89ab",f=[];for(e=0;e<36;e+=1){f[e]=(Math.random()*16|0).toString(16)}f[8]=f[13]=f[18]=f[23]="-";f[14]="4";f[19]=g.charAt(Math.random()*4|0);return f.join("")},unload:function(){var a=FlowDesigner.settings?FlowDesigner.settings.curFlowDesigner:undefined;if(a instanceof FlowDesigner.Designer){a.unload()}}});$.fn.getStep=function(){var a=null;var b=$(this);if(!b.hasClass("step")){b=b.parent()}$(FlowDesigner.settings.steps).each(function(d,e){if(e.target.get(0)==b.get(0)){a=e;return false}});return a};$.fn.setAsCurStep=function(){if(FlowDesigner.settings.curSel instanceof FlowDesigner.Spirit){FlowDesigner.settings.curSel.highLight(false)}var b=$(this);if(!b.hasClass("step")){b=b.parent()}var a=b.getStep();if(a instanceof FlowDesigner.Step){a.sel()}};$.fn.getLine=function(b){var d=null;var a=$(this);switch(b){case"delIcon":$(FlowDesigner.settings.lines).each(function(e,f){if(f.getDelIconTarget()[0]==a[0]){d=f;return false}});break;case"text":$(FlowDesigner.settings.lines).each(function(e,f){if(f.getTextTarget()[0]==a[0]){d=f;return false}});break;default:if(!a.hasClass("path")){a=a.parent()}$(FlowDesigner.settings.lines).each(function(e,f){if(f.hasPath(a)){d=f;return false}});break}return d};$.fn.setAsCurLine=function(d){if(FlowDesigner.settings.curSel instanceof FlowDesigner.Spirit){FlowDesigner.settings.curSel.highLight(false);if(FlowDesigner.settings.curSel instanceof FlowDesigner.Line){FlowDesigner.settings.curSel.setZIndex(FlowDesigner.settings.lineZIndex)}}var b=$(this);var a=b.getLine(d);if(a instanceof FlowDesigner.Line){a.sel()}};$.fn.setTransform=function(a){if(a instanceof Object&&typeof a.rotate=="number"&&typeof a.translate=="number"){$(this).css("transform","rotate("+a.rotate+"deg) translate("+a.translate+"px)");$(this).css("-webkit-transform","rotate("+a.rotate+"deg) translate("+a.translate+"px)");$(this).css("-moz-transform","rotate("+a.rotate+"deg) translate("+a.translate+"px)");$(this).css("-o-transform","rotate("+a.rotate+"deg) translate("+a.translate+"px)");$(this).css("-ms-transform","rotate("+a.rotate+"deg) translate("+a.translate+"px)")}};FlowDesigner.FlowCanvasView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["canvas-scroll-view","canvasWrap","whiterBack"],horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend({layout:{left:0,top:0,right:0,bottom:0,width:2000,height:2000},contentBinding:SC.Binding.oneWay("FlowDesigner.FlowController.content"),modifiedBinding:SC.Binding.oneWay("FlowDesigner.FlowController*current.modified"),displayProperties:["content","modified"],render:function(b){var a='<div class = "flowCanvas"></div>';b.push(a)},update:function(a){FlowDesigner.unload();var d=null;var b=this.get("content");if(SC.none(b)){return}if(b.get("firstObject")){var e=this.getPath("parentView.parentView.parentView");d=b.get("firstObject").attributes();this.invokeLast(function(){var f=FlowDesigner.FlowController.get("isEditable");new FlowDesigner.Designer({container:$(".canvasWrap"),data:d,designerView:e,isEditable:f})})}},contentDidChange:function(){var d=null;var b=this.get("content");var a=FlowDesigner.settings?FlowDesigner.settings.curFlowDesigner:null;if(b&&a instanceof FlowDesigner.Designer){if(d=b.get("firstObject")){d=d.attributes();a.reloadData(d)}}}.observes("FlowDesigner.FlowController.steps")})});FlowDesigner.FlowPropertyView=SC.View.extend({classNames:"flow_property_back",childViews:["flowTabView"],contentBinding:"FlowDesigner.FlowController",flowTabView:SC.TabView.extend({controlSize:SC.LARGE_CONTROL_SIZE,itemIsEnabledKey:"isEnabled",itemTitleKey:"title",itemValueKey:"value",classNames:"flowtabView",nowShowing:"FlowDesigner.FlowPropFlowView",displayDidChange:function(){if(this.nowShowing=="FlowDesigner.FlowPropStepAndLineView"){if(!FlowDesigner.settings){return}var a=FlowDesigner.settings.curPropForm;if(a instanceof FlowDesigner.PropForm){}else{a=new FlowDesigner.PropForm({bindSpirit:null})}setTimeout(function(){a.show()},10)}},layout:{top:10,bottom:10,left:10,right:10},isEditableBinding:SC.Binding.oneWay("FlowDesigner.FlowController.isEditable"),stepAndLineContentBinding:SC.Binding.oneWay("FlowDesigner.FlowStepAndLineController.content"),items:function(){var b=[{title:"Button.FlowInfo".loc(),isEnabled:YES,value:"FlowDesigner.FlowPropFlowView"},{title:"Button.Draw".loc(),isEnabled:YES,value:"FlowDesigner.FlowPropBtnsView"},{title:"Button.Property".loc(),isEnabled:YES,value:"FlowDesigner.FlowPropStepAndLineView"},{title:"Button.Permissions".loc(),isEnabled:YES,value:"FlowDesigner.FlowPropPermissionsView"}];var a=this.get("isEditable"),d=this.getPath("stepAndLineContent.stepId");if(a){if(!d){if(this.get("nowShowing")=="FlowDesigner.FlowPropPermissionsView"){this.set("nowShowing","FlowDesigner.FlowPropStepAndLineView")}this.invokeLast(function(){b.removeAt(3)})}return b}else{b.removeAt(1);if(!d){if(this.get("nowShowing")=="FlowDesigner.FlowPropPermissionsView"){this.set("nowShowing","FlowDesigner.FlowPropStepAndLineView")}this.invokeLast(function(){b.removeAt(2)})}return b}}.property("isEditable","stepAndLineContent").cacheable()})});sc_require("views/flow_property");sc_require("views/flow_canvas");FlowDesigner.DesignerView=SC.View.extend({isEditable:YES,errorMessage:"",render:function(a,b){SC.debug("FlowDesigner.DesignerView.render");arguments.callee.base.apply(this,arguments);if(!b){return}this.invokeLast(function(){FlowDesigner.FlowController.set("isEditable",this.get("isEditable"));FlowDesigner.flowValidController.bind("errorMessage",this,"errorMessage");FlowDesigner.FlowController.set("content",this.getPath("content.content"));var d=this.get("rolesControllerDelegate");if(d){FlowDesigner.FlowRolesController.set("content",d.get("content"));FlowDesigner.FlowRolesController.set("allowsMultipleSelection",false);FlowDesigner.FlowRolesController.set("spaceId",d.get("spaceId"))}FlowDesigner.companyId=this.get("companyId")})},rolesControllerDelegate:FlowDesigner.FlowRolesController,layout:{top:0,bottom:0,left:0,right:0},childViews:["flowCanvasView","flowPropertyView"],classNames:["flowdesigner"],classNameBindings:["readonly"],readonly:function(){return this.get("isEditable")?"":"readonly"}.property("isEditable"),flowCanvasView:FlowDesigner.FlowCanvasView.design({layout:{top:0,bottom:0,left:0,right:361}}),flowPropertyView:FlowDesigner.FlowPropertyView.design({layout:{top:0,bottom:0,width:360,right:0}})});FlowDesigner.FlowPropBtnsView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend(SC.FlowedLayout,{classNames:["flow-prop-btns-view"],layout:{top:20},childViews:["topLine","signButton","counterSignButton","submitButton","conditionButton","bottomLine"],topLine:SC.View.extend({classNames:"step_button_top",layout:{height:2},}),signButton:SC.View.extend(FlowDesigner.DragAppendButtonDelegate,{classNames:"step_button",layout:{height:SC.buildLocale=="zh-cn"?70:110},childViews:["btnView","btnName","infoView"],btnView:SC.ButtonView.extend(FlowDesigner.DragAppendButtonDelegate,{layout:{left:15,top:SC.buildLocale=="zh-cn"?15:30,width:32,height:32},controlSize:SC.HUGE_CONTROL_SIZE,classNames:"flowBtn button_sign",eventTag:"sign",}),eventTag:"sign",btnName:SC.LabelView.extend({classNames:"remaind_step_name",layout:{top:SC.buildLocale=="zh-cn"?10:15,height:20,left:60,right:0},value:"Step.Sign".loc()}),infoView:SC.LabelView.extend({escapeHTML:NO,classNames:"remaind_step",layout:{top:SC.buildLocale=="zh-cn"?33:38,bottom:0,left:60,right:0},value:"Step.Sign.Info".loc()})}),counterSignButton:SC.View.extend(FlowDesigner.DragAppendButtonDelegate,{classNames:"step_button",layout:{height:SC.buildLocale=="zh-cn"?70:95},childViews:["btnView","btnName","infoView"],btnView:SC.ButtonView.extend(FlowDesigner.DragAppendButtonDelegate,{layout:{left:15,top:SC.buildLocale=="zh-cn"?15:30,width:32,height:32},controlSize:SC.HUGE_CONTROL_SIZE,classNames:"flowBtn button_counterSign",eventTag:"counterSign"}),eventTag:"counterSign",btnName:SC.LabelView.extend({classNames:"remaind_step_name",layout:{top:SC.buildLocale=="zh-cn"?10:15,height:20,left:60,right:0},value:"Step.CounterSign".loc()}),infoView:SC.LabelView.extend({escapeHTML:NO,classNames:"remaind_step",layout:{top:SC.buildLocale=="zh-cn"?33:38,bottom:0,left:60,right:0},value:"Step.CounterSign.Info".loc()}),}),submitButton:SC.View.extend(FlowDesigner.DragAppendButtonDelegate,{classNames:"step_button",layout:{height:SC.buildLocale=="zh-cn"?70:90},childViews:["btnView","btnName","infoView"],eventTag:"submit",btnView:SC.ButtonView.extend(FlowDesigner.DragAppendButtonDelegate,{layout:{left:15,top:SC.buildLocale=="zh-cn"?15:30,width:32,height:32},controlSize:SC.HUGE_CONTROL_SIZE,classNames:"flowBtn button_submit",eventTag:"submit",}),btnName:SC.LabelView.extend({classNames:"remaind_step_name",layout:{top:SC.buildLocale=="zh-cn"?10:15,height:20,left:60,right:0},value:"Step.Submit".loc()}),infoView:SC.LabelView.extend({escapeHTML:NO,classNames:"remaind_step",layout:{top:SC.buildLocale=="zh-cn"?33:38,bottom:0,left:60,right:0},value:"Step.Submit.Info".loc()})}),notifyButton:SC.View.extend({classNames:"step_button_disabled",layout:{height:SC.buildLocale=="zh-cn"?60:90},childViews:["btnView","btnName","infoView"],btnView:SC.ButtonView.extend({layout:{left:15,top:SC.buildLocale=="zh-cn"?15:30,width:32,height:32},controlSize:SC.HUGE_CONTROL_SIZE,classNames:"flowBtn button_notify",isEnabled:NO,eventTag:"notify",}),btnName:SC.LabelView.extend({classNames:"remaind_step_name_disabled",layout:{top:10,height:20,left:60,right:0},value:"Step.Notify".loc()}),infoView:SC.LabelView.extend({escapeHTML:NO,classNames:"remaind_step_disabled",layout:{top:33,bottom:0,left:60,right:0},value:"Step.Notify.Info".loc()})}),concurrentStartButton:SC.View.extend({classNames:"step_button_disabled",layout:{height:SC.buildLocale=="zh-cn"?60:90},childViews:["btnView","btnName","infoView"],btnView:SC.ButtonView.extend({layout:{left:15,top:SC.buildLocale=="zh-cn"?15:30,width:32,height:32},controlSize:SC.HUGE_CONTROL_SIZE,classNames:"flowBtn button_concurrentStart",isEnabled:NO,eventTag:"concurrentStart"}),btnName:SC.LabelView.extend({classNames:"remaind_step_name_disabled",layout:{top:SC.buildLocale=="zh-cn"?10:15,height:20,left:60,right:0},value:"Step.ConcurrentStart".loc()}),infoView:SC.LabelView.extend({escapeHTML:NO,classNames:"remaind_step_disabled",layout:{top:SC.buildLocale=="zh-cn"?33:38,bottom:0,left:60,right:0},value:"Step.ConcurrentStart.Info".loc()})}),concurrentEndButton:SC.View.extend({classNames:"step_button_disabled",layout:{height:SC.buildLocale=="zh-cn"?60:90},childViews:["btnView","btnName","infoView"],btnView:SC.ButtonView.extend({layout:{left:15,top:SC.buildLocale=="zh-cn"?15:30,width:32,height:32},controlSize:SC.HUGE_CONTROL_SIZE,classNames:"flowBtn button_concurrentEnd",isEnabled:NO,eventTag:"concurrentEnd",}),btnName:SC.LabelView.extend({classNames:"remaind_step_name_disabled",layout:{top:SC.buildLocale=="zh-cn"?10:15,height:20,left:60,right:0},value:"Step.ConcurrentEnd".loc()}),infoView:SC.LabelView.extend({escapeHTML:NO,classNames:"remaind_step_disabled",layout:{top:SC.buildLocale=="zh-cn"?33:38,bottom:0,left:60,right:0},value:"Step.ConcurrentEnd.Info".loc()})}),conditionButton:SC.View.extend(FlowDesigner.DragAppendButtonDelegate,{classNames:"step_button",layout:{height:SC.buildLocale=="zh-cn"?70:90},childViews:["btnView","btnName","infoView"],eventTag:"condition",btnView:SC.ButtonView.extend(FlowDesigner.DragAppendButtonDelegate,{layout:{left:15,top:SC.buildLocale=="zh-cn"?15:30,width:32,height:32},controlSize:SC.HUGE_CONTROL_SIZE,classNames:"flowBtn button_condition",eventTag:"condition"}),btnName:SC.LabelView.extend({classNames:"remaind_step_name",layout:{top:SC.buildLocale=="zh-cn"?10:15,height:20,left:60,right:0},value:"Step.Condition".loc()}),infoView:SC.LabelView.extend({escapeHTML:NO,classNames:"remaind_step",layout:{top:SC.buildLocale=="zh-cn"?33:38,bottom:0,left:60,right:0},value:"Step.Condition.Info".loc()})}),deleteButton:SC.View.extend(FlowDesigner.DragAppendButtonDelegate,{classNames:"step_button_delete",layout:{height:SC.buildLocale=="zh-cn"?70:90},childViews:["btnView","btnName","infoView"],eventTag:"delete",btnView:SC.ButtonView.extend(FlowDesigner.DragAppendButtonDelegate,{layout:{left:15,top:SC.buildLocale=="zh-cn"?15:25,width:32,height:32},controlSize:SC.HUGE_CONTROL_SIZE,classNames:"flowBtn_delete button_delete",eventTag:"delete"}),btnName:SC.LabelView.extend({classNames:"remaind_step_name_delete",layout:{top:SC.buildLocale=="zh-cn"?10:15,height:20,left:60,right:0},value:"Step.Delete".loc()}),infoView:SC.LabelView.extend({escapeHTML:NO,classNames:"remaind_step_delete",layout:{top:SC.buildLocale=="zh-cn"?33:38,bottom:0,left:60,right:0},value:"Step.Delete.Info".loc()})}),bottomLine:SC.View.extend({classNames:"step_button_bottom",layout:{height:2},}),})});FlowDesigner.ConcurrentEndStepPropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend()});FlowDesigner.ConcurrentStartStepPropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend()});FlowDesigner.ConditionStepPropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend(SC.FlowedLayout,{layout:{left:0,top:20,right:0},classNames:["flow-form-label"],childViews:["topLine","stepName","stepTypeName","hours","lines","bottomLine","emptyView"],topLine:SC.View.extend({classNames:"step_button_top",layout:{height:2},}),stepName:SC.View.extend({classNames:"flow_step",layout:{height:74},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.Name".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.Name".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:34},valueBinding:"FlowDesigner.FlowStepAndLineController.stepName",hint:"Step.Enter.StepName".loc(),render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var d=this.get("value");if(SC.none(d)||""==d){this.$(".border").css("border-color","red")}else{this.$(".border").css("border-color","#bdbdbd")}})}})}),stepTypeName:SC.View.extend({classNames:"flow_step",layout:{height:30},childViews:["title"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:function(){return"Step.TypeName".loc(FlowDesigner.FlowStepAndLineController.get("stepTypeName"))}.property().cacheable()})}),hours:SC.View.extend({classNames:"flow_step",layout:{height:61},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Step.Hours".loc()}),value:CS.NumberView.extend({layout:{left:15,right:15,top:30,height:24},fieldValBinding:"FlowDesigner.FlowStepAndLineController.hours",digits:2,hint:"0",minValue:0})}),lines:SC.StackedView.extend({contentBinding:"FlowDesigner.FlowStepAndLineController.lines",exampleView:SC.View.extend({classNames:"flow_step",layout:{height:122},useStaticLayout:true,toStepIdBinding:SC.Binding.oneWay(".content.to_step"),toStepName:function(){var d="",a=this.get("toStepId");if(a){var b=Admin.flowController.getPath("current.steps").filterProperty("id",a).get("firstObject");if(b){d=b.get("name")}}return d}.property("toStepId").cacheable(),childViews:["toStepNameView","nameView","conditionView"],willSelLine:function(){var a=this.get("toStepId"),d=FlowDesigner.FlowStepAndLineController.get("stepId");curStep=FlowDesigner.settings.steps.filter(function(e){return d==e.getStepId()}).get("firstObject");var b=curStep.getNextLines().filter(function(e){return a==e.getToStepId()}).get("firstObject");return b}.property().cacheable(),syncAndValiFlow:function(){this.invokeLast(function(){var a=this.get("willSelLine");if(a){a.setLineName(this.getPath("content.name"));a.setAutoText();a.setCondition(this.getPath("content.condition"));FlowDesigner.settings.curFlowDesigner.valiFlow()}},this)},highLightLine:function(a){var b=this.get("willSelLine");if(b){b.highLight(a)}},toStepNameView:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},toStepNameBinding:".parentView.toStepName",value:function(){return"Line.ToStep".loc(this.getPath("parentView.toStepName"))}.property("toStepName").cacheable()}),nameView:SC.View.extend({layout:{height:30,top:25},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:256,top:5,height:20},value:"Line.Name".loc()}),value:SC.TextFieldView.extend({layout:{left:84,right:15,top:5,height:24},nameBinding:".parentView.parentView.content.name",value:function(b,a){var d=this.get("name");if(a!=undefined){this.set("name",a);var e=this.getPath("parentView.parentView");if(e){e.syncAndValiFlow()}}else{return d}}.property(".name").cacheable(),fieldDidFocus:function(){arguments.callee.base.apply(this,arguments);this.getPath("parentView.parentView").highLightLine(true)},fieldDidBlur:function(){arguments.callee.base.apply(this,arguments);this.getPath("parentView.parentView").highLightLine(false)}})}),conditionView:SC.View.extend({layout:{height:68,top:56},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Line.Condition".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Line.Condition".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:25,height:34},conditionBinding:".parentView.parentView.content.condition",value:function(b,a){var e=this.get("condition");if(a!=undefined){this.set("condition",a);var d=this.getPath("parentView.parentView");if(d){d.syncAndValiFlow()}if(FlowDesigner.settings.curSel instanceof FlowDesigner.Step){FlowDesigner.settings.curFlowDesigner.valiCurStep()}}else{return e}}.property(".condition").cacheable(),hint:"Line.Formula.Hint".loc(),render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var d=this.get("value");if(SC.none(d)||""==d){this.$(".border").css("border-color","red")}else{this.$(".border").css("border-color","#bdbdbd")}})},fieldDidFocus:function(){arguments.callee.base.apply(this,arguments);this.getPath("parentView.parentView").highLightLine(true)},fieldDidBlur:function(){arguments.callee.base.apply(this,arguments);this.getPath("parentView.parentView").highLightLine(false)}})}),})}),bottomLine:SC.View.extend({classNames:"step_button_bottom",layout:{height:2},}),emptyView:SC.View.extend({layout:{height:20}})})});FlowDesigner.CounterSignStepPropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend(SC.FlowedLayout,{layout:{left:0,top:20,right:0},classNames:["flow-form-label"],childViews:["topLine","stepName","stepTypeName","dealType","relatedStep","relatedRole","relatedUsers","relatedGroups","relatedUserField","relatedGroupField","hours","disableCC","allowDistribute","can_edit_main_attach","can_edit_normal_attach","cc_must_finished","cc_alert","allowBatch","oneClickApproval","oneClickRejection","allow_pick_approve_users","bottomLine","emptyView"],topLine:SC.View.extend({classNames:"step_button_top",layout:{height:2},}),stepName:SC.View.extend({classNames:"flow_step",layout:{height:74},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.Name".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.Name".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:34},valueBinding:"FlowDesigner.FlowStepAndLineController.stepName",hint:"Step.Enter.StepName".loc(),render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var d=this.get("value");if(SC.none(d)||""==d){this.$(".border").css("border-color","red")}else{this.$(".border").css("border-color","#bdbdbd")}})}})}),stepTypeName:SC.View.extend({classNames:"flow_step",layout:{height:30},childViews:["title"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:function(){return"Step.TypeName".loc(FlowDesigner.FlowStepAndLineController.get("stepTypeName"))}.property().cacheable()})}),dealType:SC.View.extend({classNames:"flow_step",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.DealType".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.DealType".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.LabelView.extend({classNames:["deal_type","dealType"],layout:{left:15,right:15,top:30,height:24},value:function(){var a=FlowDesigner.FlowStepAndLineController.get("dealType");var d=FlowDesigner.options.dealTypes;var b;d.forEach(function(e){if(e.value==a){b=e.title}});return b}.property().cacheable(),valueDidChange:function(){var a=FlowDesigner.FlowStepAndLineController.get("dealType");var d=FlowDesigner.options.dealTypes;var b;d.forEach(function(e){if(e.value==a){b=e.title}});this.set("value",b)}.observes("FlowDesigner.FlowStepAndLineController.dealType"),mouseDown:function(){FlowDesigner.FlowStepAndLineController.showDealType(this)},touchStart:function(){this.mouseDown()}})}),relatedStep:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedStepRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Step.RelatedStep".loc(),}),select:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},itemTitleKey:"title",itemValueKey:"value",itemsBinding:"FlowDesigner.FlowStepAndLineController.historySteps",valueBinding:"FlowDesigner.FlowStepAndLineController.relatedStepId"})}),relatedRole:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedRoleRowVisible",childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedRole".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedRole".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,isEditable:false,layout:{left:15,right:15,top:30,height:24},hint:"Step.RelatedRole.Hint".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.rolesNames",mouseDown:function(){FlowDesigner.FlowStepAndLineController.showRolesView(this)},touchStart:function(){this.mouseDown()}})}),relatedUsers:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedUsersRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedUsers.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedUsers.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:CS.UserSelectView.extend({layout:{left:15,right:15,top:30,height:24,minHeight:24},showSearchBox:true,classNames:["org_user_straight"],pickerTitle:"Step.RelatedUsers.Select.Title".loc(),canFilter:true,preferMatrix:[1,0,2,3,1],setValue:function(){var d=FlowDesigner.FlowStepAndLineController.get("relatedUsers");var e=[];if(d&&d.length>0){for(var b=0;b<d.length;b++){var a=CS.store.find(CS.User,d[b]);if(a){e.push(a)}}}this.set("value",e)}.observes("FlowDesigner.FlowStepAndLineController*content.stepId"),valueChange:function(){this.invokeLast(function(){if(this.parentView){this.parentView.adjust("height",this.frame().height+40)}});var b=this.get("value");var d=[];if(b&&b.length>0){for(var a=0;a<b.length;a++){d.push(b[a].get("id"))}}FlowDesigner.FlowStepAndLineController.set("relatedUsers",d)}.observes("value"),render:function(){arguments.callee.base.apply(this,arguments);var d=FlowDesigner.FlowStepAndLineController.get("relatedUsers");var e=[];if(d&&d.length>0){for(var b=0;b<d.length;b++){var a=CS.store.find(CS.User,d[b]);if(a){e.push(a)}}}this.set("value",e)},relatedUsersChanged:function(){var a=FlowDesigner.FlowStepAndLineController.get("relatedUsers");if(!a||a.length==0){this.userView.set("value","")}}.observes("FlowDesigner.FlowStepAndLineController.relatedUsers"),init:function(){this.set("spaceId",Admin.spaceController.get("id"));this.set("companyId",FlowDesigner.companyId);arguments.callee.base.apply(this,arguments)},useModel:true,})}),relatedGroups:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedGroupsRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedGroups.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedGroups.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:CS.OrganizationSelectView.extend({layout:{left:15,right:15,top:30,height:24,minHeight:24},classNames:["org_user_straight"],showFullName:true,pickerTitle:"Step.RelatedGroups.Select.Title".loc(),setValue:function(){var b=FlowDesigner.FlowStepAndLineController.get("relatedGroups");var a=[];if(b&&b.length>0){for(var d=0;d<b.length;d++){var e=CS.store.find(CS.Organization,b[d]);a.push(e)}}this.set("value",a)}.observes("FlowDesigner.FlowStepAndLineController*content.stepId"),valueChange:function(){this.invokeLast(function(){if(this.parentView){this.parentView.adjust("height",this.frame().height+40)}});var d=this.get("value");var a=[];if(d&&d.length>0){for(var b=0;b<d.length;b++){if(d[b]){a.push(d[b].get("id"))}}}FlowDesigner.FlowStepAndLineController.set("relatedGroups",a)}.observes("value"),render:function(){arguments.callee.base.apply(this,arguments);var b=FlowDesigner.FlowStepAndLineController.get("relatedGroups");var a=[];if(b&&b.length>0){for(var d=0;d<b.length;d++){var e=CS.store.find(CS.Organization,b[d]);a.push(e)}}this.set("value",a)},relatedGroupsChanged:function(){var a=FlowDesigner.FlowStepAndLineController.get("relatedGroups");if(!a||a.length==0){this.organizationView.set("value","")}}.observes("FlowDesigner.FlowStepAndLineController.relatedGroups"),init:function(){this.set("spaceId",Admin.spaceController.get("id"));this.set("companyId",FlowDesigner.companyId);arguments.callee.base.apply(this,arguments)},useModel:true,})}),relatedUserField:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedUserFieldRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedUserField.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedUserField.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},itemTitleKey:"name",itemValueKey:"id",userFieldsBinding:"FlowDesigner.ApproverUserFieldController.content",items:function(){var a=[];if(FlowDesigner.ApproverUserFieldController.content&&FlowDesigner.ApproverUserFieldController.content.length>1){a.push({name:"Step.Message.SelectUserField".loc(),id:""})}FlowDesigner.ApproverUserFieldController.content.toArray().forEach(function(b){a.push({name:b.get("code"),id:b.get("id")})},this);return a}.property("userFields").cacheable(),valueBinding:"FlowDesigner.FlowStepAndLineController.approverUserField"})}),relatedGroupField:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedGroupFieldRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedGroupField.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedGroupField.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},itemTitleKey:"name",itemValueKey:"id",orgFieldsBinding:"FlowDesigner.ApproverOrgFieldController.content",items:function(){var a=[];if(FlowDesigner.ApproverOrgFieldController.content&&FlowDesigner.ApproverOrgFieldController.content.length>1){a.push({name:"Step.Message.SelectOrgField".loc(),id:""})}FlowDesigner.ApproverOrgFieldController.content.toArray().forEach(function(b){a.push({name:b.get("code"),id:b.get("id")})},this);return a}.property("orgFields").cacheable(),valueBinding:"FlowDesigner.FlowStepAndLineController.approverOrgField"})}),hours:SC.View.extend({classNames:"flow_step",layout:{height:61},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Step.Hours".loc()}),value:CS.NumberView.extend({layout:{left:15,right:15,top:30,height:24},fieldValBinding:"FlowDesigner.FlowStepAndLineController.hours",digits:2,hint:"0",minValue:0})}),disableCC:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.disableCC".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.disableCC"})}),allowDistribute:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.allowDistribute".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.allowDistribute"})}),can_edit_main_attach:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.can_edit_main_attach".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.can_edit_main_attach"})}),can_edit_normal_attach:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.can_edit_normal_attach".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.can_edit_normal_attach"})}),cc_must_finished:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.cc_must_finished".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.cc_must_finished"})}),cc_alert:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.cc_alert".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.cc_alert"})}),allowBatch:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.allowBatch".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.allowBatch"})}),oneClickApproval:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.one-click.approval".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.oneClickApproval"})}),oneClickRejection:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.one-click.rejection".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.oneClickRejection"})}),allow_pick_approve_users:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.allow_pick_approve_users".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.allow_pick_approve_users"})}),bottomLine:SC.View.extend({classNames:"step_button_bottom",layout:{height:2},}),emptyView:SC.View.extend({layout:{height:20}})})});FlowDesigner.EndStepPropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend(SC.FlowedLayout,{layout:{left:0,top:20,right:0},classNames:["flow-form-label"],childViews:["topLine","stepName","stepTypeName","bottomLine"],topLine:SC.View.extend({classNames:"step_button_top",layout:{left:0,right:0,top:4,height:2},}),stepName:SC.View.extend({classNames:"flow_step",layout:{height:74},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.Name".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.Name".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:34},valueBinding:"FlowDesigner.FlowStepAndLineController.stepName",hint:"Step.Enter.StepName".loc(),render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var d=this.get("value");if(SC.none(d)||""==d){this.$(".border").css("border-color","red")}else{this.$(".border").css("border-color","#bdbdbd")}})}}),}),stepTypeName:SC.View.extend({classNames:"flow_step",layout:{left:0,right:0,height:30},childViews:["title"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:function(){return"Step.TypeName".loc(FlowDesigner.FlowStepAndLineController.get("stepTypeName"))}.property().cacheable()})}),bottomLine:SC.View.extend({classNames:"step_button_bottom",layout:{left:0,right:0,top:280,height:2},})})});FlowDesigner.FlowPropFlowView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend(SC.FlowedLayout,{layout:{left:0,top:20,right:0},classNames:["flow-form-label-flow"],childViews:["topLine","name","description","created","current_modified","flowPermission","bottomLine"],topLine:SC.View.extend({classNames:"step_button_top",layout:{height:2},}),name:SC.View.extend({classNames:"flow_step",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Flow.Name".loc()}),value:SC.TextFieldView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FlowDesigner.FlowController.name",render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var d=this.get("value");if(SC.none(d)||""==d){this.$(".border").css("border-color","red")}else{this.$(".border").css("border-color","#bdbdbd")}})}})}),description:SC.View.extend({classNames:"flow_step",layout:{height:110},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Flow.Description".loc()}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:70},valueBinding:"FlowDesigner.FlowController.description",})}),created:SC.View.extend({classNames:"flow_step",layout:{height:64},childViews:["created","createdBy"],created:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var a="Flow.Created.Label".loc();if(FlowDesigner.FlowController.get("created")){a+="  "+FlowDesigner.FlowController.get("created").format("yyyy-MM-dd HH:mm:ss")}this.set("value",a)})}}),createdBy:SC.LabelView.extend({layout:{left:15,right:15,top:30,height:24},render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var a="Flow.Created_by.Name".loc();if(FlowDesigner.FlowController.get("created_by")){a+="  "+FlowDesigner.FlowController.get("created_by").get("name")}this.set("value",a)})}})}),current_modified:SC.View.extend({classNames:"flow_step",layout:{height:64},childViews:["modified","modifiedBy"],modified:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},render:function(){arguments.callee.base.apply(this,arguments);this.setModified()},modifiedChange:function(){this.setModified()}.observes("FlowDesigner.FlowController*current.modified"),setModified:function(){this.invokeLast(function(){var a="Flow.Modified.Label".loc();if(FlowDesigner.FlowController.get("current")&&FlowDesigner.FlowController.get("current").get("modified")){a+="  "+FlowDesigner.FlowController.get("current").get("modified").format("yyyy-MM-dd HH:mm:ss")}this.set("value",a)})}}),modifiedBy:SC.LabelView.extend({layout:{left:15,right:15,top:30,height:24},render:function(){arguments.callee.base.apply(this,arguments);this.setModifiedBy()},modifiedByChange:function(){this.setModifiedBy()}.observes("FlowDesigner.FlowController*current.modified_by"),setModifiedBy:function(){this.invokeLast(function(){var a="Flow.Modified.Name".loc();if(FlowDesigner.FlowController.get("current")&&FlowDesigner.FlowController.get("current").get("modified_by")){a+="  "+FlowDesigner.FlowController.get("current").get("modified_by").get("name")}this.set("value",a)})}})}),flowPermission:SC.View.extend({classNames:"flow_step",layout:{height:50},childViews:["buttonView"],buttonView:SC.ButtonView.extend({classNames:["flow-permission-button"],controlSize:SC.HUGE_CONTROL_SIZE,layout:{height:30,top:10,left:50,right:50},title:"Flow.Permission.Setting".loc(),action:function(){FlowDesigner.FlowController.showFlowPermission()}})}),bottomLine:SC.View.extend({classNames:"step_button_bottom",layout:{height:2},}),render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(!FlowDesigner.FlowController.get("isEditable")){this.setContentViewReadOnly()}},this)},setContentViewReadOnly:function(){var a=this.get("childViews");a.forEach(function(b){var d=b.get("childViews").objectAt(1);if(d){this.setValueViewReadOny(d)}},this)},setValueViewReadOny:function(a){a.set("isEditable",NO);a.set("mouseDown",null);a.set("touchStart",null);var b=a.get("childViews");b.forEach(function(d){this.setValueViewReadOny(d)},this)}})});FlowDesigner.LinePropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend(SC.FlowedLayout,{layout:{left:0,top:20,right:0},classNames:["flow-form-label"],childViews:["topLine","lineName","lineFromStep","lineToStep","lineCondition","lineTimeoutLine","bottomLine","emptyView"],topLine:SC.View.extend({classNames:"step_button_top",layout:{height:2},}),lineName:SC.View.extend({classNames:"flow_step",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Line.Name".loc()}),value:SC.TextFieldView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FlowDesigner.FlowStepAndLineController.lineName"})}),lineFromStep:SC.View.extend({classNames:"flow_step",layout:{height:30},childViews:["title"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},lineFromStepBinding:"FlowDesigner.FlowStepAndLineController.lineFromStep",value:function(){return"Line.FromStep".loc(this.get("lineFromStep"))}.property("lineFromStep").cacheable()})}),lineToStep:SC.View.extend({classNames:"flow_step",layout:{height:30},childViews:["title"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},lineToStepBinding:"FlowDesigner.FlowStepAndLineController.lineToStep",value:function(){return"Line.ToStep".loc(this.get("lineToStep"))}.property("lineToStep").cacheable()})}),lineCondition:SC.View.extend({classNames:"flow_step",layout:{height:74},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isLineConditionRowVisible",childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Line.Condition".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Line.Condition".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:34},valueBinding:"FlowDesigner.FlowStepAndLineController.condition",hint:"Line.Formula.Hint".loc(),render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var d=this.get("value");if(SC.none(d)||""==d){this.$(".border").css("border-color","red")}else{this.$(".border").css("border-color","#bdbdbd")}})}})}),lineTimeoutLine:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Line.TimeoutLine".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.lineTimeoutLine"})}),bottomLine:SC.View.extend({classNames:"step_button_bottom",layout:{height:2},}),emptyView:SC.View.extend({layout:{height:20}})})});FlowDesigner.NotifyStepPropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend()});FlowDesigner.FlowPropPermissionsView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],layout:{top:20},verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend({classNames:["prop-permissions-view"],childViews:["titleView","splitLine","formPermissionsView","fieldPermissionsView"],titleView:SC.LabelView.extend({layout:{centerX:0,height:28,width:300},classNames:["permissions-title-view"],value:"Field.Permission.Title".loc()}),splitLine:SC.View.extend({layout:{centerX:0,top:28,height:0,width:315},classNames:["permissions-split-line"]}),formPermissionsView:SC.View.extend({layout:{centerX:0,height:24,width:300,top:35},classNames:["form-permissions-view"],childViews:["btnsView"],btnsView:SC.CheckboxView.extend({classNames:["permission-checkbox"],toggleOnValue:"editable",toggleOffValue:"readonly",titleBinding:SC.Binding.transform(function(a){return"Field.Permission.Form".loc()+a}).from("FlowDesigner.FlowController.form.name"),stepIdBinding:"FlowDesigner.FlowStepAndLineController.stepId",value:function(d,b){if(typeof(b)!="undefined"){var f="__form";var h=FlowDesigner.FlowStepAndLineController.get("permissions");if(!h){FlowDesigner.FlowStepAndLineController.set("permissions",new Object());h=FlowDesigner.FlowStepAndLineController.get("permissions")}var g=b;if(g=="readonly"){delete h[f]}else{h[f]=b}FlowDesigner.settings.curFlowDesigner.updateStepAndLineDataToContent();var e=this.getPath("parentView.parentView.fieldPermissionsView.childViews");if(e){e.forEach(function(j){j.get("btnsView").set("value",b)})}return b}else{var f="__form";var h=FlowDesigner.FlowStepAndLineController.get("permissions");var a=FlowDesigner.FlowStepAndLineController.get("stepType");this.invokeLast(function(){if(FlowDesigner.FlowController.get("isEditable")){if(a=="end"||a=="condition"||a=="counterSign"){this.set("isEnabled",NO)}else{this.set("isEnabled",YES)}}else{this.set("isEnabled",NO)}},this);if(h&&h[f]){return h[f]}else{var g="readonly";return g}}}.property("stepId").cacheable(),})}),fieldPermissionsView:SC.StackedView.extend({classNames:["fields-permissions-view"],layout:{centerX:0,top:59,bottom:8,width:300},init:function(){arguments.callee.base.apply(this,arguments);if(!FlowDesigner.FlowStepAndLineController.get("stepId")){return}var d=[];var b=FlowDesigner.FieldListController.get("content");b.forEach(function(e){d.push(e);if(e.get("type")=="section"||e.get("type")=="table"){e.get("fields").forEach(function(f){d.push(f)})}});this.set("content",d);var a=24*d.get("length")+this.getPath("layout.top")+12;this.invokeLast(function(){this.get("parentView").adjust("height",a)},this)},exampleView:SC.View.extend({layout:{height:24},useStaticLayout:true,isSubField:function(){return SC.instanceOf(this.get("content"),Admin.SubField)}.property("content"),typeBinding:".content.type",permissionBinding:".btnsView.value",classNameBindings:["permission","isSubField"],childViews:["btnsView"],btnsView:SC.CheckboxView.extend({classNames:["permission-checkbox"],toggleOnValue:"editable",toggleOffValue:"readonly",title:function(){var a=this.getPath("parentView.content.type"),b=this.getPath("parentView.content.code");if(a==="table"){return"Field.Permission.Table".loc()+b}else{if(a==="section"){return"Field.Permission.Section".loc()+b}else{return b}}}.property().cacheable(),stepIdBinding:"FlowDesigner.FlowStepAndLineController.stepId",value:function(f,n){if(typeof(n)!="undefined"){var d=this.getPath("parentView.content.code");var h=FlowDesigner.FlowStepAndLineController.get("permissions");if(!h){FlowDesigner.FlowStepAndLineController.set("permissions",new Object());h=FlowDesigner.FlowStepAndLineController.get("permissions")}var b=n;if(!this.get("isEnabled")){b="readonly"}if(b=="readonly"){delete h[d]}else{h[d]=b}FlowDesigner.settings.curFlowDesigner.updateStepAndLineDataToContent();var e=this.getPath("parentView.content");var m=e.get("type");if(m=="section"||m=="table"){var l=this.getPath("parentView.parentView.childViews");if(l){l.forEach(function(o){var k=o.get("type");if(k&&k!="section"&&k!="table"){var p=o.getPath("content.parent.parent");if(e==p){o.get("btnsView").set("value",b)}}})}}return b}else{var d=this.getPath("parentView.content.code");if(!d){return}var h=FlowDesigner.FlowStepAndLineController.get("permissions");var g=FlowDesigner.FlowStepAndLineController.get("stepType");this.invokeLast(function(){if(FlowDesigner.FlowController.get("isEditable")){if(g=="end"||g=="condition"||g=="counterSign"||a){this.set("isEnabled",NO)}else{this.set("isEnabled",YES)}}else{this.set("isEnabled",NO)}},this);var j=this.getPath("parentView.content.formula");var a=NO;if(j&&j.length>0){a=YES}if(h&&h[d]){return h[d]}else{var b="readonly";return b}}}.property("stepId").cacheable(),})})})})});FlowDesigner.SignStepPropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend(SC.FlowedLayout,{layout:{left:0,top:20,right:0},classNames:["flow-form-label"],childViews:["topLine","stepName","stepTypeName","dealType","relatedStep","relatedRole","relatedUsers","relatedGroups","relatedUserField","relatedGroupField","hours","disableCC","allowDistribute","can_edit_main_attach","can_edit_normal_attach","cc_must_finished","cc_alert","allow_pick_approve_users","cc_has_edit_permission","bottomLine","emptyView"],topLine:SC.View.extend({classNames:"step_button_top",layout:{height:2},}),stepName:SC.View.extend({classNames:"flow_step",layout:{height:74},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.Name".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.Name".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:34},valueBinding:"FlowDesigner.FlowStepAndLineController.stepName",hint:"Step.Enter.StepName".loc(),render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var d=this.get("value");if(SC.none(d)||""==d){this.$(".border").css("border-color","red")}else{this.$(".border").css("border-color","#bdbdbd")}})}})}),stepTypeName:SC.View.extend({classNames:"flow_step",layout:{height:30},childViews:["title"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:function(){return"Step.TypeName".loc(FlowDesigner.FlowStepAndLineController.get("stepTypeName"))}.property().cacheable()})}),dealType:SC.View.extend({classNames:"flow_step",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.DealType".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.DealType".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.LabelView.extend({classNames:["deal_type","dealType"],layout:{left:15,right:15,top:30,height:24},value:function(){var a=FlowDesigner.FlowStepAndLineController.get("dealType");var d=FlowDesigner.options.dealTypes;var b;d.forEach(function(e){if(e.value==a){b=e.title}});return b}.property().cacheable(),valueDidChange:function(){var a=FlowDesigner.FlowStepAndLineController.get("dealType");var d=FlowDesigner.options.dealTypes;var b;d.forEach(function(e){if(e.value==a){b=e.title}});this.set("value",b)}.observes("FlowDesigner.FlowStepAndLineController.dealType"),mouseDown:function(){FlowDesigner.FlowStepAndLineController.showDealType(this)},touchStart:function(){this.mouseDown()}})}),relatedStep:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedStepRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Step.RelatedStep".loc(),}),select:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},itemTitleKey:"title",itemValueKey:"value",itemsBinding:"FlowDesigner.FlowStepAndLineController.historySteps",valueBinding:"FlowDesigner.FlowStepAndLineController.relatedStepId"})}),relatedRole:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedRoleRowVisible",childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedRole".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedRole".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,isEditable:false,layout:{left:15,right:15,top:30,height:24},hint:"Step.RelatedRole.Hint".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.rolesNames",mouseDown:function(){FlowDesigner.FlowStepAndLineController.showRolesView(this)},touchStart:function(){this.mouseDown()}})}),relatedUsers:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedUsersRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedUsers.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedUsers.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:CS.UserSelectView.extend({layout:{left:15,right:15,top:30,height:24,minHeight:24},showSearchBox:true,classNames:["org_user_straight"],pickerTitle:"Step.RelatedUsers.Select.Title".loc(),canFilter:true,preferMatrix:[1,0,2,3,1],setValue:function(){var d=FlowDesigner.FlowStepAndLineController.get("relatedUsers");var e=[];if(d&&d.length>0){for(var b=0;b<d.length;b++){var a=CS.store.find(CS.User,d[b]);if(a){e.push(a)}}}this.set("value",e)}.observes("FlowDesigner.FlowStepAndLineController*content.stepId"),valueChange:function(){this.invokeLast(function(){if(this.parentView){this.parentView.adjust("height",this.frame().height+40)}});var b=this.get("value");var d=[];if(b&&b.length>0){for(var a=0;a<b.length;a++){d.push(b[a].get("id"))}}FlowDesigner.FlowStepAndLineController.set("relatedUsers",d)}.observes("value"),render:function(){arguments.callee.base.apply(this,arguments);var d=FlowDesigner.FlowStepAndLineController.get("relatedUsers");var e=[];if(d&&d.length>0){for(var b=0;b<d.length;b++){var a=CS.store.find(CS.User,d[b]);if(a){e.push(a)}}}this.set("value",e)},relatedUsersChanged:function(){var a=FlowDesigner.FlowStepAndLineController.get("relatedUsers");if(!a||a.length==0){this.userView.set("value","")}}.observes("FlowDesigner.FlowStepAndLineController.relatedUsers"),init:function(){this.set("spaceId",Admin.spaceController.get("id"));this.set("companyId",FlowDesigner.companyId);arguments.callee.base.apply(this,arguments)},useModel:true,})}),relatedGroups:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedGroupsRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedGroups.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedGroups.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:CS.OrganizationSelectView.extend({layout:{left:15,right:15,top:30,height:24,minHeight:24},classNames:["org_user_straight"],showFullName:true,pickerTitle:"Step.RelatedGroups.Select.Title".loc(),setValue:function(){var b=FlowDesigner.FlowStepAndLineController.get("relatedGroups");var a=[];if(b&&b.length>0){for(var d=0;d<b.length;d++){var e=CS.store.find(CS.Organization,b[d]);a.push(e)}}this.set("value",a)}.observes("FlowDesigner.FlowStepAndLineController*content.stepId"),valueChange:function(){this.invokeLast(function(){if(this.parentView){this.parentView.adjust("height",this.frame().height+40)}});var d=this.get("value");var a=[];if(d&&d.length>0){for(var b=0;b<d.length;b++){if(d[b]){a.push(d[b].get("id"))}}}FlowDesigner.FlowStepAndLineController.set("relatedGroups",a)}.observes("value"),render:function(){arguments.callee.base.apply(this,arguments);var b=FlowDesigner.FlowStepAndLineController.get("relatedGroups");var a=[];if(b&&b.length>0){for(var d=0;d<b.length;d++){var e=CS.store.find(CS.Organization,b[d]);a.push(e)}}this.set("value",a)},relatedGroupsChanged:function(){var a=FlowDesigner.FlowStepAndLineController.get("relatedGroups");if(!a||a.length==0){this.organizationView.set("value","")}}.observes("FlowDesigner.FlowStepAndLineController.relatedGroups"),init:function(){this.set("spaceId",Admin.spaceController.get("id"));this.set("companyId",FlowDesigner.companyId);arguments.callee.base.apply(this,arguments)},useModel:true,})}),relatedUserField:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedUserFieldRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedUserField.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedUserField.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},itemTitleKey:"name",itemValueKey:"id",userFieldsBinding:"FlowDesigner.ApproverUserFieldController.content",items:function(){var a=[];if(FlowDesigner.ApproverUserFieldController.content&&FlowDesigner.ApproverUserFieldController.content.length>1){a.push({name:"Step.Message.SelectUserField".loc(),id:""})}FlowDesigner.ApproverUserFieldController.content.toArray().forEach(function(b){a.push({name:b.get("code"),id:b.get("id")})},this);return a}.property("userFields").cacheable(),valueBinding:"FlowDesigner.FlowStepAndLineController.approverUserField"})}),relatedGroupField:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedGroupFieldRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedGroupField.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedGroupField.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},itemTitleKey:"name",itemValueKey:"id",orgFieldsBinding:"FlowDesigner.ApproverOrgFieldController.content",items:function(){var a=[];if(FlowDesigner.ApproverOrgFieldController.content&&FlowDesigner.ApproverOrgFieldController.content.length>1){a.push({name:"Step.Message.SelectOrgField".loc(),id:""})}FlowDesigner.ApproverOrgFieldController.content.toArray().forEach(function(b){a.push({name:b.get("code"),id:b.get("id")})},this);return a}.property("orgFields").cacheable(),valueBinding:"FlowDesigner.FlowStepAndLineController.approverOrgField"})}),hours:SC.View.extend({classNames:"flow_step",layout:{height:61},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Step.Hours".loc()}),value:CS.NumberView.extend({layout:{left:15,right:15,top:30,height:24},fieldValBinding:"FlowDesigner.FlowStepAndLineController.hours",digits:2,hint:"0",minValue:0})}),disableCC:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.disableCC".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.disableCC"})}),allowDistribute:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.allowDistribute".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.allowDistribute"})}),can_edit_main_attach:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.can_edit_main_attach".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.can_edit_main_attach"})}),can_edit_normal_attach:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.can_edit_normal_attach".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.can_edit_normal_attach"})}),cc_must_finished:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.cc_must_finished".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.cc_must_finished"})}),cc_alert:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.cc_alert".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.cc_alert"})}),allow_pick_approve_users:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.allow_pick_approve_users".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.allow_pick_approve_users"})}),cc_has_edit_permission:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.cc_has_edit_permission".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.cc_has_edit_permission"})}),bottomLine:SC.View.extend({classNames:"step_button_bottom",layout:{height:2},}),emptyView:SC.View.extend({layout:{height:20}})})});FlowDesigner.StartStepPropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,classNames:["my-prop-scroll-view"],contentView:SC.View.extend(SC.FlowedLayout,{layout:{left:0,top:20,right:0},classNames:["flow-form-label"],childViews:["topLine","stepName","stepTypeName","whoCanCreate","can_edit_main_attach","can_edit_normal_attach","bottomLine","emptyView"],topLine:SC.View.extend({classNames:"step_button_top",layout:{height:2},}),stepName:SC.View.extend({classNames:"flow_step",layout:{height:74},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.Name".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.Name".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:34},valueBinding:"FlowDesigner.FlowStepAndLineController.stepName",continuouslyUpdatesValue:true,commitOnBlur:false,hint:"Step.Enter.StepName".loc(),render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var d=this.get("value");if(SC.none(d)||""==d){this.$(".border").css("border-color","red")}else{this.$(".border").css("border-color","#bdbdbd")}})}})}),stepTypeName:SC.View.extend({classNames:"flow_step",layout:{height:30},childViews:["title"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:function(){return"Step.TypeName".loc(FlowDesigner.FlowStepAndLineController.get("stepTypeName"))}.property().cacheable()})}),whoCanCreate:SC.View.extend({classNames:"flow_step",layout:{height:150},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.Start.WhoCanCreate".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.Start.WhoCanCreate".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.View.extend({layout:{left:15,right:15,top:30,height:110},childViews:["specifyUser","specifyOrg"],specifyOrg:SC.View.extend({layout:{left:10,top:0,height:55},childViews:["title","value"],title:SC.LabelView.extend({layout:{top:0,height:24},value:"Step.Departments".loc(),}),value:CS.OrganizationSelectView.extend({layout:{top:26,height:24,minHeight:24},classNames:["org_user_straight"],showFullName:true,pickerTitle:"Step.Departments".loc(),valueChange:function(){this.invokeLast(function(){if(this.parentView){var e=this.getPath("parentView.parentView.parentView");if(e){this.parentView.adjust("height",this.frame().height+31);this.parentView.parentView.adjust("height",this.frame().height+31+this.parentView.parentView.specifyUser.frame().height);this.parentView.parentView.parentView.adjust("height",this.frame().height+31+this.parentView.parentView.specifyUser.frame().height+30);this.parentView.parentView.specifyUser.adjust("top",this.frame().height+31)}}});var d=this.get("value");var b=[];if(d&&d.length>0){for(var a=0;a<d.length;a++){b.push(d[a])}}FlowDesigner.FlowController.get("perms").set("orgs_can_add",b)}.observes("value"),render:function(){arguments.callee.base.apply(this,arguments);var a=FlowDesigner.FlowController.getPath("perms.orgs_can_add");if(a){a=a.toArray()}this.set("value",a)},init:function(){this.set("spaceId",Admin.spaceController.get("id"));this.set("companyId",FlowDesigner.companyId);arguments.callee.base.apply(this,arguments)},useModel:true,})}),specifyUser:SC.View.extend({layout:{left:10,top:55,height:55},childViews:["title","value"],title:SC.LabelView.extend({layout:{top:0,height:24},value:"Step.Users".loc()}),value:CS.UserSelectView.extend({layout:{top:26,height:24,minHeight:24},classNames:["org_user_straight"],pickerTitle:"Step.Users".loc(),showSearchBox:true,canFilter:true,preferMatrix:[1,0,2,3,1],valueChange:function(){this.invokeLast(function(){if(this.parentView){var e=this.getPath("parentView.parentView.parentView");if(e){this.parentView.adjust("height",this.frame().height+31);this.parentView.parentView.adjust("height",this.frame().height+31+this.parentView.parentView.specifyOrg.frame().height);this.parentView.parentView.parentView.adjust("height",this.frame().height+31+this.parentView.parentView.specifyOrg.frame().height+40);this.parentView.adjust("height",this.frame().height+40)}}});var d=this.get("value");var b=[];if(d&&d.length>0){for(var a=0;a<d.length;a++){b.push(d[a])}}FlowDesigner.FlowController.get("perms").set("users_can_add",b)}.observes("value"),render:function(){arguments.callee.base.apply(this,arguments);var a=FlowDesigner.FlowController.getPath("perms.users_can_add");if(a){a=a.toArray()}this.set("value",a)},init:function(){this.set("spaceId",Admin.spaceController.get("id"));this.set("companyId",FlowDesigner.companyId);arguments.callee.base.apply(this,arguments)},useModel:true,})})})}),can_edit_main_attach:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.can_edit_main_attach".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.can_edit_main_attach"})}),can_edit_normal_attach:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.can_edit_normal_attach".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.can_edit_normal_attach"})}),bottomLine:SC.View.extend({classNames:"step_button_bottom",layout:{height:2},}),emptyView:SC.View.extend({layout:{height:20}})})});FlowDesigner.SubmitStepPropView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{classNames:["my-prop-scroll-view"],verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend(SC.FlowedLayout,{layout:{left:0,top:20,right:0},classNames:["flow-form-label"],childViews:["topLine","stepName","stepTypeName","dealType","relatedStep","relatedRole","relatedUsers","relatedGroups","relatedUserField","relatedGroupField","hours","disableCC","allowDistribute","can_edit_main_attach","can_edit_normal_attach","cc_must_finished","cc_alert","allow_pick_approve_users","cc_has_edit_permission","bottomLine","emptyView"],topLine:SC.View.extend({classNames:"step_button_top",layout:{height:2},}),stepName:SC.View.extend({classNames:"flow_step",layout:{height:74},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.Name".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.Name".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:34},valueBinding:"FlowDesigner.FlowStepAndLineController.stepName",hint:"Step.Enter.StepName".loc(),render:function(a,b){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var d=this.get("value");if(SC.none(d)||""==d){this.$(".border").css("border-color","red")}else{this.$(".border").css("border-color","#bdbdbd")}})}})}),stepTypeName:SC.View.extend({classNames:"flow_step",layout:{height:30},childViews:["title"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:function(){return"Step.TypeName".loc(FlowDesigner.FlowStepAndLineController.get("stepTypeName"))}.property().cacheable()})}),dealType:SC.View.extend({classNames:"flow_step",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.DealType".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.DealType".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.LabelView.extend({classNames:["deal_type","dealType"],layout:{left:15,right:15,top:30,height:24},value:function(){var a=FlowDesigner.FlowStepAndLineController.get("dealType");var d=FlowDesigner.options.dealTypes;var b;d.forEach(function(e){if(e.value==a){b=e.title}});return b}.property().cacheable(),valueDidChange:function(){var a=FlowDesigner.FlowStepAndLineController.get("dealType");var d=FlowDesigner.options.dealTypes;var b;d.forEach(function(e){if(e.value==a){b=e.title}});this.set("value",b)}.observes("FlowDesigner.FlowStepAndLineController.dealType"),mouseDown:function(){FlowDesigner.FlowStepAndLineController.showDealType(this)},touchStart:function(){this.mouseDown()}}),}),relatedRole:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedRoleRowVisible",childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedRole".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedRole".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,isEditable:false,layout:{left:15,right:15,top:30,height:24},hint:"Step.RelatedRole.Hint".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.rolesNames",mouseDown:function(){FlowDesigner.FlowStepAndLineController.showRolesView(this)},touchStart:function(){this.mouseDown()}})}),relatedUsers:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedUsersRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedUsers.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedUsers.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:CS.UserSelectView.extend({layout:{left:15,right:15,top:30,height:24,minHeight:24},classNames:["org_user_straight"],pickerTitle:"Step.RelatedUsers.Select.Title".loc(),showSearchBox:true,canFilter:true,preferMatrix:[1,0,2,3,1],setValue:function(){var d=FlowDesigner.FlowStepAndLineController.get("relatedUsers");var e=[];if(d&&d.length>0){for(var b=0;b<d.length;b++){var a=CS.store.find(CS.User,d[b]);if(a){e.push(a)}}}this.set("value",e)}.observes("FlowDesigner.FlowStepAndLineController*content.stepId"),valueChange:function(){this.invokeLast(function(){if(this.parentView){this.parentView.adjust("height",this.frame().height+40)}});var b=this.get("value");var d=[];if(b&&b.length>0){for(var a=0;a<b.length;a++){d.push(b[a].get("id"))}}FlowDesigner.FlowStepAndLineController.set("relatedUsers",d)}.observes("value"),render:function(){arguments.callee.base.apply(this,arguments);var d=FlowDesigner.FlowStepAndLineController.get("relatedUsers");var e=[];if(d&&d.length>0){for(var b=0;b<d.length;b++){var a=CS.store.find(CS.User,d[b]);if(a){e.push(a)}}}this.set("value",e)},relatedUsersChanged:function(){var a=FlowDesigner.FlowStepAndLineController.get("relatedUsers");if(!a||a.length==0){this.userView.set("value","")}}.observes("FlowDesigner.FlowStepAndLineController.relatedUsers"),init:function(){this.set("spaceId",Admin.spaceController.get("id"));this.set("companyId",FlowDesigner.companyId);arguments.callee.base.apply(this,arguments)},useModel:true,})}),relatedGroups:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedGroupsRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedGroups.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedGroups.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:CS.OrganizationSelectView.extend({layout:{left:15,right:15,top:30,height:24,minHeight:24},classNames:["org_user_straight"],showFullName:true,pickerTitle:"Step.RelatedGroups.Select.Title".loc(),setValue:function(){var b=FlowDesigner.FlowStepAndLineController.get("relatedGroups");var a=[];if(b&&b.length>0){for(var d=0;d<b.length;d++){var e=CS.store.find(CS.Organization,b[d]);a.push(e)}}this.set("value",a)}.observes("FlowDesigner.FlowStepAndLineController*content.stepId"),valueChange:function(){this.invokeLast(function(){if(this.parentView){this.parentView.adjust("height",this.frame().height+40)}});var d=this.get("value");var a=[];if(d&&d.length>0){for(var b=0;b<d.length;b++){if(d[b]){a.push(d[b].get("id"))}}}FlowDesigner.FlowStepAndLineController.set("relatedGroups",a)}.observes("value"),render:function(){arguments.callee.base.apply(this,arguments);var b=FlowDesigner.FlowStepAndLineController.get("relatedGroups");var a=[];if(b&&b.length>0){for(var d=0;d<b.length;d++){var e=CS.store.find(CS.Organization,b[d]);a.push(e)}}this.set("value",a)},relatedGroupsChanged:function(){var a=FlowDesigner.FlowStepAndLineController.get("relatedGroups");if(!a||a.length==0){this.organizationView.set("value","")}}.observes("FlowDesigner.FlowStepAndLineController.relatedGroups"),init:function(){this.set("spaceId",Admin.spaceController.get("id"));this.set("companyId",FlowDesigner.companyId);arguments.callee.base.apply(this,arguments)},useModel:true,})}),relatedUserField:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedUserFieldRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedUserField.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedUserField.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},itemTitleKey:"name",itemValueKey:"id",userFieldsBinding:"FlowDesigner.ApproverUserFieldController.content",items:function(){var a=[];if(FlowDesigner.ApproverUserFieldController.content&&FlowDesigner.ApproverUserFieldController.content.length>1){a.push({name:"Step.Message.SelectUserField".loc(),id:""})}FlowDesigner.ApproverUserFieldController.content.toArray().forEach(function(b){a.push({name:b.get("code"),id:b.get("id")})},this);return a}.property("userFields").cacheable(),valueBinding:"FlowDesigner.FlowStepAndLineController.approverUserField"})}),relatedGroupField:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedGroupFieldRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Step.RelatedGroupField.Title".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Step.RelatedGroupField.Title".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),select:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},itemTitleKey:"name",itemValueKey:"id",orgFieldsBinding:"FlowDesigner.ApproverOrgFieldController.content",items:function(){var a=[];if(FlowDesigner.ApproverOrgFieldController.content&&FlowDesigner.ApproverOrgFieldController.content.length>1){a.push({name:"Step.Message.SelectOrgField".loc(),id:""})}FlowDesigner.ApproverOrgFieldController.content.toArray().forEach(function(b){a.push({name:b.get("code"),id:b.get("id")})},this);return a}.property("orgFields").cacheable(),valueBinding:"FlowDesigner.FlowStepAndLineController.approverOrgField"})}),relatedStep:SC.View.extend({classNames:"flow_step",layout:{height:64},isVisibleBinding:"FlowDesigner.FlowStepAndLineController.isRelatedStepRowVisible",childViews:["title","select"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Step.RelatedStep".loc(),}),select:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},itemTitleKey:"title",itemValueKey:"value",itemsBinding:"FlowDesigner.FlowStepAndLineController.historySteps",valueBinding:"FlowDesigner.FlowStepAndLineController.relatedStepId"})}),hours:SC.View.extend({classNames:"flow_step",layout:{height:61},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Step.Hours".loc()}),value:CS.NumberView.extend({layout:{left:15,right:15,top:30,height:24},fieldValBinding:"FlowDesigner.FlowStepAndLineController.hours",digits:2,hint:"0",minValue:0})}),disableCC:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.disableCC".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.disableCC"})}),allowDistribute:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.allowDistribute".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.allowDistribute"})}),can_edit_main_attach:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.can_edit_main_attach".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.can_edit_main_attach"})}),can_edit_normal_attach:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.can_edit_normal_attach".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.can_edit_normal_attach"})}),cc_must_finished:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.cc_must_finished".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.cc_must_finished"})}),cc_alert:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.cc_alert".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.cc_alert"})}),allow_pick_approve_users:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.allow_pick_approve_users".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.allow_pick_approve_users"})}),cc_has_edit_permission:SC.View.extend({classNames:"flow_step",layout:{height:41},childViews:["ckbox"],ckbox:SC.CheckboxView.extend({layout:{left:15,right:15,top:5,height:24},title:"Step.cc_has_edit_permission".loc(),valueBinding:"FlowDesigner.FlowStepAndLineController.cc_has_edit_permission"})}),bottomLine:SC.View.extend({classNames:"step_button_bottom",layout:{height:2},}),emptyView:SC.View.extend({layout:{height:20}})})});sc_require("views/flow_prop_startStep");sc_require("views/flow_prop_endStep");sc_require("views/flow_prop_conditionStep");sc_require("views/flow_prop_counterSignStep");sc_require("views/flow_prop_signStep");sc_require("views/flow_prop_submitStep");sc_require("views/flow_prop_notifyStep");sc_require("views/flow_prop_concurrentStartStep");sc_require("views/flow_prop_concurrentEndStep");sc_require("views/flow_prop_line");FlowDesigner.FlowPropStepAndLineView=SC.ContainerView.extend({emptyView:SC.LabelView.extend(SC.AutoResize,{layout:{width:220,height:24,centerX:0,centerY:0},controlSize:SC.LARGE_CONTROL_SIZE,value:"Step.Message.SelectStepOrLine".loc(),supportsAutoResize:YES,autoResizeLayer:function(){return this.get("layer")}.property("layer"),autoResizeText:function(){return this.get("value")}.property("value")}),startStepPropView:FlowDesigner.StartStepPropView,endStepPropView:FlowDesigner.EndStepPropView,conditionStepPropView:FlowDesigner.ConditionStepPropView,counterSignStepPropView:FlowDesigner.CounterSignStepPropView,signStepPropView:FlowDesigner.SignStepPropView,submitStepPropView:FlowDesigner.SubmitStepPropView,notifyStepPropView:FlowDesigner.NotifyStepPropView,concurrentStartStepPropView:FlowDesigner.ConcurrentStartStepPropView,concurrentEndStepPropView:FlowDesigner.ConcurrentEndStepPropView,linePropView:FlowDesigner.LinePropView,nowShowingDidChange:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){if(!FlowDesigner.FlowController.get("isEditable")){this.setContentViewReadOnly()}},this)},setContentViewReadOnly:function(){var a=this.getPath("contentView.contentView");if(!a){return}var b=a.get("childViews");b.forEach(function(d){this.setValueViewReadOny(d)},this)},setValueViewReadOny:function(a){a.set("isEditable",NO);a.set("mouseDown",null);a.set("touchStart",null);var b=a.get("childViews");b.forEach(function(d){this.setValueViewReadOny(d)},this)}});SC.stringsFor("en-us",{"Button.Cancel":"Canceldis","Button.OK":"OK","Button.Home":"Home page","Button.FormProperty":"Properties","Button.AddFields":"Add Fields","Button.FieldProperty":"Properties","Button.Edit":"Edit","Button.Delete":"Delete","Button.FormInfo":"Form Info","Button.AllChecked":"All","Disclosure.Input":"Input","Disclosure.Select":"Selection","Disclosure.Others":"Others","Disclosure.InfoBasic":"Basic information","Disclosure.Formula":"Formula","Disclosure.HelpText":"Help text","Form.Name":"Display Name:","Form.Description":"Discription:","Form.HelpText":"Help text:","Form.Rev":"Revision:","Form.Created.Label":"Created on:","Form.Created_by.Name":"Created by:","Form.Modified.Label":"Modified on:","Form.Modified.Name":"Modified by:","FormDesigner.Field.Property.Error":'Error in "%@"',"FormDesigner.Field.CodeNull.Property.Error":"Error in field properties","Field.Null.Message":"Please select a field","Field.Input":"Text","Field.Textarea":"Multi-line text","Field.Email":"Email","Field.URL":"URL","Field.Richtext":"Rich text","Field.Checkbox":"YesNo Box","Field.Number":"Number","Field.Percentage":"Percentage","Field.Password":"Password","Field.Currency":"Currency","Field.Date":"Date","Field.DateTime":"Date-Time","Field.Select":"Drop-down","Field.Radio":"Radio","Field.Group":"Select Dept.","Field.MultiSelect":"Checkbox","Field.User":"Select User","Field.Label":"Label","Field.SubForm":"Sub-form","Field.Table":"Table","Field.Section":"Section","Field.DefaultValue":"Default Value:","Field.Description":"Description:","Field.Name":"Display Name:","Field.Code":"Field Name:","Field.Options":"List Values:","Field.Rows":"Number of rows:","Field.Digits":"Decimal Places:","Field.Is_required":"Required:","Field.Has_others":"Other options:","Field.Is_multiselect":"Select Type:","Field.TypeText":"Field Type:","Field.Formula":"Formula:","Field.Text":"Text:","Field.IsWide":"Wide:","Field.IsTextArea":"Multiline:","Field.No.Select":"None","Field.Label.Instruction":"An label field is read-only. System will show the contents that you entered here.","Field.Formula.Instruction":"After you entered formula, the default value will not be used.","Field.NotSetUp.Subform.Fields":"","Field.NotSetUp.Subform":"","Field.NotSetUp.Options":"at least one option is required.","Field.DefaultValue.Not.Number":"default value must be a number.","Field.DefaultValue.Not.Email":"default value isn't an email address.","Field.Code.NotInput":"Field name is required.","Field.Code.NotInValid":"Reserved key words cannot be the field name.","Field.Code.Repeat":"the field with the same name exists.","Field.Code.CanNot.Repeat":"The field with the same name already exists.","Field.Code.ContainReservedSymbol":"reserved symbol cant be the field name.","Field.Formula.NotInValid":"circular references in formula.","Field.Add.Reminder":"Click Add Fields to add form elements.","Field.Formula.Hint.Value":"Example: {Price}*{Count}","Field.Options.Hint":"Option1<br/>Option2<br/>Option3","Field.UserAndGroup.SelectType.Multiple":"Multiple Choice","Field.UserAndGroup.SelectType.Single":"Single Choice","Field.Table.NO.Fields":"You must add at least 1 field in this table.","Field.Geolocation":"Geolocation","Subform.Data":"Data","Subform.Select":"Select Subform:","Subform.Message.Select":"- None -","Subform.Fields":"Columns:","DeleteField.failed":"Delete Failed!","DeleteField.start":"%@ is referred in following fields:","DeleteField.start2":"%@ is referred in following processes:","DeleteField.end":"To delete this, remove the references in the above listed fields.","DeleteField.end2":"To delete this, remove the references in the above listed processes.","DeleteField.end3":"To delete this, remove the references in the above listed fields and processes.","DeleteField.uuflow":"Also in following processes:","Form.name_forumla":"Name Forumla",Category:"Category:",InstanceStyle:"Style:",InstanceStyleDefault:"default",InstanceStyleTable:"table","Field.IsListDisplay":"List display:","Field.IsSearchable":"Searchable:"});FormDesigner=SC.Application.create({NAMESPACE:"FormDesigner",VERSION:"0.1.0"});FormDesigner.categoriesController=SC.ArrayController.create({load:function(){if(!FormDesigner.formController.get("space")){return}var a,b=CS.store;if(b){query=SC.Query.local(CS.Category,{conditions:"space = %@",parameters:[FormDesigner.formController.get("space").get("id")],orderBy:"name ASC"});CS.store.dataSourceDidFetchQuery(query);a=CS.store.find(query)}this.set("content",a)}.observes("FormDesigner.formController.space")});FormDesigner.fieldController=SC.ObjectController.create({oldCode:null,fieldChange:function(){this.set("oldCode",this.get("code"))}.observes("id"),fieldErrorImagValid:function(f){if(f){var e=f.get("type");var a=f.get("code");var j=f.get("options");var k=f.get("subform");var g=f.get("default_value");var b=f.get("digits")||0;var h=f.get("fields");var d="";d=FormDesigner.fieldListController.fieldsCodeValid(a);if(d==""&&e==="email"){d=FormDesigner.fieldListController.emailValid(g)}if(d==""&&e==="number"){d=FormDesigner.fieldListController.numberValid(g,b)}if(d==""&&e==="number"){d=FormDesigner.fieldListController.hasFormulaFieldValid(a,f.get("formula"),FormDesigner.fieldListController.toArray())}if(d==""&&e==="input"){d=FormDesigner.fieldListController.hasFormulaFieldValid(a,f.get("formula"),FormDesigner.fieldListController.toArray())}if(d==""&&(e==="select"||e==="multiSelect"||e=="radio")){d=FormDesigner.fieldListController.optionsValid(j)}if(d==""&&e==="table"){d=FormDesigner.fieldListController.tableValid(h)}return d}},nowShowing:function(){var b=this.get("content");if(b){var a=b.get("type");return a+"View"}else{return"formInfoView"}}.property("content").cacheable(),type_text:function(){var a="";switch(this.get("type")){case"input":a="Field.Input".loc();break;case"textarea":a="Field.extarea".loc();break;case"richtext":a="Field.Richtext".loc();break;case"email":a="Field.Email".loc();break;case"url":a="Field.URL".loc();break;case"number":a="Field.Number".loc();break;case"percentage":a="Field.Percentage".loc();break;case"currency":a="Field.Currency".loc();break;case"date":a="Field.Date".loc();break;case"dateTime":a="Field.DateTime".loc();break;case"password":a="Field.Password".loc();break;case"checkbox":a="Field.Checkbox".loc();break;case"select":a="Field.Select".loc();break;case"radio":a="Field.Radio".loc();break;case"multiSelect":a="Field.MultiSelect".loc();break;case"group":a="Field.Group".loc();break;case"user":a="Field.User".loc();break;case"subForm":a="Field.SubForm".loc();case"label":a="Field.Label".loc();break;case"table":a="Field.Table".loc();break;case"section":a="Field.Section".loc();break;case"geolocation":a="Field.Geolocation".loc();break;default:a="Field.Input".loc();break}return a}.property("type").cacheable(),options_items:function(){var a=[],b=this.get("options");if(b){a.push({value:"",text:"Field.No.Select".loc()})}if(SC.instanceOf(b,String)){b.split("\n").forEach(function(h,f,d){var g=false;for(var e=0;e<this.length;e++){if(this[e].value==h){g=true}}if(g==false&&h){this.push({value:h,text:h})}},a)}return a}.property("options").cacheable(),subform_fields_object:function(){var a=[],d=this.get("subform");if(d){a=d.get("fields")||[];var b=[];a.forEach(function(e){if(e.get("type")!="subForm"){b.push(e)}})}return b}.property("subform").cacheable(),subform_data:function(){var a=this.get("subform_fields");var b=[{}];if(a&&a.get){a.forEach(function(f,e,d){b[0][f.field_code]="Subform.Data".loc()+e},b)}return b}.property("subform","subform_fields").cacheable(),getDefault:function(b,a){if(this.get("type")=="checkbox"){if(SC.none(a)){return this.get("default_value")=="true"}else{if(a){this.set("default_value",a);return a}else{this.set("default_value",a);return a}}}}.property("default_value").cacheable(),table_columns:function(){var d=[],b=this.get("subform");if(b){fields=b.get("fields");var a=this.get("subform_fields");if(a&&a.get){a.forEach(function(h,f,e){var g=fields.findProperty("code",h.field_code);if(g){this.pushObject(SC.Object.create(SCTable.Column,{nameBinding:SC.Binding.from("name",g),valueKeyBinding:SC.Binding.from("code",g),widthBinding:SC.Binding.from("width",h)}))}},d)}}return d}.property("subform","subform_fields").cacheable(),codeDidChange:function(){SC.debug("codeDidChange");var b=new Date*1;var d=FormDesigner.fieldController.get("oldCode");var a=FormDesigner.fieldController.get("code");if(a==d){return}var h=FormDesigner.formController.get("space").get("id");var f=FormDesigner.formController.get("id");var g=FormDesigner.fieldController.getFlowsByForm(h,f);if(g){g=g.toArray()}else{g=[]}var e=FormDesigner.fieldController.get("type");FormDesigner.fieldController.update_Formula(d,a,e);FormDesigner.fieldController.update_Condition(d,a,e,g);FormDesigner.fieldController.update_Permissions(d,a,g);FormDesigner.fieldController.set("oldCode",FormDesigner.fieldController.get("code"));SC.debug("codeDidChange");SC.debug(""+(new Date()*1-b)+"ms")},update_Formula:function(b,j,d){SC.debug("update_Formula");var f=new Date*1;var g=FormDesigner.fieldListController.content.toArray();var l=g.filterProperty("type","section"),k=g.filterProperty("type","table");if(l.length){l.forEach(function(m){m.get("fields").forEach(function(n){g.push(n)})})}if(k.length){k.forEach(function(m){m.get("fields").forEach(function(n){g.push(n)})})}var h=[];var a=g.filterProperty("type","input");var e=g.filterProperty("type","number");if(a&&a.length){h=h.concat(a)}if(e&&e.length){h=h.concat(e)}if(h.length){h.forEach(function(m){var o=m.get("formula");if(o){if(d=="user"||d=="group"){var n=new RegExp("{"+b+"\\.","g");m.set("formula",o.replace(n,"{"+j+"."))}else{var n=new RegExp("{"+b+"}","g");m.set("formula",o.replace(n,"{"+j+"}"))}}})}SC.debug("update_Formula");SC.debug(""+(new Date()*1-f)+"ms")},getFlowsByForm:function(b,a){},update_Condition:function(a,g,d,f){SC.debug("update_Condition");var e=new Date*1;var h,j,k,b;if(f.length){f.forEach(function(l){h=l.get("current").get("steps").toArray();j=h.filterProperty("step_type","condition");if(j.length){j.forEach(function(m){k=m.get("lines").toArray();if(k.length){k.forEach(function(n){b=n.get("condition");if(b){if(d=="user"||d=="group"){var o=new RegExp("{"+a+"\\.","g");n.set("condition",b.replace(o,"{"+g+"."))}else{var o=new RegExp("{"+a+"}","g");n.set("condition",b.replace(o,"{"+g+"}"))}}})}})}})}SC.debug("update_Condition");SC.debug(""+(new Date()*1-e)+"ms")},update_Permissions:function(f,b,h){SC.debug("update_Permissions");var e=new Date*1;var a,d,g;if(h.length){h.forEach(function(j){a=j.get("current").get("steps").toArray();if(a.length){a.forEach(function(k){d=SC.copy(k.get("permissions"));if(d){g=d[f];if(g){SC.debug("delete permissions "+f);SC.debug("add permissions "+b);delete d[f];d[b]=g;k.set("permissions",d)}}})}})}SC.debug("update_Permissions");SC.debug(""+(new Date()*1-e)+"ms")},addFormula:function(){SC.debug("addFormula");var b=new Date*1;var d=FormDesigner.fieldController.get("code");var g=FormDesigner.fieldController.get("formula");if(g){var j=FormDesigner.formController.get("space").get("id");var k=FormDesigner.formController.get("id");var f=FormDesigner.fieldController.getFlowsByForm(j,k);if(f){f=f.toArray()}else{f=[]}if(f.length){var h,e,a;f.forEach(function(l){h=l.get("current").get("steps").toArray();if(h.length){h.forEach(function(m){e=SC.copy(m.get("permissions"));if(e){if(e[d]){SC.debug("delete permissions "+d);delete e[d];m.set("permissions",e)}}})}})}}SC.debug("addFormula");SC.debug(""+(new Date()*1-b)+"ms")},deleteFormula:function(){var b=FormDesigner.fieldController.get("code");var e="__form";if(FormDesigner.fieldController.getPath("parent.parent") instanceof Admin.Field){e=FormDesigner.fieldController.getPath("parent.parent").get("code")}var h=FormDesigner.formController.get("space").get("id");var f=FormDesigner.formController.get("id");var g=FormDesigner.fieldController.getFlowsByForm(h,f);if(g){g=g.toArray();if(g.length){var a,d;g.forEach(function(j){a=j.get("current").get("steps").toArray();a.forEach(function(k){d=SC.copy(k.get("permissions"));if(d){if(d[e]){d[b]="editable";k.set("permissions",d);SC.debug("addField:"+b+""+k.get("name")+"permissions")}}})})}}},deleteField:function(a){var m=a.get("code"),f=a.get("id"),e=a.get("type");SC.debug("deleteField");var d=new Date*1;errorMessage={};var h=FormDesigner.formController.get("space").get("id");var l=FormDesigner.formController.get("id");var g=FormDesigner.fieldController.getFlowsByForm(h,l);if(g){g=g.toArray()}else{g=[]}var b="",k="",j="";if(e=="section"||e=="table"){a.get("fields").forEach(function(o){var n=o.get("code");errorMessage[n]={};errorMessage[n]["formula"]=[];errorMessage[n]["uuflow"]=[];FormDesigner.fieldController.checkFormula_field(errorMessage,n);FormDesigner.fieldController.checkCondition_field(errorMessage,n,g,o.get("type"),o.get("id"));if(errorMessage[n]["formula"].length>0){b=errorMessage[n]["formula"].join(", ");if(j.length>0){j=j+"\n"+"DeleteField.start".loc('"'+n+'"')+"    "+b}else{j="DeleteField.start".loc('"'+n+'"')+"\n    "+b}}if(errorMessage[n]["uuflow"].length>0){k=errorMessage[n]["uuflow"].join("\n    ");if(errorMessage[n]["formula"].length<1){j="DeleteField.start2".loc('"'+n+'"')+"\n    "+k}else{j=j+"\n"+"DeleteField.uuflow".loc()+"\n    "+k}}if(errorMessage[n]["formula"].length>0&&errorMessage[n]["uuflow"].length<1){j=j+"\n"+"DeleteField.end".loc()}if(errorMessage[n]["uuflow"].length>0&&errorMessage[n]["formula"].length<1){j=j+"\n"+"DeleteField.end2".loc()}if(errorMessage[n]["uuflow"].length>0&&errorMessage[n]["formula"].length>0){j=j+"\n"+"DeleteField.end3".loc()}})}else{errorMessage[m]={};errorMessage[m]["formula"]=[];errorMessage[m]["uuflow"]=[];FormDesigner.fieldController.checkFormula_field(errorMessage,m);FormDesigner.fieldController.checkCondition_field(errorMessage,m,g,e,f);if(errorMessage[m]["formula"].length>0){b=errorMessage[m]["formula"].join(", ");j="DeleteField.start".loc('"'+m+'"')+"\n    "+b}if(errorMessage[m]["uuflow"].length>0){k=errorMessage[m]["uuflow"].join("\n   ");if(errorMessage[m]["formula"].length<1){j="DeleteField.start2".loc('"'+m+'"')+"\n    "+k}else{j=j+"\n"+"DeleteField.uuflow".loc()+"\n    "+k}}if(errorMessage[m]["formula"].length>0&&errorMessage[m]["uuflow"].length<1){j=j+"\n"+"DeleteField.end".loc()}if(errorMessage[m]["uuflow"].length>0&&errorMessage[m]["formula"].length<1){j=j+"\n"+"DeleteField.end2".loc()}if(errorMessage[m]["uuflow"].length>0&&errorMessage[m]["formula"].length>0){j=j+"\n"+"DeleteField.end3".loc()}}if(b!=""||k!=""){navigator.notification.alert(j,function(){},"DeleteField.failed".loc(),"Button.OK".loc());SC.debug("deleteField");SC.debug(""+(new Date()*1-d)+"ms");return false}SC.debug("deleteField");SC.debug(""+(new Date()*1-d)+"ms");return true},checkFormula_field:function(f,j){var b=[];var e=FormDesigner.fieldListController.content.toArray();var k=e.filterProperty("type","section"),h=e.filterProperty("type","table");if(k.length){k.forEach(function(l){l.get("fields").forEach(function(m){e.push(m)})})}if(h.length){h.forEach(function(l){l.get("fields").forEach(function(m){e.push(m)})})}var g=[];var a=e.filterProperty("type","input");var d=e.filterProperty("type","number");if(a&&a.length){g=g.concat(a)}if(d&&d.length){g=g.concat(d)}if(g.length){g.forEach(function(l){var m=l.get("formula");if(m){if(FormDesigner.fieldController.codeIsUseInFormula(j,m)){b.push(l.get("code"))}}})}f[j]["formula"]=b},checkCondition_field:function(e,k,g,d,f){var a=[];var h,j,l,b;if(g.length){g.forEach(function(n){var o="";var m=[];h=n.get("current").get("steps").toArray();if(d=="user"){var p=h.filterProperty("deal_type","userField");if(p.length){p.forEach(function(s){approver_user_field=s.get("approver_user_field");if(approver_user_field==f){m.push(s.get("name"))}})}}if(d=="group"){var q=h.filterProperty("deal_type","orgField");if(q.length){q.forEach(function(s){approver_org_field=s.get("approver_org_field");if(approver_org_field==f){m.push(s.get("name"))}})}}j=h.filterProperty("step_type","condition");if(j.length){j.forEach(function(s){l=s.get("lines").toArray();lines_errorStepName="";if(l.length){l.forEach(function(t){b=t.get("condition");if(b){if(FormDesigner.fieldController.codeIsUseInFormula(k,b)){lines_errorStepName=s.get("name")}}})}if(lines_errorStepName!=""){m.push(lines_errorStepName)}})}if(m.length>0){o=n.get("name")+"("+m.join(", ")+")"}if(o!=""){a.push(o)}})}e[k]["uuflow"]=a},codeIsUseInFormula:function(a,f){if(a&&f){var j="{"+a+"}";if(j==f){return true}if(f.length>j.length){var g=f.split(j);for(var b=g.length-2;b>=0;b--){var k=f.search(j);var e=f.charAt(k-1);var d=f.charAt(k+j.length);if(e.match(/\w/)==null&&d.match(/\w/)==null){return true}}}var h="{"+a+".";if(f.length>h.length){var g=f.split(h);for(var b=g.length-2;b>=0;b--){var k=f.search(h);var e=f.charAt(k-1);if(e.match(/\w/)==null){return true}}}}return false},delete_Permissions:function(b,g){SC.debug("delete_Permissions");var e=new Date*1;var a,d,f;if(g.length){g.forEach(function(h){a=h.get("current").get("steps").toArray();if(a.length){a.forEach(function(j){d=SC.copy(j.get("permissions"));if(d){SC.debug("delete permissions "+b);delete d[b];j.set("permissions",d)}else{SC.debug("permissions is null")}})}})}SC.debug("delete_Permissions");SC.debug(""+(new Date()*1-e)+"ms")},formatValuesOfOptions:function(d){var e=[];if(d){var b=d.split("\n");for(var a=0;a<b.length;a++){if(b[a]&&b[a].trim()&&!e.contains(b[a])){if(FormDesigner.fieldController.get("type")=="multiSelect"){e.push(b[a].replace(/[,]/g,""))}else{e.push(b[a])}}}}return e}});FormDesigner.formController=SC.ObjectController.create(SC.CollectionViewDelegate,{nowShowing:"FormDesigner.FormPropFieldView",formDesignerView:null,isSelectingParentField:NO,clearAllSubFieldSel:function(){var e=this.getPath("formDesignerView.contentView");var b=this.get("isSelectingParentField");var a=FormDesigner.fieldListController.getPath("selection.firstObject.id");var d=e.get("childViews").filter(function(g){var f=g.get("type");if(f=="section"||f=="table"){if(b){if(a==g.getPath("content.id")){return NO}else{return YES}}else{return YES}}else{return NO}});d.forEach(function(g){var f=g.getPath("fieldView.childViews.firstObject.contentView");f.deselectAll()},this)},clearAllSel:function(b){if(b.get("isHeader")){this.getPath("formDesignerView.contentView").deselectAll();this.clearAllSubFieldSel()}else{if(b.get("isMainField")){var d=b.getPath("selection.firstObject");if(d){this.getPath("formDesignerView.headerView").set("sel",NO);this.clearAllSubFieldSel()}}else{if(b.get("isSubField")){var d=b.getPath("selection.firstObject");if(d){this.getPath("formDesignerView.headerView").set("sel",NO);var f=this.getPath("formDesignerView.contentView");var a=d.get("id"),e=f.getPath("selection.firstObject.fields");if(!(e&&e.filterProperty("id",a).get("length"))){f.deselectAll()}}}}}},selectParentField:function(b){var d=FormDesigner.fieldListController.getPath("selection.firstObject.id"),a=b.getPath("selection.firstObject.parent.parent");if(!a){return}if(d!=a.get("id")){this.set("isSelectingParentField",YES);FormDesigner.fieldListController.selectObject(a)}},});sc_require("controllers/form_controller");FormDesigner.fieldListController=SC.ArrayController.create({contentBinding:"FormDesigner.formController.fields",allowsMultipleSelection:NO,errorMessage:"",addFieldDelegate:null,updateMainFieldsHeight:function(a){if(!this.get("content")){return}SC.debug("FormDesigner.fieldListController.updateMainFieldsHeight");this.get("mainFieldsView").updateHeight(a)},updateAllSubFieldsHeight:function(){if(!this.get("content")){return}SC.debug("FormDesigner.fieldListController.updateAllSubFieldsHeight");var a=this.getAllSubFieldsView();a.forEach(function(b){b.updateHeight()})},updateCurSubFieldsHeight:function(){if(!this.get("content")){return}SC.debug("FormDesigner.fieldListController.updateCurSubFieldsHeight");var a=this.getSubFieldsView();a.updateHeight()},mainFieldsView:function(){return FormDesigner.formController.getPath("formDesignerView.contentView")}.property("content").cacheable(),getSubFieldsView:function(){var d=this.get("mainFieldsView"),b=d.getPath("selection.firstObject"),a=b?b.get("type"):null;if((a=="section"||a=="table")){mainSelFieldView=d.itemViewForContentObject(b),subFieldsView=mainSelFieldView.getPath("fieldView.childViews.firstObject.contentView");return subFieldsView}else{return null}},getAllSubFieldsView:function(){var a=[],b=this.get("mainFieldsView");b.get("childViews").forEach(function(d){var e=d.get("type");if(e=="section"||e=="table"){a.push(d.getPath("fieldView.childViews.firstObject.contentView"))}});return a},selectNewField:function(d,f){var b,a;if(d){b=this.getSubFieldsView();f>=0?b.select(f):null}else{b=this.get("mainFieldsView")}a=b.getPath("selection.firstObject");if(a){b.selectNextItem()}else{var e=b.getPath("content.length")-1;b.select(e);b.scrollToVisible()}},addField:function(d,b,e){SC.debug("FormDesigner.fieldListController.addField");var a=this.get("addFieldDelegate");if(SC.instanceOf(a,Function)){a(d,b,e)}this.invokeLast(function(){SC.debug("addFieldupdateMainFieldsHeight");this.updateMainFieldsHeight(YES)})},validFormFields:function(){SC.debug("FormDesigner.fieldListController.validFormFields");if(FormDesigner.formController&&FormDesigner.formController.get("id")){var a=this.toArray();var g=a.filterProperty("type","section"),b=a.filterProperty("type","table");if(g.length){g.forEach(function(j){j.get("fields").forEach(function(k){a.push(k)})})}if(b.length){b.forEach(function(j){j.get("fields").forEach(function(k){a.push(k)})})}var h=[];if(a){for(var e=0;e<a.length;e++){if(!a[e]){break}var d=this.fieldsCodeValid(a[e].get("code"));if(d!=""){var f=a[e].get("code")?(a[e].get("code")+": "+d):(d);h.push(f)}if(a[e].get("type")=="email"){var d=this.emailValid(a[e].get("default_value"));if(d!=""){h.push(a[e].get("code")+": "+d)}}if(a[e].get("type")=="number"){var d=this.numberValid(a[e].get("default_value"));if(d!=""){h.push(a[e].get("code")+": "+d)}}if(a[e].get("type")==="select"||a[e].get("type")==="multiSelect"||a[e].get("type")=="radio"){var d=this.optionsValid(a[e].get("options"));if(d!=""){h.push(a[e].get("code")+": "+d)}}if(a[e].get("type")==="input"||a[e].get("type")==="number"||a[e].get("type")=="label"){var d=this.hasFormulaFieldValid(a[e].get("code"),a[e].get("formula"),a);if(d!=""){h.push(a[e].get("code")+": "+d)}}if(a[e].get("type")=="table"){var d=this.tableValid(a[e].get("fields"));if(d!=""){h.push(a[e].get("code")+": "+d)}}}if(h.length>0){if(FormDesigner.formController.get("is_valid")==true){FormDesigner.formController.set("is_valid",false)}FormDesigner.formValidController.set("errorMessage",h.join("\n"))}else{if(FormDesigner.formController.get("is_valid")==false){FormDesigner.formController.set("is_valid",true)}FormDesigner.formValidController.set("errorMessage","")}}return h.toString()}},hasFormulaFieldValid:function(a,C,n){var t="";if(!a||!C||!n||C.trim()===""){return t}var A=new Array();var D=new Array();var w=new Array();for(var x=n.length-1;x>=0;x--){if(n[x]&&(n[x].get("type")==="input"||n[x].get("type")==="number")&&n[x].get("formula")!=null&&n[x].get("formula").trim()!=""){A.push(n[x]);D.push(n[x].get("code"))}else{if(n[x]&&n[x].get("type")==="subForm"){_subForm=n[x].get("subform");if(_subForm!=null&&_subForm instanceof SC.Record){_subFormVersions=new Array();_subFormVersions.push(_subForm.get("current"));_subFormVersions.concat(_subForm.get("historys"));for(var q=_subFormVersions.length-1;q>=0;q--){if(n[x].get("subform_version")===_subFormVersions[q].get("id")){_fields=_subFormVersions[q].get("fields");for(var g=_fields.length()-1;g>=0;g--){w.push(n[x].get("code")+"."+_fields.objectAt(g).get("code"))}}}}}}}w=w.sort();var u=a;var f=C.trim();var e=new Array();for(var x=w.length-1;x>=0;x--){f=f.replace(new RegExp(w[x],"g"),"")}for(var v=D.length-1;v>=0;v--){var b=f.split(D[v]);if(b.length==1){continue}else{var y=f;for(var s=b.length-2;s>=0;s--){var z=y.search(D[v]);var d=y.charAt(z-1);var h=y.charAt(z+D[v].length);y=y.slice(z+D[v].length-1);if(d.match(/\w/)==null&&h.match(/\w/)==null){if(D[v]!=u){e.push(D[v])}}}}}e=e.uniq();var l=new Array();for(var k=A.length-1;k>=0;k--){if(e.contains(A[k].get("code"))){l.push(A[k])}}var B=this._fieldFormulaValid(D,l,A,u,w);if(B==false){t="Field.Formula.NotInValid".loc()}return t},_fieldFormulaValid:function(z,h,y,q,t){for(var u=h.length-1;u>=0;u--){if(h[u].get("formula")===null||h[u].get("code")===null){continue}var e=h[u].get("formula").trim();for(var o=t.length-1;o>=0;o--){e=e.replace(new RegExp(t[o],"g"),"")}var a=h[u].get("code");var v=new Array();for(var s=z.length-1;s>=0;s--){var b=e.split(z[s]);if(b.length==1){continue}else{var w=e;for(var n=b.length-2;n>=0;n--){var x=w.search(z[s]);var d=w.charAt(x-1);var f=w.charAt(x+z[s].length);w=w.slice(x+z[s].length-1);if(d.match(/\w/)==null&&f.match(/\w/)==null){v.push(z[s])}}}}v=v.uniq();if(v.length>0){if(v.contains(q)){return false}else{y=y.removeObject(h[u]);var l=new Array();for(var g=y.length-1;g>=0;g--){if(v.contains(y[g].get("code"))){l.push(y[g])}}return this._fieldFormulaValid(z,l,y,q,t)}}}},tableValid:function(a){var b="";if(a&&a.toArray()&&a.toArray().length>0){return b}else{b="Field.Table.NO.Fields".loc()}return b},subformFieldsValid:function(b){var a="";if(b&&b.length>0){return a}else{a="Field.NotSetUp.Subform.Fields".loc()}return a},subformValid:function(b){var a="";if(!b){a="Field.NotSetUp.Subform".loc()}return a},optionsValid:function(b){var a="";if(!b){a="Field.NotSetUp.Options".loc()}return a},numberValid:function(d){var a="";if(d){var b=CS.Number.valiReg;if(!b.test(d)){a="Field.DefaultValue.Not.Number".loc()}}return a},emailValid:function(d){var a="";if(d){var b=/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/;if(!b.test(d)){a="Field.DefaultValue.Not.Email".loc()}}return a},fieldsCodeValid:function(j){var e="";if(j===null||j===undefined||""==j.trim()){e="Field.Code.NotInput".loc()}else{if((j.indexOf("{")>=0)||(j.indexOf("}")>=0)){e="Field.Code.ContainReservedSymbol".loc()}}if(e==""){var a=FormDesigner.fieldListController.toArray();var h=a.filterProperty("type","section"),b=a.filterProperty("type","table");if(h.length){h.forEach(function(k){k.get("fields").forEach(function(l){a.push(l)})})}if(b.length){b.forEach(function(k){k.get("fields").forEach(function(l){a.push(l)})})}var d=0;for(var f=0;f<a.length;f++){if(a[f]){var g=a[f].get("code");if(g&&g==j){d++}}}if(d>1){e="Field.Code.Repeat".loc()}}return e}});FormDesigner.formValidController=SC.ObjectController.create({errorMessage:"",check_chars:[":","","\\","/","","?","","*","","[","","]","","'",""],valid_name:function(a){var d=false;if(a){for(var b=this.get("check_chars").length-1;b>=0;b--){if(a.indexOf(this.get("check_chars")[b])>-1){d=true;break}}}if(d){a=a.replace(/\:/g,"");a=a.replace(/\/g,"");a=a.replace(/\\/g,"");a=a.replace(/\//g,"");a=a.replace(/\/g,"");a=a.replace(/\?/g,"");a=a.replace(/\/g,"");a=a.replace(/\*/g,"");a=a.replace(/\/g,"");a=a.replace(/\[/g,"");a=a.replace(/\/g,"");a=a.replace(/\]/g,"");a=a.replace(/\/g,"");a=a.replace(/\'/g,"")}r=new Object();r.is_change=d;r.value=a;return r}});FormDesigner.SubFormListController=SC.ArrayController.create({});SC.SORT_DIRECTION_NONE=null;SC.SORT_DIRECTION_ASCENDING="asc";SC.SORT_DIRECTION_DESCENDING="desc";SC.Column={isColumn:YES,label:null,key:null,sort:null,sortServer:null,iconKey:null,width:100,canResize:YES,canSort:YES,classNames:null,rightClicOnColumnHeader:function(){}};FormDesigner.DragAppendButtonDelegate={isDragAppendButtonDelegate:YES,isDown:false,mouseEntered:function(){this.$().addClass("mouse_on_button")},mouseExited:function(){this.$().removeClass("mouse_on_button")},mouseDown:function(a){this.isDown=true},touchStart:function(a){this.isDown=true},dragFieldToAdd:function(a){this.getDragContent();return YES},mouseUp:function(a){if(this.isDown==true){this.dragFieldToAdd(a)}return NO},touchEnd:function(a){if(this.isDown==true){this.dragFieldToAdd(a)}return NO},getDragContent:function(){var f,a,g=this.get("type"),b=FormDesigner.fieldListController.get("mainFieldsView"),e=b.getPath("selection.firstObject"),j=e?e.get("type"):null,l,d,k,h;if((j=="section"||j=="table")&&(g!="section"&&g!="table")){f=e;l=FormDesigner.fieldListController.getSubFieldsView();d=l.getPath("selection.firstObject")}else{f=null;l=b;d=e}if(d){k=l.get("content").indexOf(d);h=k+1}else{h=l.getPath("content.length")}SC.debug("FormDesigner.getDragContent.newFieldIndex:"+h);a=FormDesigner.fieldListController.addField(g,h,f);FormDesigner.fieldListController.validFormFields();this.invokeNext(function(){FormDesigner.fieldListController.selectNewField(f,k)},this);return a},startDrag:function(a){var b=this;var d=this.getDragContent();if(!SC.none(d)){b.set("content",d)}SC.Drag.start({event:a,source:this,dragView:b,ghost:NO,ghostActsLikeCursor:NO,slideBack:YES,dataSource:this,sourceIsDraggable:YES});return YES}};FormDesigner.CheckboxView=SC.CheckboxView.extend({layout:{height:30},isEnabledBinding:"FormDesigner.formController.isEditable",defaultValueBinding:".content.default_value",value:function(b,a){if(SC.none(a)){return this.content.get("default_value")=="true"}else{this.content.set("default_value",a);return a}}.property("defaultValue").cacheable()});FormDesigner.DateTimeView=SC.TextFieldView.extend({layout:{height:30},isEditable:NO,value:"yyyy-MM-dd HH:mm"});FormDesigner.DateView=SC.TextFieldView.extend({layout:{height:30},isEditable:NO,value:"yyyy-MM-dd"});FormDesigner.EmailView=SC.TextFieldView.extend({layout:{height:30},isEditableBinding:"FormDesigner.formController.isEditable",autoCapitalize:false,validator:"email",valueBinding:".content.default_value",valueDidChange:function(){FormDesigner.fieldListController.validFormFields()}.observes("value"),render:function(b,e){var d=this.get("content"),a=NO;if(d!=null){a=d.get("is_required")}arguments.callee.base.apply(this,arguments)}});FormDesigner.GeolocationView=SC.TextFieldView.extend({layout:{height:30},isEditable:false});FormDesigner.GroupView=SC.TextFieldView.extend({layout:{height:30},isEditable:false});FormDesigner.InputView=SC.TextFieldView.extend({layout:{height:30},isEditableBinding:"FormDesigner.formController.isEditable",valueBinding:".content.default_value",classNames:["form-canvas-input-view"],isTextArea:true});FormDesigner.LabelView=SC.LabelView.extend({layout:{height:30},valueBinding:".content.default_value"});FormDesigner.CheckboxListView=SC.View.extend(SC.Control,{acceptsFirstResponder:function(){if(SC.FOCUS_ALL_CONTROLS){return this.get("isEnabled")}return NO}.property("isEnabled"),classNames:["sc-checkbox-view"],ariaRole:"checkboxgroup",displayProperties:["displayItems","isEnabled","layoutDirection"],renderDelegateName:"formCheckboxGroupRenderDelegate",itemAriaLabeledByKey:null,itemAriaLabelKey:null,value:null,layoutDirection:SC.LAYOUT_VERTICAL,escapeHTML:YES,items:[],itemTitleKey:null,itemWidthKey:null,itemValueKey:null,itemIsEnabledKey:null,itemIconKey:null,itemsDidChange:function(){if(this._items){this._items.removeObserver("[]",this,this.itemContentDidChange)}this._items=this.get("items");if(this._items){this._items.addObserver("[]",this,this.itemContentDidChange)}this.itemContentDidChange()}.observes("items"),itemContentDidChange:function(){this._renderAsFirstTime=YES;this.notifyPropertyChange("displayItems")},displayItems:function(){var n=this.get("items"),t=(this.get("value")||"").split(","),j=SC.isArray(t),g=this.get("localize"),e=this.get("itemTitleKey"),f=this.get("itemValueKey"),s=this.get("itemWidthKey"),d=this.get("layoutDirection")===SC.LAYOUT_HORIZONTAL,m=this.get("itemIsEnabledKey"),A=this.get("itemIconKey"),h=this.get("itemAriaLabeledByKey"),C=this.get("itemAriaLabelKey"),z=this._displayItems||[],u=(n)?n.get("length"):0,x,B,o,p,l,y,w,q,b,a,v;for(l=0;l<u;l++){x=n.objectAt(l);if(SC.typeOf(x)===SC.T_ARRAY){B=x[0];p=x[1]}else{if(x){if(e){B=x.get?x.get(e):x[e]}else{B=(x.toString)?x.toString():null}if(s&&d){o=x.get?x.get(s):x[s]}if(f){p=x.get?x.get(f):x[f]}else{p=x}if(m){y=x.get?x.get(m):x[m]}else{y=YES}if(A){w=x.get?x.get(A):x[A]}else{w=null}if(h){a=x.get?x.get(h):x[h]}else{a=null}if(C){v=x.get?x.get(C):x[C]}else{v=null}}else{B=p=w=null;y=NO}}if(!p){continue}y=y&&this.get("isEnabled");if(x){q=(j)?(t.indexOf(p)>=0):(t===p)}else{q=NO}if(g){B=SC.String.loc(B)}var k={title:B,icon:w,width:o,value:p,isEnabled:y,isSelected:t.contains(p),isMixed:NO,isActive:this._activeCheckboxButton===l,theme:this.get("theme"),renderState:{}};z.push(SC.Object.create(k))}return z}.property("isEnabled","value","items","itemTitleKey","itemWidthKey","itemValueKey","itemIsEnabledKey","localize","itemIconKey","itemAriaLabeledByKey","itemAriaLabelKey").cacheable(),mouseDown:function(a){if(!this.get("isEnabled")){return YES}var e=this.get("renderDelegate"),d=this.get("renderDelegateProxy"),g=this.$(),b=e.indexForEvent(d,g,a);this._activeCheckboxButton=b;if(b!==undefined){var f=this.get("displayItems")[b];if(f&&f.get("isEnabled")){f.set("isActive",YES);e.updateCheckboxAtIndex(d,g,b)}}a.allowDefault();return YES},mouseUp:function(a){if(!this.get("isEnabled")){return YES}var e=this.get("renderDelegate"),d=this.get("renderDelegateProxy"),g=this.$(),j=this.get("displayItems"),b=e.indexForEvent(d,g,a);if(!j||j.length<=0){return}if(this._activeCheckboxButton!==undefined&&b!==this._activeCheckboxButton){j[this._activeCheckboxButton].set("isActive",NO);e.updateCheckboxAtIndex(d,g,this._activeCheckboxButton)}this._activeCheckboxButton=undefined;if(b!==undefined){var f=this.get("displayItems")[b];if(f.get("isEnabled")){f.set("isActive",NO);e.updateCheckboxAtIndex(d,g,b);var h=(this.get("value")||"").split(",");if(h.contains(f.value)){h.removeObject(f.value)}else{h.pushObject(f.value)}h=h.removeObject("");this.set("value",h.join(","))}}a.allowDefault();return YES},keyDown:function(k){if(!this.get("isEnabled")){return YES}if(k.which===9||k.keyCode===9){var j=k.shiftKey?this.get("previousValidKeyView"):this.get("nextValidKeyView");if(j){j.becomeFirstResponder()}else{k.allowDefault()}return YES}if(k.which>=37&&k.which<=40){var h=this.get("renderDelegate"),g=this.get("renderDelegateProxy"),d=this.$(),f=this.get("displayItems"),b=this.get("value");for(var e=0,a=f.length;e<a;e++){if(b===f[e].value){break}}if(k.which===37||k.which===38){if(e<=0){e=f.length-1}else{e--}}if(k.which===39||k.which===40){if(e>=f.length-1){e=0}else{e++}}h.updateCheckboxAtIndex(g,d,e);this.set("value",f[e].value)}k.allowDefault();return NO},touchStart:function(a){return this.mouseDown(a)},touchEnd:function(a){return this.mouseUp(a)},render:function(a,b){arguments.callee.base.apply(this,arguments);this.updateTotalHeight()},updateTotalHeight:function(){this.invokeLast(function(){var a=0;this.$("div").forEach(function(b){a+=$(b).height()});a=((a==0)?0:a+4);this.adjust("height",a)},this)}});sc_require("views/checkbox_list");FormDesigner.MultiSelectView=FormDesigner.CheckboxListView.extend({isEnabledBinding:"FormDesigner.formController.isEditable",valueBinding:".content.default_value",optionsBinding:".content.options",items:function(){var a=[],b=this.content.get("options");if(SC.instanceOf(b,String)){b.split("\n").forEach(function(h,f,d){var g=false;for(var e=0;e<this.length;e++){if(this[e].value==h){g=true}}if(g==false&&h){this.push({value:h,text:h})}},a)}return a}.property(".options").cacheable(),itemTitleKey:"text",itemValueKey:"value",itemIconKey:"icon",displayProperties:["items"],render:function(a,b){SC.debug("FormDesigner.MultiSelectView.render");arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var f=this.$(".sc-button-label");if(f&&f.length>0){f.addClass("multiSelect_title");if(this.content&&this.content.get("is_wide")==true){this.$(".multiSelect_title").css("max-width",410)}else{this.$(".multiSelect_title").css("max-width",195)}for(var d=0;d<f.length;d++){oldHtml=this.$(".sc-button-label")[d].innerHTML;var e=oldHtml.replace(/ /g,"&nbsp;");$(this.$(".sc-button-label")[d]).html(e)}}})},isWidthChanged:function(){this.invokeLast(function(){var a=this.$(".multiSelect_title");if(a&&a.length>0){if(this.content&&this.content.get("is_wide")==true){this.$(".multiSelect_title").css("max-width",410)}else{this.$(".multiSelect_title").css("max-width",195)}}})}.observes(".content.is_wide"),mouseDown:function(){arguments.callee.base.apply(this,arguments);this.getPath("parentView.parentView").tryToPerform("didBecomeFirstResponder");return YES}});FormDesigner.NumberView=CS.NumberView.extend({layout:{height:30},isEditableBinding:"FormDesigner.formController.isEditable",fieldValBinding:".content.default_value",digitsBinding:SC.Binding.oneWay(".content.digits"),applyImmediately:NO,value:function(b,a){var d=this.get("fieldVal");if(a!=undefined){this.set("fieldVal",a.toString())}else{var e=this.get("isFirstResponder");if(e){return d}else{if(this.getPath("content.type")=="number"){return this.getShowNumber(d)}else{return d}}}}.property(".fieldVal",".digits").cacheable(),valueDidChange:function(){FormDesigner.fieldListController.validFormFields()}.observes("value")});FormDesigner.PasswordView=SC.TextFieldView.extend({layout:{height:30},isEditableBinding:"FormDesigner.formController.isEditable",type:"password",valueBinding:".content.default_value"});FormDesigner.RadioView=SC.RadioView.extend({isEnabledBinding:"FormDesigner.formController.isEditable",valueBinding:".content.default_value",optionsBinding:".content.options",items:function(){var a=[],b=this.content.get("options");if(b){a.push({value:"",text:"Field.No.Select".loc()})}if(SC.instanceOf(b,String)){b.split("\n").forEach(function(h,f,d){var g=false;for(var e=0;e<this.length;e++){if(this[e].value==h){g=true}}if(g==false&&h){this.push({value:h,text:h})}},a)}return a}.property(".options").cacheable(),itemTitleKey:"text",itemValueKey:"value",itemIconKey:"icon",displayProperties:["items"],render:function(d,e){SC.debug("FormDesigner.RadioView.render");var b=this.get("items"),a=b.length==0?1:b.length;this.adjust("height",a*this.height);arguments.callee.base.apply(this,arguments);if(b.length!==0){if(!this.get("value")){this.set("value",b[0].value)}else{if(b.filterProperty("value",this.get("value")).length==0){this.set("value",b[0].value)}}}this.invokeLast(function(){var h=this.$(".sc-button-label");if(h&&h.length>0){h.addClass("radio_title");for(var f=0;f<h.length;f++){oldHtml=this.$(".sc-button-label")[f].innerHTML;var g=oldHtml.replace(/ /g,"&nbsp;");$(this.$(".sc-button-label")[f]).html(g)}}})},mouseDown:function(){arguments.callee.base.apply(this,arguments);this.getPath("parentView.parentView").tryToPerform("didBecomeFirstResponder");return YES}});FormDesigner.SectionView=SC.View.extend({childViews:["descriptionView","contentView"],descriptionView:SC.LabelView.extend({layout:{height:16},classNames:["item-description-view"],valueBinding:".parentView*content.description",}),contentView:SC.ListView.extend({classNames:["item-content-view"],layout:{top:22,left:20,right:20,bottom:10},isSubField:YES,contentBinding:".parentView*content.fields",canDeleteContent:true,canEditContent:true,canReorderContent:true,createItemView:function(d,a,b){SC.debug("SectionTableListViewcreateItemView,idx:"+a);return FormDesigner.FormDesignerItemView.create(b)},deleteSelection:function(){arguments.callee.base.apply(this,arguments);SC.debug("SectionTableListViewdeleteSelection");FormDesigner.fieldListController.updateMainFieldsHeight(YES);var a=this.getPath("parentView.parentView.content");FormDesigner.fieldListController.selectObject(a);this.invokeLast(function(){FormDesigner.fieldListController.validFormFields()},this)},dragExited:function(){arguments.callee.base.apply(this,arguments);SC.debug("SectionTableListViewdragExited");this.updateHeight()},contentIndexRowHeight:function(a,f,b){SC.debug("SectionTableListViewcontentIndexRowHeight");SC.debug("fieldIndex:"+b);var e=60;if(f.objectAt(b)){var d=f.objectAt(b).get("type");if(d==="radio"){if(f.objectAt(b).get("options")){e=45+21*f.objectAt(b).get("options").split("\n").length}else{e=45}}else{if(d==="multiSelect"){if(f.objectAt(b).get("options")){e=30+21*f.objectAt(b).get("options").split("\n").length}else{e=42}}}}return e},updateHeight:function(){var a=this.getPath("content.length");if(!a){return}SC.debug("SectionTableListViewupdateHeight");SC.debug("customRowHeightIndexes:"+a);this.set("customRowHeightIndexes",null);this.set("customRowHeightIndexes",SC.IndexSet.create(0,a))},selectionDidChange:function(){SC.debug("[%@]selectionDidChange".fmt(this.getPath("selection.firstObject.code")));FormDesigner.formController.selectParentField(this);var a=this.getPath("selection.firstObject");if(a){FormDesigner.fieldController.set("content",a)}SC.debug("[%@]selectionDidChange".fmt(this.getPath("selection.firstObject.code")))}.observes(".selection"),computeNowShowing:function(){return this.get("allContentIndexes")}})});FormDesigner.SelectView=SC.SelectView.extend({layout:{height:25},itemTitleKey:"text",itemValueKey:"value",valueBinding:".content.default_value",contentOptionsBinding:".content.options",items:function(){var a=[],b=this.content.get("options");if(b){a.push({value:"",text:"Subform.Message.Select".loc()})}if(SC.instanceOf(b,String)){b.split("\n").forEach(function(h,f,d){var g=false;for(var e=0;e<this.length;e++){if(this[e].value==h){g=true}}if(g==false&&h){this.push({value:h,text:h})}},a)}if(FormDesigner.formController.get("isEditable")==true&&a.length>0){this.set("isEnabled",true)}else{this.set("isEnabled",false)}return a}.property("contentOptions").cacheable(),});FormDesigner.TableView=FormDesigner.SectionView.extend({});FormDesigner.UrlView=SC.TextFieldView.extend({layout:{height:30},classNames:["url"],autoCapitalize:false,isEditableBinding:"FormDesigner.formController.isEditable",valueBinding:".content.default_value"});FormDesigner.UserView=SC.TextFieldView.extend({layout:{height:30},isEditable:false});sc_require("mixins/column");SC.TableColumn=SC.Object.extend(SC.Column,{});SC.BaseTheme.formCheckboxRenderDelegate=SC.RenderDelegate.create({className:"checkbox",render:function(g,b){if(g){this.addSizeClassName(g,b);var f=g.get("theme");var a=g.get("isSelected"),d=g.get("width"),e=SC.guidFor(g)+"-label";b.setClass({active:g.get("isActive"),mixed:g.get("isMixed"),sel:g.get("isSelected"),disabled:!g.get("isEnabled")});b.attr("role","checkbox");b.attr("aria-checked",a);b.attr("aria-labelledby",e);b.attr("aria-disabled",g.get("isEnabled")?"false":"true");if(d){b.css("width",d)}b.begin("span").addClass("button").end();b=b.begin("span").addStyle("padding-left","20px").addClass("sc-button-label").id(e);f.labelRenderDelegate.render(g,b);b=b.end()}else{b.begin("span").removeClass("sc-button-label")}},update:function(g,a){this.updateSizeClassName(g,a);var f=g.get("theme");var b=g.get("isSelected"),d=g.get("width"),e=g.get("value");a.setClass({active:g.get("isActive"),mixed:g.get("isMixed"),sel:g.get("isSelected"),disabled:!g.get("isEnabled")});a.attr("aria-disabled",g.get("isEnabled")?"false":"true");a.attr("aria-checked",b);a.css("width",d?d:null);f.labelRenderDelegate.update(g,a.find(".sc-button-label"))}});SC.BaseTheme.formCheckboxGroupRenderDelegate=SC.RenderDelegate.create({className:"checkbox-group",render:function(j,f){this.addSizeClassName(j,f);var h=j.get("theme"),e=SC.guidFor(this),d=j.get("items"),b,a=d.length,g;f.addClass(j.get("layoutDirection"));f.attr("role","checkboxgroup");f.attr("aria-disabled",j.get("isEnabled")?"false":"true");for(b=0;b<a;b++){g=d[b];f=f.begin("div").addClass("checkbox-"+b).attr("index",b).addClass(h.classNames).addClass(h.formCheckboxRenderDelegate.className).addClass("sc-checkbox-view");h.formCheckboxRenderDelegate.render(g,f);f=f.end()}if(!a){h.formCheckboxRenderDelegate.render(null,f)}j.get("renderState").checkboxCount=b},update:function(a,e){this.updateSizeClassName(a,e);var f=a.get("theme"),b=SC.guidFor(this),h=a.get("items"),j,g=h.length,k;e.addClass(a.get("layoutDirection"));e.attr("aria-disabled",a.get("isEnabled")?"false":"true");if(a.get("renderState").checkboxCount!==g){var d=SC.RenderContext(e[0]);this.render(a,d);d.update();return}for(j=0;j<g;j++){k=h[j];f.formCheckboxRenderDelegate.update(k,e.find(".checkbox-"+j))}},updateCheckboxAtIndex:function(e,a,b){var d=e.get("items")[b];e.get("theme").formCheckboxRenderDelegate.update(d,a.find(".checkbox-"+b))},indexForEvent:function(e,b,a){var d=$(a.target).closest(".sc-checkbox-view").attr("index");if(isNaN(d)){return undefined}return parseInt(d,0)}});FormDesigner.TableDelegate={isTableDelegate:YES,getSortKey:function(h,g){var b=h.get("sort"),a=h.get("key");return g&&h.get("sortServer")?h.get("sortServer"):b?b:a==="heureF"||a==="dateF"||a==="dateTime"?"date":a},tableDidRequestSort:function(m,l,k,j,b){var j=NO,a=this.getSortKey(k);l.set("TABLE_VIEW_ORDER",null);if(SC.kindOf(l,SC.ArrayController)){if(l.get("needSparseArray")){a=this.getSortKey(k,true);j=b===SC.SORT_DIRECTION_ASCENDING?"%@ ASC".fmt(a):b===SC.SORT_DIRECTION_DESCENDING?"%@ DESC".fmt(a):l.ORDER;l.set("TABLE_VIEW_ORDER",j);j=SC.Query.remote(l.MODEL,{controller:l,conditions:l._searchConditions,parameters:l._searchParameters,orderBy:j});l.set("content",GX.store.find(j,"editable"))}else{b===SC.SORT_DIRECTION_ASCENDING?l.set("orderBy","ASC %@".fmt(a)):b===SC.SORT_DIRECTION_DESCENDING?l.set("orderBy","DESC %@".fmt(a)):l.set("orderBy",null)}j=YES}else{if(SC.typeOf(l)===SC.T_ARRAY){l.sortProperty(a+"Sort");b===SC.SORT_DIRECTION_DESCENDING&&l.reverse();m.notifyPropertyChange("content");j=YES}}j&&m.set("sort",{key:k.get("key"),direction:b});return YES},renderTableCellContent:function(k,j,h,b,a){k=h?h.getPath(a.get("key")):null;SC.typeOf(k)===SC.T_STRING&&(k=SC.RenderContext.escapeHTML(k));return j.push('<div class="text">%@</div>'.fmt(k))},mouseDownOnTableRow:function(){},rightClicOnColumnHeader:function(f,b,a){f.openReglageColonne&&f.openReglageColonne(b,a)},rightClicOnTableRow:function(){return NO},beginColumnResizeDrag:function(){},updateColumnResizeDrag:function(a){a.updateColumnsProperties&&a.updateColumnsProperties()},endColumnDrag:function(a){a.updateColumnsProperties&&a.updateColumnsProperties()}};FormDesigner.metrics=SC.Object.create({DOCK_HEIGHT:44,DOCK_HEIGHT_WITH_SHADOW:44,MIN_MESSAGEVIEW_WIDTH:520,DOCK_TOOLBAR_SEPARATOR_HEIGHT:43,CHILD_WINDOW_WIDTH:810,CHILD_WINDOW_HEIGHT:644,MAX_SEARCHFIELD_WIDTH:520,MAX_SOURCELIST_WIDTH:318,FEEDBACK_WIDTH:55,HELP_WIDTH:30,FAQ_WIDTH:25,PIPE1_LEFT:36,FAQ_LEFT:42,PIPE2_LEFT:68,FEEDBACK_LEFT:74,MIN_SOURCELIST_WIDTH:150,DEFAULT_SOURCELIST_WIDTH:225,DEFAULT_MIN_APP_SWITCHER_WIDTH:50});FormDesigner.Button={};FormDesigner.Button.HomeBtn=SC.ButtonView.design(SC.AutoResize,{layout:{left:7,top:7,width:80,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Button.Home".loc(),needsEllipsis:NO,icon:"home-icon",action:function(){alert("please call home function")}});FormDesigner.Alert=CW.Alert.extend(),SC.mixin(FormDesigner.Alert,{infoIconHash:{value:"me-icon-info-68",width:68,height:65},alertIconHash:{value:"me-icon-alert-68",width:68,height:65},sharingIconHash:{value:"admin-icon-sharing",width:68,height:65},alert:function(a){return a.image=this.alertIconHash,this.show(a)},info:function(a){return a.image=this.infoIconHash,this.show(a)},sharing:function(a){return a.image=this.sharingIconHash,this.show(a)}});FormDesigner.FormPropBtnsView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{layout:{top:15,left:0,right:0},verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend(SC.FlowedLayout,{childViews:["othersView","inputTitle","inputView","selectTitle","selectView"],defaultFlowSpacing:{left:28,top:5},layout:{widthBinding:SC.Binding.single(".parentView.frame.width")},viewDidResize:function(){arguments.callee.base.apply(this,arguments);this.adjust("width",this.parentView.frame().width-30)},othersView:SC.View.extend(SC.FlowedLayout,{childViews:["sectionView","tableView"],classNames:["fieldItem"],defaultFlowSpacing:{left:2,bottom:2,top:3,right:10},sectionView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Section".loc(),name:"Field.Section".loc(),type:"section"}),tableView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Table".loc(),name:"Field.Table".loc(),type:"table"})}),inputTitle:SC.DisclosureView.extend({layout:{height:22},value:YES,title:"Disclosure.Input".loc()}),inputView:SC.View.extend(SC.FlowedLayout,{childViews:["inputView","numberView","dateView","dateTiemView","checkboxView","emailView","urlView","passworkView"],classNames:["fieldItem"],isVisibleBinding:".parentView.inputTitle.value",defaultFlowSpacing:{left:2,bottom:2,top:3,right:10},inputView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Input".loc(),name:"Field.Input".loc(),type:"input"}),emailView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Email".loc(),name:"Field.Email".loc(),type:"email"}),checkboxView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Checkbox".loc(),name:"Field.Checkbox".loc(),type:"checkbox"}),urlView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.URL".loc(),name:"Field.URL".loc(),type:"url"}),numberView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Number".loc(),name:"Field.Number".loc(),type:"number"}),passworkView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Password".loc(),name:"Field.Password".loc(),type:"password"}),dateView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Date".loc(),name:"Field.Date".loc(),type:"date"}),dateTiemView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.DateTime".loc(),name:"Field.DateTime".loc(),type:"dateTime"})}),selectTitle:SC.DisclosureView.extend({layout:{height:22},value:YES,title:"Disclosure.Select".loc()}),selectView:SC.View.extend(SC.FlowedLayout,{childViews:["selectView","userView","radioView","groupView","multiSelectView"],classNames:["fieldItem"],isVisibleBinding:".parentView.selectTitle.value",defaultFlowSpacing:{left:2,bottom:2,top:3,right:10},selectView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Select".loc(),name:"Field.Select".loc(),type:"select"}),userView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.User".loc(),name:"Field.User".loc(),type:"user"}),radioView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Radio".loc(),name:"Field.Radio".loc(),type:"radio"}),groupView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Group".loc(),name:"Field.Group".loc(),type:"group"}),multiSelectView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.MultiSelect".loc(),name:"Field.MultiSelect".loc(),type:"multiSelect"}),geolocationView:SC.ButtonView.extend(FormDesigner.DragAppendButtonDelegate,{layout:{width:120,height:30},controlSize:SC.HUGE_CONTROL_SIZE,title:"Field.Geolocation".loc(),name:"Field.Geolocation".loc(),type:"geolocation"})})})});FormDesigner.InfoBasicView=SC.View.extend(SC.FlowedLayout,{classNames:["fieldItem"],layout:{left:0,right:0},childViews:["topLine","code","name","options","default_value","rows","digits","is_required","has_others","is_multiselect","type_text","is_wide","formula","bottomLine","is_list_display","is_searchable"],topLine:SC.View.extend({classNames:"field_top",layout:{height:2},}),code:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Field.Code".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Field.Code".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({layout:{left:15,right:15,top:30,height:24},autoCapitalize:false,valueBinding:"FormDesigner.fieldController.code",field_typeBinding:"FormDesigner.fieldController.type",fieldDidBlur:function(){arguments.callee.base.apply(this,arguments);var b=this.get("value");if(b&&b.indexOf(".")>=0){b=b.replace(/[.]/g,"_");FormDesigner.fieldController.set("code",b);SC.debug("code._")}if(SC.typeOf(b)=="string"&&b!=b.trim()){FormDesigner.fieldController.set("code",b.trim());SC.debug("code")}var a=FormDesigner.fieldListController.fieldsCodeValid(b);if(a==""){this.parentView.$(".warring_icon").remove();console.log("remove");if(b){FormDesigner.fieldController.codeDidChange()}}else{if(this.parentView.$(".warring_icon").length==0){this.parentView.$().append('<div style="right: 12px; width: 16px; top: 4px; height: 16px;position: absolute" class="warring_icon"></div>');console.log("add")}var d=b?"FormDesigner.Field.Property.Error".loc(b):"FormDesigner.Field.CodeNull.Property.Error".loc();navigator.notification.alert(a,function(){},d,"Button.OK".loc())}},valueDidChange:function(){var d=this.get("value"),a=/\\/g;if(a.test(d)){this.set("value",d.replace(a,""))}if(this.get("field_type")=="table"){var b=FormDesigner.formValidController.valid_name(this.get("value"));if(b.is_change){this.set("value",b.value)}}this.invokeLast(function(){FormDesigner.fieldListController.validFormFields()})}.observes("value"),fieldValueDidChange:function(a){var d=this.getFieldValue();var b=this.objectForFieldValue(d,a);arguments.callee.base.apply(this,arguments)}})}),name:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.Name".loc()}),value:SC.TextFieldView.extend({hintOnFocus:NO,layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.name",hintBinding:"FormDesigner.fieldController.code"})}),options:SC.View.extend({classNames:"form_field",layout:{height:110},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Field.Options".loc();a=a.begin("span").addClass("code-title").push(b).end();this.set("value",b)},update:function(b){var a="Field.Options".loc();b.find(".code-title").html(a)}}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:70},hint:"Field.Options.Hint".loc(),validValue:function(){var d=this.get("value");var a="";if(FormDesigner.fieldController){var b=FormDesigner.fieldController.get("type");if(b=="select"||b=="radio"||b=="multiSelect"){a=FormDesigner.fieldListController.optionsValid(d)}}if(this.parentView){if(a==""){this.parentView.$(".warring_icon").remove();console.log("remove")}else{if(this.parentView.$(".warring_icon").length==0){this.parentView.$().append('<div style="right: 70px; width: 16px; top: 4px; height: 16px;position: absolute" class="warring_icon"></div>');console.log("add")}}}},selectFieldChanged:function(){if(FormDesigner.fieldController.get("options")){this.set("value",FormDesigner.fieldController.get("options"))}else{this.set("value","")}}.observes("FormDesigner.fieldController.id"),render:function(a,b){arguments.callee.base.apply(this,arguments);if(b){this.invokeLast(function(){if(FormDesigner.fieldController.get("options")){this.set("value",FormDesigner.fieldController.get("options"))}this.validValue()})}},valueDidChange:function(){this.invokeLast(function(){this.validValue()})}.observes("value"),fieldDidBlur:function(){arguments.callee.base.apply(this,arguments);var f=this.get("value");var d=[];var g="";if(f){d=FormDesigner.fieldController.formatValuesOfOptions(f);if(d.length>0){g=d.join("\n")}}if(d.length>0&&FormDesigner.fieldController.get("default_value")){if(FormDesigner.fieldController.get("type")=="multiSelect"){var e=[];var a=FormDesigner.fieldController.get("default_value").split(",");for(var b=0;b<a.length;b++){if(d.contains(a[b])){e.push(a[b])}}if(e.length>0){FormDesigner.fieldController.set("default_value",e.join(","))}else{FormDesigner.fieldController.set("default_value","")}}else{if(!d.contains(FormDesigner.fieldController.get("default_value"))){FormDesigner.fieldController.set("default_value","")}}}else{if(FormDesigner.fieldController.get("default_value")){FormDesigner.fieldController.set("default_value","")}}if(FormDesigner.fieldController.get("options")!=g){FormDesigner.fieldController.set("options",g)}this.set("value",g);FormDesigner.fieldListController.validFormFields();FormDesigner.fieldListController.updateMainFieldsHeight(YES)}})}),default_value:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.DefaultValue".loc()}),value:SC.TextFieldView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.default_value"})}),rows:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.Rows".loc()}),value:SC.TextFieldView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.rows",validator:"Number"})}),digits:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Field.Digits".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end();this.set("value",b)},update:function(b){var a="Field.Digits".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:CS.NumberView.extend({layout:{left:15,right:15,top:30,height:24},fieldValBinding:"FormDesigner.fieldController.digits",applyImmediately:NO,digits:0,hint:"0",minValue:0,maxValue:10})}),is_multiselect:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.Is_multiselect".loc()}),value:SC.RadioView.extend({layout:{left:15,right:15,top:30,height:24},items:[{title:"Field.UserAndGroup.SelectType.Multiple".loc(),value:YES},{title:"Field.UserAndGroup.SelectType.Single".loc(),value:NO}],itemTitleKey:"title",itemValueKey:"value",valueBinding:"FormDesigner.fieldController.is_multiselect",layoutDirection:SC.LAYOUT_HORIZONTAL})}),is_required:SC.View.extend({classNames:"form_field",layout:{height:35},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?70:85,top:8,height:20},displayProperties:["value"],render:function(a,d){arguments.callee.base.apply(this,arguments);var b="Field.Is_required".loc();a=a.begin("span").addClass("code-title").push(b).end().begin("span").addClass("red-star").end().begin("span");this.set("value",b)},update:function(b){var a="Field.Is_required".loc();b.find(".red-star").html(" *");b.find(".code-title").html(a)}}),value:SC.CheckboxView.extend({layout:{left:SC.buildLocale=="zh-cn"?85:100,right:15,top:8,height:20},valueBinding:"FormDesigner.fieldController.is_required",render:function(a,b){a=a.addStyle("padding-top","5px");arguments.callee.base.apply(this,arguments)}})}),has_others:SC.View.extend({classNames:"form_field",layout:{height:35},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?70:85,top:8,height:20},value:"Field.Has_others".loc()}),value:SC.CheckboxView.extend({layout:{left:SC.buildLocale=="zh-cn"?85:100,right:15,top:8,height:20},valueBinding:"FormDesigner.fieldController.has_others",render:function(a,b){a=a.addStyle("padding-top","5px");arguments.callee.base.apply(this,arguments)}})}),type_text:SC.View.extend({classNames:"form_field",layout:{height:35},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?70:85,top:8,height:20},value:"Field.TypeText".loc()}),value:SC.LabelView.extend({layout:{left:SC.buildLocale=="zh-cn"?85:100,right:15,top:8,height:20},valueBinding:"FormDesigner.fieldController.type_text"})}),is_wide:SC.View.extend({classNames:"form_field",layout:{height:35},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?70:85,top:8,height:20},value:"Field.IsWide".loc()}),value:SC.CheckboxView.extend({layout:{left:SC.buildLocale=="zh-cn"?85:100,right:15,top:8,height:20},valueBinding:"FormDesigner.fieldController.is_wide",render:function(a,b){a=a.addStyle("padding-top","5px");arguments.callee.base.apply(this,arguments)}})}),formula:SC.View.extend({classNames:"form_field",layout:{height:SC.buildLocale=="zh-cn"?150:160},childViews:["title","value","instruction"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.Formula".loc()}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:70},valueBinding:"FormDesigner.fieldController.formula",hint:"Field.Formula.Hint.Value".loc(),validChange:function(){var b=this.get("value");if(!FormDesigner.fieldController.content){return}var a=FormDesigner.fieldListController.hasFormulaFieldValid(FormDesigner.fieldController.content.get("code"),this.value,FormDesigner.fieldListController.toArray());if(a==""){this.parentView.$(".warring_icon").remove();console.log("remove")}else{if(this.parentView.$(".warring_icon").length==0){this.parentView.$().append('<div style="right: 12px; width: 16px; top: 4px; height: 16px;position: absolute" class="warring_icon"></div>');console.log("add")}}this.invokeLast(function(){FormDesigner.fieldListController.validFormFields()})}.observes("value"),fieldDidBlur:function(){arguments.callee.base.apply(this,arguments);var a=this.get("value");if(SC.typeOf(a)=="string"){if(a!=""&&a.trim()==""){a=a.trim();this.set("value","")}}if(a&&a.length>0){FormDesigner.fieldController.addFormula()}else{FormDesigner.fieldController.deleteFormula()}}}),instruction:SC.LabelView.extend({classNames:"instruction",layout:{left:15,right:15,top:110,height:SC.buildLocale=="zh-cn"?40:50},escapeHTML:NO,value:"Field.Formula.Instruction".loc()})}),bottomLine:SC.View.extend({classNames:"field_bottom",layout:{height:2},}),is_list_display:SC.View.extend({classNames:"form_field",layout:{height:35},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?70:85,top:8,height:20},value:"Field.IsListDisplay".loc()}),value:SC.CheckboxView.extend({layout:{left:SC.buildLocale=="zh-cn"?85:100,right:15,top:8,height:20},valueBinding:"FormDesigner.fieldController.is_list_display",render:function(a,b){a=a.addStyle("padding-top","5px");arguments.callee.base.apply(this,arguments)}})}),is_searchable:SC.View.extend({classNames:"form_field",layout:{height:35},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?70:85,top:8,height:20},value:"Field.IsSearchable".loc()}),value:SC.CheckboxView.extend({layout:{left:SC.buildLocale=="zh-cn"?85:100,right:15,top:8,height:20},valueBinding:"FormDesigner.fieldController.is_searchable",render:function(a,b){a=a.addStyle("padding-top","5px");arguments.callee.base.apply(this,arguments)}})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldInputView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","options","is_required","is_wide","is_list_display","is_searchable","is_textarea","type_text","formula","bottomLine",],default_value:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.DefaultValue".loc()}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.default_value",classNames:["form-default-value"],valueDidChange:function(){this.invokeLast(function(){var f=this.$(".field")[0],b=(this.getPath("frame.width")-6),e=this.get("value"),d=24,a;if(f){a=CS.Utils.getHeightByDom(f,b,d,e);this.adjust("height",a);this.parentView.adjust("height",a+40)}})}.observes("value")})}),is_textarea:SC.View.extend({classNames:"form_field",layout:{height:35},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?70:85,top:8,height:20},value:"Field.IsTextArea".loc()}),value:SC.CheckboxView.extend({layout:{left:SC.buildLocale=="zh-cn"?85:100,right:15,top:8,height:20},valueBinding:"FormDesigner.fieldController.is_textarea",render:function(a,b){arguments.callee.base.apply(this,arguments)}})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldEmailView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","is_required","is_wide","is_list_display","is_searchable","type_text","bottomLine"],default_value:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.DefaultValue".loc()}),value:SC.TextFieldView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.default_value",validator:"email",autoCapitalize:false,render:function(b,e){arguments.callee.base.apply(this,arguments);var d=this.get("value");if(d&&d.length>0){var a=FormDesigner.fieldListController.emailValid(this.value);if(a==""){this.parentView.$(".warring_icon").remove()}else{if(this.parentView.$(".warring_icon").length==0){this.parentView.$().append('<div style="right: 12px; width: 16px; top: 4px; height: 16px;position: absolute" class="warring_icon"></div>')}}}else{this.parentView.$(".warring_icon").remove()}FormDesigner.fieldListController.validFormFields()}})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldCheckboxView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","is_wide","is_list_display","is_searchable","type_text","bottomLine"],default_value:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.DefaultValue".loc()}),value:SC.CheckboxView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.getDefault"})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldUrlView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","is_required","is_wide","is_list_display","is_searchable","type_text","bottomLine"],default_value:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.DefaultValue".loc()}),value:SC.TextFieldView.extend({autoCapitalize:false,layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.default_value"})}),})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldNumberView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","digits","default_value","is_required","is_wide","is_list_display","is_searchable","type_text","formula","bottomLine"],default_value:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["titleView","valueView"],titleView:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.DefaultValue".loc()}),valueView:FormDesigner.NumberView.extend({layout:{left:15,right:15,top:30,height:24},fieldValBinding:"FormDesigner.fieldController.default_value",digitsBinding:SC.Binding.oneWay("FormDesigner.fieldController.digits")}),isValidDidChange:function(){var a=this.getPath("valueView.isValid");if(a){this.$(".warring_icon").remove()}else{if(this.$(".warring_icon").length==0){this.$().append('<div style="right: 12px; width: 16px; top: 4px; height: 16px;position: absolute" class="warring_icon"></div>')}}}.observes(".valueView.isValid")})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldPasswordView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","is_required","is_wide","type_text","bottomLine"],default_value:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.DefaultValue".loc()}),value:SC.TextFieldView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.default_value",type:"password"})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldDateView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","is_required","is_wide","is_list_display","is_searchable","type_text","bottomLine"]})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldDateTimeView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","is_required","is_wide","is_list_display","is_searchable","type_text","bottomLine"]})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldSelectView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","options","default_value","is_required","is_wide","is_list_display","is_searchable","type_text","bottomLine"],default_value:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.DefaultValue".loc()}),value:SC.SelectView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.default_value",itemTitleKey:"text",itemValueKey:"value",optionsChanged:function(){var a=[],b=FormDesigner.fieldController.get("options");if(b){a.push({value:"",text:"Subform.Message.Select".loc()})}if(SC.instanceOf(b,String)){b.split("\n").forEach(function(h,f,d){var g=false;for(var e=0;e<this.length;e++){if(this[e].value==h){g=true}}if(g==false&&h){this.push({value:h,text:h})}},a)}this.set("items",a);this.canEditable(a);if(a.length==0){this.set("value","")}}.observes("FormDesigner.fieldController.options"),render:function(d,e){arguments.callee.base.apply(this,arguments);if(e){var a=[],b=FormDesigner.fieldController.get("options");if(b){a.push({value:"",text:"Subform.Message.Select".loc()})}if(SC.instanceOf(b,String)){b.split("\n").forEach(function(k,h,f){var j=false;for(var g=0;g<this.length;g++){if(this[g].value==k){j=true}}if(j==false&&k){this.push({value:k,text:k})}},a)}this.set("items",a);this.canEditable(a)}},canEditable:function(a){if(FormDesigner.formController.get("isEditable")==true&&a.length>0){this.set("isEnabled",true)}else{this.set("isEnabled",false)}}})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldRadioView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","options","default_value","is_required","is_wide","is_list_display","is_searchable","type_text","bottomLine"],default_value:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.DefaultValue".loc()}),value:SC.RadioView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.default_value",height:21,items:[],itemTitleKey:"text",itemValueKey:"value",itemIconKey:"icon",displayProperties:["items"],optionsChanged:function(){var b=[],d=FormDesigner.fieldController.get("options");if(d){b.push({value:"",text:"Field.No.Select".loc()})}if(SC.instanceOf(d,String)){d.split("\n").forEach(function(j,g,e){var h=false;for(var f=0;f<this.length;f++){if(this[f].value==j){h=true}}if(h==false&&j){this.push({value:j,text:j})}},b)}var a=b.length==0?1:b.length;this.adjust("height",a*this.height);if(this.parentView){this.parentView.adjust("height",a*this.height+40)}this.set("items",b);this.invokeLast(function(){var g=this.$(".sc-button-label");if(g&&g.length>0){for(var e=0;e<g.length;e++){oldHtml=this.$(".sc-button-label")[e].innerHTML;var f=oldHtml.replace(/ /g,"&nbsp;");$(this.$(".sc-button-label")[e]).html(f)}}})}.observes("FormDesigner.fieldController.options"),render:function(d,e){if(FormDesigner.fieldController.get("options_items")){var b=[],a=this.get("items");b=FormDesigner.fieldController.get("options_items");if(a.length!=b.length){this.set("items",b)}len=b.length==0?1:a.length;this.adjust("height",len*this.height);if(this.parentView){this.parentView.adjust("height",len*this.height+40)}d=d.addStyle("padding-top","5px")}else{this.adjust("height",0);this.parentView.adjust("height",40)}arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var h=this.$(".sc-button-label");if(h&&h.length>0){h.addClass("radio_title");for(var f=0;f<h.length;f++){oldHtml=this.$(".sc-button-label")[f].innerHTML;var g=oldHtml.replace(/ /g,"&nbsp;");$(this.$(".sc-button-label")[f]).html(g)}}})}})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldGroupView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","is_multiselect","is_required","is_wide","is_list_display","type_text","bottomLine"]})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldMultiSelectView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","options","default_value","is_required","is_wide","is_searchable","type_text","bottomLine"],default_value:SC.View.extend({classNames:"form_field",layout:{height:24},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:24},value:"Field.DefaultValue".loc()}),value:FormDesigner.CheckboxListView.extend({layout:{left:15,right:15,top:24,height:0},valueBinding:"FormDesigner.fieldController.default_value",height:21,classNames:["multiSelect-value"],itemsBinding:"FormDesigner.fieldController.options_items",itemTitleKey:"text",itemValueKey:"value",itemIconKey:"icon",displayProperties:["items"],render:function(d,e){if(FormDesigner.fieldController.get("options_items")){var b=[],a=this.get("items");b=FormDesigner.fieldController.get("options_items");if(a.length!=b.length){this.set("items",b)}len=b.length;this.adjust("height",len*this.height);this.parentView.adjust("height",len*this.height+30);d=d.addStyle("padding-top","5px")}else{this.adjust("height",0);this.parentView.adjust("height",30)}arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var h=this.$(".sc-button-label");if(h&&h.length>0){h.addClass("multiSelect_title");this.$(".multiSelect_title").css("max-width",275);for(var f=0;f<h.length;f++){oldHtml=this.$(".sc-button-label")[f].innerHTML;var g=oldHtml.replace(/ /g,"&nbsp;");$(this.$(".sc-button-label")[f]).html(g)}}})},optionsDidChange:function(){this.invokeLast(function(){var d=this.$(".sc-button-label");if(d&&d.length>0){for(var a=0;a<d.length;a++){oldHtml=this.$(".sc-button-label")[a].innerHTML;var b=oldHtml.replace(/ /g,"&nbsp;");$(this.$(".sc-button-label")[a]).html(b)}}})}.observes("FormDesigner.fieldController.options")})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldUserView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","is_multiselect","is_required","is_wide","is_list_display","is_searchable","type_text","bottomLine"]})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldLabelView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","default_value","is_wide","is_list_display","is_searchable","type_text","formula","bottomLine"],default_value:SC.View.extend({classNames:"form_field",layout:{height:95},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.Text".loc()}),value:SC.TextFieldView.extend({layout:{left:15,right:15,top:30,height:55},valueBinding:"FormDesigner.fieldController.default_value",isTextArea:YES})}),type_text:SC.View.extend({classNames:"form_field",layout:{height:SC.buildLocale=="zh-cn"?70:65},childViews:["title","value","instruction"],title:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?70:85,top:8,height:20},value:"Field.TypeText".loc()}),value:SC.LabelView.extend({layout:{left:SC.buildLocale=="zh-cn"?85:100,right:15,top:8,height:20},valueBinding:"FormDesigner.fieldController.type_text"}),instruction:SC.LabelView.extend({classNames:"instruction",layout:{left:15,right:15,top:28,height:SC.buildLocale=="zh-cn"?40:35},value:"Field.Label.Instruction".loc()})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldSectionView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","type_text","bottomLine",],default_value:SC.View.extend({classNames:"form_field",layout:{height:110},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.Description".loc()}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:70},valueBinding:"FormDesigner.fieldController.description"})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldTableView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","default_value","is_required","type_text","bottomLine",],name:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.Name".loc()}),value:SC.TextFieldView.extend({hintOnFocus:NO,layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.fieldController.name",hintBinding:"FormDesigner.fieldController.code",valueDidChange:function(){var a=FormDesigner.formValidController.valid_name(this.get("value"));if(a.is_change){this.set("value",a.value)}}.observes("value")})}),default_value:SC.View.extend({classNames:"form_field",layout:{height:110},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Field.Description".loc()}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:70},valueBinding:"FormDesigner.fieldController.description"})})})});sc_require("views/detail/mixins/info_basic");FormDesigner.FieldGeolocationView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:FormDesigner.InfoBasicView.extend({childViews:["topLine","code","name","is_required","is_wide","type_text","bottomLine"]})});FormDesigner.FormPropFormView=SC.ScrollView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{layout:{top:0,left:0,right:0},verticalScrollerView:CW.MiniFadingCaplessScrollerView,align:SC.ALIGN_CENTER,contentView:SC.View.extend(SC.FlowedLayout,{classNames:["form-prop-form"],layout:{left:0,top:0,right:0},childViews:["topLine","name","description","form_script","name_forumla","instance_style","category","current_rev","created","current_modified","bottomLine"],topLine:SC.View.extend({classNames:"field_top",layout:{height:2},}),name:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Form.Name".loc()}),value:SC.TextFieldView.extend({layout:{left:15,right:15,top:30,height:24},valueBinding:"FormDesigner.formController.name",valueDidChange:function(){var a=FormDesigner.formValidController.valid_name(this.get("value"));if(a.is_change){this.set("value",a.value)}}.observes("value")})}),description:SC.View.extend({classNames:"form_field",layout:{height:110},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Form.Description".loc()}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:70},valueBinding:"FormDesigner.formController.description",})}),form_script:SC.View.extend({classNames:"form_field",layout:{height:110},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Form.Form_script".loc()}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:70},valueBinding:"FormDesigner.formController*current.form_script"})}),name_forumla:SC.View.extend({classNames:"form_field",layout:{height:110},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Form.name_forumla".loc()}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:70},valueBinding:"FormDesigner.formController*current.name_forumla",})}),help_text:SC.View.extend({classNames:"form_field",layout:{height:110},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,right:15,top:5,height:20},value:"Form.HelpText".loc()}),value:SC.TextFieldView.extend({isTextArea:true,layout:{left:15,right:15,top:30,height:70},valueBinding:"FormDesigner.formController.help_text",})}),current_rev:SC.View.extend({classNames:"form_field",layout:{height:30},childViews:["title","value"],title:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?50:65,top:5,height:20},value:"Form.Rev".loc()}),value:SC.LabelView.extend({layout:{left:SC.buildLocale=="zh-cn"?65:80,right:15,top:5,height:20},valueBinding:"FormDesigner.formController.current_rev"})}),created:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["created","createdBy"],created:SC.LabelView.extend({layout:{left:15,right:15,top:10,height:20},createdBinding:SC.Binding.oneWay("FormDesigner.formController.created"),value:function(){var a="Form.Created.Label".loc();var b=this.get("created");if(b){a+="  "+b.format("yyyy-MM-dd HH:mm:ss")}return a}.property("created").cacheable()}),createdBy:SC.LabelView.extend({layout:{left:15,right:15,top:35,height:24},createdByBinding:SC.Binding.oneWay("FormDesigner.formController.created_by"),value:function(){var b="Form.Created_by.Name".loc();var a=this.get("createdBy");if(a){b+="  "+a.get("name")}return b}.property("createdBy").cacheable()})}),current_modified:SC.View.extend({classNames:"form_field",layout:{height:64},childViews:["modified","modifiedBy"],modified:SC.LabelView.extend({layout:{left:15,right:15,top:10,height:20},value:function(){var a="Form.Modified.Label".loc();if(FormDesigner.formController.get("current")&&FormDesigner.formController.get("current").get("modified")){a+="  "+FormDesigner.formController.get("current").get("modified").format("yyyy-MM-dd HH:mm:ss")}return a}.property().cacheable(),modifiedChange:function(){var a="Form.Modified.Label".loc();if(FormDesigner.formController.get("current")&&FormDesigner.formController.get("current").get("modified")){a+="  "+FormDesigner.formController.get("current").get("modified").format("yyyy-MM-dd HH:mm:ss")}this.set("value",a)}.observes("FormDesigner.formController*current.modified"),}),modifiedBy:SC.LabelView.extend({layout:{left:15,right:15,top:35,height:24},value:function(){var a="Form.Modified.Name".loc();if(FormDesigner.formController.get("current")&&FormDesigner.formController.get("current").get("modified_by")){a+="  "+FormDesigner.formController.get("current").get("modified_by").get("name")}return a}.property().cacheable(),modifiedByChange:function(){var a="Form.Modified.Name".loc();if(FormDesigner.formController.get("current")&&FormDesigner.formController.get("current").get("modified_by")){a+="  "+FormDesigner.formController.get("current").get("modified_by").get("name")}this.set("value",a)}.observes("FormDesigner.formController*current.modified_by"),})}),instance_style:SC.View.extend({classNames:"form_field",layout:{height:30},childViews:["style_label","style_value"],style_label:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?50:65,top:5,height:20},value:"InstanceStyle".loc(),}),style_value:SC.SelectView.extend({layout:{left:SC.buildLocale=="zh-cn"?65:80,right:15,top:5,height:25},itemTitleKey:"name",itemValueKey:"id",items:[{id:"table",name:"InstanceStyleTable".loc()},{id:"default",name:"InstanceStyleDefault".loc()}],render:function(a,b){arguments.callee.base.apply(this,arguments);that=this;this.invokeLast(function(){if(FormDesigner.formController.get("instance_style")){that.set("value",FormDesigner.formController.get("instance_style"))}else{that.set("value",null)}})},displaySelectedItem:function(){arguments.callee.base.apply(this,arguments);var a=null;if(FormDesigner.formController.get("instance_style")){a=FormDesigner.formController.get("instance_style")}if(a!=this.get("value")){FormDesigner.formController.set("instance_style",this.get("value"))}},})}),category:SC.View.extend({classNames:"form_field",layout:{height:30},childViews:["catLabel","catValue"],catLabel:SC.LabelView.extend({layout:{left:15,width:SC.buildLocale=="zh-cn"?50:65,top:5,height:20},value:"Category".loc(),}),catValue:SC.SelectView.extend({layout:{left:SC.buildLocale=="zh-cn"?65:80,right:15,top:5,height:25},itemTitleKey:"name",itemValueKey:"id",itemsBinding:"FormDesigner.categoriesController.content",render:function(a,b){arguments.callee.base.apply(this,arguments);if(b){that=this;this.invokeLast(function(){if(FormDesigner.formController.get("category")){that.set("value",FormDesigner.formController.get("category").get("id"))}else{that.set("value",null)}})}},displaySelectedItem:function(){arguments.callee.base.apply(this,arguments);var b=null;if(FormDesigner.formController.get("category")){b=FormDesigner.formController.get("category").get("id")}if(b!=this.get("value")){var d,a=CS.store;if(a){d=CS.store.find(CS.Category,this.get("value"));FormDesigner.formController.set("category",d)}}},})}),bottomLine:SC.View.extend({classNames:"field_bottom",layout:{height:2},}),render:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var b=this.getPath("parentView.parentView.parentView.parentView.parentView.parentView.parentView"),a=b?b.get("isEditable"):NO;if(!a){this.setContentViewReadOnly()}},this)},setContentViewReadOnly:function(){var a=this.get("childViews");a.forEach(function(b){var d=b.get("childViews").objectAt(1);if(d){this.setValueViewReadOny(d)}},this)},setValueViewReadOny:function(a){a.set("isEditable",NO);a.set("mouseDown",null);a.set("touchStart",null);var b=a.get("childViews");b.forEach(function(d){this.setValueViewReadOny(d)},this)}})});sc_require("views/detail/mixins/input");sc_require("views/detail/mixins/email");sc_require("views/detail/mixins/checkbox");sc_require("views/detail/mixins/url");sc_require("views/detail/mixins/number");sc_require("views/detail/mixins/password");sc_require("views/detail/mixins/date");sc_require("views/detail/mixins/dateTime");sc_require("views/detail/mixins/select");sc_require("views/detail/mixins/radio");sc_require("views/detail/mixins/group");sc_require("views/detail/mixins/multiSelect");sc_require("views/detail/mixins/user");sc_require("views/detail/mixins/label");sc_require("views/detail/mixins/section");sc_require("views/detail/mixins/table");sc_require("views/detail/mixins/geolocation");sc_require("views/detail/form_prop_form");FormDesigner.FormPropFieldView=SC.ScrollView.extend({layout:{top:15,left:0,right:0},contentView:SC.ContainerView.extend({layout:{left:0,right:0,top:15},nowShowingBinding:"FormDesigner.fieldController.nowShowing",emptyView:SC.LabelView.extend(SC.AutoResize,{controlSize:SC.LARGE_CONTROL_SIZE,layout:{centerX:0,centerY:0,height:24,width:150},value:"Field.Null.Message".loc(),supportsAutoResize:YES,autoResizeLayer:function(){return this.get("layer")}.property("layer"),autoResizeText:function(){return this.get("value")}.property("value")}),formInfoView:FormDesigner.FormPropFormView.extend(),inputView:FormDesigner.FieldInputView.extend(),emailView:FormDesigner.FieldEmailView.extend(),checkboxView:FormDesigner.FieldCheckboxView.extend(),urlView:FormDesigner.FieldUrlView.extend(),numberView:FormDesigner.FieldNumberView.extend(),passwordView:FormDesigner.FieldPasswordView.extend(),dateView:FormDesigner.FieldDateView.extend(),dateTimeView:FormDesigner.FieldDateTimeView.extend(),selectView:FormDesigner.FieldSelectView.extend(),radioView:FormDesigner.FieldRadioView.extend(),groupView:FormDesigner.FieldGroupView.extend(),multiSelectView:FormDesigner.FieldMultiSelectView.extend(),userView:FormDesigner.FieldUserView.extend(),labelView:FormDesigner.FieldLabelView.extend(),tableView:FormDesigner.FieldTableView.extend(),sectionView:FormDesigner.FieldSectionView.extend(),geolocationView:FormDesigner.FieldGeolocationView.extend(),nowShowingDidChange:function(){arguments.callee.base.apply(this,arguments);this.invokeLast(function(){var b=this.getPath("parentView.parentView.parentView.parentView"),a=b?b.get("isEditable"):NO;if(!a){this.setContentViewReadOnly()}},this)},setContentViewReadOnly:function(){var a=this.getPath("contentView.contentView");if(!a){return}var b=a.get("childViews");b.forEach(function(d){var e=d.get("childViews").objectAt(1);if(e){this.setValueViewReadOny(e)}},this)},setValueViewReadOny:function(a){a.set("isEditable",NO);a.set("mouseDown",null);a.set("touchStart",null);var b=a.get("childViews");b.forEach(function(d){this.setValueViewReadOny(d)},this)}})});sc_require("views/detail/form_prop_field");sc_require("views/detail/form_prop_form");sc_require("views/detail/form_prop_btns");FormDesigner.FormPropertyView=SC.View.extend({classNames:"form_property_back",childViews:["formTabView"],contentBinding:"FlowDesigner.FlowController",formTabView:SC.TabView.extend({layout:{top:10,bottom:10,left:10,right:10},itemTitleKey:"title",itemValueKey:"value",classNames:"formTabView",nowShowingBinding:"FormDesigner.formController.nowShowing",isEditableBinding:".parentView.parentView.isEditable",items:function(){var a=[{title:"Button.AddFields".loc(),value:"FormDesigner.FormPropBtnsView"},{title:"Button.FieldProperty".loc(),value:"FormDesigner.FormPropFieldView"}];if(this.get("isEditable")){return a}else{return a.removeAt(1)}}.property("isEditable")})});sc_require("mixins/field_item_view/checkbox_view");sc_require("mixins/field_item_view/date_time_view");sc_require("mixins/field_item_view/date_view");sc_require("mixins/field_item_view/email_view");sc_require("mixins/field_item_view/group_view");sc_require("mixins/field_item_view/input_view");sc_require("mixins/field_item_view/label_view");sc_require("mixins/field_item_view/multi_select_view");sc_require("mixins/field_item_view/number_view");sc_require("mixins/field_item_view/password_view");sc_require("mixins/field_item_view/radio_view");sc_require("mixins/field_item_view/section_view");sc_require("mixins/field_item_view/select_view");sc_require("mixins/field_item_view/table_view");sc_require("mixins/field_item_view/url_view");sc_require("mixins/field_item_view/user_view");sc_require("mixins/field_item_view/geolocation_view");FormDesigner.FormDesignerItemView=SC.View.extend(SC.Control,{isEditable:YES,typeBinding:".content.type",isWideBinding:".content.is_wide",classNames:["form-designer-item-view"],classNameBindings:["type"],childViews:["titleView","fieldView"],action:function(a){FormDesigner.formController.set("nowShowing","FormDesigner.FormPropFieldView")},titleView:SC.View.extend({classNames:["item-title-view"],layout:{left:20,right:20,height:24},childViews:["labelView","errorView","buttonView"],labelView:SC.LabelView.extend({layout:{top:4,height:24,right:40},valueBinding:".parentView.parentView.content.code",requiredBinding:".parentView.parentView.content.is_required",displayProperties:["required"],render:function(a,d){var b="";if(this.get("value")){b=this.get("value")}a=a.begin("div").begin("span").addClass("title").push(b).end().begin("span").addClass("required").end().end();arguments.callee.base.apply(this,arguments);this.notifyPropertyChange("required");this.invokeLast(function(){var e=this.getPath("parentView.parentView.content.code");if(e){fieldValue=e}this.set("value",e)})},update:function(b){if(this.get("required")){b.find(".required").html(" *")}else{b.find(".required").html("")}var a=this.getPath("parentView.parentView");if(a){if(a.get("isWide")){if(a.get("type")==="section"||a.get("type")==="table"){b.find(".title").css("max-width",471)}else{b.find(".title").css("max-width",391)}}else{b.find(".title").css("max-width",171)}}b.find(".title").html(this.get("value"))}}),errorView:SC.ImageButtonView.extend({layout:{top:4,right:20,width:16,height:16},image:"field_warn_image",valueBinding:".parentView.parentView.content.default_value",codeBinding:".parentView.parentView.content.code",optionsBinding:".parentView.parentView.content.options",fieldIdBinding:"FormDesigner.fieldController*content.id",isVisible:function(){SC.debug("FormDesignerItemView.errorView.isVisible,fieldCode:"+this.get("code"));var b=this.getPath("parentView.parentView.content"),a=NO;if(b){var d=FormDesigner.fieldController.fieldErrorImagValid(b);a=(d=="")?NO:YES}return a}.property("code","value","options","fieldId").cacheable()}),buttonView:SC.ImageButtonView.extend({isVisibleBinding:".parentView.parentView.isEditable",layout:{top:4,right:0,width:16,height:16},image:"field_delete_image",action:function(){var f=this.getPath("parentView.parentView.content");var b=this.getPath("parentView.parentView.parentView.content");if(!FormDesigner.fieldController.deleteField(f)){return}var d=f.getPath("parent.parent"),a=["section","type"].contains(d.get("type"));b.removeObject(f);var g=FormDesigner.formController.get("space").get("id");var e=FormDesigner.formController.get("id");FormDesigner.fieldController.delete_Permissions(f.get("code"),FormDesigner.fieldController.getFlowsByForm(g,e));this.invokeLast(function(){FormDesigner.fieldListController.validFormFields();FormDesigner.fieldListController.updateMainFieldsHeight(YES);if(a){FormDesigner.fieldListController.selectObject(d)}},this)}})}),fieldView:SC.View.extend({classNames:["item-field-view"],layout:{left:20,right:20,top:24},contentBinding:".parentView.content",createChildViews:function(){var f=[];var d=this.getPath("parentView.content");var b=d.get("type");var a=this.getFieldViewClassByType(b);var e=this.createChildView(a.extend({content:d}));f.push(e);this.set("childViews",f)},getFieldViewClassByType:function(d){var b;var a={mouseDown:function(){arguments.callee.base.apply(this,arguments);var f=this.getPath("parentView.parentView.parentView"),h=this.getPath("parentView.parentView");if(!h.isSelected){var g=f.get("content"),j=h.get("content");var e=g.indexOf(j);f.select(e)}return YES},touchStart:function(){arguments.callee.base.apply(this,arguments);this.mouseDown()}};switch(d){case"checkbox":b=FormDesigner.CheckboxView.extend(a);break;case"dateTime":b=FormDesigner.DateTimeView.extend(a);break;case"date":b=FormDesigner.DateView.extend(a);break;case"email":b=FormDesigner.EmailView.extend(a);break;case"group":b=FormDesigner.GroupView.extend(a);break;case"input":b=FormDesigner.InputView.extend(a);break;case"multiSelect":b=FormDesigner.MultiSelectView.extend(a);break;case"number":b=FormDesigner.NumberView.extend(a);break;case"password":b=FormDesigner.PasswordView.extend(a);break;case"radio":b=FormDesigner.RadioView.extend(a);break;case"section":b=FormDesigner.SectionView.extend();break;case"select":b=FormDesigner.SelectView.extend(a);break;case"table":b=FormDesigner.TableView.extend();break;case"url":b=FormDesigner.UrlView.extend(a);break;case"user":b=FormDesigner.UserView.extend(a);break;case"geolocation":b=FormDesigner.GeolocationView.extend(a);break;default:b=SC.View.extend(a);break}return b}}),iswideChange:function(){SC.debug("FormDesignerItemViewiswideChange:"+this.getPath("content.code"));if(this.titleView&&this.fieldView){if(this.get("isWide")){if(this.get("type")==="section"||this.get("type")==="table"){this.titleView.adjust("width",520);this.fieldView.adjust("width",520)}else{this.titleView.adjust("width",440);this.fieldView.adjust("width",440)}}else{this.titleView.adjust("width",220);this.fieldView.adjust("width",220)}this.titleView.labelView.notifyPropertyChange("required")}}.observes("isWide"),mouseEntered:function(){this.$().addClass("mouse_on_button")},mouseExited:function(){this.$().removeClass("mouse_on_button")}});sc_require("views/FormDesignerItemView");FormDesigner.FormDesignerView=SC.View.extend({classNames:["form-designer-view"],childViews:["headerView","hintView","contentView"],init:function(){arguments.callee.base.apply(this,arguments);FormDesigner.formController.formDesignerView=this},headerView:SC.View.extend({classNames:["form-designer-header-view"],sel:NO,isHeader:YES,classNameBindings:["sel"],layout:{top:0,height:54},childViews:["titleView","descriptionView"],titleView:SC.LabelView.extend({layout:{left:8,right:8,top:0,height:24},isEditable:YES,classNames:["header-title-view"],valueBinding:"FormDesigner.formController.name"}),descriptionView:SC.LabelView.extend({layout:{left:8,right:8,top:24,height:24},isEditable:YES,classNames:["header-description-view"],valueBinding:"FormDesigner.formController.description"}),mouseDown:function(a){SC.debug("mouseDown");FormDesigner.formController.clearAllSel(this);this.set("sel",YES);if(a.clickCount==2){FormDesigner.formController.set("nowShowing","FormDesigner.FormPropFieldView")}SC.debug("mouseDown");return NO},touchStart:function(){return this.mouseDown()}}),hintView:SC.LabelView.extend({value:"Field.Add.Reminder".loc(),layout:{top:62,height:24,left:10},classNames:["add-fields-reminder"],fieldsLengthBinding:SC.Binding.oneWay("FormDesigner.fieldListController*content.length"),isVisible:function(){var a=this.get("fieldsLength");if(a&&a>0){return NO}else{return YES}}.property("fieldsLength").cacheable()}),contentView:SC.ListView.extend({classNames:["form-designer-content-view"],layout:{top:62},isMainField:YES,contentBinding:"FormDesigner.fieldListController.content",selectionBinding:"FormDesigner.fieldListController.selection",canDeleteContentBinding:"FormDesigner.formController.isEditable",canEditContentBinding:"FormDesigner.formController.isEditable",canReorderContentBinding:"FormDesigner.formController.isEditable",listViewLotalHeight:0,heightHasUpdated:false,createItemView:function(d,a,b){SC.debug("ListViewcreateItemView,idx:"+a);return FormDesigner.FormDesignerItemView.create(b)},deleteSelection:function(){arguments.callee.base.apply(this,arguments);SC.debug("ListViewdeleteSelection");this.updateHeight(YES);this.invokeLast(function(){FormDesigner.fieldListController.validFormFields()},this)},dragExited:function(){arguments.callee.base.apply(this,arguments);SC.debug("ListViewdragExited");this.updateHeight(YES)},contentIndexRowHeight:function(b,h,d){SC.debug("ListViewcontentIndexRowHeight");SC.debug("fieldIndex:"+d);var g=60;if(h.objectAt(d)){var f=h.objectAt(d).get("type");if(f==="radio"){if(h.objectAt(d).get("options")){g=45+21*h.objectAt(d).get("options").split("\n").length}else{g=45}}else{if(f==="multiSelect"){if(h.objectAt(d).get("options")){g=30+21*h.objectAt(d).get("options").split("\n").length}else{g=42}}else{if(f==="section"||f==="table"){var a=h.objectAt(d).get("fields"),e=24+24+10;if(a.length()){a.forEach(function(k){var j=k.get("type");if(j==="radio"){if(k.get("options")){e+=45+21*k.get("options").split("\n").length}else{e+=45}}else{if(j==="multiSelect"){if(k.get("options")){e+=30+21*k.get("options").split("\n").length}else{e+=42}}else{e+=60}}})}else{e=60}g=e}}}}this.set("listViewLotalHeight",this.get("listViewLotalHeight")+g);return g},updateHeight:function(b){var a=this.getPath("content.length");SC.debug("ListViewupdateHeight");SC.debug("customRowHeightIndexes:"+a);this.set("listViewLotalHeight",0);this.set("customRowHeightIndexes",null);this.set("customRowHeightIndexes",SC.IndexSet.create(0,a));this.invokeLast(function(){if(b){FormDesigner.fieldListController.updateAllSubFieldsHeight()}this.invokeLast(function(){SC.debug("parentView");var d=this.getPath("parentView.parentView");if(d){d.adjust("height",(this.get("listViewLotalHeight")+62))}})})},selectionDidChange:function(){SC.debug("[%@]selectionDidChange".fmt(this.getPath("selection.firstObject.code")));FormDesigner.formController.clearAllSel(this);var a=this.getPath("selection.firstObject");if(!FormDesigner.formController.get("isSelectingParentField")){FormDesigner.fieldController.set("content",a)}FormDesigner.formController.set("isSelectingParentField",NO);SC.debug("[%@]selectionDidChange".fmt(this.getPath("selection.firstObject.code")))}.observes(".selection"),computeNowShowing:function(){return this.get("allContentIndexes")}})});sc_require("views/FormDesignerView");FormDesigner.FormCanvasView=SC.ScrollView.extend(CW.MiniFadingCaplessScrollerViewSupport,{verticalScrollerView:CW.MiniFadingCaplessScrollerView,horizontalScrollerView:CW.MiniFadingCaplessScrollerView,contentView:SC.View.extend({layout:{centerX:0,width:600,height:300},backgroundColor:"#fff",childViews:["designerView"],designerView:FormDesigner.FormDesignerView.extend({}),frameDidChange:function(){var a=this.getPath("parentView.frame.height");if(a&&this.getPath("frame.height")<a){this.adjust("height",a)}}.observes(".frame")})});sc_require("views/form_canvas");sc_require("views/detail/form_property");FormDesigner.DesignerView=SC.View.extend({isEditable:YES,errorMessage:"",render:function(a,b){SC.debug("FormDesigner.DesignerView.render");arguments.callee.base.apply(this,arguments);if(!b){}this.invokeLast(function(){FormDesigner.formController.set("isEditable",this.get("isEditable"));FormDesigner.formValidController.bind("errorMessage",this,"errorMessage");FormDesigner.formController.set("content",this.get("content"));var d=this.get("addFieldDelegate");if(SC.instanceOf(d,Function)){FormDesigner.fieldListController.set("addFieldDelegate",d)}if(SC.instanceOf(this.get("getFlowsByForm"),Function)){FormDesigner.fieldController.set("getFlowsByForm",this.get("getFlowsByForm"))}this.invokeLast(function(){FormDesigner.fieldListController.updateMainFieldsHeight(YES)})})},classNames:["form-designer-designer-view"],layout:{top:0,bottom:0,left:0,right:0},childViews:["formCanvasView","formPropertyView"],formCanvasView:SC.View.design({classNames:["form-canvas-view"],layout:{top:0,bottom:0,left:0,right:361},childViews:["canvasView"],canvasView:FormDesigner.FormCanvasView.design({layout:{top:0,bottom:0,left:0,right:0},})}),formPropertyView:FormDesigner.FormPropertyView.design({classNames:["form-property-view"],layout:{top:0,bottom:0,width:360,right:0}}),clearController:function(){SC.debug("FormDesigner.DesignerView.clearController");FormDesigner.formController.set("nowShowing","FormDesigner.FormPropFieldView");FormDesigner.fieldListController.set("selection",null);FormDesigner.fieldListController.set("content",null);FormDesigner.fieldController.set("content",null);FormDesigner.formController.set("content",null);FormDesigner.formValidController.set("errorMessage",null);return YES}});SC.metricsFor("en-us",{"PhotoPicker.picker.height":261});SC.stringsFor("en-us",{"Designer.title":"Workflow Designer","Designer.workflow":"Workflow","Designer.form":"Form","Designer.close":"Close","Admin.FirstRun.PhotoIcon.AddPhoto":"Add Photo","Admin.FirstRun.PhotoIcon.EditPhoto":"Edit Photo","Admin.FirstRun.PhotoIcon.AddLogo":"Add Logo","Admin.FirstRun.PhotoIcon.EditLogo":"Edit Logo","Button.Steedos":"SteedOS","Button.Setting":"Settings","Button.Add":"Add","Button.Cancel":"Cancel","Button.ClearAll":"Clear All","Button.Delete":"Delete","Button.Details":"Details","Button.Done":"Done","Button.DontJoin":"Don't Join","Button.Edit":"Edit","Button.OK":"OK","Button.Report":"Report","Button.Save":"Save","Button.Back":"Back","Button.Yes":"Yes","Button.No":"No","Button.Transfer":"Move","Button.Close":"Close","Button.ReEnter":"Re-Enter","Button.GotoUUFlow":"GO TO UUFlow","Button.QuickGuid":"Quick Guide","Button.DontSave":"Discard Changes","Button.Save.Success":"Save Succed","Delete Failed":"Delete failed","Data.Modified.Message":"Data has been modified, do you want to discard these changes?","Data.Had.Modified":"Data has been modifieddo you want to save?","Dialog.ServerErrorReport.Text":"Send us diagnosis and using information about SteedOS, help us improve our products.","Dialog.ServerErrorReport.Title":"Error report.","Organization.Title":"Department","Organization.Name":"Department Name","Organization.Children":"Sub-Departments","Organization.Button.Add":"Add Department ...","Organization.Button.Add.Children":"Add Sub-Department ...","Organization.Users":"Users","Organization.Button.Delete":"Delete Department","Organization.Delete.Confirm":"Department will be permanently deleted. \nYou cannot undo this operation.","Organization.New":"New Department","Organization.Parent":"Belongs to","Organization.FullName":"Department full path","Organization.Move.ChildOrg.Remind":"%@ cannot be moved.","Organization.List.Footer":"Department cannot be deleted while has invited users or Sub-Departments.","Click.Change.Parent.Organization":"Click the bar to move department.","Organization.Move.Exist.Remind":"%@ is already in %@, cannot move!","Organization.Move.Remind":"Are you sure you want to move %@ to %@?","Organization.Move.Unable":"Cannot move","Organization.Move.Title":"Move Dept.","Organization.Move.Self":"Cannot move the department to itself.","Organization.Move.SelectOrg.Remind":"You havent chosen any department.","Organization.NameCanNotBlank":"Department name is required.","Organization.Change.Success":"Successfully updated.","Organization.HasChildOrg":"Department cannot be deleted while has Sub-Departments.","Organization.hasUser":"Department cannot be deleted while has invited users.","Organization.UseInFlow":"Department cannot be deleted while referred in following processes:","Organization.InputOrganizationName":"Please enter a organization name","InviteUser.Success.Description":"Please ask your invitees to check the invitation mail (including junk mail folder).","InviteUser.Success.Text":"Invite success","InviteUser.Twice.Title":"Invited once again","Dialog.Error.Title.Multiple.Organization.DESTROY":"Cannot delete this department.","Dialog.Error.Text.Multiple.Organization.DESTROY":"Server Error! Failed to delete this department. Please try again.","Dialog.Error.Text.Multiple.Organization.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this department.","Dialog.Error.Text.Multiple.Organization.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this department. Please try again.","Dialog.Error.Text.Multiple.Organization.DESTROY.ERROR_DATA":"Failed to delete this department.","Dialog.Error.Title.Organization.INVITE_USER":"Cannot invite this user.","Dialog.Error.Text.Organization.INVITE_USER":"Failed to invite this user, please try again.","Dialog.Error.Text.Organization.INVITE_USER.SPACE_FULL_IS_NOT_PAID":"The space reached the maximum number of members. You can upgrade to get more members.","Dialog.Error.Text.Organization.INVITE_USER.SPACE_FULL_IS_PAID":"The space reached the maximum number of members. You can upgrade to get more members.","Dialog.Error.Title.Organization.MOVE_USER":"Cannot move %@.","Dialog.Error.Text.Organization.MOVE_USER":"Failed to move this user, please try again.","Dialog.Error.Title.Organization.CREATE":"Cannot create %@.","Dialog.Error.Text.Organization.CREATE":"Server Error! Failed to create a department. Please try again.","Dialog.Error.Text.Organization.CREATE.ERROR_EXCEPTION":"Server Error! Failed to create a department. Please try again.","Dialog.Error.Text.Organization.CREATE.NOT_FOUND":"Failed to create a department. Failed to find its parent department.","Dialog.Error.Text.Organization.CREATE.NOT_AUTHORIZED":"Sorry, you have no permission to create a department.","Dialog.Error.Text.Organization.CREATE.ERROR_DATA":"Failed to create a department.","Dialog.Error.Title.Organization.UPDATE":"Cannot save the changes to %@.","Dialog.Error.Text.Organization.UPDATE":"Server Error! Failed to update this department. Please try again.","Dialog.Error.Text.Organization.UPDATE.CONFLICT":"Failed to save your changes, because it has been updated by another device.","Dialog.Error.Text.Organization.UPDATE.NOT_FOUND":"Failed to save your changes, because it has been deleted by another device.","Dialog.Error.Text.Organization.UPDATE.NOT_AUTHORIZED":"Sorry, you have no permission to update a department.","Dialog.Error.Text.Organization.UPDATE.ERROR_EXCEPTION":"Server Error! Failed to update this department.","Dialog.Error.Text.Organization.UPDATE.ERROR_DATA":"Failed to update this department.","Dialog.Error.Title.Organization.DESTROY":"Cannot delete %@.","Dialog.Error.Text.Organization.DESTROY":"Server Error! Failed to delete this department. Please try again.","Dialog.Error.Text.Organization.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this department. Please try again.","Dialog.Error.Text.Organization.DESTROY.CONFLICT":"Failed to delete this department, because it has been updated by another device.","Dialog.Error.Text.Organization.DESTROY.NOT_FOUND":"Failed to delete this department, because it has been deleted by another device.","Dialog.Error.Text.Organization.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this department.","Dialog.Error.Text.Organization.DESTROY.ERROR_DATA":"Failed to delete this department.","Role.Title":"Roles","Role.Delete.Confirm":"This role will be permanently deleted.You cannot undo this operation.","Role.Manage":"Role Management","Role.InUse":"Role cannot be deleted while is referred in a workflow process.","Role.List.Header":"Role List","Role.List.Footer":"A role is a class of users who perform the same type of work.\nReferencing roles in a workflow process allows you to easily change the user in that role without modifying the workflow rule.","Role.Button.Add":"Add Role ...","Role.Name":"Role Name","Role.Button.Delete":"Delete Role","Role.New":"New Role","Role.CanNot.Delete":"Role cannot be deleted while it is referred in a workflow process.","Role.Number":"Users","Role.InputRoleName":"Please enter a role name","Dialog.Error.Title.Multiple.Role.DESTROY":"Cannot delete this role.","Dialog.Error.Text.Multiple.Role.DESTROY":"Server Error! Failed to delete this role. Please try again.","Dialog.Error.Text.Multiple.Role.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this role. Please try again.","Dialog.Error.Text.Multiple.Role.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this role.","Dialog.Error.Text.Multiple.Role.DESTROY.ERROR_DATA":"Failed to delete this role.","Dialog.Error.Title.Role.CREATE":"Cannot create %@.","Dialog.Error.Text.Role.CREATE":"Server Error! Failed to create a role. Please try again.","Dialog.Error.Text.Role.CREATE.ERROR_EXCEPTION":"Server Error! Failed to create a role. Please try again.","Dialog.Error.Text.Role.CREATE.NOT_FOUND":"Failed to create a role. Failed to find the role list.","Dialog.Error.Text.Role.CREATE.NOT_AUTHORIZED":"Sorry, you have no permission to create a role.","Dialog.Error.Text.Role.CREATE.ERROR_DATA":"Failed to create a role.","Dialog.Error.Title.Role.UPDATE":"Cannot save the changes to %@.","Dialog.Error.Text.Role.UPDATE":"Server Error! Failed to update this role. Please try again.","Dialog.Error.Text.Role.UPDATE.CONFLICT":"Failed to save your changes, because it has been updated by another device.","Dialog.Error.Text.Role.UPDATE.NOT_FOUND":"Failed to save your changes, because it has been deleted by another device.","Dialog.Error.Text.Role.UPDATE.NOT_AUTHORIZED":"Sorry, you have no permission to update this role.","Dialog.Error.Text.Role.UPDATE.ERROR_EXCEPTION":"Server Error! Failed to update this role","Dialog.Error.Text.Role.UPDATE.ERROR_DATA":"Failed to update this role.","Dialog.Error.Title.Role.DESTROY":"Cannot delete %@.","Dialog.Error.Text.Role.DESTROY":"Server Error! Failed to delete this role. Please try again.","Dialog.Error.Text.Role.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this role. Please try again.","Dialog.Error.Text.Role.DESTROY.CONFLICT":"Failed to delete this role, because it has been updated by another device.","Dialog.Error.Text.Role.DESTROY.NOT_FOUND":"Failed to delete this role, because it has been deleted by another device.","Dialog.Error.Text.Role.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this role.","Dialog.Error.Text.Role.DESTROY.ERROR_DATA":"Failed to delete this role.","Position.Title":"Role Route Control","Position.List.Header":"List","Position.Button.Add":"Add Route Control ...","Position.Edit":"Edit","Position.User":"User","Position.Organization":"In charge of","Position.Button.Delete":"Delete Route Control","Position.Delete.Confirm":"This Route Control will be permanently deleted. You cannot undo this operation.","Position.Back":"Detail of Role","Position.User.Label":"User:","Position.User.Hint":"Click here to select user","Position.SignatrueAuthority.Label":"In charge of:","Position.UserAndOrg.Title":"Route Control needs you assign a person to this role, and determine a department he/she is in charge of.\n\nFor example, suppose a role named manager is assigned to manager approval step.\n Now Jack in HR Dept. submits a request, then Route Control will select Rose (manager of HR) to work on this step.","Dialog.Error.Title.Multiple.Position.DESTROY":"Cannot delete the Route Control","Dialog.Error.Text.Multiple.Position.DESTROY":"Server Error! Failed to delete this Route Control. Please try again.","Dialog.Error.Text.Multiple.Position.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this Route Control. Please try again.","Dialog.Error.Text.Multiple.Position.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this Route Control.","Dialog.Error.Text.Multiple.Position.DESTROY.ERROR_DATA":"Failed to delete this Route Control.","Dialog.Error.Title.Position.CREATE":"Cannot create %@.","Dialog.Error.Text.Position.CREATE":"Server Error! Failed to create a Route Control. Please try again.","Dialog.Error.Text.Position.CREATE.ERROR_EXCEPTION":"Server Error! Failed to create a Route Control. Please try again.","Dialog.Error.Text.Position.CREATE.NOT_FOUND":"Failed to create a Route Control. Failed to find the Route Control list.","Dialog.Error.Text.Position.CREATE.NOT_AUTHORIZED":"Sorry, you have no permission to create a Route Control.","Dialog.Error.Text.Position.CREATE.ERROR_DATA":"Failed to create a Route Control.","Dialog.Error.Title.Position.UPDATE":"Cannot save the changes to %@.","Dialog.Error.Text.Position.UPDATE":"Server Error! Failed to update this Route Control. Please try again.","Dialog.Error.Text.Position.UPDATE.ERROR_EXCEPTION":"Server Error! Failed to update this Route Control. Please try again.","Dialog.Error.Text.Position.UPDATE.CONFLICT":"Failed to update this Route Control, because it has been updated by another device.","Dialog.Error.Text.Position.UPDATE.NOT_FOUND":"Failed to update this Route Control, because it has been deleted by another device.","Dialog.Error.Text.Position.UPDATE.NOT_AUTHORIZED":"Sorry, you have no permission to update this Route Control.","Dialog.Error.Text.Position.UPDATE.ERROR_DATA":"Failed to update this Route Control.","Dialog.Error.Title.Position.DESTROY":"Cannot delete %@.","Dialog.Error.Text.Position.DESTROY.ERROR_DATA":"Server Error! Failed to delete this Route Control. Please try again.","Dialog.Error.Text.Position.DESTROY":"Server Error! Failed to delete this Route Control. Please try again.","Dialog.Error.Text.Position.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this Route Control. Please try again.","Dialog.Error.Text.Position.DESTROY.CONFLICT":"Failed to delete this Route Control, because it has been updated by another device.","Dialog.Error.Text.Position.DESTROY.NOT_FOUND":"Failed to delete this Route Control, because it has been deleted by another device.","Dialog.Error.Text.Position.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this Route Control.","Form.Title":"Form","Form.Name":"Form Name","Form.List.Header":"Form List","Subform.List.Header":"Subform List","Form.Button.Add":"Add Form ...","Form.Button.Addition":"Add Form","Form.Button.Add.Empty":"Create a blank Form ...","Form.Button.Add.Template":"Create a Form from templates...","Form.Template.None":"No Template Form","Form.Add.Form.Template.Tip":"Select a template to duplicate","Form.Button.View":"View Form","Subform.Button.Add":"Add Subform ...","Form.State.Enabled":"Enabled","Form.State.Disabled":"Disabled","Form.EnabledForms":"Enabled Forms","Form.DisabledForms":"Disabled Forms","Form.NO":"No Form","Form.State.Footer":"Enabling RuleForm with a unique name can be enabled after it is verified.\nDisabling RuleForm can be disabled only after the related Flows are disabled.","Form.Button.Design":"Design Form","Form.Button.Design.Footer":"You cannot design form while it is enabled.","Form.Button.Delete":"Delete Form","Form.Delete.Confirm":"This Form will be permanently deleted. You cannot undo this operation.","Form.Designer.Title":"Form Designer","Form.Designer.Invalid.Message":"Error","Form.Designer.Invalid.Description":"Form verification failed","Form.Modified":"Modified on","Form.Created":"Created on","Form.IsValid":"Verified or not","Form.Revision":"Revision","Form.New":"New Form","Form.SetUp.NotPassValid":"Form verification failed","Form.Field":"Field","Form.Field.Property.Error":'Error in "%@"',"Form.Error.Reason":"Error","Form.Designer.PropertyView.Show":"Show Properties Panel","Form.Designer.PropertyView.Hide":"Hide Properties Panel","Form.Designer.SaveOrNot":"Do you want to save the changes you made to the form ?","Form.SetUp.Error.Message":"Failed to enable this form. Because: ","Form.CanNot.Start.Reason":"Form cannot be enabled while another form has the same name.","Form.CanNot.Stop.Reason":"Form cannot be disabled while flow is enabled.","Form.Fields.Property.HasError":"Error in field properties","Form.MakeSureToDelete":"For security purposes, please re-enter the form name that you want to delete(Will also delete the associated flows and instances)","Form.MakeSureToDelete.InputWrongName":"The name is wrong.","Form.InputFormName":"Please enter a form name","Form.ValidFormName":"A form name cannot contain the characters: ","Form.InvalidFormName":"Invalid form name","Form.Name.Cannot.Blank":"form name cannot be blank","Form.Creating":"Creating...","Form.State.Title":"Enabled State","Add.Form.Template.Error.Title":"Failed to create form","Add.Form.Template.Error.Text":"Failed to create form from the template, please try again.","Dialog.Error.Title.Multiple.Form.DESTROY":"Cannot delete this Form.","Dialog.Error.Text.Multiple.Form.DESTROY":"Server Error! Failed to delete this Form. Please try again.","Dialog.Error.Text.Multiple.Form.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this Form. Please try again.","Dialog.Error.Text.Multiple.Form.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this Form.","Dialog.Error.Text.Multiple.Form.DESTROY.ERROR_DATA":"Failed to delete this Form.","Dialog.Error.Title.Form.CREATE":"Cannot create %@.","Dialog.Error.Text.Form.CREATE":"Server Error! Failed to create a Form. Please try again.","Dialog.Error.Text.Form.CREATE.ERROR_EXCEPTION":"Server Error! Failed to create a Form. Please try again.","Dialog.Error.Text.Form.CREATE.NOT_FOUND":"Failed to create a Form.","Dialog.Error.Text.Form.CREATE.NOT_AUTHORIZED":"Sorry, you have no permission to create a Form.","Dialog.Error.Text.Form.CREATE.ERROR_DATA":"Failed to create a Form.","Dialog.Error.Title.Form.UPDATE":"Cannot save the changes to %@.","Dialog.Error.Text.Form.UPDATE":"Server Error! Failed to update this Form. Please try again.","Dialog.Error.Text.Form.UPDATE.ERROR_EXCEPTION":"Server Error! Failed to update this Form. Please try again.","Dialog.Error.Text.Form.UPDATE.CONFLICT":"Failed to update this form, because it has been updated by another device.","Dialog.Error.Text.Form.UPDATE.NOT_FOUND":"Failed to update this form, because it has been deleted by another device.","Dialog.Error.Text.Form.UPDATE.NOT_AUTHORIZED":"Sorry, you have no permission to update a form.","Dialog.Error.Text.Form.UPDATE.ERROR_DATA":"Failed to update this form.","Dialog.Error.Title.Form.DESTROY":"Cannot delete %@","Dialog.Error.Text.Form.DESTROY.ERROR_DATA":"Server Error! Failed to delete this form. Please try again.","Dialog.Error.Text.Form.DESTROY":"Server Error! Failed to delete this Form. Please try again.","Dialog.Error.Text.Form.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this Form. Please try again.","Dialog.Error.Text.Form.DESTROY.CONFLICT":"Failed to delete this form, because it has been updated by another device.","Dialog.Error.Text.Form.DESTROY.NOT_FOUND":"Failed to delete this form, because it has been deleted by another device.","Dialog.Error.Text.Form.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this form. ","Flow.Title":"Workflow","Flow.List.Header":"Workflow List","Flow.Button.Add":"Add Workflow ...","Flow.Button.Design":"Design Flow","Flow.Button.View":"View Flow","Flow.Button.Design.Footer":"You cannot design flow while it is enabled.","Flow.Designer.Title":"Flow Designer","Flow.Button.Delete":"Delete Flow","Flow.Delete.Confirm":"This Flow will be permanently deleted. You cannot undo this action.","Flow.Permission":"Flow Permissions","Flow.Permission.Organization":"Departments","Flow.Permission.User":"Users","Flow.Permission.Header":"You cannot change permissions while flow is enabled","Flow.Permission.Org":"Departments","Flow.Permission.User":"Users","Flow.Permission.Add.Footer":"","Flow.Permission.Monitor.Footer":"","Flow.Permission.Admin.Footer":"","Flow.Permission.Add":"Who can initiate new request","Flow.Permission.Monitor":"Who can read all the requests","Flow.Permission.Admin":"Who can read all the requests, and relocat or reassign or delete a request","Flow.State.Enabled":"Enabled","Flow.State.Disabled":"Disabled","Flow.State.Footer":"Flow cannot be enabled while parent form is disabled or another flow has the same name.","Flow.Modified":"Modified on","Flow.IsValid":"Verified or not","Flow.Revision":"Revision","Flow.New":"New Flow","Flow.Step.ApproveUserOrGroup.Invalid":"The properties of %@ step are not verified.","Flow.Designer.PropertyView.Show":"Show Properties Panel","Flow.Designer.PropertyView.Hide":"Hide Properties Panel","Flow.Designer.SaveOrNot":"Do you want to save the changes you made to the flow ?","Flow.SetUp.NotPassValid":"Flow verification failed.","Flow.Step":"Step","Flow.SetUp.Error.Message":"Failed to enable this flow. Because: ","Flow.Steps.Property.HasError":"Error in step properties","Flow.MakeSureToDelete":"For security purposes, please re-enter the flow name that you want to delete(Will also delete the associated instances)","Flow.MakeSureToDelete.InputWrongName":"The name is wrong.","Form.InputFlowName":"Please enter a flow name","Flow.Name.Cannot.Blank":"flow name cannot be blank","Dialog.Error.Title.Multiple.Flow.DESTROY":"Cannot delete this Flow.","Dialog.Error.Text.Multiple.Flow.DESTROY":"Server Error! Failed to delete this Flow. Please try again.","Dialog.Error.Text.Multiple.Flow.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this Flow. Please try again.","Dialog.Error.Text.Multiple.Flow.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this flow.","Dialog.Error.Text.Multiple.Flow.DESTROY.ERROR_DATA":"Failed to delete this Flow.","Dialog.Error.Title.Flow.CREATE":"Cannot create %@.","Dialog.Error.Text.Flow.CREATE":"Server Error! Failed to create a Flow. Please try again.","Dialog.Error.Text.Flow.CREATE.ERROR_EXCEPTION":"Server Error! Failed to create a Flow. Please try again.","Dialog.Error.Text.Flow.CREATE.NOT_FOUND":"Failed to create a Flow. Failed to find the Flow list.","Dialog.Error.Text.Flow.CREATE.NOT_AUTHORIZED":"Sorry, you have no permission to create a flow.","Dialog.Error.Text.Flow.CREATE.ERROR_DATA":"Failed to create a Flow.","Dialog.Error.Title.Flow.UPDATE":"Cannot save the changes to %@.","Dialog.Error.Text.Flow.UPDATE":"Server Error! Failed to update this Flow. Please try again.","Dialog.Error.Text.Flow.UPDATE.ERROR_EXCEPTION":"Server Error! Failed to update this Flow. Please try again.","Dialog.Error.Text.Flow.UPDATE.CONFLICT":"Failed to update this flow, because it has been updated by another device.","Dialog.Error.Text.Flow.UPDATE.NOT_FOUND":"Failed to update this flow, because it has been deleted by another device.","Dialog.Error.Text.Flow.UPDATE.NOT_AUTHORIZED":"Sorry, you have no permission to update this flow. ","Dialog.Error.Text.Flow.UPDATE.ERROR_DATA":"Failed to update this Flow.","Dialog.Error.Title.Flow.DESTROY":"Cannot delete %@.","Dialog.Error.Text.Flow.DESTROY":"Server Error! Failed to delete this Flow. Please try again.","Dialog.Error.Text.Flow.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this Flow. Please try again.","Dialog.Error.Text.Flow.DESTROY.CONFLICT":"Failed to delete this flow, because it has been updated by another device.","Dialog.Error.Text.Flow.DESTROY.NOT_FOUND":"Failed to delete this flow, because it has been deleted by another device.","Dialog.Error.Text.Flow.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this flow. ","Dialog.Error.Text.Flow.DESTROY.ERROR_DATA":"Failed to delete this Flow.","User.Title":"User","User.Profile.Change":"Parameters","User.Profile.Change.Name":"Name","User.Profile.Change.Company":"Company","User.Profile.Change.Mobile":"Mobile","User.Profile.Change.Email":"Email","User.Profile.Change.Bind":"Account Bind","User.Profile.Change.QQ.Bind":"Bind QQ account","User.Profile.Change.QQ.Binded":"QQ account has binded","User.Profile.Bind.Success":"Account bind success, SteedOS will reload.","User.Profile.Bind.Error.Binded":"This QQ Account had binded another SteedOS account.","User.Profile.Change.Success":"Successfully saved.","User.Profile.UnActivated":"Unaccepted","User.Profile.Email.Notification":"Enable to receive Email notification","User.Password.Change":"Change Password","User.Password.Change.Old":"Old Password","User.Password.Change.New":"New Password","User.Password.Change.Confirm":"Confirm Password","User.Password.Change.Success":"Successfully changed password.","User.Password.Change.Error.Title":"Cannot change password.","User.Password.Change.Error.Text.Twice.Unequal":"Passwords didnt match.","User.Password.Change.Error.Text.Empty":"Password is required.","User.Password.Change.Error.Text.LessThanSix":"Password must contain 6 characters.","User.Language":"Language","User.Language.Change.Alert":"Language has been changed, Do you want to reload the page for the settings to take effect?","User.Account.Status":"Account Status","User.Account.Actived":"Actived","User.Account.Unactived":"UnActivated","User.List.Header":"User List","User.Add.MaxUserCount.Message":"Reached the maximum number.","User.Add.MaxUserCount.Description":"The space reached the maximum number of members. You can upgrade to get more members.","User.Add.EmailNotNull.Message":"These fields are required.","User.LastName":"Last Name","User.FirstName":"First Name","User.Name":"Name","User.Email":"Email%@","User.Manager":"Manager","User.Edit.Title":"Edit Users","User.Organization":"Belongs to","User.Button.Delete":"Delete User","User.Delete.Confirm":"User and his information will be permanently deleted. You cannot undo this operation.","User.Manage.Title":"User Management","User.Manager.Hint":"Click here to select user","User.Move.Exist.Remind":"Cannot move. %@ is already in %@. ","User.Move.Remind":"Are you sure you want to move %@ to %@? ","User.Move.Unable":"Cannot invite users","User.Move.Title":"Move User","User.Move.SelectOrg.Remind":"You havent chosen any department.","User.Invite.Title":"Invite Users","User.Invite.Success":"Invitation has been sent.","User.Invite.HeaderTitle":"Please enter the email address.","User.Invite.FooterTitle":"Use commas, semicolons, or separate lines to separate multiple email addresses.","User.Invite.Error.Title":"Failed to invite","User.Invite.Email.Error.Text":"Error in mail address, Please fix it and try again.","User.Invite.DomainEmail.Error.Text":"Email address must be @%@, fix your input and invite again.","User.Button.SendInvite":"Send Invitation","User.Button.Add":"Invite users","User.Button.Quit":"Quit","User.Quit.Confirm.Title":"Are you sure you want to quit from this space?","User.CanNot.Delete":"User cannot be deleted while he/she is admin, has assigned roles, has assigned requests, or has uncompleted requests.","User.MoveTo":"Move to","User.ApiAccess":"API Access","User.All":"All Users","User.Search.Text":"Enter user name or his/her email","User.Search.Null":'Failed to find "%@". Please change search terms.',"User.IsAdmin.CanNotDelete":"User cannot be deleted while he/she is admin.","User.HasRole.CanNotDelete":"User cannot be deleted while has assigned roles.","User.UseInFlow.CanNotDelete":"User cannot be deleted while referred in following processes:","Dialog.Error.Title.User.DELETE_USER":"Cannot delete %@.","Dialog.Error.Text.User.DELETE_USER":"Failed to delete this user, please try again.","Dialog.Error.Title.User.CHANGE_PASSWORD":"Cannot change password.","Dialog.Error.Text.User.CHANGE_PASSWORD":"Failed to change password, please try again.","Dialog.Error.Text.User.CHANGE_PASSWORD.OLD_PASSWORD_WRONG":"Old password is incorrect, please re-enter.","Dialog.Error.Title.Multiple.User.DESTROY":"Cannot delete this user","Dialog.Error.Text.Multiple.User.DESTROY":"Server Error! Failed to delete this user. Please try again.","Dialog.Error.Text.Multiple.User.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this user. Please try again.","Dialog.Error.Text.Multiple.User.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this user.","Dialog.Error.Text.Multiple.User.DESTROY.ERROR_DATA":"Failed to delete this user.","Dialog.Error.Title.User.CREATE":"Cannot create %@.","Dialog.Error.Text.User.CREATE":"Server Error! Failed to create a user. Please try again.","Dialog.Error.Text.User.CREATE.ERROR_EXCEPTION":"Server Error! Failed to create a user. Please try again.","Dialog.Error.Text.User.CREATE.NOT_FOUND":"Failed to create a user. Failed to find the user list.","Dialog.Error.Text.User.CREATE.NOT_AUTHORIZED":"Sorry, you have no permission to create a user.","Dialog.Error.Text.User.CREATE.ERROR_DATA":"Failed to create a user.","Dialog.Error.Title.User.UPDATE":"Cannot save the changes to %@.","Dialog.Error.Text.User.UPDATE":"Server Error! Failed to update this user. Please try again.","Dialog.Error.Text.User.UPDATE.ERROR_EXCEPTION":"Server Error! Failed to update this user. Please try again.","Dialog.Error.Text.User.UPDATE.CONFLICT":"Failed to update this user, because it has been updated by another device.","Dialog.Error.Text.User.UPDATE.NOT_FOUND":"Failed to update this user, because it has been deleted by another device.","Dialog.Error.Text.User.UPDATE.NOT_AUTHORIZED":"Sorry, you have no permission to update this user. ","Dialog.Error.Text.User.UPDATE.ERROR_DATA":"Failed to update this user.","Dialog.Error.Title.User.DESTROY":"Cannot delete %@.","Dialog.Error.Text.User.DESTROY":"Server Error! Failed to delete this user. Please try again.","Dialog.Error.Text.User.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this user. Please try again.","Dialog.Error.Text.User.DESTROY.CONFLICT":"Failed to delete this user, because it has been updated by another device.","Dialog.Error.Text.User.DESTROY.NOT_FOUND":"Failed to delete this user, because it has been deleted by another device.","Dialog.Error.Text.User.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this user.","Dialog.Error.Text.User.DESTROY.ERROR_DATA":"Cant delete this user. Failed to verify the data.","Space.ID":"ID","Space.Title":"Settings","Space.Options":"Options","Space.List.Header":"Space","Space.List.Joined.Header":"Joined Spaces","Space.List.Managed.Header":"Spaces","Space.Button.Add":"Add Space ...","Space.About":"About","Space.Organization":"Departments","Space.User":"Users","Space.RoleAndPosition":"Roles","Space.FormAndFlow":"Forms and Flow","Space.Workflow":"Workflow","Space.Creator":"Creator","Space.Billing":"Billing","Space.About.Title":"About Space","Space.Name":"Name","Space.Name.Footer":"Only space owner can change the name.","Space.Owner":"Owner","Space.Admins":"Administrators","Space.Admins.Footer":"Space owner can change the owner and administrators in Professional Version.","Space.MaxUserCount":"Allowed Users%@","Space.Created":"Created on","Space.Version":"Version","Space.Version.IsPaid":"Professional Version","Space.Version.Free":"Free Version","Space.Destroy":"Delete Space","Space.wantUpgrade":"Upgrade to Professional Version","Space.Destroy.Success":"Successfully deleted","Space.Update.Success":"Successfully changed","Space.Create.Success":"Successfully created","Space.Setting.Title":"Space Settings","Space.Quit":"Quit","Space.New":"New Space","Space.Delete.Confirm":"Space willed be permanently deleted. You cannot undo this operation.","Space.Delete.Tag":"1:: Operator must be the owner of this space;  n2: Only the owner can remain in the space.","Space.InputSpaceName":"Please enter a space name","Space.Create.Error.Title.NameBlank":"Create space error","Space.Create.Error.Text.NameBlank":"Space name is required.","Space.Billing.Introduce.Intro6":"      API for integration","Space.Billing.Introduce.Intro5":"      5-year Approval History","Space.Billing.Introduce.Intro3":"      Export all your requests to Excel","Space.Billing.Introduce.Intro2":"      Attach docs or photos to your request","Space.Billing.Introduce.Intro1":"      CounterSign Step","Space.Billing.Introduce.Intro":"Professional Version upgrades your experience with features below:","Space.Billing.TransactionDetails":"Transaction Details","Space.Billing.rechargeAccount":"Recharge account","Space.Billing.WrongUserCount":"Your space has too many members to purchase to this user count.","Space.Billing.Next":"Next","Space.Billing.Months":"months","Space.Billing.Amount":"Recharge Amount","Space.Billing.Time":"Time","Space.Billing.Plan":"My Plan","Space.Billing.Price":"Price","Space.Billing.PriceDetail":"US $ 3 / User / Month","Space.Billing.Balance":"Balance","Space.Billing.BuyURL":"https://steedos.com/us/steedos/buy/","Space.Billing.MyOrders":"My Orders","Space.CurrentAcceptedUserCount":"Current Users","Space.AcceptedUserCount":"Users%@","Space.CanAcceptUserCount":"Allowed Users%@","Space.InvitedUserCount":"%@ members (of %@ available)","Space.User.footerTitle":"You can upgrade to get more members.","Space.PaidExpireDate":"Expire Date","Space.PaidExpireDate.Undated":"Unlimited","Space.Name.Modified":"Change Space Name","Space.Owner.Modified":"Change Space Owner","Space.Admins.Modified":"Change Space admin","Space.Paid.Modified.OwnerAndAdmins":"Only Professional Version can change owner and admins.","Space.ListView.FooterTitle":"Please create your space, your form and flow, then invite your colleagues to join the SteedOS Cloud.","Space.MakeSureToDelete":"For security purposes, please re-enter the space name that you want to delete","Space.MakeSureToDelete.InputWrongName":"The name is wrong, please re-enter it and try again.","Space.Category":"Category","Space.Category.Add":"Add Category ...","Space.Category.New":"New Category","Space.Category.InputCategoryName":"Please enter a category name","Space.Category.Delete":"Delete Category","Space.Category.Choose":"Choose a category ...","Space.Category.Upgrade":"You can upgrade to use categories ...","Space.Category.Delete.InputCategoryName":"Please re-enter the category name that you want to delete","Space.Category.Delete.Used":"The category has been used","Space.Category.No":"No Category","Dialog.Error.Title.Category.CREATE":"Cannot create %@.","Dialog.Error.Title.Category.DESTROY":"Cannot delete %@.","Dialog.Error.Title.Category.UPDATE":"Cannot save the changes to %@.","Dialog.Error.Title.Multiple.Space.DESTROY":"Cannot delete this space.","Dialog.Error.Text.Multiple.Space.DESTROY":"Server Error! Failed to delete this space. Please try again.","Dialog.Error.Text.Multiple.Space.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this space. Please try again.","Dialog.Error.Text.Multiple.Space.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this space.","Dialog.Error.Text.Multiple.Space.DESTROY.ERROR_DATA":"Failed to delete this space.","Dialog.Error.Title.Space.CREATE":"Cannot create %@.","Dialog.Error.Text.Space.CREATE":"Server Error! Failed to create a space. Please try again.","Dialog.Error.Text.Space.CREATE.ERROR_EXCEPTION":"Server Error! Failed to create a space. Please try again.","Dialog.Error.Text.Space.CREATE.NOT_FOUND":"Failed to create a space. Failed to find the space list.","Dialog.Error.Text.Space.CREATE.NOT_AUTHORIZED":"Sorry, you have no permission to create a space.","Dialog.Error.Text.Space.CREATE.ERROR_DATA":"Failed to create a space.","Dialog.Error.Title.Space.UPDATE":"Cannot save the changes to %@.","Dialog.Error.Text.Space.UPDATE":"Server Error! Failed to update this space. Please try again.","Dialog.Error.Text.Space.UPDATE.ERROR_EXCEPTION":"Server Error! Failed to update this space. Please try again.","Dialog.Error.Text.Space.UPDATE.CONFLICT":"Failed to update this space, because it has been updated by another device.","Dialog.Error.Text.Space.UPDATE.NOT_FOUND":"Failed to update this space, because it has been deleted by another device.","Dialog.Error.Text.Space.UPDATE.NOT_AUTHORIZED":"Sorry, you have no permission to update this space.","Dialog.Error.Text.Space.UPDATE.ERROR_DATA":"Failed to update this space.","Dialog.Error.Title.Space.DESTROY":"Cannot delete this space","Dialog.Error.Text.Space.DESTROY":"Server Error! Failed to delete this space. Please try again.","Dialog.Error.Text.Space.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this space. Please try again.","Dialog.Error.Text.Space.DESTROY.CONFLICT":"Failed to delete this space, because it has been updated by another device.","Dialog.Error.Text.Space.DESTROY.NOT_FOUND":"Failed to delete this space, because it has been deleted by another device.","Dialog.Error.Text.Space.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this space.","Dialog.Error.Text.Space.DESTROY.ERROR_DATA":"Failed to delete this space.","Dialog.Error.Title.Multiple.SpaceUser.DESTROY":"Cannot delete this space user.","Dialog.Error.Text.Multiple.SpaceUser.DESTROY":"Server Error! Failed to delete this space user. Please try again.","Dialog.Error.Text.Multiple.SpaceUser.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this space user. Please try again.","Dialog.Error.Text.Multiple.SpaceUser.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this space user.","Dialog.Error.Text.Multiple.SpaceUser.DESTROY.ERROR_DATA":"Failed to delete this space user.","Dialog.Error.Title.SpaceUser.CREATE":"Cannot create %@.","Dialog.Error.Text.SpaceUser.CREATE":"Server Error! Failed to create a space user. Please try again.","Dialog.Error.Text.SpaceUser.CREATE.ERROR_EXCEPTION":"Server Error! Failed to create a space user. Please try again.","Dialog.Error.Text.SpaceUser.CREATE.NOT_FOUND":"Failed to create a space user. Failed to find the space user list.","Dialog.Error.Text.SpaceUser.CREATE.NOT_AUTHORIZED":"Sorry, you have no permission to create a space user.","Dialog.Error.Text.SpaceUser.CREATE.ERROR_DATA":"Failed to create a space user.","Dialog.Error.Title.SpaceUser.UPDATE":"Cannot save the changes to %@.","Dialog.Error.Text.SpaceUser.UPDATE":"Server Error! Failed to update this space user. Please try again.","Dialog.Error.Text.SpaceUser.UPDATE.ERROR_EXCEPTION":"Server Error! Failed to update this space user. Please try again.","Dialog.Error.Text.SpaceUser.UPDATE.CONFLICT":"Failed to update this space user, because it has been updated by another device.","Dialog.Error.Text.SpaceUser.UPDATE.NOT_FOUND":"Failed to update this space user, because it has been deleted by another device.","Dialog.Error.Text.SpaceUser.UPDATE.NOT_AUTHORIZED":"Sorry, you have no permission to update this space user. ","Dialog.Error.Text.SpaceUser.UPDATE.ERROR_DATA":"Failed to update this space user.","Dialog.Error.Title.SpaceUser.DESTROY":"Cannot delete %@","Dialog.Error.Text.SpaceUser.DESTROY":"Server Error! Failed to delete this space user. Please try again.","Dialog.Error.Text.SpaceUser.DESTROY.ERROR_EXCEPTION":"Server Error! Failed to delete this space user. Please try again.","Dialog.Error.Text.SpaceUser.DESTROY.CONFLICT":"Failed to delete this space user, because it has been updated by another device.","Dialog.Error.Text.SpaceUser.DESTROY.NOT_FOUND":"Failed to delete this space user, because it has been deleted by another device.","Dialog.Error.Text.SpaceUser.DESTROY.NOT_AUTHORIZED":"Sorry, you have no permission to delete this space user.","Dialog.Error.Text.SpaceUser.DESTROY.ERROR_DATA":"Failed to delete this space user.","SpaceUser.ActivedSpaceUser":"Actived Users","SpaceUser.Active.NO":"No Actived Users","SpaceUser.UnactivedSpaceUser":"Deactived Users","SpaceUser.Unactive.NO":"No Deactived Users","SpaceUser.InProgress":"Operations are in progress...","Dialog.Error.Title.SpaceUser.MOVE_USER":"Cannot move user","Dialog.Error.Text.SpaceUser.MOVE_USER":"Failed to move, please try again.","locale.DateFormat":"MMM dd, yyyy","locale.DateTimeFormat":"MMM dd, yyyy HH:mm","Help.URL":"http://blog.steedos.com/help","Field.Input":"Text","Field.Textarea":"Textarea","Field.Email":"Email","Field.URL":"URL","Field.Richtext":"Rich text","Field.Checkbox":"YesNo Box","Field.Number":"Number","Field.Percentage":"Percentage","Field.Password":"Password","Field.Currency":"Currency","Field.Date":"Date","Field.DateTime":"Date-Time","Field.Select":"Drop-down","Field.Radio":"Radio","Field.Group":"Select Dept.","Field.MultiSelect":"Checkbox","Field.User":"Select User","Field.Label":"Label","Field.SubForm":"Sub-form","Field.Table":"Table","Field.Section":"Section","PhotoPicker.DragPhoto":"Drag\nPhoto\nHere","Button.ImagePicker.UploadNewPhoto":"Choose Photo...","Button.ImagePicker.InstallPlugin":"Install Plugin...","Button.ImagePicker.Cancel":"Cancel","Button.ImagePicker.Done":"Done","PhotoPicker.InvalidFormat.Title":"Invalid Format","PhotoPicker.InvalidFormat.Message":"Make sure your photo is a JPEG, GIF, PNG or BMP and try again.","PhotoPicker.PhotoTooBig.Title":"Photo Is Too Big","PhotoPicker.PhotoTooBig.Message":"Make sure your photo is under 10MB, and then try again.","PhotoPicker.PluginRequired.Title":"Plugin Required","PhotoPicker.PluginRequired.Message":'Adding or Editing a photo requires the SteedOS Web App Plugin. \n<a target="_BLANK" href="http://help.steedos.com/">Learn more...</a>',"PhotoPicker.ServerError.Title":"Server Error","PhotoPicker.PhotoLoadError.Message":"Your photo couldn't be uploaded at this time. Try again later.","PhotoPicker.PhotoLoadingFailed":"Could Not Load Photo","PhotoPicker.UploadingPhoto":"Uploading Photo","Dialog.PhotoPicker.ActiveXRequired.Title":"Browser Add-on Required","Dialog.PhotoPicker.ActiveXRequired.Text":"To Save photos, SteedOS Extras for Internet Explorer must be installed.","Dialog.PhotoPicker.ActiveXRequired.LearnMore.URL":"http://help.steedos.com/","Dialog.PhotoPicker.Button.LearnMore":"Learn More","Dialog.PhotoPicker.Button.OK":"OK","PhotoPicker.ActiveXNotInstalled.MessageLabel":"Browser\nAdd-on\nRequired"});Admin=Designer=SC.Application.create({NAMESPACE:"Flow",VERSION:"0.1.0",store:SC.Store.create().from(SC.FixturesDataSource.create({simulateRemoteResponse:YES,latency:250})),spaceId:null,companyId:null,loadRecords:function(a,b){if(b instanceof Array){for(i=0;i<b.length;i++){Designer.store.loadRecord(a,b[i])}}else{Designer.store.loadRecord(a,b)}},getQueryString:function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i");var d=window.location.search.substr(1).match(b);if(d!=null){return unescape(d[2])}return null}});Designer.categoriesController=SC.ArrayController.create({allowsMultipleSelection:NO,load:function(){if(!Designer.spaceId){return}if(!Designer.store.find(Designer.Category,Designer.spaceId+"_nocategory")){Designer.store.createRecord(Designer.Category,{id:Designer.spaceId+"_nocategory",name:"Space.Category.No".loc(),space:null})}query=SC.Query.local(Designer.Category,{conditions:"space = %@ OR id = %@",parameters:[Designer.spaceId,Designer.spaceId+"_nocategory"],orderBy:"name ASC"});c=Designer.store.find(query);this.set("content",c)}.observes("Designer.spaceId"),addCategory:function(){navigator.notification.prompt("",function(f){if(f.buttonIndex==1){var d="Space.Category.New".loc();if(f.input1.trim()){var g=[":","","\\","/","","?","","*","","[","","]","","'",""];var b=[":","\\","/","?","*","[","]","'"];for(var e=g.length-1;e>=0;e--){if(f.input1.indexOf(g[e])>-1){navigator.notification.alert("Form.ValidFormName".loc()+b.join(" "),function(){},"Form.InvalidFormName".loc(),"Button.OK".loc());return NO}}d=f.input1}var a={id:CW.upperCaseUUID(),name:d,space:Designer.spaceController.get("id")};data={Categories:[a]};$.ajax({url:requestOrigin+"/am/categories?sync_token="+Designer.sync_token,crossDomain:true,type:"POST",xhrFields:{withCredentials:true},dataType:"text",data:JSON.stringify(data),contentType:"text/plain"}).done(function(h){responseFixed=h.replace(/\"_id\"/g,'"id"');Designer.fixtures.ChangeSet=JSON.parse(responseFixed).ChangeSet;Designer.loadRecords(Designer.Category,Designer.fixtures.ChangeSet.inserts.Categories);Designer.sync_token=Designer.fixtures.ChangeSet.sync_token}).error(function(h,k,j){alert("create category failed: "+k+","+j)})}},"Space.Category.InputCategoryName".loc(),["Button.OK".loc(),"Button.Cancel".loc()])},deleteCategory:function(){var a=Admin.categoryController.get("content");if(SC.none(a)||a.get("status")===SC.Record.DESTROYED){return}a.destroy();Admin.adminNestedStore.commitChanges(YES)},});Designer.categoryController=SC.ObjectController.create({});Designer.displayController=SC.ObjectController.create({isBusy:NO,justSaved:NO,tabs:["Designer.form".loc(),"Designer.workflow".loc()],selectedTab:"Designer.workflow".loc(),isEditable:YES,formVisible:function(){return this.get("selectedTab")==this.get("tabs")[0]}.property(".selectedTab"),flowVisible:function(){return this.get("selectedTab")==this.get("tabs")[1]}.property(".selectedTab"),openDesignPanel:function(){formId=Designer.flowController.get("content").firstObject().attributes().form;Designer.formController.loadForm(formId);Designer.displayController.designPane=Designer.DesignPanelView.create({isEditable:true});Designer.displayController.designPane.append()},closeDesignPanel:function(){Designer.displayController.designPane.remove();Designer.displayController.designPane.destroy();FormDesigner.formController.set("nowShowing","FormDesigner.FormPropFieldView");FormDesigner.fieldListController.set("selection",null);FormDesigner.fieldListController.set("content",null);FormDesigner.fieldController.set("content",null);FormDesigner.formController.set("content",null);FormDesigner.formValidController.set("errorMessage",null);FlowDesigner.FlowStepAndLineController.content=null;Designer.displayController.set("selectedTab","Designer.workflow".loc())}});Designer.flowController=SC.ObjectController.create({contentBinding:SC.Binding.oneWay("Designer.flowsController.selection"),showFlowPermission:function(){var a=CW.PanelPane.create(CW.Animatability,CW.PaneAnimationSupport,{layout:{centerX:0,centerY:0,width:530,height:500},themeName:"iOS",hasNavigationBar:YES,hasTabBar:NO,contentView:CW.NavigationView.extend({navigationController:Designer.flowPermissionNavigationController,themeName:"navigationViewSilverPanel",layout:{top:0,left:0,right:0,bottom:0},wellViewClassType:SC.View,contentView:Designer.PermissionNavigatableView})}).append()},loadFlow:function(a){query=SC.Query.create({conditions:"id = '"+a+"'",recordType:Designer.Flow});flows=Designer.store.find(query);Designer.flowController.set("content",flows)}});Designer.flowsController=SC.ArrayController.create({load:function(){if(!Designer.spaceId||!Designer.categoryId){return}query=SC.Query.local(Designer.Flow,{conditions:"space.id = %@ AND category.id = %@",parameters:[Designer.spaceId,Designer.categoryId],orderBy:"name ASC"});if(Designer.categoryId==(Designer.spaceId+"_nocategory")){query=SC.Query.local(Designer.Flow,{conditions:"space.id = %@ AND category = %@",parameters:[Designer.spaceId,null],orderBy:"name ASC"})}flows=Designer.store.find(query);this.set("content",flows)}.observes("Designer.spaceId","Designer.categoryId"),getFlowsByForm:function(e,d){var b,a;b=SC.Query.local(Designer.Flow,{conditions:"space.id = %@ AND form.id= %@",parameters:[e,d],orderBy:"name ASC"});a=Designer.store.find(b);return a},});Designer.formController=SC.ObjectController.create({loadForm:function(a){queryForm=SC.Query.create({conditions:"id = '"+a+"'",recordType:Designer.Form});forms=Designer.store.find(queryForm);Designer.formController.set("content",forms)},addField:function(f,d,h){var j,a,b=Designer.formController.getCodeByType(f);var g="";var e={type:f,code:b};if(e.id===undefined){e.id=CW.upperCaseUUID()}if(f=="user"||f=="group"){e.rows=1}else{if(f=="section"||f=="table"){e.is_wide=YES}else{if(f=="number"){e.digits=0}}}if(h){a=h.get("fields");g=h.get("code")}else{a=Designer.formController.get("fields");g="__form"}a.insertAt(d,e);j=a.objectAt(d);Designer.formController.addFieldToPermisions(b,g);return j},addFieldToPermisions:function(b,g){var h=Designer.flowsController.getFlowsByForm(Designer.formController.get("space").get("id"),Designer.formController.get("id"));if(h.length()>0){for(var e=h.length()-1;e>=0;e--){var a=h.objectAt(e).get("current").get("steps");if(a.length()>0){for(var d=a.length()-1;d>=0;d--){var f=SC.copy(a.objectAt(d).get("permissions"));if(f){if(f[g]){f[b]="editable";a.objectAt(d).set("permissions",f);SC.debug("addField:"+b+""+a.objectAt(d).get("name")+"permissions")}}}}}}},getCodeByType:function(e){var g="";switch(e){case"checkbox":g="Field.Checkbox".loc();break;case"dateTime":g="Field.DateTime".loc();break;case"date":g="Field.Date".loc();break;case"email":g="Field.Email".loc();break;case"group":g="Field.Group".loc();g=g.replace(".","");break;case"input":g="Field.Input".loc();break;case"multiSelect":g="Field.MultiSelect".loc();break;case"number":g="Field.Number".loc();break;case"password":g="Field.Password".loc();break;case"radio":g="Field.Radio".loc();break;case"section":g="Field.Section".loc();break;case"select":g="Field.Select".loc();break;case"table":g="Field.Table".loc();break;case"url":g="Field.URL".loc();break;case"user":g="Field.User".loc();break;case"geolocation":g="Field.Geolocation".loc();break;default:g="";break}var a=Designer.formController.get("current").get("fields").toArray();var f=a.filterProperty("type","section"),b=a.filterProperty("type","table");if(f.length){f.forEach(function(h){h.get("fields").forEach(function(j){a.push(j)})})}if(b.length){b.forEach(function(h){h.get("fields").forEach(function(j){a.push(j)})})}var d=a.mapProperty("code");if(d.contains(g)){g=this.getCodeAutomatic(1,g,d)}return g},getCodeAutomatic:function(a,e,d){SC.debug("getCodeAutomatic");var f=new Date*1;var b=e+a;if(d.contains(b)){return this.getCodeAutomatic(++a,e,d)}else{SC.debug("return value : "+b);SC.debug(" getCodeAutomatic");SC.debug(""+(new Date()*1-f)+"ms");return b}},saveChanges:function(){Designer.displayController.set("isBusy",true);Designer.displayController.set("justSaved",true);form=Designer.formController.get("content").firstObject().attributes();form_data={Forms:[form]};$.ajax({url:requestOrigin+"/am/forms?methodOverride=PUT&sync_token="+Designer.sync_token,crossDomain:true,type:"POST",xhrFields:{withCredentials:true},dataType:"text",data:JSON.stringify(form_data),contentType:"text/plain"}).done(function(e){responseFixed=e.replace(/\"_id\"/g,'"id"');Designer.fixtures.ChangeSet=JSON.parse(responseFixed).ChangeSet;Designer.loadRecords(Designer.Form,Designer.fixtures.ChangeSet.updates.Forms);Designer.loadRecords(Designer.Flow,Designer.fixtures.ChangeSet.updates.Flows);for(a=0;a<Designer.fixtures.ChangeSet.updates.Forms.length;a++){var b=Designer.fixtures.ChangeSet.updates.Forms[a];var d=SC.Query.local(Designer.Flow,{conditions:"space.id = %@ AND form.id = %@",parameters:[Designer.spaceId,b.id]});var g=Designer.store.find(d);if(g&&g.storeKeys){var f=[];g.storeKeys.forEach(function(h){f.push(Designer.store.readDataHash(h))});for(var a=f.length-1;a>=0;a--){f[a]["category"]=b.category}Designer.loadRecords(Designer.Flow,f)}}if(Designer.formController.get("content").firstObject()){Designer.store.writeStatus(Designer.formController.get("content").firstObject().storeKey,SC.Record.READY_CLEAN)}Designer.sync_token=Designer.fixtures.ChangeSet.sync_token;flow=Designer.flowController.get("content").firstObject().attributes();flow_data={Flows:[flow]};$.ajax({url:requestOrigin+"/am/flows?methodOverride=PUT&sync_token="+Designer.sync_token,crossDomain:true,type:"POST",xhrFields:{withCredentials:true},dataType:"text",data:JSON.stringify(flow_data),contentType:"text/plain"}).done(function(l){responseFixed=l.replace(/\"_id\"/g,'"id"');Designer.fixtures.ChangeSet=JSON.parse(responseFixed).ChangeSet;for(a=0;a<Designer.fixtures.ChangeSet.updates.Flows.length;a++){flow=Designer.fixtures.ChangeSet.updates.Flows[a];formId=flow.form;formRecord=Designer.store.find(Designer.Form,formId);console.log(formRecord);if(formRecord&&formRecord.get("category")){flow.category=formRecord.get("category").get("id")}}Designer.loadRecords(Designer.Flow,Designer.fixtures.ChangeSet.updates.Flows);Designer.sync_token=Designer.fixtures.ChangeSet.sync_token;if(Designer.displayController.flowVisible()){Designer.displayController.set("justSaved",false);var k=null;var j=FlowDesigner.FlowController.get("content");var h=FlowDesigner.settings?FlowDesigner.settings.curFlowDesigner:null;if(j&&h instanceof FlowDesigner.Designer){if(k=j.get("firstObject")){k=k.attributes();h.reloadData(k)}}}if(Designer.flowController.get("content").firstObject()){Designer.store.writeStatus(Designer.flowController.get("content").firstObject().storeKey,SC.Record.READY_CLEAN)}navigator.notification.alert("",function(){},"Button.Save.Success".loc(),"Button.OK".loc());Designer.displayController.set("isBusy",false);Designer.formController.invokeLast(function(){Designer.flowController.set("content",FlowDesigner.FlowController.get("content"))})}).error(function(h,k,j){alert("update flow failed: "+k+","+j)})}).error(function(a,d,b){alert("update form failed: "+d+","+b)})}});Designer.formsController=SC.ArrayController.create({addForm:function(){navigator.notification.prompt("",function(f){if(f.buttonIndex==1){var e="Form.New".loc();if(f.input1.trim()){var h=[":","","\\","/","","?","","*","","[","","]","","'",""];var a=[":","\\","/","?","*","[","]","'"];for(var d=h.length-1;d>=0;d--){if(f.input1.indexOf(h[d])>-1){navigator.notification.alert("Form.ValidFormName".loc()+a.join(" "),function(){},"Form.InvalidFormName".loc(),"Button.OK".loc());return NO}}e=f.input1}var b=SC.DateTime.create().toISO8601(),j=CW.upperCaseUUID();var g={id:j,name:e,space:Designer.spaceController.get("id"),is_valid:true,app:"workflow",current:{id:CW.upperCaseUUID()}};if(Designer.categoryId&&(Designer.categoryId!=(Designer.spaceId+"_nocategory"))){g.category=Designer.categoryId}if(Designer.companyId){g.company_id=Designer.companyId}data={Forms:[g]};$.ajax({url:requestOrigin+"/am/forms?sync_token="+Designer.sync_token,crossDomain:true,type:"POST",xhrFields:{withCredentials:true},dataType:"text",data:JSON.stringify(data),contentType:"text/plain"}).done(function(k){responseFixed=k.replace(/\"_id\"/g,'"id"');Designer.fixtures.ChangeSet=JSON.parse(responseFixed).ChangeSet;Designer.loadRecords(Designer.Form,Designer.fixtures.ChangeSet.inserts.Forms);for(d=0;d<Designer.fixtures.ChangeSet.inserts.Flows.length;d++){flow=Designer.fixtures.ChangeSet.inserts.Flows[d];j=flow.form;formRecord=Designer.store.find(Designer.Form,j);if(formRecord){if(formRecord.get("category")){flow.category=formRecord.get("category").get("id")}}}Designer.loadRecords(Designer.Flow,Designer.fixtures.ChangeSet.inserts.Flows);Designer.sync_token=Designer.fixtures.ChangeSet.sync_token}).error(function(k,m,l){alert("create form failed: "+m+","+l)})}},"Form.InputFlowName".loc(),["Button.OK".loc(),"Button.Cancel".loc()])},clearSelection:function(){var a=SC.SelectionSet.create();this.set("selection",a)},deleteForm:function(){var a=Admin.formController.get("content");if(SC.none(a)||a.get("status")===SC.Record.DESTROYED){return}a.destroy();Admin.adminNestedStore.commitChanges(YES)}});Designer.flowPermissionNavigationController=CW.NavigationController.create();Designer.rolesController=SC.ArrayController.create({allowsMultipleSelection:NO,load:function(){var e,a=Designer.store,d=Designer.spaceId;if(a&&d){var b=SC.Query.local(Designer.Role,{conditions:"space = %@",parameters:[d],orderBy:"name ASC"});e=Designer.store.find(b)}this.set("content",e);this.set("spaceId",d)}.observes("Designer.spaceId")});Designer.spaceController=SC.ObjectController.create({load:function(){if(!Designer.spaceId){return}query=SC.Query.create({recordType:Designer.Space,conditions:"id = %@",parameters:[Designer.spaceId],});selectedSpace=Designer.store.find(query);this.set("content",selectedSpace)}.observes("Designer.spaceId")});Designer.spacesController=SC.ArrayController.create({load:function(){query=SC.Query.create({recordType:Designer.Space});spaces=Designer.store.find(query);this.set("content",spaces)},});Designer.utilController=SC.ObjectController.create({compareArray:function(f,e){if(!f||!e||f.length!==e.length){return false}var d=true;f.forEach(function(a){if(!e.contains(a)){d=false;return}});return d}});Designer.Category=CS.Category;SC.mixin(Designer.Category,{typeString:"Designer.Category"});Designer.SubField=CW.HashAttribute.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),name:SC.Record.attr(String,{isRequired:YES}),code:SC.Record.attr(String,{isRequired:YES}),description:SC.Record.attr(String),default_value:SC.Record.attr(String),is_required:SC.Record.attr(Boolean,{defaultValue:false}),is_textarea:SC.Record.attr(Boolean,{defaultValue:false}),type:SC.Record.attr(String,{isRequired:YES,defaultValue:"input"}),rows:SC.Record.attr(Number,{defaultValue:4}),help_text:SC.Record.attr(String),digits:SC.Record.attr(Number,{defaultValue:0}),formula:SC.Record.attr(String),options:SC.Record.attr(String),has_others:SC.Record.attr(Boolean,{defaultValue:false}),is_multiselect:SC.Record.attr(Boolean,{defaultValue:false}),is_wide:SC.Record.attr(Boolean,{defaultValue:false}),});sc_require("models/sub_field_model");Designer.Field=CW.HashAttribute.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),name:SC.Record.attr(String,{isRequired:YES}),code:SC.Record.attr(String,{isRequired:YES}),description:SC.Record.attr(String),default_value:SC.Record.attr(String),is_required:SC.Record.attr(Boolean,{defaultValue:false}),is_textarea:SC.Record.attr(Boolean,{defaultValue:false}),type:SC.Record.attr(String,{isRequired:YES}),help_text:SC.Record.attr(String),digits:SC.Record.attr(Number,{defaultValue:0}),formula:SC.Record.attr(String),options:SC.Record.attr(String),has_others:SC.Record.attr(Boolean,{defaultValue:false}),is_multiselect:SC.Record.attr(Boolean,{defaultValue:false}),is_wide:SC.Record.attr(Boolean,{defaultValue:false}),fields:CW.Record.toMany(Designer.SubField,{isRequired:YES}),});Designer.Line=CW.HashAttribute.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),name:SC.Record.attr(String),state:SC.Record.attr(String,{isRequired:YES}),condition:SC.Record.attr(String),to_step:SC.Record.attr(String,{isRequired:YES}),description:SC.Record.attr(String),timeout_line:SC.Record.attr(Boolean)});sc_require("models/line_model");sc_require("models/field_model");Designer.Step=CW.HashAttribute.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),name:SC.Record.attr(String,{isRequired:YES}),step_type:SC.Record.attr(String,{isRequired:YES}),deal_type:SC.Record.attr(String,{isRequired:YES}),description:SC.Record.attr(String),posx:SC.Record.attr(Number,{isRequired:YES}),posy:SC.Record.attr(Number,{isRequired:YES}),timeout_hours:SC.Record.attr(Number),approver_user_field:SC.Record.attr(String),approver_org_field:SC.Record.attr(String),approver_roles:CW.Record.toMany("Designer.Role"),approver_orgs:CW.Record.toMany("Designer.Organization"),approver_users:CW.Record.toMany("Designer.User"),approver_step:SC.Record.attr(String),lines:CW.Record.toMany(Designer.Line),help_text:SC.Record.attr(String),permissions:SC.Record.attr(Object),disableCC:SC.Record.attr(Boolean),allowDistribute:SC.Record.attr(Boolean),can_edit_main_attach:SC.Record.attr(Boolean),can_edit_normal_attach:SC.Record.attr(Boolean),distribute_optional_flows:SC.Record.attr(Array),cc_must_finished:SC.Record.attr(Boolean),cc_alert:SC.Record.attr(Boolean),allowBatch:SC.Record.attr(Boolean),oneClickApproval:SC.Record.attr(Boolean),oneClickRejection:SC.Record.attr(Boolean),allow_pick_approve_users:SC.Record.attr(Boolean),cc_has_edit_permission:SC.Record.attr(Boolean)});SC.mixin(Designer.Step,{typeString:"Designer.Step",});sc_require("models/field_model");sc_require("models/list_field_model");Designer.FormVersion=CW.HashAttribute.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),form:CW.Record.toOne("Designer.Form",{isRequired:YES}),_rev:SC.Record.attr(Number,{isRequired:YES,defaultValue:1}),fields:CW.Record.toMany(Designer.Field,{isRequired:YES}),start_date:SC.Record.attr(Date),finish_date:SC.Record.attr(Date),created:SC.Record.attr(Date),created_by:SC.Record.toOne("Designer.User",{isRequired:YES}),modified:SC.Record.attr(Date),form_script:SC.Record.attr(String),name_forumla:SC.Record.attr(String),modified_by:SC.Record.toOne("Designer.User"),userFields:function(){var b=this.get("fields");var a=b.filter(function(f,e,d){if(f.get("type")=="user"){return true}else{return false}},this);return a}.property("fields").cacheable(),orgFields:function(){var b=this.get("fields");var a=b.filter(function(f,e,d){if(f.get("type")=="group"){return true}else{return false}},this);return a}.property("fields").cacheable(),});Designer.User=CS.User.extend({imo_uid:SC.Record.attr(String),google_id:SC.Record.attr(String),qq_open_id:SC.Record.attr(String),isGoogleAppsAccount:function(){return this.get("google_id")&&this.get("google_id")!=""},isIMOAccount:function(){return this.get("imo_uid")&&this.get("imo_uid")!=""},isQQAccount:function(){return this.get("qq_open_id")&&this.get("qq_open_id")!=""},});SC.mixin(Designer.User,{typeString:"Designer.User"});sc_require("models/step_model");sc_require("models/form_version_model");sc_require("models/user_model");Designer.FlowVersion=CW.HashAttribute.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),_rev:SC.Record.attr(Number,{isRequired:YES}),flow:SC.Record.attr(String,{isRequired:YES}),form_version:SC.Record.attr(String,{isRequired:YES}),steps:CW.Record.toMany(Designer.Step,{isRequired:YES}),created:SC.Record.attr(Date),created_by:SC.Record.toOne("Designer.User"),modified:SC.Record.attr(Date),modified_by:SC.Record.toOne("Designer.User"),start_date:SC.Record.attr(Date),finish_date:SC.Record.attr(Date),});Designer.Space=CS.Space.extend({imo_cid:SC.Record.attr(String),modules:SC.Record.attr(Array),acceptedUserCount:function(){var d=Designer.spacesController.getPath("selection.firstObject");if(!SC.empty(d)){var b=SC.Query.local(Designer.SpaceUser,{conditions:"space = %@ AND user_accepted = %@",parameters:[d.get("id"),YES]}),a;Designer.adminNestedStore.dataSourceDidFetchQuery(b);a=Designer.adminNestedStore.find(b);return a.get("length")}else{return 0}}.property(),isGoogleAppsSpace:function(){return this.get("google_domain_name")&&this.get("google_domain_name")!=""}.property("google_domain_name").cacheable(),isIMOSpace:function(){return this.get("imo_cid")&&this.get("imo_cid")!=""}.property("imo_cid").cacheable(),isAdmin:function(){var a=this.get("admins");return a&&a.contains(Designer.get("currentUser"))}.property().cacheable(),});SC.mixin(Designer.Space,{typeString:"Designer.Space",});sc_require("models/form_version_model");Designer.Form=CW.Record.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),current:CW.Record.toOne(Designer.FormVersion),historys:CW.Record.toMany(Designer.FormVersion),name:SC.Record.attr(String,{isRequired:YES}),app:SC.Record.attr(String),state:SC.Record.attr(String,{isRequired:YES,defaultValue:"disabled"}),stateString:function(){if(this.get("state")==="enabled"){return"Form.State.Enabled".loc()}else{return"Form.State.Disabled".loc()}}.property("state").cacheable(),description:SC.Record.attr(String),is_deleted:SC.Record.attr(Boolean,{isRequired:YES}),is_valid:SC.Record.attr(Boolean,{isRequired:YES}),space:SC.Record.toOne("Designer.Space",{isRequired:YES}),help_text:SC.Record.attr(String),created:SC.Record.attr(Date),created_by:SC.Record.toOne("Designer.User",{isRequired:YES}),error_message:SC.Record.attr(Object),category:SC.Record.toOne("Designer.Category"),instance_style:SC.Record.attr(String),fields:function(){return(this.get("current")&&this.get("current").get("fields"))||null}.property("current").cacheable(),current_rev:function(){return(this.get("current")&&this.get("current").get("_rev"))||null}.property("current").cacheable(),current_created:function(){return(this.get("current")&&this.get("current").get("created"))||null}.property("current").cacheable(),current_modified:function(){return(this.get("current")&&this.get("current").get("modified"))||null}.property("current").cacheable(),});SC.mixin(Designer.Form,{typeString:"Designer.Form"});Designer.Organization=CS.Organization.extend();SC.mixin(Designer.Organization,{typeString:"Designer.Organization"});sc_require("models/organization_model");sc_require("models/user_model");Designer.FlowPerm=CW.HashAttribute.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),users_can_add:CW.Record.toMany(Designer.User),orgs_can_add:CW.Record.toMany(Designer.Organization),users_can_monitor:CW.Record.toMany(Designer.User),orgs_can_monitor:CW.Record.toMany(Designer.Organization),users_can_admin:CW.Record.toMany(Designer.User),orgs_can_admin:CW.Record.toMany(Designer.Organization),});sc_require("models/flow_version_model");sc_require("models/space_model");sc_require("models/form_model");sc_require("models/flow_perm_model");Designer.Flow=CW.Record.extend({primaryKey:"id",id:SC.Record.attr(String,{isRequired:YES}),category:SC.Record.toOne("Designer.Category"),current:CW.Record.toOne(Designer.FlowVersion),historys:CW.Record.toMany(Designer.FlowVersion),name:SC.Record.attr(String,{isRequired:YES}),space:SC.Record.toOne("Designer.Space",{isRequired:YES}),description:SC.Record.attr(String),is_valid:SC.Record.attr(Boolean,{isRequired:YES,defaultValue:NO}),form:CW.Record.toOne("Designer.Form",{isRequired:YES}),flowtype:SC.Record.attr(String,{isRequired:YES}),state:SC.Record.attr(String,{isRequired:YES,defaultValue:"disabled"}),error_message:SC.Record.attr(Object),app:SC.Record.attr(String),stateString:function(){if(this.get("state")==="enabled"){return"Flow.State.Enabled".loc()}else{return"Flow.State.Disabled".loc()}}.property("state").cacheable(),is_deleted:SC.Record.attr(Boolean,{isRequired:YES,defaultValue:NO}),is_enabled:function(){if(this.get("state")==="enabled"){return true}else{return false}}.property("state").cacheable(),created:SC.Record.attr(Date),created_by:SC.Record.toOne("Designer.User",{isRequired:YES}),help_text:SC.Record.attr(String),current_no:SC.Record.attr(Number,{defaultValue:0}),perms:CW.Record.toOne(Designer.FlowPerm),fields:function(){return this.get("form")&&this.get("form").get("fields")?this.get("form").get("fields"):[]}.property("form").cacheable(),userFields:function(){var b=this.get("fields");var a=b.filter(function(f,e,d){if(f.get("type")=="user"){return true}else{return false}},this);return a}.property("form").cacheable(),orgFields:function(){var b=this.get("fields");var a=b.filter(function(f,e,d){if(f.get("type")=="group"){return true}else{return false}},this);return a}.property("form").cacheable(),distribute_optional_users:SC.Record.attr(Array)});SC.mixin(Designer.Flow,{typeString:"Designer.Flow"});Designer.Position=CS.Position;SC.mixin(Designer.Position,{typeString:"Designer.Position"});Designer.Role=CS.Role;SC.mixin(Designer.Role,{typeString:"Designer.Role"});Designer.SpaceUser=CS.SpaceUser;SC.mixin(Designer.SpaceUser,{typeString:"Designer.SpaceUser",});Designer.Theme=SteedOSTheme.create({name:"designer"});SC.Theme.addTheme(Designer.Theme);SC.defaultTheme="designer";Designer.DesignPanelView=CW.PanelPane.extend(CW.Animatability,CW.PaneAnimationSupport,{layout:{left:24,right:24,top:38,bottom:38},classNames:"wood".w(),isFullScreen:YES,hasNavigationBar:YES,hasTabBar:NO,contentView:SC.View.extend({layout:{left:0,right:0,top:0,bottom:0},childViews:"toolbarView formView flowView".w(),toolbarView:SC.View.extend({childViews:"saveBtn closeBtn segView".w(),layout:{height:44},segView:SC.SegmentedView.extend({controlSize:SC.LARGE_CONTROL_SIZE,layout:{width:300,height:30,centerX:0,centerY:0},itemsBinding:"Designer.displayController.tabs",valueBinding:"Designer.displayController.selectedTab"}),closeBtn:SC.ButtonView.extend({controlSize:SC.HUGE_CONTROL_SIZE,layout:{width:60,height:30,left:100,centerY:0},title:"Designer.close".loc(),isEnabledBinding:SC.Binding.not("Designer.displayController.isBusy"),action:function(){if((Designer.formController.get("content").firstObject()&&(Designer.formController.get("content").firstObject().status()&SC.Record.DIRTY))||(Designer.flowController.get("content").firstObject()&&(Designer.flowController.get("content").firstObject().status()&SC.Record.DIRTY))){navigator.notification.confirm("",function(a){if(a===1){if(Designer.formController.get("is_valid")==false){Designer.formController.formInvalidAlert()}else{if(Designer.formController.get("name")==null||Designer.formController.get("name").trim()==""){Designer.formValidController.nameCannotBlank()}else{Designer.formController.saveChanges();Designer.displayController.closeDesignPanel()}}}else{if(a===2){return}else{window.location.reload()}}},"Form.Designer.SaveOrNot".loc(),["Button.Save".loc(),"Button.Cancel".loc(),"Button.DontSave".loc()])}else{Designer.displayController.closeDesignPanel()}}}),saveBtn:SC.ButtonView.extend({controlSize:SC.HUGE_CONTROL_SIZE,layout:{width:60,height:30,left:20,centerY:0},title:"Button.Save".loc(),isEnabledBinding:SC.Binding.not("Designer.displayController.isBusy"),action:function(){Designer.formController.saveChanges()}})}),formView:FormDesigner.DesignerView.design({isVisibleBinding:"Designer.displayController.formVisible",layout:{top:44},contentBinding:SC.Binding.oneWay("Designer.formController"),isEditableBinding:"Designer.displayController.isEditable",addFieldDelegate:Designer.formController.addField,getFlowsByForm:Designer.flowsController.getFlowsByForm,isVisibleDidChange:function(){if(!this.get("isVisible")){if((Designer.formController.get("content").firstObject()&&(Designer.formController.get("content").firstObject().status()&SC.Record.DIRTY))||(Designer.flowController.get("content").firstObject()&&(Designer.flowController.get("content").firstObject().status()&SC.Record.DIRTY))){navigator.notification.confirm("",function(a){if(a===1){if(Designer.formController.get("is_valid")==false){Designer.formController.formInvalidAlert()}else{if(Designer.formController.get("name")==null||Designer.formController.get("name").trim()==""){Designer.formValidController.nameCannotBlank()}else{Designer.formController.saveChanges()}}}else{if(a===2){return}else{return}}},"Form.Designer.SaveOrNot".loc(),["Button.Save".loc(),"Button.Cancel".loc()])}}}.observes("isVisible")}),flowView:FlowDesigner.DesignerView.design({isVisibleBinding:"Designer.displayController.flowVisible",layout:{top:44},contentBinding:SC.Binding.oneWay("Designer.flowController"),rolesControllerDelegate:Designer.rolesController,isEditableBinding:"Designer.displayController.isEditable",companyIdBinding:"Designer.companyId",isVisible:YES,isVisibleDidChange:function(){if(!this.get("isVisible")){if((Designer.formController.get("content").firstObject()&&(Designer.formController.get("content").firstObject().status()&SC.Record.DIRTY))||(Designer.flowController.get("content").firstObject()&&(Designer.flowController.get("content").firstObject().status()&SC.Record.DIRTY))){navigator.notification.confirm("",function(e){if(e===1){if(Designer.formController.get("is_valid")==false){Designer.formController.formInvalidAlert()}else{if(Designer.formController.get("name")==null||Designer.formController.get("name").trim()==""){Designer.formValidController.nameCannotBlank()}else{Designer.formController.saveChanges()}}}else{if(e===2){return}else{return}}},"Form.Designer.SaveOrNot".loc(),["Button.Save".loc(),"Button.Cancel".loc()])}}else{if(Designer.displayController.get("justSaved")){Designer.displayController.set("justSaved",false);var d=null;var b=FlowDesigner.FlowController.get("content");var a=FlowDesigner.settings?FlowDesigner.settings.curFlowDesigner:null;if(b&&a instanceof FlowDesigner.Designer){if(d=b.get("firstObject")){d=d.attributes();a.reloadData(d)}}}}}.observes("isVisible")})}),});Designer.PermissionNavigatableView=CW.NavigatableView.extend(CW.ActionSheetSupport,{layout:{top:44,bottom:0,left:0,right:0},title:"Flow.Permission".loc(),hasLeftBarButton:YES,leftBarButtonTitle:"\uf053",leftBarButtonTheme:"fa",leftBarButtonAction:function(){this.pane().destroy()},hasRightBarButton:NO,childViews:["sectionedView"],sectionedView:CW.SectionedView.extend(CW.SectionedViewDesignSupport,CW.MiniFadingCaplessScrollerViewSupport,{horizontalScrollerView:CW.MiniFadingCaplessScrollerView,verticalScrollerView:CW.MiniFadingCaplessScrollerView,style:CW.SectionedViewStyle.GROUPED,sections:["add","monitor","manage"],add:CW.SectionedViewSection.extend({allowsSelection:NO,headerTitle:"Flow.Permission.Add".loc(),rows:"orgView userView".w(),orgView:CW.SectionedViewTextFieldRow.extend({text:"Flow.Permission.Org".loc(),layout:{left:SC.buildLocale=="zh-cn"?150:235},accessoryViewExample:CS.OrganizationSelectView.design({useModel:true,modelToOne:false,isMulti:YES,showFullName:true,showBorder:false,isTextArea:false,showNameTextFontSize:16,showNameNeedBolder:true,companyId:"",pickerTitle:"Flow.Permission.Org".loc(),init:function(){this.set("spaceId",Designer.spaceController.get("id"));this.set("value",Designer.flowController.get("perms").get("orgs_can_add"));this.set("companyId",Designer.companyId);var a=this;this.invokeLast(function(){var b=[];a.get("value").forEach(function(d){b.push(d.get("fullname"))});a.organizationView.set("value",b.join(", "))});arguments.callee.base.apply(this,arguments)},render:function(){arguments.callee.base.apply(this,arguments);this.adjust("left",0);this.adjust("top",9);this.adjust("minHeight",26);this.organizationView.adjust("left",SC.buildLocale=="zh-cn"?130:230)},valueDidChange:function(){if(this.get("value")&&this.get("value").get("length")>0){if(!Designer.utilController.compareArray(Designer.flowController.get("perms").get("orgs_can_add").toArray(),this.get("value").toArray())){Designer.flowController.get("perms").set("orgs_can_add",this.get("value"))}}else{var a=this;this.invokeLast(function(){a.organizationView.set("value","")});if(Designer.flowController.get("perms").get("orgs_can_add").get("length")>0){Designer.flowController.get("perms").set("orgs_can_add",[])}}}.observes("value"),mouseDown:function(){return this.organizationView.mouseDown()},touchStart:function(){return this.mouseDown()}})}),userView:CW.SectionedViewTextFieldRow.extend({text:"Flow.Permission.User".loc(),layout:{left:SC.buildLocale=="zh-cn"?150:235},accessoryViewExample:CS.UserSelectView.design({useModel:true,modelToOne:false,isMulti:YES,isTextArea:false,showBorder:false,isTextArea:false,showNameTextFontSize:16,showNameNeedBolder:true,showSearchBox:true,pickerTitle:"Flow.Permission.User".loc(),canFilter:true,init:function(){this.set("spaceId",Designer.spaceController.get("id"));this.set("value",Designer.flowController.get("perms").get("users_can_add"));this.set("companyId",Designer.companyId);var a=this;this.invokeLast(function(){var b=[];a.get("value").forEach(function(d){if(d){b.push(d.get("name"))}});a.userView.set("value",b.join(", "))});if(CW.isOEM()){this.set("canInviteUser",false)}else{this.set("canInviteUser",true)}arguments.callee.base.apply(this,arguments)},render:function(){arguments.callee.base.apply(this,arguments);this.adjust("left",0);this.adjust("top",9);this.adjust("minHeight",26);this.userView.adjust("left",SC.buildLocale=="zh-cn"?130:230)},valueDidChange:function(){if(this.get("value")&&this.get("value").get("length")>0){if(!Designer.utilController.compareArray(Designer.flowController.get("perms").get("users_can_add").toArray(),this.get("value").toArray())){Designer.flowController.get("perms").set("users_can_add",this.get("value"))}}else{var a=this;this.invokeLast(function(){a.userView.set("value","")});if(Designer.flowController.get("perms").get("users_can_add").get("length")>0){Designer.flowController.get("perms").set("users_can_add",[])}}}.observes("value"),mouseDown:function(){return this.userView.mouseDown()},touchStart:function(){return this.mouseDown()}})})}),monitor:CW.SectionedViewSection.extend({allowsSelection:NO,headerTitle:"Flow.Permission.Monitor".loc(),rows:"orgView userView".w(),orgView:CW.SectionedViewTextFieldRow.extend({text:"Flow.Permission.Org".loc(),layout:{left:SC.buildLocale=="zh-cn"?150:235},accessoryViewExample:CS.OrganizationSelectView.design({useModel:true,modelToOne:false,isMulti:YES,showFullName:true,showBorder:false,isTextArea:false,showNameTextFontSize:16,showNameNeedBolder:true,pickerTitle:"Flow.Permission.Org".loc(),init:function(){this.set("spaceId",Designer.spaceController.get("id"));this.set("value",Designer.flowController.get("perms").get("orgs_can_monitor"));this.set("companyId",Designer.companyId);var a=this;this.invokeLast(function(){var b=[];a.get("value").forEach(function(d){b.push(d.get("fullname"))});a.organizationView.set("value",b.join(", "))});arguments.callee.base.apply(this,arguments)},render:function(){arguments.callee.base.apply(this,arguments);this.adjust("left",0);this.adjust("top",9);this.adjust("minHeight",26);this.organizationView.adjust("left",SC.buildLocale=="zh-cn"?130:230)},valueDidChange:function(){if(this.get("value")&&this.get("value").get("length")>0){if(!Designer.utilController.compareArray(Designer.flowController.get("perms").get("orgs_can_monitor").toArray(),this.get("value").toArray())){Designer.flowController.get("perms").set("orgs_can_monitor",this.get("value"))}}else{var a=this;this.invokeLast(function(){a.organizationView.set("value","")});if(Designer.flowController.get("perms").get("orgs_can_monitor").get("length")>0){Designer.flowController.get("perms").set("orgs_can_monitor",[])}}}.observes("value"),mouseDown:function(){return this.organizationView.mouseDown()},touchStart:function(){return this.mouseDown()}})}),userView:CW.SectionedViewTextFieldRow.extend({text:"Flow.Permission.User".loc(),layout:{left:SC.buildLocale=="zh-cn"?150:235},accessoryViewExample:CS.UserSelectView.design({useModel:true,modelToOne:false,isMulti:YES,isTextArea:false,showBorder:false,isTextArea:false,showNameTextFontSize:16,showNameNeedBolder:true,showSearchBox:true,pickerTitle:"Flow.Permission.User".loc(),canFilter:true,init:function(){this.set("spaceId",Designer.spaceController.get("id"));this.set("value",Designer.flowController.get("perms").get("users_can_monitor"));this.set("companyId",Designer.companyId);var a=this;this.invokeLast(function(){var b=[];a.get("value").forEach(function(d){if(d){b.push(d.get("name"))}});a.userView.set("value",b.join(", "))});if(CW.isOEM()){this.set("canInviteUser",false)}else{this.set("canInviteUser",true)}arguments.callee.base.apply(this,arguments)},render:function(){arguments.callee.base.apply(this,arguments);this.adjust("top",9);this.adjust("left",0);this.adjust("minHeight",26);this.userView.adjust("left",SC.buildLocale=="zh-cn"?130:230)},valueDidChange:function(){if(this.get("value")&&this.get("value").get("length")>0){if(!Designer.utilController.compareArray(Designer.flowController.get("perms").get("users_can_monitor").toArray(),this.get("value").toArray())){Designer.flowController.get("perms").set("users_can_monitor",this.get("value"))}}else{var a=this;this.invokeLast(function(){a.userView.set("value","")});if(Designer.flowController.get("perms").get("users_can_monitor").get("length")>0){Designer.flowController.get("perms").set("users_can_monitor",[])}}}.observes("value"),mouseDown:function(){return this.userView.mouseDown()},touchStart:function(){return this.mouseDown()}})})}),manage:CW.SectionedViewSection.extend({allowsSelection:NO,init:function(){arguments.callee.base.apply(this,arguments);this.set("autoResizeFooterTitle",true)},headerTitle:"Flow.Permission.Admin".loc(),rows:"orgView userView".w(),orgView:CW.SectionedViewTextFieldRow.extend({text:"Flow.Permission.Org".loc(),layout:{left:SC.buildLocale=="zh-cn"?150:235},accessoryViewExample:CS.OrganizationSelectView.design({useModel:true,modelToOne:false,isMulti:YES,showFullName:true,showBorder:false,isTextArea:false,showNameTextFontSize:16,showNameNeedBolder:true,pickerTitle:"Flow.Permission.Org".loc(),init:function(){this.set("spaceId",Designer.spaceController.get("id"));this.set("value",Designer.flowController.get("perms").get("orgs_can_admin"));this.set("companyId",Designer.companyId);var a=this;this.invokeLast(function(){var b=[];a.get("value").forEach(function(d){b.push(d.get("fullname"))});a.organizationView.set("value",b.join(", "))});arguments.callee.base.apply(this,arguments)},render:function(){arguments.callee.base.apply(this,arguments);this.adjust("left",0);this.adjust("minHeight",26);this.adjust("top",9);this.organizationView.adjust("left",SC.buildLocale=="zh-cn"?130:230)},valueDidChange:function(){if(this.get("value")&&this.get("value").get("length")>0){if(!Designer.utilController.compareArray(Designer.flowController.get("perms").get("orgs_can_admin").toArray(),this.get("value").toArray())){Designer.flowController.get("perms").set("orgs_can_admin",this.get("value"))}}else{var a=this;this.invokeLast(function(){a.organizationView.set("value","")});if(Designer.flowController.get("perms").get("orgs_can_admin").get("length")>0){Designer.flowController.get("perms").set("orgs_can_admin",[])}}}.observes("value"),mouseDown:function(){return this.organizationView.mouseDown()},touchStart:function(){return this.mouseDown()}})}),userView:CW.SectionedViewTextFieldRow.extend({text:"Flow.Permission.User".loc(),layout:{left:SC.buildLocale=="zh-cn"?150:235},accessoryViewExample:CS.UserSelectView.design({useModel:true,modelToOne:false,isMulti:YES,isTextArea:false,showBorder:false,isTextArea:false,showNameTextFontSize:16,showNameNeedBolder:true,showSearchBox:true,pickerTitle:"Flow.Permission.User".loc(),canFilter:true,init:function(){this.set("spaceId",Designer.spaceController.get("id"));this.set("value",Designer.flowController.get("perms").get("users_can_admin"));this.set("companyId",Designer.companyId);var a=this;this.invokeLast(function(){var b=[];a.get("value").forEach(function(d){if(d){b.push(d.get("name"))}});a.userView.set("value",b.join(", "))});if(CW.isOEM()){this.set("canInviteUser",false)}else{this.set("canInviteUser",true)}arguments.callee.base.apply(this,arguments)},render:function(){arguments.callee.base.apply(this,arguments);this.adjust("left",0);this.adjust("top",9);this.adjust("minHeight",26);this.userView.adjust("left",SC.buildLocale=="zh-cn"?130:230)},valueDidChange:function(){if(this.get("value")&&this.get("value").get("length")>0){if(!Designer.utilController.compareArray(Designer.flowController.get("perms").get("users_can_admin").toArray(),this.get("value").toArray())){Designer.flowController.get("perms").set("users_can_admin",this.get("value"))}}else{var a=this;this.invokeLast(function(){a.userView.set("value","")});if(Designer.flowController.get("perms").get("users_can_admin").get("length")>0){Designer.flowController.get("perms").set("users_can_admin",[])}}}.observes("value"),mouseDown:function(){return this.userView.mouseDown()},touchStart:function(){return this.mouseDown()}})})})})});Designer.SpacePickerView=SC.SelectView.extend({layout:{width:150,height:24,centerX:0,centerY:0},isDefaultPosition:YES,itemTitleKey:"name",itemValueKey:"id",itemsBinding:"Designer.spacesController.content",valueBinding:"Designer.spaceId",render:function(a,b){arguments.callee.base.apply(this,arguments);if(b){this.invokeLast(function(){var e=Designer.getQueryString("spaceId");if(e){this.set("value",e)}var d=Designer.getQueryString("flowId");if(d){Designer.flowController.loadFlow(d);FlowDesigner.FlowController.set("showFlowPermission",Designer.flowController.showFlowPermission);Designer.displayController.openDesignPanel()}})}}});sc_require("views/space_picker");Designer.mainPage=SC.Page.design({mainPane:SC.MainPane.design({childViews:"steedWindow".w(),steedWindow:CW.SteedWindowView.design({hasNavigationBar:YES,hasTabBar:NO,classNames:"wood".w(),childViews:"toolbarView catView flowView".w(),toolbarView:SC.View.extend({layout:{height:44},childViews:"titleView spaceView".w(),titleView:SC.LabelView.extend({classNames:"panel-title",layout:{centerX:0,centerY:0,height:30,width:200},value:"Designer.title".loc(),}),spaceView:Designer.SpacePickerView.extend({layout:{centerY:0,height:24,left:20,width:200},})}),catView:SC.View.extend({layout:{top:45,left:0,width:350,bottom:0},childViews:"catListView addBtn titleView".w(),classNames:"category-view".w(),catListView:SC.ScrollView.extend({layout:{top:50,left:0,right:0,bottom:0},contentView:SC.ListView.extend({rowHeight:48,rowSpacing:1,classNames:"category-list-view",contentBinding:SC.Binding.oneWay("Designer.categoriesController.arrangedObjects"),exampleView:SC.View.extend(SC.Control,{classNames:"instance-item".w(),childViews:"name edit remove".w(),name:SC.LabelView.extend({layout:{left:10,height:17,centerY:0},valueBinding:SC.Binding.oneWay(".parentView.content.name"),}),edit:SC.ButtonView.extend({layout:{width:35,height:21,right:40,centerY:0},controlSize:SC.LARGE_CONTROL_SIZE,classNames:"fa".w(),title:"\uf044",toolTip:"Button.Edit".loc(),isVisible:false,action:function(){Designer.categoryController.set("content",this.get("parentView").get("content"));navigator.notification.prompt("",function(b){if(b.buttonIndex==1){var a=b.input1.trim();if(!a){return}data={Categories:[{id:Designer.categoryController.get("content").get("id"),name:a}]};$.ajax({url:requestOrigin+"/am/categories?methodOverride=PUT&sync_token="+Designer.sync_token,crossDomain:true,type:"POST",xhrFields:{withCredentials:true},dataType:"text",data:JSON.stringify(data),contentType:"text/plain"}).done(function(d){responseFixed=d.replace(/\"_id\"/g,'"id"');Designer.fixtures.ChangeSet=JSON.parse(responseFixed).ChangeSet;Designer.loadRecords(Designer.Category,Designer.fixtures.ChangeSet.updates.Categories);Designer.sync_token=Designer.fixtures.ChangeSet.sync_token}).error(function(d,f,e){alert("edit category failed: "+f+","+e)})}},"Space.Category.InputCategoryName".loc(),["Button.OK".loc(),"Button.Cancel".loc()],this.get("parentView").get("content").get("name"))}}),remove:SC.ButtonView.extend({layout:{width:35,height:21,right:0,centerY:0},controlSize:SC.LARGE_CONTROL_SIZE,classNames:"fa".w(),title:"\uf00d",toolTip:"Button.Delete".loc(),isVisible:false,action:function(){Designer.categoryController.set("content",this.get("parentView").get("content"));var b=SC.Query.local(Designer.Form,{conditions:"space.id = %@ AND category.id= %@",parameters:[Designer.spaceController.get("id"),this.get("parentView").get("content").get("id")]});var a=Designer.store.find(b);if(a.length()>0){navigator.notification.alert("",function(){},"Space.Category.Delete.Used".loc(),["Button.OK".loc()])}else{navigator.notification.prompt("",function(d){if(d.buttonIndex==1){if(d.input1==Designer.categoryController.get("name")){var e=SC.clone(Designer.categoryController.getPath("content"));Designer.categoryController.destroy();var f={Categories:[{id:e.get("id")}]};$.ajax({url:requestOrigin+"/am/categories?methodOverride=DELETE&sync_token="+Designer.sync_token,crossDomain:true,type:"POST",xhrFields:{withCredentials:true},dataType:"text",data:JSON.stringify(f),contentType:"text/plain"}).done(function(h){var g=h.replace(/\"_id\"/g,'"id"');Designer.fixtures.ChangeSet=JSON.parse(g).ChangeSet;Designer.sync_token=Designer.fixtures.ChangeSet.sync_token}).error(function(g,j,h){alert("delete category failed: "+j+","+h)})}else{navigator.notification.alert("",function(){},"Form.MakeSureToDelete.InputWrongName".loc(),["Button.OK".loc()])}}},"Space.Category.Delete.InputCategoryName".loc(),["Button.Delete".loc(),"Button.Cancel".loc()])}}}),mouseEntered:function(){if(this.get("content").get("id")!=(Designer.spaceId+"_nocategory")&&!Designer.companyId){this.childViews[1].set("isVisible",true);this.childViews[2].set("isVisible",true)}},mouseExited:function(){if(this.childViews[1]&&this.childViews[2]){this.childViews[1].set("isVisible",false);this.childViews[2].set("isVisible",false)}}}),useToggleSelection:NO,select:function(){arguments.callee.base.apply(this,arguments);Designer.set("categoryId",this.selection.firstObject().get("id"))},})}),addBtn:SC.ButtonView.extend({layout:{width:120,height:30,top:10,right:20},title:"Space.Category.Add".loc(),classNames:"sel".w(),action:function(){Designer.categoriesController.addCategory()},isVisibleBinding:SC.Binding.not("Designer.companyId")}),titleView:SC.LabelView.extend({layout:{height:30,left:10,right:150,top:10},classNames:"category-title-view".w(),value:"Space.Category".loc(),})}),flowView:SC.View.extend({layout:{left:351,right:0,top:45,bottom:0},childViews:"flowListView addBtn titleView".w(),classNames:"workflow-view".w(),flowListView:SC.ScrollView.extend({layout:{left:0,right:0,top:50,bottom:0},contentView:SC.ListView.extend({rowHeight:48,rowSpacing:1,classNames:"workflow-list-view",contentBinding:SC.Binding.oneWay("Designer.flowsController.arrangedObjects"),selectionBinding:"Designer.flowsController.selection",exampleView:SC.View.extend(SC.Control,{classNames:"instance-item".w(),childViews:"name state remove".w(),name:SC.LabelView.extend({layout:{left:10,height:17,centerY:0},valueBinding:SC.Binding.oneWay(".parentView.content.name"),}),state:CW.SwitchView.extend({layout:{width:80,centerY:0,height:30,right:40},valueBinding:".parentView.content.state",action:function(){var b=this.get("parentView").get("content");var a=b.attributes();data={Flows:[a]};$.ajax({url:requestOrigin+"/am/flows/state?methodOverride=PUT&sync_token="+Designer.sync_token,crossDomain:true,type:"POST",xhrFields:{withCredentials:true},dataType:"text",data:JSON.stringify(data),contentType:"text/plain"}).done(function(d){responseFixed=d.replace(/\"_id\"/g,'"id"');Designer.fixtures.ChangeSet=JSON.parse(responseFixed).ChangeSet;Designer.loadRecords(Designer.Form,Designer.fixtures.ChangeSet.updates.Forms);Designer.loadRecords(Designer.Flow,Designer.fixtures.ChangeSet.updates.Flows);Designer.sync_token=Designer.fixtures.ChangeSet.sync_token}).error(function(d,f,e){alert("update form failed: "+f+","+e)})},toggleOnValue:"enabled",toggleOffValue:"disabled",}),remove:SC.ButtonView.extend({layout:{width:35,height:21,right:0,centerY:0},controlSize:SC.LARGE_CONTROL_SIZE,classNames:"fa".w(),title:"\uf00d",toolTip:"Button.Delete".loc(),isVisible:false,action:function(){Designer.flowController.set("content",this.get("parentView").get("content"));navigator.notification.prompt("",function(b){if(b.buttonIndex==1){if(b.input1==Designer.flowController.get("content").get("name")){FlowDesigner.FlowStepAndLineController.content=null;var d=SC.clone(Designer.flowController.getPath("content"));Designer.flowController.destroy();Designer.formController.destroy();var f=SC.Query.local(Designer.Flow,{conditions:"form.id = %@",parameters:[d.get("form").get("id")]});var g=Designer.store.find(f);var e={};var a="";if(g.length()>1){e={Flows:[{id:d.get("id")}]};a=requestOrigin+"/am/flows?methodOverride=DELETE&sync_token="+Designer.sync_token}else{e={Forms:[{id:d.get("form").get("id")}]};a=requestOrigin+"/am/forms?methodOverride=DELETE&sync_token="+Designer.sync_token}$.ajax({url:a,crossDomain:true,type:"POST",xhrFields:{withCredentials:true},dataType:"text",data:JSON.stringify(e),contentType:"text/plain"}).done(function(j){var h=j.replace(/\"_id\"/g,'"id"');Designer.fixtures.ChangeSet=JSON.parse(h).ChangeSet;Designer.sync_token=Designer.fixtures.ChangeSet.sync_token}).error(function(h,k,j){alert("delete flow failed: "+k+","+j)})}else{navigator.notification.alert("",function(){},"Flow.MakeSureToDelete.InputWrongName".loc(),["Button.OK".loc()])}}},"Flow.MakeSureToDelete".loc(),["Button.Delete".loc(),"Button.Cancel".loc()])}}),mouseEntered:function(){if(this.childViews[2]){this.childViews[2].set("isVisible",true)}},mouseExited:function(){if(this.childViews[2]){this.childViews[2].set("isVisible",false)}}}),useToggleSelection:NO,select:function(){arguments.callee.base.apply(this,arguments);FlowDesigner.FlowController.set("showFlowPermission",Designer.flowController.showFlowPermission);this.invokeLast(function(){Designer.displayController.openDesignPanel()})},}),}),addBtn:SC.ButtonView.extend({layout:{width:120,height:30,top:10,right:20},classNames:"sel",title:"Flow.Button.Add".loc(),action:function(){Designer.formsController.addForm()}}),titleView:SC.LabelView.extend({layout:{height:30,left:10,right:150,top:10},classNames:"workflow-title-view".w(),value:"Flow.List.Header".loc(),})}),}),})});Designer.main=function main(){document.title="Designer.title".loc();Designer.companyId=Designer.getQueryString("companyId")||"";requestOrigin="";$.ajax({url:requestOrigin+"/am/designer/startup?companyId="+Designer.companyId,crossDomain:true,type:"GET",xhrFields:{withCredentials:true},dataType:"text"}).done(function(a){responseFixed=a.replace(/\"_id\"/g,'"id"');Designer.fixtures=JSON.parse(responseFixed);Designer.loadRecords(Designer.Space,Designer.fixtures.Spaces);Designer.loadRecords(Designer.User,Designer.fixtures.Users);Designer.loadRecords(Designer.SpaceUser,Designer.fixtures.SpaceUsers);Designer.loadRecords(Designer.Organization,Designer.fixtures.Organizations);Designer.loadRecords(Designer.Role,Designer.fixtures.Roles);Designer.loadRecords(Designer.Position,Designer.fixtures.Positions);Designer.loadRecords(Designer.Category,Designer.fixtures.Categories);Designer.loadRecords(Designer.Form,Designer.fixtures.Forms);for(i=0;i<Designer.fixtures.Flows.length;i++){flow=Designer.fixtures.Flows[i];formId=flow.form;formRecord=Designer.store.find(Designer.Form,formId);if(formRecord){if(formRecord.get("category")){flow.category=formRecord.get("category").get("id")}}}Designer.loadRecords(Designer.Flow,Designer.fixtures.Flows);Designer.flowsController.load();Designer.spacesController.load();Designer.spacesController.load();CS.store=Designer.store;CS.User=Designer.User;CS.SpaceUser=Designer.SpaceUser;CS.Organization=Designer.Organization;Designer.sync_token=Designer.fixtures.sync_token;Designer.getPath("mainPage.mainPane").append()}).error(function(a,d,b){alert("Load startup data failed: "+d+","+b)})};function main(){Designer.main()};