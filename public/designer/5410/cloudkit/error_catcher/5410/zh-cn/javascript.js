CK.errorCatcher.mixin({MAX_RECENT_LOG_MESSAGES_SIZE:4800,_radarComponents:{contacts:"SteedOS Contacts Web App",mail:"SteedOS Mail Web Client",workflow:"SteedOS Workflow Web App",calendar:"SteedOS Calendar Web App",steedos:"SteedOS SteedOS",notes:"SteedOS Notes Web App",reminders:"SteedOS Reminders Web App"},moduleDidLoad:function(j,h){SC.debug("CloudKit: ErrorCatcher module loaded.");if(this.customize){this.customize()}var f=h.applicationName||"steedos",i,g;i=SC.clone(h,YES);i.origin=h.origin;i.type=h.type;i=this._fieldsForHash(i,f);if(h.showDialog===NO){this.sendErrorReport(i,f,h)}else{this.displayExceptionDialog(i,f,h)}},displayExceptionDialog:function(v,r,w){var s=("AppTitle."+r).loc(),o=s&&!CK.currentApplication?"ErrorCatcher.Dialog.Title".loc(s):"ErrorCatcher.Dialog.Title.NoApp".loc(),m="ErrorCatcher.Dialog.Text".loc(),p="me-icon-alert-67",n="ErrorCatcher.Dialog.Caption".loc(),q=v.type,t=v.text,x;if(q!=="exception"){o=w.title?w.title:o;m=w.message?w.message:m;p=w.icon?w.icon:p}var u=this;this._alert=CW.Alert.show({message:o,description:m,layout:{centerX:0,width:CW.isMobile()?300:500,centerY:0,minHeight:160},image:{value:"me-icon-alert-68",height:68,width:68},leftButton:function(){var a=function(){for(var c=0;c<navigator.mimeTypes.length;c++){var b=navigator.mimeTypes[c];if(b.suffixes==="x-snkp"&&b.enabledPlugin){return true}}return false}();if(!a||!SC.browser.isSafari){return}return{title:"Create Radar",action:"createRadar"}}(),rightButton:{title:"ErrorCatcher.Dialog.ReportButton".loc(),action:"report"},middleButton:{title:w.isFatal?"ErrorCatcher.Dialog.ReloadButton".loc():"ErrorCatcher.Dialog.CloseButton".loc(),action:"close"},close:function(){u.exitErrorCatcher(w,r);this.remove()},report:function(){u.sendErrorReport(v,r,w);this.remove()},createRadar:function(){var d=window.escape(u._radarComponents[r]||"SteedOS Web"),b=window.escape(v.error||""),c=window.escape("* SUMMARY\nRecap the problem title and/or include more descriptive summary information.\n\n* ERROR CATCHER LOG\n\n"+t);var a="rdar://new/problem/component=%@&version=All&title=%@&description=%@".fmt(d,b,c);window.location=a},extraView:CW.DetailsDisclosureView.design({caption:n,disclosureTitle:"ErrorCatcher.Dialog.Details".loc(),contentView:SC.TextFieldView.design({layout:{height:90},isTextArea:YES,isVisible:NO,value:t})})})},exitErrorCatcher:function(c,d){if(c.isFatal){if(SteedOS.isSteedOSClient&&d!=="steedos"){SteedOS.appController.reloadApplication(d)}else{if(CK.currentApplication&&CK.currentApplication.isWindowApplication){window.close()}else{window.location.reload()}}}else{if(!c.isFatal&&c.dismissCallback){c.dismissCallback.call()}}CK.errorCatcher.set("isReporting",NO)},sendErrorReport:function(r,l,q){var n=r.error||r.origin+" - "+r.type,o=this,j,k,p,m;r.text=null;p={appName:l,errorTitle:n,errorType:q.type,origin:q.origin};for(j in r){k=r[j];if(k!==undefined&&k!==null){p[j]=k}}m=CK.Request.postUrl("https://feedbackws.steedos.com/reportStats",null);m.set("isJSON",YES);m.notify(200,this,function(a){o.exitErrorCatcher(q,l);return YES});m.notify(0,this,function(a){o.exitErrorCatcher(q,l);return YES});SC.debug("CloudKit: Sending error catcher report for steedOS",l);m.send(p)},_fieldsForHash:function(v,s){if(!v){v={}}var y,B,x;v.buildNumber=SC.buildNumber;v.time=new Date().toString()+"        ("+Math.floor(new Date())+")";v.host=window.location.host;v.userAgent=navigator.userAgent+"";y=SteedOS.isSteedOSClient?(SteedOS.authController&&SteedOS.authController.get("user")):SteedOS.getUser();if(y){B=y.get("dsid");v.dsid=y.get("dsid");v.name=y.get("name");v.steedosId=y.get("steedosId")}v.environment=function(){return SteedOS.isSteedOSClient?COS.authController.get("environment"):SteedOS.getEnvironment()}();v.recentLogMessages=function(){return v.log||SC.Logger.stringifyRecordedLogMessages()}();var i=[],q,z,A,w,t,p,u,r;for(q in v){z=v[q];if(!z){continue}A="";p=YES;for(w=0,t=q.length;w<t;++w){u=q.charAt(w);r=u.toUpperCase();if(u===r){if(w===0){p=NO}if(p){A+=" "}}A+=r}i.push(A);i.push(z+"\n")}v.text=i.join("\n");return v}});SC.stringsFor("ja-jp",{"ErrorCatcher.Dialog.Caption":'「SteedOSへ送信」をクリックすると、アップルがサポートサービスの一環としてこの情報を収集し、製品とサービスの改善に利用することに同意するものとみなされます。レポートにはあなたのメンバー名やユーザデータなどの個人情報が含まれます。アップルのプライバシーポリシーの詳細は <a target="_BLANK" href="http://www.apple.com/jp/privacy/">http://www.steedos.com/privacy/</a> をご覧ください。',"ErrorCatcher.Dialog.CloseButton":"閉じる","ErrorCatcher.Dialog.Details":"詳細情報","ErrorCatcher.Dialog.ReloadButton":"再読み込み","ErrorCatcher.Dialog.ReportButton":"SteedOSへ送信","ErrorCatcher.Dialog.Text":"エラーのため、このアプリケーションは正常に動作していません。SteedOSの分析や使用状況などの情報を送信して、製品の品質向上にご協力ください。","ErrorCatcher.Dialog.Title":"%@の応答が停止しました。","ErrorCatcher.Dialog.Title.NoApp":"予期不能な問題が発生したため、アプリケーションが停止しました。"});SC.stringsFor("zh-cn",{"ErrorCatcher.Dialog.Caption":"点击“发送”，即表示您同意 SteedOS 在其支持服务过程中收集并使用此信息以改进其产品与服务。该报告将包括您的会员名和用户数据等个人信息。","ErrorCatcher.Dialog.CloseButton":"关闭","ErrorCatcher.Dialog.Details":"详细信息","ErrorCatcher.Dialog.ReloadButton":"重新载入","ErrorCatcher.Dialog.ReportButton":"发送","ErrorCatcher.Dialog.Text":"错误已导致此应用程序无法正常工作。向我们发送有关 SteedOS 的诊断和使用信息，帮助我们改进产品。","ErrorCatcher.Dialog.Title":"%@ 已停止响应。","ErrorCatcher.Dialog.Title.NoApp":"应用软件意外中止。"});
